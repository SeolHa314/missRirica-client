diff --color=auto -r misskeyV13/packages/frontend/src/account.ts RiricaV13/account.ts
1,9c1,9
< import { defineAsyncComponent, reactive } from 'vue';
< import * as misskey from 'misskey-js';
< import { showSuspendedDialog } from './scripts/show-suspended-dialog';
< import { i18n } from './i18n';
< import { miLocalStorage } from './local-storage';
< import { del, get, set } from '@/scripts/idb-proxy';
< import { apiUrl } from '@/config';
< import { waiting, api, popup, popupMenu, success, alert } from '@/os';
< import { unisonReload, reloadChannel } from '@/scripts/unison-reload';
---
> import { defineAsyncComponent, reactive } from "vue";
> import * as misskey from "misskey-js";
> import { showSuspendedDialog } from "./scripts/show-suspended-dialog";
> import { i18n } from "./i18n";
> import { del, get, set } from "@/scripts/idb-proxy";
> import { waiting, api, popup, popupMenu, success, alert, apiGet } from "@/os";
> import { unisonReload, reloadChannel } from "@/scripts/unison-reload";
> import * as Misskey from "misskey-js";
> import { instance } from "@/instance";
11d10
< // TODO: 他のタブと永続化されたstateを同期
12a12,13
> // アカウントデータがJSONでパースできないほど壊れてたら諦めて再設定
> 
13a15,21
> let accountData = null
> try {
>    accountData = JSON.parse(localStorage.getItem("account"))
> }catch (e) {
>   localStorage.removeItem("account")
>   window.location.reload()
> }
15c23
< const accountData = miLocalStorage.getItem('account');
---
> if(accountData && !accountData?.instanceUrl) accountData.instanceUrl = "https://misskey.io"
18c26,28
< export const $i = accountData ? reactive(JSON.parse(accountData) as Account) : null;
---
> export const $i = accountData
>   ? reactive(accountData as Account)
>   : null;
23,27d32
< export let notesCount = $i == null ? 0 : $i.notesCount;
< export function incNotesCount() {
< 	notesCount++;
< }
< 
29,30c34,35
< 	waiting();
< 	miLocalStorage.removeItem('account');
---
>   waiting();
>   localStorage.removeItem("account");
32c37
< 	await removeAccount($i.id);
---
>   await removeAccount($i.id);
34c39
< 	const accounts = await getAccounts();
---
>   const accounts = await getAccounts();
36,53c41
< 	//#region Remove service worker registration
< 	try {
< 		if (navigator.serviceWorker.controller) {
< 			const registration = await navigator.serviceWorker.ready;
< 			const push = await registration.pushManager.getSubscription();
< 			if (push) {
< 				await window.fetch(`${apiUrl}/sw/unregister`, {
< 					method: 'POST',
< 					body: JSON.stringify({
< 						i: $i.token,
< 						endpoint: push.endpoint,
< 					}),
< 					headers: {
< 						'Content-Type': 'application/json',
< 					},
< 				});
< 			}
< 		}
---
>   document.cookie = "igi=; path=/";
55,67c43,44
< 		if (accounts.length === 0) {
< 			await navigator.serviceWorker.getRegistrations()
< 				.then(registrations => {
< 					return Promise.all(registrations.map(registration => registration.unregister()));
< 				});
< 		}
< 	} catch (err) {}
< 	//#endregion
< 
< 	document.cookie = 'igi=; path=/';
< 
< 	if (accounts.length > 0) login(accounts[0].token);
< 	else unisonReload('/');
---
>   if (accounts.length > 0) login(accounts[0].token, accounts[0].instanceUrl);
>   else unisonReload("/");
70,71c47,50
< export async function getAccounts(): Promise<{ id: Account['id'], token: Account['token'] }[]> {
< 	return (await get('accounts')) || [];
---
> export async function getAccounts(): Promise<
>   { id: Account["id"]; token: Account["token"] , instanceUrl: string}[]
> > {
>   return (await get("accounts")) || [];
74,78c53,57
< export async function addAccount(id: Account['id'], token: Account['token']) {
< 	const accounts = await getAccounts();
< 	if (!accounts.some(x => x.id === id)) {
< 		await set('accounts', accounts.concat([{ id, token }]));
< 	}
---
> export async function addAccount(id: Account["id"], token: Account["token"], instanceUrl: string) {
>   const accounts = await getAccounts();
>   if (!accounts.some((x) => x.id === id)) {
>     await set("accounts", accounts.concat([{ id, token , instanceUrl}]));
>   }
81,83c60,65
< export async function removeAccount(id: Account['id']) {
< 	const accounts = await getAccounts();
< 	accounts.splice(accounts.findIndex(x => x.id === id), 1);
---
> export async function removeAccount(id: Account["id"]) {
>   const accounts = await getAccounts();
>   accounts.splice(
>     accounts.findIndex((x) => x.id === id),
>     1
>   );
85,86c67,68
< 	if (accounts.length > 0) await set('accounts', accounts);
< 	else await del('accounts');
---
>   if (accounts.length > 0) await set("accounts", accounts);
>   else await del("accounts");
89,121c71,94
< function fetchAccount(token: string): Promise<Account> {
< 	return new Promise((done, fail) => {
< 		// Fetch user
< 		window.fetch(`${apiUrl}/i`, {
< 			method: 'POST',
< 			body: JSON.stringify({
< 				i: token,
< 			}),
< 			headers: {
< 				'Content-Type': 'application/json',
< 			},
< 		})
< 			.then(res => res.json())
< 			.then(res => {
< 				if (res.error) {
< 					if (res.error.id === 'a8c724b3-6e9c-4b46-b1a8-bc3ed6258370') {
< 						showSuspendedDialog().then(() => {
< 							signout();
< 						});
< 					} else {
< 						alert({
< 							type: 'error',
< 							title: i18n.ts.failedToFetchAccountInformation,
< 							text: JSON.stringify(res.error),
< 						});
< 					}
< 				} else {
< 					res.token = token;
< 					done(res);
< 				}
< 			})
< 			.catch(fail);
< 	});
---
> function fetchAccount(token: string, instanceUrl: string): Promise<Account & {instanceUrl: string}> {
>   const apiClient = new Misskey.api.APIClient({
>     origin: instanceUrl,
>     credential: token,
>   });
>   return apiClient
>     .request("i")
>     .then((res) => {
>       return {...res as Account, token,  instanceUrl};
>     })
>     .catch((err) => {
>       if (err.id === "a8c724b3-6e9c-4b46-b1a8-bc3ed6258370") {
>         showSuspendedDialog().then(() => {
>           signout();
>         });
>       } else {
>         alert({
>           type: "error",
>           title: i18n.ts.failedToFetchAccountInformation,
>           text: JSON.stringify(err),
>         })
>       }
>       return Promise.reject(err)
>     });
124,128c97,101
< export function updateAccount(accountData) {
< 	for (const [key, value] of Object.entries(accountData)) {
< 		$i[key] = value;
< 	}
< 	miLocalStorage.setItem('account', JSON.stringify($i));
---
> export function updateAccount(accountData: Object) {
>   for (const [key, value] of Object.entries(accountData)) {
>     $i[key] = value;
>   }
>   localStorage.setItem("account", JSON.stringify($i));
132c105,106
< 	return fetchAccount($i.token).then(updateAccount);
---
>   console.debug($i)
>   return fetchAccount($i.token, $i.instanceUrl).then(updateAccount);
135,141c109,115
< export async function login(token: Account['token'], redirect?: string) {
< 	waiting();
< 	if (_DEV_) console.log('logging as token ', token);
< 	const me = await fetchAccount(token);
< 	miLocalStorage.setItem('account', JSON.stringify(me));
< 	document.cookie = `token=${token}; path=/; max-age=31536000`; // bull dashboardの認証とかで使う
< 	await addAccount(me.id, token);
---
> export async function login(token: Account["token"], instanceUrl: string,  redirect?: string) {
>   if (_DEV_) console.log("logging as token ", token, instanceUrl);
>   const me = await fetchAccount(token, instanceUrl)
>   localStorage.setItem("account", JSON.stringify(me));
>   localStorage.setItem("instance", JSON.stringify(await new Misskey.api.APIClient({origin: instanceUrl, credential: token}).request("meta")))
>   document.cookie = `token=${token}; path=/; max-age=31536000`; // bull dashboardの認証とかで使う
>   await addAccount(me.id, token, instanceUrl);
143,149c117,123
< 	if (redirect) {
< 		// 他のタブは再読み込みするだけ
< 		reloadChannel.postMessage(null);
< 		// このページはredirectで指定された先に移動
< 		location.href = redirect;
< 		return;
< 	}
---
>   if (redirect) {
>     // 他のタブは再読み込みするだけ
>     reloadChannel.postMessage(null);
>     // このページはredirectで指定された先に移動
>     location.href = redirect;
>     return;
>   }
151c125
< 	unisonReload();
---
>   unisonReload();
154,167c128,149
< export async function openAccountMenu(opts: {
< 	includeCurrentAccount?: boolean;
< 	withExtraOperation: boolean;
< 	active?: misskey.entities.UserDetailed['id'];
< 	onChoose?: (account: misskey.entities.UserDetailed) => void;
< }, ev: MouseEvent) {
< 	function showSigninDialog() {
< 		popup(defineAsyncComponent(() => import('@/components/MkSigninDialog.vue')), {}, {
< 			done: res => {
< 				addAccount(res.id, res.i);
< 				success();
< 			},
< 		}, 'closed');
< 	}
---
> export async function openAccountMenu(
>   opts: {
>     includeCurrentAccount?: boolean;
>     withExtraOperation: boolean;
>     active?: misskey.entities.UserDetailed["id"];
>     onChoose?: (account: misskey.entities.UserDetailed) => void;
>   },
>   ev: MouseEvent
> ) {
>   function showSigninDialog() {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkSigninDialog.vue")),
>       {},
>       {
>         done: (res) => {
>           addAccount(res.id, res.i, res.instanceUrl);
>           success();
>         },
>       },
>       "closed"
>     );
>   }
169,176d150
< 	function createAccount() {
< 		popup(defineAsyncComponent(() => import('@/components/MkSignupDialog.vue')), {}, {
< 			done: res => {
< 				addAccount(res.id, res.i);
< 				switchAccountWithToken(res.i);
< 			},
< 		}, 'closed');
< 	}
178,182d151
< 	async function switchAccount(account: misskey.entities.UserDetailed) {
< 		const storedAccounts = await getAccounts();
< 		const token = storedAccounts.find(x => x.id === account.id).token;
< 		switchAccountWithToken(token);
< 	}
184,186c153,158
< 	function switchAccountWithToken(token: string) {
< 		login(token);
< 	}
---
>   async function switchAccount(account: misskey.entities.UserDetailed) {
>     const storedAccounts = await getAccounts();
>     const acc = storedAccounts.find((x) => x.id === account.id);
>      const{ token, instanceUrl } = acc
>     switchAccountWithToken(token, instanceUrl);
>   }
188,189c160,162
< 	const storedAccounts = await getAccounts().then(accounts => accounts.filter(x => x.id !== $i.id));
< 	const accountsPromise = api('users/show', { userIds: storedAccounts.map(x => x.id) });
---
>   function switchAccountWithToken(token: string, instanceUrl: string) {
>     login(token, instanceUrl);
>   }
191,204c164,166
< 	function createItem(account: misskey.entities.UserDetailed) {
< 		return {
< 			type: 'user',
< 			user: account,
< 			active: opts.active != null ? opts.active === account.id : false,
< 			action: () => {
< 				if (opts.onChoose) {
< 					opts.onChoose(account);
< 				} else {
< 					switchAccount(account);
< 				}
< 			},
< 		};
< 	}
---
>   const storedAccounts = await getAccounts().then((accounts) =>
>     accounts.filter((x) => x.id !== $i.id)
>   );
206,212d167
< 	const accountItemPromises = storedAccounts.map(a => new Promise(res => {
< 		accountsPromise.then(accounts => {
< 			const account = accounts.find(x => x.id === a.id);
< 			if (account == null) return res(null);
< 			res(createItem(account));
< 		});
< 	}));
214,243c169,239
< 	if (opts.withExtraOperation) {
< 		popupMenu([...[{
< 			type: 'link',
< 			text: i18n.ts.profile,
< 			to: `/@${ $i.username }`,
< 			avatar: $i,
< 		}, null, ...(opts.includeCurrentAccount ? [createItem($i)] : []), ...accountItemPromises, {
< 			type: 'parent',
< 			icon: 'ti ti-plus',
< 			text: i18n.ts.addAccount,
< 			children: [{
< 				text: i18n.ts.existingAccount,
< 				action: () => { showSigninDialog(); },
< 			}, {
< 				text: i18n.ts.createAccount,
< 				action: () => { createAccount(); },
< 			}],
< 		}, {
< 			type: 'link',
< 			icon: 'ti ti-users',
< 			text: i18n.ts.manageAccounts,
< 			to: '/settings/accounts',
< 		}]], ev.currentTarget ?? ev.target, {
< 			align: 'left',
< 		});
< 	} else {
< 		popupMenu([...(opts.includeCurrentAccount ? [createItem($i)] : []), ...accountItemPromises], ev.currentTarget ?? ev.target, {
< 			align: 'left',
< 		});
< 	}
---
>   function createItem(account: misskey.entities.UserDetailed) {
>     return {
>       type: "user",
>       user: account,
>       active: opts.active != null ? opts.active === account.id : false,
>       action: () => {
>         if (opts.onChoose) {
>           opts.onChoose(account);
>         } else {
>           switchAccount(account);
>         }
>       },
>     };
>   }
> 
>   const accountItemPromises = storedAccounts.map(
>     (a) =>
>       new Promise((res) => {
>         const client = new Misskey.api.APIClient({origin: a.instanceUrl, credential: a.token})
> 
>         client.request("users/show", {
>           userIds: [a.id]
>         }).then((accounts) => {
>           const account = accounts.find((x) => x.id === a.id);
>           if (account == null) return res(null);
> 
>           client.request("meta").then(meta => {
>             res(createItem({ ...account, host: meta.name}))
>           })
>         });
>       })
>   );
> 
>   if (opts.withExtraOperation) {
>     popupMenu(
>       [
>         ...[
>           {
>             type: "link",
>             text: i18n.ts.profile,
>             to: `/@${$i.username}`,
>             avatar: $i,
>           },
>           null,
>           ...(opts.includeCurrentAccount ? [createItem($i)] : []),
>           ...accountItemPromises,
>           {
>             type: "link",
>             icon: "fas fa-users",
>             text: i18n.ts.manageAccounts,
>             to: "/settings/accounts",
>           },
>         ],
>       ],
>       ev.currentTarget ?? ev.target,
>       {
>         align: "left",
>       }
>     );
>   } else {
>     popupMenu(
>       [
>         ...(opts.includeCurrentAccount ? [createItem($i)] : []),
>         ...accountItemPromises,
>       ],
>       ev.currentTarget ?? ev.target,
>       {
>         align: "left",
>       }
>     );
>   }
Only in RiricaV13: assets
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkAbuseReport.vue RiricaV13/components/MkAbuseReport.vue
2,35c2,57
< <div class="bcekxzvu _margin _panel">
< 	<div class="target">
< 		<MkA v-user-preview="report.targetUserId" class="info" :to="`/user-info/${report.targetUserId}`">
< 			<MkAvatar class="avatar" :user="report.targetUser" indicator/>
< 			<div class="names">
< 				<MkUserName class="name" :user="report.targetUser"/>
< 				<MkAcct class="acct" :user="report.targetUser" style="display: block;"/>
< 			</div>
< 		</MkA>
< 		<MkKeyValue>
< 			<template #key>{{ i18n.ts.registeredDate }}</template>
< 			<template #value>{{ dateString(report.targetUser.createdAt) }} (<MkTime :time="report.targetUser.createdAt"/>)</template>
< 		</MkKeyValue>
< 	</div>
< 	<div class="detail">
< 		<div>
< 			<Mfm :text="report.comment"/>
< 		</div>
< 		<hr/>
< 		<div>{{ i18n.ts.reporter }}: <MkAcct :user="report.reporter"/></div>
< 		<div v-if="report.assignee">
< 			{{ i18n.ts.moderator }}:
< 			<MkAcct :user="report.assignee"/>
< 		</div>
< 		<div><MkTime :time="report.createdAt"/></div>
< 		<div class="action">
< 			<MkSwitch v-model="forward" :disabled="report.targetUser.host == null || report.resolved">
< 				{{ i18n.ts.forwardReport }}
< 				<template #caption>{{ i18n.ts.forwardReportIsAnonymous }}</template>
< 			</MkSwitch>
< 			<MkButton v-if="!report.resolved" primary @click="resolve">{{ i18n.ts.abuseMarkAsResolved }}</MkButton>
< 		</div>
< 	</div>
< </div>
---
>   <div class="bcekxzvu _gap _panel">
>     <div class="target">
>       <MkA
>         v-user-preview="report.targetUserId"
>         class="info"
>         :to="`/user-info/${report.targetUserId}`"
>       >
>         <MkAvatar
>           class="avatar"
>           :user="report.targetUser"
>           :show-indicator="true"
>           :disable-link="true"
>         />
>         <div class="names">
>           <MkUserName class="name" :user="report.targetUser" />
>           <MkAcct
>             class="acct"
>             :user="report.targetUser"
>             style="display: block"
>           />
>         </div>
>       </MkA>
>       <MkKeyValue class="_formBlock">
>         <template #key>{{ i18n.ts.registeredDate }}</template>
>         <template #value
>           >{{ new Date(report.targetUser.createdAt).toLocaleString() }} (<MkTime
>             :time="report.targetUser.createdAt"
>           />)</template
>         >
>       </MkKeyValue>
>     </div>
>     <div class="detail">
>       <div>
>         <Mfm :text="report.comment" />
>       </div>
>       <hr />
>       <div>{{ i18n.ts.reporter }}: <MkAcct :user="report.reporter" /></div>
>       <div v-if="report.assignee">
>         {{ i18n.ts.moderator }}:
>         <MkAcct :user="report.assignee" />
>       </div>
>       <div><MkTime :time="report.createdAt" /></div>
>       <div class="action">
>         <MkSwitch
>           v-model="forward"
>           :disabled="report.targetUser.host == null || report.resolved"
>         >
>           {{ i18n.ts.forwardReport }}
>           <template #caption>{{ i18n.ts.forwardReportIsAnonymous }}</template>
>         </MkSwitch>
>         <MkButton v-if="!report.resolved" primary @click="resolve">{{
>           i18n.ts.abuseMarkAsResolved
>         }}</MkButton>
>       </div>
>     </div>
>   </div>
39,45c61,66
< import MkButton from '@/components/MkButton.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import { acct, userPage } from '@/filters/user';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { dateString } from '@/filters/date';
---
> import MkButton from "@/components/MkButton.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import { acct, userPage } from "@/filters/user";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
48c69
< 	report: any;
---
>   report: any;
52c73
< 	(ev: 'resolved', reportId: string): void;
---
>   (ev: "resolved", reportId: string): void;
58,63c79,84
< 	os.apiWithDialog('admin/resolve-abuse-user-report', {
< 		forward: forward,
< 		reportId: props.report.id,
< 	}).then(() => {
< 		emit('resolved', props.report.id);
< 	});
---
>   os.apiWithDialog("admin/resolve-abuse-user-report", {
>     forward: forward,
>     reportId: props.report.id,
>   }).then(() => {
>     emit("resolved", props.report.id);
>   });
69c90
< 	display: flex;
---
>   display: flex;
71,76c92,97
< 	> .target {
< 		width: 35%;
< 		box-sizing: border-box;
< 		text-align: left;
< 		padding: 24px;
< 		border-right: solid 1px var(--divider);
---
>   > .target {
>     width: 35%;
>     box-sizing: border-box;
>     text-align: left;
>     padding: 24px;
>     border-right: solid 1px var(--divider);
78,86c99,116
< 		> .info {
< 			display: flex;
< 			box-sizing: border-box;
< 			align-items: center;
< 			padding: 14px;
< 			border-radius: 8px;
< 			--c: rgb(255 196 0 / 15%);
< 			background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 			background-size: 16px 16px;
---
>     > .info {
>       display: flex;
>       box-sizing: border-box;
>       align-items: center;
>       padding: 14px;
>       border-radius: 8px;
>       --c: rgb(255 196 0 / 15%);
>       background-image: linear-gradient(
>         45deg,
>         var(--c) 16.67%,
>         transparent 16.67%,
>         transparent 50%,
>         var(--c) 50%,
>         var(--c) 66.67%,
>         transparent 66.67%,
>         transparent 100%
>       );
>       background-size: 16px 16px;
88,91c118,121
< 			> .avatar {
< 				width: 42px;
< 				height: 42px;
< 			}
---
>       > .avatar {
>         width: 42px;
>         height: 42px;
>       }
93,96c123,126
< 			> .names {
< 				margin-left: 0.3em;
< 				padding: 0 8px;
< 				flex: 1;
---
>       > .names {
>         margin-left: 0.3em;
>         padding: 0 8px;
>         flex: 1;
98,103c128,133
< 				> .name {
< 					font-weight: bold;
< 				}
< 			}
< 		}
< 	}
---
>         > .name {
>           font-weight: bold;
>         }
>       }
>     }
>   }
105,108c135,138
< 	> .detail {
< 		flex: 1;
< 		padding: 24px;
< 	}
---
>   > .detail {
>     flex: 1;
>     padding: 24px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkAbuseReportWindow.vue RiricaV13/components/MkAbuseReportWindow.vue
2,24c2,30
< <MkWindow ref="uiWindow" :initial-width="400" :initial-height="500" :can-resize="true" @closed="emit('closed')">
< 	<template #header>
< 		<i class="ti ti-exclamation-circle" style="margin-right: 0.5em;"></i>
< 		<I18n :src="i18n.ts.reportAbuseOf" tag="span">
< 			<template #name>
< 				<b><MkAcct :user="user"/></b>
< 			</template>
< 		</I18n>
< 	</template>
< 	<MkSpacer :margin-min="20" :margin-max="28">
< 		<div class="dpvffvvy _gaps_m">
< 			<div class="">
< 				<MkTextarea v-model="comment">
< 					<template #label>{{ i18n.ts.details }}</template>
< 					<template #caption>{{ i18n.ts.fillAbuseReportDescription }}</template>
< 				</MkTextarea>
< 			</div>
< 			<div class="">
< 				<MkButton primary full :disabled="comment.length === 0" @click="send">{{ i18n.ts.send }}</MkButton>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkWindow>
---
>   <XWindow
>     ref="uiWindow"
>     :initial-width="400"
>     :initial-height="500"
>     :can-resize="true"
>     @closed="emit('closed')"
>   >
>     <template #header>
>       <i class="fas fa-exclamation-circle" style="margin-right: 0.5em"></i>
>       <I18n :src="i18n.ts.reportAbuseOf" tag="span">
>         <template #name>
>           <b><MkAcct :user="user" /></b>
>         </template>
>       </I18n>
>     </template>
>     <div class="dpvffvvy _monolithic_">
>       <div class="_section">
>         <MkTextarea v-model="comment">
>           <template #label>{{ i18n.ts.details }}</template>
>           <template #caption>{{ i18n.ts.fillAbuseReportDescription }}</template>
>         </MkTextarea>
>       </div>
>       <div class="_section">
>         <MkButton primary full :disabled="comment.length === 0" @click="send">{{
>           i18n.ts.send
>         }}</MkButton>
>       </div>
>     </div>
>   </XWindow>
28,34c34,40
< import { ref, shallowRef } from 'vue';
< import * as Misskey from 'misskey-js';
< import MkWindow from '@/components/MkWindow.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import * as Misskey from "misskey-js";
> import XWindow from "@/components/MkWindow.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
37,38c43,44
< 	user: Misskey.entities.User;
< 	initialComment?: string;
---
>   user: Misskey.entities.User;
>   initialComment?: string;
42c48
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
45,46c51,52
< const uiWindow = shallowRef<InstanceType<typeof MkWindow>>();
< const comment = ref(props.initialComment || '');
---
> const uiWindow = ref<InstanceType<typeof XWindow>>();
> const comment = ref(props.initialComment || "");
49,59c55,69
< 	os.apiWithDialog('users/report-abuse', {
< 		userId: props.user.id,
< 		comment: comment.value,
< 	}, undefined).then(res => {
< 		os.alert({
< 			type: 'success',
< 			text: i18n.ts.abuseReported,
< 		});
< 		uiWindow.value?.close();
< 		emit('closed');
< 	});
---
>   os.apiWithDialog(
>     "users/report-abuse",
>     {
>       userId: props.user.id,
>       comment: comment.value,
>     },
>     undefined
>   ).then((res) => {
>     os.alert({
>       type: "success",
>       text: i18n.ts.abuseReported,
>     });
>     uiWindow.value?.close();
>     emit("closed");
>   });
65c75
< 	--root-margin: 16px;
---
>   --root-margin: 16px;
Only in misskeyV13/packages/frontend/src/components: MkAchievements.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkAnalogClock.vue RiricaV13/components/MkAnalogClock.vue
2,27c2,47
< <svg :class="$style.root" viewBox="0 0 10 10" preserveAspectRatio="none">
< 	<template v-if="props.graduations === 'dots'">
< 		<circle
< 			v-for="(angle, i) in graduationsMajor"
< 			:cx="5 + (Math.sin(angle) * (5 - graduationsPadding))"
< 			:cy="5 - (Math.cos(angle) * (5 - graduationsPadding))"
< 			:r="0.125"
< 			:fill="(props.twentyfour ? h : h % 12) === i ? nowColor : majorGraduationColor"
< 			:opacity="!props.fadeGraduations || (props.twentyfour ? h : h % 12) === i ? 1 : Math.max(0, 1 - (angleDiff(hAngle, angle) / Math.PI) - numbersOpacityFactor)"
< 		/>
< 	</template>
< 	<template v-else-if="props.graduations === 'numbers'">
< 		<text
< 			v-for="(angle, i) in texts"
< 			:x="5 + (Math.sin(angle) * (5 - textsPadding))"
< 			:y="5 - (Math.cos(angle) * (5 - textsPadding))"
< 			text-anchor="middle"
< 			dominant-baseline="middle"
< 			:font-size="(props.twentyfour ? h : h % 12) === i ? 1 : 0.7"
< 			:font-weight="(props.twentyfour ? h : h % 12) === i ? 'bold' : 'normal'"
< 			:fill="(props.twentyfour ? h : h % 12) === i ? nowColor : 'currentColor'"
< 			:opacity="!props.fadeGraduations || (props.twentyfour ? h : h % 12) === i ? 1 : Math.max(0, 1 - (angleDiff(hAngle, angle) / Math.PI) - numbersOpacityFactor)"
< 		>
< 			{{ i === 0 ? (props.twentyfour ? '24' : '12') : i }}
< 		</text>
< 	</template>
---
>   <svg class="mbcofsoe" viewBox="0 0 10 10" preserveAspectRatio="none">
>     <template v-if="props.graduations === 'dots'">
>       <circle
>         v-for="(angle, i) in graduationsMajor"
>         :cx="5 + Math.sin(angle) * (5 - graduationsPadding)"
>         :cy="5 - Math.cos(angle) * (5 - graduationsPadding)"
>         :r="0.125"
>         :fill="
>           (props.twentyfour ? h : h % 12) === i
>             ? nowColor
>             : majorGraduationColor
>         "
>         :opacity="
>           !props.fadeGraduations || (props.twentyfour ? h : h % 12) === i
>             ? 1
>             : Math.max(
>                 0,
>                 1 - angleDiff(hAngle, angle) / Math.PI - numbersOpacityFactor
>               )
>         "
>       />
>     </template>
>     <template v-else-if="props.graduations === 'numbers'">
>       <text
>         v-for="(angle, i) in texts"
>         :x="5 + Math.sin(angle) * (5 - textsPadding)"
>         :y="5 - Math.cos(angle) * (5 - textsPadding)"
>         text-anchor="middle"
>         dominant-baseline="middle"
>         :font-size="(props.twentyfour ? h : h % 12) === i ? 1 : 0.7"
>         :font-weight="(props.twentyfour ? h : h % 12) === i ? 'bold' : 'normal'"
>         :fill="
>           (props.twentyfour ? h : h % 12) === i ? nowColor : 'currentColor'
>         "
>         :opacity="
>           !props.fadeGraduations || (props.twentyfour ? h : h % 12) === i
>             ? 1
>             : Math.max(
>                 0,
>                 1 - angleDiff(hAngle, angle) / Math.PI - numbersOpacityFactor
>               )
>         "
>       >
>         {{ i === 0 ? (props.twentyfour ? "24" : "12") : i }}
>       </text>
>     </template>
29c49
< 	<!--
---
>     <!--
41,51c61,76
< 	<line
< 		:class="[$style.s, { [$style.animate]: !disableSAnimate && sAnimation !== 'none', [$style.elastic]: sAnimation === 'elastic', [$style.easeOut]: sAnimation === 'easeOut' }]"
< 		:x1="5 - (0 * (sHandLengthRatio * handsTailLength))"
< 		:y1="5 + (1 * (sHandLengthRatio * handsTailLength))"
< 		:x2="5 + (0 * ((sHandLengthRatio * 5) - handsPadding))"
< 		:y2="5 - (1 * ((sHandLengthRatio * 5) - handsPadding))"
< 		:stroke="sHandColor"
< 		:stroke-width="thickness / 2"
< 		:style="`transform: rotateZ(${sAngle}rad)`"
< 		stroke-linecap="round"
< 	/>
---
>     <line
>       class="s"
>       :class="{
>         animate: !disableSAnimate && sAnimation !== 'none',
>         elastic: sAnimation === 'elastic',
>         easeOut: sAnimation === 'easeOut',
>       }"
>       :x1="5 - 0 * (sHandLengthRatio * handsTailLength)"
>       :y1="5 + 1 * (sHandLengthRatio * handsTailLength)"
>       :x2="5 + 0 * (sHandLengthRatio * 5 - handsPadding)"
>       :y2="5 - 1 * (sHandLengthRatio * 5 - handsPadding)"
>       :stroke="sHandColor"
>       :stroke-width="thickness / 2"
>       :style="`transform: rotateZ(${sAngle}rad)`"
>       stroke-linecap="round"
>     />
53,61c78,86
< 	<line
< 		:x1="5 - (Math.sin(mAngle) * (mHandLengthRatio * handsTailLength))"
< 		:y1="5 + (Math.cos(mAngle) * (mHandLengthRatio * handsTailLength))"
< 		:x2="5 + (Math.sin(mAngle) * ((mHandLengthRatio * 5) - handsPadding))"
< 		:y2="5 - (Math.cos(mAngle) * ((mHandLengthRatio * 5) - handsPadding))"
< 		:stroke="mHandColor"
< 		:stroke-width="thickness"
< 		stroke-linecap="round"
< 	/>
---
>     <line
>       :x1="5 - Math.sin(mAngle) * (mHandLengthRatio * handsTailLength)"
>       :y1="5 + Math.cos(mAngle) * (mHandLengthRatio * handsTailLength)"
>       :x2="5 + Math.sin(mAngle) * (mHandLengthRatio * 5 - handsPadding)"
>       :y2="5 - Math.cos(mAngle) * (mHandLengthRatio * 5 - handsPadding)"
>       :stroke="mHandColor"
>       :stroke-width="thickness"
>       stroke-linecap="round"
>     />
63,72c88,97
< 	<line
< 		:x1="5 - (Math.sin(hAngle) * (hHandLengthRatio * handsTailLength))"
< 		:y1="5 + (Math.cos(hAngle) * (hHandLengthRatio * handsTailLength))"
< 		:x2="5 + (Math.sin(hAngle) * ((hHandLengthRatio * 5) - handsPadding))"
< 		:y2="5 - (Math.cos(hAngle) * ((hHandLengthRatio * 5) - handsPadding))"
< 		:stroke="hHandColor"
< 		:stroke-width="thickness"
< 		stroke-linecap="round"
< 	/>
< </svg>
---
>     <line
>       :x1="5 - Math.sin(hAngle) * (hHandLengthRatio * handsTailLength)"
>       :y1="5 + Math.cos(hAngle) * (hHandLengthRatio * handsTailLength)"
>       :x2="5 + Math.sin(hAngle) * (hHandLengthRatio * 5 - handsPadding)"
>       :y2="5 - Math.cos(hAngle) * (hHandLengthRatio * 5 - handsPadding)"
>       :stroke="hHandColor"
>       :stroke-width="thickness"
>       stroke-linecap="round"
>     />
>   </svg>
76,78c101,110
< import { ref, computed, onMounted, onBeforeUnmount, shallowRef, nextTick } from 'vue';
< import tinycolor from 'tinycolor2';
< import { globalEvents } from '@/events.js';
---
> import {
>   ref,
>   computed,
>   onMounted,
>   onBeforeUnmount,
>   shallowRef,
>   nextTick,
> } from "vue";
> import tinycolor from "tinycolor2";
> import { globalEvents } from "@/events.js";
82,83c114,115
< 	const x = Math.abs(a - b);
< 	return Math.abs((x + Math.PI) % (Math.PI * 2) - Math.PI);
---
>   const x = Math.abs(a - b);
>   return Math.abs(((x + Math.PI) % (Math.PI * 2)) - Math.PI);
95,110c127,145
< const props = withDefaults(defineProps<{
< 	thickness?: number;
< 	offset?: number;
< 	twentyfour?: boolean;
< 	graduations?: 'none' | 'dots' | 'numbers';
< 	fadeGraduations?: boolean;
< 	sAnimation?: 'none' | 'elastic' | 'easeOut';
< }>(), {
< 	numbers: false,
< 	thickness: 0.1,
< 	offset: 0 - new Date().getTimezoneOffset(),
< 	twentyfour: false,
< 	graduations: 'dots',
< 	fadeGraduations: true,
< 	sAnimation: 'elastic',
< });
---
> const props = withDefaults(
>   defineProps<{
>     thickness?: number;
>     offset?: number;
>     twentyfour?: boolean;
>     graduations?: "none" | "dots" | "numbers";
>     fadeGraduations?: boolean;
>     sAnimation?: "none" | "elastic" | "easeOut";
>   }>(),
>   {
>     numbers: false,
>     thickness: 0.1,
>     offset: 0 - new Date().getTimezoneOffset(),
>     twentyfour: false,
>     graduations: "dots",
>     fadeGraduations: true,
>     sAnimation: "elastic",
>   }
> );
113,119c148,154
< 	const angles: number[] = [];
< 	const times = props.twentyfour ? 24 : 12;
< 	for (let i = 0; i < times; i++) {
< 		const angle = Math.PI * i / (times / 2);
< 		angles.push(angle);
< 	}
< 	return angles;
---
>   const angles: number[] = [];
>   const times = props.twentyfour ? 24 : 12;
>   for (let i = 0; i < times; i++) {
>     const angle = (Math.PI * i) / (times / 2);
>     angles.push(angle);
>   }
>   return angles;
122,128c157,163
< 	const angles: number[] = [];
< 	const times = props.twentyfour ? 24 : 12;
< 	for (let i = 0; i < times; i++) {
< 		const angle = Math.PI * i / (times / 2);
< 		angles.push(angle);
< 	}
< 	return angles;
---
>   const angles: number[] = [];
>   const times = props.twentyfour ? 24 : 12;
>   for (let i = 0; i < times; i++) {
>     const angle = (Math.PI * i) / (times / 2);
>     angles.push(angle);
>   }
>   return angles;
148,169c183,209
< 	const now = new Date();
< 	now.setMinutes(now.getMinutes() + (new Date().getTimezoneOffset() + props.offset));
< 	s = now.getSeconds();
< 	m = now.getMinutes();
< 	h = now.getHours();
< 	hAngle = Math.PI * (h % (props.twentyfour ? 24 : 12) + (m + s / 60) / 60) / (props.twentyfour ? 12 : 6);
< 	mAngle = Math.PI * (m + s / 60) / 30;
< 	if (sOneRound) { // 秒針が一周した際のアニメーションをよしなに処理する(これが無いと秒が59->0になったときに期待したアニメーションにならない)
< 		sAngle = Math.PI * 60 / 30;
< 		window.setTimeout(() => {
< 			disableSAnimate = true;
< 			window.setTimeout(() => {
< 				sAngle = 0;
< 				window.setTimeout(() => {
< 					disableSAnimate = false;
< 				}, 100);
< 			}, 100);
< 		}, 700);
< 	} else {
< 		sAngle = Math.PI * s / 30;
< 	}
< 	sOneRound = s === 59;
---
>   const now = new Date();
>   now.setMinutes(
>     now.getMinutes() + (new Date().getTimezoneOffset() + props.offset)
>   );
>   s = now.getSeconds();
>   m = now.getMinutes();
>   h = now.getHours();
>   hAngle =
>     (Math.PI * ((h % (props.twentyfour ? 24 : 12)) + (m + s / 60) / 60)) /
>     (props.twentyfour ? 12 : 6);
>   mAngle = (Math.PI * (m + s / 60)) / 30;
>   if (sOneRound) {
>     // 秒針が一周した際のアニメーションをよしなに処理する(これが無いと秒が59->0になったときに期待したアニメーションにならない)
>     sAngle = (Math.PI * 60) / 30;
>     window.setTimeout(() => {
>       disableSAnimate = true;
>       window.setTimeout(() => {
>         sAngle = 0;
>         window.setTimeout(() => {
>           disableSAnimate = false;
>         }, 100);
>       }, 100);
>     }, 700);
>   } else {
>     sAngle = (Math.PI * s) / 30;
>   }
>   sOneRound = s === 59;
175,183c215,227
< 	const computedStyle = getComputedStyle(document.documentElement);
< 	const dark = tinycolor(computedStyle.getPropertyValue('--bg')).isDark();
< 	const accent = tinycolor(computedStyle.getPropertyValue('--accent')).toHexString();
< 	majorGraduationColor = dark ? 'rgba(255, 255, 255, 0.3)' : 'rgba(0, 0, 0, 0.3)';
< 	//minorGraduationColor = dark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)';
< 	sHandColor = dark ? 'rgba(255, 255, 255, 0.5)' : 'rgba(0, 0, 0, 0.3)';
< 	mHandColor = tinycolor(computedStyle.getPropertyValue('--fg')).toHexString();
< 	hHandColor = accent;
< 	nowColor = accent;
---
>   const computedStyle = getComputedStyle(document.documentElement);
>   const dark = tinycolor(computedStyle.getPropertyValue("--bg")).isDark();
>   const accent = tinycolor(
>     computedStyle.getPropertyValue("--accent")
>   ).toHexString();
>   majorGraduationColor = dark
>     ? "rgba(255, 255, 255, 0.3)"
>     : "rgba(0, 0, 0, 0.3)";
>   //minorGraduationColor = dark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)';
>   sHandColor = dark ? "rgba(255, 255, 255, 0.5)" : "rgba(0, 0, 0, 0.3)";
>   mHandColor = tinycolor(computedStyle.getPropertyValue("--fg")).toHexString();
>   hHandColor = accent;
>   nowColor = accent;
189,195c233,239
< 	const update = () => {
< 		if (enabled) {
< 			tick();
< 			window.setTimeout(update, 1000);
< 		}
< 	};
< 	update();
---
>   const update = () => {
>     if (enabled) {
>       tick();
>       window.setTimeout(update, 1000);
>     }
>   };
>   update();
197c241
< 	globalEvents.on('themeChanged', calcColors);
---
>   globalEvents.on("themeChanged", calcColors);
201c245
< 	enabled = false;
---
>   enabled = false;
203c247
< 	globalEvents.off('themeChanged', calcColors);
---
>   globalEvents.off("themeChanged", calcColors);
207,210c251,253
< <style lang="scss" module>
< .root {
< 	display: block;
< }
---
> <style lang="scss" scoped>
> .mbcofsoe {
>   display: block;
212,214c255,257
< .s {
< 	will-change: transform;
< 	transform-origin: 50% 50%;
---
>   > .s {
>     will-change: transform;
>     transform-origin: 50% 50%;
216,218c259,261
< 	&.animate.elastic {
< 		transition: transform .2s cubic-bezier(.4,2.08,.55,.44);
< 	}
---
>     &.animate.elastic {
>       transition: transform 0.2s cubic-bezier(0.4, 2.08, 0.55, 0.44);
>     }
220,222c263,266
< 	&.animate.easeOut {
< 		transition: transform .7s cubic-bezier(0,.7,.3,1);
< 	}
---
>     &.animate.easeOut {
>       transition: transform 0.7s cubic-bezier(0, 0.7, 0.3, 1);
>     }
>   }
Only in misskeyV13/packages/frontend/src/components: MkAsUi.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkAutocomplete.vue RiricaV13/components/MkAutocomplete.vue
2,32c2,76
< <div ref="rootEl" :class="$style.root" class="_popup _shadow" :style="{ zIndex }" @contextmenu.prevent="() => {}">
< 	<ol v-if="type === 'user'" ref="suggests" :class="$style.list">
< 		<li v-for="user in users" tabindex="-1" :class="$style.item" @click="complete(type, user)" @keydown="onKeydown">
< 			<img :class="$style.avatar" :src="user.avatarUrl"/>
< 			<span :class="$style.userName">
< 				<MkUserName :key="user.id" :user="user"/>
< 			</span>
< 			<span>@{{ acct(user) }}</span>
< 		</li>
< 		<li tabindex="-1" :class="$style.item" @click="chooseUser()" @keydown="onKeydown">{{ i18n.ts.selectUser }}</li>
< 	</ol>
< 	<ol v-else-if="hashtags.length > 0" ref="suggests" :class="[$style.list, $style.hashtags]">
< 		<li v-for="hashtag in hashtags" tabindex="-1" :class="$style.item" @click="complete(type, hashtag)" @keydown="onKeydown">
< 			<span class="name">{{ hashtag }}</span>
< 		</li>
< 	</ol>
< 	<ol v-else-if="emojis.length > 0" ref="suggests" :class="$style.list">
< 		<li v-for="emoji in emojis" :key="emoji.emoji" :class="$style.item" tabindex="-1" @click="complete(type, emoji.emoji)" @keydown="onKeydown">
< 			<MkEmoji :emoji="emoji.emoji" :class="$style.emoji"/>
< 			<!-- eslint-disable-next-line vue/no-v-html -->
< 			<span v-if="q" :class="$style.emojiName" v-html="sanitizeHtml(emoji.name.replace(q, `<b>${q}</b>`))"></span>
< 			<span v-else v-text="emoji.name"></span>
< 			<span v-if="emoji.aliasOf" :class="$style.emojiAlias">({{ emoji.aliasOf }})</span>
< 		</li>
< 	</ol>
< 	<ol v-else-if="mfmTags.length > 0" ref="suggests" :class="$style.list">
< 		<li v-for="tag in mfmTags" tabindex="-1" :class="$style.item" @click="complete(type, tag)" @keydown="onKeydown">
< 			<span>{{ tag }}</span>
< 		</li>
< 	</ol>
< </div>
---
>   <div
>     ref="rootEl"
>     class="swhvrteh _popup _shadow"
>     :style="{ zIndex }"
>     @contextmenu.prevent="() => {}"
>   >
>     <ol v-if="type === 'user'" ref="suggests" class="users">
>       <li
>         v-for="user in users"
>         tabindex="-1"
>         class="user"
>         @click="complete(type, user)"
>         @keydown="onKeydown"
>       >
>         <img class="avatar" :src="user.avatarUrl" />
>         <span class="name">
>           <MkUserName :key="user.id" :user="user" />
>         </span>
>         <span class="username">@{{ acct(user) }}</span>
>       </li>
>       <li
>         tabindex="-1"
>         class="choose"
>         @click="chooseUser()"
>         @keydown="onKeydown"
>       >
>         {{ i18n.ts.selectUser }}
>       </li>
>     </ol>
>     <ol v-else-if="hashtags.length > 0" ref="suggests" class="hashtags">
>       <li
>         v-for="hashtag in hashtags"
>         tabindex="-1"
>         @click="complete(type, hashtag)"
>         @keydown="onKeydown"
>       >
>         <span class="name">{{ hashtag }}</span>
>       </li>
>     </ol>
>     <ol v-else-if="emojis.length > 0" ref="suggests" class="emojis">
>       <li
>         v-for="emoji in emojis"
>         tabindex="-1"
>         @click="complete(type, emoji.emoji)"
>         @keydown="onKeydown"
>       >
>         <span v-if="emoji.isCustomEmoji" class="emoji"
>           ><img
>             :src="
>               defaultStore.state.disableShowingAnimatedImages
>                 ? getStaticImageUrl(emoji.url)
>                 : emoji.url
>             "
>             :alt="emoji.emoji"
>         /></span>
>         <span v-else-if="!defaultStore.state.useOsNativeEmojis" class="emoji"
>           ><img :src="emoji.url" :alt="emoji.emoji"
>         /></span>
>         <span v-else class="emoji">{{ emoji.emoji }}</span>
>         <!-- eslint-disable-next-line vue/no-v-html -->
>         <span class="name" v-html="emoji.name.replace(q, `<b>${q}</b>`)"></span>
>         <span v-if="emoji.aliasOf" class="alias">({{ emoji.aliasOf }})</span>
>       </li>
>     </ol>
>     <ol v-else-if="mfmTags.length > 0" ref="suggests" class="mfmTags">
>       <li
>         v-for="tag in mfmTags"
>         tabindex="-1"
>         @click="complete(type, tag)"
>         @keydown="onKeydown"
>       >
>         <span class="tag">{{ tag }}</span>
>       </li>
>     </ol>
>   </div>
36,48c80,98
< import { markRaw, ref, shallowRef, computed, onUpdated, onMounted, onBeforeUnmount, nextTick, watch } from 'vue';
< import sanitizeHtml from 'sanitize-html';
< import contains from '@/scripts/contains';
< import { char2twemojiFilePath, char2fluentEmojiFilePath } from '@/scripts/emoji-base';
< import { acct } from '@/filters/user';
< import * as os from '@/os';
< import { MFM_TAGS } from '@/scripts/mfm-tags';
< import { defaultStore } from '@/store';
< import { emojilist } from '@/scripts/emojilist';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
< import { miLocalStorage } from '@/local-storage';
< import { customEmojis } from '@/custom-emojis';
---
> import {
>   markRaw,
>   ref,
>   onUpdated,
>   onMounted,
>   onBeforeUnmount,
>   nextTick,
>   watch,
> } from "vue";
> import contains from "@/scripts/contains";
> import { char2filePath } from "@/scripts/twemoji-base";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import { acct } from "@/filters/user";
> import * as os from "@/os";
> import { MFM_TAGS } from "@/scripts/mfm-tags";
> import { defaultStore } from "@/store";
> import { emojilist } from "@/scripts/emojilist";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
51,59c101,105
< 	emoji: string;
< 	name: string;
< 	url: string;
< 	aliasOf?: string;
< } | {
< 	emoji: string;
< 	name: string;
< 	aliasOf?: string;
< 	isCustomEmoji?: true;
---
>   emoji: string;
>   name: string;
>   aliasOf?: string;
>   url?: string;
>   isCustomEmoji?: boolean;
62c108
< const lib = emojilist.filter(x => x.category !== 'flags');
---
> const lib = emojilist.filter((x) => x.category !== "flags");
64,66c110,114
< const emojiDb = computed(() => {
< 	//#region Unicode Emoji
< 	const char2path = defaultStore.reactiveState.emojiStyle.value === 'twemoji' ? char2twemojiFilePath : char2fluentEmojiFilePath;
---
> const emjdb: EmojiDef[] = lib.map((x) => ({
>   emoji: x.char,
>   name: x.name,
>   url: char2filePath(x.char),
> }));
68,72c116,127
< 	const unicodeEmojiDB: EmojiDef[] = lib.map(x => ({
< 		emoji: x.char,
< 		name: x.name,
< 		url: char2path(x.char),
< 	}));
---
> for (const x of lib) {
>   if (x.keywords) {
>     for (const k of x.keywords) {
>       emjdb.push({
>         emoji: x.char,
>         name: k,
>         aliasOf: x.name,
>         url: char2filePath(x.char),
>       });
>     }
>   }
> }
74,85c129
< 	for (const x of lib) {
< 		if (x.keywords) {
< 			for (const k of x.keywords) {
< 				unicodeEmojiDB.push({
< 					emoji: x.char,
< 					name: k,
< 					aliasOf: x.name,
< 					url: char2path(x.char),
< 				});
< 			}
< 		}
< 	}
---
> emjdb.sort((a, b) => a.name.length - b.name.length);
87,88c131,133
< 	unicodeEmojiDB.sort((a, b) => a.name.length - b.name.length);
< 	//#endregion
---
> //#region Construct Emoji DB
> const customEmojis = instance.emojis;
> const emojiDefinitions: EmojiDef[] = [];
90,91c135,141
< 	//#region Custom Emoji
< 	const customEmojiDB: EmojiDef[] = [];
---
> for (const x of customEmojis) {
>   emojiDefinitions.push({
>     name: x.name,
>     emoji: `:${x.name}:`,
>     url: x.url,
>     isCustomEmoji: true,
>   });
93,98c143,154
< 	for (const x of customEmojis.value) {
< 		customEmojiDB.push({
< 			name: x.name,
< 			emoji: `:${x.name}:`,
< 			isCustomEmoji: true,
< 		});
---
>   if (x.aliases) {
>     for (const alias of x.aliases) {
>       emojiDefinitions.push({
>         name: alias,
>         aliasOf: x.name,
>         emoji: `:${x.name}:`,
>         url: x.url,
>         isCustomEmoji: true,
>       });
>     }
>   }
> }
100,110c156
< 		if (x.aliases) {
< 			for (const alias of x.aliases) {
< 				customEmojiDB.push({
< 					name: alias,
< 					aliasOf: x.name,
< 					emoji: `:${x.name}:`,
< 					isCustomEmoji: true,
< 				});
< 			}
< 		}
< 	}
---
> emojiDefinitions.sort((a, b) => a.name.length - b.name.length);
112,113c158,159
< 	customEmojiDB.sort((a, b) => a.name.length - b.name.length);
< 	//#endregion
---
> const emojiDb = markRaw(emojiDefinitions.concat(emjdb));
> //#endregion
115,117d160
< 	return markRaw([ ...customEmojiDB, ...unicodeEmojiDB ]);
< });
< 
119,120c162,165
< 	emojiDb,
< 	emojilist,
---
>   emojiDb,
>   emojiDefinitions,
>   emojilist,
>   customEmojis,
126,131c171,176
< 	type: string;
< 	q: string | null;
< 	textarea: HTMLTextAreaElement;
< 	close: () => void;
< 	x: number;
< 	y: number;
---
>   type: string;
>   q: string | null;
>   textarea: HTMLTextAreaElement;
>   close: () => void;
>   x: number;
>   y: number;
135,136c180,181
< 	(event: 'done', value: { type: string; value: any }): void;
< 	(event: 'closed'): void;
---
>   (event: "done", value: { type: string; value: any }): void;
>   (event: "closed"): void;
140c185
< const rootEl = shallowRef<HTMLDivElement>();
---
> const rootEl = ref<HTMLDivElement>();
145c190
< const emojis = ref<(EmojiDef)[]>([]);
---
> const emojis = ref<EmojiDef[]>([]);
149c194
< const zIndex = os.claimZIndex('high');
---
> const zIndex = os.claimZIndex("high");
152,159c197,204
< 	emit('done', { type, value });
< 	emit('closed');
< 	if (type === 'emoji') {
< 		let recents = defaultStore.state.recentlyUsedEmojis;
< 		recents = recents.filter((emoji: any) => emoji !== value);
< 		recents.unshift(value);
< 		defaultStore.set('recentlyUsedEmojis', recents.splice(0, 32));
< 	}
---
>   emit("done", { type, value });
>   emit("closed");
>   if (type === "emoji") {
>     let recents = defaultStore.state.recentlyUsedEmojis;
>     recents = recents.filter((emoji: any) => emoji !== value);
>     recents.unshift(value);
>     defaultStore.set("recentlyUsedEmojis", recents.splice(0, 32));
>   }
163,175c208,221
< 	if (!rootEl.value) return;
< 	if (props.x + rootEl.value.offsetWidth > window.innerWidth) {
< 		rootEl.value.style.left = (window.innerWidth - rootEl.value.offsetWidth) + 'px';
< 	} else {
< 		rootEl.value.style.left = `${props.x}px`;
< 	}
< 	if (props.y + rootEl.value.offsetHeight > window.innerHeight) {
< 		rootEl.value.style.top = (props.y - rootEl.value.offsetHeight) + 'px';
< 		rootEl.value.style.marginTop = '0';
< 	} else {
< 		rootEl.value.style.top = props.y + 'px';
< 		rootEl.value.style.marginTop = 'calc(1em + 8px)';
< 	}
---
>   if (!rootEl.value) return;
>   if (props.x + rootEl.value.offsetWidth > window.innerWidth) {
>     rootEl.value.style.left =
>       window.innerWidth - rootEl.value.offsetWidth + "px";
>   } else {
>     rootEl.value.style.left = `${props.x}px`;
>   }
>   if (props.y + rootEl.value.offsetHeight > window.innerHeight) {
>     rootEl.value.style.top = props.y - rootEl.value.offsetHeight + "px";
>     rootEl.value.style.marginTop = "0";
>   } else {
>     rootEl.value.style.top = props.y + "px";
>     rootEl.value.style.marginTop = "calc(1em + 8px)";
>   }
179,190c225,236
< 	select.value = -1;
< 	if (suggests.value) {
< 		for (const el of Array.from(items.value)) {
< 			el.removeAttribute('data-selected');
< 		}
< 	}
< 	if (props.type === 'user') {
< 		if (!props.q) {
< 			users.value = [];
< 			fetching.value = false;
< 			return;
< 		}
---
>   select.value = -1;
>   if (suggests.value) {
>     for (const el of Array.from(items.value)) {
>       el.removeAttribute("data-selected");
>     }
>   }
>   if (props.type === "user") {
>     if (!props.q) {
>       users.value = [];
>       fetching.value = false;
>       return;
>     }
192,193c238,239
< 		const cacheKey = `autocomplete:user:${props.q}`;
< 		const cache = sessionStorage.getItem(cacheKey);
---
>     const cacheKey = `autocomplete:user:${props.q}`;
>     const cache = sessionStorage.getItem(cacheKey);
195,238c241,286
< 		if (cache) {
< 			users.value = JSON.parse(cache);
< 			fetching.value = false;
< 		} else {
< 			os.api('users/search-by-username-and-host', {
< 				username: props.q,
< 				limit: 10,
< 				detail: false,
< 			}).then(searchedUsers => {
< 				users.value = searchedUsers as any[];
< 				fetching.value = false;
< 				// キャッシュ
< 				sessionStorage.setItem(cacheKey, JSON.stringify(searchedUsers));
< 			});
< 		}
< 	} else if (props.type === 'hashtag') {
< 		if (!props.q || props.q === '') {
< 			hashtags.value = JSON.parse(miLocalStorage.getItem('hashtags') || '[]');
< 			fetching.value = false;
< 		} else {
< 			const cacheKey = `autocomplete:hashtag:${props.q}`;
< 			const cache = sessionStorage.getItem(cacheKey);
< 			if (cache) {
< 				const hashtags = JSON.parse(cache);
< 				hashtags.value = hashtags;
< 				fetching.value = false;
< 			} else {
< 				os.api('hashtags/search', {
< 					query: props.q,
< 					limit: 30,
< 				}).then(searchedHashtags => {
< 					hashtags.value = searchedHashtags as any[];
< 					fetching.value = false;
< 					// キャッシュ
< 					sessionStorage.setItem(cacheKey, JSON.stringify(searchedHashtags));
< 				});
< 			}
< 		}
< 	} else if (props.type === 'emoji') {
< 		if (!props.q || props.q === '') {
< 			// 最近使った絵文字をサジェスト
< 			emojis.value = defaultStore.state.recentlyUsedEmojis.map(emoji => emojiDb.value.find(dbEmoji => dbEmoji.emoji === emoji)).filter(x => x) as EmojiDef[];
< 			return;
< 		}
---
>     if (cache) {
>       users.value = JSON.parse(cache);
>       fetching.value = false;
>     } else {
>       os.api("users/search-by-username-and-host", {
>         username: props.q,
>         limit: 10,
>         detail: false,
>       }).then((searchedUsers) => {
>         users.value = searchedUsers as any[];
>         fetching.value = false;
>         // キャッシュ
>         sessionStorage.setItem(cacheKey, JSON.stringify(searchedUsers));
>       });
>     }
>   } else if (props.type === "hashtag") {
>     if (!props.q || props.q === "") {
>       hashtags.value = JSON.parse(localStorage.getItem("hashtags") || "[]");
>       fetching.value = false;
>     } else {
>       const cacheKey = `autocomplete:hashtag:${props.q}`;
>       const cache = sessionStorage.getItem(cacheKey);
>       if (cache) {
>         const hashtags = JSON.parse(cache);
>         hashtags.value = hashtags;
>         fetching.value = false;
>       } else {
>         os.api("hashtags/search", {
>           query: props.q,
>           limit: 30,
>         }).then((searchedHashtags) => {
>           hashtags.value = searchedHashtags as any[];
>           fetching.value = false;
>           // キャッシュ
>           sessionStorage.setItem(cacheKey, JSON.stringify(searchedHashtags));
>         });
>       }
>     }
>   } else if (props.type === "emoji") {
>     if (!props.q || props.q === "") {
>       // 最近使った絵文字をサジェスト
>       emojis.value = defaultStore.state.recentlyUsedEmojis
>         .map((emoji) => emojiDb.find((dbEmoji) => dbEmoji.emoji === emoji))
>         .filter((x) => x) as EmojiDef[];
>       return;
>     }
240,241c288,289
< 		const matched: EmojiDef[] = [];
< 		const max = 30;
---
>     const matched: EmojiDef[] = [];
>     const max = 30;
243,246c291,299
< 		emojiDb.value.some(x => {
< 			if (x.name.startsWith(props.q ?? '') && !x.aliasOf && !matched.some(y => y.emoji === x.emoji)) matched.push(x);
< 			return matched.length === max;
< 		});
---
>     emojiDb.some((x) => {
>       if (
>         x.name.startsWith(props.q ?? "") &&
>         !x.aliasOf &&
>         !matched.some((y) => y.emoji === x.emoji)
>       )
>         matched.push(x);
>       return matched.length === max;
>     });
248,253c301,310
< 		if (matched.length < max) {
< 			emojiDb.value.some(x => {
< 				if (x.name.startsWith(props.q ?? '') && !matched.some(y => y.emoji === x.emoji)) matched.push(x);
< 				return matched.length === max;
< 			});
< 		}
---
>     if (matched.length < max) {
>       emojiDb.some((x) => {
>         if (
>           x.name.startsWith(props.q ?? "") &&
>           !matched.some((y) => y.emoji === x.emoji)
>         )
>           matched.push(x);
>         return matched.length === max;
>       });
>     }
255,260c312,321
< 		if (matched.length < max) {
< 			emojiDb.value.some(x => {
< 				if (x.name.includes(props.q ?? '') && !matched.some(y => y.emoji === x.emoji)) matched.push(x);
< 				return matched.length === max;
< 			});
< 		}
---
>     if (matched.length < max) {
>       emojiDb.some((x) => {
>         if (
>           x.name.includes(props.q ?? "") &&
>           !matched.some((y) => y.emoji === x.emoji)
>         )
>           matched.push(x);
>         return matched.length === max;
>       });
>     }
262,267c323,328
< 		emojis.value = matched;
< 	} else if (props.type === 'mfmTag') {
< 		if (!props.q || props.q === '') {
< 			mfmTags.value = MFM_TAGS;
< 			return;
< 		}
---
>     emojis.value = matched;
>   } else if (props.type === "mfmTag") {
>     if (!props.q || props.q === "") {
>       mfmTags.value = MFM_TAGS;
>       return;
>     }
269,270c330,331
< 		mfmTags.value = MFM_TAGS.filter(tag => tag.startsWith(props.q ?? ''));
< 	}
---
>     mfmTags.value = MFM_TAGS.filter((tag) => tag.startsWith(props.q ?? ""));
>   }
274c335,336
< 	if (!contains(rootEl.value, event.target) && (rootEl.value !== event.target)) props.close();
---
>   if (!contains(rootEl.value, event.target) && rootEl.value !== event.target)
>     props.close();
278,281c340,343
< 	const cancel = () => {
< 		event.preventDefault();
< 		event.stopPropagation();
< 	};
---
>   const cancel = () => {
>     event.preventDefault();
>     event.stopPropagation();
>   };
283,291c345,353
< 	switch (event.key) {
< 		case 'Enter':
< 			if (select.value !== -1) {
< 				cancel();
< 				(items.value[select.value] as any).click();
< 			} else {
< 				props.close();
< 			}
< 			break;
---
>   switch (event.key) {
>     case "Enter":
>       if (select.value !== -1) {
>         cancel();
>         (items.value[select.value] as any).click();
>       } else {
>         props.close();
>       }
>       break;
293,296c355,358
< 		case 'Escape':
< 			cancel();
< 			props.close();
< 			break;
---
>     case "Escape":
>       cancel();
>       props.close();
>       break;
298,305c360,367
< 		case 'ArrowUp':
< 			if (select.value !== -1) {
< 				cancel();
< 				selectPrev();
< 			} else {
< 				props.close();
< 			}
< 			break;
---
>     case "ArrowUp":
>       if (select.value !== -1) {
>         cancel();
>         selectPrev();
>       } else {
>         props.close();
>       }
>       break;
307,311c369,373
< 		case 'Tab':
< 		case 'ArrowDown':
< 			cancel();
< 			selectNext();
< 			break;
---
>     case "Tab":
>     case "ArrowDown":
>       cancel();
>       selectNext();
>       break;
313,316c375,378
< 		default:
< 			event.stopPropagation();
< 			props.textarea.focus();
< 	}
---
>     default:
>       event.stopPropagation();
>       props.textarea.focus();
>   }
320,322c382,384
< 	if (++select.value >= items.value.length) select.value = 0;
< 	if (items.value.length === 0) select.value = -1;
< 	applySelect();
---
>   if (++select.value >= items.value.length) select.value = 0;
>   if (items.value.length === 0) select.value = -1;
>   applySelect();
326,327c388,389
< 	if (--select.value < 0) select.value = items.value.length - 1;
< 	applySelect();
---
>   if (--select.value < 0) select.value = items.value.length - 1;
>   applySelect();
331,333c393,395
< 	for (const el of Array.from(items.value)) {
< 		el.removeAttribute('data-selected');
< 	}
---
>   for (const el of Array.from(items.value)) {
>     el.removeAttribute("data-selected");
>   }
335,338c397,400
< 	if (select.value !== -1) {
< 		items.value[select.value].setAttribute('data-selected', 'true');
< 		(items.value[select.value] as any).focus();
< 	}
---
>   if (select.value !== -1) {
>     items.value[select.value].setAttribute("data-selected", "true");
>     (items.value[select.value] as any).focus();
>   }
342,346c404,408
< 	props.close();
< 	os.selectUser().then(user => {
< 		complete('user', user);
< 		props.textarea.focus();
< 	});
---
>   props.close();
>   os.selectUser().then((user) => {
>     complete("user", user);
>     props.textarea.focus();
>   });
350,351c412,413
< 	setPosition();
< 	items.value = suggests.value?.children ?? [];
---
>   setPosition();
>   items.value = suggests.value?.children ?? [];
355c417
< 	setPosition();
---
>   setPosition();
357c419
< 	props.textarea.addEventListener('keydown', onKeydown);
---
>   props.textarea.addEventListener("keydown", onKeydown);
359,361c421,423
< 	for (const el of Array.from(document.querySelectorAll('body *'))) {
< 		el.addEventListener('mousedown', onMousedown);
< 	}
---
>   for (const el of Array.from(document.querySelectorAll("body *"))) {
>     el.addEventListener("mousedown", onMousedown);
>   }
363,364c425,426
< 	nextTick(() => {
< 		exec();
---
>   nextTick(() => {
>     exec();
366,371c428,436
< 		watch(() => props.q, () => {
< 			nextTick(() => {
< 				exec();
< 			});
< 		});
< 	});
---
>     watch(
>       () => props.q,
>       () => {
>         nextTick(() => {
>           exec();
>         });
>       }
>     );
>   });
375c440
< 	props.textarea.removeEventListener('keydown', onKeydown);
---
>   props.textarea.removeEventListener("keydown", onKeydown);
377,379c442,444
< 	for (const el of Array.from(document.querySelectorAll('body *'))) {
< 		el.removeEventListener('mousedown', onMousedown);
< 	}
---
>   for (const el of Array.from(document.querySelectorAll("body *"))) {
>     el.removeEventListener("mousedown", onMousedown);
>   }
383,390c448,454
< <style lang="scss" module>
< .root {
< 	position: fixed;
< 	max-width: 100%;
< 	margin-top: calc(1em + 8px);
< 	overflow: clip;
< 	transition: top 0.1s ease, left 0.1s ease;
< }
---
> <style lang="scss" scoped>
> .swhvrteh {
>   position: fixed;
>   max-width: 100%;
>   margin-top: calc(1em + 8px);
>   overflow: hidden;
>   transition: top 0.1s ease, left 0.1s ease;
392,400c456,463
< .list {
< 	display: block;
< 	margin: 0;
< 	padding: 4px 0;
< 	max-height: 190px;
< 	max-width: 500px;
< 	overflow: auto;
< 	list-style: none;
< }
---
>   > ol {
>     display: block;
>     margin: 0;
>     padding: 4px 0;
>     max-height: 190px;
>     max-width: 500px;
>     overflow: auto;
>     list-style: none;
402,412c465,472
< .item {
< 	display: flex;
< 	align-items: center;
< 	padding: 4px 12px;
< 	white-space: nowrap;
< 	overflow: clip;
< 	font-size: 0.9em;
< 	cursor: default;
< 	user-select: none;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
---
>     > li {
>       display: flex;
>       align-items: center;
>       padding: 4px 12px;
>       white-space: nowrap;
>       overflow: hidden;
>       font-size: 0.9em;
>       cursor: default;
414,416c474,477
< 	&:hover {
< 		background: var(--X3);
< 	}
---
>       &,
>       * {
>         user-select: none;
>       }
418,421c479,482
< 	&[data-selected='true'] {
< 		background: var(--accent);
< 		color: #fff !important;
< 	}
---
>       * {
>         overflow: hidden;
>         text-overflow: ellipsis;
>       }
423,427c484,486
< 	&:active {
< 		background: var(--accentDarken);
< 		color: #fff !important;
< 	}
< }
---
>       &:hover {
>         background: var(--X3);
>       }
429,436c488,489
< .avatar {
< 	min-width: 28px;
< 	min-height: 28px;
< 	max-width: 28px;
< 	max-height: 28px;
< 	margin: 0 8px 0 0;
< 	border-radius: 100%;
< }
---
>       &[data-selected="true"] {
>         background: var(--accent);
438,440c491,495
< .userName {
< 	margin: 0 8px 0 0;
< }
---
>         &,
>         * {
>           color: #fff !important;
>         }
>       }
442,452c497,498
< .emoji {
< 	flex-shrink: 0 !important;
< 	display: flex !important;
< 	margin: 0 4px 0 0 !important;
< 	height: 24px !important;
< 	width: 24px !important;
< 	justify-content: center !important;
< 	align-items: center !important;
< 	font-size: 20px !important;
< 	pointer-events: none !important;
< }
---
>       &:active {
>         background: var(--accentDarken);
454,458c500,506
< .emojiImg {
< 	height: 24px;
< 	width: 24px;
< 	object-fit: scale-down;
< }
---
>         &,
>         * {
>           color: #fff !important;
>         }
>       }
>     }
>   }
460,462c508,516
< .emojiName {
< 	flex-shrink: 1;
< }
---
>   > .users > li {
>     .avatar {
>       min-width: 28px;
>       min-height: 28px;
>       max-width: 28px;
>       max-height: 28px;
>       margin: 0 8px 0 0;
>       border-radius: 100%;
>     }
464,466c518,543
< .emojiAlias {
< 	flex-shrink: 9999999;
< 	margin: 0 0 0 8px;
---
>     .name {
>       margin: 0 8px 0 0;
>     }
>   }
> 
>   > .emojis > li {
>     .emoji {
>       display: inline-block;
>       margin: 0 4px 0 0;
>       width: 24px;
> 
>       > img {
>         width: 24px;
>         vertical-align: bottom;
>       }
>     }
> 
>     .alias {
>       margin: 0 0 0 8px;
>     }
>   }
> 
>   > .mfmTags > li {
>     .name {
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkAvatars.vue RiricaV13/components/MkAvatars.vue
2,6c2,19
< <div>
< 	<div v-for="user in users" :key="user.id" style="display:inline-block;width:32px;height:32px;margin-right:8px;">
< 		<MkAvatar :user="user" style="width:32px;height:32px;" indicator link preview/>
< 	</div>
< </div>
---
>   <div>
>     <div
>       v-for="user in users"
>       :key="user.id"
>       style="
>         display: inline-block;
>         width: 32px;
>         height: 32px;
>         margin-right: 8px;
>       "
>     >
>       <MkAvatar
>         :user="user"
>         style="width: 32px; height: 32px"
>         :show-indicator="true"
>       />
>     </div>
>   </div>
10,11c23,24
< import { onMounted, ref } from 'vue';
< import * as os from '@/os';
---
> import { onMounted, ref } from "vue";
> import * as os from "@/os";
14c27
< 	userIds: string[];
---
>   userIds: string[];
20,22c33,35
< 	users.value = await os.api('users/show', {
< 		userIds: props.userIds,
< 	});
---
>   users.value = await os.api("users/show", {
>     userIds: props.userIds,
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkButton.vue RiricaV13/components/MkButton.vue
2,25c2,26
< <button
< 	v-if="!link"
< 	ref="el" class="_button"
< 	:class="[$style.root, { [$style.inline]: inline, [$style.primary]: primary, [$style.gradate]: gradate, [$style.danger]: danger, [$style.rounded]: rounded, [$style.full]: full, [$style.small]: small, [$style.large]: large, [$style.asLike]: asLike }]"
< 	:type="type"
< 	@click="emit('click', $event)"
< 	@mousedown="onMousedown"
< >
< 	<div ref="ripples" :class="$style.ripples"></div>
< 	<div :class="$style.content">
< 		<slot></slot>
< 	</div>
< </button>
< <MkA
< 	v-else class="_button"
< 	:class="[$style.root, { [$style.inline]: inline, [$style.primary]: primary, [$style.gradate]: gradate, [$style.danger]: danger, [$style.rounded]: rounded, [$style.full]: full, [$style.small]: small, [$style.large]: large, [$style.asLike]: asLike }]"
< 	:to="to"
< 	@mousedown="onMousedown"
< >
< 	<div ref="ripples" :class="$style.ripples"></div>
< 	<div :class="$style.content">
< 		<slot></slot>
< 	</div>
< </MkA>
---
>   <button
>     v-if="!link"
>     class="bghgjjyj _button"
>     :class="{ inline, primary, gradate, danger, rounded, full }"
>     :type="type"
>     @click="emit('click', $event)"
>     @mousedown="onMousedown"
>   >
>     <div ref="ripples" class="ripples"></div>
>     <div class="content">
>       <slot></slot>
>     </div>
>   </button>
>   <MkA
>     v-else
>     class="bghgjjyj _button"
>     :class="{ inline, primary, gradate, danger, rounded, full }"
>     :to="to"
>     @mousedown="onMousedown"
>   >
>     <div ref="ripples" class="ripples"></div>
>     <div class="content">
>       <slot></slot>
>     </div>
>   </MkA>
29c30
< import { nextTick, onMounted, useCssModule } from 'vue';
---
> import { nextTick, onMounted } from "vue";
31,32d31
< const $style = useCssModule();
< 
34,47c33,43
< 	type?: 'button' | 'submit' | 'reset';
< 	primary?: boolean;
< 	gradate?: boolean;
< 	rounded?: boolean;
< 	inline?: boolean;
< 	link?: boolean;
< 	to?: string;
< 	autofocus?: boolean;
< 	wait?: boolean;
< 	danger?: boolean;
< 	full?: boolean;
< 	small?: boolean;
< 	large?: boolean;
< 	asLike?: boolean;
---
>   type?: "button" | "submit" | "reset";
>   primary?: boolean;
>   gradate?: boolean;
>   rounded?: boolean;
>   inline?: boolean;
>   link?: boolean;
>   to?: string;
>   autofocus?: boolean;
>   wait?: boolean;
>   danger?: boolean;
>   full?: boolean;
51c47
< 	(ev: 'click', payload: MouseEvent): void;
---
>   (ev: "click", payload: MouseEvent): void;
54,55c50,51
< let el = $shallowRef<HTMLElement | null>(null);
< let ripples = $shallowRef<HTMLElement | null>(null);
---
> let el = $ref<HTMLElement | null>(null);
> let ripples = $ref<HTMLElement | null>(null);
58,62c54,58
< 	if (props.autofocus) {
< 		nextTick(() => {
< 			el!.focus();
< 		});
< 	}
---
>   if (props.autofocus) {
>     nextTick(() => {
>       el!.focus();
>     });
>   }
66c62
< 	return Math.hypot(p.x - q.x, p.y - q.y);
---
>   return Math.hypot(p.x - q.x, p.y - q.y);
70,75c66,71
< 	const origin = { x: circleCenterX, y: circleCenterY };
< 	const dist1 = distance({ x: 0, y: 0 }, origin);
< 	const dist2 = distance({ x: boxW, y: 0 }, origin);
< 	const dist3 = distance({ x: 0, y: boxH }, origin);
< 	const dist4 = distance({ x: boxW, y: boxH }, origin);
< 	return Math.max(dist1, dist2, dist3, dist4) * 2;
---
>   const origin = { x: circleCenterX, y: circleCenterY };
>   const dist1 = distance({ x: 0, y: 0 }, origin);
>   const dist2 = distance({ x: boxW, y: 0 }, origin);
>   const dist3 = distance({ x: 0, y: boxH }, origin);
>   const dist4 = distance({ x: boxW, y: boxH }, origin);
>   return Math.max(dist1, dist2, dist3, dist4) * 2;
79,80c75,76
< 	const target = evt.target! as HTMLElement;
< 	const rect = target.getBoundingClientRect();
---
>   const target = evt.target! as HTMLElement;
>   const rect = target.getBoundingClientRect();
82,85c78,80
< 	const ripple = document.createElement('div');
< 	ripple.classList.add($style.ripple);
< 	ripple.style.top = (evt.clientY - rect.top - 1).toString() + 'px';
< 	ripple.style.left = (evt.clientX - rect.left - 1).toString() + 'px';
---
>   const ripple = document.createElement("div");
>   ripple.style.top = (evt.clientY - rect.top - 1).toString() + "px";
>   ripple.style.left = (evt.clientX - rect.left - 1).toString() + "px";
87c82
< 	ripples!.appendChild(ripple);
---
>   ripples!.appendChild(ripple);
89,90c84,85
< 	const circleCenterX = evt.clientX - rect.left;
< 	const circleCenterY = evt.clientY - rect.top;
---
>   const circleCenterX = evt.clientX - rect.left;
>   const circleCenterY = evt.clientY - rect.top;
92c87,92
< 	const scale = calcCircleScale(target.clientWidth, target.clientHeight, circleCenterX, circleCenterY);
---
>   const scale = calcCircleScale(
>     target.clientWidth,
>     target.clientHeight,
>     circleCenterX,
>     circleCenterY
>   );
94,103c94,103
< 	window.setTimeout(() => {
< 		ripple.style.transform = 'scale(' + (scale / 2) + ')';
< 	}, 1);
< 	window.setTimeout(() => {
< 		ripple.style.transition = 'all 1s ease';
< 		ripple.style.opacity = '0';
< 	}, 1000);
< 	window.setTimeout(() => {
< 		if (ripples) ripples.removeChild(ripple);
< 	}, 2000);
---
>   window.setTimeout(() => {
>     ripple.style.transform = "scale(" + scale / 2 + ")";
>   }, 1);
>   window.setTimeout(() => {
>     ripple.style.transition = "all 1s ease";
>     ripple.style.opacity = "0";
>   }, 1000);
>   window.setTimeout(() => {
>     if (ripples) ripples.removeChild(ripple);
>   }, 2000);
107,124c107,124
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	z-index: 1; // 他コンポーネントのbox-shadowに隠されないようにするため
< 	display: block;
< 	min-width: 100px;
< 	width: max-content;
< 	padding: 7px 14px;
< 	text-align: center;
< 	font-weight: normal;
< 	font-size: 95%;
< 	box-shadow: none;
< 	text-decoration: none;
< 	background: var(--buttonBg);
< 	border-radius: 5px;
< 	overflow: clip;
< 	box-sizing: border-box;
< 	transition: background 0.1s ease;
---
> <style lang="scss" scoped>
> .bghgjjyj {
>   position: relative;
>   z-index: 1; // 他コンポーネントのbox-shadowに隠されないようにするため
>   display: block;
>   min-width: 100px;
>   width: max-content;
>   padding: 8px 16px;
>   text-align: center;
>   font-weight: normal;
>   font-size: 1em;
>   box-shadow: none;
>   text-decoration: none;
>   background: var(--buttonBg);
>   border-radius: 5px;
>   overflow: clip;
>   box-sizing: border-box;
>   transition: background 0.1s ease;
126,128c126,128
< 	&:not(:disabled):hover {
< 		background: var(--buttonHoverBg);
< 	}
---
>   &:not(:disabled):hover {
>     background: var(--buttonHoverBg);
>   }
130,132c130,132
< 	&:not(:disabled):active {
< 		background: var(--buttonHoverBg);
< 	}
---
>   &:not(:disabled):active {
>     background: var(--buttonHoverBg);
>   }
134,137c134,136
< 	&.small {
< 		font-size: 90%;
< 		padding: 6px 12px;
< 	}
---
>   &.full {
>     width: 100%;
>   }
139,142c138,140
< 	&.large {
< 		font-size: 100%;
< 		padding: 8px 16px;
< 	}
---
>   &.rounded {
>     border-radius: 999px;
>   }
144,146c142,145
< 	&.full {
< 		width: 100%;
< 	}
---
>   &.primary {
>     font-weight: bold;
>     color: var(--fgOnAccent) !important;
>     background: var(--accent);
148,150c147,149
< 	&.rounded {
< 		border-radius: 999px;
< 	}
---
>     &:not(:disabled):hover {
>       background: var(--X8);
>     }
152,155c151,154
< 	&.primary {
< 		font-weight: bold;
< 		color: var(--fgOnAccent) !important;
< 		background: var(--accent);
---
>     &:not(:disabled):active {
>       background: var(--X8);
>     }
>   }
157,159c156,163
< 		&:not(:disabled):hover {
< 			background: var(--X8);
< 		}
---
>   &.gradate {
>     font-weight: bold;
>     color: var(--fgOnAccent) !important;
>     background: linear-gradient(
>       90deg,
>       var(--buttonGradateA),
>       var(--buttonGradateB)
>     );
161,164c165,167
< 		&:not(:disabled):active {
< 			background: var(--X8);
< 		}
< 	}
---
>     &:not(:disabled):hover {
>       background: linear-gradient(90deg, var(--X8), var(--X8));
>     }
166,168c169,172
< 	&.asLike {
< 		background: rgba(255, 86, 125, 0.07);
< 		color: #ff002f;
---
>     &:not(:disabled):active {
>       background: linear-gradient(90deg, var(--X8), var(--X8));
>     }
>   }
170,172c174,175
< 		&:not(:disabled):hover {
< 			background: rgba(255, 74, 116, 0.11);
< 		}
---
>   &.danger {
>     color: #ff2a2a;
174,176c177,179
< 		&:not(:disabled):active {
< 			background: rgba(224, 57, 96, 0.125);
< 		}
---
>     &.primary {
>       color: #fff;
>       background: #ff2a2a;
178,182c181,183
< 		> .ripples {
< 			> .ripple {
< 				background: rgba(255, 60, 106, 0.15);
< 			}
< 		}
---
>       &:not(:disabled):hover {
>         background: #ff4242;
>       }
184,185c185,189
< 		&.primary {
< 			background: rgb(241 97 132);
---
>       &:not(:disabled):active {
>         background: #d42e2e;
>       }
>     }
>   }
187,189c191,193
< 			&:not(:disabled):hover {
< 				background: rgb(241 92 128);
< 			}
---
>   &:disabled {
>     opacity: 0.7;
>   }
191,195c195,198
< 			&:not(:disabled):active {
< 				background: rgb(241 92 128);
< 			}
< 		}
< 	}
---
>   &:focus-visible {
>     outline: solid 2px var(--focus);
>     outline-offset: 2px;
>   }
197,200c200,204
< 	&.gradate {
< 		font-weight: bold;
< 		color: var(--fgOnAccent) !important;
< 		background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
---
>   &.inline {
>     display: inline-block;
>     width: auto;
>     min-width: 100px;
>   }
202,204c206,214
< 		&:not(:disabled):hover {
< 			background: linear-gradient(90deg, var(--X8), var(--X8));
< 		}
---
>   > .ripples {
>     position: absolute;
>     z-index: 0;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     border-radius: 6px;
>     overflow: hidden;
206,209c216,226
< 		&:not(:disabled):active {
< 			background: linear-gradient(90deg, var(--X8), var(--X8));
< 		}
< 	}
---
>     ::v-deep(div) {
>       position: absolute;
>       width: 2px;
>       height: 2px;
>       border-radius: 100%;
>       background: rgba(0, 0, 0, 0.1);
>       opacity: 1;
>       transform: scale(1);
>       transition: all 0.5s cubic-bezier(0, 0.5, 0, 1);
>     }
>   }
211,212c228,230
< 	&.danger {
< 		color: #ff2a2a;
---
>   &.primary > .ripples ::v-deep(div) {
>     background: rgba(0, 0, 0, 0.15);
>   }
214,274c232,235
< 		&.primary {
< 			color: #fff;
< 			background: #ff2a2a;
< 
< 			&:not(:disabled):hover {
< 				background: #ff4242;
< 			}
< 
< 			&:not(:disabled):active {
< 				background: #d42e2e;
< 			}
< 		}
< 	}
< 
< 	&:disabled {
< 		opacity: 0.7;
< 	}
< 
< 	&:focus-visible {
< 		outline: solid 2px var(--focus);
< 		outline-offset: 2px;
< 	}
< 
< 	&.inline {
< 		display: inline-block;
< 		width: auto;
< 		min-width: 100px;
< 	}
< 
< 	&.primary > .ripples > .ripple {
< 		background: rgba(0, 0, 0, 0.15);
< 	}
< }
< 
< .ripples {
< 	position: absolute;
< 	z-index: 0;
< 	top: 0;
< 	left: 0;
< 	width: 100%;
< 	height: 100%;
< 	border-radius: 6px;
< 	overflow: clip;
< 	pointer-events: none;
< }
< 
< .ripple {
< 	position: absolute;
< 	width: 2px;
< 	height: 2px;
< 	border-radius: 100%;
< 	background: rgba(0, 0, 0, 0.1);
< 	opacity: 1;
< 	transform: scale(1);
< 	transition: all 0.5s cubic-bezier(0,.5,0,1);
< }
< 
< .content {
< 	position: relative;
< 	z-index: 1;
< 	pointer-events: none;
---
>   > .content {
>     position: relative;
>     z-index: 1;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkCaptcha.vue RiricaV13/components/MkCaptcha.vue
2,5c2,5
< <div>
< 	<span v-if="!available">{{ i18n.ts.waiting }}<MkEllipsis/></span>
< 	<div ref="captchaEl"></div>
< </div>
---
>   <div>
>     <span v-if="!available">{{ i18n.ts.waiting }}<MkEllipsis /></span>
>     <div ref="captchaEl"></div>
>   </div>
9,11c9,11
< import { ref, shallowRef, computed, onMounted, onBeforeUnmount, watch } from 'vue';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
---
> import { ref, computed, onMounted, onBeforeUnmount, watch } from "vue";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
14,20c14,33
< 	render(container: string | Node, options: {
< 		readonly [_ in 'sitekey' | 'theme' | 'type' | 'size' | 'tabindex' | 'callback' | 'expired' | 'expired-callback' | 'error-callback' | 'endpoint']?: unknown;
< 	}): string;
< 	remove(id: string): void;
< 	execute(id: string): void;
< 	reset(id?: string): void;
< 	getResponse(id: string): string;
---
>   render(
>     container: string | Node,
>     options: {
>       readonly [_ in
>         | "sitekey"
>         | "theme"
>         | "type"
>         | "size"
>         | "tabindex"
>         | "callback"
>         | "expired"
>         | "expired-callback"
>         | "error-callback"
>         | "endpoint"]?: unknown;
>     }
>   ): string;
>   remove(id: string): void;
>   execute(id: string): void;
>   reset(id?: string): void;
>   getResponse(id: string): string;
23c36
< type CaptchaProvider = 'hcaptcha' | 'recaptcha' | 'turnstile';
---
> type CaptchaProvider = "hcaptcha" | "recaptcha" | "turnstile";
26c39
< 	readonly [_ in CaptchaProvider]?: Captcha;
---
>   readonly [_ in CaptchaProvider]?: Captcha;
30c43
< 	interface Window extends CaptchaContainer { }
---
>   interface Window extends CaptchaContainer {}
34,36c47,49
< 	provider: CaptchaProvider;
< 	sitekey: string;
< 	modelValue?: string | null;
---
>   provider: CaptchaProvider;
>   sitekey: string;
>   modelValue?: string | null;
40c53
< 	(ev: 'update:modelValue', v: string | null): void;
---
>   (ev: "update:modelValue", v: string | null): void;
45c58
< const captchaEl = shallowRef<HTMLDivElement | undefined>();
---
> const captchaEl = ref<HTMLDivElement | undefined>();
48,52c61,68
< 	switch (props.provider) {
< 		case 'hcaptcha': return 'hcaptcha';
< 		case 'recaptcha': return 'grecaptcha';
< 		case 'turnstile': return 'turnstile';
< 	}
---
>   switch (props.provider) {
>     case "hcaptcha":
>       return "hcaptcha";
>     case "recaptcha":
>       return "grecaptcha";
>     case "turnstile":
>       return "turnstile";
>   }
58,62c74,81
< 	switch (props.provider) {
< 		case 'hcaptcha': return 'https://js.hcaptcha.com/1/api.js?render=explicit&recaptchacompat=off';
< 		case 'recaptcha': return 'https://www.recaptcha.net/recaptcha/api.js?render=explicit';
< 		case 'turnstile': return 'https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit';
< 	}
---
>   switch (props.provider) {
>     case "hcaptcha":
>       return "https://js.hcaptcha.com/1/api.js?render=explicit&recaptchacompat=off";
>     case "recaptcha":
>       return "https://www.recaptcha.net/recaptcha/api.js?render=explicit";
>     case "turnstile":
>       return "https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit";
>   }
65c84,86
< const scriptId = computed(() => `script-${props.provider}`);
---
> const captcha = computed<Captcha>(
>   () => window[variable.value] || ({} as unknown as Captcha)
> );
67,68d87
< const captcha = computed<Captcha>(() => window[variable.value] || {} as unknown as Captcha);
< 
70c89
< 	available.value = true;
---
>   available.value = true;
72,77c91,100
< 	(document.getElementById(scriptId.value) || document.head.appendChild(Object.assign(document.createElement('script'), {
< 		async: true,
< 		id: scriptId.value,
< 		src: src.value,
< 	})))
< 		.addEventListener('load', () => available.value = true);
---
>   (
>     document.getElementById(props.provider) ||
>     document.head.appendChild(
>       Object.assign(document.createElement("script"), {
>         async: true,
>         id: props.provider,
>         src: src.value,
>       })
>     )
>   ).addEventListener("load", () => (available.value = true));
81c104
< 	if (captcha.value.reset) captcha.value.reset();
---
>   if (captcha.value.reset) captcha.value.reset();
85,95c108,118
< 	if (captcha.value.render && captchaEl.value instanceof Element) {
< 		captcha.value.render(captchaEl.value, {
< 			sitekey: props.sitekey,
< 			theme: defaultStore.state.darkMode ? 'dark' : 'light',
< 			callback: callback,
< 			'expired-callback': callback,
< 			'error-callback': callback,
< 		});
< 	} else {
< 		window.setTimeout(requestRender, 1);
< 	}
---
>   if (captcha.value.render && captchaEl.value instanceof Element) {
>     captcha.value.render(captchaEl.value, {
>       sitekey: props.sitekey,
>       theme: defaultStore.state.darkMode ? "dark" : "light",
>       callback: callback,
>       "expired-callback": callback,
>       "error-callback": callback,
>     });
>   } else {
>     window.setTimeout(requestRender, 1);
>   }
99c122
< 	emit('update:modelValue', typeof response === 'string' ? response : null);
---
>   emit("update:modelValue", typeof response === "string" ? response : null);
103,107c126,130
< 	if (available.value) {
< 		requestRender();
< 	} else {
< 		watch(available, requestRender);
< 	}
---
>   if (available.value) {
>     requestRender();
>   } else {
>     watch(available, requestRender);
>   }
111c134
< 	reset();
---
>   reset();
115c138
< 	reset,
---
>   reset,
117d139
< 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkChannelFollowButton.vue RiricaV13/components/MkChannelFollowButton.vue
2,19c2,22
< <button
< 	class="hdcaacmi _button"
< 	:class="{ wait, active: isFollowing, full }"
< 	:disabled="wait"
< 	@click="onClick"
< >
< 	<template v-if="!wait">
< 		<template v-if="isFollowing">
< 			<span v-if="full">{{ i18n.ts.unfollow }}</span><i class="ti ti-minus"></i>
< 		</template>
< 		<template v-else>
< 			<span v-if="full">{{ i18n.ts.follow }}</span><i class="ti ti-plus"></i>
< 		</template>
< 	</template>
< 	<template v-else>
< 		<span v-if="full">{{ i18n.ts.processing }}</span><MkLoading :em="true"/>
< 	</template>
< </button>
---
>   <button
>     class="hdcaacmi _button"
>     :class="{ wait, active: isFollowing, full }"
>     :disabled="wait"
>     @click="onClick"
>   >
>     <template v-if="!wait">
>       <template v-if="isFollowing">
>         <span v-if="full">{{ i18n.ts.unfollow }}</span
>         ><i class="fas fa-minus"></i>
>       </template>
>       <template v-else>
>         <span v-if="full">{{ i18n.ts.follow }}</span
>         ><i class="fas fa-plus"></i>
>       </template>
>     </template>
>     <template v-else>
>       <span v-if="full">{{ i18n.ts.processing }}</span
>       ><i class="fas fa-spinner fa-pulse fa-fw"></i>
>     </template>
>   </button>
23,25c26,28
< import { ref } from 'vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
27,32c30,38
< const props = withDefaults(defineProps<{
< 	channel: Record<string, any>;
< 	full?: boolean;
< }>(), {
< 	full: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     channel: Record<string, any>;
>     full?: boolean;
>   }>(),
>   {
>     full: false,
>   }
> );
38c44
< 	wait.value = true;
---
>   wait.value = true;
40,56c46,62
< 	try {
< 		if (isFollowing.value) {
< 			await os.api('channels/unfollow', {
< 				channelId: props.channel.id,
< 			});
< 			isFollowing.value = false;
< 		} else {
< 			await os.api('channels/follow', {
< 				channelId: props.channel.id,
< 			});
< 			isFollowing.value = true;
< 		}
< 	} catch (err) {
< 		console.error(err);
< 	} finally {
< 		wait.value = false;
< 	}
---
>   try {
>     if (isFollowing.value) {
>       await os.api("channels/unfollow", {
>         channelId: props.channel.id,
>       });
>       isFollowing.value = false;
>     } else {
>       await os.api("channels/follow", {
>         channelId: props.channel.id,
>       });
>       isFollowing.value = true;
>     }
>   } catch (err) {
>     console.error(err);
>   } finally {
>     wait.value = false;
>   }
62,72c68,78
< 	position: relative;
< 	display: inline-block;
< 	font-weight: bold;
< 	color: var(--accent);
< 	background: transparent;
< 	border: solid 1px var(--accent);
< 	padding: 0;
< 	height: 31px;
< 	font-size: 16px;
< 	border-radius: 32px;
< 	background: #fff;
---
>   position: relative;
>   display: inline-block;
>   font-weight: bold;
>   color: var(--accent);
>   background: transparent;
>   border: solid 1px var(--accent);
>   padding: 0;
>   height: 31px;
>   font-size: 16px;
>   border-radius: 32px;
>   background: #fff;
74,77c80,83
< 	&.full {
< 		padding: 0 8px 0 12px;
< 		font-size: 14px;
< 	}
---
>   &.full {
>     padding: 0 8px 0 12px;
>     font-size: 14px;
>   }
79,81c85,87
< 	&:not(.full) {
< 		width: 31px;
< 	}
---
>   &:not(.full) {
>     width: 31px;
>   }
83,95c89,101
< 	&:focus-visible {
< 		&:after {
< 			content: "";
< 			pointer-events: none;
< 			position: absolute;
< 			top: -5px;
< 			right: -5px;
< 			bottom: -5px;
< 			left: -5px;
< 			border: 2px solid var(--focus);
< 			border-radius: 32px;
< 		}
< 	}
---
>   &:focus-visible {
>     &:after {
>       content: "";
>       pointer-events: none;
>       position: absolute;
>       top: -5px;
>       right: -5px;
>       bottom: -5px;
>       left: -5px;
>       border: 2px solid var(--focus);
>       border-radius: 32px;
>     }
>   }
97,99c103,105
< 	&:hover {
< 		//background: mix($primary, #fff, 20);
< 	}
---
>   &:hover {
>     //background: mix($primary, #fff, 20);
>   }
101,103c107,109
< 	&:active {
< 		//background: mix($primary, #fff, 40);
< 	}
---
>   &:active {
>     //background: mix($primary, #fff, 40);
>   }
105,107c111,113
< 	&.active {
< 		color: #fff;
< 		background: var(--accent);
---
>   &.active {
>     color: #fff;
>     background: var(--accent);
109,112c115,118
< 		&:hover {
< 			background: var(--accentLighten);
< 			border-color: var(--accentLighten);
< 		}
---
>     &:hover {
>       background: var(--accentLighten);
>       border-color: var(--accentLighten);
>     }
114,118c120,124
< 		&:active {
< 			background: var(--accentDarken);
< 			border-color: var(--accentDarken);
< 		}
< 	}
---
>     &:active {
>       background: var(--accentDarken);
>       border-color: var(--accentDarken);
>     }
>   }
120,123c126,129
< 	&.wait {
< 		cursor: wait !important;
< 		opacity: 0.7;
< 	}
---
>   &.wait {
>     cursor: wait !important;
>     opacity: 0.7;
>   }
125,127c131,133
< 	> span {
< 		margin-right: 6px;
< 	}
---
>   > span {
>     margin-right: 6px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkChannelPreview.vue RiricaV13/components/MkChannelPreview.vue
2,33c2,49
< <MkA :to="`/channels/${channel.id}`" class="eftoefju _panel" tabindex="-1">
< 	<div class="banner" :style="bannerStyle">
< 		<div class="fade"></div>
< 		<div class="name"><i class="ti ti-device-tv"></i> {{ channel.name }}</div>
< 		<div class="status">
< 			<div>
< 				<i class="ti ti-users ti-fw"></i>
< 				<I18n :src="i18n.ts._channel.usersCount" tag="span" style="margin-left: 4px;">
< 					<template #n>
< 						<b>{{ channel.usersCount }}</b>
< 					</template>
< 				</I18n>
< 			</div>
< 			<div>
< 				<i class="ti ti-pencil ti-fw"></i>
< 				<I18n :src="i18n.ts._channel.notesCount" tag="span" style="margin-left: 4px;">
< 					<template #n>
< 						<b>{{ channel.notesCount }}</b>
< 					</template>
< 				</I18n>
< 			</div>
< 		</div>
< 	</div>
< 	<article v-if="channel.description">
< 		<p :title="channel.description">{{ channel.description.length > 85 ? channel.description.slice(0, 85) + '…' : channel.description }}</p>
< 	</article>
< 	<footer>
< 		<span v-if="channel.lastNotedAt">
< 			{{ i18n.ts.updatedAt }}: <MkTime :time="channel.lastNotedAt"/>
< 		</span>
< 	</footer>
< </MkA>
---
>   <MkA :to="`/channels/${channel.id}`" class="eftoefju _panel" tabindex="-1">
>     <div class="banner" :style="bannerStyle">
>       <div class="fade"></div>
>       <div class="name">
>         <i class="fas fa-satellite-dish"></i> {{ channel.name }}
>       </div>
>       <div class="status">
>         <div>
>           <i class="fas fa-users fa-fw"></i>
>           <I18n
>             :src="i18n.ts._channel.usersCount"
>             tag="span"
>             style="margin-left: 4px"
>           >
>             <template #n>
>               <b>{{ channel.usersCount }}</b>
>             </template>
>           </I18n>
>         </div>
>         <div>
>           <i class="fas fa-pencil-alt fa-fw"></i>
>           <I18n
>             :src="i18n.ts._channel.notesCount"
>             tag="span"
>             style="margin-left: 4px"
>           >
>             <template #n>
>               <b>{{ channel.notesCount }}</b>
>             </template>
>           </I18n>
>         </div>
>       </div>
>     </div>
>     <article v-if="channel.description">
>       <p :title="channel.description">
>         {{
>           channel.description.length > 85
>             ? channel.description.slice(0, 85) + "…"
>             : channel.description
>         }}
>       </p>
>     </article>
>     <footer>
>       <span v-if="channel.lastNotedAt">
>         {{ i18n.ts.updatedAt }}: <MkTime :time="channel.lastNotedAt" />
>       </span>
>     </footer>
>   </MkA>
37,38c53,54
< import { computed } from 'vue';
< import { i18n } from '@/i18n';
---
> import { computed } from "vue";
> import { i18n } from "@/i18n";
41c57
< 	channel: Record<string, any>;
---
>   channel: Record<string, any>;
45,49c61,65
< 	if (props.channel.bannerUrl) {
< 		return { backgroundImage: `url(${props.channel.bannerUrl})` };
< 	} else {
< 		return { backgroundColor: '#4c5e6d' };
< 	}
---
>   if (props.channel.bannerUrl) {
>     return { backgroundImage: `url(${props.channel.bannerUrl})` };
>   } else {
>     return { backgroundColor: "#4c5e6d" };
>   }
55,57c71,73
< 	display: block;
< 	overflow: hidden;
< 	width: 100%;
---
>   display: block;
>   overflow: hidden;
>   width: 100%;
59,61c75,77
< 	&:hover {
< 		text-decoration: none;
< 	}
---
>   &:hover {
>     text-decoration: none;
>   }
63,68c79,84
< 	> .banner {
< 		position: relative;
< 		width: 100%;
< 		height: 200px;
< 		background-position: center;
< 		background-size: cover;
---
>   > .banner {
>     position: relative;
>     width: 100%;
>     height: 200px;
>     background-position: center;
>     background-size: cover;
70,77c86,93
< 		> .fade {
< 			position: absolute;
< 			bottom: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 64px;
< 			background: linear-gradient(0deg, var(--panel), var(--X15));
< 		}
---
>     > .fade {
>       position: absolute;
>       bottom: 0;
>       left: 0;
>       width: 100%;
>       height: 64px;
>       background: linear-gradient(0deg, var(--panel), var(--X15));
>     }
79,87c95,103
< 		> .name {
< 			position: absolute;
< 			top: 16px;
< 			left: 16px;
< 			padding: 12px 16px;
< 			background: rgba(0, 0, 0, 0.7);
< 			color: #fff;
< 			font-size: 1.2em;
< 		}
---
>     > .name {
>       position: absolute;
>       top: 16px;
>       left: 16px;
>       padding: 12px 16px;
>       background: rgba(0, 0, 0, 0.7);
>       color: #fff;
>       font-size: 1.2em;
>     }
89,100c105,116
< 		> .status {
< 			position: absolute;
< 			z-index: 1;
< 			bottom: 16px;
< 			right: 16px;
< 			padding: 8px 12px;
< 			font-size: 80%;
< 			background: rgba(0, 0, 0, 0.7);
< 			border-radius: 6px;
< 			color: #fff;
< 		}
< 	}
---
>     > .status {
>       position: absolute;
>       z-index: 1;
>       bottom: 16px;
>       right: 16px;
>       padding: 8px 12px;
>       font-size: 80%;
>       background: rgba(0, 0, 0, 0.7);
>       border-radius: 6px;
>       color: #fff;
>     }
>   }
102,103c118,119
< 	> article {
< 		padding: 16px;
---
>   > article {
>     padding: 16px;
105,109c121,125
< 		> p {
< 			margin: 0;
< 			font-size: 1em;
< 		}
< 	}
---
>     > p {
>       margin: 0;
>       font-size: 1em;
>     }
>   }
111,113c127,129
< 	> footer {
< 		padding: 12px 16px;
< 		border-top: solid 0.5px var(--divider);
---
>   > footer {
>     padding: 12px 16px;
>     border-top: solid 0.5px var(--divider);
115,119c131,135
< 		> span {
< 			opacity: 0.7;
< 			font-size: 0.9em;
< 		}
< 	}
---
>     > span {
>       opacity: 0.7;
>       font-size: 0.9em;
>     }
>   }
121,122c137,138
< 	@media (max-width: 550px) {
< 		font-size: 0.9em;
---
>   @media (max-width: 550px) {
>     font-size: 0.9em;
124,125c140,141
< 		> .banner {
< 			height: 80px;
---
>     > .banner {
>       height: 80px;
127,130c143,146
< 			> .status {
< 				display: none;
< 			}
< 		}
---
>       > .status {
>         display: none;
>       }
>     }
132,134c148,150
< 		> article {
< 			padding: 12px;
< 		}
---
>     > article {
>       padding: 12px;
>     }
136,139c152,155
< 		> footer {
< 			display: none;
< 		}
< 	}
---
>     > footer {
>       display: none;
>     }
>   }
141,142c157,158
< 	@media (max-width: 500px) {
< 		font-size: 0.8em;
---
>   @media (max-width: 500px) {
>     font-size: 0.8em;
144,146c160,162
< 		> .banner {
< 			height: 70px;
< 		}
---
>     > .banner {
>       height: 70px;
>     }
148,151c164,167
< 		> article {
< 			padding: 8px;
< 		}
< 	}
---
>     > article {
>       padding: 8px;
>     }
>   }
153d168
< 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkChart.vue RiricaV13/components/MkChart.vue
2,8c2,7
< <div class="cbbedffa">
< 	<canvas ref="chartEl"></canvas>
< 	<MkChartLegend ref="legendEl" style="margin-top: 8px;"/>
< 	<div v-if="fetching" class="fetching">
< 		<MkLoading/>
< 	</div>
< </div>
---
>   <div class="cbbedffa">
>     <canvas ref="chartEl"></canvas>
>     <div v-if="fetching" class="fetching">
>       <MkLoading />
>     </div>
>   </div>
17,28c16,42
< import { onMounted, ref, shallowRef, watch, PropType, onUnmounted } from 'vue';
< import { Chart } from 'chart.js';
< import gradient from 'chartjs-plugin-gradient';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { useChartTooltip } from '@/scripts/use-chart-tooltip';
< import { chartVLine } from '@/scripts/chart-vline';
< import { alpha } from '@/scripts/color';
< import date from '@/filters/date';
< import { initChart } from '@/scripts/init-chart';
< import { chartLegend } from '@/scripts/chart-legend';
< import MkChartLegend from '@/components/MkChartLegend.vue';
---
> import { onMounted, ref, watch, PropType, onUnmounted } from "vue";
> import {
>   Chart,
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
> } from "chart.js";
> import "chartjs-adapter-date-fns";
> import { enUS } from "date-fns/locale";
> import zoomPlugin from "chartjs-plugin-zoom";
> // https://github.com/misskey-dev/misskey/pull/8575#issuecomment-1114242002
> // We can't use gradient because Vite throws a error.
> //import gradient from 'chartjs-plugin-gradient';
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { useChartTooltip } from "@/scripts/use-chart-tooltip";
30,31d43
< initChart();
< 
33,69c45,81
< 	src: {
< 		type: String,
< 		required: true,
< 	},
< 	args: {
< 		type: Object,
< 		required: false,
< 	},
< 	limit: {
< 		type: Number,
< 		required: false,
< 		default: 90,
< 	},
< 	span: {
< 		type: String as PropType<'hour' | 'day'>,
< 		required: true,
< 	},
< 	detailed: {
< 		type: Boolean,
< 		required: false,
< 		default: false,
< 	},
< 	stacked: {
< 		type: Boolean,
< 		required: false,
< 		default: false,
< 	},
< 	bar: {
< 		type: Boolean,
< 		required: false,
< 		default: false,
< 	},
< 	aspectRatio: {
< 		type: Number,
< 		required: false,
< 		default: null,
< 	},
---
>   src: {
>     type: String,
>     required: true,
>   },
>   args: {
>     type: Object,
>     required: false,
>   },
>   limit: {
>     type: Number,
>     required: false,
>     default: 90,
>   },
>   span: {
>     type: String as PropType<"hour" | "day">,
>     required: true,
>   },
>   detailed: {
>     type: Boolean,
>     required: false,
>     default: false,
>   },
>   stacked: {
>     type: Boolean,
>     required: false,
>     default: false,
>   },
>   bar: {
>     type: Boolean,
>     required: false,
>     default: false,
>   },
>   aspectRatio: {
>     type: Number,
>     required: false,
>     default: null,
>   },
72c84,101
< let legendEl = $shallowRef<InstanceType<typeof MkChartLegend>>();
---
> Chart.register(
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
>   zoomPlugin
>   //gradient,
> );
75c104,111
< const negate = arr => arr.map(x => -x);
---
> const negate = (arr) => arr.map((x) => -x);
> const alpha = (hex, a) => {
>   const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)!;
>   const r = parseInt(result[1], 16);
>   const g = parseInt(result[2], 16);
>   const b = parseInt(result[3], 16);
>   return `rgba(${r}, ${g}, ${b}, ${a})`;
> };
78,85c114,121
< 	blue: '#008FFB',
< 	green: '#00E396',
< 	yellow: '#FEB019',
< 	red: '#FF4560',
< 	purple: '#e300db',
< 	orange: '#fe6919',
< 	lime: '#bde800',
< 	cyan: '#00e0e0',
---
>   blue: "#008FFB",
>   green: "#00E396",
>   yellow: "#FEB019",
>   red: "#FF4560",
>   purple: "#e300db",
>   orange: "#fe6919",
>   lime: "#bde800",
>   cyan: "#00e0e0",
87c123,129
< const colorSets = [colors.blue, colors.green, colors.yellow, colors.red, colors.purple];
---
> const colorSets = [
>   colors.blue,
>   colors.green,
>   colors.yellow,
>   colors.red,
>   colors.purple,
> ];
89c131
< 	return colorSets[i % colorSets.length];
---
>   return colorSets[i % colorSets.length];
95,105c137,147
< 	series: {
< 		name: string;
< 		type: 'line' | 'area';
< 		color?: string;
< 		dashed?: boolean;
< 		hidden?: boolean;
< 		data: {
< 			x: number;
< 			y: number;
< 		}[];
< 	}[];
---
>   series: {
>     name: string;
>     type: "line" | "area";
>     color?: string;
>     dashed?: boolean;
>     hidden?: boolean;
>     data: {
>       x: number;
>       y: number;
>     }[];
>   }[];
108c150
< const chartEl = shallowRef<HTMLCanvasElement>(null);
---
> const chartEl = ref<HTMLCanvasElement>(null);
112,115c154,157
< 	const y = now.getFullYear();
< 	const m = now.getMonth();
< 	const d = now.getDate();
< 	const h = now.getHours();
---
>   const y = now.getFullYear();
>   const m = now.getMonth();
>   const d = now.getDate();
>   const h = now.getHours();
117c159,161
< 	return props.span === 'day' ? new Date(y, m, d - ago) : new Date(y, m, d, h - ago);
---
>   return props.span === "day"
>     ? new Date(y, m, d - ago)
>     : new Date(y, m, d, h - ago);
121,124c165,168
< 	return arr.map((v, i) => ({
< 		x: getDate(i).getTime(),
< 		y: v,
< 	}));
---
>   return arr.map((v, i) => ({
>     x: getDate(i).getTime(),
>     y: v,
>   }));
130,132c174,176
< 	if (chartInstance) {
< 		chartInstance.destroy();
< 	}
---
>   if (chartInstance) {
>     chartInstance.destroy();
>   }
134c178,183
< 	const vLineColor = defaultStore.state.darkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)';
---
>   const gridColor = defaultStore.state.darkMode
>     ? "rgba(255, 255, 255, 0.1)"
>     : "rgba(0, 0, 0, 0.1)";
>   const vLineColor = defaultStore.state.darkMode
>     ? "rgba(255, 255, 255, 0.2)"
>     : "rgba(0, 0, 0, 0.2)";
136c185,188
< 	const maxes = chartData.series.map((x, i) => Math.max(...x.data.map(d => d.y)));
---
>   // フォントカラー
>   Chart.defaults.color = getComputedStyle(
>     document.documentElement
>   ).getPropertyValue("--fg");
138,154c190,218
< 	chartInstance = new Chart(chartEl.value, {
< 		type: props.bar ? 'bar' : 'line',
< 		data: {
< 			labels: new Array(props.limit).fill(0).map((_, i) => date(getDate(i))).slice().reverse(),
< 			datasets: chartData.series.map((x, i) => ({
< 				parsing: false,
< 				label: x.name,
< 				data: x.data.slice().reverse(),
< 				tension: 0.3,
< 				pointRadius: 0,
< 				borderWidth: props.bar ? 0 : 2,
< 				borderColor: x.color ? x.color : getColor(i),
< 				borderDash: x.dashed ? [5, 5] : [],
< 				borderJoinStyle: 'round',
< 				borderRadius: props.bar ? 3 : undefined,
< 				backgroundColor: props.bar ? (x.color ? x.color : getColor(i)) : alpha(x.color ? x.color : getColor(i), 0.1),
< 				gradient: props.bar ? undefined : {
---
>   const maxes = chartData.series.map((x, i) =>
>     Math.max(...x.data.map((d) => d.y))
>   );
> 
>   chartInstance = new Chart(chartEl.value, {
>     type: props.bar ? "bar" : "line",
>     data: {
>       labels: new Array(props.limit)
>         .fill(0)
>         .map((_, i) => getDate(i).toLocaleString())
>         .slice()
>         .reverse(),
>       datasets: chartData.series.map((x, i) => ({
>         parsing: false,
>         label: x.name,
>         data: x.data.slice().reverse(),
>         tension: 0.3,
>         pointRadius: 0,
>         borderWidth: props.bar ? 0 : 2,
>         borderColor: x.color ? x.color : getColor(i),
>         borderDash: x.dashed ? [5, 5] : [],
>         borderJoinStyle: "round",
>         borderRadius: props.bar ? 3 : undefined,
>         backgroundColor: props.bar
>           ? x.color
>             ? x.color
>             : getColor(i)
>           : alpha(x.color ? x.color : getColor(i), 0.1),
>         /*gradient: props.bar ? undefined : {
159c223
< 							[maxes[i]]: alpha(x.color ? x.color : getColor(i), 0.35),
---
> 							[maxes[i]]: alpha(x.color ? x.color : getColor(i), 0.2),
162,267c226,365
< 				},
< 				barPercentage: 0.9,
< 				categoryPercentage: 0.9,
< 				fill: x.type === 'area',
< 				clip: 8,
< 				hidden: !!x.hidden,
< 			})),
< 		},
< 		options: {
< 			aspectRatio: props.aspectRatio || 2.5,
< 			layout: {
< 				padding: {
< 					left: 0,
< 					right: 8,
< 					top: 0,
< 					bottom: 0,
< 				},
< 			},
< 			scales: {
< 				x: {
< 					type: 'time',
< 					stacked: props.stacked,
< 					offset: false,
< 					time: {
< 						stepSize: 1,
< 						unit: props.span === 'day' ? 'month' : 'day',
< 						displayFormats: {
< 							day: 'M/d',
< 							month: 'Y/M',
< 						},
< 					},
< 					grid: {
< 					},
< 					ticks: {
< 						display: props.detailed,
< 						maxRotation: 0,
< 						autoSkipPadding: 16,
< 					},
< 					min: getDate(props.limit).getTime(),
< 				},
< 				y: {
< 					position: 'left',
< 					stacked: props.stacked,
< 					suggestedMax: 50,
< 					grid: {
< 					},
< 					ticks: {
< 						display: props.detailed,
< 						//mirror: true,
< 					},
< 				},
< 			},
< 			interaction: {
< 				intersect: false,
< 				mode: 'index',
< 			},
< 			elements: {
< 				point: {
< 					hoverRadius: 5,
< 					hoverBorderWidth: 2,
< 				},
< 			},
< 			plugins: {
< 				legend: {
< 					display: false,
< 				},
< 				tooltip: {
< 					enabled: false,
< 					mode: 'index',
< 					animation: {
< 						duration: 0,
< 					},
< 					external: externalTooltipHandler,
< 				},
< 				zoom: props.detailed ? {
< 					pan: {
< 						enabled: true,
< 					},
< 					zoom: {
< 						wheel: {
< 							enabled: true,
< 						},
< 						pinch: {
< 							enabled: true,
< 						},
< 						drag: {
< 							enabled: false,
< 						},
< 						mode: 'x',
< 					},
< 					limits: {
< 						x: {
< 							min: 'original',
< 							max: 'original',
< 						},
< 						y: {
< 							min: 'original',
< 							max: 'original',
< 						},
< 					},
< 				} : undefined,
< 				gradient,
< 			},
< 		},
< 		plugins: [chartVLine(vLineColor), ...(props.detailed ? [chartLegend(legendEl)] : [])],
< 	});
---
> 				},*/
>         barPercentage: 0.9,
>         categoryPercentage: 0.9,
>         fill: x.type === "area",
>         clip: 8,
>         hidden: !!x.hidden,
>       })),
>     },
>     options: {
>       aspectRatio: props.aspectRatio || 2.5,
>       layout: {
>         padding: {
>           left: 0,
>           right: 8,
>           top: 0,
>           bottom: 0,
>         },
>       },
>       scales: {
>         x: {
>           type: "time",
>           stacked: props.stacked,
>           offset: false,
>           time: {
>             stepSize: 1,
>             unit: props.span === "day" ? "month" : "day",
>           },
>           grid: {
>             color: gridColor,
>             borderColor: "rgb(0, 0, 0, 0)",
>           },
>           ticks: {
>             display: props.detailed,
>             maxRotation: 0,
>             autoSkipPadding: 16,
>           },
>           adapters: {
>             date: {
>               locale: enUS,
>             },
>           },
>           min: getDate(props.limit).getTime(),
>         },
>         y: {
>           position: "left",
>           stacked: props.stacked,
>           suggestedMax: 50,
>           grid: {
>             color: gridColor,
>             borderColor: "rgb(0, 0, 0, 0)",
>           },
>           ticks: {
>             display: props.detailed,
>             //mirror: true,
>           },
>         },
>       },
>       interaction: {
>         intersect: false,
>         mode: "index",
>       },
>       elements: {
>         point: {
>           hoverRadius: 5,
>           hoverBorderWidth: 2,
>         },
>       },
>       animation: false,
>       plugins: {
>         legend: {
>           display: props.detailed,
>           position: "bottom",
>           labels: {
>             boxWidth: 16,
>           },
>         },
>         tooltip: {
>           enabled: false,
>           mode: "index",
>           animation: {
>             duration: 0,
>           },
>           external: externalTooltipHandler,
>         },
>         zoom: props.detailed
>           ? {
>               pan: {
>                 enabled: true,
>               },
>               zoom: {
>                 wheel: {
>                   enabled: true,
>                 },
>                 pinch: {
>                   enabled: true,
>                 },
>                 drag: {
>                   enabled: false,
>                 },
>                 mode: "x",
>               },
>               limits: {
>                 x: {
>                   min: "original",
>                   max: "original",
>                 },
>                 y: {
>                   min: "original",
>                   max: "original",
>                 },
>               },
>             }
>           : undefined,
>         //gradient,
>       },
>     },
>     plugins: [
>       {
>         id: "vLine",
>         beforeDraw(chart, args, options) {
>           if (chart.tooltip?._active?.length) {
>             const activePoint = chart.tooltip._active[0];
>             const ctx = chart.ctx;
>             const x = activePoint.element.x;
>             const topY = chart.scales.y.top;
>             const bottomY = chart.scales.y.bottom;
> 
>             ctx.save();
>             ctx.beginPath();
>             ctx.moveTo(x, bottomY);
>             ctx.lineTo(x, topY);
>             ctx.lineWidth = 1;
>             ctx.strokeStyle = vLineColor;
>             ctx.stroke();
>             ctx.restore();
>           }
>         },
>       },
>     ],
>   });
271c369
< 	// TODO
---
>   // TODO
275,321c373,431
< 	const raw = await os.apiGet('charts/federation', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Received',
< 			type: 'area',
< 			data: format(raw.inboxInstances),
< 			color: colors.blue,
< 		}, {
< 			name: 'Delivered',
< 			type: 'area',
< 			data: format(raw.deliveredInstances),
< 			color: colors.green,
< 		}, {
< 			name: 'Stalled',
< 			type: 'area',
< 			data: format(raw.stalled),
< 			color: colors.red,
< 		}, {
< 			name: 'Pub Active',
< 			type: 'line',
< 			data: format(raw.pubActive),
< 			color: colors.purple,
< 		}, {
< 			name: 'Sub Active',
< 			type: 'line',
< 			data: format(raw.subActive),
< 			color: colors.orange,
< 		}, {
< 			name: 'Pub & Sub',
< 			type: 'line',
< 			data: format(raw.pubsub),
< 			dashed: true,
< 			color: colors.cyan,
< 		}, {
< 			name: 'Pub',
< 			type: 'line',
< 			data: format(raw.pub),
< 			dashed: true,
< 			color: colors.purple,
< 		}, {
< 			name: 'Sub',
< 			type: 'line',
< 			data: format(raw.sub),
< 			dashed: true,
< 			color: colors.orange,
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/federation", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Received",
>         type: "area",
>         data: format(raw.inboxInstances),
>         color: colors.blue,
>       },
>       {
>         name: "Delivered",
>         type: "area",
>         data: format(raw.deliveredInstances),
>         color: colors.green,
>       },
>       {
>         name: "Stalled",
>         type: "area",
>         data: format(raw.stalled),
>         color: colors.red,
>       },
>       {
>         name: "Pub Active",
>         type: "line",
>         data: format(raw.pubActive),
>         color: colors.purple,
>       },
>       {
>         name: "Sub Active",
>         type: "line",
>         data: format(raw.subActive),
>         color: colors.orange,
>       },
>       {
>         name: "Pub & Sub",
>         type: "line",
>         data: format(raw.pubsub),
>         dashed: true,
>         color: colors.cyan,
>       },
>       {
>         name: "Pub",
>         type: "line",
>         data: format(raw.pub),
>         dashed: true,
>         color: colors.purple,
>       },
>       {
>         name: "Sub",
>         type: "line",
>         data: format(raw.sub),
>         dashed: true,
>         color: colors.orange,
>       },
>     ],
>   };
325,343c435,460
< 	const raw = await os.apiGet('charts/ap-request', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'In',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(raw.inboxReceived),
< 		}, {
< 			name: 'Out (succ)',
< 			type: 'area',
< 			color: '#00E396',
< 			data: format(raw.deliverSucceeded),
< 		}, {
< 			name: 'Out (fail)',
< 			type: 'area',
< 			color: '#FEB019',
< 			data: format(raw.deliverFailed),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/ap-request", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "In",
>         type: "area",
>         color: "#008FFB",
>         data: format(raw.inboxReceived),
>       },
>       {
>         name: "Out (succ)",
>         type: "area",
>         color: "#00E396",
>         data: format(raw.deliverSucceeded),
>       },
>       {
>         name: "Out (fail)",
>         type: "area",
>         color: "#FEB019",
>         data: format(raw.deliverFailed),
>       },
>     ],
>   };
347,390c464,526
< 	const raw = await os.apiGet('charts/notes', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'All',
< 			type: 'line',
< 			data: format(type === 'combined'
< 				? sum(raw.local.inc, negate(raw.local.dec), raw.remote.inc, negate(raw.remote.dec))
< 				: sum(raw[type].inc, negate(raw[type].dec)),
< 			),
< 			color: '#888888',
< 		}, {
< 			name: 'Renotes',
< 			type: 'area',
< 			data: format(type === 'combined'
< 				? sum(raw.local.diffs.renote, raw.remote.diffs.renote)
< 				: raw[type].diffs.renote,
< 			),
< 			color: colors.green,
< 		}, {
< 			name: 'Replies',
< 			type: 'area',
< 			data: format(type === 'combined'
< 				? sum(raw.local.diffs.reply, raw.remote.diffs.reply)
< 				: raw[type].diffs.reply,
< 			),
< 			color: colors.yellow,
< 		}, {
< 			name: 'Normal',
< 			type: 'area',
< 			data: format(type === 'combined'
< 				? sum(raw.local.diffs.normal, raw.remote.diffs.normal)
< 				: raw[type].diffs.normal,
< 			),
< 			color: colors.blue,
< 		}, {
< 			name: 'With file',
< 			type: 'area',
< 			data: format(type === 'combined'
< 				? sum(raw.local.diffs.withFile, raw.remote.diffs.withFile)
< 				: raw[type].diffs.withFile,
< 			),
< 			color: colors.purple,
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/notes", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "All",
>         type: "line",
>         data: format(
>           type === "combined"
>             ? sum(
>                 raw.local.inc,
>                 negate(raw.local.dec),
>                 raw.remote.inc,
>                 negate(raw.remote.dec)
>               )
>             : sum(raw[type].inc, negate(raw[type].dec))
>         ),
>         color: "#888888",
>       },
>       {
>         name: "Renotes",
>         type: "area",
>         data: format(
>           type === "combined"
>             ? sum(raw.local.diffs.renote, raw.remote.diffs.renote)
>             : raw[type].diffs.renote
>         ),
>         color: colors.green,
>       },
>       {
>         name: "Replies",
>         type: "area",
>         data: format(
>           type === "combined"
>             ? sum(raw.local.diffs.reply, raw.remote.diffs.reply)
>             : raw[type].diffs.reply
>         ),
>         color: colors.yellow,
>       },
>       {
>         name: "Normal",
>         type: "area",
>         data: format(
>           type === "combined"
>             ? sum(raw.local.diffs.normal, raw.remote.diffs.normal)
>             : raw[type].diffs.normal
>         ),
>         color: colors.blue,
>       },
>       {
>         name: "With file",
>         type: "area",
>         data: format(
>           type === "combined"
>             ? sum(raw.local.diffs.withFile, raw.remote.diffs.withFile)
>             : raw[type].diffs.withFile
>         ),
>         color: colors.purple,
>       },
>     ],
>   };
394,409c530,552
< 	const raw = await os.apiGet('charts/notes', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Combined',
< 			type: 'line',
< 			data: format(sum(raw.local.total, raw.remote.total)),
< 		}, {
< 			name: 'Local',
< 			type: 'area',
< 			data: format(raw.local.total),
< 		}, {
< 			name: 'Remote',
< 			type: 'area',
< 			data: format(raw.remote.total),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/notes", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Combined",
>         type: "line",
>         data: format(sum(raw.local.total, raw.remote.total)),
>       },
>       {
>         name: "Local",
>         type: "area",
>         data: format(raw.local.total),
>       },
>       {
>         name: "Remote",
>         type: "area",
>         data: format(raw.remote.total),
>       },
>     ],
>   };
413,437c556,591
< 	const raw = await os.apiGet('charts/users', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Combined',
< 			type: 'line',
< 			data: format(total
< 				? sum(raw.local.total, raw.remote.total)
< 				: sum(raw.local.inc, negate(raw.local.dec), raw.remote.inc, negate(raw.remote.dec)),
< 			),
< 		}, {
< 			name: 'Local',
< 			type: 'area',
< 			data: format(total
< 				? raw.local.total
< 				: sum(raw.local.inc, negate(raw.local.dec)),
< 			),
< 		}, {
< 			name: 'Remote',
< 			type: 'area',
< 			data: format(total
< 				? raw.remote.total
< 				: sum(raw.remote.inc, negate(raw.remote.dec)),
< 			),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/users", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Combined",
>         type: "line",
>         data: format(
>           total
>             ? sum(raw.local.total, raw.remote.total)
>             : sum(
>                 raw.local.inc,
>                 negate(raw.local.dec),
>                 raw.remote.inc,
>                 negate(raw.remote.dec)
>               )
>         ),
>       },
>       {
>         name: "Local",
>         type: "area",
>         data: format(
>           total ? raw.local.total : sum(raw.local.inc, negate(raw.local.dec))
>         ),
>       },
>       {
>         name: "Remote",
>         type: "area",
>         data: format(
>           total ? raw.remote.total : sum(raw.remote.inc, negate(raw.remote.dec))
>         ),
>       },
>     ],
>   };
441,489c595,656
< 	const raw = await os.apiGet('charts/active-users', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Read & Write',
< 			type: 'area',
< 			data: format(raw.readWrite),
< 			color: colors.orange,
< 		}, {
< 			name: 'Write',
< 			type: 'area',
< 			data: format(raw.write),
< 			color: colors.lime,
< 		}, {
< 			name: 'Read',
< 			type: 'area',
< 			data: format(raw.read),
< 			color: colors.blue,
< 		}, {
< 			name: '< Week',
< 			type: 'area',
< 			data: format(raw.registeredWithinWeek),
< 			color: colors.green,
< 		}, {
< 			name: '< Month',
< 			type: 'area',
< 			data: format(raw.registeredWithinMonth),
< 			color: colors.yellow,
< 		}, {
< 			name: '< Year',
< 			type: 'area',
< 			data: format(raw.registeredWithinYear),
< 			color: colors.red,
< 		}, {
< 			name: '> Week',
< 			type: 'area',
< 			data: format(raw.registeredOutsideWeek),
< 			color: colors.yellow,
< 		}, {
< 			name: '> Month',
< 			type: 'area',
< 			data: format(raw.registeredOutsideMonth),
< 			color: colors.red,
< 		}, {
< 			name: '> Year',
< 			type: 'area',
< 			data: format(raw.registeredOutsideYear),
< 			color: colors.purple,
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/active-users", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Read & Write",
>         type: "area",
>         data: format(raw.readWrite),
>         color: colors.orange,
>       },
>       {
>         name: "Write",
>         type: "area",
>         data: format(raw.write),
>         color: colors.lime,
>       },
>       {
>         name: "Read",
>         type: "area",
>         data: format(raw.read),
>         color: colors.blue,
>       },
>       {
>         name: "< Week",
>         type: "area",
>         data: format(raw.registeredWithinWeek),
>         color: colors.green,
>       },
>       {
>         name: "< Month",
>         type: "area",
>         data: format(raw.registeredWithinMonth),
>         color: colors.yellow,
>       },
>       {
>         name: "< Year",
>         type: "area",
>         data: format(raw.registeredWithinYear),
>         color: colors.red,
>       },
>       {
>         name: "> Week",
>         type: "area",
>         data: format(raw.registeredOutsideWeek),
>         color: colors.yellow,
>       },
>       {
>         name: "> Month",
>         type: "area",
>         data: format(raw.registeredOutsideMonth),
>         color: colors.red,
>       },
>       {
>         name: "> Year",
>         type: "area",
>         data: format(raw.registeredOutsideYear),
>         color: colors.purple,
>       },
>     ],
>   };
493,525c660,701
< 	const raw = await os.apiGet('charts/drive', { limit: props.limit, span: props.span });
< 	return {
< 		bytes: true,
< 		series: [{
< 			name: 'All',
< 			type: 'line',
< 			dashed: true,
< 			data: format(
< 				sum(
< 					raw.local.incSize,
< 					negate(raw.local.decSize),
< 					raw.remote.incSize,
< 					negate(raw.remote.decSize),
< 				),
< 			),
< 		}, {
< 			name: 'Local +',
< 			type: 'area',
< 			data: format(raw.local.incSize),
< 		}, {
< 			name: 'Local -',
< 			type: 'area',
< 			data: format(negate(raw.local.decSize)),
< 		}, {
< 			name: 'Remote +',
< 			type: 'area',
< 			data: format(raw.remote.incSize),
< 		}, {
< 			name: 'Remote -',
< 			type: 'area',
< 			data: format(negate(raw.remote.decSize)),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/drive", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     bytes: true,
>     series: [
>       {
>         name: "All",
>         type: "line",
>         dashed: true,
>         data: format(
>           sum(
>             raw.local.incSize,
>             negate(raw.local.decSize),
>             raw.remote.incSize,
>             negate(raw.remote.decSize)
>           )
>         ),
>       },
>       {
>         name: "Local +",
>         type: "area",
>         data: format(raw.local.incSize),
>       },
>       {
>         name: "Local -",
>         type: "area",
>         data: format(negate(raw.local.decSize)),
>       },
>       {
>         name: "Remote +",
>         type: "area",
>         data: format(raw.remote.incSize),
>       },
>       {
>         name: "Remote -",
>         type: "area",
>         data: format(negate(raw.remote.decSize)),
>       },
>     ],
>   };
529,560c705,745
< 	const raw = await os.apiGet('charts/drive', { limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'All',
< 			type: 'line',
< 			dashed: true,
< 			data: format(
< 				sum(
< 					raw.local.incCount,
< 					negate(raw.local.decCount),
< 					raw.remote.incCount,
< 					negate(raw.remote.decCount),
< 				),
< 			),
< 		}, {
< 			name: 'Local +',
< 			type: 'area',
< 			data: format(raw.local.incCount),
< 		}, {
< 			name: 'Local -',
< 			type: 'area',
< 			data: format(negate(raw.local.decCount)),
< 		}, {
< 			name: 'Remote +',
< 			type: 'area',
< 			data: format(raw.remote.incCount),
< 		}, {
< 			name: 'Remote -',
< 			type: 'area',
< 			data: format(negate(raw.remote.decCount)),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/drive", {
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "All",
>         type: "line",
>         dashed: true,
>         data: format(
>           sum(
>             raw.local.incCount,
>             negate(raw.local.decCount),
>             raw.remote.incCount,
>             negate(raw.remote.decCount)
>           )
>         ),
>       },
>       {
>         name: "Local +",
>         type: "area",
>         data: format(raw.local.incCount),
>       },
>       {
>         name: "Local -",
>         type: "area",
>         data: format(negate(raw.local.decCount)),
>       },
>       {
>         name: "Remote +",
>         type: "area",
>         data: format(raw.remote.incCount),
>       },
>       {
>         name: "Remote -",
>         type: "area",
>         data: format(negate(raw.remote.decCount)),
>       },
>     ],
>   };
564,582c749,775
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'In',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(raw.requests.received),
< 		}, {
< 			name: 'Out (succ)',
< 			type: 'area',
< 			color: '#00E396',
< 			data: format(raw.requests.succeeded),
< 		}, {
< 			name: 'Out (fail)',
< 			type: 'area',
< 			color: '#FEB019',
< 			data: format(raw.requests.failed),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "In",
>         type: "area",
>         color: "#008FFB",
>         data: format(raw.requests.received),
>       },
>       {
>         name: "Out (succ)",
>         type: "area",
>         color: "#00E396",
>         data: format(raw.requests.succeeded),
>       },
>       {
>         name: "Out (fail)",
>         type: "area",
>         color: "#FEB019",
>         data: format(raw.requests.failed),
>       },
>     ],
>   };
585,597c778,797
< const fetchInstanceUsersChart = async (total: boolean): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Users',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(total
< 				? raw.users.total
< 				: sum(raw.users.inc, negate(raw.users.dec)),
< 			),
< 		}],
< 	};
---
> const fetchInstanceUsersChart = async (
>   total: boolean
> ): Promise<typeof chartData> => {
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Users",
>         type: "area",
>         color: "#008FFB",
>         data: format(
>           total ? raw.users.total : sum(raw.users.inc, negate(raw.users.dec))
>         ),
>       },
>     ],
>   };
600,612c800,819
< const fetchInstanceNotesChart = async (total: boolean): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Notes',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(total
< 				? raw.notes.total
< 				: sum(raw.notes.inc, negate(raw.notes.dec)),
< 			),
< 		}],
< 	};
---
> const fetchInstanceNotesChart = async (
>   total: boolean
> ): Promise<typeof chartData> => {
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Notes",
>         type: "area",
>         color: "#008FFB",
>         data: format(
>           total ? raw.notes.total : sum(raw.notes.inc, negate(raw.notes.dec))
>         ),
>       },
>     ],
>   };
615,635c822,853
< const fetchInstanceFfChart = async (total: boolean): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Following',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(total
< 				? raw.following.total
< 				: sum(raw.following.inc, negate(raw.following.dec)),
< 			),
< 		}, {
< 			name: 'Followers',
< 			type: 'area',
< 			color: '#00E396',
< 			data: format(total
< 				? raw.followers.total
< 				: sum(raw.followers.inc, negate(raw.followers.dec)),
< 			),
< 		}],
< 	};
---
> const fetchInstanceFfChart = async (
>   total: boolean
> ): Promise<typeof chartData> => {
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Following",
>         type: "area",
>         color: "#008FFB",
>         data: format(
>           total
>             ? raw.following.total
>             : sum(raw.following.inc, negate(raw.following.dec))
>         ),
>       },
>       {
>         name: "Followers",
>         type: "area",
>         color: "#00E396",
>         data: format(
>           total
>             ? raw.followers.total
>             : sum(raw.followers.inc, negate(raw.followers.dec))
>         ),
>       },
>     ],
>   };
638,651c856,878
< const fetchInstanceDriveUsageChart = async (total: boolean): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		bytes: true,
< 		series: [{
< 			name: 'Drive usage',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(total
< 				? raw.drive.totalUsage
< 				: sum(raw.drive.incUsage, negate(raw.drive.decUsage)),
< 			),
< 		}],
< 	};
---
> const fetchInstanceDriveUsageChart = async (
>   total: boolean
> ): Promise<typeof chartData> => {
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     bytes: true,
>     series: [
>       {
>         name: "Drive usage",
>         type: "area",
>         color: "#008FFB",
>         data: format(
>           total
>             ? raw.drive.totalUsage
>             : sum(raw.drive.incUsage, negate(raw.drive.decUsage))
>         ),
>       },
>     ],
>   };
654,666c881,902
< const fetchInstanceDriveFilesChart = async (total: boolean): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/instance', { host: props.args.host, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Drive files',
< 			type: 'area',
< 			color: '#008FFB',
< 			data: format(total
< 				? raw.drive.totalFiles
< 				: sum(raw.drive.incFiles, negate(raw.drive.decFiles)),
< 			),
< 		}],
< 	};
---
> const fetchInstanceDriveFilesChart = async (
>   total: boolean
> ): Promise<typeof chartData> => {
>   const raw = await os.apiGet("charts/instance", {
>     host: props.args.host,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Drive files",
>         type: "area",
>         color: "#008FFB",
>         data: format(
>           total
>             ? raw.drive.totalFiles
>             : sum(raw.drive.incFiles, negate(raw.drive.decFiles))
>         ),
>       },
>     ],
>   };
670,698c906,948
< 	const raw = await os.apiGet('charts/user/notes', { userId: props.args.user.id, limit: props.limit, span: props.span });
< 	return {
< 		series: [...(props.args.withoutAll ? [] : [{
< 			name: 'All',
< 			type: 'line',
< 			data: format(sum(raw.inc, negate(raw.dec))),
< 			color: '#888888',
< 		}]), {
< 			name: 'With file',
< 			type: 'area',
< 			data: format(raw.diffs.withFile),
< 			color: colors.purple,
< 		}, {
< 			name: 'Renotes',
< 			type: 'area',
< 			data: format(raw.diffs.renote),
< 			color: colors.green,
< 		}, {
< 			name: 'Replies',
< 			type: 'area',
< 			data: format(raw.diffs.reply),
< 			color: colors.yellow,
< 		}, {
< 			name: 'Normal',
< 			type: 'area',
< 			data: format(raw.diffs.normal),
< 			color: colors.blue,
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/user/notes", {
>     userId: props.args.user.id,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       ...(props.args.withoutAll
>         ? []
>         : [
>             {
>               name: "All",
>               type: "line",
>               data: format(sum(raw.inc, negate(raw.dec))),
>               color: "#888888",
>             },
>           ]),
>       {
>         name: "With file",
>         type: "area",
>         data: format(raw.diffs.withFile),
>         color: colors.purple,
>       },
>       {
>         name: "Renotes",
>         type: "area",
>         data: format(raw.diffs.renote),
>         color: colors.green,
>       },
>       {
>         name: "Replies",
>         type: "area",
>         data: format(raw.diffs.reply),
>         color: colors.yellow,
>       },
>       {
>         name: "Normal",
>         type: "area",
>         data: format(raw.diffs.normal),
>         color: colors.blue,
>       },
>     ],
>   };
701,727d950
< const fetchPerUserPvChart = async (): Promise<typeof chartData> => {
< 	const raw = await os.apiGet('charts/user/pv', { userId: props.args.user.id, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Unique PV (user)',
< 			type: 'area',
< 			data: format(raw.upv.user),
< 			color: colors.purple,
< 		}, {
< 			name: 'PV (user)',
< 			type: 'area',
< 			data: format(raw.pv.user),
< 			color: colors.green,
< 		}, {
< 			name: 'Unique PV (visitor)',
< 			type: 'area',
< 			data: format(raw.upv.visitor),
< 			color: colors.yellow,
< 		}, {
< 			name: 'PV (visitor)',
< 			type: 'area',
< 			data: format(raw.pv.visitor),
< 			color: colors.blue,
< 		}],
< 	};
< };
< 
729,740c952,970
< 	const raw = await os.apiGet('charts/user/following', { userId: props.args.user.id, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Local',
< 			type: 'area',
< 			data: format(raw.local.followings.total),
< 		}, {
< 			name: 'Remote',
< 			type: 'area',
< 			data: format(raw.remote.followings.total),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/user/following", {
>     userId: props.args.user.id,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Local",
>         type: "area",
>         data: format(raw.local.followings.total),
>       },
>       {
>         name: "Remote",
>         type: "area",
>         data: format(raw.remote.followings.total),
>       },
>     ],
>   };
744,755c974,992
< 	const raw = await os.apiGet('charts/user/following', { userId: props.args.user.id, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Local',
< 			type: 'area',
< 			data: format(raw.local.followers.total),
< 		}, {
< 			name: 'Remote',
< 			type: 'area',
< 			data: format(raw.remote.followers.total),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/user/following", {
>     userId: props.args.user.id,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Local",
>         type: "area",
>         data: format(raw.local.followers.total),
>       },
>       {
>         name: "Remote",
>         type: "area",
>         data: format(raw.remote.followers.total),
>       },
>     ],
>   };
759,770c996,1014
< 	const raw = await os.apiGet('charts/user/drive', { userId: props.args.user.id, limit: props.limit, span: props.span });
< 	return {
< 		series: [{
< 			name: 'Inc',
< 			type: 'area',
< 			data: format(raw.incSize),
< 		}, {
< 			name: 'Dec',
< 			type: 'area',
< 			data: format(raw.decSize),
< 		}],
< 	};
---
>   const raw = await os.apiGet("charts/user/drive", {
>     userId: props.args.user.id,
>     limit: props.limit,
>     span: props.span,
>   });
>   return {
>     series: [
>       {
>         name: "Inc",
>         type: "area",
>         data: format(raw.incSize),
>       },
>       {
>         name: "Dec",
>         type: "area",
>         data: format(raw.decSize),
>       },
>     ],
>   };
774,797c1018,1063
< 	const fetchData = () => {
< 		switch (props.src) {
< 			case 'federation': return fetchFederationChart();
< 			case 'ap-request': return fetchApRequestChart();
< 			case 'users': return fetchUsersChart(false);
< 			case 'users-total': return fetchUsersChart(true);
< 			case 'active-users': return fetchActiveUsersChart();
< 			case 'notes': return fetchNotesChart('combined');
< 			case 'local-notes': return fetchNotesChart('local');
< 			case 'remote-notes': return fetchNotesChart('remote');
< 			case 'notes-total': return fetchNotesTotalChart();
< 			case 'drive': return fetchDriveChart();
< 			case 'drive-files': return fetchDriveFilesChart();
< 			case 'instance-requests': return fetchInstanceRequestsChart();
< 			case 'instance-users': return fetchInstanceUsersChart(false);
< 			case 'instance-users-total': return fetchInstanceUsersChart(true);
< 			case 'instance-notes': return fetchInstanceNotesChart(false);
< 			case 'instance-notes-total': return fetchInstanceNotesChart(true);
< 			case 'instance-ff': return fetchInstanceFfChart(false);
< 			case 'instance-ff-total': return fetchInstanceFfChart(true);
< 			case 'instance-drive-usage': return fetchInstanceDriveUsageChart(false);
< 			case 'instance-drive-usage-total': return fetchInstanceDriveUsageChart(true);
< 			case 'instance-drive-files': return fetchInstanceDriveFilesChart(false);
< 			case 'instance-drive-files-total': return fetchInstanceDriveFilesChart(true);
---
>   const fetchData = () => {
>     switch (props.src) {
>       case "federation":
>         return fetchFederationChart();
>       case "ap-request":
>         return fetchApRequestChart();
>       case "users":
>         return fetchUsersChart(false);
>       case "users-total":
>         return fetchUsersChart(true);
>       case "active-users":
>         return fetchActiveUsersChart();
>       case "notes":
>         return fetchNotesChart("combined");
>       case "local-notes":
>         return fetchNotesChart("local");
>       case "remote-notes":
>         return fetchNotesChart("remote");
>       case "notes-total":
>         return fetchNotesTotalChart();
>       case "drive":
>         return fetchDriveChart();
>       case "drive-files":
>         return fetchDriveFilesChart();
>       case "instance-requests":
>         return fetchInstanceRequestsChart();
>       case "instance-users":
>         return fetchInstanceUsersChart(false);
>       case "instance-users-total":
>         return fetchInstanceUsersChart(true);
>       case "instance-notes":
>         return fetchInstanceNotesChart(false);
>       case "instance-notes-total":
>         return fetchInstanceNotesChart(true);
>       case "instance-ff":
>         return fetchInstanceFfChart(false);
>       case "instance-ff-total":
>         return fetchInstanceFfChart(true);
>       case "instance-drive-usage":
>         return fetchInstanceDriveUsageChart(false);
>       case "instance-drive-usage-total":
>         return fetchInstanceDriveUsageChart(true);
>       case "instance-drive-files":
>         return fetchInstanceDriveFilesChart(false);
>       case "instance-drive-files-total":
>         return fetchInstanceDriveFilesChart(true);
799,809c1065,1078
< 			case 'per-user-notes': return fetchPerUserNotesChart();
< 			case 'per-user-pv': return fetchPerUserPvChart();
< 			case 'per-user-following': return fetchPerUserFollowingChart();
< 			case 'per-user-followers': return fetchPerUserFollowersChart();
< 			case 'per-user-drive': return fetchPerUserDriveChart();
< 		}
< 	};
< 	fetching.value = true;
< 	chartData = await fetchData();
< 	fetching.value = false;
< 	render();
---
>       case "per-user-notes":
>         return fetchPerUserNotesChart();
>       case "per-user-following":
>         return fetchPerUserFollowingChart();
>       case "per-user-followers":
>         return fetchPerUserFollowersChart();
>       case "per-user-drive":
>         return fetchPerUserDriveChart();
>     }
>   };
>   fetching.value = true;
>   chartData = await fetchData();
>   fetching.value = false;
>   render();
815c1084
< 	fetchAndRender();
---
>   fetchAndRender();
822c1091
< 	position: relative;
---
>   position: relative;
824,836c1093,1105
< 	> .fetching {
< 		position: absolute;
< 		top: 0;
< 		left: 0;
< 		width: 100%;
< 		height: 100%;
< 		-webkit-backdrop-filter: var(--blur, blur(12px));
< 		backdrop-filter: var(--blur, blur(12px));
< 		display: flex;
< 		justify-content: center;
< 		align-items: center;
< 		cursor: wait;
< 	}
---
>   > .fetching {
>     position: absolute;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     -webkit-backdrop-filter: var(--blur, blur(12px));
>     backdrop-filter: var(--blur, blur(12px));
>     display: flex;
>     justify-content: center;
>     align-items: center;
>     cursor: wait;
>   }
Only in misskeyV13/packages/frontend/src/components: MkChartLegend.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkChartTooltip.vue RiricaV13/components/MkChartTooltip.vue
2,12c2,27
< <MkTooltip ref="tooltip" :showing="showing" :x="x" :y="y" :max-width="340" :direction="'top'" :inner-margin="16" @closed="emit('closed')">
< 	<div v-if="title || series">
< 		<div v-if="title" :class="$style.title">{{ title }}</div>
< 		<template v-if="series">
< 			<div v-for="x in series">
< 				<span :class="$style.color" :style="{ background: x.backgroundColor, borderColor: x.borderColor }"></span>
< 				<span>{{ x.text }}</span>
< 			</div>
< 		</template>
< 	</div>
< </MkTooltip>
---
>   <MkTooltip
>     ref="tooltip"
>     :showing="showing"
>     :x="x"
>     :y="y"
>     :max-width="340"
>     :direction="'top'"
>     :inner-margin="16"
>     @closed="emit('closed')"
>   >
>     <div v-if="title || series" class="qpcyisrl">
>       <div v-if="title" class="title">{{ title }}</div>
>       <template v-if="series">
>         <div v-for="x in series" class="series">
>           <span
>             class="color"
>             :style="{
>               background: x.backgroundColor,
>               borderColor: x.borderColor,
>             }"
>           ></span>
>           <span>{{ x.text }}</span>
>         </div>
>       </template>
>     </div>
>   </MkTooltip>
16,17c31,32
< import { } from 'vue';
< import MkTooltip from './MkTooltip.vue';
---
> import {} from "vue";
> import MkTooltip from "./MkTooltip.vue";
19,28c34,43
< defineProps<{
< 	showing: boolean;
< 	x: number;
< 	y: number;
< 	title?: string;
< 	series?: {
< 		backgroundColor: string;
< 		borderColor: string;
< 		text: string;
< 	}[];
---
> const props = defineProps<{
>   showing: boolean;
>   x: number;
>   y: number;
>   title?: string;
>   series?: {
>     backgroundColor: string;
>     borderColor: string;
>     text: string;
>   }[];
32c47
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
36,39c51,55
< <style lang="scss" module>
< .title {
< 	margin-bottom: 4px;
< }
---
> <style lang="scss" scoped>
> .qpcyisrl {
>   > .title {
>     margin-bottom: 4px;
>   }
41,47c57,66
< .color {
< 	display: inline-block;
< 	width: 8px;
< 	height: 8px;
< 	border-width: 1px;
< 	border-style: solid;
< 	margin-right: 8px;
---
>   > .series {
>     > .color {
>       display: inline-block;
>       width: 8px;
>       height: 8px;
>       border-width: 1px;
>       border-style: solid;
>       margin-right: 8px;
>     }
>   }
Only in misskeyV13/packages/frontend/src/components: MkCheckbox.vue
Only in misskeyV13/packages/frontend/src/components: MkClickerGame.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkCode.core.vue RiricaV13/components/MkCode.core.vue
3,4c3,7
< <code v-if="inline" :class="`language-${prismLang}`" v-html="html"></code>
< <pre v-else :class="`language-${prismLang}`"><code :class="`language-${prismLang}`" v-html="html"></code></pre>
---
>   <code v-if="inline" :class="`language-${prismLang}`" v-html="html"></code>
>   <pre
>     v-else
>     :class="`language-${prismLang}`"
>   ><code :class="`language-${prismLang}`" v-html="html"></code></pre>
8,10c11,13
< import { computed } from 'vue';
< import Prism from 'prismjs';
< import 'prismjs/themes/prism-okaidia.css';
---
> import { computed } from "vue";
> import Prism from "prismjs";
> import "prismjs/themes/prism-okaidia.css";
13,15c16,18
< 	code: string;
< 	lang?: string;
< 	inline?: boolean;
---
>   code: string;
>   lang?: string;
>   inline?: boolean;
18,19c21,26
< const prismLang = computed(() => Prism.languages[props.lang] ? props.lang : 'js');
< const html = computed(() => Prism.highlight(props.code, Prism.languages[prismLang.value], prismLang.value));
---
> const prismLang = computed(() =>
>   Prism.languages[props.lang] ? props.lang : "js"
> );
> const html = computed(() =>
>   Prism.highlight(props.code, Prism.languages[prismLang.value], prismLang.value)
> );
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkCode.vue RiricaV13/components/MkCode.vue
2c2
< <XCode :code="code" :lang="lang" :inline="inline"/>
---
>   <XCode :code="code" :lang="lang" :inline="inline" />
6c6
< import { defineAsyncComponent } from 'vue';
---
> import { defineAsyncComponent } from "vue";
9,11c9,11
< 	code: string;
< 	lang?: string;
< 	inline?: boolean;
---
>   code: string;
>   lang?: string;
>   inline?: boolean;
14c14,16
< const XCode = defineAsyncComponent(() => import('@/components/MkCode.core.vue'));
---
> const XCode = defineAsyncComponent(
>   () => import("@/components/MkCode.core.vue")
> );
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkContainer.vue RiricaV13/components/MkContainer.vue
2,33c2,50
< <div class="_panel" :class="[$style.root, { [$style.naked]: naked, [$style.thin]: thin, [$style.hideHeader]: !showHeader, [$style.scrollable]: scrollable, [$style.closed]: !showBody }]">
< 	<header v-if="showHeader" ref="header" :class="$style.header">
< 		<div :class="$style.title">
< 			<span :class="$style.titleIcon"><slot name="icon"></slot></span>
< 			<slot name="header"></slot>
< 		</div>
< 		<div :class="$style.headerSub">
< 			<slot name="func" :button-style-class="$style.headerButton"></slot>
< 			<button v-if="foldable" :class="$style.headerButton" class="_button" @click="() => showBody = !showBody">
< 				<template v-if="showBody"><i class="ti ti-chevron-up"></i></template>
< 				<template v-else><i class="ti ti-chevron-down"></i></template>
< 			</button>
< 		</div>
< 	</header>
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_toggle_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_toggle_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_toggle_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_toggle_leaveTo : ''"
< 		@enter="enter"
< 		@after-enter="afterEnter"
< 		@leave="leave"
< 		@after-leave="afterLeave"
< 	>
< 		<div v-show="showBody" ref="content" :class="[$style.content, { [$style.omitted]: omitted }]">
< 			<slot></slot>
< 			<button v-if="omitted" :class="$style.fade" class="_button" @click="() => { ignoreOmit = true; omitted = false; }">
< 				<span :class="$style.fadeLabel">{{ $ts.showMore }}</span>
< 			</button>
< 		</div>
< 	</Transition>
< </div>
---
>   <div
>     v-size="{ max: [380] }"
>     class="ukygtjoj _panel"
>     :class="{
>       naked,
>       thin,
>       hideHeader: !showHeader,
>       scrollable,
>       closed: !showBody,
>     }"
>   >
>     <header v-if="showHeader" ref="header">
>       <div class="title"><slot name="header"></slot></div>
>       <div class="sub">
>         <slot name="func"></slot>
>         <button
>           v-if="foldable"
>           class="_button"
>           @click="() => (showBody = !showBody)"
>         >
>           <template v-if="showBody"><i class="fas fa-angle-up"></i></template>
>           <template v-else><i class="fas fa-angle-down"></i></template>
>         </button>
>       </div>
>     </header>
>     <transition
>       :name="$store.state.animation ? 'container-toggle' : ''"
>       @enter="enter"
>       @after-enter="afterEnter"
>       @leave="leave"
>       @after-leave="afterLeave"
>     >
>       <div v-show="showBody" ref="content" class="content" :class="{ omitted }">
>         <slot></slot>
>         <button
>           v-if="omitted"
>           class="fade _button"
>           @click="
>             () => {
>               ignoreOmit = true;
>               omitted = false;
>             }
>           "
>         >
>           <span>{{ $ts.showMore }}</span>
>         </button>
>       </div>
>     </transition>
>   </div>
37c54
< import { defineComponent } from 'vue';
---
> import { defineComponent } from "vue";
40,95c57,118
< 	props: {
< 		showHeader: {
< 			type: Boolean,
< 			required: false,
< 			default: true,
< 		},
< 		thin: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		naked: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		foldable: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		expanded: {
< 			type: Boolean,
< 			required: false,
< 			default: true,
< 		},
< 		scrollable: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		maxHeight: {
< 			type: Number,
< 			required: false,
< 			default: null,
< 		},
< 	},
< 	data() {
< 		return {
< 			showBody: this.expanded,
< 			omitted: null,
< 			ignoreOmit: false,
< 		};
< 	},
< 	mounted() {
< 		this.$watch('showBody', showBody => {
< 			const headerHeight = this.showHeader ? this.$refs.header.offsetHeight : 0;
< 			this.$el.style.minHeight = `${headerHeight}px`;
< 			if (showBody) {
< 				this.$el.style.flexBasis = 'auto';
< 			} else {
< 				this.$el.style.flexBasis = `${headerHeight}px`;
< 			}
< 		}, {
< 			immediate: true,
< 		});
---
>   props: {
>     showHeader: {
>       type: Boolean,
>       required: false,
>       default: true,
>     },
>     thin: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     naked: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     foldable: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     expanded: {
>       type: Boolean,
>       required: false,
>       default: true,
>     },
>     scrollable: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     maxHeight: {
>       type: Number,
>       required: false,
>       default: null,
>     },
>   },
>   data() {
>     return {
>       showBody: this.expanded,
>       omitted: null,
>       ignoreOmit: false,
>     };
>   },
>   mounted() {
>     this.$watch(
>       "showBody",
>       (showBody) => {
>         const headerHeight = this.showHeader
>           ? this.$refs.header.offsetHeight
>           : 0;
>         this.$el.style.minHeight = `${headerHeight}px`;
>         if (showBody) {
>           this.$el.style.flexBasis = "auto";
>         } else {
>           this.$el.style.flexBasis = `${headerHeight}px`;
>         }
>       },
>       {
>         immediate: true,
>       }
>     );
97c120
< 		this.$el.style.setProperty('--maxHeight', this.maxHeight + 'px');
---
>     this.$el.style.setProperty("--maxHeight", this.maxHeight + "px");
99,103c122,126
< 		const calcOmit = () => {
< 			if (this.omitted || this.ignoreOmit || this.maxHeight == null) return;
< 			const height = this.$refs.content.offsetHeight;
< 			this.omitted = height > this.maxHeight;
< 		};
---
>     const calcOmit = () => {
>       if (this.omitted || this.ignoreOmit || this.maxHeight == null) return;
>       const height = this.$refs.content.offsetHeight;
>       this.omitted = height > this.maxHeight;
>     };
105,114c128,137
< 		calcOmit();
< 		new ResizeObserver((entries, observer) => {
< 			calcOmit();
< 		}).observe(this.$refs.content);
< 	},
< 	methods: {
< 		toggleContent(show: boolean) {
< 			if (!this.foldable) return;
< 			this.showBody = show;
< 		},
---
>     calcOmit();
>     new ResizeObserver((entries, observer) => {
>       calcOmit();
>     }).observe(this.$refs.content);
>   },
>   methods: {
>     toggleContent(show: boolean) {
>       if (!this.foldable) return;
>       this.showBody = show;
>     },
116,134c139,157
< 		enter(el) {
< 			const elementHeight = el.getBoundingClientRect().height;
< 			el.style.height = 0;
< 			el.offsetHeight; // reflow
< 			el.style.height = elementHeight + 'px';
< 		},
< 		afterEnter(el) {
< 			el.style.height = null;
< 		},
< 		leave(el) {
< 			const elementHeight = el.getBoundingClientRect().height;
< 			el.style.height = elementHeight + 'px';
< 			el.offsetHeight; // reflow
< 			el.style.height = 0;
< 		},
< 		afterLeave(el) {
< 			el.style.height = null;
< 		},
< 	},
---
>     enter(el) {
>       const elementHeight = el.getBoundingClientRect().height;
>       el.style.height = 0;
>       el.offsetHeight; // reflow
>       el.style.height = elementHeight + "px";
>     },
>     afterEnter(el) {
>       el.style.height = null;
>     },
>     leave(el) {
>       const elementHeight = el.getBoundingClientRect().height;
>       el.style.height = elementHeight + "px";
>       el.offsetHeight; // reflow
>       el.style.height = 0;
>     },
>     afterLeave(el) {
>       el.style.height = null;
>     },
>   },
138,142c161,165
< <style lang="scss" module>
< .transition_toggle_enterActive,
< .transition_toggle_leaveActive {
< 	overflow-y: clip;
< 	transition: opacity 0.5s, height 0.5s !important;
---
> <style lang="scss" scoped>
> .container-toggle-enter-active,
> .container-toggle-leave-active {
>   overflow-y: hidden;
>   transition: opacity 0.5s, height 0.5s !important;
144,146c167,168
< .transition_toggle_enterFrom,
< .transition_toggle_leaveTo {
< 	opacity: 0;
---
> .container-toggle-enter-from {
>   opacity: 0;
147a170,172
> .container-toggle-leave-to {
>   opacity: 0;
> }
149,152c174,177
< .root {
< 	position: relative;
< 	overflow: clip;
< 	contain: content;
---
> .ukygtjoj {
>   position: relative;
>   overflow: clip;
>   contain: content;
154,157c179,182
< 	&.naked {
< 		background: transparent !important;
< 		box-shadow: none !important;
< 	}
---
>   &.naked {
>     background: transparent !important;
>     box-shadow: none !important;
>   }
159,161c184,186
< 	&.scrollable {
< 		display: flex;
< 		flex-direction: column;
---
>   &.scrollable {
>     display: flex;
>     flex-direction: column;
163,166c188,191
< 		> .content {
< 			overflow: auto;
< 		}
< 	}
---
>     > .content {
>       overflow: auto;
>     }
>   }
168,176c193,201
< 	&.thin {
< 		> .header {
< 			> .title {
< 				padding: 8px 10px;
< 				font-size: 0.9em;
< 			}
< 		}
< 	}
< }
---
>   > header {
>     position: sticky;
>     top: var(--stickyTop, 0px);
>     left: 0;
>     color: var(--panelHeaderFg);
>     background: var(--panelHeaderBg);
>     border-bottom: solid 0.5px var(--panelHeaderDivider);
>     z-index: 2;
>     line-height: 1.4em;
178,187c203,205
< .header {
< 	position: sticky;
< 	top: var(--stickyTop, 0px);
< 	left: 0;
< 	color: var(--panelHeaderFg);
< 	background: var(--panelHeaderBg);
< 	border-bottom: solid 0.5px var(--panelHeaderDivider);
< 	z-index: 2;
< 	line-height: 1.4em;
< }
---
>     > .title {
>       margin: 0;
>       padding: 12px 16px;
189,191c207,209
< .title {
< 	margin: 0;
< 	padding: 12px 16px;
---
>       > ::v-deep(i) {
>         margin-right: 6px;
>       }
193,196c211,214
< 	&:empty {
< 		display: none;
< 	}
< }
---
>       &:empty {
>         display: none;
>       }
>     }
198,200c216,221
< .titleIcon {
< 	margin-right: 6px;
< }
---
>     > .sub {
>       position: absolute;
>       z-index: 2;
>       top: 0;
>       right: 0;
>       height: 100%;
202,208c223,228
< .headerSub {
< 	position: absolute;
< 	z-index: 2;
< 	top: 0;
< 	right: 0;
< 	height: 100%;
< }
---
>       > ::v-deep(button) {
>         width: 42px;
>         height: 100%;
>       }
>     }
>   }
210,213c230,231
< .headerButton {
< 	width: 42px;
< 	height: 100%;
< }
---
>   > .content {
>     --stickyTop: 0px;
215,216c233,236
< .content {
< 	--stickyTop: 0px;
---
>     &.omitted {
>       position: relative;
>       max-height: var(--maxHeight);
>       overflow: hidden;
218,221c238,246
< 	&.omitted {
< 		position: relative;
< 		max-height: var(--maxHeight);
< 		overflow: hidden;
---
>       > .fade {
>         display: block;
>         position: absolute;
>         z-index: 10;
>         bottom: 0;
>         left: 0;
>         width: 100%;
>         height: 64px;
>         background: linear-gradient(0deg, var(--panel), var(--X15));
223,231c248,255
< 		> .fade {
< 			display: block;
< 			position: absolute;
< 			z-index: 10;
< 			bottom: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 64px;
< 			background: linear-gradient(0deg, var(--panel), var(--X15));
---
>         > span {
>           display: inline-block;
>           background: var(--panel);
>           padding: 6px 10px;
>           font-size: 0.8em;
>           border-radius: 999px;
>           box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
>         }
233,240c257,264
< 			> .fadeLabel {
< 				display: inline-block;
< 				background: var(--panel);
< 				padding: 6px 10px;
< 				font-size: 0.8em;
< 				border-radius: 999px;
< 				box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
< 			}
---
>         &:hover {
>           > span {
>             background: var(--panelHighlight);
>           }
>         }
>       }
>     }
>   }
242,248c266,277
< 			&:hover {
< 				> .fadeLabel {
< 					background: var(--panelHighlight);
< 				}
< 			}
< 		}
< 	}
---
>   &.max-width_380px,
>   &.thin {
>     > header {
>       > .title {
>         padding: 8px 10px;
>         font-size: 0.9em;
>       }
>     }
> 
>     > .content {
>     }
>   }
251,255c280,293
< @container (max-width: 380px) {
< 	.title {
< 		padding: 8px 10px;
< 		font-size: 0.9em;
< 	}
---
> ._forceContainerFull_ .ukygtjoj {
>   > header {
>     > .title {
>       padding: 12px 16px !important;
>     }
>   }
> }
> 
> ._forceContainerFull_.ukygtjoj {
>   > header {
>     > .title {
>       padding: 12px 16px !important;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkContextMenu.vue RiricaV13/components/MkContextMenu.vue
2,12c2,11
< <Transition
< 	appear
< 	:enter-active-class="$store.state.animation ? $style.transition_fade_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_fade_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_fade_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_fade_leaveTo : ''"
< >
< 	<div ref="rootEl" :class="$style.root" :style="{ zIndex }" @contextmenu.prevent.stop="() => {}">
< 		<MkMenu :items="items" :align="'left'" @close="$emit('closed')"/>
< 	</div>
< </Transition>
---
>   <transition :name="$store.state.animation ? 'fade' : ''" appear>
>     <div
>       ref="rootEl"
>       class="nvlagfpb"
>       :style="{ zIndex }"
>       @contextmenu.prevent.stop="() => {}"
>     >
>       <MkMenu :items="items" :align="'left'" @close="$emit('closed')" />
>     </div>
>   </transition>
16,20c15,19
< import { onMounted, onBeforeUnmount } from 'vue';
< import MkMenu from './MkMenu.vue';
< import { MenuItem } from './types/menu.vue';
< import contains from '@/scripts/contains';
< import * as os from '@/os';
---
> import { onMounted, onBeforeUnmount } from "vue";
> import MkMenu from "./MkMenu.vue";
> import { MenuItem } from "./types/menu.vue";
> import contains from "@/scripts/contains";
> import * as os from "@/os";
23,24c22,23
< 	items: MenuItem[];
< 	ev: MouseEvent;
---
>   items: MenuItem[];
>   ev: MouseEvent;
28c27
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
31c30
< let rootEl = $shallowRef<HTMLDivElement>();
---
> let rootEl = $ref<HTMLDivElement>();
33c32
< let zIndex = $ref<number>(os.claimZIndex('high'));
---
> let zIndex = $ref<number>(os.claimZIndex("high"));
36,37c35,36
< 	let left = props.ev.pageX + 1; // 間違って右ダブルクリックした場合に意図せずアイテムがクリックされるのを防ぐため + 1
< 	let top = props.ev.pageY + 1; // 間違って右ダブルクリックした場合に意図せずアイテムがクリックされるのを防ぐため + 1
---
>   let left = props.ev.pageX + 1; // 間違って右ダブルクリックした場合に意図せずアイテムがクリックされるのを防ぐため + 1
>   let top = props.ev.pageY + 1; // 間違って右ダブルクリックした場合に意図せずアイテムがクリックされるのを防ぐため + 1
39,40c38,39
< 	const width = rootEl.offsetWidth;
< 	const height = rootEl.offsetHeight;
---
>   const width = rootEl.offsetWidth;
>   const height = rootEl.offsetHeight;
42,44c41,43
< 	if (left + width - window.pageXOffset > window.innerWidth) {
< 		left = window.innerWidth - width + window.pageXOffset;
< 	}
---
>   if (left + width - window.pageXOffset > window.innerWidth) {
>     left = window.innerWidth - width + window.pageXOffset;
>   }
46,48c45,47
< 	if (top + height - window.pageYOffset > window.innerHeight) {
< 		top = window.innerHeight - height + window.pageYOffset;
< 	}
---
>   if (top + height - window.pageYOffset > window.innerHeight) {
>     top = window.innerHeight - height + window.pageYOffset;
>   }
50,52c49,51
< 	if (top < 0) {
< 		top = 0;
< 	}
---
>   if (top < 0) {
>     top = 0;
>   }
54,56c53,55
< 	if (left < 0) {
< 		left = 0;
< 	}
---
>   if (left < 0) {
>     left = 0;
>   }
58,59c57,58
< 	rootEl.style.top = `${top}px`;
< 	rootEl.style.left = `${left}px`;
---
>   rootEl.style.top = `${top}px`;
>   rootEl.style.left = `${left}px`;
61,63c60,62
< 	for (const el of Array.from(document.querySelectorAll('body *'))) {
< 		el.addEventListener('mousedown', onMousedown);
< 	}
---
>   for (const el of Array.from(document.querySelectorAll("body *"))) {
>     el.addEventListener("mousedown", onMousedown);
>   }
67,69c66,68
< 	for (const el of Array.from(document.querySelectorAll('body *'))) {
< 		el.removeEventListener('mousedown', onMousedown);
< 	}
---
>   for (const el of Array.from(document.querySelectorAll("body *"))) {
>     el.removeEventListener("mousedown", onMousedown);
>   }
73c72
< 	if (!contains(rootEl, evt.target) && (rootEl !== evt.target)) emit('closed');
---
>   if (!contains(rootEl, evt.target) && rootEl !== evt.target) emit("closed");
77,81c76,78
< <style lang="scss" module>
< .transition_fade_enterActive,
< .transition_fade_leaveActive {
< 	transition: opacity 0.3s cubic-bezier(0.16, 1, 0.3, 1), transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
< 	transform-origin: left top;
---
> <style lang="scss" scoped>
> .nvlagfpb {
>   position: absolute;
83,86c80,85
< .transition_fade_enterFrom,
< .transition_fade_leaveTo {
< 	opacity: 0;
< 	transform: scale(0.9);
---
> 
> .fade-enter-active,
> .fade-leave-active {
>   transition: opacity 0.5s cubic-bezier(0.16, 1, 0.3, 1),
>     transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
>   transform-origin: left top;
89,90c88,91
< .root {
< 	position: absolute;
---
> .fade-enter-from,
> .fade-leave-to {
>   opacity: 0;
>   transform: scale(0.9);
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkCropperDialog.vue RiricaV13/components/MkCropperDialog.vue
2,25c2,33
< <MkModalWindow
< 	ref="dialogEl"
< 	:width="800"
< 	:height="500"
< 	:scroll="false"
< 	:with-ok-button="true"
< 	@close="cancel()"
< 	@ok="ok()"
< 	@closed="$emit('closed')"
< >
< 	<template #header>{{ i18n.ts.cropImage }}</template>
< 	<template #default="{ width, height }">
< 		<div class="mk-cropper-dialog" :style="`--vw: ${width}px; --vh: ${height}px;`">
< 			<Transition name="fade">
< 				<div v-if="loading" class="loading">
< 					<MkLoading/>
< 				</div>
< 			</Transition>
< 			<div class="container">
< 				<img ref="imgEl" :src="imgUrl" style="display: none;" @load="onImageLoad">
< 			</div>
< 		</div>
< 	</template>
< </MkModalWindow>
---
>   <XModalWindow
>     ref="dialogEl"
>     :width="800"
>     :height="500"
>     :scroll="false"
>     :with-ok-button="true"
>     @close="cancel()"
>     @ok="ok()"
>     @closed="$emit('closed')"
>   >
>     <template #header>{{ i18n.ts.cropImage }}</template>
>     <template #default="{ width, height }">
>       <div
>         class="mk-cropper-dialog"
>         :style="`--vw: ${width}px; --vh: ${height}px;`"
>       >
>         <Transition name="fade">
>           <div v-if="loading" class="loading">
>             <MkLoading />
>           </div>
>         </Transition>
>         <div class="container">
>           <img
>             ref="imgEl"
>             :src="imgUrl"
>             style="display: none"
>             @load="onImageLoad"
>           />
>         </div>
>       </div>
>     </template>
>   </XModalWindow>
29,39c37,47
< import { nextTick, onMounted } from 'vue';
< import * as misskey from 'misskey-js';
< import Cropper from 'cropperjs';
< import tinycolor from 'tinycolor2';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { defaultStore } from '@/store';
< import { apiUrl } from '@/config';
< import { i18n } from '@/i18n';
< import { getProxiedImageUrl } from '@/scripts/media-proxy';
---
> import { nextTick, onMounted } from "vue";
> import * as misskey from "misskey-js";
> import Cropper from "cropperjs";
> import tinycolor from "tinycolor2";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { defaultStore } from "@/store";
> import { apiUrl } from "@/config";
> import { i18n } from "@/i18n";
> import { getProxiedImageUrl } from "@/scripts/media-proxy";
42,44c50,52
< 	(ev: 'ok', cropped: misskey.entities.DriveFile): void;
< 	(ev: 'cancel'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "ok", cropped: misskey.entities.DriveFile): void;
>   (ev: "cancel"): void;
>   (ev: "closed"): void;
48,49c56,57
< 	file: misskey.entities.DriveFile;
< 	aspectRatio: number;
---
>   file: misskey.entities.DriveFile;
>   aspectRatio: number;
53,54c61,62
< let dialogEl = $shallowRef<InstanceType<typeof MkModalWindow>>();
< let imgEl = $shallowRef<HTMLImageElement>();
---
> let dialogEl = $ref<InstanceType<typeof XModalWindow>>();
> let imgEl = $ref<HTMLImageElement>();
59,67c67,75
< 	const promise = new Promise<misskey.entities.DriveFile>(async (res) => {
< 		const croppedCanvas = await cropper?.getCropperSelection()?.$toCanvas();
< 		croppedCanvas.toBlob(blob => {
< 			const formData = new FormData();
< 			formData.append('file', blob);
< 			formData.append('i', $i.token);
< 			if (defaultStore.state.uploadFolder) {
< 				formData.append('folderId', defaultStore.state.uploadFolder);
< 			}
---
>   const promise = new Promise<misskey.entities.DriveFile>(async (res) => {
>     const croppedCanvas = await cropper?.getCropperSelection()?.$toCanvas();
>     croppedCanvas.toBlob((blob) => {
>       const formData = new FormData();
>       formData.append("file", blob);
>       formData.append("i", $i.token);
>       if (defaultStore.state.uploadFolder) {
>         formData.append("folderId", defaultStore.state.uploadFolder);
>       }
69,78c77,87
< 			window.fetch(apiUrl + '/drive/files/create', {
< 				method: 'POST',
< 				body: formData,
< 			})
< 				.then(response => response.json())
< 				.then(f => {
< 					res(f);
< 				});
< 		});
< 	});
---
>       window
>         .fetch(apiUrl + "/drive/files/create", {
>           method: "POST",
>           body: formData,
>         })
>         .then((response) => response.json())
>         .then((f) => {
>           res(f);
>         });
>     });
>   });
80c89
< 	os.promiseDialog(promise);
---
>   os.promiseDialog(promise);
82c91
< 	const f = await promise;
---
>   const f = await promise;
84,85c93,94
< 	emit('ok', f);
< 	dialogEl.close();
---
>   emit("ok", f);
>   dialogEl.close();
89,90c98,99
< 	emit('cancel');
< 	dialogEl.close();
---
>   emit("cancel");
>   dialogEl.close();
94c103
< 	loading = false;
---
>   loading = false;
96,99c105,108
< 	if (cropper) {
< 		cropper.getCropperImage()!.$center('contain');
< 		cropper.getCropperSelection()!.$center();
< 	}
---
>   if (cropper) {
>     cropper.getCropperImage()!.$center("contain");
>     cropper.getCropperSelection()!.$center();
>   }
103,104c112
< 	cropper = new Cropper(imgEl, {
< 	});
---
>   cropper = new Cropper(imgEl, {});
106c114
< 	const computedStyle = getComputedStyle(document.documentElement);
---
>   const computedStyle = getComputedStyle(document.documentElement);
108,112c116,122
< 	const selection = cropper.getCropperSelection()!;
< 	selection.themeColor = tinycolor(computedStyle.getPropertyValue('--accent')).toHexString();
< 	selection.aspectRatio = props.aspectRatio;
< 	selection.initialAspectRatio = props.aspectRatio;
< 	selection.outlined = true;
---
>   const selection = cropper.getCropperSelection()!;
>   selection.themeColor = tinycolor(
>     computedStyle.getPropertyValue("--accent")
>   ).toHexString();
>   selection.aspectRatio = props.aspectRatio;
>   selection.initialAspectRatio = props.aspectRatio;
>   selection.outlined = true;
114,117c124,127
< 	window.setTimeout(() => {
< 		cropper.getCropperImage()!.$center('contain');
< 		selection.$center();
< 	}, 100);
---
>   window.setTimeout(() => {
>     cropper.getCropperImage()!.$center("contain");
>     selection.$center();
>   }, 100);
119,123c129,133
< 	// モーダルオープンアニメーションが終わったあとで再度調整
< 	window.setTimeout(() => {
< 		cropper.getCropperImage()!.$center('contain');
< 		selection.$center();
< 	}, 500);
---
>   // モーダルオープンアニメーションが終わったあとで再度調整
>   window.setTimeout(() => {
>     cropper.getCropperImage()!.$center("contain");
>     selection.$center();
>   }, 500);
130c140
< 	transition: opacity 0.5s ease 0.5s;
---
>   transition: opacity 0.5s ease 0.5s;
134c144
< 	opacity: 0;
---
>   opacity: 0;
138,142c148,152
< 	display: flex;
< 	flex-direction: column;
< 	width: var(--vw);
< 	height: var(--vh);
< 	position: relative;
---
>   display: flex;
>   flex-direction: column;
>   width: var(--vw);
>   height: var(--vh);
>   position: relative;
144,157c154,167
< 	> .loading {
< 		position: absolute;
< 		z-index: 10;
< 		top: 0;
< 		left: 0;
< 		width: 100%;
< 		height: 100%;
< 		display: flex;
< 		align-items: center;
< 		justify-content: center;
< 		-webkit-backdrop-filter: var(--blur, blur(10px));
< 		backdrop-filter: var(--blur, blur(10px));
< 		background: rgba(0, 0, 0, 0.5);
< 	}
---
>   > .loading {
>     position: absolute;
>     z-index: 10;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     display: flex;
>     align-items: center;
>     justify-content: center;
>     -webkit-backdrop-filter: var(--blur, blur(10px));
>     backdrop-filter: var(--blur, blur(10px));
>     background: rgba(0, 0, 0, 0.5);
>   }
159,162c169,172
< 	> .container {
< 		flex: 1;
< 		width: 100%;
< 		height: 100%;
---
>   > .container {
>     flex: 1;
>     width: 100%;
>     height: 100%;
164,166c174,176
< 		> ::v-deep(cropper-canvas) {
< 			width: 100%;
< 			height: 100%;
---
>     > ::v-deep(cropper-canvas) {
>       width: 100%;
>       height: 100%;
168,172c178,182
< 			> cropper-selection > cropper-handle[action="move"] {
< 				background: transparent;
< 			}
< 		}
< 	}
---
>       > cropper-selection > cropper-handle[action="move"] {
>         background: transparent;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkCwButton.vue RiricaV13/components/MkCwButton.vue
2,5c2,5
< <button class="_button" :class="$style.root" @click="toggle">
< 	<b>{{ modelValue ? i18n.ts._cw.hide : i18n.ts._cw.show }}</b>
< 	<span v-if="!modelValue" :class="$style.label">{{ label }}</span>
< </button>
---
>   <button class="nrvgflfu _button" @click="toggle">
>     <b>{{ modelValue ? i18n.ts._cw.hide : i18n.ts._cw.show }}</b>
>     <span v-if="!modelValue">{{ label }}</span>
>   </button>
9,13c9,13
< import { computed } from 'vue';
< import { length } from 'stringz';
< import * as misskey from 'misskey-js';
< import { concat } from '@/scripts/array';
< import { i18n } from '@/i18n';
---
> import { computed } from "vue";
> import { length } from "stringz";
> import * as misskey from "misskey-js";
> import { concat } from "@/scripts/array";
> import { i18n } from "@/i18n";
16,17c16,17
< 	modelValue: boolean;
< 	note: misskey.entities.Note;
---
>   modelValue: boolean;
>   note: misskey.entities.Note;
21c21
< 	(ev: 'update:modelValue', v: boolean): void;
---
>   (ev: "update:modelValue", v: boolean): void;
25,29c25,33
< 	return concat([
< 		props.note.text ? [i18n.t('_cw.chars', { count: length(props.note.text) })] : [],
< 		props.note.files && props.note.files.length !== 0 ? [i18n.t('_cw.files', { count: props.note.files.length })] : [],
< 		props.note.poll != null ? [i18n.ts.poll] : [],
< 	] as string[][]).join(' / ');
---
>   return concat([
>     props.note.text
>       ? [i18n.t("_cw.chars", { count: length(props.note.text) })]
>       : [],
>     props.note.files && props.note.files.length !== 0
>       ? [i18n.t("_cw.files", { count: props.note.files.length })]
>       : [],
>     props.note.poll != null ? [i18n.ts.poll] : [],
>   ] as string[][]).join(" / ");
33c37
< 	emit('update:modelValue', !props.modelValue);
---
>   emit("update:modelValue", !props.modelValue);
37,44c41,48
< <style lang="scss" module>
< .root {
< 	display: inline-block;
< 	padding: 4px 8px;
< 	font-size: 0.7em;
< 	color: var(--cwFg);
< 	background: var(--cwBg);
< 	border-radius: 2px;
---
> <style lang="scss" scoped>
> .nrvgflfu {
>   display: inline-block;
>   padding: 4px 8px;
>   font-size: 0.7em;
>   color: var(--cwFg);
>   background: var(--cwBg);
>   border-radius: 2px;
46,49c50,52
< 	&:hover {
< 		background: var(--cwHoverBg);
< 	}
< }
---
>   &:hover {
>     background: var(--cwHoverBg);
>   }
51,52c54,55
< .label {
< 	margin-left: 4px;
---
>   > span {
>     margin-left: 4px;
54,56c57,59
< 	&:before {
< 		content: '(';
< 	}
---
>     &:before {
>       content: "(";
>     }
58,60c61,64
< 	&:after {
< 		content: ')';
< 	}
---
>     &:after {
>       content: ")";
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDateSeparatedList.vue RiricaV13/components/MkDateSeparatedList.vue
2,6c2,5
< import { defineComponent, h, PropType, TransitionGroup, useCssModule } from 'vue';
< import MkAd from '@/components/global/MkAd.vue';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
< import { MisskeyEntity } from '@/types/date-separated-list';
---
> import { defineComponent, h, PropType, TransitionGroup } from "vue";
> import MkAd from "@/components/global/MkAd.vue";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
9,34c8,35
< 	props: {
< 		items: {
< 			type: Array as PropType<MisskeyEntity[]>,
< 			required: true,
< 		},
< 		direction: {
< 			type: String,
< 			required: false,
< 			default: 'down',
< 		},
< 		reversed: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		noGap: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		ad: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 	},
---
>   props: {
>     items: {
>       type: Array as PropType<
>         { id: string; createdAt: string; _shouldInsertAd_: boolean }[]
>       >,
>       required: true,
>     },
>     direction: {
>       type: String,
>       required: false,
>       default: "down",
>     },
>     reversed: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     noGap: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     ad: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>   },
36,45c37,45
< 	setup(props, { slots, expose }) {
< 		const $style = useCssModule();
< 		function getDateText(time: string) {
< 			const date = new Date(time).getDate();
< 			const month = new Date(time).getMonth() + 1;
< 			return i18n.t('monthAndDay', {
< 				month: month.toString(),
< 				day: date.toString(),
< 			});
< 		}
---
>   setup(props, { slots, expose }) {
>     function getDateText(time: string) {
>       const date = new Date(time).getDate();
>       const month = new Date(time).getMonth() + 1;
>       return i18n.t("monthAndDay", {
>         month: month.toString(),
>         day: date.toString(),
>       });
>     }
47c47
< 		if (props.items.length === 0) return;
---
>     if (props.items.length === 0) return;
49,50c49,51
< 		const renderChildren = () => props.items.map((item, i) => {
< 			if (!slots || !slots.default) return;
---
>     const renderChildren = () =>
>       props.items.map((item, i) => {
>         if (!slots || !slots.default) return;
52,55c53,56
< 			const el = slots.default({
< 				item: item,
< 			})[0];
< 			if (el.key == null && item.id) el.key = item.id;
---
>         const el = slots.default({
>           item: item,
>         })[0];
>         if (el.key == null && item.id) el.key = item.id;
57,83c58,89
< 			if (
< 				i !== props.items.length - 1 &&
< 				new Date(item.createdAt).getDate() !== new Date(props.items[i + 1].createdAt).getDate()
< 			) {
< 				const separator = h('div', {
< 					class: $style['separator'],
< 					key: item.id + ':separator',
< 				}, h('p', {
< 					class: $style['date'],
< 				}, [
< 					h('span', {
< 						class: $style['date-1'],
< 					}, [
< 						h('i', {
< 							class: `ti ti-chevron-up ${$style['date-1-icon']}`,
< 						}),
< 						getDateText(item.createdAt),
< 					]),
< 					h('span', {
< 						class: $style['date-2'],
< 					}, [
< 						getDateText(props.items[i + 1].createdAt),
< 						h('i', {
< 							class: `ti ti-chevron-down ${$style['date-2-icon']}`,
< 						}),
< 					]),
< 				]));
---
>         if (
>           i !== props.items.length - 1 &&
>           new Date(item.createdAt).getDate() !==
>             new Date(props.items[i + 1].createdAt).getDate()
>         ) {
>           const separator = h(
>             "div",
>             {
>               class: "separator",
>               key: item.id + ":separator",
>             },
>             h(
>               "p",
>               {
>                 class: "date",
>               },
>               [
>                 h("span", [
>                   h("i", {
>                     class: "fas fa-angle-up icon",
>                   }),
>                   getDateText(item.createdAt),
>                 ]),
>                 h("span", [
>                   getDateText(props.items[i + 1].createdAt),
>                   h("i", {
>                     class: "fas fa-angle-down icon",
>                   }),
>                 ]),
>               ]
>             )
>           );
85,96c91,106
< 				return [el, separator];
< 			} else {
< 				if (props.ad && item._shouldInsertAd_) {
< 					return [h(MkAd, {
< 						key: item.id + ':ad',
< 						prefer: ['horizontal', 'horizontal-big'],
< 					}), el];
< 				} else {
< 					return el;
< 				}
< 			}
< 		});
---
>           return [el, separator];
>         } else {
>           if (props.ad && item._shouldInsertAd_) {
>             return [
>               h(MkAd, {
>                 class: "a", // advertiseの意(ブロッカー対策)
>                 key: item.id + ":ad",
>                 prefer: ["horizontal", "horizontal-big"],
>               }),
>               el,
>             ];
>           } else {
>             return el;
>           }
>         }
>       });
98,125c108,124
< 		function onBeforeLeave(el: HTMLElement) {
< 			el.style.top = `${el.offsetTop}px`;
< 			el.style.left = `${el.offsetLeft}px`;
< 		}
< 		function onLeaveCanceled(el: HTMLElement) {
< 			el.style.top = '';
< 			el.style.left = '';
< 		}
< 
< 		return () => h(
< 			defaultStore.state.animation ? TransitionGroup : 'div',
< 			{
< 					class: {
< 						[$style['date-separated-list']]: true,
< 						[$style['date-separated-list-nogap']]: props.noGap,
< 						[$style['reversed']]: props.reversed,
< 						[$style['direction-down']]: props.direction === 'down',
< 						[$style['direction-up']]: props.direction === 'up',
< 					},
< 					...(defaultStore.state.animation ? {
< 						name: 'list',
< 						tag: 'div',
< 						onBeforeLeave,
< 						onLeaveCanceled,
< 					} : {}),
< 			},
< 			{ default: renderChildren });
< 	},
---
>     return () =>
>       h(
>         defaultStore.state.animation ? TransitionGroup : "div",
>         defaultStore.state.animation
>           ? {
>               class: "sqadhkmv" + (props.noGap ? " noGap" : ""),
>               name: "list",
>               tag: "div",
>               "data-direction": props.direction,
>               "data-reversed": props.reversed ? "true" : "false",
>             }
>           : {
>               class: "sqadhkmv" + (props.noGap ? " noGap" : ""),
>             },
>         { default: renderChildren }
>       );
>   },
129,131c128,132
< <style lang="scss" module>
< .date-separated-list {
< 	container-type: inline-size;
---
> <style lang="scss">
> .sqadhkmv {
>   > *:empty {
>     display: none;
>   }
133,136c134,136
< 	&:global {
< 	> .list-move {
< 		transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1);
< 	}
---
>   > *:not(:last-child) {
>     margin-bottom: var(--margin);
>   }
138,140c138,140
< 	&.deny-move-transition > .list-move {
< 		transition: none !important;
< 	}
---
>   > .list-move {
>     transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1);
>   }
142,145c142,145
< 	> .list-leave-active,
< 	> .list-enter-active {
< 		transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.7s cubic-bezier(0.23, 1, 0.32, 1);
< 	}
---
>   > .list-enter-active {
>     transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1),
>       opacity 0.7s cubic-bezier(0.23, 1, 0.32, 1);
>   }
147,152c147,152
< 	> .list-leave-from,
< 	> .list-leave-to,
< 	> .list-leave-active {
< 		transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.7s cubic-bezier(0.23, 1, 0.32, 1);
< 		position: absolute !important;
< 	}
---
>   &[data-direction="up"] {
>     > .list-enter-from {
>       opacity: 0;
>       transform: translateY(64px);
>     }
>   }
154,156c154,159
< 	> *:empty {
< 		display: none;
< 	}
---
>   &[data-direction="down"] {
>     > .list-enter-from {
>       opacity: 0;
>       transform: translateY(-64px);
>     }
>   }
158,162c161,162
< 	> *:not(:last-child) {
< 		margin-bottom: var(--margin);
< 	}
< 	}
< }
---
>   > .separator {
>     text-align: center;
164,169c164,172
< .date-separated-list-nogap {
< 	> * {
< 		margin: 0 !important;
< 		border: none;
< 		border-radius: 0;
< 		box-shadow: none;
---
>     > .date {
>       display: inline-block;
>       position: relative;
>       margin: 0;
>       padding: 0 16px;
>       line-height: 32px;
>       text-align: center;
>       font-size: 12px;
>       color: var(--dateLabelFg);
171,175c174,176
< 		&:not(:last-child) {
< 			border-bottom: solid 0.5px var(--divider);
< 		}
< 	}
< }
---
>       > span {
>         &:first-child {
>           margin-right: 8px;
177,194c178,181
< .direction-up {
< 	&:global {
< 	> .list-enter-from,
< 	> .list-leave-to {
< 		opacity: 0;
< 		transform: translateY(64px);
< 	}
< 	}
< }
< .direction-down {
< 	&:global {
< 	> .list-enter-from,
< 	> .list-leave-to {
< 		opacity: 0;
< 		transform: translateY(-64px);
< 	}
< 	}
< }
---
>           > .icon {
>             margin-right: 8px;
>           }
>         }
196,199c183,184
< .reversed {
< 	display: flex;
< 	flex-direction: column-reverse;
< }
---
>         &:last-child {
>           margin-left: 8px;
201,203c186,192
< .separator {
< 	text-align: center;
< }
---
>           > .icon {
>             margin-left: 8px;
>           }
>         }
>       }
>     }
>   }
205,214c194,199
< .date {
< 	display: inline-block;
< 	position: relative;
< 	margin: 0;
< 	padding: 0 16px;
< 	line-height: 32px;
< 	text-align: center;
< 	font-size: 12px;
< 	color: var(--dateLabelFg);
< }
---
>   &.noGap {
>     > * {
>       margin: 0 !important;
>       border: none;
>       border-radius: 0;
>       box-shadow: none;
216,217c201,205
< .date-1 {
< 	margin-right: 8px;
---
>       &:not(:last-child) {
>         border-bottom: solid 0.5px var(--divider);
>       }
>     }
>   }
219,230d206
< 
< .date-1-icon {
< 	margin-right: 8px;
< }
< 
< .date-2 {
< 	margin-left: 8px;
< }
< 
< .date-2-icon {
< 	margin-left: 8px;
< }
232d207
< 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDialog.vue RiricaV13/components/MkDialog.vue
2,38c2,92
< <MkModal ref="modal" :prefer-type="'dialog'" :z-priority="'high'" @click="done(true)" @closed="emit('closed')">
< 	<div :class="$style.root">
< 		<div v-if="icon" :class="$style.icon">
< 			<i :class="icon"></i>
< 		</div>
< 		<div v-else-if="!input && !select" :class="[$style.icon, $style['type_' + type]]">
< 			<i v-if="type === 'success'" :class="$style.iconInner" class="ti ti-check"></i>
< 			<i v-else-if="type === 'error'" :class="$style.iconInner" class="ti ti-circle-x"></i>
< 			<i v-else-if="type === 'warning'" :class="$style.iconInner" class="ti ti-alert-triangle"></i>
< 			<i v-else-if="type === 'info'" :class="$style.iconInner" class="ti ti-info-circle"></i>
< 			<i v-else-if="type === 'question'" :class="$style.iconInner" class="ti ti-question-circle"></i>
< 			<MkLoading v-else-if="type === 'waiting'" :class="$style.iconInner" :em="true"/>
< 		</div>
< 		<header v-if="title" :class="$style.title"><Mfm :text="title"/></header>
< 		<div v-if="text" :class="$style.text"><Mfm :text="text"/></div>
< 		<MkInput v-if="input" v-model="inputValue" autofocus :type="input.type || 'text'" :placeholder="input.placeholder || undefined" @keydown="onInputKeydown">
< 			<template v-if="input.type === 'password'" #prefix><i class="ti ti-lock"></i></template>
< 		</MkInput>
< 		<MkSelect v-if="select" v-model="selectedValue" autofocus>
< 			<template v-if="select.items">
< 				<option v-for="item in select.items" :value="item.value">{{ item.text }}</option>
< 			</template>
< 			<template v-else>
< 				<optgroup v-for="groupedItem in select.groupedItems" :label="groupedItem.label">
< 					<option v-for="item in groupedItem.items" :value="item.value">{{ item.text }}</option>
< 				</optgroup>
< 			</template>
< 		</MkSelect>
< 		<div v-if="(showOkButton || showCancelButton) && !actions" :class="$style.buttons">
< 			<MkButton v-if="showOkButton" inline primary :autofocus="!input && !select" @click="ok">{{ (showCancelButton || input || select) ? i18n.ts.ok : i18n.ts.gotIt }}</MkButton>
< 			<MkButton v-if="showCancelButton || input || select" inline @click="cancel">{{ i18n.ts.cancel }}</MkButton>
< 		</div>
< 		<div v-if="actions" :class="$style.buttons">
< 			<MkButton v-for="action in actions" :key="action.text" inline :primary="action.primary" @click="() => { action.callback(); close(); }">{{ action.text }}</MkButton>
< 		</div>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :prefer-type="'dialog'"
>     :z-priority="'high'"
>     @click="done(true)"
>     @closed="emit('closed')"
>   >
>     <div class="mk-dialog">
>       <div v-if="icon" class="icon">
>         <i :class="icon"></i>
>       </div>
>       <div v-else-if="!input && !select" class="icon" :class="type">
>         <i v-if="type === 'success'" class="fas fa-check"></i>
>         <i v-else-if="type === 'error'" class="fas fa-times-circle"></i>
>         <i
>           v-else-if="type === 'warning'"
>           class="fas fa-exclamation-triangle"
>         ></i>
>         <i v-else-if="type === 'info'" class="fas fa-info-circle"></i>
>         <i v-else-if="type === 'question'" class="fas fa-question-circle"></i>
>         <i v-else-if="type === 'waiting'" class="fas fa-spinner fa-pulse"></i>
>       </div>
>       <header v-if="title"><Mfm :text="title" /></header>
>       <div v-if="text" class="body"><Mfm :text="text" /></div>
>       <MkInput
>         v-if="input"
>         v-model="inputValue"
>         autofocus
>         :type="input.type || 'text'"
>         :placeholder="input.placeholder || undefined"
>         @keydown="onInputKeydown"
>       >
>         <template v-if="input.type === 'password'" #prefix
>           ><i class="fas fa-lock"></i
>         ></template>
>       </MkInput>
>       <MkSelect v-if="select" v-model="selectedValue" autofocus>
>         <template v-if="select.items">
>           <option v-for="item in select.items" :value="item.value">
>             {{ item.text }}
>           </option>
>         </template>
>         <template v-else>
>           <optgroup
>             v-for="groupedItem in select.groupedItems"
>             :label="groupedItem.label"
>           >
>             <option v-for="item in groupedItem.items" :value="item.value">
>               {{ item.text }}
>             </option>
>           </optgroup>
>         </template>
>       </MkSelect>
>       <div
>         v-if="(showOkButton || showCancelButton) && !actions"
>         class="buttons"
>       >
>         <MkButton
>           v-if="showOkButton"
>           inline
>           primary
>           :autofocus="!input && !select"
>           @click="ok"
>           >{{
>             showCancelButton || input || select ? i18n.ts.ok : i18n.ts.gotIt
>           }}</MkButton
>         >
>         <MkButton
>           v-if="showCancelButton || input || select"
>           inline
>           @click="cancel"
>           >{{ i18n.ts.cancel }}</MkButton
>         >
>       </div>
>       <div v-if="actions" class="buttons">
>         <MkButton
>           v-for="action in actions"
>           :key="action.text"
>           inline
>           :primary="action.primary"
>           @click="
>             () => {
>               action.callback();
>               close();
>             }
>           "
>           >{{ action.text }}</MkButton
>         >
>       </div>
>     </div>
>   </MkModal>
42,47c96,101
< import { onBeforeUnmount, onMounted, ref, shallowRef } from 'vue';
< import MkModal from '@/components/MkModal.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import { i18n } from '@/i18n';
---
> import { onBeforeUnmount, onMounted, ref } from "vue";
> import MkModal from "@/components/MkModal.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import { i18n } from "@/i18n";
50,52c104,106
< 	type: HTMLInputElement['type'];
< 	placeholder?: string | null;
< 	default: any | null;
---
>   type: HTMLInputElement["type"];
>   placeholder?: string | null;
>   default: any | null;
56,67c110,121
< 	items: {
< 		value: string;
< 		text: string;
< 	}[];
< 	groupedItems: {
< 		label: string;
< 		items: {
< 			value: string;
< 			text: string;
< 		}[];
< 	}[];
< 	default: string | null;
---
>   items: {
>     value: string;
>     text: string;
>   }[];
>   groupedItems: {
>     label: string;
>     items: {
>       value: string;
>       text: string;
>     }[];
>   }[];
>   default: string | null;
70,90c124,147
< const props = withDefaults(defineProps<{
< 	type?: 'success' | 'error' | 'warning' | 'info' | 'question' | 'waiting';
< 	title: string;
< 	text?: string;
< 	input?: Input;
< 	select?: Select;
< 	icon?: string;
< 	actions?: {
< 		text: string;
< 		primary?: boolean,
< 		callback: (...args: any[]) => void;
< 	}[];
< 	showOkButton?: boolean;
< 	showCancelButton?: boolean;
< 	cancelableByBgClick?: boolean;
< }>(), {
< 	type: 'info',
< 	showOkButton: true,
< 	showCancelButton: false,
< 	cancelableByBgClick: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     type?: "success" | "error" | "warning" | "info" | "question" | "waiting";
>     title: string;
>     text?: string;
>     input?: Input;
>     select?: Select;
>     icon?: string;
>     actions?: {
>       text: string;
>       primary?: boolean;
>       callback: (...args: any[]) => void;
>     }[];
>     showOkButton?: boolean;
>     showCancelButton?: boolean;
>     cancelableByBgClick?: boolean;
>   }>(),
>   {
>     type: "info",
>     showOkButton: true,
>     showCancelButton: false,
>     cancelableByBgClick: true,
>   }
> );
93,94c150,151
< 	(ev: 'done', v: { canceled: boolean; result: any }): void;
< 	(ev: 'closed'): void;
---
>   (ev: "done", v: { canceled: boolean; result: any }): void;
>   (ev: "closed"): void;
97c154
< const modal = shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = ref<InstanceType<typeof MkModal>>();
103,104c160,161
< 	emit('done', { canceled, result });
< 	modal.value?.close();
---
>   emit("done", { canceled, result });
>   modal.value?.close();
108c165
< 	if (!props.showOkButton) return;
---
>   if (!props.showOkButton) return;
110,114c167,172
< 	const result =
< 		props.input ? inputValue.value :
< 		props.select ? selectedValue.value :
< 		true;
< 	done(false, result);
---
>   const result = props.input
>     ? inputValue.value
>     : props.select
>     ? selectedValue.value
>     : true;
>   done(false, result);
118c176
< 	done(true);
---
>   done(true);
126c184
< 	if (evt.key === 'Escape') cancel();
---
>   if (evt.key === "Escape") cancel();
130,134c188,192
< 	if (evt.key === 'Enter') {
< 		evt.preventDefault();
< 		evt.stopPropagation();
< 		ok();
< 	}
---
>   if (evt.key === "Enter") {
>     evt.preventDefault();
>     evt.stopPropagation();
>     ok();
>   }
138c196
< 	document.addEventListener('keydown', onKeydown);
---
>   document.addEventListener("keydown", onKeydown);
142c200
< 	document.removeEventListener('keydown', onKeydown);
---
>   document.removeEventListener("keydown", onKeydown);
146,157c204,213
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	margin: auto;
< 	padding: 32px;
< 	min-width: 320px;
< 	max-width: 480px;
< 	box-sizing: border-box;
< 	text-align: center;
< 	background: var(--panel);
< 	border-radius: var(--radius);
< }
---
> <style lang="scss" scoped>
> .mk-dialog {
>   position: relative;
>   padding: 32px;
>   min-width: 320px;
>   max-width: 480px;
>   box-sizing: border-box;
>   text-align: center;
>   background: var(--panel);
>   border-radius: var(--radius);
159,160c215,216
< .icon {
< 	font-size: 24px;
---
>   > .icon {
>     font-size: 32px;
162,165c218,220
< 	& + .title {
< 		margin-top: 8px;
< 	}
< }
---
>     &.info {
>       color: #55c4dd;
>     }
167,170c222,224
< .iconInner {
< 	display: block;
< 	margin: 0 auto;
< }
---
>     &.success {
>       color: var(--success);
>     }
172,174c226,228
< .type_info {
< 	color: #55c4dd;
< }
---
>     &.error {
>       color: var(--error);
>     }
176,178c230,232
< .type_success {
< 	color: var(--success);
< }
---
>     &.warning {
>       color: var(--warn);
>     }
180,182c234,237
< .type_error {
< 	color: var(--error);
< }
---
>     > * {
>       display: block;
>       margin: 0 auto;
>     }
184,186c239,242
< .type_warning {
< 	color: var(--warn);
< }
---
>     & + header {
>       margin-top: 16px;
>     }
>   }
188,191c244,247
< .title {
< 	margin: 0 0 8px 0;
< 	font-weight: bold;
< 	font-size: 1.1em;
---
>   > header {
>     margin: 0 0 8px 0;
>     font-weight: bold;
>     font-size: 1.2em;
193,196c249,252
< 	& + .text {
< 		margin-top: 8px;
< 	}
< }
---
>     & + .body {
>       margin-top: 8px;
>     }
>   }
198,200c254,256
< .text {
< 	margin: 16px 0 0 0;
< }
---
>   > .body {
>     margin: 16px 0 0 0;
>   }
202,207c258,264
< .buttons {
< 	margin-top: 16px;
< 	display: flex;
< 	gap: 8px;
< 	flex-wrap: wrap;
< 	justify-content: center;
---
>   > .buttons {
>     margin-top: 16px;
> 
>     > * {
>       margin: 0 8px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDigitalClock.vue RiricaV13/components/MkDigitalClock.vue
2,10c2,10
< <span>
< 	<span v-text="hh"></span>
< 	<span :class="[$style.colon, { [$style.showColon]: showColon }]">:</span>
< 	<span v-text="mm"></span>
< 	<span v-if="showS" :class="[$style.colon, { [$style.showColon]: showColon }]">:</span>
< 	<span v-if="showS" v-text="ss"></span>
< 	<span v-if="showMs" :class="[$style.colon, { [$style.showColon]: showColon }]">:</span>
< 	<span v-if="showMs" v-text="ms"></span>
< </span>
---
>   <span class="zjobosdg">
>     <span v-text="hh"></span>
>     <span class="colon" :class="{ showColon }">:</span>
>     <span v-text="mm"></span>
>     <span v-if="showS" class="colon" :class="{ showColon }">:</span>
>     <span v-if="showS" v-text="ss"></span>
>     <span v-if="showMs" class="colon" :class="{ showColon }">:</span>
>     <span v-if="showMs" v-text="ms"></span>
>   </span>
14c14
< import { onUnmounted, ref, watch } from 'vue';
---
> import { onUnmounted, ref, watch } from "vue";
16,24c16,27
< const props = withDefaults(defineProps<{
< 	showS?: boolean;
< 	showMs?: boolean;
< 	offset?: number;
< }>(), {
< 	showS: true,
< 	showMs: false,
< 	offset: 0 - new Date().getTimezoneOffset(),
< });
---
> const props = withDefaults(
>   defineProps<{
>     showS?: boolean;
>     showMs?: boolean;
>     offset?: number;
>   }>(),
>   {
>     showS: true,
>     showMs: false,
>     offset: 0 - new Date().getTimezoneOffset(),
>   }
> );
27,30c30,33
< const hh = ref('');
< const mm = ref('');
< const ss = ref('');
< const ms = ref('');
---
> const hh = ref("");
> const mm = ref("");
> const ss = ref("");
> const ms = ref("");
35,39c38,42
< 	if (v) {
< 		window.setTimeout(() => {
< 			showColon.value = false;
< 		}, 30);
< 	}
---
>   if (v) {
>     window.setTimeout(() => {
>       showColon.value = false;
>     }, 30);
>   }
43,50c46,57
< 	const now = new Date();
< 	now.setMinutes(now.getMinutes() + (new Date().getTimezoneOffset() + props.offset));
< 	hh.value = now.getHours().toString().padStart(2, '0');
< 	mm.value = now.getMinutes().toString().padStart(2, '0');
< 	ss.value = now.getSeconds().toString().padStart(2, '0');
< 	ms.value = Math.floor(now.getMilliseconds() / 10).toString().padStart(2, '0');
< 	if (now.getSeconds() !== prevSec) showColon.value = true;
< 	prevSec = now.getSeconds();
---
>   const now = new Date();
>   now.setMinutes(
>     now.getMinutes() + (new Date().getTimezoneOffset() + props.offset)
>   );
>   hh.value = now.getHours().toString().padStart(2, "0");
>   mm.value = now.getMinutes().toString().padStart(2, "0");
>   ss.value = now.getSeconds().toString().padStart(2, "0");
>   ms.value = Math.floor(now.getMilliseconds() / 10)
>     .toString()
>     .padStart(2, "0");
>   if (now.getSeconds() !== prevSec) showColon.value = true;
>   prevSec = now.getSeconds();
55,58c62,69
< watch(() => props.showMs, () => {
< 	if (intervalId) window.clearInterval(intervalId);
< 	intervalId = window.setInterval(tick, props.showMs ? 10 : 1000);
< }, { immediate: true });
---
> watch(
>   () => props.showMs,
>   () => {
>     if (intervalId) window.clearInterval(intervalId);
>     intervalId = window.setInterval(tick, props.showMs ? 10 : 1000);
>   },
>   { immediate: true }
> );
61c72
< 	window.clearInterval(intervalId);
---
>   window.clearInterval(intervalId);
65,68c76,80
< <style lang="scss" module>
< .colon {
< 	opacity: 0;
< 	transition: opacity 1s ease;
---
> <style lang="scss" scoped>
> .zjobosdg {
>   > .colon {
>     opacity: 0;
>     transition: opacity 1s ease;
70,73c82,86
< 	&.showColon {
< 		opacity: 1;
< 		transition: opacity 0s;
< 	}
---
>     &.showColon {
>       opacity: 1;
>       transition: opacity 0s;
>     }
>   }
Only in misskeyV13/packages/frontend/src/components: MkDonation.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDrive.file.vue RiricaV13/components/MkDrive.file.vue
2,23c2,23
< <div
< 	class="ncvczrfv"
< 	:class="{ isSelected }"
< 	draggable="true"
< 	:title="title"
< 	@click="onClick"
< 	@contextmenu.stop="onContextmenu"
< 	@dragstart="onDragstart"
< 	@dragend="onDragend"
< >
< 	<div v-if="$i?.avatarId == file.id" class="label">
< 		<img src="/client-assets/label.svg"/>
< 		<p>{{ i18n.ts.avatar }}</p>
< 	</div>
< 	<div v-if="$i?.bannerId == file.id" class="label">
< 		<img src="/client-assets/label.svg"/>
< 		<p>{{ i18n.ts.banner }}</p>
< 	</div>
< 	<div v-if="file.isSensitive" class="label red">
< 		<img src="/client-assets/label-red.svg"/>
< 		<p>{{ i18n.ts.nsfw }}</p>
< 	</div>
---
>   <div
>     class="ncvczrfv"
>     :class="{ isSelected }"
>     draggable="true"
>     :title="title"
>     @click="onClick"
>     @contextmenu.stop="onContextmenu"
>     @dragstart="onDragstart"
>     @dragend="onDragend"
>   >
>     <div v-if="$i?.avatarId == file.id" class="label">
>       <img src="/client-assets/label.svg" />
>       <p>{{ i18n.ts.avatar }}</p>
>     </div>
>     <div v-if="$i?.bannerId == file.id" class="label">
>       <img src="/client-assets/label.svg" />
>       <p>{{ i18n.ts.banner }}</p>
>     </div>
>     <div v-if="file.isSensitive" class="label red">
>       <img src="/client-assets/label-red.svg" />
>       <p>{{ i18n.ts.nsfw }}</p>
>     </div>
25c25
< 	<MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain"/>
---
>     <MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain" />
27,31c27,37
< 	<p class="name">
< 		<span>{{ file.name.lastIndexOf('.') != -1 ? file.name.substr(0, file.name.lastIndexOf('.')) : file.name }}</span>
< 		<span v-if="file.name.lastIndexOf('.') != -1" class="ext">{{ file.name.substr(file.name.lastIndexOf('.')) }}</span>
< 	</p>
< </div>
---
>     <p class="name">
>       <span>{{
>         file.name.lastIndexOf(".") != -1
>           ? file.name.substr(0, file.name.lastIndexOf("."))
>           : file.name
>       }}</span>
>       <span v-if="file.name.lastIndexOf('.') != -1" class="ext">{{
>         file.name.substr(file.name.lastIndexOf("."))
>       }}</span>
>     </p>
>   </div>
35,42c41,48
< import { computed, defineAsyncComponent, ref } from 'vue';
< import * as Misskey from 'misskey-js';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import MkDriveFileThumbnail from '@/components/MkDriveFileThumbnail.vue';
< import bytes from '@/filters/bytes';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
---
> import { computed, defineAsyncComponent, ref } from "vue";
> import * as Misskey from "misskey-js";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import MkDriveFileThumbnail from "@/components/MkDriveFileThumbnail.vue";
> import bytes from "@/filters/bytes";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
44,51c50,60
< const props = withDefaults(defineProps<{
< 	file: Misskey.entities.DriveFile;
< 	isSelected?: boolean;
< 	selectMode?: boolean;
< }>(), {
< 	isSelected: false,
< 	selectMode: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     file: Misskey.entities.DriveFile;
>     isSelected?: boolean;
>     selectMode?: boolean;
>   }>(),
>   {
>     isSelected: false,
>     selectMode: false,
>   }
> );
54,56c63,65
< 	(ev: 'chosen', r: Misskey.entities.DriveFile): void;
< 	(ev: 'dragstart'): void;
< 	(ev: 'dragend'): void;
---
>   (ev: "chosen", r: Misskey.entities.DriveFile): void;
>   (ev: "dragstart"): void;
>   (ev: "dragend"): void;
61c70,72
< const title = computed(() => `${props.file.name}\n${props.file.type} ${bytes(props.file.size)}`);
---
> const title = computed(
>   () => `${props.file.name}\n${props.file.type} ${bytes(props.file.size)}`
> );
64,92c75,114
< 	return [{
< 		text: i18n.ts.rename,
< 		icon: 'ti ti-forms',
< 		action: rename,
< 	}, {
< 		text: props.file.isSensitive ? i18n.ts.unmarkAsSensitive : i18n.ts.markAsSensitive,
< 		icon: props.file.isSensitive ? 'ti ti-eye' : 'ti ti-eye-off',
< 		action: toggleSensitive,
< 	}, {
< 		text: i18n.ts.describeFile,
< 		icon: 'ti ti-text-caption',
< 		action: describe,
< 	}, null, {
< 		text: i18n.ts.copyUrl,
< 		icon: 'ti ti-link',
< 		action: copyUrl,
< 	}, {
< 		type: 'a',
< 		href: props.file.url,
< 		target: '_blank',
< 		text: i18n.ts.download,
< 		icon: 'ti ti-download',
< 		download: props.file.name,
< 	}, null, {
< 		text: i18n.ts.delete,
< 		icon: 'ti ti-trash',
< 		danger: true,
< 		action: deleteFile,
< 	}];
---
>   return [
>     {
>       text: i18n.ts.rename,
>       icon: "fas fa-i-cursor",
>       action: rename,
>     },
>     {
>       text: props.file.isSensitive
>         ? i18n.ts.unmarkAsSensitive
>         : i18n.ts.markAsSensitive,
>       icon: props.file.isSensitive ? "fas fa-eye" : "fas fa-eye-slash",
>       action: toggleSensitive,
>     },
>     {
>       text: i18n.ts.describeFile,
>       icon: "fas fa-i-cursor",
>       action: describe,
>     },
>     null,
>     {
>       text: i18n.ts.copyUrl,
>       icon: "fas fa-link",
>       action: copyUrl,
>     },
>     {
>       type: "a",
>       href: props.file.url,
>       target: "_blank",
>       text: i18n.ts.download,
>       icon: "fas fa-download",
>       download: props.file.name,
>     },
>     null,
>     {
>       text: i18n.ts.delete,
>       icon: "fas fa-trash-alt",
>       danger: true,
>       action: deleteFile,
>     },
>   ];
96,100c118,125
< 	if (props.selectMode) {
< 		emit('chosen', props.file);
< 	} else {
< 		os.popupMenu(getMenu(), (ev.currentTarget ?? ev.target ?? undefined) as HTMLElement | undefined);
< 	}
---
>   if (props.selectMode) {
>     emit("chosen", props.file);
>   } else {
>     os.popupMenu(
>       getMenu(),
>       (ev.currentTarget ?? ev.target ?? undefined) as HTMLElement | undefined
>     );
>   }
104c129
< 	os.contextMenu(getMenu(), ev);
---
>   os.contextMenu(getMenu(), ev);
108,112c133,140
< 	if (ev.dataTransfer) {
< 		ev.dataTransfer.effectAllowed = 'move';
< 		ev.dataTransfer.setData(_DATA_TRANSFER_DRIVE_FILE_, JSON.stringify(props.file));
< 	}
< 	isDragging.value = true;
---
>   if (ev.dataTransfer) {
>     ev.dataTransfer.effectAllowed = "move";
>     ev.dataTransfer.setData(
>       _DATA_TRANSFER_DRIVE_FILE_,
>       JSON.stringify(props.file)
>     );
>   }
>   isDragging.value = true;
114c142
< 	emit('dragstart');
---
>   emit("dragstart");
118,119c146,147
< 	isDragging.value = false;
< 	emit('dragend');
---
>   isDragging.value = false;
>   emit("dragend");
123,133c151,161
< 	os.inputText({
< 		title: i18n.ts.renameFile,
< 		placeholder: i18n.ts.inputNewFileName,
< 		default: props.file.name,
< 	}).then(({ canceled, result: name }) => {
< 		if (canceled) return;
< 		os.api('drive/files/update', {
< 			fileId: props.file.id,
< 			name: name,
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.renameFile,
>     placeholder: i18n.ts.inputNewFileName,
>     default: props.file.name,
>   }).then(({ canceled, result: name }) => {
>     if (canceled) return;
>     os.api("drive/files/update", {
>       fileId: props.file.id,
>       name: name,
>     });
>   });
137,147c165,186
< 	os.popup(defineAsyncComponent(() => import('@/components/MkFileCaptionEditWindow.vue')), {
< 		default: props.file.comment != null ? props.file.comment : '',
< 		file: props.file,
< 	}, {
< 		done: caption => {
< 			os.api('drive/files/update', {
< 				fileId: props.file.id,
< 				comment: caption.length === 0 ? null : caption,
< 			});
< 		},
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkMediaCaption.vue")),
>     {
>       title: i18n.ts.describeFile,
>       input: {
>         placeholder: i18n.ts.inputNewDescription,
>         default: props.file.comment != null ? props.file.comment : "",
>       },
>       image: props.file,
>     },
>     {
>       done: (result) => {
>         if (!result || result.canceled) return;
>         let comment = result.result;
>         os.api("drive/files/update", {
>           fileId: props.file.id,
>           comment: comment.length === 0 ? null : comment,
>         });
>       },
>     },
>     "closed"
>   );
151,154c190,193
< 	os.api('drive/files/update', {
< 		fileId: props.file.id,
< 		isSensitive: !props.file.isSensitive,
< 	});
---
>   os.api("drive/files/update", {
>     fileId: props.file.id,
>     isSensitive: !props.file.isSensitive,
>   });
158,159c197,198
< 	copyToClipboard(props.file.url);
< 	os.success();
---
>   copyToClipboard(props.file.url);
>   os.success();
167,170c206,209
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.t('driveFileDeleteConfirm', { name: props.file.name }),
< 	});
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.t("driveFileDeleteConfirm", { name: props.file.name }),
>   });
172,175c211,214
< 	if (canceled) return;
< 	os.api('drive/files/delete', {
< 		fileId: props.file.id,
< 	});
---
>   if (canceled) return;
>   os.api("drive/files/delete", {
>     fileId: props.file.id,
>   });
181,184c220,223
< 	position: relative;
< 	padding: 8px 0 0 0;
< 	min-height: 180px;
< 	border-radius: 8px;
---
>   position: relative;
>   padding: 8px 0 0 0;
>   min-height: 180px;
>   border-radius: 8px;
186,188c225,228
< 	&, * {
< 		cursor: pointer;
< 	}
---
>   &,
>   * {
>     cursor: pointer;
>   }
190,192c230,232
< 	> * {
< 		pointer-events: none;
< 	}
---
>   > * {
>     pointer-events: none;
>   }
194,195c234,235
< 	&:hover {
< 		background: rgba(#000, 0.05);
---
>   &:hover {
>     background: rgba(#000, 0.05);
197,201c237,241
< 		> .label {
< 			&:before,
< 			&:after {
< 				background: #0b65a5;
< 			}
---
>     > .label {
>       &:before,
>       &:after {
>         background: #0b65a5;
>       }
203,210c243,250
< 			&.red {
< 				&:before,
< 				&:after {
< 					background: #c12113;
< 				}
< 			}
< 		}
< 	}
---
>       &.red {
>         &:before,
>         &:after {
>           background: #c12113;
>         }
>       }
>     }
>   }
212,213c252,253
< 	&:active {
< 		background: rgba(#000, 0.1);
---
>   &:active {
>     background: rgba(#000, 0.1);
215,219c255,259
< 		> .label {
< 			&:before,
< 			&:after {
< 				background: #0b588c;
< 			}
---
>     > .label {
>       &:before,
>       &:after {
>         background: #0b588c;
>       }
221,228c261,268
< 			&.red {
< 				&:before,
< 				&:after {
< 					background: #ce2212;
< 				}
< 			}
< 		}
< 	}
---
>       &.red {
>         &:before,
>         &:after {
>           background: #ce2212;
>         }
>       }
>     }
>   }
230,231c270,271
< 	&.isSelected {
< 		background: var(--accent);
---
>   &.isSelected {
>     background: var(--accent);
233,235c273,275
< 		&:hover {
< 			background: var(--accentLighten);
< 		}
---
>     &:hover {
>       background: var(--accentLighten);
>     }
237,239c277,279
< 		&:active {
< 			background: var(--accentDarken);
< 		}
---
>     &:active {
>       background: var(--accentDarken);
>     }
241,246c281,286
< 		> .label {
< 			&:before,
< 			&:after {
< 				display: none;
< 			}
< 		}
---
>     > .label {
>       &:before,
>       &:after {
>         display: none;
>       }
>     }
248,250c288,290
< 		> .name {
< 			color: #fff;
< 		}
---
>     > .name {
>       color: #fff;
>     }
252,255c292,295
< 		> .thumbnail {
< 			color: #fff;
< 		}
< 	}
---
>     > .thumbnail {
>       color: #fff;
>     }
>   }
257,261c297,301
< 	> .label {
< 		position: absolute;
< 		top: 0;
< 		left: 0;
< 		pointer-events: none;
---
>   > .label {
>     position: absolute;
>     top: 0;
>     left: 0;
>     pointer-events: none;
263,270c303,310
< 		&:before,
< 		&:after {
< 			content: "";
< 			display: block;
< 			position: absolute;
< 			z-index: 1;
< 			background: #0c7ac9;
< 		}
---
>     &:before,
>     &:after {
>       content: "";
>       display: block;
>       position: absolute;
>       z-index: 1;
>       background: #0c7ac9;
>     }
272,277c312,317
< 		&:before {
< 			top: 0;
< 			left: 57px;
< 			width: 28px;
< 			height: 8px;
< 		}
---
>     &:before {
>       top: 0;
>       left: 57px;
>       width: 28px;
>       height: 8px;
>     }
279,284c319,324
< 		&:after {
< 			top: 57px;
< 			left: 0;
< 			width: 8px;
< 			height: 28px;
< 		}
---
>     &:after {
>       top: 57px;
>       left: 0;
>       width: 8px;
>       height: 28px;
>     }
286,291c326,331
< 		&.red {
< 			&:before,
< 			&:after {
< 				background: #c12113;
< 			}
< 		}
---
>     &.red {
>       &:before,
>       &:after {
>         background: #c12113;
>       }
>     }
293,298c333,338
< 		> img {
< 			position: absolute;
< 			z-index: 2;
< 			top: 0;
< 			left: 0;
< 		}
---
>     > img {
>       position: absolute;
>       z-index: 2;
>       top: 0;
>       left: 0;
>     }
300,312c340,352
< 		> p {
< 			position: absolute;
< 			z-index: 3;
< 			top: 19px;
< 			left: -28px;
< 			width: 120px;
< 			margin: 0;
< 			text-align: center;
< 			line-height: 28px;
< 			color: #fff;
< 			transform: rotate(-45deg);
< 		}
< 	}
---
>     > p {
>       position: absolute;
>       z-index: 3;
>       top: 19px;
>       left: -28px;
>       width: 120px;
>       margin: 0;
>       text-align: center;
>       line-height: 28px;
>       color: #fff;
>       transform: rotate(-45deg);
>     }
>   }
314,318c354,358
< 	> .thumbnail {
< 		width: 110px;
< 		height: 110px;
< 		margin: auto;
< 	}
---
>   > .thumbnail {
>     width: 110px;
>     height: 110px;
>     margin: auto;
>   }
320,327c360,367
< 	> .name {
< 		display: block;
< 		margin: 4px 0 0 0;
< 		font-size: 0.8em;
< 		text-align: center;
< 		word-break: break-all;
< 		color: var(--fg);
< 		overflow: hidden;
---
>   > .name {
>     display: block;
>     margin: 4px 0 0 0;
>     font-size: 0.8em;
>     text-align: center;
>     word-break: break-all;
>     color: var(--fg);
>     overflow: hidden;
329,332c369,372
< 		> .ext {
< 			opacity: 0.5;
< 		}
< 	}
---
>     > .ext {
>       opacity: 0.5;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDrive.folder.vue RiricaV13/components/MkDrive.folder.vue
2,27c2,32
< <div
< 	class="rghtznwe"
< 	:class="{ draghover }"
< 	draggable="true"
< 	:title="title"
< 	@click="onClick"
< 	@contextmenu.stop="onContextmenu"
< 	@mouseover="onMouseover"
< 	@mouseout="onMouseout"
< 	@dragover.prevent.stop="onDragover"
< 	@dragenter.prevent="onDragenter"
< 	@dragleave="onDragleave"
< 	@drop.prevent.stop="onDrop"
< 	@dragstart="onDragstart"
< 	@dragend="onDragend"
< >
< 	<p class="name">
< 		<template v-if="hover"><i class="ti ti-folder ti-fw"></i></template>
< 		<template v-if="!hover"><i class="ti ti-folder ti-fw"></i></template>
< 		{{ folder.name }}
< 	</p>
< 	<p v-if="defaultStore.state.uploadFolder == folder.id" class="upload">
< 		{{ i18n.ts.uploadFolder }}
< 	</p>
< 	<button v-if="selectMode" class="checkbox _button" :class="{ checked: isSelected }" @click.prevent.stop="checkboxClicked"></button>
< </div>
---
>   <div
>     class="rghtznwe"
>     :class="{ draghover }"
>     draggable="true"
>     :title="title"
>     @click="onClick"
>     @contextmenu.stop="onContextmenu"
>     @mouseover="onMouseover"
>     @mouseout="onMouseout"
>     @dragover.prevent.stop="onDragover"
>     @dragenter.prevent="onDragenter"
>     @dragleave="onDragleave"
>     @drop.prevent.stop="onDrop"
>     @dragstart="onDragstart"
>     @dragend="onDragend"
>   >
>     <p class="name">
>       <template v-if="hover"><i class="fas fa-folder-open fa-fw"></i></template>
>       <template v-if="!hover"><i class="fas fa-folder fa-fw"></i></template>
>       {{ folder.name }}
>     </p>
>     <p v-if="defaultStore.state.uploadFolder == folder.id" class="upload">
>       {{ i18n.ts.uploadFolder }}
>     </p>
>     <button
>       v-if="selectMode"
>       class="checkbox _button"
>       :class="{ checked: isSelected }"
>       @click.prevent.stop="checkboxClicked"
>     ></button>
>   </div>
31,36c36,40
< import { computed, defineAsyncComponent, ref } from 'vue';
< import * as Misskey from 'misskey-js';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { computed, defineAsyncComponent, ref } from "vue";
> import * as Misskey from "misskey-js";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
38,45c42,52
< const props = withDefaults(defineProps<{
< 	folder: Misskey.entities.DriveFolder;
< 	isSelected?: boolean;
< 	selectMode?: boolean;
< }>(), {
< 	isSelected: false,
< 	selectMode: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     folder: Misskey.entities.DriveFolder;
>     isSelected?: boolean;
>     selectMode?: boolean;
>   }>(),
>   {
>     isSelected: false,
>     selectMode: false,
>   }
> );
48,54c55,61
< 	(ev: 'chosen', v: Misskey.entities.DriveFolder): void;
< 	(ev: 'move', v: Misskey.entities.DriveFolder): void;
< 	(ev: 'upload', file: File, folder: Misskey.entities.DriveFolder);
< 	(ev: 'removeFile', v: Misskey.entities.DriveFile['id']): void;
< 	(ev: 'removeFolder', v: Misskey.entities.DriveFolder['id']): void;
< 	(ev: 'dragstart'): void;
< 	(ev: 'dragend'): void;
---
>   (ev: "chosen", v: Misskey.entities.DriveFolder): void;
>   (ev: "move", v: Misskey.entities.DriveFolder): void;
>   (ev: "upload", file: File, folder: Misskey.entities.DriveFolder);
>   (ev: "removeFile", v: Misskey.entities.DriveFile["id"]): void;
>   (ev: "removeFolder", v: Misskey.entities.DriveFolder["id"]): void;
>   (ev: "dragstart"): void;
>   (ev: "dragend"): void;
64c71
< 	emit('chosen', props.folder);
---
>   emit("chosen", props.folder);
68c75
< 	emit('move', props.folder);
---
>   emit("move", props.folder);
72c79
< 	hover.value = true;
---
>   hover.value = true;
76c83
< 	hover.value = false;
---
>   hover.value = false;
80c87
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
82,87c89,94
< 	// 自分自身がドラッグされている場合
< 	if (isDragging.value) {
< 		// 自分自身にはドロップさせない
< 		ev.dataTransfer.dropEffect = 'none';
< 		return;
< 	}
---
>   // 自分自身がドラッグされている場合
>   if (isDragging.value) {
>     // 自分自身にはドロップさせない
>     ev.dataTransfer.dropEffect = "none";
>     return;
>   }
89,91c96,99
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
< 	const isDriveFolder = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
---
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
>   const isDriveFolder =
>     ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
93,112c101,120
< 	if (isFile || isDriveFile || isDriveFolder) {
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	} else {
< 		ev.dataTransfer.dropEffect = 'none';
< 	}
---
>   if (isFile || isDriveFile || isDriveFolder) {
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   } else {
>     ev.dataTransfer.dropEffect = "none";
>   }
116c124
< 	if (!isDragging.value) draghover.value = true;
---
>   if (!isDragging.value) draghover.value = true;
120c128
< 	draghover.value = false;
---
>   draghover.value = false;
124c132
< 	draghover.value = false;
---
>   draghover.value = false;
126c134
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
128,134c136,142
< 	// ファイルだったら
< 	if (ev.dataTransfer.files.length > 0) {
< 		for (const file of Array.from(ev.dataTransfer.files)) {
< 			emit('upload', file, props.folder);
< 		}
< 		return;
< 	}
---
>   // ファイルだったら
>   if (ev.dataTransfer.files.length > 0) {
>     for (const file of Array.from(ev.dataTransfer.files)) {
>       emit("upload", file, props.folder);
>     }
>     return;
>   }
136,146c144,154
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		const file = JSON.parse(driveFile);
< 		emit('removeFile', file.id);
< 		os.api('drive/files/update', {
< 			fileId: file.id,
< 			folderId: props.folder.id,
< 		});
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     const file = JSON.parse(driveFile);
>     emit("removeFile", file.id);
>     os.api("drive/files/update", {
>       fileId: file.id,
>       folderId: props.folder.id,
>     });
>   }
>   //#endregion
148,151c156,159
< 	//#region ドライブのフォルダ
< 	const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
< 	if (driveFolder != null && driveFolder !== '') {
< 		const folder = JSON.parse(driveFolder);
---
>   //#region ドライブのフォルダ
>   const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
>   if (driveFolder != null && driveFolder !== "") {
>     const folder = JSON.parse(driveFolder);
153,154c161,162
< 		// 移動先が自分自身ならreject
< 		if (folder.id === props.folder.id) return;
---
>     // 移動先が自分自身ならreject
>     if (folder.id === props.folder.id) return;
156,180c164,188
< 		emit('removeFolder', folder.id);
< 		os.api('drive/folders/update', {
< 			folderId: folder.id,
< 			parentId: props.folder.id,
< 		}).then(() => {
< 			// noop
< 		}).catch(err => {
< 			switch (err.code) {
< 				case 'RECURSIVE_NESTING':
< 					claimAchievement('driveFolderCircularReference');
< 					os.alert({
< 						type: 'error',
< 						title: i18n.ts.unableToProcess,
< 						text: i18n.ts.circularReferenceFolder,
< 					});
< 					break;
< 				default:
< 					os.alert({
< 						type: 'error',
< 						text: i18n.ts.somethingHappened,
< 					});
< 			}
< 		});
< 	}
< 	//#endregion
---
>     emit("removeFolder", folder.id);
>     os.api("drive/folders/update", {
>       folderId: folder.id,
>       parentId: props.folder.id,
>     })
>       .then(() => {
>         // noop
>       })
>       .catch((err) => {
>         switch (err) {
>           case "detected-circular-definition":
>             os.alert({
>               title: i18n.ts.unableToProcess,
>               text: i18n.ts.circularReferenceFolder,
>             });
>             break;
>           default:
>             os.alert({
>               type: "error",
>               text: i18n.ts.somethingHappened,
>             });
>         }
>       });
>   }
>   //#endregion
184c192
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
186,188c194,199
< 	ev.dataTransfer.effectAllowed = 'move';
< 	ev.dataTransfer.setData(_DATA_TRANSFER_DRIVE_FOLDER_, JSON.stringify(props.folder));
< 	isDragging.value = true;
---
>   ev.dataTransfer.effectAllowed = "move";
>   ev.dataTransfer.setData(
>     _DATA_TRANSFER_DRIVE_FOLDER_,
>     JSON.stringify(props.folder)
>   );
>   isDragging.value = true;
190,192c201,203
< 	// 親ブラウザに対して、ドラッグが開始されたフラグを立てる
< 	// (=あなたの子供が、ドラッグを開始しましたよ)
< 	emit('dragstart');
---
>   // 親ブラウザに対して、ドラッグが開始されたフラグを立てる
>   // (=あなたの子供が、ドラッグを開始しましたよ)
>   emit("dragstart");
196,197c207,208
< 	isDragging.value = false;
< 	emit('dragend');
---
>   isDragging.value = false;
>   emit("dragend");
201c212
< 	emit('move', props.folder.id);
---
>   emit("move", props.folder.id);
205,215c216,226
< 	os.inputText({
< 		title: i18n.ts.renameFolder,
< 		placeholder: i18n.ts.inputNewFolderName,
< 		default: props.folder.name,
< 	}).then(({ canceled, result: name }) => {
< 		if (canceled) return;
< 		os.api('drive/folders/update', {
< 			folderId: props.folder.id,
< 			name: name,
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.renameFolder,
>     placeholder: i18n.ts.inputNewFolderName,
>     default: props.folder.name,
>   }).then(({ canceled, result: name }) => {
>     if (canceled) return;
>     os.api("drive/folders/update", {
>       folderId: props.folder.id,
>       name: name,
>     });
>   });
219,240c230,253
< 	os.api('drive/folders/delete', {
< 		folderId: props.folder.id,
< 	}).then(() => {
< 		if (defaultStore.state.uploadFolder === props.folder.id) {
< 			defaultStore.set('uploadFolder', null);
< 		}
< 	}).catch(err => {
< 		switch (err.id) {
< 			case 'b0fc8a17-963c-405d-bfbc-859a487295e1':
< 				os.alert({
< 					type: 'error',
< 					title: i18n.ts.unableToDelete,
< 					text: i18n.ts.hasChildFilesOrFolders,
< 				});
< 				break;
< 			default:
< 				os.alert({
< 					type: 'error',
< 					text: i18n.ts.unableToDelete,
< 				});
< 		}
< 	});
---
>   os.api("drive/folders/delete", {
>     folderId: props.folder.id,
>   })
>     .then(() => {
>       if (defaultStore.state.uploadFolder === props.folder.id) {
>         defaultStore.set("uploadFolder", null);
>       }
>     })
>     .catch((err) => {
>       switch (err.id) {
>         case "b0fc8a17-963c-405d-bfbc-859a487295e1":
>           os.alert({
>             type: "error",
>             title: i18n.ts.unableToDelete,
>             text: i18n.ts.hasChildFilesOrFolders,
>           });
>           break;
>         default:
>           os.alert({
>             type: "error",
>             text: i18n.ts.unableToDelete,
>           });
>       }
>     });
244c257
< 	defaultStore.set('uploadFolder', props.folder.id);
---
>   defaultStore.set("uploadFolder", props.folder.id);
248,266c261,294
< 	os.contextMenu([{
< 		text: i18n.ts.openInWindow,
< 		icon: 'ti ti-app-window',
< 		action: () => {
< 			os.popup(defineAsyncComponent(() => import('@/components/MkDriveWindow.vue')), {
< 				initialFolder: props.folder,
< 			}, {
< 			}, 'closed');
< 		},
< 	}, null, {
< 		text: i18n.ts.rename,
< 		icon: 'ti ti-forms',
< 		action: rename,
< 	}, null, {
< 		text: i18n.ts.delete,
< 		icon: 'ti ti-trash',
< 		danger: true,
< 		action: deleteFolder,
< 	}], ev);
---
>   os.contextMenu(
>     [
>       {
>         text: i18n.ts.openInWindow,
>         icon: "fas fa-window-restore",
>         action: () => {
>           os.popup(
>             defineAsyncComponent(
>               () => import("@/components/MkDriveWindow.vue")
>             ),
>             {
>               initialFolder: props.folder,
>             },
>             {},
>             "closed"
>           );
>         },
>       },
>       null,
>       {
>         text: i18n.ts.rename,
>         icon: "fas fa-i-cursor",
>         action: rename,
>       },
>       null,
>       {
>         text: i18n.ts.delete,
>         icon: "fas fa-trash-alt",
>         danger: true,
>         action: deleteFolder,
>       },
>     ],
>     ev
>   );
272,276c300,304
< 	position: relative;
< 	padding: 8px;
< 	height: 64px;
< 	background: var(--driveFolderBg);
< 	border-radius: 4px;
---
>   position: relative;
>   padding: 8px;
>   height: 64px;
>   background: var(--driveFolderBg);
>   border-radius: 4px;
278,280c306,309
< 	&, * {
< 		cursor: pointer;
< 	}
---
>   &,
>   * {
>     cursor: pointer;
>   }
282,284c311,313
< 	*:not(.checkbox) {
< 		pointer-events: none;
< 	}
---
>   *:not(.checkbox) {
>     pointer-events: none;
>   }
286,293c315,322
< 	> .checkbox {
< 		position: absolute;
< 		bottom: 8px;
< 		right: 8px;
< 		width: 16px;
< 		height: 16px;
< 		background: #fff;
< 		border: solid 1px #000;
---
>   > .checkbox {
>     position: absolute;
>     bottom: 8px;
>     right: 8px;
>     width: 16px;
>     height: 16px;
>     background: #fff;
>     border: solid 1px #000;
295,298c324,327
< 		&.checked {
< 			background: var(--accent);
< 		}
< 	}
---
>     &.checked {
>       background: var(--accent);
>     }
>   }
300,312c329,341
< 	&.draghover {
< 		&:after {
< 			content: "";
< 			pointer-events: none;
< 			position: absolute;
< 			top: -4px;
< 			right: -4px;
< 			bottom: -4px;
< 			left: -4px;
< 			border: 2px dashed var(--focus);
< 			border-radius: 4px;
< 		}
< 	}
---
>   &.draghover {
>     &:after {
>       content: "";
>       pointer-events: none;
>       position: absolute;
>       top: -4px;
>       right: -4px;
>       bottom: -4px;
>       left: -4px;
>       border: 2px dashed var(--focus);
>       border-radius: 4px;
>     }
>   }
314,317c343,346
< 	> .name {
< 		margin: 0;
< 		font-size: 0.9em;
< 		color: var(--desktopDriveFolderFg);
---
>   > .name {
>     margin: 0;
>     font-size: 0.9em;
>     color: var(--desktopDriveFolderFg);
319,324c348,353
< 		> i {
< 			margin-right: 4px;
< 			margin-left: 2px;
< 			text-align: left;
< 		}
< 	}
---
>     > i {
>       margin-right: 4px;
>       margin-left: 2px;
>       text-align: left;
>     }
>   }
326,331c355,360
< 	> .upload {
< 		margin: 4px 4px;
< 		font-size: 0.8em;
< 		text-align: right;
< 		color: var(--desktopDriveFolderFg);
< 	}
---
>   > .upload {
>     margin: 4px 4px;
>     font-size: 0.8em;
>     text-align: right;
>     color: var(--desktopDriveFolderFg);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDrive.navFolder.vue RiricaV13/components/MkDrive.navFolder.vue
2,12c2,13
< <div class="drylbebk"
< 	:class="{ draghover }"
< 	@click="onClick"
< 	@dragover.prevent.stop="onDragover"
< 	@dragenter="onDragenter"
< 	@dragleave="onDragleave"
< 	@drop.stop="onDrop"
< >
< 	<i v-if="folder == null" class="ti ti-cloud"></i>
< 	<span>{{ folder == null ? i18n.ts.drive : folder.name }}</span>
< </div>
---
>   <div
>     class="drylbebk"
>     :class="{ draghover }"
>     @click="onClick"
>     @dragover.prevent.stop="onDragover"
>     @dragenter="onDragenter"
>     @dragleave="onDragleave"
>     @drop.stop="onDrop"
>   >
>     <i v-if="folder == null" class="fas fa-cloud"></i>
>     <span>{{ folder == null ? i18n.ts.drive : folder.name }}</span>
>   </div>
16,19c17,20
< import { ref } from 'vue';
< import * as Misskey from 'misskey-js';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import * as Misskey from "misskey-js";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
22,23c23,24
< 	folder?: Misskey.entities.DriveFolder;
< 	parentFolder: Misskey.entities.DriveFolder | null;
---
>   folder?: Misskey.entities.DriveFolder;
>   parentFolder: Misskey.entities.DriveFolder | null;
27,30c28,35
< 	(ev: 'move', v?: Misskey.entities.DriveFolder): void;
< 	(ev: 'upload', file: File, folder?: Misskey.entities.DriveFolder | null): void;
< 	(ev: 'removeFile', v: Misskey.entities.DriveFile['id']): void;
< 	(ev: 'removeFolder', v: Misskey.entities.DriveFolder['id']): void;
---
>   (ev: "move", v?: Misskey.entities.DriveFolder): void;
>   (
>     ev: "upload",
>     file: File,
>     folder?: Misskey.entities.DriveFolder | null
>   ): void;
>   (ev: "removeFile", v: Misskey.entities.DriveFile["id"]): void;
>   (ev: "removeFolder", v: Misskey.entities.DriveFolder["id"]): void;
37c42
< 	emit('move', props.folder);
---
>   emit("move", props.folder);
41c46
< 	hover.value = true;
---
>   hover.value = true;
45c50
< 	hover.value = false;
---
>   hover.value = false;
49c54
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
51,54c56,59
< 	// このフォルダがルートかつカレントディレクトリならドロップ禁止
< 	if (props.folder == null && props.parentFolder == null) {
< 		ev.dataTransfer.dropEffect = 'none';
< 	}
---
>   // このフォルダがルートかつカレントディレクトリならドロップ禁止
>   if (props.folder == null && props.parentFolder == null) {
>     ev.dataTransfer.dropEffect = "none";
>   }
56,58c61,64
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
< 	const isDriveFolder = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
---
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
>   const isDriveFolder =
>     ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
60,79c66,85
< 	if (isFile || isDriveFile || isDriveFolder) {
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	} else {
< 		ev.dataTransfer.dropEffect = 'none';
< 	}
---
>   if (isFile || isDriveFile || isDriveFolder) {
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   } else {
>     ev.dataTransfer.dropEffect = "none";
>   }
81c87
< 	return false;
---
>   return false;
85c91
< 	if (props.folder || props.parentFolder) draghover.value = true;
---
>   if (props.folder || props.parentFolder) draghover.value = true;
89c95
< 	if (props.folder || props.parentFolder) draghover.value = false;
---
>   if (props.folder || props.parentFolder) draghover.value = false;
93c99
< 	draghover.value = false;
---
>   draghover.value = false;
95c101
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
97,103c103,109
< 	// ファイルだったら
< 	if (ev.dataTransfer.files.length > 0) {
< 		for (const file of Array.from(ev.dataTransfer.files)) {
< 			emit('upload', file, props.folder);
< 		}
< 		return;
< 	}
---
>   // ファイルだったら
>   if (ev.dataTransfer.files.length > 0) {
>     for (const file of Array.from(ev.dataTransfer.files)) {
>       emit("upload", file, props.folder);
>     }
>     return;
>   }
105,115c111,121
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		const file = JSON.parse(driveFile);
< 		emit('removeFile', file.id);
< 		os.api('drive/files/update', {
< 			fileId: file.id,
< 			folderId: props.folder ? props.folder.id : null,
< 		});
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     const file = JSON.parse(driveFile);
>     emit("removeFile", file.id);
>     os.api("drive/files/update", {
>       fileId: file.id,
>       folderId: props.folder ? props.folder.id : null,
>     });
>   }
>   //#endregion
117,129c123,135
< 	//#region ドライブのフォルダ
< 	const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
< 	if (driveFolder != null && driveFolder !== '') {
< 		const folder = JSON.parse(driveFolder);
< 		// 移動先が自分自身ならreject
< 		if (props.folder && folder.id === props.folder.id) return;
< 		emit('removeFolder', folder.id);
< 		os.api('drive/folders/update', {
< 			folderId: folder.id,
< 			parentId: props.folder ? props.folder.id : null,
< 		});
< 	}
< 	//#endregion
---
>   //#region ドライブのフォルダ
>   const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
>   if (driveFolder != null && driveFolder !== "") {
>     const folder = JSON.parse(driveFolder);
>     // 移動先が自分自身ならreject
>     if (props.folder && folder.id === props.folder.id) return;
>     emit("removeFolder", folder.id);
>     os.api("drive/folders/update", {
>       folderId: folder.id,
>       parentId: props.folder ? props.folder.id : null,
>     });
>   }
>   //#endregion
135,137c141,143
< 	> * {
< 		pointer-events: none;
< 	}
---
>   > * {
>     pointer-events: none;
>   }
139,141c145,147
< 	&.draghover {
< 		background: #eee;
< 	}
---
>   &.draghover {
>     background: #eee;
>   }
143,145c149,151
< 	> i {
< 		margin-right: 4px;
< 	}
---
>   > i {
>     margin-right: 4px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDrive.vue RiricaV13/components/MkDrive.vue
2,87c2,114
< <div class="yfudmmck">
< 	<nav>
< 		<div class="path" @contextmenu.prevent.stop="() => {}">
< 			<XNavFolder
< 				:class="{ current: folder == null }"
< 				:parent-folder="folder"
< 				@move="move"
< 				@upload="upload"
< 				@remove-file="removeFile"
< 				@remove-folder="removeFolder"
< 			/>
< 			<template v-for="f in hierarchyFolders">
< 				<span class="separator"><i class="ti ti-chevron-right"></i></span>
< 				<XNavFolder
< 					:folder="f"
< 					:parent-folder="folder"
< 					@move="move"
< 					@upload="upload"
< 					@remove-file="removeFile"
< 					@remove-folder="removeFolder"
< 				/>
< 			</template>
< 			<span v-if="folder != null" class="separator"><i class="ti ti-chevron-right"></i></span>
< 			<span v-if="folder != null" class="folder current">{{ folder.name }}</span>
< 		</div>
< 		<button class="menu _button" @click="showMenu"><i class="ti ti-dots"></i></button>
< 	</nav>
< 	<div
< 		ref="main" class="main"
< 		:class="{ uploading: uploadings.length > 0, fetching }"
< 		@dragover.prevent.stop="onDragover"
< 		@dragenter="onDragenter"
< 		@dragleave="onDragleave"
< 		@drop.prevent.stop="onDrop"
< 		@contextmenu.stop="onContextmenu"
< 	>
< 		<div ref="contents" class="contents">
< 			<div v-show="folders.length > 0" ref="foldersContainer" class="folders">
< 				<XFolder
< 					v-for="(f, i) in folders"
< 					:key="f.id"
< 					v-anim="i"
< 					class="folder"
< 					:folder="f"
< 					:select-mode="select === 'folder'"
< 					:is-selected="selectedFolders.some(x => x.id === f.id)"
< 					@chosen="chooseFolder"
< 					@move="move"
< 					@upload="upload"
< 					@remove-file="removeFile"
< 					@remove-folder="removeFolder"
< 					@dragstart="isDragSource = true"
< 					@dragend="isDragSource = false"
< 				/>
< 				<!-- SEE: https://stackoverflow.com/questions/18744164/flex-box-align-last-row-to-grid -->
< 				<div v-for="(n, i) in 16" :key="i" class="padding"></div>
< 				<MkButton v-if="moreFolders" ref="moreFolders">{{ i18n.ts.loadMore }}</MkButton>
< 			</div>
< 			<div v-show="files.length > 0" ref="filesContainer" class="files">
< 				<XFile
< 					v-for="(file, i) in files"
< 					:key="file.id"
< 					v-anim="i"
< 					class="file"
< 					:file="file"
< 					:select-mode="select === 'file'"
< 					:is-selected="selectedFiles.some(x => x.id === file.id)"
< 					@chosen="chooseFile"
< 					@dragstart="isDragSource = true"
< 					@dragend="isDragSource = false"
< 				/>
< 				<!-- SEE: https://stackoverflow.com/questions/18744164/flex-box-align-last-row-to-grid -->
< 				<div v-for="(n, i) in 16" :key="i" class="padding"></div>
< 				<MkButton v-show="moreFiles" ref="loadMoreFiles" @click="fetchMoreFiles">{{ i18n.ts.loadMore }}</MkButton>
< 			</div>
< 			<div v-if="files.length == 0 && folders.length == 0 && !fetching" class="empty">
< 				<p v-if="draghover">{{ i18n.t('empty-draghover') }}</p>
< 				<p v-if="!draghover && folder == null"><strong>{{ i18n.ts.emptyDrive }}</strong><br/>{{ i18n.t('empty-drive-description') }}</p>
< 				<p v-if="!draghover && folder != null">{{ i18n.ts.emptyFolder }}</p>
< 			</div>
< 		</div>
< 		<MkLoading v-if="fetching"/>
< 	</div>
< 	<div v-if="draghover" class="dropzone"></div>
< 	<input ref="fileInput" type="file" accept="*/*" multiple tabindex="-1" @change="onChangeFileInput"/>
< </div>
---
>   <div class="yfudmmck">
>     <nav>
>       <div class="path" @contextmenu.prevent.stop="() => {}">
>         <XNavFolder
>           :class="{ current: folder == null }"
>           :parent-folder="folder"
>           @move="move"
>           @upload="upload"
>           @removeFile="removeFile"
>           @removeFolder="removeFolder"
>         />
>         <template v-for="f in hierarchyFolders">
>           <span class="separator"><i class="fas fa-angle-right"></i></span>
>           <XNavFolder
>             :folder="f"
>             :parent-folder="folder"
>             @move="move"
>             @upload="upload"
>             @removeFile="removeFile"
>             @removeFolder="removeFolder"
>           />
>         </template>
>         <span v-if="folder != null" class="separator"
>           ><i class="fas fa-angle-right"></i
>         ></span>
>         <span v-if="folder != null" class="folder current">{{
>           folder.name
>         }}</span>
>       </div>
>       <button class="menu _button" @click="showMenu">
>         <i class="fas fa-ellipsis-h"></i>
>       </button>
>     </nav>
>     <div
>       ref="main"
>       class="main"
>       :class="{ uploading: uploadings.length > 0, fetching }"
>       @dragover.prevent.stop="onDragover"
>       @dragenter="onDragenter"
>       @dragleave="onDragleave"
>       @drop.prevent.stop="onDrop"
>       @contextmenu.stop="onContextmenu"
>     >
>       <div ref="contents" class="contents">
>         <div v-show="folders.length > 0" ref="foldersContainer" class="folders">
>           <XFolder
>             v-for="(f, i) in folders"
>             :key="f.id"
>             v-anim="i"
>             class="folder"
>             :folder="f"
>             :select-mode="select === 'folder'"
>             :is-selected="selectedFolders.some((x) => x.id === f.id)"
>             @chosen="chooseFolder"
>             @move="move"
>             @upload="upload"
>             @removeFile="removeFile"
>             @removeFolder="removeFolder"
>             @dragstart="isDragSource = true"
>             @dragend="isDragSource = false"
>           />
>           <!-- SEE: https://stackoverflow.com/questions/18744164/flex-box-align-last-row-to-grid -->
>           <div v-for="(n, i) in 16" :key="i" class="padding"></div>
>           <MkButton v-if="moreFolders" ref="moreFolders">{{
>             i18n.ts.loadMore
>           }}</MkButton>
>         </div>
>         <div v-show="files.length > 0" ref="filesContainer" class="files">
>           <XFile
>             v-for="(file, i) in files"
>             :key="file.id"
>             v-anim="i"
>             class="file"
>             :file="file"
>             :select-mode="select === 'file'"
>             :is-selected="selectedFiles.some((x) => x.id === file.id)"
>             @chosen="chooseFile"
>             @dragstart="isDragSource = true"
>             @dragend="isDragSource = false"
>           />
>           <!-- SEE: https://stackoverflow.com/questions/18744164/flex-box-align-last-row-to-grid -->
>           <div v-for="(n, i) in 16" :key="i" class="padding"></div>
>           <MkButton
>             v-show="moreFiles"
>             ref="loadMoreFiles"
>             @click="fetchMoreFiles"
>             >{{ i18n.ts.loadMore }}</MkButton
>           >
>         </div>
>         <div
>           v-if="files.length == 0 && folders.length == 0 && !fetching"
>           class="empty"
>         >
>           <p v-if="draghover">{{ i18n.t("empty-draghover") }}</p>
>           <p v-if="!draghover && folder == null">
>             <strong>{{ i18n.ts.emptyDrive }}</strong
>             ><br />{{ i18n.t("empty-drive-description") }}
>           </p>
>           <p v-if="!draghover && folder != null">{{ i18n.ts.emptyFolder }}</p>
>         </div>
>       </div>
>       <MkLoading v-if="fetching" />
>     </div>
>     <div v-if="draghover" class="dropzone"></div>
>     <input
>       ref="fileInput"
>       type="file"
>       accept="*/*"
>       multiple
>       tabindex="-1"
>       @change="onChangeFileInput"
>     />
>   </div>
91,102c118,136
< import { markRaw, nextTick, onActivated, onBeforeUnmount, onMounted, ref, shallowRef, watch } from 'vue';
< import * as Misskey from 'misskey-js';
< import MkButton from './MkButton.vue';
< import XNavFolder from '@/components/MkDrive.navFolder.vue';
< import XFolder from '@/components/MkDrive.folder.vue';
< import XFile from '@/components/MkDrive.file.vue';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { uploadFile, uploads } from '@/scripts/upload';
< import { claimAchievement } from '@/scripts/achievements';
---
> import {
>   markRaw,
>   nextTick,
>   onActivated,
>   onBeforeUnmount,
>   onMounted,
>   ref,
>   watch,
> } from "vue";
> import * as Misskey from "misskey-js";
> import MkButton from "./MkButton.vue";
> import XNavFolder from "@/components/MkDrive.navFolder.vue";
> import XFolder from "@/components/MkDrive.folder.vue";
> import XFile from "@/components/MkDrive.file.vue";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { uploadFile, uploads } from "@/scripts/upload";
104,112c138,149
< const props = withDefaults(defineProps<{
< 	initialFolder?: Misskey.entities.DriveFolder;
< 	type?: string;
< 	multiple?: boolean;
< 	select?: 'file' | 'folder' | null;
< }>(), {
< 	multiple: false,
< 	select: null,
< });
---
> const props = withDefaults(
>   defineProps<{
>     initialFolder?: Misskey.entities.DriveFolder;
>     type?: string;
>     multiple?: boolean;
>     select?: "file" | "folder" | null;
>   }>(),
>   {
>     multiple: false,
>     select: null,
>   }
> );
115,119c152,162
< 	(ev: 'selected', v: Misskey.entities.DriveFile | Misskey.entities.DriveFolder): void;
< 	(ev: 'change-selection', v: Misskey.entities.DriveFile[] | Misskey.entities.DriveFolder[]): void;
< 	(ev: 'move-root'): void;
< 	(ev: 'cd', v: Misskey.entities.DriveFolder | null): void;
< 	(ev: 'open-folder', v: Misskey.entities.DriveFolder): void;
---
>   (
>     ev: "selected",
>     v: Misskey.entities.DriveFile | Misskey.entities.DriveFolder
>   ): void;
>   (
>     ev: "change-selection",
>     v: Misskey.entities.DriveFile[] | Misskey.entities.DriveFolder[]
>   ): void;
>   (ev: "move-root"): void;
>   (ev: "cd", v: Misskey.entities.DriveFolder | null): void;
>   (ev: "open-folder", v: Misskey.entities.DriveFolder): void;
122,123c165,166
< const loadMoreFiles = shallowRef<InstanceType<typeof MkButton>>();
< const fileInput = shallowRef<HTMLInputElement>();
---
> const loadMoreFiles = ref<InstanceType<typeof MkButton>>();
> const fileInput = ref<HTMLInputElement>();
134c177
< const connection = stream.useChannel('drive');
---
> const connection = stream.useChannel("drive");
147c190,194
< 	(entries) => entries.some((entry) => entry.isIntersecting) && !fetching.value && moreFiles.value && fetchMoreFiles(),
---
>   (entries) =>
>     entries.some((entry) => entry.isIntersecting) &&
>     !fetching.value &&
>     moreFiles.value &&
>     fetchMoreFiles()
150c197
< watch(folder, () => emit('cd', folder.value));
---
> watch(folder, () => emit("cd", folder.value));
153c200
< 	addFile(file, true);
---
>   addFile(file, true);
157,162c204,209
< 	const current = folder.value ? folder.value.id : null;
< 	if (current !== file.folderId) {
< 		removeFile(file);
< 	} else {
< 		addFile(file, true);
< 	}
---
>   const current = folder.value ? folder.value.id : null;
>   if (current !== file.folderId) {
>     removeFile(file);
>   } else {
>     addFile(file, true);
>   }
166c213
< 	removeFile(fileId);
---
>   removeFile(fileId);
169,170c216,219
< function onStreamDriveFolderCreated(createdFolder: Misskey.entities.DriveFolder) {
< 	addFolder(createdFolder, true);
---
> function onStreamDriveFolderCreated(
>   createdFolder: Misskey.entities.DriveFolder
> ) {
>   addFolder(createdFolder, true);
173,179c222,230
< function onStreamDriveFolderUpdated(updatedFolder: Misskey.entities.DriveFolder) {
< 	const current = folder.value ? folder.value.id : null;
< 	if (current !== updatedFolder.parentId) {
< 		removeFolder(updatedFolder);
< 	} else {
< 		addFolder(updatedFolder, true);
< 	}
---
> function onStreamDriveFolderUpdated(
>   updatedFolder: Misskey.entities.DriveFolder
> ) {
>   const current = folder.value ? folder.value.id : null;
>   if (current !== updatedFolder.parentId) {
>     removeFolder(updatedFolder);
>   } else {
>     addFolder(updatedFolder, true);
>   }
183c234
< 	removeFolder(folderId);
---
>   removeFolder(folderId);
187c238
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
189,194c240,245
< 	// ドラッグ元が自分自身の所有するアイテムだったら
< 	if (isDragSource.value) {
< 		// 自分自身にはドロップさせない
< 		ev.dataTransfer.dropEffect = 'none';
< 		return;
< 	}
---
>   // ドラッグ元が自分自身の所有するアイテムだったら
>   if (isDragSource.value) {
>     // 自分自身にはドロップさせない
>     ev.dataTransfer.dropEffect = "none";
>     return;
>   }
196,218c247,270
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
< 	const isDriveFolder = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
< 	if (isFile || isDriveFile || isDriveFolder) {
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	} else {
< 		ev.dataTransfer.dropEffect = 'none';
< 	}
---
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
>   const isDriveFolder =
>     ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FOLDER_;
>   if (isFile || isDriveFile || isDriveFolder) {
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   } else {
>     ev.dataTransfer.dropEffect = "none";
>   }
220c272
< 	return false;
---
>   return false;
224c276
< 	if (!isDragSource.value) draghover.value = true;
---
>   if (!isDragSource.value) draghover.value = true;
228c280
< 	draghover.value = false;
---
>   draghover.value = false;
232c284
< 	draghover.value = false;
---
>   draghover.value = false;
234c286
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
236,242c288,294
< 	// ドロップされてきたものがファイルだったら
< 	if (ev.dataTransfer.files.length > 0) {
< 		for (const file of Array.from(ev.dataTransfer.files)) {
< 			upload(file, folder.value);
< 		}
< 		return;
< 	}
---
>   // ドロップされてきたものがファイルだったら
>   if (ev.dataTransfer.files.length > 0) {
>     for (const file of Array.from(ev.dataTransfer.files)) {
>       upload(file, folder.value);
>     }
>     return;
>   }
244,255c296,307
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		const file = JSON.parse(driveFile);
< 		if (files.value.some(f => f.id === file.id)) return;
< 		removeFile(file.id);
< 		os.api('drive/files/update', {
< 			fileId: file.id,
< 			folderId: folder.value ? folder.value.id : null,
< 		});
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     const file = JSON.parse(driveFile);
>     if (files.value.some((f) => f.id === file.id)) return;
>     removeFile(file.id);
>     os.api("drive/files/update", {
>       fileId: file.id,
>       folderId: folder.value ? folder.value.id : null,
>     });
>   }
>   //#endregion
257,260c309,312
< 	//#region ドライブのフォルダ
< 	const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
< 	if (driveFolder != null && driveFolder !== '') {
< 		const droppedFolder = JSON.parse(driveFolder);
---
>   //#region ドライブのフォルダ
>   const driveFolder = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FOLDER_);
>   if (driveFolder != null && driveFolder !== "") {
>     const droppedFolder = JSON.parse(driveFolder);
262,289c314,341
< 		// 移動先が自分自身ならreject
< 		if (folder.value && droppedFolder.id === folder.value.id) return false;
< 		if (folders.value.some(f => f.id === droppedFolder.id)) return false;
< 		removeFolder(droppedFolder.id);
< 		os.api('drive/folders/update', {
< 			folderId: droppedFolder.id,
< 			parentId: folder.value ? folder.value.id : null,
< 		}).then(() => {
< 			// noop
< 		}).catch(err => {
< 			switch (err.code) {
< 				case 'RECURSIVE_NESTING':
< 					claimAchievement('driveFolderCircularReference');
< 					os.alert({
< 						type: 'error',
< 						title: i18n.ts.unableToProcess,
< 						text: i18n.ts.circularReferenceFolder,
< 					});
< 					break;
< 				default:
< 					os.alert({
< 						type: 'error',
< 						text: i18n.ts.somethingHappened,
< 					});
< 			}
< 		});
< 	}
< 	//#endregion
---
>     // 移動先が自分自身ならreject
>     if (folder.value && droppedFolder.id === folder.value.id) return false;
>     if (folders.value.some((f) => f.id === droppedFolder.id)) return false;
>     removeFolder(droppedFolder.id);
>     os.api("drive/folders/update", {
>       folderId: droppedFolder.id,
>       parentId: folder.value ? folder.value.id : null,
>     })
>       .then(() => {
>         // noop
>       })
>       .catch((err) => {
>         switch (err) {
>           case "detected-circular-definition":
>             os.alert({
>               title: i18n.ts.unableToProcess,
>               text: i18n.ts.circularReferenceFolder,
>             });
>             break;
>           default:
>             os.alert({
>               type: "error",
>               text: i18n.ts.somethingHappened,
>             });
>         }
>       });
>   }
>   //#endregion
293c345
< 	fileInput.value?.click();
---
>   fileInput.value?.click();
297,306c349,358
< 	os.inputText({
< 		title: i18n.ts.uploadFromUrl,
< 		type: 'url',
< 		placeholder: i18n.ts.uploadFromUrlDescription,
< 	}).then(({ canceled, result: url }) => {
< 		if (canceled || !url) return;
< 		os.api('drive/files/upload-from-url', {
< 			url: url,
< 			folderId: folder.value ? folder.value.id : undefined,
< 		});
---
>   os.inputText({
>     title: i18n.ts.uploadFromUrl,
>     type: "url",
>     placeholder: i18n.ts.uploadFromUrlDescription,
>   }).then(({ canceled, result: url }) => {
>     if (canceled || !url) return;
>     os.api("drive/files/upload-from-url", {
>       url: url,
>       folderId: folder.value ? folder.value.id : undefined,
>     });
308,312c360,364
< 		os.alert({
< 			title: i18n.ts.uploadFromUrlRequested,
< 			text: i18n.ts.uploadFromUrlMayTakeTime,
< 		});
< 	});
---
>     os.alert({
>       title: i18n.ts.uploadFromUrlRequested,
>       text: i18n.ts.uploadFromUrlMayTakeTime,
>     });
>   });
316,327c368,379
< 	os.inputText({
< 		title: i18n.ts.createFolder,
< 		placeholder: i18n.ts.folderName,
< 	}).then(({ canceled, result: name }) => {
< 		if (canceled) return;
< 		os.api('drive/folders/create', {
< 			name: name,
< 			parentId: folder.value ? folder.value.id : undefined,
< 		}).then(createdFolder => {
< 			addFolder(createdFolder, true);
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.createFolder,
>     placeholder: i18n.ts.folderName,
>   }).then(({ canceled, result: name }) => {
>     if (canceled) return;
>     os.api("drive/folders/create", {
>       name: name,
>       parentId: folder.value ? folder.value.id : undefined,
>     }).then((createdFolder) => {
>       addFolder(createdFolder, true);
>     });
>   });
331,344c383,396
< 	os.inputText({
< 		title: i18n.ts.renameFolder,
< 		placeholder: i18n.ts.inputNewFolderName,
< 		default: folderToRename.name,
< 	}).then(({ canceled, result: name }) => {
< 		if (canceled) return;
< 		os.api('drive/folders/update', {
< 			folderId: folderToRename.id,
< 			name: name,
< 		}).then(updatedFolder => {
< 			// FIXME: 画面を更新するために自分自身に移動
< 			move(updatedFolder);
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.renameFolder,
>     placeholder: i18n.ts.inputNewFolderName,
>     default: folderToRename.name,
>   }).then(({ canceled, result: name }) => {
>     if (canceled) return;
>     os.api("drive/folders/update", {
>       folderId: folderToRename.id,
>       name: name,
>     }).then((updatedFolder) => {
>       // FIXME: 画面を更新するために自分自身に移動
>       move(updatedFolder);
>     });
>   });
348,368c400,422
< 	os.api('drive/folders/delete', {
< 		folderId: folderToDelete.id,
< 	}).then(() => {
< 		// 削除時に親フォルダに移動
< 		move(folderToDelete.parentId);
< 	}).catch(err => {
< 		switch (err.id) {
< 			case 'b0fc8a17-963c-405d-bfbc-859a487295e1':
< 				os.alert({
< 					type: 'error',
< 					title: i18n.ts.unableToDelete,
< 					text: i18n.ts.hasChildFilesOrFolders,
< 				});
< 				break;
< 			default:
< 				os.alert({
< 					type: 'error',
< 					text: i18n.ts.unableToDelete,
< 				});
< 		}
< 	});
---
>   os.api("drive/folders/delete", {
>     folderId: folderToDelete.id,
>   })
>     .then(() => {
>       // 削除時に親フォルダに移動
>       move(folderToDelete.parentId);
>     })
>     .catch((err) => {
>       switch (err.id) {
>         case "b0fc8a17-963c-405d-bfbc-859a487295e1":
>           os.alert({
>             type: "error",
>             title: i18n.ts.unableToDelete,
>             text: i18n.ts.hasChildFilesOrFolders,
>           });
>           break;
>         default:
>           os.alert({
>             type: "error",
>             text: i18n.ts.unableToDelete,
>           });
>       }
>     });
372,375c426,429
< 	if (!fileInput.value?.files) return;
< 	for (const file of Array.from(fileInput.value.files)) {
< 		upload(file, folder.value);
< 	}
---
>   if (!fileInput.value?.files) return;
>   for (const file of Array.from(fileInput.value.files)) {
>     upload(file, folder.value);
>   }
378,381c432,445
< function upload(file: File, folderToUpload?: Misskey.entities.DriveFolder | null) {
< 	uploadFile(file, (folderToUpload && typeof folderToUpload === 'object') ? folderToUpload.id : null, undefined, keepOriginal.value).then(res => {
< 		addFile(res, true);
< 	});
---
> function upload(
>   file: File,
>   folderToUpload?: Misskey.entities.DriveFolder | null
> ) {
>   uploadFile(
>     file,
>     folderToUpload && typeof folderToUpload === "object"
>       ? folderToUpload.id
>       : null,
>     undefined,
>     keepOriginal.value
>   ).then((res) => {
>     addFile(res, true);
>   });
385,400c449,464
< 	const isAlreadySelected = selectedFiles.value.some(f => f.id === file.id);
< 	if (props.multiple) {
< 		if (isAlreadySelected) {
< 			selectedFiles.value = selectedFiles.value.filter(f => f.id !== file.id);
< 		} else {
< 			selectedFiles.value.push(file);
< 		}
< 		emit('change-selection', selectedFiles.value);
< 	} else {
< 		if (isAlreadySelected) {
< 			emit('selected', file);
< 		} else {
< 			selectedFiles.value = [file];
< 			emit('change-selection', [file]);
< 		}
< 	}
---
>   const isAlreadySelected = selectedFiles.value.some((f) => f.id === file.id);
>   if (props.multiple) {
>     if (isAlreadySelected) {
>       selectedFiles.value = selectedFiles.value.filter((f) => f.id !== file.id);
>     } else {
>       selectedFiles.value.push(file);
>     }
>     emit("change-selection", selectedFiles.value);
>   } else {
>     if (isAlreadySelected) {
>       emit("selected", file);
>     } else {
>       selectedFiles.value = [file];
>       emit("change-selection", [file]);
>     }
>   }
404,419c468,487
< 	const isAlreadySelected = selectedFolders.value.some(f => f.id === folderToChoose.id);
< 	if (props.multiple) {
< 		if (isAlreadySelected) {
< 			selectedFolders.value = selectedFolders.value.filter(f => f.id !== folderToChoose.id);
< 		} else {
< 			selectedFolders.value.push(folderToChoose);
< 		}
< 		emit('change-selection', selectedFolders.value);
< 	} else {
< 		if (isAlreadySelected) {
< 			emit('selected', folderToChoose);
< 		} else {
< 			selectedFolders.value = [folderToChoose];
< 			emit('change-selection', [folderToChoose]);
< 		}
< 	}
---
>   const isAlreadySelected = selectedFolders.value.some(
>     (f) => f.id === folderToChoose.id
>   );
>   if (props.multiple) {
>     if (isAlreadySelected) {
>       selectedFolders.value = selectedFolders.value.filter(
>         (f) => f.id !== folderToChoose.id
>       );
>     } else {
>       selectedFolders.value.push(folderToChoose);
>     }
>     emit("change-selection", selectedFolders.value);
>   } else {
>     if (isAlreadySelected) {
>       emit("selected", folderToChoose);
>     } else {
>       selectedFolders.value = [folderToChoose];
>       emit("change-selection", [folderToChoose]);
>     }
>   }
423,428c491,496
< 	if (!target) {
< 		goRoot();
< 		return;
< 	} else if (typeof target === 'object') {
< 		target = target.id;
< 	}
---
>   if (!target) {
>     goRoot();
>     return;
>   } else if (typeof target === "object") {
>     target = target.id;
>   }
430c498
< 	fetching.value = true;
---
>   fetching.value = true;
432,436c500,504
< 	os.api('drive/folders/show', {
< 		folderId: target,
< 	}).then(folderToMove => {
< 		folder.value = folderToMove;
< 		hierarchyFolders.value = [];
---
>   os.api("drive/folders/show", {
>     folderId: target,
>   }).then((folderToMove) => {
>     folder.value = folderToMove;
>     hierarchyFolders.value = [];
438,441c506,509
< 		const dive = folderToDive => {
< 			hierarchyFolders.value.unshift(folderToDive);
< 			if (folderToDive.parent) dive(folderToDive.parent);
< 		};
---
>     const dive = (folderToDive) => {
>       hierarchyFolders.value.unshift(folderToDive);
>       if (folderToDive.parent) dive(folderToDive.parent);
>     };
443c511
< 		if (folderToMove.parent) dive(folderToMove.parent);
---
>     if (folderToMove.parent) dive(folderToMove.parent);
445,447c513,515
< 		emit('open-folder', folderToMove);
< 		fetch();
< 	});
---
>     emit("open-folder", folderToMove);
>     fetch();
>   });
451,452c519,520
< 	const current = folder.value ? folder.value.id : null;
< 	if (current !== folderToAdd.parentId) return;
---
>   const current = folder.value ? folder.value.id : null;
>   if (current !== folderToAdd.parentId) return;
454,458c522,526
< 	if (folders.value.some(f => f.id === folderToAdd.id)) {
< 		const exist = folders.value.map(f => f.id).indexOf(folderToAdd.id);
< 		folders.value[exist] = folderToAdd;
< 		return;
< 	}
---
>   if (folders.value.some((f) => f.id === folderToAdd.id)) {
>     const exist = folders.value.map((f) => f.id).indexOf(folderToAdd.id);
>     folders.value[exist] = folderToAdd;
>     return;
>   }
460,464c528,532
< 	if (unshift) {
< 		folders.value.unshift(folderToAdd);
< 	} else {
< 		folders.value.push(folderToAdd);
< 	}
---
>   if (unshift) {
>     folders.value.unshift(folderToAdd);
>   } else {
>     folders.value.push(folderToAdd);
>   }
468,469c536,537
< 	const current = folder.value ? folder.value.id : null;
< 	if (current !== fileToAdd.folderId) return;
---
>   const current = folder.value ? folder.value.id : null;
>   if (current !== fileToAdd.folderId) return;
471,475c539,543
< 	if (files.value.some(f => f.id === fileToAdd.id)) {
< 		const exist = files.value.map(f => f.id).indexOf(fileToAdd.id);
< 		files.value[exist] = fileToAdd;
< 		return;
< 	}
---
>   if (files.value.some((f) => f.id === fileToAdd.id)) {
>     const exist = files.value.map((f) => f.id).indexOf(fileToAdd.id);
>     files.value[exist] = fileToAdd;
>     return;
>   }
477,481c545,549
< 	if (unshift) {
< 		files.value.unshift(fileToAdd);
< 	} else {
< 		files.value.push(fileToAdd);
< 	}
---
>   if (unshift) {
>     files.value.unshift(fileToAdd);
>   } else {
>     files.value.push(fileToAdd);
>   }
485,486c553,555
< 	const folderIdToRemove = typeof folderToRemove === 'object' ? folderToRemove.id : folderToRemove;
< 	folders.value = folders.value.filter(f => f.id !== folderIdToRemove);
---
>   const folderIdToRemove =
>     typeof folderToRemove === "object" ? folderToRemove.id : folderToRemove;
>   folders.value = folders.value.filter((f) => f.id !== folderIdToRemove);
490,491c559,560
< 	const fileId = typeof file === 'object' ? file.id : file;
< 	files.value = files.value.filter(f => f.id !== fileId);
---
>   const fileId = typeof file === "object" ? file.id : file;
>   files.value = files.value.filter((f) => f.id !== fileId);
495c564
< 	addFile(file);
---
>   addFile(file);
499c568
< 	addFolder(folderToAppend);
---
>   addFolder(folderToAppend);
511,512c580,581
< 	// 既にrootにいるなら何もしない
< 	if (folder.value == null) return;
---
>   // 既にrootにいるなら何もしない
>   if (folder.value == null) return;
514,517c583,586
< 	folder.value = null;
< 	hierarchyFolders.value = [];
< 	emit('move-root');
< 	fetch();
---
>   folder.value = null;
>   hierarchyFolders.value = [];
>   emit("move-root");
>   fetch();
521,525c590,594
< 	folders.value = [];
< 	files.value = [];
< 	moreFolders.value = false;
< 	moreFiles.value = false;
< 	fetching.value = true;
---
>   folders.value = [];
>   files.value = [];
>   moreFolders.value = false;
>   moreFiles.value = false;
>   fetching.value = true;
527,528c596,597
< 	const foldersMax = 30;
< 	const filesMax = 30;
---
>   const foldersMax = 30;
>   const filesMax = 30;
530,539c599,610
< 	const foldersPromise = os.api('drive/folders', {
< 		folderId: folder.value ? folder.value.id : null,
< 		limit: foldersMax + 1,
< 	}).then(fetchedFolders => {
< 		if (fetchedFolders.length === foldersMax + 1) {
< 			moreFolders.value = true;
< 			fetchedFolders.pop();
< 		}
< 		return fetchedFolders;
< 	});
---
>   const foldersPromise = os
>     .api("drive/folders", {
>       folderId: folder.value ? folder.value.id : null,
>       limit: foldersMax + 1,
>     })
>     .then((fetchedFolders) => {
>       if (fetchedFolders.length === foldersMax + 1) {
>         moreFolders.value = true;
>         fetchedFolders.pop();
>       }
>       return fetchedFolders;
>     });
541,551c612,624
< 	const filesPromise = os.api('drive/files', {
< 		folderId: folder.value ? folder.value.id : null,
< 		type: props.type,
< 		limit: filesMax + 1,
< 	}).then(fetchedFiles => {
< 		if (fetchedFiles.length === filesMax + 1) {
< 			moreFiles.value = true;
< 			fetchedFiles.pop();
< 		}
< 		return fetchedFiles;
< 	});
---
>   const filesPromise = os
>     .api("drive/files", {
>       folderId: folder.value ? folder.value.id : null,
>       type: props.type,
>       limit: filesMax + 1,
>     })
>     .then((fetchedFiles) => {
>       if (fetchedFiles.length === filesMax + 1) {
>         moreFiles.value = true;
>         fetchedFiles.pop();
>       }
>       return fetchedFiles;
>     });
553c626,629
< 	const [fetchedFolders, fetchedFiles] = await Promise.all([foldersPromise, filesPromise]);
---
>   const [fetchedFolders, fetchedFiles] = await Promise.all([
>     foldersPromise,
>     filesPromise,
>   ]);
555,556c631,632
< 	for (const x of fetchedFolders) appendFolder(x);
< 	for (const x of fetchedFiles) appendFile(x);
---
>   for (const x of fetchedFolders) appendFolder(x);
>   for (const x of fetchedFiles) appendFile(x);
558c634
< 	fetching.value = false;
---
>   fetching.value = false;
562c638
< 	fetching.value = true;
---
>   fetching.value = true;
564c640
< 	const max = 30;
---
>   const max = 30;
566,581c642,657
< 	// ファイル一覧取得
< 	os.api('drive/files', {
< 		folderId: folder.value ? folder.value.id : null,
< 		type: props.type,
< 		untilId: files.value[files.value.length - 1].id,
< 		limit: max + 1,
< 	}).then(files => {
< 		if (files.length === max + 1) {
< 			moreFiles.value = true;
< 			files.pop();
< 		} else {
< 			moreFiles.value = false;
< 		}
< 		for (const x of files) appendFile(x);
< 		fetching.value = false;
< 	});
---
>   // ファイル一覧取得
>   os.api("drive/files", {
>     folderId: folder.value ? folder.value.id : null,
>     type: props.type,
>     untilId: files.value[files.value.length - 1].id,
>     limit: max + 1,
>   }).then((files) => {
>     if (files.length === max + 1) {
>       moreFiles.value = true;
>       files.pop();
>     } else {
>       moreFiles.value = false;
>     }
>     for (const x of files) appendFile(x);
>     fetching.value = false;
>   });
585,615c661,716
< 	return [{
< 		type: 'switch',
< 		text: i18n.ts.keepOriginalUploading,
< 		ref: keepOriginal,
< 	}, null, {
< 		text: i18n.ts.addFile,
< 		type: 'label',
< 	}, {
< 		text: i18n.ts.upload,
< 		icon: 'ti ti-upload',
< 		action: () => { selectLocalFile(); },
< 	}, {
< 		text: i18n.ts.fromUrl,
< 		icon: 'ti ti-link',
< 		action: () => { urlUpload(); },
< 	}, null, {
< 		text: folder.value ? folder.value.name : i18n.ts.drive,
< 		type: 'label',
< 	}, folder.value ? {
< 		text: i18n.ts.renameFolder,
< 		icon: 'ti ti-forms',
< 		action: () => { renameFolder(folder.value); },
< 	} : undefined, folder.value ? {
< 		text: i18n.ts.deleteFolder,
< 		icon: 'ti ti-trash',
< 		action: () => { deleteFolder(folder.value as Misskey.entities.DriveFolder); },
< 	} : undefined, {
< 		text: i18n.ts.createFolder,
< 		icon: 'ti ti-folder-plus',
< 		action: () => { createFolder(); },
< 	}];
---
>   return [
>     {
>       type: "switch",
>       text: i18n.ts.keepOriginalUploading,
>       ref: keepOriginal,
>     },
>     null,
>     {
>       text: i18n.ts.addFile,
>       type: "label",
>     },
>     {
>       text: i18n.ts.upload,
>       icon: "fas fa-upload",
>       action: () => {
>         selectLocalFile();
>       },
>     },
>     {
>       text: i18n.ts.fromUrl,
>       icon: "fas fa-link",
>       action: () => {
>         urlUpload();
>       },
>     },
>     null,
>     {
>       text: folder.value ? folder.value.name : i18n.ts.drive,
>       type: "label",
>     },
>     folder.value
>       ? {
>           text: i18n.ts.renameFolder,
>           icon: "fas fa-i-cursor",
>           action: () => {
>             renameFolder(folder.value);
>           },
>         }
>       : undefined,
>     folder.value
>       ? {
>           text: i18n.ts.deleteFolder,
>           icon: "fas fa-trash-alt",
>           action: () => {
>             deleteFolder(folder.value as Misskey.entities.DriveFolder);
>           },
>         }
>       : undefined,
>     {
>       text: i18n.ts.createFolder,
>       icon: "fas fa-folder-plus",
>       action: () => {
>         createFolder();
>       },
>     },
>   ];
619c720,723
< 	os.popupMenu(getMenu(), (ev.currentTarget ?? ev.target ?? undefined) as HTMLElement | undefined);
---
>   os.popupMenu(
>     getMenu(),
>     (ev.currentTarget ?? ev.target ?? undefined) as HTMLElement | undefined
>   );
623c727
< 	os.contextMenu(getMenu(), ev);
---
>   os.contextMenu(getMenu(), ev);
627,631c731,735
< 	if (defaultStore.state.enableInfiniteScroll && loadMoreFiles.value) {
< 		nextTick(() => {
< 			ilFilesObserver.observe(loadMoreFiles.value?.$el);
< 		});
< 	}
---
>   if (defaultStore.state.enableInfiniteScroll && loadMoreFiles.value) {
>     nextTick(() => {
>       ilFilesObserver.observe(loadMoreFiles.value?.$el);
>     });
>   }
633,638c737,742
< 	connection.on('fileCreated', onStreamDriveFileCreated);
< 	connection.on('fileUpdated', onStreamDriveFileUpdated);
< 	connection.on('fileDeleted', onStreamDriveFileDeleted);
< 	connection.on('folderCreated', onStreamDriveFolderCreated);
< 	connection.on('folderUpdated', onStreamDriveFolderUpdated);
< 	connection.on('folderDeleted', onStreamDriveFolderDeleted);
---
>   connection.on("fileCreated", onStreamDriveFileCreated);
>   connection.on("fileUpdated", onStreamDriveFileUpdated);
>   connection.on("fileDeleted", onStreamDriveFileDeleted);
>   connection.on("folderCreated", onStreamDriveFolderCreated);
>   connection.on("folderUpdated", onStreamDriveFolderUpdated);
>   connection.on("folderDeleted", onStreamDriveFolderDeleted);
640,644c744,748
< 	if (props.initialFolder) {
< 		move(props.initialFolder);
< 	} else {
< 		fetch();
< 	}
---
>   if (props.initialFolder) {
>     move(props.initialFolder);
>   } else {
>     fetch();
>   }
648,652c752,756
< 	if (defaultStore.state.enableInfiniteScroll) {
< 		nextTick(() => {
< 			ilFilesObserver.observe(loadMoreFiles.value?.$el);
< 		});
< 	}
---
>   if (defaultStore.state.enableInfiniteScroll) {
>     nextTick(() => {
>       ilFilesObserver.observe(loadMoreFiles.value?.$el);
>     });
>   }
656,657c760,761
< 	connection.dispose();
< 	ilFilesObserver.disconnect();
---
>   connection.dispose();
>   ilFilesObserver.disconnect();
663,665c767,769
< 	display: flex;
< 	flex-direction: column;
< 	height: 100%;
---
>   display: flex;
>   flex-direction: column;
>   height: 100%;
667,675c771,779
< 	> nav {
< 		display: flex;
< 		z-index: 2;
< 		width: 100%;
< 		padding: 0 8px;
< 		box-sizing: border-box;
< 		overflow: auto;
< 		font-size: 0.9em;
< 		box-shadow: 0 1px 0 var(--divider);
---
>   > nav {
>     display: flex;
>     z-index: 2;
>     width: 100%;
>     padding: 0 8px;
>     box-sizing: border-box;
>     overflow: auto;
>     font-size: 0.9em;
>     box-shadow: 0 1px 0 var(--divider);
677,679c781,784
< 		&, * {
< 			user-select: none;
< 		}
---
>     &,
>     * {
>       user-select: none;
>     }
681,685c786,790
< 		> .path {
< 			display: inline-block;
< 			vertical-align: bottom;
< 			line-height: 42px;
< 			white-space: nowrap;
---
>     > .path {
>       display: inline-block;
>       vertical-align: bottom;
>       line-height: 42px;
>       white-space: nowrap;
687,692c792,797
< 			> * {
< 				display: inline-block;
< 				margin: 0;
< 				padding: 0 8px;
< 				line-height: 42px;
< 				cursor: pointer;
---
>       > * {
>         display: inline-block;
>         margin: 0;
>         padding: 0 8px;
>         line-height: 42px;
>         cursor: pointer;
694,696c799,801
< 				* {
< 					pointer-events: none;
< 				}
---
>         * {
>           pointer-events: none;
>         }
698,700c803,805
< 				&:hover {
< 					text-decoration: underline;
< 				}
---
>         &:hover {
>           text-decoration: underline;
>         }
702,704c807,809
< 				&.current {
< 					font-weight: bold;
< 					cursor: default;
---
>         &.current {
>           font-weight: bold;
>           cursor: default;
706,709c811,814
< 					&:hover {
< 						text-decoration: none;
< 					}
< 				}
---
>           &:hover {
>             text-decoration: none;
>           }
>         }
711,715c816,820
< 				&.separator {
< 					margin: 0;
< 					padding: 0;
< 					opacity: 0.5;
< 					cursor: default;
---
>         &.separator {
>           margin: 0;
>           padding: 0;
>           opacity: 0.5;
>           cursor: default;
717,722c822,827
< 					> i {
< 						margin: 0;
< 					}
< 				}
< 			}
< 		}
---
>           > i {
>             margin: 0;
>           }
>         }
>       }
>     }
724,728c829,833
< 		> .menu {
< 			margin-left: auto;
< 			padding: 0 12px;
< 		}
< 	}
---
>     > .menu {
>       margin-left: auto;
>       padding: 0 12px;
>     }
>   }
730,733c835,838
< 	> .main {
< 		flex: 1;
< 		overflow: auto;
< 		padding: var(--margin);
---
>   > .main {
>     flex: 1;
>     overflow: auto;
>     padding: var(--margin);
735,737c840,843
< 		&, * {
< 			user-select: none;
< 		}
---
>     &,
>     * {
>       user-select: none;
>     }
739,740c845,846
< 		&.fetching {
< 			cursor: wait !important;
---
>     &.fetching {
>       cursor: wait !important;
742,744c848,850
< 			* {
< 				pointer-events: none;
< 			}
---
>       * {
>         pointer-events: none;
>       }
746,749c852,855
< 			> .contents {
< 				opacity: 0.5;
< 			}
< 		}
---
>       > .contents {
>         opacity: 0.5;
>       }
>     }
751,753c857,859
< 		&.uploading {
< 			height: calc(100% - 38px - 100px);
< 		}
---
>     &.uploading {
>       height: calc(100% - 38px - 100px);
>     }
755c861,865
< 		> .contents {
---
>     > .contents {
>       > .folders,
>       > .files {
>         display: flex;
>         flex-wrap: wrap;
757,760c867,873
< 			> .folders,
< 			> .files {
< 				display: flex;
< 				flex-wrap: wrap;
---
>         > .folder,
>         > .file {
>           flex-grow: 1;
>           width: 128px;
>           margin: 4px;
>           box-sizing: border-box;
>         }
762,768c875,880
< 				> .folder,
< 				> .file {
< 					flex-grow: 1;
< 					width: 128px;
< 					margin: 4px;
< 					box-sizing: border-box;
< 				}
---
>         > .padding {
>           flex-grow: 1;
>           pointer-events: none;
>           width: 128px + 8px;
>         }
>       }
770,775c882,886
< 				> .padding {
< 					flex-grow: 1;
< 					pointer-events: none;
< 					width: 128px + 8px;
< 				}
< 			}
---
>       > .empty {
>         padding: 16px;
>         text-align: center;
>         pointer-events: none;
>         opacity: 0.5;
777,781c888,893
< 			> .empty {
< 				padding: 16px;
< 				text-align: center;
< 				pointer-events: none;
< 				opacity: 0.5;
---
>         > p {
>           margin: 0;
>         }
>       }
>     }
>   }
783,788c895,903
< 				> p {
< 					margin: 0;
< 				}
< 			}
< 		}
< 	}
---
>   > .dropzone {
>     position: absolute;
>     left: 0;
>     top: 38px;
>     width: 100%;
>     height: calc(100% - 38px);
>     border: dashed 2px var(--focus);
>     pointer-events: none;
>   }
790,802c905,907
< 	> .dropzone {
< 		position: absolute;
< 		left: 0;
< 		top: 38px;
< 		width: 100%;
< 		height: calc(100% - 38px);
< 		border: dashed 2px var(--focus);
< 		pointer-events: none;
< 	}
< 
< 	> input {
< 		display: none;
< 	}
---
>   > input {
>     display: none;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDriveFileThumbnail.vue RiricaV13/components/MkDriveFileThumbnail.vue
2,11c2,21
< <div ref="thumbnail" class="zdjebgpv">
< 	<ImgWithBlurhash v-if="isThumbnailAvailable" :hash="file.blurhash" :src="file.thumbnailUrl" :alt="file.name" :title="file.name" :cover="fit !== 'contain'"/>
< 	<i v-else-if="is === 'image'" class="ti ti-photo icon"></i>
< 	<i v-else-if="is === 'video'" class="ti ti-video icon"></i>
< 	<i v-else-if="is === 'audio' || is === 'midi'" class="ti ti-file-music icon"></i>
< 	<i v-else-if="is === 'csv'" class="ti ti-file-text icon"></i>
< 	<i v-else-if="is === 'pdf'" class="ti ti-file-text icon"></i>
< 	<i v-else-if="is === 'textfile'" class="ti ti-file-text icon"></i>
< 	<i v-else-if="is === 'archive'" class="ti ti-file-zip icon"></i>
< 	<i v-else class="ti ti-file icon"></i>
---
>   <div ref="thumbnail" class="zdjebgpv">
>     <ImgWithBlurhash
>       v-if="isThumbnailAvailable"
>       :hash="file.blurhash"
>       :src="file.thumbnailUrl"
>       :alt="file.name"
>       :title="file.name"
>       :cover="fit !== 'contain'"
>     />
>     <i v-else-if="is === 'image'" class="fas fa-file-image icon"></i>
>     <i v-else-if="is === 'video'" class="fas fa-file-video icon"></i>
>     <i
>       v-else-if="is === 'audio' || is === 'midi'"
>       class="fas fa-music icon"
>     ></i>
>     <i v-else-if="is === 'csv'" class="fas fa-file-csv icon"></i>
>     <i v-else-if="is === 'pdf'" class="fas fa-file-pdf icon"></i>
>     <i v-else-if="is === 'textfile'" class="fas fa-file-alt icon"></i>
>     <i v-else-if="is === 'archive'" class="fas fa-file-archive icon"></i>
>     <i v-else class="fas fa-file icon"></i>
13,14c23,27
< 	<i v-if="isThumbnailAvailable && is === 'video'" class="ti ti-video icon-sub"></i>
< </div>
---
>     <i
>       v-if="isThumbnailAvailable && is === 'video'"
>       class="fas fa-film icon-sub"
>     ></i>
>   </div>
18,20c31,33
< import { computed } from 'vue';
< import * as Misskey from 'misskey-js';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
---
> import { computed } from "vue";
> import * as Misskey from "misskey-js";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
23,24c36,37
< 	file: Misskey.entities.DriveFile;
< 	fit: string;
---
>   file: Misskey.entities.DriveFile;
>   fit: string;
28,46c41,62
< 	if (props.file.type.startsWith('image/')) return 'image';
< 	if (props.file.type.startsWith('video/')) return 'video';
< 	if (props.file.type === 'audio/midi') return 'midi';
< 	if (props.file.type.startsWith('audio/')) return 'audio';
< 	if (props.file.type.endsWith('/csv')) return 'csv';
< 	if (props.file.type.endsWith('/pdf')) return 'pdf';
< 	if (props.file.type.startsWith('text/')) return 'textfile';
< 	if ([
< 		'application/zip',
< 		'application/x-cpio',
< 		'application/x-bzip',
< 		'application/x-bzip2',
< 		'application/java-archive',
< 		'application/x-rar-compressed',
< 		'application/x-tar',
< 		'application/gzip',
< 		'application/x-7z-compressed',
< 	].some(archiveType => archiveType === props.file.type)) return 'archive';
< 	return 'unknown';
---
>   if (props.file.type.startsWith("image/")) return "image";
>   if (props.file.type.startsWith("video/")) return "video";
>   if (props.file.type === "audio/midi") return "midi";
>   if (props.file.type.startsWith("audio/")) return "audio";
>   if (props.file.type.endsWith("/csv")) return "csv";
>   if (props.file.type.endsWith("/pdf")) return "pdf";
>   if (props.file.type.startsWith("text/")) return "textfile";
>   if (
>     [
>       "application/zip",
>       "application/x-cpio",
>       "application/x-bzip",
>       "application/x-bzip2",
>       "application/java-archive",
>       "application/x-rar-compressed",
>       "application/x-tar",
>       "application/gzip",
>       "application/x-7z-compressed",
>     ].some((archiveType) => archiveType === props.file.type)
>   )
>     return "archive";
>   return "unknown";
50,52c66,68
< 	return props.file.thumbnailUrl
< 		? (is.value === 'image' as const || is.value === 'video')
< 		: false;
---
>   return props.file.thumbnailUrl
>     ? is.value === ("image" as const) || is.value === "video"
>     : false;
58,62c74,78
< 	position: relative;
< 	display: flex;
< 	background: var(--panel);
< 	border-radius: 8px;
< 	overflow: clip;
---
>   position: relative;
>   display: flex;
>   background: var(--panel);
>   border-radius: 8px;
>   overflow: clip;
64,71c80,87
< 	> .icon-sub {
< 		position: absolute;
< 		width: 30%;
< 		height: auto;
< 		margin: 0;
< 		right: 4%;
< 		bottom: 4%;
< 	}
---
>   > .icon-sub {
>     position: absolute;
>     width: 30%;
>     height: auto;
>     margin: 0;
>     right: 4%;
>     bottom: 4%;
>   }
73,78c89,94
< 	> .icon {
< 		pointer-events: none;
< 		margin: auto;
< 		font-size: 32px;
< 		color: #777;
< 	}
---
>   > .icon {
>     pointer-events: none;
>     margin: auto;
>     font-size: 32px;
>     color: #777;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDriveSelectDialog.vue RiricaV13/components/MkDriveSelectDialog.vue
2,18c2,33
< <MkModalWindow
< 	ref="dialog"
< 	:width="800"
< 	:height="500"
< 	:with-ok-button="true"
< 	:ok-button-disabled="(type === 'file') && (selected.length === 0)"
< 	@click="cancel()"
< 	@close="cancel()"
< 	@ok="ok()"
< 	@closed="emit('closed')"
< >
< 	<template #header>
< 		{{ multiple ? ((type === 'file') ? i18n.ts.selectFiles : i18n.ts.selectFolders) : ((type === 'file') ? i18n.ts.selectFile : i18n.ts.selectFolder) }}
< 		<span v-if="selected.length > 0" style="margin-left: 8px; opacity: 0.5;">({{ number(selected.length) }})</span>
< 	</template>
< 	<XDrive :multiple="multiple" :select="type" @change-selection="onChangeSelection" @selected="ok()"/>
< </MkModalWindow>
---
>   <XModalWindow
>     ref="dialog"
>     :width="800"
>     :height="500"
>     :with-ok-button="true"
>     :ok-button-disabled="type === 'file' && selected.length === 0"
>     @click="cancel()"
>     @close="cancel()"
>     @ok="ok()"
>     @closed="emit('closed')"
>   >
>     <template #header>
>       {{
>         multiple
>           ? type === "file"
>             ? i18n.ts.selectFiles
>             : i18n.ts.selectFolders
>           : type === "file"
>           ? i18n.ts.selectFile
>           : i18n.ts.selectFolder
>       }}
>       <span v-if="selected.length > 0" style="margin-left: 8px; opacity: 0.5"
>         >({{ number(selected.length) }})</span
>       >
>     </template>
>     <XDrive
>       :multiple="multiple"
>       :select="type"
>       @changeSelection="onChangeSelection"
>       @selected="ok()"
>     />
>   </XModalWindow>
22,27c37,42
< import { ref, shallowRef } from 'vue';
< import * as Misskey from 'misskey-js';
< import XDrive from '@/components/MkDrive.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import number from '@/filters/number';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import * as Misskey from "misskey-js";
> import XDrive from "@/components/MkDrive.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import number from "@/filters/number";
> import { i18n } from "@/i18n";
29,34c44,52
< withDefaults(defineProps<{
< 	type?: 'file' | 'folder';
< 	multiple: boolean;
< }>(), {
< 	type: 'file',
< });
---
> withDefaults(
>   defineProps<{
>     type?: "file" | "folder";
>     multiple: boolean;
>   }>(),
>   {
>     type: "file",
>   }
> );
37,38c55,56
< 	(ev: 'done', r?: Misskey.entities.DriveFile[]): void;
< 	(ev: 'closed'): void;
---
>   (ev: "done", r?: Misskey.entities.DriveFile[]): void;
>   (ev: "closed"): void;
41c59
< const dialog = shallowRef<InstanceType<typeof MkModalWindow>>();
---
> const dialog = ref<InstanceType<typeof XModalWindow>>();
46,47c64,65
< 	emit('done', selected.value);
< 	dialog.value?.close();
---
>   emit("done", selected.value);
>   dialog.value?.close();
51,52c69,70
< 	emit('done');
< 	dialog.value?.close();
---
>   emit("done");
>   dialog.value?.close();
56c74
< 	selected.value = files;
---
>   selected.value = files;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkDriveWindow.vue RiricaV13/components/MkDriveWindow.vue
2,13c2,13
< <MkWindow
< 	ref="window"
< 	:initial-width="800"
< 	:initial-height="500"
< 	:can-resize="true"
< 	@closed="emit('closed')"
< >
< 	<template #header>
< 		{{ i18n.ts.drive }}
< 	</template>
< 	<XDrive :initial-folder="initialFolder"/>
< </MkWindow>
---
>   <XWindow
>     ref="window"
>     :initial-width="800"
>     :initial-height="500"
>     :can-resize="true"
>     @closed="emit('closed')"
>   >
>     <template #header>
>       {{ i18n.ts.drive }}
>     </template>
>     <XDrive :initial-folder="initialFolder" />
>   </XWindow>
17,21c17,21
< import { } from 'vue';
< import * as Misskey from 'misskey-js';
< import XDrive from '@/components/MkDrive.vue';
< import MkWindow from '@/components/MkWindow.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as Misskey from "misskey-js";
> import XDrive from "@/components/MkDrive.vue";
> import XWindow from "@/components/MkWindow.vue";
> import { i18n } from "@/i18n";
24c24
< 	initialFolder?: Misskey.entities.DriveFolder;
---
>   initialFolder?: Misskey.entities.DriveFolder;
28c28
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkEmojiPicker.section.vue RiricaV13/components/MkEmojiPicker.section.vue
2,17c2,21
< <!-- このコンポーネントの要素のclassは親から利用されるのでむやみに弄らないこと -->
< <section>
< 	<header class="_acrylic" @click="shown = !shown">
< 		<i class="toggle ti-fw" :class="shown ? 'ti ti-chevron-down' : 'ti ti-chevron-up'"></i> <slot></slot> ({{ emojis.length }})
< 	</header>
< 	<div v-if="shown" class="body">
< 		<button
< 			v-for="emoji in emojis"
< 			:key="emoji"
< 			class="_button item"
< 			@click="emit('chosen', emoji, $event)"
< 		>
< 			<MkEmoji class="emoji" :emoji="emoji" :normal="true"/>
< 		</button>
< 	</div>
< </section>
---
>   <!-- このコンポーネントの要素のclassは親から利用されるのでむやみに弄らないこと -->
>   <section>
>     <header class="_acrylic" @click="shown = !shown">
>       <i
>         class="toggle fa-fw"
>         :class="shown ? 'fas fa-chevron-down' : 'fas fa-chevron-up'"
>       ></i>
>       <slot></slot> ({{ emojis.length }})
>     </header>
>     <div v-if="shown" class="body">
>       <button
>         v-for="emoji in emojis"
>         :key="emoji"
>         class="_button item"
>         @click="emit('chosen', emoji, $event)"
>       >
>         <MkEmoji class="emoji" :emoji="emoji" :normal="true" />
>       </button>
>     </div>
>   </section>
21c25
< import { ref, computed, Ref } from 'vue';
---
> import { ref } from "vue";
24,25c28,29
< 	emojis: string[] | Ref<string[]>;
< 	initialShown?: boolean;
---
>   emojis: string[];
>   initialShown?: boolean;
29c33
< 	(ev: 'chosen', v: string, event: MouseEvent): void;
---
>   (ev: "chosen", v: string, event: MouseEvent): void;
32,33d35
< const emojis = computed(() => Array.isArray(props.emojis) ? props.emojis : props.emojis.value);
< 
35a38,39
> 
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkEmojiPicker.vue RiricaV13/components/MkEmojiPicker.vue
2,30c2,52
< <div class="omfetrab" :class="['s' + size, 'w' + width, 'h' + height, { asDrawer, asWindow }]" :style="{ maxHeight: maxHeight ? maxHeight + 'px' : undefined }">
< 	<input ref="searchEl" :value="q" class="search" data-prevent-emoji-insert :class="{ filled: q != null && q != '' }" :placeholder="i18n.ts.search" type="search" @input="input()" @paste.stop="paste" @keyup.enter="done()">
< 	<div ref="emojisEl" class="emojis">
< 		<section class="result">
< 			<div v-if="searchResultCustom.length > 0" class="body">
< 				<button
< 					v-for="emoji in searchResultCustom"
< 					:key="emoji.name"
< 					class="_button item"
< 					:title="emoji.name"
< 					tabindex="0"
< 					@click="chosen(emoji, $event)"
< 				>
< 					<MkEmoji class="emoji" :emoji="`:${emoji.name}:`"/>
< 				</button>
< 			</div>
< 			<div v-if="searchResultUnicode.length > 0" class="body">
< 				<button
< 					v-for="emoji in searchResultUnicode"
< 					:key="emoji.name"
< 					class="_button item"
< 					:title="emoji.name"
< 					tabindex="0"
< 					@click="chosen(emoji, $event)"
< 				>
< 					<MkEmoji class="emoji" :emoji="emoji.char"/>
< 				</button>
< 			</div>
< 		</section>
---
>   <div
>     class="omfetrab"
>     :class="['s' + size, 'w' + width, 'h' + height, { asDrawer }]"
>     :style="{ maxHeight: maxHeight ? maxHeight + 'px' : undefined }"
>   >
>     <input
>       ref="search"
>       v-model.trim="q"
>       class="search"
>       data-prevent-emoji-insert
>       :class="{ filled: q != null && q != '' }"
>       :placeholder="i18n.ts.search"
>       type="search"
>       @paste.stop="paste"
>       @keyup.enter="done()"
>     />
>     <div ref="emojis" class="emojis">
>       <section class="result">
>         <div v-if="searchResultCustom.length > 0" class="body">
>           <button
>             v-for="emoji in searchResultCustom"
>             :key="emoji.id"
>             class="_button item"
>             :title="emoji.name"
>             tabindex="0"
>             @click="chosen(emoji, $event)"
>           >
>             <!--<MkEmoji v-if="emoji.char != null" :emoji="emoji.char"/>-->
>             <img
>               class="emoji"
>               :src="
>                 disableShowingAnimatedImages
>                   ? getStaticImageUrl(emoji.url)
>                   : emoji.url
>               "
>             />
>           </button>
>         </div>
>         <div v-if="searchResultUnicode.length > 0" class="body">
>           <button
>             v-for="emoji in searchResultUnicode"
>             :key="emoji.name"
>             class="_button item"
>             :title="emoji.name"
>             tabindex="0"
>             @click="chosen(emoji, $event)"
>           >
>             <MkEmoji class="emoji" :emoji="emoji.char" />
>           </button>
>         </div>
>       </section>
32,45c54,67
< 		<div v-if="tab === 'index'" class="group index">
< 			<section v-if="showPinned">
< 				<div class="body">
< 					<button
< 						v-for="emoji in pinned"
< 						:key="emoji"
< 						class="_button item"
< 						tabindex="0"
< 						@click="chosen(emoji, $event)"
< 					>
< 						<MkEmoji class="emoji" :emoji="emoji" :normal="true"/>
< 					</button>
< 				</div>
< 			</section>
---
>       <div v-if="tab === 'index'" class="group index">
>         <section v-if="showPinned">
>           <div class="body">
>             <button
>               v-for="emoji in pinned"
>               :key="emoji"
>               class="_button item"
>               tabindex="0"
>               @click="chosen(emoji, $event)"
>             >
>               <MkEmoji class="emoji" :emoji="emoji" :normal="true" />
>             </button>
>           </div>
>         </section>
47,84c69,143
< 			<section>
< 				<header class="_acrylic"><i class="ti ti-clock ti-fw"></i> {{ i18n.ts.recentUsed }}</header>
< 				<div class="body">
< 					<button
< 						v-for="emoji in recentlyUsedEmojis"
< 						:key="emoji"
< 						class="_button item"
< 						@click="chosen(emoji, $event)"
< 					>
< 						<MkEmoji class="emoji" :emoji="emoji" :normal="true"/>
< 					</button>
< 				</div>
< 			</section>
< 		</div>
< 		<div v-once class="group">
< 			<header class="_acrylic">{{ i18n.ts.customEmojis }}</header>
< 			<XSection
< 				v-for="category in customEmojiCategories"
< 				:key="`custom:${category}`"
< 				:initial-shown="false"
< 				:emojis="computed(() => customEmojis.filter(e => category === null ? (e.category === 'null' || !e.category) : e.category === category).map(e => `:${e.name}:`))"
< 				@chosen="chosen"
< 			>
< 				{{ category || i18n.ts.other }}
< 			</XSection>
< 		</div>
< 		<div v-once class="group">
< 			<header class="_acrylic">{{ i18n.ts.emoji }}</header>
< 			<XSection v-for="category in categories" :key="category" :emojis="emojilist.filter(e => e.category === category).map(e => e.char)" @chosen="chosen">{{ category }}</XSection>
< 		</div>
< 	</div>
< 	<div class="tabs">
< 		<button class="_button tab" :class="{ active: tab === 'index' }" @click="tab = 'index'"><i class="ti ti-asterisk ti-fw"></i></button>
< 		<button class="_button tab" :class="{ active: tab === 'custom' }" @click="tab = 'custom'"><i class="ti ti-mood-happy ti-fw"></i></button>
< 		<button class="_button tab" :class="{ active: tab === 'unicode' }" @click="tab = 'unicode'"><i class="ti ti-leaf ti-fw"></i></button>
< 		<button class="_button tab" :class="{ active: tab === 'tags' }" @click="tab = 'tags'"><i class="ti ti-hash ti-fw"></i></button>
< 	</div>
< </div>
---
>         <section>
>           <header class="_acrylic">
>             <i class="far fa-clock fa-fw"></i> {{ i18n.ts.recentUsed }}
>           </header>
>           <div class="body">
>             <button
>               v-for="emoji in recentlyUsedEmojis"
>               :key="emoji"
>               class="_button item"
>               @click="chosen(emoji, $event)"
>             >
>               <MkEmoji class="emoji" :emoji="emoji" :normal="true" />
>             </button>
>           </div>
>         </section>
>       </div>
>       <div v-once class="group">
>         <header class="_acrylic">{{ i18n.ts.customEmojis }}</header>
>         <XSection
>           v-for="category in customEmojiCategories"
>           :key="'custom:' + category"
>           :initial-shown="false"
>           :emojis="
>             customEmojis
>               .filter((e) => e.category === category)
>               .map((e) => ':' + e.name + ':')
>           "
>           @chosen="chosen"
>           >{{ category || i18n.ts.other }}</XSection
>         >
>       </div>
>       <div v-once class="group">
>         <header class="_acrylic">{{ i18n.ts.emoji }}</header>
>         <XSection
>           v-for="category in categories"
>           :key="category"
>           :emojis="
>             emojilist.filter((e) => e.category === category).map((e) => e.char)
>           "
>           @chosen="chosen"
>           >{{ category }}</XSection
>         >
>       </div>
>     </div>
>     <div class="tabs">
>       <button
>         class="_button tab"
>         :class="{ active: tab === 'index' }"
>         @click="tab = 'index'"
>       >
>         <i class="fas fa-asterisk fa-fw"></i>
>       </button>
>       <button
>         class="_button tab"
>         :class="{ active: tab === 'custom' }"
>         @click="tab = 'custom'"
>       >
>         <i class="fas fa-laugh fa-fw"></i>
>       </button>
>       <button
>         class="_button tab"
>         :class="{ active: tab === 'unicode' }"
>         @click="tab = 'unicode'"
>       >
>         <i class="fas fa-leaf fa-fw"></i>
>       </button>
>       <button
>         class="_button tab"
>         :class="{ active: tab === 'tags' }"
>         @click="tab = 'tags'"
>       >
>         <i class="fas fa-hashtag fa-fw"></i>
>       </button>
>     </div>
>   </div>
88,99c147,162
< import { ref, shallowRef, computed, watch, onMounted } from 'vue';
< import * as Misskey from 'misskey-js';
< import XSection from '@/components/MkEmojiPicker.section.vue';
< import { emojilist, UnicodeEmojiDef, unicodeEmojiCategories as categories } from '@/scripts/emojilist';
< import MkRippleEffect from '@/components/MkRippleEffect.vue';
< import * as os from '@/os';
< import { isTouchUsing } from '@/scripts/touch';
< import { deviceKind } from '@/scripts/device-kind';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
< import { customEmojiCategories, customEmojis } from '@/custom-emojis';
---
> import { ref, computed, watch, onMounted } from "vue";
> import * as Misskey from "misskey-js";
> import XSection from "@/components/MkEmojiPicker.section.vue";
> import {
>   emojilist,
>   UnicodeEmojiDef,
>   unicodeEmojiCategories as categories,
> } from "@/scripts/emojilist";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import Ripple from "@/components/MkRipple.vue";
> import * as os from "@/os";
> import { isTouchUsing } from "@/scripts/touch";
> import { deviceKind } from "@/scripts/device-kind";
> import { emojiCategories, instance } from "@/instance";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
101,109c164,174
< const props = withDefaults(defineProps<{
< 	showPinned?: boolean;
< 	asReactionPicker?: boolean;
< 	maxHeight?: number;
< 	asDrawer?: boolean;
< 	asWindow?: boolean;
< }>(), {
< 	showPinned: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     showPinned?: boolean;
>     asReactionPicker?: boolean;
>     maxHeight?: number;
>     asDrawer?: boolean;
>   }>(),
>   {
>     showPinned: true,
>   }
> );
112c177
< 	(ev: 'chosen', v: string): void;
---
>   (ev: "chosen", v: string): void;
115,116c180,181
< const searchEl = shallowRef<HTMLInputElement>();
< const emojisEl = shallowRef<HTMLDivElement>();
---
> const search = ref<HTMLInputElement>();
> const emojis = ref<HTMLDivElement>();
119,124c184,189
< 	reactions: pinned,
< 	reactionPickerSize,
< 	reactionPickerWidth,
< 	reactionPickerHeight,
< 	disableShowingAnimatedImages,
< 	recentlyUsedEmojis,
---
>   reactions: pinned,
>   reactionPickerSize,
>   reactionPickerWidth,
>   reactionPickerHeight,
>   disableShowingAnimatedImages,
>   recentlyUsedEmojis,
127,130c192,203
< const size = computed(() => props.asReactionPicker ? reactionPickerSize.value : 1);
< const width = computed(() => props.asReactionPicker ? reactionPickerWidth.value : 3);
< const height = computed(() => props.asReactionPicker ? reactionPickerHeight.value : 2);
< const q = ref<string>('');
---
> const size = computed(() =>
>   props.asReactionPicker ? reactionPickerSize.value : 1
> );
> const width = computed(() =>
>   props.asReactionPicker ? reactionPickerWidth.value : 3
> );
> const height = computed(() =>
>   props.asReactionPicker ? reactionPickerHeight.value : 2
> );
> const customEmojiCategories = emojiCategories;
> const customEmojis = instance.emojis;
> const q = ref<string | null>(null);
133c206
< const tab = ref<'index' | 'custom' | 'unicode' | 'tags'>('index');
---
> const tab = ref<"index" | "custom" | "unicode" | "tags">("index");
136c209
< 	if (emojisEl.value) emojisEl.value.scrollTop = 0;
---
>   if (emojis.value) emojis.value.scrollTop = 0;
138,142c211,215
< 	if (q.value === '') {
< 		searchResultCustom.value = [];
< 		searchResultUnicode.value = [];
< 		return;
< 	}
---
>   if (q.value == null || q.value === "") {
>     searchResultCustom.value = [];
>     searchResultUnicode.value = [];
>     return;
>   }
144c217
< 	const newQ = q.value.replace(/:/g, '').toLowerCase();
---
>   const newQ = q.value.replace(/:/g, "");
146,149c219,222
< 	const searchCustom = () => {
< 		const max = 8;
< 		const emojis = customEmojis.value;
< 		const matches = new Set<Misskey.entities.CustomEmoji>();
---
>   const searchCustom = () => {
>     const max = 8;
>     const emojis = customEmojis;
>     const matches = new Set<Misskey.entities.CustomEmoji>();
151,152c224,225
< 		const exactMatch = emojis.find(emoji => emoji.name === newQ);
< 		if (exactMatch) matches.add(exactMatch);
---
>     const exactMatch = emojis.find((emoji) => emoji.name === newQ);
>     if (exactMatch) matches.add(exactMatch);
154,155c227,229
< 		if (newQ.includes(' ')) { // AND検索
< 			const keywords = newQ.split(' ');
---
>     if (newQ.includes(" ")) {
>       // AND検索
>       const keywords = newQ.split(" ");
157,164c231,238
< 			// 名前にキーワードが含まれている
< 			for (const emoji of emojis) {
< 				if (keywords.every(keyword => emoji.name.includes(keyword))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       // 名前にキーワードが含まれている
>       for (const emoji of emojis) {
>         if (keywords.every((keyword) => emoji.name.includes(keyword))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
166,180c240,260
< 			// 名前またはエイリアスにキーワードが含まれている
< 			for (const emoji of emojis) {
< 				if (keywords.every(keyword => emoji.name.includes(keyword) || emoji.aliases.some(alias => alias.includes(keyword)))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 		} else {
< 			for (const emoji of emojis) {
< 				if (emoji.name.startsWith(newQ)) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       // 名前またはエイリアスにキーワードが含まれている
>       for (const emoji of emojis) {
>         if (
>           keywords.every(
>             (keyword) =>
>               emoji.name.includes(keyword) ||
>               emoji.aliases.some((alias) => alias.includes(keyword))
>           )
>         ) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>     } else {
>       for (const emoji of emojis) {
>         if (emoji.name.startsWith(newQ)) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
182,188c262,268
< 			for (const emoji of emojis) {
< 				if (emoji.aliases.some(alias => alias.startsWith(newQ))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       for (const emoji of emojis) {
>         if (emoji.aliases.some((alias) => alias.startsWith(newQ))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
190,196c270,276
< 			for (const emoji of emojis) {
< 				if (emoji.name.includes(newQ)) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       for (const emoji of emojis) {
>         if (emoji.name.includes(newQ)) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
198,204c278,284
< 			for (const emoji of emojis) {
< 				if (emoji.aliases.some(alias => alias.includes(newQ))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 		}
---
>       for (const emoji of emojis) {
>         if (emoji.aliases.some((alias) => alias.includes(newQ))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>     }
206,207c286,287
< 		return matches;
< 	};
---
>     return matches;
>   };
209,212c289,292
< 	const searchUnicode = () => {
< 		const max = 8;
< 		const emojis = emojilist;
< 		const matches = new Set<UnicodeEmojiDef>();
---
>   const searchUnicode = () => {
>     const max = 8;
>     const emojis = emojilist;
>     const matches = new Set<UnicodeEmojiDef>();
214,215c294,295
< 		const exactMatch = emojis.find(emoji => emoji.name === newQ);
< 		if (exactMatch) matches.add(exactMatch);
---
>     const exactMatch = emojis.find((emoji) => emoji.name === newQ);
>     if (exactMatch) matches.add(exactMatch);
217,218c297,299
< 		if (newQ.includes(' ')) { // AND検索
< 			const keywords = newQ.split(' ');
---
>     if (newQ.includes(" ")) {
>       // AND検索
>       const keywords = newQ.split(" ");
220,227c301,308
< 			// 名前にキーワードが含まれている
< 			for (const emoji of emojis) {
< 				if (keywords.every(keyword => emoji.name.includes(keyword))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       // 名前にキーワードが含まれている
>       for (const emoji of emojis) {
>         if (keywords.every((keyword) => emoji.name.includes(keyword))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
229,243c310,330
< 			// 名前またはエイリアスにキーワードが含まれている
< 			for (const emoji of emojis) {
< 				if (keywords.every(keyword => emoji.name.includes(keyword) || emoji.keywords.some(alias => alias.includes(keyword)))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 		} else {
< 			for (const emoji of emojis) {
< 				if (emoji.name.startsWith(newQ)) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       // 名前またはエイリアスにキーワードが含まれている
>       for (const emoji of emojis) {
>         if (
>           keywords.every(
>             (keyword) =>
>               emoji.name.includes(keyword) ||
>               emoji.keywords.some((alias) => alias.includes(keyword))
>           )
>         ) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>     } else {
>       for (const emoji of emojis) {
>         if (emoji.name.startsWith(newQ)) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
245,251c332,338
< 			for (const emoji of emojis) {
< 				if (emoji.keywords.some(keyword => keyword.startsWith(newQ))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       for (const emoji of emojis) {
>         if (emoji.keywords.some((keyword) => keyword.startsWith(newQ))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
253,259c340,346
< 			for (const emoji of emojis) {
< 				if (emoji.name.includes(newQ)) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 			if (matches.size >= max) return matches;
---
>       for (const emoji of emojis) {
>         if (emoji.name.includes(newQ)) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>       if (matches.size >= max) return matches;
261,267c348,354
< 			for (const emoji of emojis) {
< 				if (emoji.keywords.some(keyword => keyword.includes(newQ))) {
< 					matches.add(emoji);
< 					if (matches.size >= max) break;
< 				}
< 			}
< 		}
---
>       for (const emoji of emojis) {
>         if (emoji.keywords.some((keyword) => keyword.includes(newQ))) {
>           matches.add(emoji);
>           if (matches.size >= max) break;
>         }
>       }
>     }
269,270c356,357
< 		return matches;
< 	};
---
>     return matches;
>   };
272,273c359,360
< 	searchResultCustom.value = Array.from(searchCustom());
< 	searchResultUnicode.value = Array.from(searchUnicode());
---
>   searchResultCustom.value = Array.from(searchCustom());
>   searchResultUnicode.value = Array.from(searchUnicode());
277,281c364,368
< 	if (!['smartphone', 'tablet'].includes(deviceKind) && !isTouchUsing) {
< 		searchEl.value?.focus({
< 			preventScroll: true,
< 		});
< 	}
---
>   if (!["smartphone", "tablet"].includes(deviceKind) && !isTouchUsing) {
>     search.value?.focus({
>       preventScroll: true,
>     });
>   }
285,286c372,373
< 	if (emojisEl.value) emojisEl.value.scrollTop = 0;
< 	q.value = '';
---
>   if (emojis.value) emojis.value.scrollTop = 0;
>   q.value = "";
289,290c376,379
< function getKey(emoji: string | Misskey.entities.CustomEmoji | UnicodeEmojiDef): string {
< 	return typeof emoji === 'string' ? emoji : 'char' in emoji ? emoji.char : `:${emoji.name}:`;
---
> function getKey(
>   emoji: string | Misskey.entities.CustomEmoji | UnicodeEmojiDef
> ): string {
>   return typeof emoji === "string" ? emoji : emoji.char || `:${emoji.name}:`;
294,300c383,390
< 	const el = ev && (ev.currentTarget ?? ev.target) as HTMLElement | null | undefined;
< 	if (el) {
< 		const rect = el.getBoundingClientRect();
< 		const x = rect.left + (el.offsetWidth / 2);
< 		const y = rect.top + (el.offsetHeight / 2);
< 		os.popup(MkRippleEffect, { x, y }, {}, 'end');
< 	}
---
>   const el =
>     ev && ((ev.currentTarget ?? ev.target) as HTMLElement | null | undefined);
>   if (el) {
>     const rect = el.getBoundingClientRect();
>     const x = rect.left + el.offsetWidth / 2;
>     const y = rect.top + el.offsetHeight / 2;
>     os.popup(Ripple, { x, y }, {}, "end");
>   }
302,303c392,393
< 	const key = getKey(emoji);
< 	emit('chosen', key);
---
>   const key = getKey(emoji);
>   emit("chosen", key);
305,311c395,401
< 	// 最近使った絵文字更新
< 	if (!pinned.value.includes(key)) {
< 		let recents = defaultStore.state.recentlyUsedEmojis;
< 		recents = recents.filter((emoji: any) => emoji !== key);
< 		recents.unshift(key);
< 		defaultStore.set('recentlyUsedEmojis', recents.splice(0, 32));
< 	}
---
>   // 最近使った絵文字更新
>   if (!pinned.value.includes(key)) {
>     let recents = defaultStore.state.recentlyUsedEmojis;
>     recents = recents.filter((emoji: any) => emoji !== key);
>     recents.unshift(key);
>     defaultStore.set("recentlyUsedEmojis", recents.splice(0, 32));
>   }
314,318c404,408
< function input(): void {
< 	// Using custom input event instead of v-model to respond immediately on
< 	// Android, where composition happens on all languages
< 	// (v-model does not update during composition)
< 	q.value = searchEl.value?.value.trim() ?? '';
---
> function paste(event: ClipboardEvent) {
>   const paste = (event.clipboardData || window.clipboardData).getData("text");
>   if (done(paste)) {
>     event.preventDefault();
>   }
321,326c411,413
< function paste(event: ClipboardEvent): void {
< 	const pasted = event.clipboardData?.getData('text') ?? '';
< 	if (done(pasted)) {
< 		event.preventDefault();
< 	}
< }
---
> function done(query?: any): boolean | void {
>   if (query == null) query = q.value;
>   if (query == null || typeof query !== "string") return;
328,350c415,435
< function done(query?: string): boolean | void {
< 	if (query == null) query = q.value;
< 	if (query == null || typeof query !== 'string') return;
< 
< 	const q2 = query.replace(/:/g, '');
< 	const exactMatchCustom = customEmojis.value.find(emoji => emoji.name === q2);
< 	if (exactMatchCustom) {
< 		chosen(exactMatchCustom);
< 		return true;
< 	}
< 	const exactMatchUnicode = emojilist.find(emoji => emoji.char === q2 || emoji.name === q2);
< 	if (exactMatchUnicode) {
< 		chosen(exactMatchUnicode);
< 		return true;
< 	}
< 	if (searchResultCustom.value.length > 0) {
< 		chosen(searchResultCustom.value[0]);
< 		return true;
< 	}
< 	if (searchResultUnicode.value.length > 0) {
< 		chosen(searchResultUnicode.value[0]);
< 		return true;
< 	}
---
>   const q2 = query.replace(/:/g, "");
>   const exactMatchCustom = customEmojis.find((emoji) => emoji.name === q2);
>   if (exactMatchCustom) {
>     chosen(exactMatchCustom);
>     return true;
>   }
>   const exactMatchUnicode = emojilist.find(
>     (emoji) => emoji.char === q2 || emoji.name === q2
>   );
>   if (exactMatchUnicode) {
>     chosen(exactMatchUnicode);
>     return true;
>   }
>   if (searchResultCustom.value.length > 0) {
>     chosen(searchResultCustom.value[0]);
>     return true;
>   }
>   if (searchResultUnicode.value.length > 0) {
>     chosen(searchResultUnicode.value[0]);
>     return true;
>   }
354c439
< 	focus();
---
>   focus();
358,359c443,444
< 	focus,
< 	reset,
---
>   focus,
>   reset,
365c450,451
< 	$pad: 8px;
---
>   $pad: 8px;
>   padding-bottom:  env(safe-area-inset-bottom);
367,368c453,454
< 	display: flex;
< 	flex-direction: column;
---
>   display: flex;
>   flex-direction: column;
370,372c456,458
< 	&.s1 {
< 		--eachSize: 40px;
< 	}
---
>   &.s1 {
>     --eachSize: 40px;
>   }
374,376c460,462
< 	&.s2 {
< 		--eachSize: 45px;
< 	}
---
>   &.s2 {
>     --eachSize: 45px;
>   }
378,380c464,466
< 	&.s3 {
< 		--eachSize: 50px;
< 	}
---
>   &.s3 {
>     --eachSize: 50px;
>   }
382,385c468,471
< 	&.w1 {
< 		width: calc((var(--eachSize) * 5) + (#{$pad} * 2));
< 		--columns: 1fr 1fr 1fr 1fr 1fr;
< 	}
---
>   &.w1 {
>     width: calc((var(--eachSize) * 5) + (#{$pad} * 2));
>     --columns: 1fr 1fr 1fr 1fr 1fr;
>   }
387,390c473,476
< 	&.w2 {
< 		width: calc((var(--eachSize) * 6) + (#{$pad} * 2));
< 		--columns: 1fr 1fr 1fr 1fr 1fr 1fr;
< 	}
---
>   &.w2 {
>     width: calc((var(--eachSize) * 6) + (#{$pad} * 2));
>     --columns: 1fr 1fr 1fr 1fr 1fr 1fr;
>   }
392,395c478,481
< 	&.w3 {
< 		width: calc((var(--eachSize) * 7) + (#{$pad} * 2));
< 		--columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
< 	}
---
>   &.w3 {
>     width: calc((var(--eachSize) * 7) + (#{$pad} * 2));
>     --columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
>   }
397,400c483,486
< 	&.w4 {
< 		width: calc((var(--eachSize) * 8) + (#{$pad} * 2));
< 		--columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
< 	}
---
>   &.w4 {
>     width: calc((var(--eachSize) * 8) + (#{$pad} * 2));
>     --columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
>   }
402,405c488,491
< 	&.w5 {
< 		width: calc((var(--eachSize) * 9) + (#{$pad} * 2));
< 		--columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
< 	}
---
>   &.w5 {
>     width: calc((var(--eachSize) * 9) + (#{$pad} * 2));
>     --columns: 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;
>   }
407,409c493,495
< 	&.h1 {
< 		height: calc((var(--eachSize) * 4) + (#{$pad} * 2));
< 	}
---
>   &.h1 {
>     height: calc((var(--eachSize) * 4) + (#{$pad} * 2));
>   }
411,413c497,499
< 	&.h2 {
< 		height: calc((var(--eachSize) * 6) + (#{$pad} * 2));
< 	}
---
>   &.h2 {
>     height: calc((var(--eachSize) * 6) + (#{$pad} * 2));
>   }
415,417c501,503
< 	&.h3 {
< 		height: calc((var(--eachSize) * 8) + (#{$pad} * 2));
< 	}
---
>   &.h3 {
>     height: calc((var(--eachSize) * 8) + (#{$pad} * 2));
>   }
419,421c505,507
< 	&.h4 {
< 		height: calc((var(--eachSize) * 10) + (#{$pad} * 2));
< 	}
---
>   &.h4 {
>     height: calc((var(--eachSize) * 10) + (#{$pad} * 2));
>   }
423,424c509,510
< 	&.asDrawer {
< 		width: 100% !important;
---
>   &.asDrawer {
>     width: 100% !important;
426,433c512,519
< 		> .emojis {
< 			::v-deep(section) {
< 				> header {
< 					height: 32px;
< 					line-height: 32px;
< 					padding: 0 12px;
< 					font-size: 15px;
< 				}
---
>     > .emojis {
>       ::v-deep(section) {
>         > header {
>           height: 32px;
>           line-height: 32px;
>           padding: 0 12px;
>           font-size: 15px;
>         }
435,438c521,524
< 				> .body {
< 					display: grid;
< 					grid-template-columns: var(--columns);
< 					font-size: 30px;
---
>         > .body {
>           display: grid;
>           grid-template-columns: var(--columns);
>           font-size: 30px;
440,449c526,535
< 					> .item {
< 						aspect-ratio: 1 / 1;
< 						width: auto;
< 						height: auto;
< 						min-width: 0;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > .item {
>             aspect-ratio: 1 / 1;
>             width: auto;
>             height: auto;
>             min-width: 0;
>           }
>         }
>       }
>     }
>   }
451,453c537,545
< 	&.asWindow {
< 		width: 100% !important;
< 		height: 100% !important;
---
>   > .search {
>     width: 100%;
>     padding: 12px;
>     box-sizing: border-box;
>     font-size: 1em;
>     outline: none;
>     border: none;
>     background: transparent;
>     color: var(--fg);
455,460c547,552
< 		> .emojis {
< 			::v-deep(section) {
< 				> .body {
< 					display: grid;
< 					grid-template-columns: var(--columns);
< 					font-size: 30px;
---
>     &:not(.filled) {
>       order: 1;
>       z-index: 2;
>       box-shadow: 0px -1px 0 0px var(--divider);
>     }
>   }
462,471c554,556
< 					> .item {
< 						aspect-ratio: 1 / 1;
< 						width: auto;
< 						height: auto;
< 						min-width: 0;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>   > .tabs {
>     display: flex;
>     display: none;
473,481c558,561
< 	> .search {
< 		width: 100%;
< 		padding: 12px;
< 		box-sizing: border-box;
< 		font-size: 1em;
< 		outline: none;
< 		border: none;
< 		background: transparent;
< 		color: var(--fg);
---
>     > .tab {
>       flex: 1;
>       height: 38px;
>       border-top: solid 0.5px var(--divider);
483,488c563,568
< 		&:not(.filled) {
< 			order: 1;
< 			z-index: 2;
< 			box-shadow: 0px -1px 0 0px var(--divider);
< 		}
< 	}
---
>       &.active {
>         border-top: solid 1px var(--accent);
>         color: var(--accent);
>       }
>     }
>   }
490,492c570,573
< 	> .tabs {
< 		display: flex;
< 		display: none;
---
>   > .emojis {
>     height: 100%;
>     overflow-y: auto;
>     overflow-x: hidden;
494,497c575
< 		> .tab {
< 			flex: 1;
< 			height: 38px;
< 			border-top: solid 0.5px var(--divider);
---
>     scrollbar-width: none;
499,504c577,579
< 			&.active {
< 				border-top: solid 1px var(--accent);
< 				color: var(--accent);
< 			}
< 		}
< 	}
---
>     &::-webkit-scrollbar {
>       display: none;
>     }
506,509c581,585
< 	> .emojis {
< 		height: 100%;
< 		overflow-y: auto;
< 		overflow-x: hidden;
---
>     > .group {
>       &:not(.index) {
>         padding: 4px 0 8px 0;
>         border-top: solid 0.5px var(--divider);
>       }
511,524c587,588
< 		scrollbar-width: none;
< 
< 		&::-webkit-scrollbar {
< 			display: none;
< 		}
< 
< 		> .group {
< 			&:not(.index) {
< 				padding: 4px 0 8px 0;
< 				border-top: solid 0.5px var(--divider);
< 			}
< 
< 			> header {
< 				/*position: sticky;
---
>       > header {
>         /*position: sticky;
527,533c591,597
< 				height: 32px;
< 				line-height: 32px;
< 				z-index: 2;
< 				padding: 0 8px;
< 				font-size: 12px;
< 			}
< 		}
---
>         height: 32px;
>         line-height: 32px;
>         z-index: 2;
>         padding: 0 8px;
>         font-size: 12px;
>       }
>     }
535,545c599,609
< 		::v-deep(section) {
< 			> header {
< 				position: sticky;
< 				top: 0;
< 				left: 0;
< 				height: 32px;
< 				line-height: 32px;
< 				z-index: 1;
< 				padding: 0 8px;
< 				font-size: 12px;
< 				cursor: pointer;
---
>     ::v-deep(section) {
>       > header {
>         position: sticky;
>         top: 0;
>         left: 0;
>         height: 32px;
>         line-height: 32px;
>         z-index: 1;
>         padding: 0 8px;
>         font-size: 12px;
>         cursor: pointer;
547,550c611,614
< 				&:hover {
< 					color: var(--accent);
< 				}
< 			}
---
>         &:hover {
>           color: var(--accent);
>         }
>       }
552,554c616,618
< 			> .body {
< 				position: relative;
< 				padding: $pad;
---
>       > .body {
>         position: relative;
>         padding: $pad;
556,563c620,627
< 				> .item {
< 					position: relative;
< 					padding: 0;
< 					width: var(--eachSize);
< 					height: var(--eachSize);
< 					contain: strict;
< 					border-radius: 4px;
< 					font-size: 24px;
---
>         > .item {
>           position: relative;
>           padding: 0;
>           width: var(--eachSize);
>           height: var(--eachSize);
>           contain: strict;
>           border-radius: 4px;
>           font-size: 24px;
565,568c629,632
< 					&:focus-visible {
< 						outline: solid 2px var(--focus);
< 						z-index: 1;
< 					}
---
>           &:focus-visible {
>             outline: solid 2px var(--focus);
>             z-index: 1;
>           }
570,572c634,636
< 					&:hover {
< 						background: rgba(0, 0, 0, 0.05);
< 					}
---
>           &:hover {
>             background: rgba(0, 0, 0, 0.05);
>           }
574,577c638,641
< 					&:active {
< 						background: var(--accent);
< 						box-shadow: inset 0 0.15em 0.3em rgba(27, 31, 35, 0.15);
< 					}
---
>           &:active {
>             background: var(--accent);
>             box-shadow: inset 0 0.15em 0.3em rgba(27, 31, 35, 0.15);
>           }
579,585c643,649
< 					> .emoji {
< 						height: 1.25em;
< 						vertical-align: -.25em;
< 						pointer-events: none;
< 					}
< 				}
< 			}
---
>           > .emoji {
>             height: 1.25em;
>             vertical-align: -0.25em;
>             pointer-events: none;
>           }
>         }
>       }
587,588c651,652
< 			&.result {
< 				border-bottom: solid 0.5px var(--divider);
---
>       &.result {
>         border-bottom: solid 0.5px var(--divider);
590,595c654,659
< 				&:empty {
< 					display: none;
< 				}
< 			}
< 		}
< 	}
---
>         &:empty {
>           display: none;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkEmojiPickerDialog.vue RiricaV13/components/MkEmojiPickerDialog.vue
2,25c2,30
< <MkModal
< 	ref="modal"
< 	v-slot="{ type, maxHeight }"
< 	:z-priority="'middle'"
< 	:prefer-type="asReactionPicker && defaultStore.state.reactionPickerUseDrawerForMobile === false ? 'popup' : 'auto'"
< 	:transparent-bg="true"
< 	:manual-showing="manualShowing"
< 	:src="src"
< 	@click="modal?.close()"
< 	@opening="opening"
< 	@close="emit('close')"
< 	@closed="emit('closed')"
< >
< 	<MkEmojiPicker
< 		ref="picker"
< 		class="ryghynhb _popup _shadow"
< 		:class="{ drawer: type === 'drawer' }"
< 		:show-pinned="showPinned"
< 		:as-reaction-picker="asReactionPicker"
< 		:as-drawer="type === 'drawer'"
< 		:max-height="maxHeight"
< 		@chosen="chosen"
< 	/>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     v-slot="{ type, maxHeight }"
>     :z-priority="'middle'"
>     :prefer-type="
>       asReactionPicker &&
>       defaultStore.state.reactionPickerUseDrawerForMobile === false
>         ? 'popup'
>         : 'auto'
>     "
>     :transparent-bg="true"
>     :manual-showing="manualShowing"
>     :src="src"
>     @click="modal?.close()"
>     @opening="opening"
>     @close="emit('close')"
>     @closed="emit('closed')"
>   >
>     <MkEmojiPicker
>       ref="picker"
>       class="ryghynhb _popup _shadow"
>       :class="{ drawer: type === 'drawer' }"
>       :show-pinned="showPinned"
>       :as-reaction-picker="asReactionPicker"
>       :as-drawer="type === 'drawer'"
>       :max-height="maxHeight"
>       @chosen="chosen"
>     />
>   </MkModal>
29,32c34,37
< import { shallowRef } from 'vue';
< import MkModal from '@/components/MkModal.vue';
< import MkEmojiPicker from '@/components/MkEmojiPicker.vue';
< import { defaultStore } from '@/store';
---
> import { ref } from "vue";
> import MkModal from "@/components/MkModal.vue";
> import MkEmojiPicker from "@/components/MkEmojiPicker.vue";
> import { defaultStore } from "@/store";
34,43c39,51
< withDefaults(defineProps<{
< 	manualShowing?: boolean | null;
< 	src?: HTMLElement;
< 	showPinned?: boolean;
< 	asReactionPicker?: boolean;
< }>(), {
< 	manualShowing: null,
< 	showPinned: true,
< 	asReactionPicker: false,
< });
---
> withDefaults(
>   defineProps<{
>     manualShowing?: boolean | null;
>     src?: HTMLElement;
>     showPinned?: boolean;
>     asReactionPicker?: boolean;
>   }>(),
>   {
>     manualShowing: null,
>     showPinned: true,
>     asReactionPicker: false,
>   }
> );
46,48c54,56
< 	(ev: 'done', v: any): void;
< 	(ev: 'close'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "done", v: any): void;
>   (ev: "close"): void;
>   (ev: "closed"): void;
51,52c59,60
< const modal = shallowRef<InstanceType<typeof MkModal>>();
< const picker = shallowRef<InstanceType<typeof MkEmojiPicker>>();
---
> const modal = ref<InstanceType<typeof MkModal>>();
> const picker = ref<InstanceType<typeof MkEmojiPicker>>();
55,56c63,64
< 	emit('done', emoji);
< 	modal.value?.close();
---
>   emit("done", emoji);
>   modal.value?.close();
60,66c68,69
< 	picker.value?.reset();
< 	picker.value?.focus();
< 
< 	// 何故かちょっと待たないとフォーカスされない
< 	setTimeout(() => {
< 		picker.value?.focus();
< 	}, 10);
---
>   picker.value?.reset();
>   picker.value?.focus();
72,76c75,79
< 	&.drawer {
< 		border-radius: 24px;
< 		border-bottom-right-radius: 0;
< 		border-bottom-left-radius: 0;
< 	}
---
>   &.drawer {
>     border-radius: 24px;
>     border-bottom-right-radius: 0;
>     border-bottom-left-radius: 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkEmojiPickerWindow.vue RiricaV13/components/MkEmojiPickerWindow.vue
2,11c2,16
< <MkWindow ref="window"
< 	:initial-width="300"
< 	:initial-height="290"
< 	:can-resize="true"
< 	:mini="true"
< 	:front="true"
< 	@closed="emit('closed')"
< >
< 	<MkEmojiPicker :show-pinned="showPinned" :as-reaction-picker="asReactionPicker" as-window @chosen="chosen" :class="$style.picker"/>
< </MkWindow>
---
>   <MkWindow
>     ref="window"
>     :initial-width="null"
>     :initial-height="null"
>     :can-resize="false"
>     :mini="true"
>     :front="true"
>     @closed="emit('closed')"
>   >
>     <MkEmojiPicker
>       :show-pinned="showPinned"
>       :as-reaction-picker="asReactionPicker"
>       @chosen="chosen"
>     />
>   </MkWindow>
15,17c20,22
< import { } from 'vue';
< import MkWindow from '@/components/MkWindow.vue';
< import MkEmojiPicker from '@/components/MkEmojiPicker.vue';
---
> import {} from "vue";
> import MkWindow from "@/components/MkWindow.vue";
> import MkEmojiPicker from "@/components/MkEmojiPicker.vue";
19,25c24,33
< withDefaults(defineProps<{
< 	src?: HTMLElement;
< 	showPinned?: boolean;
< 	asReactionPicker?: boolean;
< }>(), {
< 	showPinned: true,
< });
---
> withDefaults(
>   defineProps<{
>     src?: HTMLElement;
>     showPinned?: boolean;
>     asReactionPicker?: boolean;
>   }>(),
>   {
>     showPinned: true,
>   }
> );
28,29c36,37
< 	(ev: 'chosen', v: any): void;
< 	(ev: 'closed'): void;
---
>   (ev: "chosen", v: any): void;
>   (ev: "closed"): void;
33c41
< 	emit('chosen', emoji);
---
>   emit("chosen", emoji);
37,39c45,186
< <style lang="scss" module>
< .picker {
< 	height: 100%;
---
> <style lang="scss" scoped>
> .omfetrab {
>   $pad: 8px;
>   --eachSize: 40px;
> 
>   display: flex;
>   flex-direction: column;
>   contain: content;
> 
>   &.big {
>     --eachSize: 44px;
>   }
> 
>   &.w1 {
>     width: calc((var(--eachSize) * 5) + (#{$pad} * 2));
>   }
> 
>   &.w2 {
>     width: calc((var(--eachSize) * 6) + (#{$pad} * 2));
>   }
> 
>   &.w3 {
>     width: calc((var(--eachSize) * 7) + (#{$pad} * 2));
>   }
> 
>   &.h1 {
>     --height: calc((var(--eachSize) * 4) + (#{$pad} * 2));
>   }
> 
>   &.h2 {
>     --height: calc((var(--eachSize) * 6) + (#{$pad} * 2));
>   }
> 
>   &.h3 {
>     --height: calc((var(--eachSize) * 8) + (#{$pad} * 2));
>   }
> 
>   > .search {
>     width: 100%;
>     padding: 12px;
>     box-sizing: border-box;
>     font-size: 1em;
>     outline: none;
>     border: none;
>     background: transparent;
>     color: var(--fg);
> 
>     &:not(.filled) {
>       order: 1;
>       z-index: 2;
>       box-shadow: 0px -1px 0 0px var(--divider);
>     }
>   }
> 
>   > .emojis {
>     height: var(--height);
>     overflow-y: auto;
>     overflow-x: hidden;
> 
>     scrollbar-width: none;
> 
>     &::-webkit-scrollbar {
>       display: none;
>     }
> 
>     > .index {
>       min-height: var(--height);
>       position: relative;
>       border-bottom: solid 0.5px var(--divider);
> 
>       > .arrow {
>         position: absolute;
>         bottom: 0;
>         left: 0;
>         width: 100%;
>         padding: 16px 0;
>         text-align: center;
>         opacity: 0.5;
>         pointer-events: none;
>       }
>     }
> 
>     section {
>       > header {
>         position: sticky;
>         top: 0;
>         left: 0;
>         z-index: 1;
>         padding: 8px;
>         font-size: 12px;
>       }
> 
>       > div {
>         padding: $pad;
> 
>         > button {
>           position: relative;
>           padding: 0;
>           width: var(--eachSize);
>           height: var(--eachSize);
>           border-radius: 4px;
> 
>           &:focus-visible {
>             outline: solid 2px var(--focus);
>             z-index: 1;
>           }
> 
>           &:hover {
>             background: rgba(0, 0, 0, 0.05);
>           }
> 
>           &:active {
>             background: var(--accent);
>             box-shadow: inset 0 0.15em 0.3em rgba(27, 31, 35, 0.15);
>           }
> 
>           > * {
>             font-size: 24px;
>             height: 1.25em;
>             vertical-align: -0.25em;
>             pointer-events: none;
>           }
>         }
>       }
> 
>       &.result {
>         border-bottom: solid 0.5px var(--divider);
> 
>         &:empty {
>           display: none;
>         }
>       }
> 
>       &.unicode {
>         min-height: 384px;
>       }
> 
>       &.custom {
>         min-height: 64px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkFeaturedPhotos.vue RiricaV13/components/MkFeaturedPhotos.vue
2c2,6
< <div v-if="meta" :class="$style.root" :style="{ backgroundImage: `url(${ meta.backgroundImageUrl })` }"></div>
---
>   <div
>     v-if="meta"
>     class="xfbouadm"
>     :style="{ backgroundImage: `url(${meta.backgroundImageUrl})` }"
>   ></div>
6,8c10,12
< import { ref } from 'vue';
< import * as Misskey from 'misskey-js';
< import * as os from '@/os';
---
> import { ref } from "vue";
> import * as Misskey from "misskey-js";
> import * as os from "@/os";
12,13c16,17
< os.api('meta', { detail: true }).then(gotMeta => {
< 	meta.value = gotMeta;
---
> os.api("meta", { detail: true }).then((gotMeta) => {
>   meta.value = gotMeta;
17,20c21,24
< <style lang="scss" module>
< .root {
< 	background-position: center;
< 	background-size: cover;
---
> <style lang="scss" scoped>
> .xfbouadm {
>   background-position: center;
>   background-size: cover;
Only in misskeyV13/packages/frontend/src/components: MkFileCaptionEditWindow.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkFileListForAdmin.vue RiricaV13/components/MkFileListForAdmin.vue
2,31c2,47
< <div>
< 	<MkPagination v-slot="{items}" :pagination="pagination" class="urempief" :class="{ grid: viewMode === 'grid' }">
< 		<MkA
< 			v-for="file in items"
< 			:key="file.id"
< 			v-tooltip.mfm="`${file.type}\n${bytes(file.size)}\n${dateString(file.createdAt)}\nby ${file.user ? '@' + Acct.toString(file.user) : 'system'}`"
< 			:to="`/admin/file/${file.id}`"
< 			class="file _button"
< 		>
< 			<div v-if="file.isSensitive" class="sensitive-label">{{ i18n.ts.sensitive }}</div>
< 			<MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain"/>
< 			<div v-if="viewMode === 'list'" class="body">
< 				<div>
< 					<small style="opacity: 0.7;">{{ file.name }}</small>
< 				</div>
< 				<div>
< 					<MkAcct v-if="file.user" :user="file.user"/>
< 					<div v-else>{{ i18n.ts.system }}</div>
< 				</div>
< 				<div>
< 					<span style="margin-right: 1em;">{{ file.type }}</span>
< 					<span>{{ bytes(file.size) }}</span>
< 				</div>
< 				<div>
< 					<span>{{ i18n.ts.registeredDate }}: <MkTime :time="file.createdAt" mode="detail"/></span>
< 				</div>
< 			</div>
< 		</MkA>
< 	</MkPagination>
< </div>
---
>   <div>
>     <MkPagination
>       v-slot="{ items }"
>       :pagination="pagination"
>       class="urempief"
>       :class="{ grid: viewMode === 'grid' }"
>     >
>       <MkA
>         v-for="file in items"
>         :key="file.id"
>         v-tooltip.mfm="
>           `${file.type}\n${bytes(file.size)}\n${new Date(
>             file.createdAt
>           ).toLocaleString()}\nby ${
>             file.user ? '@' + Acct.toString(file.user) : 'system'
>           }`
>         "
>         :to="`/admin/file/${file.id}`"
>         class="file _button"
>       >
>         <div v-if="file.isSensitive" class="sensitive-label">
>           {{ i18n.ts.sensitive }}
>         </div>
>         <MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain" />
>         <div v-if="viewMode === 'list'" class="body">
>           <div>
>             <small style="opacity: 0.7">{{ file.name }}</small>
>           </div>
>           <div>
>             <MkAcct v-if="file.user" :user="file.user" />
>             <div v-else>{{ i18n.ts.system }}</div>
>           </div>
>           <div>
>             <span style="margin-right: 1em">{{ file.type }}</span>
>             <span>{{ bytes(file.size) }}</span>
>           </div>
>           <div>
>             <span
>               >{{ i18n.ts.registeredDate }}:
>               <MkTime :time="file.createdAt" mode="detail"
>             /></span>
>           </div>
>         </div>
>       </MkA>
>     </MkPagination>
>   </div>
35,42c51,57
< import { computed } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import MkPagination from '@/components/MkPagination.vue';
< import MkDriveFileThumbnail from '@/components/MkDriveFileThumbnail.vue';
< import bytes from '@/filters/bytes';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { dateString } from '@/filters/date';
---
> import { computed } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import MkPagination from "@/components/MkPagination.vue";
> import MkDriveFileThumbnail from "@/components/MkDriveFileThumbnail.vue";
> import bytes from "@/filters/bytes";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
45,46c60,61
< 	pagination: any;
< 	viewMode: 'grid' | 'list';
---
>   pagination: any;
>   viewMode: "grid" | "list";
52,53c67,72
< 	0% { opacity: 1; }
< 	50% { opacity: 0; }
---
>   0% {
>     opacity: 1;
>   }
>   50% {
>     opacity: 0;
>   }
57,63c76
< 	&.list {
< 		> .file {
< 			display: flex;
< 			width: 100%;
< 			box-sizing: border-box;
< 			text-align: left;
< 			align-items: center;
---
>   margin-top: var(--margin);
65,67c78,84
< 			&:hover {
< 				color: var(--accent);
< 			}
---
>   &.list {
>     > .file {
>       display: flex;
>       width: 100%;
>       box-sizing: border-box;
>       text-align: left;
>       align-items: center;
69,72c86,88
< 			> .thumbnail {
< 				width: 128px;
< 				height: 128px;
< 			}
---
>       &:hover {
>         color: var(--accent);
>       }
74,77c90,93
< 			> .body {
< 				margin-left: 0.3em;
< 				padding: 8px;
< 				flex: 1;
---
>       > .thumbnail {
>         width: 128px;
>         height: 128px;
>       }
79,84c95,98
< 				@media (max-width: 500px) {
< 					font-size: 14px;
< 				}
< 			}
< 		}
< 	}
---
>       > .body {
>         margin-left: 0.3em;
>         padding: 8px;
>         flex: 1;
86,89c100,105
< 	&.grid {
< 		display: grid;
< 		grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
< 		grid-gap: 12px;
---
>         @media (max-width: 500px) {
>           font-size: 14px;
>         }
>       }
>     }
>   }
91,98c107,111
< 		> .file {
< 			position: relative;
< 			aspect-ratio: 1;
< 		
< 			> .thumbnail {
< 				width: 100%;
< 				height: 100%;
< 			}
---
>   &.grid {
>     display: grid;
>     grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
>     grid-gap: 12px;
>     margin: var(--margin) 0;
100,113c113,135
< 			> .sensitive-label {
< 				position: absolute;
< 				z-index: 10;
< 				top: 8px;
< 				left: 8px;
< 				padding: 2px 4px;
< 				background: #ff0000bf;
< 				color: #fff;
< 				border-radius: 4px;
< 				font-size: 85%;
< 				animation: sensitive-blink 1s infinite;
< 			}
< 		}
< 	}
---
>     > .file {
>       position: relative;
>       aspect-ratio: 1;
> 
>       > .thumbnail {
>         width: 100%;
>         height: 100%;
>       }
> 
>       > .sensitive-label {
>         position: absolute;
>         z-index: 10;
>         top: 8px;
>         left: 8px;
>         padding: 2px 4px;
>         background: #ff0000bf;
>         color: #fff;
>         border-radius: 4px;
>         font-size: 85%;
>         animation: sensitive-blink 1s infinite;
>       }
>     }
>   }
Only in RiricaV13/components: MkFileTypeIcon.vue
Only in misskeyV13/packages/frontend/src/components: MkFlashPreview.vue
Only in misskeyV13/packages/frontend/src/components: MkFoldableSection.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkFolder.vue RiricaV13/components/MkFolder.vue
2,32c2,26
< <div ref="rootEl" :class="[$style.root, { [$style.opened]: opened }]">
< 	<div :class="$style.header" class="_button" @click="toggle">
< 		<span :class="$style.headerIcon"><slot name="icon"></slot></span>
< 		<span :class="$style.headerText"><slot name="label"></slot></span>
< 		<span :class="$style.headerRight">
< 			<span :class="$style.headerRightText"><slot name="suffix"></slot></span>
< 			<i v-if="opened" class="ti ti-chevron-up icon"></i>
< 			<i v-else class="ti ti-chevron-down icon"></i>
< 		</span>
< 	</div>
< 	<div v-if="openedAtLeastOnce" :class="[$style.body, { [$style.bgSame]: bgSame }]" :style="{ maxHeight: maxHeight ? `${maxHeight}px` : null }">
< 		<Transition
< 			:enter-active-class="$store.state.animation ? $style.transition_toggle_enterActive : ''"
< 			:leave-active-class="$store.state.animation ? $style.transition_toggle_leaveActive : ''"
< 			:enter-from-class="$store.state.animation ? $style.transition_toggle_enterFrom : ''"
< 			:leave-to-class="$store.state.animation ? $style.transition_toggle_leaveTo : ''"
< 			@enter="enter"
< 			@after-enter="afterEnter"
< 			@leave="leave"
< 			@after-leave="afterLeave"
< 		>
< 			<KeepAlive>
< 				<div v-show="opened">
< 					<MkSpacer :margin-min="14" :margin-max="22">
< 						<slot></slot>
< 					</MkSpacer>
< 				</div>
< 			</KeepAlive>
< 		</Transition>
< 	</div>
< </div>
---
>   <div v-size="{ max: [500] }" class="ssazuxis">
>     <header
>       class="_button"
>       :style="{ background: bg }"
>       @click="showBody = !showBody"
>     >
>       <div class="title"><slot name="header"></slot></div>
>       <div class="divider"></div>
>       <button class="_button">
>         <template v-if="showBody"><i class="fas fa-angle-up"></i></template>
>         <template v-else><i class="fas fa-angle-down"></i></template>
>       </button>
>     </header>
>     <transition
>       :name="$store.state.animation ? 'folder-toggle' : ''"
>       @enter="enter"
>       @after-enter="afterEnter"
>       @leave="leave"
>       @after-leave="afterLeave"
>     >
>       <div v-show="showBody">
>         <slot></slot>
>       </div>
>     </transition>
>   </div>
35,36c29,31
< <script lang="ts" setup>
< import { nextTick, onMounted } from 'vue';
---
> <script lang="ts">
> import { defineComponent } from "vue";
> import tinycolor from "tinycolor2";
38,44c33
< const props = withDefaults(defineProps<{
< 	defaultOpen: boolean;
< 	maxHeight: number | null;
< }>(), {
< 	defaultOpen: false,
< 	maxHeight: null,
< });
---
> const localStoragePrefix = "ui:folder:";
46,53c35,92
< const getBgColor = (el: HTMLElement) => {
< 	const style = window.getComputedStyle(el);
< 	if (style.backgroundColor && !['rgba(0, 0, 0, 0)', 'rgba(0,0,0,0)', 'transparent'].includes(style.backgroundColor)) {
< 		return style.backgroundColor;
< 	} else {
< 		return el.parentElement ? getBgColor(el.parentElement) : 'transparent';
< 	}
< };
---
> export default defineComponent({
>   props: {
>     expanded: {
>       type: Boolean,
>       required: false,
>       default: true,
>     },
>     persistKey: {
>       type: String,
>       required: false,
>       default: null,
>     },
>   },
>   data() {
>     return {
>       bg: null,
>       showBody:
>         this.persistKey &&
>         localStorage.getItem(localStoragePrefix + this.persistKey)
>           ? localStorage.getItem(localStoragePrefix + this.persistKey) === "t"
>           : this.expanded,
>     };
>   },
>   watch: {
>     showBody() {
>       if (this.persistKey) {
>         localStorage.setItem(
>           localStoragePrefix + this.persistKey,
>           this.showBody ? "t" : "f"
>         );
>       }
>     },
>   },
>   mounted() {
>     function getParentBg(el: Element | null): string {
>       if (el == null || el.tagName === "BODY") return "var(--bg)";
>       const bg = el.style.background || el.style.backgroundColor;
>       if (bg) {
>         return bg;
>       } else {
>         return getParentBg(el.parentElement);
>       }
>     }
>     const rawBg = getParentBg(this.$el);
>     const bg = tinycolor(
>       rawBg.startsWith("var(")
>         ? getComputedStyle(document.documentElement).getPropertyValue(
>             rawBg.slice(4, -1)
>           )
>         : rawBg
>     );
>     bg.setAlpha(0.85);
>     this.bg = bg.toRgbString();
>   },
>   methods: {
>     toggleContent(show: boolean) {
>       this.showBody = show;
>     },
55,96c94,112
< let rootEl = $ref<HTMLElement>();
< let bgSame = $ref(false);
< let opened = $ref(props.defaultOpen);
< let openedAtLeastOnce = $ref(props.defaultOpen);
< 
< function enter(el) {
< 	const elementHeight = el.getBoundingClientRect().height;
< 	el.style.height = 0;
< 	el.offsetHeight; // reflow
< 	el.style.height = Math.min(elementHeight, props.maxHeight ?? Infinity) + 'px';
< }
< 
< function afterEnter(el) {
< 	el.style.height = null;
< }
< 
< function leave(el) {
< 	const elementHeight = el.getBoundingClientRect().height;
< 	el.style.height = elementHeight + 'px';
< 	el.offsetHeight; // reflow
< 	el.style.height = 0;
< }
< 
< function afterLeave(el) {
< 	el.style.height = null;
< }
< 
< function toggle() {
< 	if (!opened) {
< 		openedAtLeastOnce = true;
< 	}
< 
< 	nextTick(() => {
< 		opened = !opened;
< 	});
< }
< 
< onMounted(() => {
< 	const computedStyle = getComputedStyle(document.documentElement);
< 	const parentBg = getBgColor(rootEl.parentElement);
< 	const myBg = computedStyle.getPropertyValue('--panel');
< 	bgSame = parentBg === myBg;
---
>     enter(el) {
>       const elementHeight = el.getBoundingClientRect().height;
>       el.style.height = 0;
>       el.offsetHeight; // reflow
>       el.style.height = elementHeight + "px";
>     },
>     afterEnter(el) {
>       el.style.height = null;
>     },
>     leave(el) {
>       const elementHeight = el.getBoundingClientRect().height;
>       el.style.height = elementHeight + "px";
>       el.offsetHeight; // reflow
>       el.style.height = 0;
>     },
>     afterLeave(el) {
>       el.style.height = null;
>     },
>   },
100,104c116,120
< <style lang="scss" module>
< .transition_toggle_enterActive,
< .transition_toggle_leaveActive {
< 	overflow-y: clip;
< 	transition: opacity 0.3s, height 0.3s, transform 0.3s !important;
---
> <style lang="scss" scoped>
> .folder-toggle-enter-active,
> .folder-toggle-leave-active {
>   overflow-y: hidden;
>   transition: opacity 0.5s, height 0.5s !important;
106,108c122,123
< .transition_toggle_enterFrom,
< .transition_toggle_leaveTo {
< 	opacity: 0;
---
> .folder-toggle-enter-from {
>   opacity: 0;
110,118c125,126
< 
< .root {
< 	display: block;
< 
< 	&.opened {
< 		> .header {
< 			border-radius: 6px 6px 0 0;
< 		}
< 	}
---
> .folder-toggle-leave-to {
>   opacity: 0;
121,129c129,130
< .header {
< 	display: flex;
< 	align-items: center;
< 	width: 100%;
< 	box-sizing: border-box;
< 	padding: 9px 12px 9px 12px;
< 	background: var(--buttonBg);
< 	border-radius: 6px;
< 	transition: border-radius 0.3s;
---
> .ssazuxis {
>   position: relative;
131,134c132,140
< 	&:hover {
< 		text-decoration: none;
< 		background: var(--buttonHoverBg);
< 	}
---
>   > header {
>     display: flex;
>     position: relative;
>     z-index: 10;
>     position: sticky;
>     top: var(--stickyTop, 0px);
>     padding: var(--x-padding);
>     -webkit-backdrop-filter: var(--blur, blur(8px));
>     backdrop-filter: var(--blur, blur(20px));
136,140c142,144
< 	&.active {
< 		color: var(--accent);
< 		background: var(--buttonHoverBg);
< 	}
< }
---
>     > .title {
>       margin: 0;
>       padding: 12px 16px 12px 0;
142,146c146,148
< .headerIcon {
< 	margin-right: 0.75em;
< 	flex-shrink: 0;
< 	text-align: center;
< 	opacity: 0.8;
---
>       > i {
>         margin-right: 6px;
>       }
148,149c150,153
< 	&:empty {
< 		display: none;
---
>       &:empty {
>         display: none;
>       }
>     }
151,155c155,160
< 		& + .headerText {
< 			padding-left: 4px;
< 		}
< 	}
< }
---
>     > .divider {
>       flex: 1;
>       margin: auto;
>       height: 1px;
>       background: var(--divider);
>     }
157,162c162,165
< .headerText {
< 	white-space: nowrap;
< 	text-overflow: ellipsis;
< 	overflow: hidden;
< 	padding-right: 12px;
< }
---
>     > button {
>       padding: 12px 0 12px 16px;
>     }
>   }
164,182c167,173
< .headerRight {
< 	margin-left: auto;
< 	opacity: 0.7;
< 	white-space: nowrap;
< }
< 
< .headerRightText:not(:empty) {
< 	margin-right: 0.75em;
< }
< 
< .body {
< 	background: var(--panel);
< 	border-radius: 0 0 6px 6px;
< 	container-type: inline-size;
< 	overflow: auto;
< 
< 	&.bgSame {
< 		background: var(--bg);
< 	}
---
>   &.max-width_500px {
>     > header {
>       > .title {
>         padding: 8px 10px 8px 0;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkFollowButton.vue RiricaV13/components/MkFollowButton.vue
2,29c2,40
< <button
< 	class="kpoogebi _button"
< 	:class="{ wait, active: isFollowing || hasPendingFollowRequestFromYou, full, large }"
< 	:disabled="wait"
< 	@click="onClick"
< >
< 	<template v-if="!wait">
< 		<template v-if="hasPendingFollowRequestFromYou && user.isLocked">
< 			<span v-if="full">{{ i18n.ts.followRequestPending }}</span><i class="ti ti-hourglass-empty"></i>
< 		</template>
< 		<template v-else-if="hasPendingFollowRequestFromYou && !user.isLocked">
< 			<!-- つまりリモートフォローの場合。 -->
< 			<span v-if="full">{{ i18n.ts.processing }}</span><MkLoading :em="true" :colored="false"/>
< 		</template>
< 		<template v-else-if="isFollowing">
< 			<span v-if="full">{{ i18n.ts.unfollow }}</span><i class="ti ti-minus"></i>
< 		</template>
< 		<template v-else-if="!isFollowing && user.isLocked">
< 			<span v-if="full">{{ i18n.ts.followRequest }}</span><i class="ti ti-plus"></i>
< 		</template>
< 		<template v-else-if="!isFollowing && !user.isLocked">
< 			<span v-if="full">{{ i18n.ts.follow }}</span><i class="ti ti-plus"></i>
< 		</template>
< 	</template>
< 	<template v-else>
< 		<span v-if="full">{{ i18n.ts.processing }}</span><MkLoading :em="true" :colored="false"/>
< 	</template>
< </button>
---
>   <button
>     class="kpoogebi _button"
>     :class="{
>       wait,
>       active: isFollowing || hasPendingFollowRequestFromYou,
>       full,
>       large,
>     }"
>     :disabled="wait"
>     @click="onClick"
>   >
>     <template v-if="!wait">
>       <template v-if="hasPendingFollowRequestFromYou && user.isLocked">
>         <span v-if="full">{{ i18n.ts.followRequestPending }}</span
>         ><i class="fas fa-hourglass-half"></i>
>       </template>
>       <template v-else-if="hasPendingFollowRequestFromYou && !user.isLocked">
>         <!-- つまりリモートフォローの場合。 -->
>         <span v-if="full">{{ i18n.ts.processing }}</span
>         ><i class="fas fa-spinner fa-pulse"></i>
>       </template>
>       <template v-else-if="isFollowing">
>         <span v-if="full">{{ i18n.ts.unfollow }}</span
>         ><i class="fas fa-minus"></i>
>       </template>
>       <template v-else-if="!isFollowing && user.isLocked">
>         <span v-if="full">{{ i18n.ts.followRequest }}</span
>         ><i class="fas fa-plus"></i>
>       </template>
>       <template v-else-if="!isFollowing && !user.isLocked">
>         <span v-if="full">{{ i18n.ts.follow }}</span
>         ><i class="fas fa-plus"></i>
>       </template>
>     </template>
>     <template v-else>
>       <span v-if="full">{{ i18n.ts.processing }}</span
>       ><i class="fas fa-spinner fa-pulse fa-fw"></i>
>     </template>
>   </button>
33,39c44,48
< import { onBeforeUnmount, onMounted } from 'vue';
< import * as Misskey from 'misskey-js';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
< import { claimAchievement } from '@/scripts/achievements';
< import { $i } from '@/account';
---
> import { onBeforeUnmount, onMounted } from "vue";
> import * as Misskey from "misskey-js";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
41,48c50,60
< const props = withDefaults(defineProps<{
< 	user: Misskey.entities.UserDetailed,
< 	full?: boolean,
< 	large?: boolean,
< }>(), {
< 	full: false,
< 	large: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: Misskey.entities.UserDetailed;
>     full?: boolean;
>     large?: boolean;
>   }>(),
>   {
>     full: false,
>     large: false,
>   }
> );
51c63,65
< let hasPendingFollowRequestFromYou = $ref(props.user.hasPendingFollowRequestFromYou);
---
> let hasPendingFollowRequestFromYou = $ref(
>   props.user.hasPendingFollowRequestFromYou
> );
53c67
< const connection = stream.useChannel('main');
---
> const connection = stream.useChannel("main");
56,59c70,72
< 	os.api('users/show', {
< 		userId: props.user.id,
< 	})
< 		.then(onFollowChange);
---
>   os.api("users/show", {
>     userId: props.user.id,
>   }).then(onFollowChange);
63,66c76,79
< 	if (user.id === props.user.id) {
< 		isFollowing = user.isFollowing;
< 		hasPendingFollowRequestFromYou = user.hasPendingFollowRequestFromYou;
< 	}
---
>   if (user.id === props.user.id) {
>     isFollowing = user.isFollowing;
>     hasPendingFollowRequestFromYou = user.hasPendingFollowRequestFromYou;
>   }
70c83
< 	wait = true;
---
>   wait = true;
72,77c85,92
< 	try {
< 		if (isFollowing) {
< 			const { canceled } = await os.confirm({
< 				type: 'warning',
< 				text: i18n.t('unfollowConfirm', { name: props.user.name || props.user.username }),
< 			});
---
>   try {
>     if (isFollowing) {
>       const { canceled } = await os.confirm({
>         type: "warning",
>         text: i18n.t("unfollowConfirm", {
>           name: props.user.name || props.user.username,
>         }),
>       });
79c94
< 			if (canceled) return;
---
>       if (canceled) return;
81,116c96,116
< 			await os.api('following/delete', {
< 				userId: props.user.id,
< 			});
< 		} else {
< 			if (hasPendingFollowRequestFromYou) {
< 				await os.api('following/requests/cancel', {
< 					userId: props.user.id,
< 				});
< 				hasPendingFollowRequestFromYou = false;
< 			} else {
< 				await os.api('following/create', {
< 					userId: props.user.id,
< 				});
< 				hasPendingFollowRequestFromYou = true;
< 
< 				claimAchievement('following1');
< 
< 				if ($i.followingCount >= 10) {
< 					claimAchievement('following10');
< 				}
< 				if ($i.followingCount >= 50) {
< 					claimAchievement('following50');
< 				}
< 				if ($i.followingCount >= 100) {
< 					claimAchievement('following100');
< 				}
< 				if ($i.followingCount >= 300) {
< 					claimAchievement('following300');
< 				}
< 			}
< 		}
< 	} catch (err) {
< 		console.error(err);
< 	} finally {
< 		wait = false;
< 	}
---
>       await os.api("following/delete", {
>         userId: props.user.id,
>       });
>     } else {
>       if (hasPendingFollowRequestFromYou) {
>         await os.api("following/requests/cancel", {
>           userId: props.user.id,
>         });
>         hasPendingFollowRequestFromYou = false;
>       } else {
>         await os.api("following/create", {
>           userId: props.user.id,
>         });
>         hasPendingFollowRequestFromYou = true;
>       }
>     }
>   } catch (err) {
>     console.error(err);
>   } finally {
>     wait = false;
>   }
120,121c120,121
< 	connection.on('follow', onFollowChange);
< 	connection.on('unfollow', onFollowChange);
---
>   connection.on("follow", onFollowChange);
>   connection.on("unfollow", onFollowChange);
125c125
< 	connection.dispose();
---
>   connection.dispose();
131,141c131,141
< 	position: relative;
< 	display: inline-block;
< 	font-weight: bold;
< 	color: var(--accent);
< 	background: transparent;
< 	border: solid 1px var(--accent);
< 	padding: 0;
< 	height: 31px;
< 	font-size: 16px;
< 	border-radius: 32px;
< 	background: #fff;
---
>   position: relative;
>   display: inline-block;
>   font-weight: bold;
>   color: var(--accent);
>   background: transparent;
>   border: solid 1px var(--accent);
>   padding: 0;
>   height: 31px;
>   font-size: 16px;
>   border-radius: 32px;
>   background: #fff;
143,146c143,146
< 	&.full {
< 		padding: 0 8px 0 12px;
< 		font-size: 14px;
< 	}
---
>   &.full {
>     padding: 0 8px 0 12px;
>     font-size: 14px;
>   }
148,152c148,152
< 	&.large {
< 		font-size: 16px;
< 		height: 38px;
< 		padding: 0 12px 0 16px;
< 	}
---
>   &.large {
>     font-size: 16px;
>     height: 38px;
>     padding: 0 12px 0 16px;
>   }
154,156c154,156
< 	&:not(.full) {
< 		width: 31px;
< 	}
---
>   &:not(.full) {
>     width: 31px;
>   }
158,170c158,170
< 	&:focus-visible {
< 		&:after {
< 			content: "";
< 			pointer-events: none;
< 			position: absolute;
< 			top: -5px;
< 			right: -5px;
< 			bottom: -5px;
< 			left: -5px;
< 			border: 2px solid var(--focus);
< 			border-radius: 32px;
< 		}
< 	}
---
>   &:focus-visible {
>     &:after {
>       content: "";
>       pointer-events: none;
>       position: absolute;
>       top: -5px;
>       right: -5px;
>       bottom: -5px;
>       left: -5px;
>       border: 2px solid var(--focus);
>       border-radius: 32px;
>     }
>   }
172,174c172,174
< 	&:hover {
< 		//background: mix($primary, #fff, 20);
< 	}
---
>   &:hover {
>     //background: mix($primary, #fff, 20);
>   }
176,178c176,178
< 	&:active {
< 		//background: mix($primary, #fff, 40);
< 	}
---
>   &:active {
>     //background: mix($primary, #fff, 40);
>   }
180,182c180,182
< 	&.active {
< 		color: #fff;
< 		background: var(--accent);
---
>   &.active {
>     color: #fff;
>     background: var(--accent);
184,187c184,187
< 		&:hover {
< 			background: var(--accentLighten);
< 			border-color: var(--accentLighten);
< 		}
---
>     &:hover {
>       background: var(--accentLighten);
>       border-color: var(--accentLighten);
>     }
189,193c189,193
< 		&:active {
< 			background: var(--accentDarken);
< 			border-color: var(--accentDarken);
< 		}
< 	}
---
>     &:active {
>       background: var(--accentDarken);
>       border-color: var(--accentDarken);
>     }
>   }
195,198c195,198
< 	&.wait {
< 		cursor: wait !important;
< 		opacity: 0.7;
< 	}
---
>   &.wait {
>     cursor: wait !important;
>     opacity: 0.7;
>   }
200,202c200,202
< 	> span {
< 		margin-right: 6px;
< 	}
---
>   > span {
>     margin-right: 6px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkForgotPassword.vue RiricaV13/components/MkForgotPassword.vue
2,9c2,9
< <MkModalWindow
< 	ref="dialog"
< 	:width="370"
< 	:height="400"
< 	@close="dialog.close()"
< 	@closed="emit('closed')"
< >
< 	<template #header>{{ i18n.ts.forgotPassword }}</template>
---
>   <XModalWindow
>     ref="dialog"
>     :width="370"
>     :height="400"
>     @close="dialog.close()"
>     @closed="emit('closed')"
>   >
>     <template #header>{{ i18n.ts.forgotPassword }}</template>
11,16c11,28
< 	<form v-if="instance.enableEmail" class="bafeceda" @submit.prevent="onSubmit">
< 		<div class="main _gaps_m">
< 			<MkInput v-model="username" type="text" pattern="^[a-zA-Z0-9_]+$" :spellcheck="false" autofocus required>
< 				<template #label>{{ i18n.ts.username }}</template>
< 				<template #prefix>@</template>
< 			</MkInput>
---
>     <form
>       v-if="instance.enableEmail"
>       class="bafeceda"
>       @submit.prevent="onSubmit"
>     >
>       <div class="main _formRoot">
>         <MkInput
>           v-model="username"
>           class="_formBlock"
>           type="text"
>           pattern="^[a-zA-Z0-9_]+$"
>           :spellcheck="false"
>           autofocus
>           required
>         >
>           <template #label>{{ i18n.ts.username }}</template>
>           <template #prefix>@</template>
>         </MkInput>
18,21c30,39
< 			<MkInput v-model="email" type="email" :spellcheck="false" required>
< 				<template #label>{{ i18n.ts.emailAddress }}</template>
< 				<template #caption>{{ i18n.ts._forgotPassword.enterEmail }}</template>
< 			</MkInput>
---
>         <MkInput
>           v-model="email"
>           class="_formBlock"
>           type="email"
>           :spellcheck="false"
>           required
>         >
>           <template #label>{{ i18n.ts.emailAddress }}</template>
>           <template #caption>{{ i18n.ts._forgotPassword.enterEmail }}</template>
>         </MkInput>
23,32c41,59
< 			<MkButton type="submit" :disabled="processing" primary style="margin: 0 auto;">{{ i18n.ts.send }}</MkButton>
< 		</div>
< 		<div class="sub">
< 			<MkA to="/about" class="_link">{{ i18n.ts._forgotPassword.ifNoEmail }}</MkA>
< 		</div>
< 	</form>
< 	<div v-else class="bafecedb">
< 		{{ i18n.ts._forgotPassword.contactAdmin }}
< 	</div>
< </MkModalWindow>
---
>         <MkButton
>           class="_formBlock"
>           type="submit"
>           :disabled="processing"
>           primary
>           style="margin: 0 auto"
>           >{{ i18n.ts.send }}</MkButton
>         >
>       </div>
>       <div class="sub">
>         <MkA to="/about" class="_link">{{
>           i18n.ts._forgotPassword.ifNoEmail
>         }}</MkA>
>       </div>
>     </form>
>     <div v-else class="bafecedb">
>       {{ i18n.ts._forgotPassword.contactAdmin }}
>     </div>
>   </XModalWindow>
36,42c63,69
< import { } from 'vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import * as os from '@/os';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import * as os from "@/os";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
45,46c72,73
< 	(ev: 'done'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "done"): void;
>   (ev: "closed"): void;
49c76
< let dialog: InstanceType<typeof MkModalWindow> = $ref();
---
> let dialog: InstanceType<typeof XModalWindow> = $ref();
51,52c78,79
< let username = $ref('');
< let email = $ref('');
---
> let username = $ref("");
> let email = $ref("");
56,62c83,89
< 	processing = true;
< 	await os.apiWithDialog('request-reset-password', {
< 		username,
< 		email,
< 	});
< 	emit('done');
< 	dialog.close();
---
>   processing = true;
>   await os.apiWithDialog("request-reset-password", {
>     username,
>     email,
>   });
>   emit("done");
>   dialog.close();
68,70c95,97
< 	> .main {
< 		padding: 24px;
< 	}
---
>   > .main {
>     padding: 24px;
>   }
72,75c99,102
< 	> .sub {
< 		border-top: solid 0.5px var(--divider);
< 		padding: 24px;
< 	}
---
>   > .sub {
>     border-top: solid 0.5px var(--divider);
>     padding: 24px;
>   }
79c106
< 	padding: 24px;
---
>   padding: 24px;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkFormDialog.vue RiricaV13/components/MkFormDialog.vue
2,15c2,15
< <MkModalWindow
< 	ref="dialog"
< 	:width="450"
< 	:can-close="false"
< 	:with-ok-button="true"
< 	:ok-button-disabled="false"
< 	@click="cancel()"
< 	@ok="ok()"
< 	@close="cancel()"
< 	@closed="$emit('closed')"
< >
< 	<template #header>
< 		{{ title }}
< 	</template>
---
>   <XModalWindow
>     ref="dialog"
>     :width="450"
>     :can-close="false"
>     :with-ok-button="true"
>     :ok-button-disabled="false"
>     @click="cancel()"
>     @ok="ok()"
>     @close="cancel()"
>     @closed="$emit('closed')"
>   >
>     <template #header>
>       {{ title }}
>     </template>
17,54c17,147
< 	<MkSpacer :margin-min="20" :margin-max="32">
< 		<div class="_gaps_m">
< 			<template v-for="item in Object.keys(form).filter(item => !form[item].hidden)">
< 				<MkInput v-if="form[item].type === 'number'" v-model="values[item]" type="number" :step="form[item].step || 1">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<template v-if="form[item].description" #caption>{{ form[item].description }}</template>
< 				</MkInput>
< 				<MkInput v-else-if="form[item].type === 'string' && !form[item].multiline" v-model="values[item]" type="text">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<template v-if="form[item].description" #caption>{{ form[item].description }}</template>
< 				</MkInput>
< 				<MkTextarea v-else-if="form[item].type === 'string' && form[item].multiline" v-model="values[item]">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<template v-if="form[item].description" #caption>{{ form[item].description }}</template>
< 				</MkTextarea>
< 				<MkSwitch v-else-if="form[item].type === 'boolean'" v-model="values[item]">
< 					<span v-text="form[item].label || item"></span>
< 					<template v-if="form[item].description" #caption>{{ form[item].description }}</template>
< 				</MkSwitch>
< 				<MkSelect v-else-if="form[item].type === 'enum'" v-model="values[item]">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<option v-for="item in form[item].enum" :key="item.value" :value="item.value">{{ item.label }}</option>
< 				</MkSelect>
< 				<MkRadios v-else-if="form[item].type === 'radio'" v-model="values[item]">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<option v-for="item in form[item].options" :key="item.value" :value="item.value">{{ item.label }}</option>
< 				</MkRadios>
< 				<MkRange v-else-if="form[item].type === 'range'" v-model="values[item]" :min="form[item].min" :max="form[item].max" :step="form[item].step" :text-converter="form[item].textConverter">
< 					<template #label><span v-text="form[item].label || item"></span><span v-if="form[item].required === false"> ({{ $ts.optional }})</span></template>
< 					<template v-if="form[item].description" #caption>{{ form[item].description }}</template>
< 				</MkRange>
< 				<MkButton v-else-if="form[item].type === 'button'" @click="form[item].action($event, values)">
< 					<span v-text="form[item].content || item"></span>
< 				</MkButton>
< 			</template>
< 		</div>
< 	</MkSpacer>
< </MkModalWindow>
---
>     <MkSpacer :margin-min="20" :margin-max="32">
>       <div class="xkpnjxcv _formRoot">
>         <template
>           v-for="item in Object.keys(form).filter((item) => !form[item].hidden)"
>         >
>           <FormInput
>             v-if="form[item].type === 'number'"
>             v-model="values[item]"
>             type="number"
>             :step="form[item].step || 1"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <template v-if="form[item].description" #caption>{{
>               form[item].description
>             }}</template>
>           </FormInput>
>           <FormInput
>             v-else-if="form[item].type === 'string' && !form[item].multiline"
>             v-model="values[item]"
>             type="text"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <template v-if="form[item].description" #caption>{{
>               form[item].description
>             }}</template>
>           </FormInput>
>           <FormTextarea
>             v-else-if="form[item].type === 'string' && form[item].multiline"
>             v-model="values[item]"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <template v-if="form[item].description" #caption>{{
>               form[item].description
>             }}</template>
>           </FormTextarea>
>           <FormSwitch
>             v-else-if="form[item].type === 'boolean'"
>             v-model="values[item]"
>             class="_formBlock"
>           >
>             <span v-text="form[item].label || item"></span>
>             <template v-if="form[item].description" #caption>{{
>               form[item].description
>             }}</template>
>           </FormSwitch>
>           <FormSelect
>             v-else-if="form[item].type === 'enum'"
>             v-model="values[item]"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <option
>               v-for="item in form[item].enum"
>               :key="item.value"
>               :value="item.value"
>             >
>               {{ item.label }}
>             </option>
>           </FormSelect>
>           <FormRadios
>             v-else-if="form[item].type === 'radio'"
>             v-model="values[item]"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <option
>               v-for="item in form[item].options"
>               :key="item.value"
>               :value="item.value"
>             >
>               {{ item.label }}
>             </option>
>           </FormRadios>
>           <FormRange
>             v-else-if="form[item].type === 'range'"
>             v-model="values[item]"
>             :min="form[item].min"
>             :max="form[item].max"
>             :step="form[item].step"
>             :text-converter="form[item].textConverter"
>             class="_formBlock"
>           >
>             <template #label
>               ><span v-text="form[item].label || item"></span
>               ><span v-if="form[item].required === false">
>                 ({{ $ts.optional }})</span
>               ></template
>             >
>             <template v-if="form[item].description" #caption>{{
>               form[item].description
>             }}</template>
>           </FormRange>
>           <MkButton
>             v-else-if="form[item].type === 'button'"
>             class="_formBlock"
>             @click="form[item].action($event, values)"
>           >
>             <span v-text="form[item].content || item"></span>
>           </MkButton>
>         </template>
>       </div>
>     </MkSpacer>
>   </XModalWindow>
58,66c151,159
< import { defineComponent } from 'vue';
< import MkInput from './MkInput.vue';
< import MkTextarea from './MkTextarea.vue';
< import MkSwitch from './MkSwitch.vue';
< import MkSelect from './MkSelect.vue';
< import MkRange from './MkRange.vue';
< import MkButton from './MkButton.vue';
< import MkRadios from './MkRadios.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
---
> import { defineComponent } from "vue";
> import FormInput from "./form/input.vue";
> import FormTextarea from "./form/textarea.vue";
> import FormSwitch from "./form/switch.vue";
> import FormSelect from "./form/select.vue";
> import FormRange from "./form/range.vue";
> import MkButton from "./MkButton.vue";
> import FormRadios from "./form/radios.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
69,78c162,171
< 	components: {
< 		MkModalWindow,
< 		MkInput,
< 		MkTextarea,
< 		MkSwitch,
< 		MkSelect,
< 		MkRange,
< 		MkButton,
< 		MkRadios,
< 	},
---
>   components: {
>     XModalWindow,
>     FormInput,
>     FormTextarea,
>     FormSwitch,
>     FormSelect,
>     FormRange,
>     MkButton,
>     FormRadios,
>   },
80,89c173,182
< 	props: {
< 		title: {
< 			type: String,
< 			required: true,
< 		},
< 		form: {
< 			type: Object,
< 			required: true,
< 		},
< 	},
---
>   props: {
>     title: {
>       type: String,
>       required: true,
>     },
>     form: {
>       type: Object,
>       required: true,
>     },
>   },
91c184
< 	emits: ['done'],
---
>   emits: ["done"],
93,97c186,190
< 	data() {
< 		return {
< 			values: {},
< 		};
< 	},
---
>   data() {
>     return {
>       values: {},
>     };
>   },
99,103c192,196
< 	created() {
< 		for (const item in this.form) {
< 			this.values[item] = this.form[item].default ?? null;
< 		}
< 	},
---
>   created() {
>     for (const item in this.form) {
>       this.values[item] = this.form[item].default ?? null;
>     }
>   },
105,111c198,204
< 	methods: {
< 		ok() {
< 			this.$emit('done', {
< 				result: this.values,
< 			});
< 			this.$refs.dialog.close();
< 		},
---
>   methods: {
>     ok() {
>       this.$emit("done", {
>         result: this.values,
>       });
>       this.$refs.dialog.close();
>     },
113,119c206,212
< 		cancel() {
< 			this.$emit('done', {
< 				canceled: true,
< 			});
< 			this.$refs.dialog.close();
< 		},
< 	},
---
>     cancel() {
>       this.$emit("done", {
>         canceled: true,
>       });
>       this.$refs.dialog.close();
>     },
>   },
121a215,219
> 
> <style lang="scss" scoped>
> .xkpnjxcv {
> }
> </style>
Only in RiricaV13/components: MkFormula.vue
Only in RiricaV13/components: MkFormulaCore.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkGalleryPostPreview.vue RiricaV13/components/MkGalleryPostPreview.vue
2,14c2,18
< <MkA :to="`/gallery/${post.id}`" class="ttasepnz _panel" tabindex="-1">
< 	<div class="thumbnail">
< 		<ImgWithBlurhash class="img" :src="post.files[0].thumbnailUrl" :hash="post.files[0].blurhash"/>
< 	</div>
< 	<article>
< 		<header>
< 			<MkAvatar :user="post.user" class="avatar" link preview/>
< 		</header>
< 		<footer>
< 			<span class="title">{{ post.title }}</span>
< 		</footer>
< 	</article>
< </MkA>
---
>   <MkA :to="`/gallery/${post.id}`" class="ttasepnz _panel" tabindex="-1">
>     <div class="thumbnail">
>       <ImgWithBlurhash
>         class="img"
>         :src="post.files[0].thumbnailUrl"
>         :hash="post.files[0].blurhash"
>       />
>     </div>
>     <article>
>       <header>
>         <MkAvatar :user="post.user" class="avatar" />
>       </header>
>       <footer>
>         <span class="title">{{ post.title }}</span>
>       </footer>
>     </article>
>   </MkA>
18,21c22,25
< import { } from 'vue';
< import { userName } from '@/filters/user';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
< import * as os from '@/os';
---
> import {} from "vue";
> import { userName } from "@/filters/user";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
> import * as os from "@/os";
24c28
< 	post: any;
---
>   post: any;
30,32c34,36
< 	display: block;
< 	position: relative;
< 	height: 200px;
---
>   display: block;
>   position: relative;
>   height: 200px;
34,36c38,40
< 	&:hover {
< 		text-decoration: none;
< 		color: var(--accent);
---
>   &:hover {
>     text-decoration: none;
>     color: var(--accent);
38,40c42,44
< 		> .thumbnail {
< 			transform: scale(1.1);
< 		}
---
>     > .thumbnail {
>       transform: scale(1.1);
>     }
42,49c46,53
< 		> article {
< 			> footer {
< 				&:before {
< 					opacity: 1;
< 				}
< 			}
< 		}
< 	}
---
>     > article {
>       > footer {
>         &:before {
>           opacity: 1;
>         }
>       }
>     }
>   }
51,55c55,59
< 	> .thumbnail {
< 		width: 100%;
< 		height: 100%;
< 		position: absolute;
< 		transition: all 0.5s ease;
---
>   > .thumbnail {
>     width: 100%;
>     height: 100%;
>     position: absolute;
>     transition: all 0.5s ease;
57,62c61,66
< 		> .img {
< 			width: 100%;
< 			height: 100%;
< 			object-fit: cover;
< 		}
< 	}
---
>     > .img {
>       width: 100%;
>       height: 100%;
>       object-fit: cover;
>     }
>   }
64,68c68,72
< 	> article {
< 		position: absolute;
< 		z-index: 1;
< 		width: 100%;
< 		height: 100%;
---
>   > article {
>     position: absolute;
>     z-index: 1;
>     width: 100%;
>     height: 100%;
70,76c74,80
< 		> header {
< 			position: absolute;
< 			top: 0;
< 			width: 100%;
< 			padding: 12px;
< 			box-sizing: border-box;
< 			display: flex;
---
>     > header {
>       position: absolute;
>       top: 0;
>       width: 100%;
>       padding: 12px;
>       box-sizing: border-box;
>       display: flex;
78,83c82,87
< 			> .avatar {
< 				margin-left: auto;
< 				width: 32px;
< 				height: 32px;
< 			}
< 		}
---
>       > .avatar {
>         margin-left: auto;
>         width: 32px;
>         height: 32px;
>       }
>     }
85,93c89,97
< 		> footer {
< 			position: absolute;
< 			bottom: 0;
< 			width: 100%;
< 			padding: 16px;
< 			box-sizing: border-box;
< 			color: #fff;
< 			text-shadow: 0 0 8px #000;
< 			background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
---
>     > footer {
>       position: absolute;
>       bottom: 0;
>       width: 100%;
>       padding: 16px;
>       box-sizing: border-box;
>       color: #fff;
>       text-shadow: 0 0 8px #000;
>       background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
95,107c99,111
< 			&:before {
< 				content: "";
< 				display: block;
< 				position: absolute;
< 				z-index: -1;
< 				top: 0;
< 				left: 0;
< 				width: 100%;
< 				height: 100%;
< 				background: linear-gradient(rgba(0, 0, 0, 0.4), transparent);
< 				opacity: 0;
< 				transition: opacity 0.5s ease;
< 			}
---
>       &:before {
>         content: "";
>         display: block;
>         position: absolute;
>         z-index: -1;
>         top: 0;
>         left: 0;
>         width: 100%;
>         height: 100%;
>         background: linear-gradient(rgba(0, 0, 0, 0.4), transparent);
>         opacity: 0;
>         transition: opacity 0.5s ease;
>       }
109,113c113,117
< 			> .title {
< 				font-weight: bold;
< 			}
< 		}
< 	}
---
>       > .title {
>         font-weight: bold;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkGoogle.vue RiricaV13/components/MkGoogle.vue
2,5c2,7
< <div :class="$style.root">
< 	<input v-model="query" :class="$style.input" type="search" :placeholder="q">
< 	<button :class="$style.button" @click="search"><i class="ti ti-search"></i> {{ $ts.searchByGoogle }}</button>
< </div>
---
>   <div class="mk-google">
>     <input v-model="query" type="search" :placeholder="q" />
>     <button @click="search">
>       <i class="fas fa-search"></i> {{ $ts.searchByGoogle }}
>     </button>
>   </div>
9c11
< import { ref } from 'vue';
---
> import { ref } from "vue";
12c14
< 	q: string;
---
>   q: string;
18c20
< 	window.open(`https://www.google.com/search?q=${query.value}`, '_blank');
---
>   window.open(`https://www.google.com/search?q=${query.value}`, "_blank");
22,26c24,27
< <style lang="scss" module>
< .root {
< 	display: flex;
< 	margin: 8px 0;
< }
---
> <style lang="scss" scoped>
> .mk-google {
>   display: flex;
>   margin: 8px 0;
28,37c29,38
< .input {
< 	flex-shrink: 1;
< 	padding: 10px;
< 	width: 100%;
< 	height: 40px;
< 	font-size: 16px;
< 	border: solid 1px var(--divider);
< 	border-radius: 4px 0 0 4px;
< 	-webkit-appearance: textfield;
< }
---
>   > input {
>     flex-shrink: 1;
>     padding: 10px;
>     width: 100%;
>     height: 40px;
>     font-size: 16px;
>     border: solid 1px var(--divider);
>     border-radius: 4px 0 0 4px;
>     -webkit-appearance: textfield;
>   }
39,45c40,46
< .button {
< 	flex-shrink: 0;
< 	margin: 0;
< 	padding: 0 16px;
< 	border: solid 1px var(--divider);
< 	border-left: none;
< 	border-radius: 0 4px 4px 0;
---
>   > button {
>     flex-shrink: 0;
>     margin: 0;
>     padding: 0 16px;
>     border: solid 1px var(--divider);
>     border-left: none;
>     border-radius: 0 4px 4px 0;
47,49c48,51
< 	&:active {
< 		box-shadow: 0 2px 4px rgba(#000, 0.15) inset;
< 	}
---
>     &:active {
>       box-shadow: 0 2px 4px rgba(#000, 0.15) inset;
>     }
>   }
Only in misskeyV13/packages/frontend/src/components: MkHeatmap.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkImageViewer.vue RiricaV13/components/MkImageViewer.vue
2,12c2,25
< <MkModal ref="modal" :z-priority="'middle'" @click="modal.close()" @closed="emit('closed')">
< 	<div class="xubzgfga">
< 		<header>{{ image.name }}</header>
< 		<img :src="image.url" :alt="image.comment" :title="image.comment" @click="modal.close()"/>
< 		<footer>
< 			<span>{{ image.type }}</span>
< 			<span>{{ bytes(image.size) }}</span>
< 			<span v-if="image.properties && image.properties.width">{{ number(image.properties.width) }}px × {{ number(image.properties.height) }}px</span>
< 		</footer>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :z-priority="'middle'"
>     @click="modal.close()"
>     @closed="emit('closed')"
>   >
>     <div class="xubzgfga">
>       <header>{{ image.name }}</header>
>       <img
>         :src="image.url"
>         :alt="image.comment"
>         :title="image.comment"
>         @click="modal.close()"
>       />
>       <footer>
>         <span>{{ image.type }}</span>
>         <span>{{ bytes(image.size) }}</span>
>         <span v-if="image.properties && image.properties.width"
>           >{{ number(image.properties.width) }}px ×
>           {{ number(image.properties.height) }}px</span
>         >
>       </footer>
>     </div>
>   </MkModal>
16,20c29,33
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import bytes from '@/filters/bytes';
< import number from '@/filters/number';
< import MkModal from '@/components/MkModal.vue';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import bytes from "@/filters/bytes";
> import number from "@/filters/number";
> import MkModal from "@/components/MkModal.vue";
22,25c35,40
< const props = withDefaults(defineProps<{
< 	image: misskey.entities.DriveFile;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     image: misskey.entities.DriveFile;
>   }>(),
>   {}
> );
28c43
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
31c46
< const modal = $shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = $ref<InstanceType<typeof MkModal>>();
36,39c51,53
< 	margin: auto;
< 	display: flex;
< 	flex-direction: column;
< 	height: 100%;
---
>   display: flex;
>   flex-direction: column;
>   height: 100%;
41,50c55,64
< 	> header,
< 	> footer {
< 		align-self: center;
< 		display: inline-block;
< 		padding: 6px 9px;
< 		font-size: 90%;
< 		background: rgba(0, 0, 0, 0.5);
< 		border-radius: 6px;
< 		color: #fff;
< 	}
---
>   > header,
>   > footer {
>     align-self: center;
>     display: inline-block;
>     padding: 6px 9px;
>     font-size: 90%;
>     background: rgba(0, 0, 0, 0.5);
>     border-radius: 6px;
>     color: #fff;
>   }
52,55c66,69
< 	> header {
< 		margin-bottom: 8px;
< 		opacity: 0.9;
< 	}
---
>   > header {
>     margin-bottom: 8px;
>     opacity: 0.9;
>   }
57,65c71,79
< 	> img {
< 		display: block;
< 		flex: 1;
< 		min-height: 0;
< 		object-fit: contain;
< 		width: 100%;
< 		cursor: zoom-out;
< 		image-orientation: from-image;
< 	}
---
>   > img {
>     display: block;
>     flex: 1;
>     min-height: 0;
>     object-fit: contain;
>     width: 100%;
>     cursor: zoom-out;
>     image-orientation: from-image;
>   }
67,69c81,83
< 	> footer {
< 		margin-top: 8px;
< 		opacity: 0.8;
---
>   > footer {
>     margin-top: 8px;
>     opacity: 0.8;
71,76c85,90
< 		> span + span {
< 			margin-left: 0.5em;
< 			padding-left: 0.5em;
< 			border-left: solid 1px rgba(255, 255, 255, 0.5);
< 		}
< 	}
---
>     > span + span {
>       margin-left: 0.5em;
>       padding-left: 0.5em;
>       border-left: solid 1px rgba(255, 255, 255, 0.5);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkImgWithBlurhash.vue RiricaV13/components/MkImgWithBlurhash.vue
2,5c2,11
< <div :class="[$style.root, { [$style.cover]: cover }]" :title="title">
< 	<canvas v-if="!loaded" ref="canvas" :class="$style.canvas" :width="size" :height="size" :title="title"/>
< 	<img v-if="src" :class="$style.img" :src="src" :title="title" :alt="alt" @load="onLoad"/>
< </div>
---
>   <div class="xubzgfgb" :class="{ cover }" :title="title">
>     <canvas
>       v-if="!loaded"
>       ref="canvas"
>       :width="size"
>       :height="size"
>       :title="title"
>     />
>     <img v-if="src" :src="src" :title="title" :alt="alt" @load="onLoad" />
>   </div>
9,10c15,16
< import { onMounted } from 'vue';
< import { decode } from 'blurhash';
---
> import { onMounted } from "vue";
> import { decode } from "blurhash";
12,25c18,34
< const props = withDefaults(defineProps<{
< 	src?: string | null;
< 	hash?: string;
< 	alt?: string;
< 	title?: string | null;
< 	size?: number;
< 	cover?: boolean;
< }>(), {
< 	src: null,
< 	alt: '',
< 	title: null,
< 	size: 64,
< 	cover: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     src?: string | null;
>     hash?: string;
>     alt?: string;
>     title?: string | null;
>     size?: number;
>     cover?: boolean;
>   }>(),
>   {
>     src: null,
>     alt: "",
>     title: null,
>     size: 64,
>     cover: true,
>   }
> );
27c36
< const canvas = $shallowRef<HTMLCanvasElement>();
---
> const canvas = $ref<HTMLCanvasElement>();
31,36c40,45
< 	if (props.hash == null) return;
< 	const pixels = decode(props.hash, props.size, props.size);
< 	const ctx = canvas.getContext('2d');
< 	const imageData = ctx!.createImageData(props.size, props.size);
< 	imageData.data.set(pixels);
< 	ctx!.putImageData(imageData, 0, 0);
---
>   if (props.hash == null) return;
>   const pixels = decode(props.hash, props.size, props.size);
>   const ctx = canvas.getContext("2d");
>   const imageData = ctx!.createImageData(props.size, props.size);
>   imageData.data.set(pixels);
>   ctx!.putImageData(imageData, 0, 0);
40c49
< 	loaded = true;
---
>   loaded = true;
44c53
< 	draw();
---
>   draw();
48,52c57,61
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	width: 100%;
< 	height: 100%;
---
> <style lang="scss" scoped>
> .xubzgfgb {
>   position: relative;
>   width: 100%;
>   height: 100%;
54,59c63,68
< 	&.cover {
< 		> .img {
< 			object-fit: cover;
< 		}
< 	}
< }
---
>   > canvas,
>   > img {
>     display: block;
>     width: 100%;
>     height: 100%;
>   }
61,66c70,73
< .canvas,
< .img {
< 	display: block;
< 	width: 100%;
< 	height: 100%;
< }
---
>   > canvas {
>     position: absolute;
>     object-fit: cover;
>   }
68,71c75,77
< .canvas {
< 	position: absolute;
< 	object-fit: cover;
< }
---
>   > img {
>     object-fit: contain;
>   }
73,74c79,83
< .img {
< 	object-fit: contain;
---
>   &.cover {
>     > img {
>       object-fit: cover;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkInfo.vue RiricaV13/components/MkInfo.vue
2,6c2,6
< <div :class="[$style.root, { [$style.warn]: warn }]">
< 	<i v-if="warn" class="ti ti-alert-triangle" :class="$style.i"></i>
< 	<i v-else class="ti ti-info-circle" :class="$style.i"></i>
< 	<slot></slot>
< </div>
---
>   <div class="fpezltsf" :class="{ warn }">
>     <i v-if="warn" class="fas fa-exclamation-triangle"></i>
>     <i v-else class="fas fa-info-circle"></i>
>     <slot></slot>
>   </div>
10c10
< import { } from 'vue';
---
> import {} from "vue";
13c13
< 	warn?: boolean;
---
>   warn?: boolean;
17,23c17,23
< <style lang="scss" module>
< .root {
< 	padding: 12px 14px;
< 	font-size: 90%;
< 	background: var(--infoBg);
< 	color: var(--infoFg);
< 	border-radius: var(--radius);
---
> <style lang="scss" scoped>
> .fpezltsf {
>   padding: 16px;
>   font-size: 90%;
>   background: var(--infoBg);
>   color: var(--infoFg);
>   border-radius: var(--radius);
25,29c25,28
< 	&.warn {
< 		background: var(--infoWarnBg);
< 		color: var(--infoWarnFg);
< 	}
< }
---
>   &.warn {
>     background: var(--infoWarnBg);
>     color: var(--infoWarnFg);
>   }
31,32c30,32
< .i {
< 	margin-right: 4px;
---
>   > i {
>     margin-right: 4px;
>   }
Only in misskeyV13/packages/frontend/src/components: MkInput.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkInstanceCardMini.vue RiricaV13/components/MkInstanceCardMini.vue
2,9c2,21
< <div :class="[$style.root, { yellow: instance.isNotResponding, red: instance.isBlocked, gray: instance.isSuspended }]">
< 	<img class="icon" :src="getInstanceIcon(instance)" alt="" loading="lazy"/>
< 	<div class="body">
< 		<span class="host">{{ instance.name ?? instance.host }}</span>
< 		<span class="sub _monospace"><b>{{ instance.host }}</b> / {{ instance.softwareName || '?' }} {{ instance.softwareVersion }}</span>
< 	</div>
< 	<MkMiniChart v-if="chartValues" class="chart" :src="chartValues"/>
< </div>
---
>   <div
>     :class="[
>       $style.root,
>       {
>         yellow: instance.isNotResponding,
>         red: instance.isBlocked,
>         gray: instance.isSuspended,
>       },
>     ]"
>   >
>     <img v-if="instance.iconUrl" class="icon" :src="instance.iconUrl" alt="" />
>     <div class="body">
>       <span class="host">{{ instance.name ?? instance.host }}</span>
>       <span class="sub _monospace"
>         ><b>{{ instance.host }}</b> / {{ instance.softwareName || "?" }}
>         {{ instance.softwareVersion }}</span
>       >
>     </div>
>     <MkMiniChart v-if="chartValues" class="chart" :src="chartValues" />
>   </div>
13,16c25,27
< import * as misskey from 'misskey-js';
< import MkMiniChart from '@/components/MkMiniChart.vue';
< import * as os from '@/os';
< import { getProxiedImageUrlNullable } from '@/scripts/media-proxy';
---
> import * as misskey from "misskey-js";
> import MkMiniChart from "@/components/MkMiniChart.vue";
> import * as os from "@/os";
19c30
< 	instance: misskey.entities.Instance;
---
>   instance: misskey.entities.Instance;
24,27c35,42
< os.apiGet('charts/instance', { host: props.instance.host, limit: 16 + 1, span: 'day' }).then(res => {
< 	// 今日のぶんの値はまだ途中の値であり、それも含めると大抵の場合前日よりも下降しているようなグラフになってしまうため今日は弾く
< 	res.requests.received.splice(0, 1);
< 	chartValues = res.requests.received;
---
> os.apiGet("charts/instance", {
>   host: props.instance.host,
>   limit: 16 + 1,
>   span: "day",
> }).then((res) => {
>   // 今日のぶんの値はまだ途中の値であり、それも含めると大抵の場合前日よりも下降しているようなグラフになってしまうため今日は弾く
>   res.requests.received.splice(0, 1);
>   chartValues = res.requests.received;
29,32d43
< 
< function getInstanceIcon(instance): string {
< 	return getProxiedImageUrlNullable(instance.iconUrl, 'preview') ?? getProxiedImageUrlNullable(instance.faviconUrl, 'preview') ?? '/client-assets/dummy.png';
< }
37,38c48,49
< 	$bodyTitleHieght: 18px;
< 	$bodyInfoHieght: 16px;
---
>   $bodyTitleHieght: 18px;
>   $bodyInfoHieght: 16px;
40,44c51,55
< 	display: flex;
< 	align-items: center;
< 	padding: 16px;
< 	background: var(--panel);
< 	border-radius: 8px;
---
>   display: flex;
>   align-items: center;
>   padding: 16px;
>   background: var(--panel);
>   border-radius: 8px;
46,53c57,64
< 	> :global(.icon) {
< 		display: block;
< 		width: ($bodyTitleHieght + $bodyInfoHieght);
< 		height: ($bodyTitleHieght + $bodyInfoHieght);
< 		object-fit: cover;
< 		border-radius: 4px;
< 		margin-right: 10px;
< 	}
---
>   > :global(.icon) {
>     display: block;
>     width: ($bodyTitleHieght + $bodyInfoHieght);
>     height: ($bodyTitleHieght + $bodyInfoHieght);
>     object-fit: cover;
>     border-radius: 4px;
>     margin-right: 10px;
>   }
55,60c66,71
< 	> :global(.body) {
< 		flex: 1;
< 		overflow: hidden;
< 		font-size: 0.9em;
< 		color: var(--fg);
< 		padding-right: 8px;
---
>   > :global(.body) {
>     flex: 1;
>     overflow: hidden;
>     font-size: 0.9em;
>     color: var(--fg);
>     padding-right: 8px;
62,69c73,80
< 		> :global(.host) {
< 			display: block;
< 			width: 100%;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			line-height: $bodyTitleHieght;
< 		}
---
>     > :global(.host) {
>       display: block;
>       width: 100%;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       line-height: $bodyTitleHieght;
>     }
71,81c82,92
< 		> :global(.sub) {
< 			display: block;
< 			width: 100%;
< 			font-size: 80%;
< 			opacity: 0.7;
< 			line-height: $bodyInfoHieght;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
< 	}
---
>     > :global(.sub) {
>       display: block;
>       width: 100%;
>       font-size: 80%;
>       opacity: 0.7;
>       line-height: $bodyInfoHieght;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
>   }
83,85c94,96
< 	> :global(.chart) {
< 		height: 30px;
< 	}
---
>   > :global(.chart) {
>     height: 30px;
>   }
87,91c98,111
< 	&:global(.yellow) {
< 		--c: rgb(255 196 0 / 15%);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.yellow) {
>     --c: rgb(255 196 0 / 15%);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
93,97c113,126
< 	&:global(.red) {
< 		--c: rgb(255 0 0 / 15%);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.red) {
>     --c: rgb(255 0 0 / 15%);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
99,103c128,141
< 	&:global(.gray) {
< 		--c: var(--bg);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.gray) {
>     --c: var(--bg);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkInstanceStats.vue RiricaV13/components/MkInstanceStats.vue
2,75c2,70
< <div :class="$style.root">
< 	<MkFoldableSection class="item">
< 		<template #header>Chart</template>
< 		<div :class="$style.chart">
< 			<div class="selects">
< 				<MkSelect v-model="chartSrc" style="margin: 0; flex: 1;">
< 					<optgroup :label="i18n.ts.federation">
< 						<option value="federation">{{ i18n.ts._charts.federation }}</option>
< 						<option value="ap-request">{{ i18n.ts._charts.apRequest }}</option>
< 					</optgroup>
< 					<optgroup :label="i18n.ts.users">
< 						<option value="users">{{ i18n.ts._charts.usersIncDec }}</option>
< 						<option value="users-total">{{ i18n.ts._charts.usersTotal }}</option>
< 						<option value="active-users">{{ i18n.ts._charts.activeUsers }}</option>
< 					</optgroup>
< 					<optgroup :label="i18n.ts.notes">
< 						<option value="notes">{{ i18n.ts._charts.notesIncDec }}</option>
< 						<option value="local-notes">{{ i18n.ts._charts.localNotesIncDec }}</option>
< 						<option value="remote-notes">{{ i18n.ts._charts.remoteNotesIncDec }}</option>
< 						<option value="notes-total">{{ i18n.ts._charts.notesTotal }}</option>
< 					</optgroup>
< 					<optgroup :label="i18n.ts.drive">
< 						<option value="drive-files">{{ i18n.ts._charts.filesIncDec }}</option>
< 						<option value="drive">{{ i18n.ts._charts.storageUsageIncDec }}</option>
< 					</optgroup>
< 				</MkSelect>
< 				<MkSelect v-model="chartSpan" style="margin: 0 0 0 10px;">
< 					<option value="hour">{{ i18n.ts.perHour }}</option>
< 					<option value="day">{{ i18n.ts.perDay }}</option>
< 				</MkSelect>
< 			</div>
< 			<div class="chart _panel">
< 				<MkChart :src="chartSrc" :span="chartSpan" :limit="chartLimit" :detailed="true"></MkChart>
< 			</div>
< 		</div>
< 	</MkFoldableSection>
< 
< 	<MkFoldableSection class="item">
< 		<template #header>Active users heatmap</template>
< 		<MkSelect v-model="heatmapSrc" style="margin: 0 0 12px 0;">
< 			<option value="active-users">Active users</option>
< 			<option value="notes">Notes</option>
< 			<option value="ap-requests-inbox-received">AP Requests: inboxReceived</option>
< 			<option value="ap-requests-deliver-succeeded">AP Requests: deliverSucceeded</option>
< 			<option value="ap-requests-deliver-failed">AP Requests: deliverFailed</option>
< 		</MkSelect>
< 		<div class="_panel" :class="$style.heatmap">
< 			<MkHeatmap :src="heatmapSrc"/>
< 		</div>
< 	</MkFoldableSection>
< 
< 	<MkFoldableSection class="item">
< 		<template #header>Retention rate</template>
< 		<div class="_panel" :class="$style.retention">
< 			<MkRetentionHeatmap/>
< 		</div>
< 	</MkFoldableSection>
< 
< 	<MkFoldableSection class="item">
< 		<template #header>Federation</template>
< 		<div :class="$style.federation">
< 			<div class="pies">
< 				<div class="sub">
< 					<div class="title">Sub</div>
< 					<canvas ref="subDoughnutEl"></canvas>
< 				</div>
< 				<div class="pub">
< 					<div class="title">Pub</div>
< 					<canvas ref="pubDoughnutEl"></canvas>
< 				</div>
< 			</div>
< 		</div>
< 	</MkFoldableSection>
< </div>
---
>   <div class="zbcjwnqg">
>     <div class="main">
>       <div class="body">
>         <div class="selects" style="display: flex">
>           <MkSelect v-model="chartSrc" style="margin: 0; flex: 1">
>             <optgroup :label="i18n.ts.federation">
>               <option value="federation">
>                 {{ i18n.ts._charts.federation }}
>               </option>
>               <option value="ap-request">
>                 {{ i18n.ts._charts.apRequest }}
>               </option>
>             </optgroup>
>             <optgroup :label="i18n.ts.users">
>               <option value="users">{{ i18n.ts._charts.usersIncDec }}</option>
>               <option value="users-total">
>                 {{ i18n.ts._charts.usersTotal }}
>               </option>
>               <option value="active-users">
>                 {{ i18n.ts._charts.activeUsers }}
>               </option>
>             </optgroup>
>             <optgroup :label="i18n.ts.notes">
>               <option value="notes">{{ i18n.ts._charts.notesIncDec }}</option>
>               <option value="local-notes">
>                 {{ i18n.ts._charts.localNotesIncDec }}
>               </option>
>               <option value="remote-notes">
>                 {{ i18n.ts._charts.remoteNotesIncDec }}
>               </option>
>               <option value="notes-total">
>                 {{ i18n.ts._charts.notesTotal }}
>               </option>
>             </optgroup>
>             <optgroup :label="i18n.ts.drive">
>               <option value="drive-files">
>                 {{ i18n.ts._charts.filesIncDec }}
>               </option>
>               <option value="drive">
>                 {{ i18n.ts._charts.storageUsageIncDec }}
>               </option>
>             </optgroup>
>           </MkSelect>
>           <MkSelect v-model="chartSpan" style="margin: 0 0 0 10px">
>             <option value="hour">{{ i18n.ts.perHour }}</option>
>             <option value="day">{{ i18n.ts.perDay }}</option>
>           </MkSelect>
>         </div>
>         <div class="chart">
>           <MkChart
>             :src="chartSrc"
>             :span="chartSpan"
>             :limit="chartLimit"
>             :detailed="detailed"
>           ></MkChart>
>         </div>
>       </div>
>     </div>
>     <div class="subpub">
>       <div class="sub">
>         <div class="title">Sub</div>
>         <canvas ref="subDoughnutEl"></canvas>
>       </div>
>       <div class="pub">
>         <div class="title">Pub</div>
>         <canvas ref="pubDoughnutEl"></canvas>
>       </div>
>     </div>
>   </div>
79,89c74,97
< import { onMounted } from 'vue';
< import { Chart } from 'chart.js';
< import MkSelect from '@/components/MkSelect.vue';
< import MkChart from '@/components/MkChart.vue';
< import { useChartTooltip } from '@/scripts/use-chart-tooltip';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import MkHeatmap from '@/components/MkHeatmap.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkRetentionHeatmap from '@/components/MkRetentionHeatmap.vue';
< import { initChart } from '@/scripts/init-chart';
---
> import { onMounted } from "vue";
> import {
>   Chart,
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
>   DoughnutController,
> } from "chart.js";
> import MkSelect from "@/components/form/select.vue";
> import MkChart from "@/components/MkChart.vue";
> import { useChartTooltip } from "@/scripts/use-chart-tooltip";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
91c99,115
< initChart();
---
> Chart.register(
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   DoughnutController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler
> );
93,98c117,125
< const chartLimit = 500;
< let chartSpan = $ref<'hour' | 'day'>('hour');
< let chartSrc = $ref('active-users');
< let heatmapSrc = $ref('active-users');
< let subDoughnutEl = $shallowRef<HTMLCanvasElement>();
< let pubDoughnutEl = $shallowRef<HTMLCanvasElement>();
---
> const props = withDefaults(
>   defineProps<{
>     chartLimit?: number;
>     detailed?: boolean;
>   }>(),
>   {
>     chartLimit: 90,
>   }
> );
100,105c127,130
< const { handler: externalTooltipHandler1 } = useChartTooltip({
< 	position: 'middle',
< });
< const { handler: externalTooltipHandler2 } = useChartTooltip({
< 	position: 'middle',
< });
---
> const chartSpan = $ref<"hour" | "day">("hour");
> const chartSrc = $ref("active-users");
> let subDoughnutEl = $ref<HTMLCanvasElement>();
> let pubDoughnutEl = $ref<HTMLCanvasElement>();
106a132,134
> const { handler: externalTooltipHandler1 } = useChartTooltip();
> const { handler: externalTooltipHandler2 } = useChartTooltip();
> 
108,150c136,187
< 	const chartInstance = new Chart(chartEl, {
< 		type: 'doughnut',
< 		data: {
< 			labels: data.map(x => x.name),
< 			datasets: [{
< 				backgroundColor: data.map(x => x.color),
< 				borderColor: getComputedStyle(document.documentElement).getPropertyValue('--panel'),
< 				borderWidth: 2,
< 				hoverOffset: 0,
< 				data: data.map(x => x.value),
< 			}],
< 		},
< 		options: {
< 			maintainAspectRatio: false,
< 			layout: {
< 				padding: {
< 					left: 16,
< 					right: 16,
< 					top: 16,
< 					bottom: 16,
< 				},
< 			},
< 			onClick: (ev) => {
< 				const hit = chartInstance.getElementsAtEventForMode(ev, 'nearest', { intersect: true }, false)[0];
< 				if (hit && data[hit.index].onClick) {
< 					data[hit.index].onClick();
< 				}
< 			},
< 			plugins: {
< 				legend: {
< 					display: false,
< 				},
< 				tooltip: {
< 					enabled: false,
< 					mode: 'index',
< 					animation: {
< 						duration: 0,
< 					},
< 					external: tooltip,
< 				},
< 			},
< 		},
< 	});
---
>   const chartInstance = new Chart(chartEl, {
>     type: "doughnut",
>     data: {
>       labels: data.map((x) => x.name),
>       datasets: [
>         {
>           backgroundColor: data.map((x) => x.color),
>           borderColor: getComputedStyle(
>             document.documentElement
>           ).getPropertyValue("--panel"),
>           borderWidth: 2,
>           hoverOffset: 0,
>           data: data.map((x) => x.value),
>         },
>       ],
>     },
>     options: {
>       maintainAspectRatio: false,
>       layout: {
>         padding: {
>           left: 16,
>           right: 16,
>           top: 16,
>           bottom: 16,
>         },
>       },
>       onClick: (ev) => {
>         const hit = chartInstance.getElementsAtEventForMode(
>           ev,
>           "nearest",
>           { intersect: true },
>           false
>         )[0];
>         if (hit && data[hit.index].onClick) {
>           data[hit.index].onClick();
>         }
>       },
>       plugins: {
>         legend: {
>           display: false,
>         },
>         tooltip: {
>           enabled: false,
>           mode: "index",
>           animation: {
>             duration: 0,
>           },
>           external: tooltip,
>         },
>       },
>     },
>   });
152c189
< 	return chartInstance;
---
>   return chartInstance;
156,164c193,213
< 	os.apiGet('federation/stats', { limit: 30 }).then(fedStats => {
< 		createDoughnut(subDoughnutEl, externalTooltipHandler1, fedStats.topSubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followersCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: fedStats.otherFollowersCount }]));
---
>   os.apiGet("federation/stats", { limit: 30 }).then((fedStats) => {
>     createDoughnut(
>       subDoughnutEl,
>       externalTooltipHandler1,
>       fedStats.topSubInstances
>         .map((x) => ({
>           name: x.host,
>           color: x.themeColor,
>           value: x.followersCount,
>           onClick: () => {
>             os.pageWindow(`/instance-info/${x.host}`);
>           },
>         }))
>         .concat([
>           {
>             name: "(other)",
>             color: "#80808080",
>             value: fedStats.otherFollowersCount,
>           },
>         ])
>     );
166,174c215,235
< 		createDoughnut(pubDoughnutEl, externalTooltipHandler2, fedStats.topPubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followingCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: fedStats.otherFollowingCount }]));
< 	});
---
>     createDoughnut(
>       pubDoughnutEl,
>       externalTooltipHandler2,
>       fedStats.topPubInstances
>         .map((x) => ({
>           name: x.host,
>           color: x.themeColor,
>           value: x.followingCount,
>           onClick: () => {
>             os.pageWindow(`/instance-info/${x.host}`);
>           },
>         }))
>         .concat([
>           {
>             name: "(other)",
>             color: "#80808080",
>             value: fedStats.otherFollowingCount,
>           },
>         ])
>     );
>   });
178,185c239,245
< <style lang="scss" module>
< .root {
< 	&:global {
< 		> .item {
< 			margin-bottom: 16px;
< 		}
< 	}
< }
---
> <style lang="scss" scoped>
> .zbcjwnqg {
>   > .main {
>     background: var(--panel);
>     border-radius: var(--radius);
>     padding: 24px;
>     margin-bottom: 16px;
187,192c247,252
< .chart {
< 	&:global {
< 		> .selects {
< 			display: flex;
< 			margin-bottom: 12px;
< 		}
---
>     > .body {
>       > .chart {
>         padding: 8px 0 0 0;
>       }
>     }
>   }
194,198c254,256
< 		> .chart {
< 			padding: 16px;
< 		}
< 	}
< }
---
>   > .subpub {
>     display: flex;
>     gap: 16px;
200,203c258,266
< .heatmap {
< 	padding: 16px;
< 	margin-bottom: 16px;
< }
---
>     > .sub,
>     > .pub {
>       flex: 1;
>       min-width: 0;
>       position: relative;
>       background: var(--panel);
>       border-radius: var(--radius);
>       padding: 24px;
>       max-height: 300px;
205,208c268,273
< .retention {
< 	padding: 16px;
< 	margin-bottom: 16px;
< }
---
>       > .title {
>         position: absolute;
>         top: 24px;
>         left: 24px;
>       }
>     }
210,236c275,278
< .federation {
< 	&:global {
< 		> .pies {
< 			display: flex;
< 			gap: 16px;
< 
< 			> .sub, > .pub {
< 				flex: 1;
< 				min-width: 0;
< 				position: relative;
< 				background: var(--panel);
< 				border-radius: var(--radius);
< 				padding: 24px;
< 				max-height: 300px;
< 
< 				> .title {
< 					position: absolute;
< 					top: 24px;
< 					left: 24px;
< 				}
< 			}
< 
< 			@media (max-width: 600px) {
< 				flex-direction: column;
< 			}
< 		}
< 	}
---
>     @media (max-width: 600px) {
>       flex-direction: column;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkInstanceTicker.vue RiricaV13/components/MkInstanceTicker.vue
2,5c2,5
< <div :class="$style.root" :style="bg">
< 	<img v-if="faviconUrl" :class="$style.icon" :src="faviconUrl"/>
< 	<div :class="$style.name">{{ instance.name }}</div>
< </div>
---
>   <div :class="$style.root" :style="bg">
>     <img v-if="faviconUrl" :class="$style.icon" :src="faviconUrl" />
>     <div :class="$style.name">{{ instance.name }}</div>
>   </div>
9,12c9,12
< import { } from 'vue';
< import { instanceName } from '@/config';
< import { instance as Instance } from '@/instance';
< import { getProxiedImageUrlNullable } from '@/scripts/media-proxy';
---
> import {} from "vue";
> import { instanceName } from "@/config";
> import { instance as Instance } from "@/instance";
> import { getProxiedImageUrlNullable } from "@/scripts/media-proxy";
15,19c15,19
< 	instance?: {
< 		faviconUrl?: string
< 		name: string
< 		themeColor?: string
< 	}
---
>   instance?: {
>     faviconUrl?: string;
>     name: string;
>     themeColor?: string;
>   };
24,25c24,27
< 	name: instanceName,
< 	themeColor: (document.querySelector('meta[name="theme-color-orig"]') as HTMLMetaElement).content,
---
>   name: instanceName,
>   themeColor: (
>     document.querySelector('meta[name="theme-color-orig"]') as HTMLMetaElement
>   ).content,
28c30,36
< const faviconUrl = $computed(() => props.instance ? getProxiedImageUrlNullable(props.instance.faviconUrl, 'preview') : getProxiedImageUrlNullable(Instance.iconUrl, 'preview') ?? getProxiedImageUrlNullable(Instance.faviconUrl, 'preview') ?? '/favicon.ico');
---
> const faviconUrl = $computed(() =>
>   props.instance
>     ? getProxiedImageUrlNullable(props.instance.faviconUrl, "preview")
>     : getProxiedImageUrlNullable(Instance.iconUrl, "preview") ??
>       getProxiedImageUrlNullable(Instance.faviconUrl, "preview") ??
>       "/favicon.ico"
> );
30c38
< const themeColor = instance.themeColor ?? '#777777';
---
> const themeColor = instance.themeColor ?? "#777777";
33c41
< 	background: `linear-gradient(90deg, ${themeColor}, ${themeColor}00)`,
---
>   background: `linear-gradient(90deg, ${themeColor}, ${themeColor}00)`,
41,64c49,65
< 	display: flex;
< 	align-items: center;
< 	height: $height;
< 	border-radius: 4px 0 0 4px;
< 	overflow: clip;
< 	color: #fff;
< 	text-shadow: /* .866 ≈ sin(60deg) */
< 		1px 0 1px #000,
< 		.866px .5px 1px #000,
< 		.5px .866px 1px #000,
< 		0 1px 1px #000,
< 		-.5px .866px 1px #000,
< 		-.866px .5px 1px #000,
< 		-1px 0 1px #000,
< 		-.866px -.5px 1px #000,
< 		-.5px -.866px 1px #000,
< 		0 -1px 1px #000,
< 		.5px -.866px 1px #000,
< 		.866px -.5px 1px #000;
< 	mask-image: linear-gradient(90deg,
< 		rgb(0,0,0),
< 		rgb(0,0,0) calc(100% - 16px),
< 		rgba(0,0,0,0) 100%
< 	);
---
>   display: flex;
>   align-items: center;
>   height: $height;
>   border-radius: 4px 0 0 4px;
>   overflow: clip;
>   color: #fff;
>   text-shadow: /* .866 ≈ sin(60deg) */ 1px 0 1px #000, 0.866px 0.5px 1px #000,
>     0.5px 0.866px 1px #000, 0 1px 1px #000, -0.5px 0.866px 1px #000,
>     -0.866px 0.5px 1px #000, -1px 0 1px #000, -0.866px -0.5px 1px #000,
>     -0.5px -0.866px 1px #000, 0 -1px 1px #000, 0.5px -0.866px 1px #000,
>     0.866px -0.5px 1px #000;
>   mask-image: linear-gradient(
>     90deg,
>     rgb(0, 0, 0),
>     rgb(0, 0, 0) calc(100% - 16px),
>     rgba(0, 0, 0, 0) 100%
>   );
68,69c69,70
< 	height: $height;
< 	flex-shrink: 0;
---
>   height: $height;
>   flex-shrink: 0;
73,78c74,79
< 	margin-left: 4px;
< 	line-height: 1;
< 	font-size: 0.9em;
< 	font-weight: bold;
< 	white-space: nowrap;
< 	overflow: visible;
---
>   margin-left: 4px;
>   line-height: 1;
>   font-size: 0.9em;
>   font-weight: bold;
>   white-space: nowrap;
>   overflow: visible;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkKeyValue.vue RiricaV13/components/MkKeyValue.vue
2,10c2,18
< <div class="alqyeyti" :class="{ oneline }">
< 	<div class="key">
< 		<slot name="key"></slot>
< 	</div>
< 	<div class="value">
< 		<slot name="value"></slot>
< 		<button v-if="copy" v-tooltip="i18n.ts.copy" class="_textButton" style="margin-left: 0.5em;" @click="copy_"><i class="ti ti-copy"></i></button>
< 	</div>
< </div>
---
>   <div class="alqyeyti" :class="{ oneline }">
>     <div class="key">
>       <slot name="key"></slot>
>     </div>
>     <div class="value">
>       <slot name="value"></slot>
>       <button
>         v-if="copy"
>         v-tooltip="i18n.ts.copy"
>         class="_textButton"
>         style="margin-left: 0.5em"
>         @click="copy_"
>       >
>         <i class="far fa-copy"></i>
>       </button>
>     </div>
>   </div>
14,17c22,25
< import { } from 'vue';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
19,25c27,36
< const props = withDefaults(defineProps<{
< 	copy?: string | null;
< 	oneline?: boolean;
< }>(), {
< 	copy: null,
< 	oneline: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     copy?: string | null;
>     oneline?: boolean;
>   }>(),
>   {
>     copy: null,
>     oneline: false,
>   }
> );
28,29c39,40
< 	copyToClipboard(props.copy);
< 	os.success();
---
>   copyToClipboard(props.copy);
>   os.success();
35,39c46,50
< 	> .key {
< 		font-size: 0.85em;
< 		padding: 0 0 0.25em 0;
< 		opacity: 0.75;
< 	}
---
>   > .key {
>     font-size: 0.85em;
>     padding: 0 0 0.25em 0;
>     opacity: 0.75;
>   }
41,42c52,53
< 	&.oneline {
< 		display: flex;
---
>   &.oneline {
>     display: flex;
44,48c55,59
< 		> .key {
< 			width: 30%;
< 			font-size: 1em;
< 			padding: 0 8px 0 0;
< 		}
---
>     > .key {
>       width: 30%;
>       font-size: 1em;
>       padding: 0 8px 0 0;
>     }
50,56c61,67
< 		> .value {
< 			width: 70%;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
< 	}
---
>     > .value {
>       width: 70%;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkLaunchPad.vue RiricaV13/components/MkLaunchPad.vue
2,19c2,46
< <MkModal ref="modal" v-slot="{ type, maxHeight }" :prefer-type="preferedModalType" :anchor="anchor" :transparent-bg="true" :src="src" @click="modal.close()" @closed="emit('closed')">
< 	<div class="szkkfdyq _popup _shadow" :class="{ asDrawer: type === 'drawer' }" :style="{ maxHeight: maxHeight ? maxHeight + 'px' : '' }">
< 		<div class="main">
< 			<template v-for="item in items">
< 				<button v-if="item.action" v-click-anime class="_button item" @click="$event => { item.action($event); close(); }">
< 					<i class="icon" :class="item.icon"></i>
< 					<div class="text">{{ item.text }}</div>
< 					<span v-if="item.indicate" class="indicator"><i class="_indicatorCircle"></i></span>
< 				</button>
< 				<MkA v-else v-click-anime :to="item.to" class="item" @click.passive="close()">
< 					<i class="icon" :class="item.icon"></i>
< 					<div class="text">{{ item.text }}</div>
< 					<span v-if="item.indicate" class="indicator"><i class="_indicatorCircle"></i></span>
< 				</MkA>
< 			</template>
< 		</div>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     v-slot="{ type, maxHeight }"
>     :prefer-type="preferedModalType"
>     :anchor="anchor"
>     :transparent-bg="true"
>     :src="src"
>     @click="modal.close()"
>     @closed="emit('closed')"
>   >
>     <div
>       class="szkkfdyq _popup _shadow"
>       :class="{ asDrawer: type === 'drawer' }"
>       :style="{ maxHeight: maxHeight ? maxHeight + 'px' : '' }"
>     >
>       <div class="main">
>         <template v-for="item in items">
>           <button
>             v-if="item.action"
>             v-click-anime
>             class="_button"
>             @click="
>               ($event) => {
>                 item.action($event);
>                 close();
>               }
>             "
>           >
>             <i class="icon" :class="item.icon"></i>
>             <div class="text">{{ item.text }}</div>
>             <span v-if="item.indicate" class="indicator"
>               ><i class="fas fa-circle"></i
>             ></span>
>           </button>
>           <MkA v-else v-click-anime :to="item.to" @click.passive="close()">
>             <i class="icon" :class="item.icon"></i>
>             <div class="text">{{ item.text }}</div>
>             <span v-if="item.indicate" class="indicator"
>               ><i class="fas fa-circle"></i
>             ></span>
>           </MkA>
>         </template>
>       </div>
>     </div>
>   </MkModal>
23,30c50,57
< import { } from 'vue';
< import MkModal from '@/components/MkModal.vue';
< import { navbarItemDef } from '@/navbar';
< import { instanceName } from '@/config';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { deviceKind } from '@/scripts/device-kind';
< import * as os from '@/os';
---
> import {} from "vue";
> import MkModal from "@/components/MkModal.vue";
> import { navbarItemDef } from "@/navbar";
> import { instanceName } from "@/config";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { deviceKind } from "@/scripts/device-kind";
> import * as os from "@/os";
32,37c59,67
< const props = withDefaults(defineProps<{
< 	src?: HTMLElement;
< 	anchor?: { x: string; y: string; };
< }>(), {
< 	anchor: () => ({ x: 'right', y: 'center' }),
< });
---
> const props = withDefaults(
>   defineProps<{
>     src?: HTMLElement;
>     anchor?: { x: string; y: string };
>   }>(),
>   {
>     anchor: () => ({ x: "right", y: "center" }),
>   }
> );
40c70
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
43,45c73,78
< const preferedModalType = (deviceKind === 'desktop' && props.src != null) ? 'popup' :
< 	deviceKind === 'smartphone' ? 'drawer' :
< 	'dialog';
---
> const preferedModalType =
>   deviceKind === "desktop" && props.src != null
>     ? "popup"
>     : deviceKind === "smartphone"
>     ? "drawer"
>     : "dialog";
47c80
< const modal = $shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = $ref<InstanceType<typeof MkModal>>();
51,58c84,95
< const items = Object.keys(navbarItemDef).filter(k => !menu.includes(k)).map(k => navbarItemDef[k]).filter(def => def.show == null ? true : def.show).map(def => ({
< 	type: def.to ? 'link' : 'button',
< 	text: def.title,
< 	icon: def.icon,
< 	to: def.to,
< 	action: def.action,
< 	indicate: def.indicated,
< }));
---
> const items = Object.keys(navbarItemDef)
>   .filter((k) => !menu.includes(k))
>   .map((k) => navbarItemDef[k])
>   .filter((def) => (def.show == null ? true : def.show))
>   .map((def) => ({
>     type: def.to ? "link" : "button",
>     text: i18n.ts[def.title],
>     icon: def.icon,
>     to: def.to,
>     action: def.action,
>     indicate: def.indicated,
>   }));
61c98
< 	modal.close();
---
>   modal.close();
67,75c104,111
< 	max-height: 100%;
< 	width: min(460px, 100vw);
< 	margin: auto;
< 	padding: 24px;
< 	box-sizing: border-box;
< 	overflow: auto;
< 	overscroll-behavior: contain;
< 	text-align: left;
< 	border-radius: 16px;
---
>   max-height: 100%;
>   width: min(460px, 100vw);
>   padding: 24px;
>   box-sizing: border-box;
>   overflow: auto;
>   overscroll-behavior: contain;
>   text-align: left;
>   border-radius: 16px;
77,84c113,120
< 	&.asDrawer {
< 		width: 100%;
< 		padding: 16px 16px max(env(safe-area-inset-bottom, 0px), 16px) 16px;
< 		border-radius: 24px;
< 		border-bottom-right-radius: 0;
< 		border-bottom-left-radius: 0;
< 		text-align: center;
< 	}
---
>   &.asDrawer {
>     width: 100%;
>     padding: 16px 16px calc(env(safe-area-inset-bottom, 0px) + 16px) 16px;
>     border-radius: 24px;
>     border-bottom-right-radius: 0;
>     border-bottom-left-radius: 0;
>     text-align: center;
>   }
86,88c122,125
< 	> .main {
< 		display: grid;
< 		grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
---
>   > .main,
>   > .sub {
>     display: grid;
>     grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
90,98c127,135
< 		> .item {
< 			position: relative;
< 			display: flex;
< 			flex-direction: column;
< 			align-items: center;
< 			justify-content: center;
< 			vertical-align: bottom;
< 			height: 100px;
< 			border-radius: 10px;
---
>     > * {
>       position: relative;
>       display: flex;
>       flex-direction: column;
>       align-items: center;
>       justify-content: center;
>       vertical-align: bottom;
>       height: 100px;
>       border-radius: 10px;
100,104c137,141
< 			&:hover {
< 				color: var(--accent);
< 				background: var(--accentedBg);
< 				text-decoration: none;
< 			}
---
>       &:hover {
>         color: var(--accent);
>         background: var(--accentedBg);
>         text-decoration: none;
>       }
106,109c143,146
< 			> .icon {
< 				font-size: 24px;
< 				height: 24px;
< 			}
---
>       > .icon {
>         font-size: 24px;
>         height: 24px;
>       }
111,115c148,152
< 			> .text {
< 				margin-top: 12px;
< 				font-size: 0.8em;
< 				line-height: 1.5em;
< 			}
---
>       > .text {
>         margin-top: 12px;
>         font-size: 0.8em;
>         line-height: 1.5em;
>       }
117,123c154,160
< 			> .indicator {
< 				position: absolute;
< 				top: 32px;
< 				left: 32px;
< 				color: var(--indicator);
< 				font-size: 8px;
< 				animation: blink 1s infinite;
---
>       > .indicator {
>         position: absolute;
>         top: 32px;
>         left: 32px;
>         color: var(--indicator);
>         font-size: 8px;
>         animation: blink 1s infinite;
125,131c162,174
< 				@media (max-width: 500px) {
< 					top: 16px;
< 					left: 16px;
< 				}
< 			}
< 		}
< 	}
---
>         @media (max-width: 500px) {
>           top: 16px;
>           left: 16px;
>         }
>       }
>     }
>   }
> 
>   > .sub {
>     margin-top: 8px;
>     padding-top: 8px;
>     border-top: solid 0.5px var(--divider);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkLink.vue RiricaV13/components/MkLink.vue
2,8c2,16
< <component
< 	:is="self ? 'MkA' : 'a'" ref="el" style="word-break: break-all;" class="_link" :[attr]="self ? url.substr(local.length) : url" :rel="rel" :target="target"
< 	:title="url"
< >
< 	<slot></slot>
< 	<i v-if="target === '_blank'" class="ti ti-external-link" :class="$style.icon"></i>
< </component>
---
>   <component
>     :is="self ? 'MkA' : 'a'"
>     ref="el"
>     class="xlcxczvw _link"
>     :[attr]="self ? url.substr(local.length) : url"
>     :rel="rel"
>     :target="target"
>     :title="url"
>   >
>     <slot></slot>
>     <i
>       v-if="target === '_blank'"
>       class="fas fa-external-link-square-alt icon"
>     ></i>
>   </component>
12,15c20,23
< import { defineAsyncComponent } from 'vue';
< import { url as local } from '@/config';
< import { useTooltip } from '@/scripts/use-tooltip';
< import * as os from '@/os';
---
> import { defineAsyncComponent } from "vue";
> import { url as local } from "@/config";
> import { useTooltip } from "@/scripts/use-tooltip";
> import * as os from "@/os";
17,21c25,31
< const props = withDefaults(defineProps<{
< 	url: string;
< 	rel?: null | string;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     url: string;
>     rel?: null | string;
>   }>(),
>   {}
> );
24,25c34,35
< const attr = self ? 'to' : 'href';
< const target = self ? null : '_blank';
---
> const attr = self ? "to" : "href";
> const target = self ? null : "_blank";
30,34c40,49
< 	os.popup(defineAsyncComponent(() => import('@/components/MkUrlPreviewPopup.vue')), {
< 		showing,
< 		url: props.url,
< 		source: el,
< 	}, {}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkUrlPreviewPopup.vue")),
>     {
>       showing,
>       url: props.url,
>       source: el,
>     },
>     {},
>     "closed"
>   );
38,41c53,60
< <style lang="scss" module>
< .icon {
< 	padding-left: 2px;
< 	font-size: .9em;
---
> <style lang="scss" scoped>
> .xlcxczvw {
>   word-break: break-all;
> 
>   > .icon {
>     padding-left: 2px;
>     font-size: 0.9em;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMarquee.vue RiricaV13/components/MkMarquee.vue
2c2
< import { h, onMounted, onUnmounted, ref, watch } from 'vue';
---
> import { h, onMounted, onUnmounted, ref, watch } from "vue";
5,25c5,25
< 	name: 'MarqueeText',
< 	props: {
< 		duration: {
< 			type: Number,
< 			default: 15,
< 		},
< 		repeat: {
< 			type: Number,
< 			default: 2,
< 		},
< 		paused: {
< 			type: Boolean,
< 			default: false,
< 		},
< 		reverse: {
< 			type: Boolean,
< 			default: false,
< 		},
< 	},
< 	setup(props) {
< 		const contentEl = ref();
---
>   name: "MarqueeText",
>   props: {
>     duration: {
>       type: Number,
>       default: 15,
>     },
>     repeat: {
>       type: Number,
>       default: 2,
>     },
>     paused: {
>       type: Boolean,
>       default: false,
>     },
>     reverse: {
>       type: Boolean,
>       default: false,
>     },
>   },
>   setup(props) {
>     const contentEl = ref();
27,30c27,30
< 		function calc() {
< 			const eachLength = contentEl.value.offsetWidth / props.repeat;
< 			const factor = 3000;
< 			const duration = props.duration / ((1 / eachLength) * factor);
---
>     function calc() {
>       const eachLength = contentEl.value.offsetWidth / props.repeat;
>       const factor = 3000;
>       const duration = props.duration / ((1 / eachLength) * factor);
32,33c32,33
< 			contentEl.value.style.animationDuration = `${duration}s`;
< 		}
---
>       contentEl.value.style.animationDuration = `${duration}s`;
>     }
35c35
< 		watch(() => props.duration, calc);
---
>     watch(() => props.duration, calc);
37,39c37,39
< 		onMounted(() => {
< 			calc();
< 		});
---
>     onMounted(() => {
>       calc();
>     });
41,42c41
< 		onUnmounted(() => {
< 		});
---
>     onUnmounted(() => {});
44,73c43,69
< 		return {
< 			contentEl,
< 		};
< 	},
< 	render({
< 		$slots, $style, $props: {
< 			duration, repeat, paused, reverse,
< 		},
< 	}) {
< 		return h('div', { class: [$style.wrap] }, [
< 			h('span', {
< 				ref: 'contentEl',
< 				class: [
< 					paused
< 						? $style.paused
< 						: undefined,
< 					$style.content,
< 				],
< 			}, Array(repeat).fill(
< 				h('span', {
< 					class: $style.text,
< 					style: {
< 						animationDirection: reverse
< 							? 'reverse'
< 							: undefined,
< 					},
< 				}, $slots.default()),
< 			)),
< 		]);
< 	},
---
>     return {
>       contentEl,
>     };
>   },
>   render({ $slots, $style, $props: { duration, repeat, paused, reverse } }) {
>     return h("div", { class: [$style.wrap] }, [
>       h(
>         "span",
>         {
>           ref: "contentEl",
>           class: [paused ? $style.paused : undefined, $style.content],
>         },
>         Array(repeat).fill(
>           h(
>             "span",
>             {
>               class: $style.text,
>               style: {
>                 animationDirection: reverse ? "reverse" : undefined,
>               },
>             },
>             $slots.default()
>           )
>         )
>       ),
>     ]);
>   },
79,80c75,76
< 	overflow: clip;
< 	animation-play-state: running;
---
>   overflow: clip;
>   animation-play-state: running;
82,84c78,80
< 	&:hover {
< 		animation-play-state: paused;
< 	}
---
>   &:hover {
>     animation-play-state: paused;
>   }
87,89c83,85
< 	display: inline-block;
< 	white-space: nowrap;
< 	animation-play-state: inherit;
---
>   display: inline-block;
>   white-space: nowrap;
>   animation-play-state: inherit;
92,97c88,93
< 	display: inline-block;
< 	animation-name: marquee;
< 	animation-timing-function: linear;
< 	animation-iteration-count: infinite;
< 	animation-duration: inherit;
< 	animation-play-state: inherit;
---
>   display: inline-block;
>   animation-name: marquee;
>   animation-timing-function: linear;
>   animation-iteration-count: infinite;
>   animation-duration: inherit;
>   animation-play-state: inherit;
100c96
< 	animation-play-state: paused;
---
>   animation-play-state: paused;
103,104c99,104
< 	0% { transform:translateX(0); }
< 	100% { transform:translateX(-100%); }
---
>   0% {
>     transform: translateX(0);
>   }
>   100% {
>     transform: translateX(-100%);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMediaBanner.vue RiricaV13/components/MkMediaBanner.vue
2,28c2,36
< <div class="mk-media-banner">
< 	<div v-if="media.isSensitive && hide" class="sensitive" @click="hide = false">
< 		<span class="icon"><i class="ti ti-alert-triangle"></i></span>
< 		<b>{{ $ts.sensitive }}</b>
< 		<span>{{ $ts.clickToShow }}</span>
< 	</div>
< 	<div v-else-if="media.type.startsWith('audio') && media.type !== 'audio/midi'" class="audio">
< 		<audio
< 			ref="audioEl"
< 			class="audio"
< 			:src="media.url"
< 			:title="media.name"
< 			controls
< 			preload="metadata"
< 			@volumechange="volumechange"
< 		/>
< 	</div>
< 	<a
< 		v-else class="download"
< 		:href="media.url"
< 		:title="media.name"
< 		:download="media.name"
< 	>
< 		<span class="icon"><i class="ti ti-download"></i></span>
< 		<b>{{ media.name }}</b>
< 	</a>
< </div>
---
>   <div class="mk-media-banner">
>     <div
>       v-if="media.isSensitive && hide"
>       class="sensitive"
>       @click="hide = false"
>     >
>       <span class="icon"><i class="fas fa-exclamation-triangle"></i></span>
>       <b>{{ $ts.sensitive }}</b>
>       <span>{{ $ts.clickToShow }}</span>
>     </div>
>     <div
>       v-else-if="media.type.startsWith('audio') && media.type !== 'audio/midi'"
>       class="audio"
>     >
>       <audio
>         ref="audioEl"
>         class="audio"
>         :src="media.url"
>         :title="media.name"
>         controls
>         preload="metadata"
>         @volumechange="volumechange"
>       />
>     </div>
>     <a
>       v-else
>       class="download"
>       :href="media.url"
>       :title="media.name"
>       :download="media.name"
>     >
>       <span class="icon"><i class="fas fa-download"></i></span>
>       <b>{{ media.name }}</b>
>     </a>
>   </div>
32,34c40,42
< import { onMounted } from 'vue';
< import * as misskey from 'misskey-js';
< import { ColdDeviceStorage } from '@/store';
---
> import { onMounted } from "vue";
> import * as misskey from "misskey-js";
> import { ColdDeviceStorage } from "@/store";
36,39c44,49
< const props = withDefaults(defineProps<{
< 	media: misskey.entities.DriveFile;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     media: misskey.entities.DriveFile;
>   }>(),
>   {}
> );
41c51
< const audioEl = $shallowRef<HTMLAudioElement | null>();
---
> const audioEl = $ref<HTMLAudioElement | null>();
45c55
< 	if (audioEl) ColdDeviceStorage.set('mediaVolume', audioEl.volume);
---
>   if (audioEl) ColdDeviceStorage.set("mediaVolume", audioEl.volume);
49c59
< 	if (audioEl) audioEl.volume = ColdDeviceStorage.get('mediaVolume');
---
>   if (audioEl) audioEl.volume = ColdDeviceStorage.get("mediaVolume");
55,58c65,68
< 	width: 100%;
< 	border-radius: 4px;
< 	margin-top: 4px;
< 	overflow: hidden;
---
>   width: 100%;
>   border-radius: 4px;
>   margin-top: 4px;
>   overflow: hidden;
60,66c70,76
< 	> .download,
< 	> .sensitive {
< 		display: flex;
< 		align-items: center;
< 		font-size: 12px;
< 		padding: 8px 12px;
< 		white-space: nowrap;
---
>   > .download,
>   > .sensitive {
>     display: flex;
>     align-items: center;
>     font-size: 12px;
>     padding: 8px 12px;
>     white-space: nowrap;
68,70c78,80
< 		> * {
< 			display: block;
< 		}
---
>     > * {
>       display: block;
>     }
72,75c82,85
< 		> b {
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
---
>     > b {
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
77,79c87,89
< 		> *:not(:last-child) {
< 			margin-right: .2em;
< 		}
---
>     > *:not(:last-child) {
>       margin-right: 0.2em;
>     }
81,84c91,94
< 		> .icon {
< 			font-size: 1.6em;
< 		}
< 	}
---
>     > .icon {
>       font-size: 1.6em;
>     }
>   }
86,88c96,98
< 	> .download {
< 		background: var(--noteAttachedFile);
< 	}
---
>   > .download {
>     background: var(--noteAttachedFile);
>   }
90,93c100,103
< 	> .sensitive {
< 		background: #111;
< 		color: #fff;
< 	}
---
>   > .sensitive {
>     background: #111;
>     color: #fff;
>   }
95,100c105,110
< 	> .audio {
< 		.audio {
< 			display: block;
< 			width: 100%;
< 		}
< 	}
---
>   > .audio {
>     .audio {
>       display: block;
>       width: 100%;
>     }
>   }
Only in RiricaV13/components: MkMediaCaption.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMediaImage.vue RiricaV13/components/MkMediaImage.vue
2,20c2,32
< <div v-if="hide" class="qjewsnkg" @click="hide = false">
< 	<ImgWithBlurhash class="bg" :hash="image.blurhash" :title="image.comment" :alt="image.comment"/>
< 	<div class="text">
< 		<div class="wrapper">
< 			<b style="display: block;"><i class="ti ti-alert-triangle"></i> {{ $ts.sensitive }}</b>
< 			<span style="display: block;">{{ $ts.clickToShow }}</span>
< 		</div>
< 	</div>
< </div>
< <div v-else class="gqnyydlz">
< 	<a
< 		:href="image.url"
< 		:title="image.name"
< 	>
< 		<ImgWithBlurhash :hash="image.blurhash" :src="url" :alt="image.comment || image.name" :title="image.comment || image.name" :cover="false"/>
< 		<div v-if="image.type === 'image/gif'" class="gif">GIF</div>
< 	</a>
< 	<button v-tooltip="$ts.hide" class="_button hide" @click="hide = true"><i class="ti ti-eye-off"></i></button>
< </div>
---
>   <div v-if="hide" class="qjewsnkg" @click="hide = false">
>     <ImgWithBlurhash
>       class="bg"
>       :hash="image.blurhash"
>       :title="image.comment"
>       :alt="image.comment"
>     />
>     <div class="text">
>       <div class="wrapper">
>         <b style="display: block"
>           ><i class="fas fa-exclamation-triangle"></i> {{ $ts.sensitive }}</b
>         >
>         <span style="display: block">{{ $ts.clickToShow }}</span>
>       </div>
>     </div>
>   </div>
>   <div v-else class="gqnyydlz">
>     <a :href="image.url" :title="image.name">
>       <ImgWithBlurhash
>         :hash="image.blurhash"
>         :src="url"
>         :alt="image.comment"
>         :title="image.comment"
>         :cover="false"
>       />
>       <div v-if="image.type === 'image/gif'" class="gif">GIF</div>
>     </a>
>     <button v-tooltip="$ts.hide" class="_button hide" @click="hide = true">
>       <i class="fas fa-eye-slash"></i>
>     </button>
>   </div>
24,28c36,40
< import { watch } from 'vue';
< import * as misskey from 'misskey-js';
< import { getStaticImageUrl } from '@/scripts/media-proxy';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
< import { defaultStore } from '@/store';
---
> import { watch } from "vue";
> import * as misskey from "misskey-js";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
> import { defaultStore } from "@/store";
31,32c43,44
< 	image: misskey.entities.DriveFile;
< 	raw?: boolean;
---
>   image: misskey.entities.DriveFile;
>   raw?: boolean;
37,41c49,54
< const url = (props.raw || defaultStore.state.loadRawImages)
< 	? props.image.url
< 	: defaultStore.state.disableShowingAnimatedImages
< 		? getStaticImageUrl(props.image.thumbnailUrl)
< 		: props.image.thumbnailUrl;
---
> const url =
>   props.raw || defaultStore.state.loadRawImages
>     ? props.image.url
>     : defaultStore.state.disableShowingAnimatedImages
>     ? getStaticImageUrl(props.image.thumbnailUrl)
>     : props.image.thumbnailUrl;
44,49c57,69
< watch(() => props.image, () => {
< 	hide = (defaultStore.state.nsfw === 'force') ? true : props.image.isSensitive && (defaultStore.state.nsfw !== 'ignore');
< }, {
< 	deep: true,
< 	immediate: true,
< });
---
> watch(
>   () => props.image,
>   () => {
>     hide =
>       defaultStore.state.nsfw === "force"
>         ? true
>         : props.image.isSensitive && defaultStore.state.nsfw !== "ignore";
>   },
>   {
>     deep: true,
>     immediate: true,
>   }
> );
54c74
< 	position: relative;
---
>   position: relative;
56,58c76,78
< 	> .bg {
< 		filter: brightness(0.5);
< 	}
---
>   > .bg {
>     filter: brightness(0.5);
>   }
60,69c80,89
< 	> .text {
< 		position: absolute;
< 		left: 0;
< 		top: 0;
< 		width: 100%;
< 		height: 100%;
< 		z-index: 1;
< 		display: flex;
< 		justify-content: center;
< 		align-items: center;
---
>   > .text {
>     position: absolute;
>     left: 0;
>     top: 0;
>     width: 100%;
>     height: 100%;
>     z-index: 1;
>     display: flex;
>     justify-content: center;
>     align-items: center;
71,77c91,97
< 		> .wrapper {
< 			display: table-cell;
< 			text-align: center;
< 			font-size: 0.8em;
< 			color: #fff;
< 		}
< 	}
---
>     > .wrapper {
>       display: table-cell;
>       text-align: center;
>       font-size: 0.8em;
>       color: #fff;
>     }
>   }
81,83c101,103
< 	position: relative;
< 	//box-shadow: 0 0 0 1px var(--divider) inset;
< 	background: var(--bg);
---
>   position: relative;
>   //box-shadow: 0 0 0 1px var(--divider) inset;
>   background: var(--bg);
85,97c105,117
< 	> .hide {
< 		display: block;
< 		position: absolute;
< 		border-radius: 6px;
< 		background-color: var(--accentedBg);
< 		-webkit-backdrop-filter: var(--blur, blur(15px));
< 		backdrop-filter: var(--blur, blur(15px));
< 		color: var(--accent);
< 		font-size: 0.8em;
< 		padding: 6px 8px;
< 		text-align: center;
< 		top: 12px;
< 		right: 12px;
---
>   > .hide {
>     display: block;
>     position: absolute;
>     border-radius: 6px;
>     background-color: var(--accentedBg);
>     -webkit-backdrop-filter: var(--blur, blur(15px));
>     backdrop-filter: var(--blur, blur(15px));
>     color: var(--accent);
>     font-size: 0.8em;
>     padding: 6px 8px;
>     text-align: center;
>     top: 12px;
>     right: 12px;
99,102c119,122
< 		> i {
< 			display: block;
< 		}
< 	}
---
>     > i {
>       display: block;
>     }
>   }
104,112c124,132
< 	> a {
< 		display: block;
< 		cursor: zoom-in;
< 		overflow: hidden;
< 		width: 100%;
< 		height: 100%;
< 		background-position: center;
< 		background-size: contain;
< 		background-repeat: no-repeat;
---
>   > a {
>     display: block;
>     cursor: zoom-in;
>     overflow: hidden;
>     width: 100%;
>     height: 100%;
>     background-position: center;
>     background-size: contain;
>     background-repeat: no-repeat;
114,128c134,148
< 		> .gif {
< 			background-color: var(--fg);
< 			border-radius: 6px;
< 			color: var(--accentLighten);
< 			display: inline-block;
< 			font-size: 14px;
< 			font-weight: bold;
< 			left: 12px;
< 			opacity: .5;
< 			padding: 0 6px;
< 			text-align: center;
< 			top: 12px;
< 			pointer-events: none;
< 		}
< 	}
---
>     > .gif {
>       background-color: var(--fg);
>       border-radius: 6px;
>       color: var(--accentLighten);
>       display: inline-block;
>       font-size: 14px;
>       font-weight: bold;
>       left: 12px;
>       opacity: 0.5;
>       padding: 0 6px;
>       text-align: center;
>       top: 12px;
>       pointer-events: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMediaList.vue RiricaV13/components/MkMediaList.vue
2,12c2,35
< <div class="hoawjimk">
< 	<XBanner v-for="media in mediaList.filter(media => !previewable(media))" :key="media.id" :media="media"/>
< 	<div v-if="mediaList.filter(media => previewable(media)).length > 0" class="gird-container">
< 		<div ref="gallery" :data-count="mediaList.filter(media => previewable(media)).length">
< 			<template v-for="media in mediaList.filter(media => previewable(media))">
< 				<XVideo v-if="media.type.startsWith('video')" :key="media.id" :video="media"/>
< 				<XImage v-else-if="media.type.startsWith('image')" :key="media.id" class="image" :data-id="media.id" :image="media" :raw="raw"/>
< 			</template>
< 		</div>
< 	</div>
< </div>
---
>   <div class="hoawjimk">
>     <XBanner
>       v-for="media in mediaList.filter((media) => !previewable(media))"
>       :key="media.id"
>       :media="media"
>     />
>     <div
>       v-if="mediaList.filter((media) => previewable(media)).length > 0"
>       class="gird-container"
>     >
>       <div
>         ref="gallery"
>         :data-count="mediaList.filter((media) => previewable(media)).length"
>       >
>         <template
>           v-for="media in mediaList.filter((media) => previewable(media))"
>         >
>           <XVideo
>             v-if="media.type.startsWith('video')"
>             :key="media.id"
>             :video="media"
>           />
>           <XImage
>             v-else-if="media.type.startsWith('image')"
>             :key="media.id"
>             class="image"
>             :data-id="media.id"
>             :image="media"
>             :raw="raw"
>           />
>         </template>
>       </div>
>     </div>
>   </div>
16,26c39,49
< import { onMounted, ref } from 'vue';
< import * as misskey from 'misskey-js';
< import PhotoSwipeLightbox from 'photoswipe/lightbox';
< import PhotoSwipe from 'photoswipe';
< import 'photoswipe/style.css';
< import XBanner from '@/components/MkMediaBanner.vue';
< import XImage from '@/components/MkMediaImage.vue';
< import XVideo from '@/components/MkMediaVideo.vue';
< import * as os from '@/os';
< import { FILE_TYPE_BROWSERSAFE } from '@/const';
< import { defaultStore } from '@/store';
---
> import { onMounted, ref } from "vue";
> import * as misskey from "misskey-js";
> import PhotoSwipeLightbox from "photoswipe/lightbox";
> import PhotoSwipe from "photoswipe";
> import "photoswipe/style.css";
> import XBanner from "@/components/MkMediaBanner.vue";
> import XImage from "@/components/MkMediaImage.vue";
> import XVideo from "@/components/MkMediaVideo.vue";
> import * as os from "@/os";
> import { FILE_TYPE_BROWSERSAFE } from "@/const";
> import { defaultStore } from "@/store";
29,30c52,53
< 	mediaList: misskey.entities.DriveFile[];
< 	raw?: boolean;
---
>   mediaList: misskey.entities.DriveFile[];
>   raw?: boolean;
34c57
< const pswpZIndex = os.claimZIndex('middle');
---
> const pswpZIndex = os.claimZIndex("middle");
37,75c60,105
< 	const lightbox = new PhotoSwipeLightbox({
< 		dataSource: props.mediaList
< 			.filter(media => {
< 				if (media.type === 'image/svg+xml') return true; // svgのwebpublicはpngなのでtrue
< 				return media.type.startsWith('image') && FILE_TYPE_BROWSERSAFE.includes(media.type);
< 			})
< 			.map(media => {
< 				const item = {
< 					src: media.url,
< 					w: media.properties.width,
< 					h: media.properties.height,
< 					alt: media.comment || media.name,
< 					comment: media.comment || media.name,
< 				};
< 				if (media.properties.orientation != null && media.properties.orientation >= 5) {
< 					[item.w, item.h] = [item.h, item.w];
< 				}
< 				return item;
< 			}),
< 		gallery: gallery.value,
< 		children: '.image',
< 		thumbSelector: '.image',
< 		loop: false,
< 		padding: window.innerWidth > 500 ? {
< 			top: 32,
< 			bottom: 32,
< 			left: 32,
< 			right: 32,
< 		} : {
< 			top: 0,
< 			bottom: 0,
< 			left: 0,
< 			right: 0,
< 		},
< 		imageClickAction: 'close',
< 		tapAction: 'toggle-controls',
< 		bgOpacity: 1,
< 		pswpModule: PhotoSwipe,
< 	});
---
>   const lightbox = new PhotoSwipeLightbox({
>     dataSource: props.mediaList
>       .filter((media) => {
>         if (media.type === "image/svg+xml") return true; // svgのwebpublicはpngなのでtrue
>         return (
>           media.type.startsWith("image") &&
>           FILE_TYPE_BROWSERSAFE.includes(media.type)
>         );
>       })
>       .map((media) => {
>         const item = {
>           src: media.url,
>           w: media.properties.width,
>           h: media.properties.height,
>           alt: media.name,
>         };
>         if (
>           media.properties.orientation != null &&
>           media.properties.orientation >= 5
>         ) {
>           [item.w, item.h] = [item.h, item.w];
>         }
>         return item;
>       }),
>     gallery: gallery.value,
>     children: ".image",
>     thumbSelector: ".image",
>     loop: false,
>     padding:
>       window.innerWidth > 500
>         ? {
>             top: 32,
>             bottom: 32,
>             left: 32,
>             right: 32,
>           }
>         : {
>             top: 0,
>             bottom: 0,
>             left: 0,
>             right: 0,
>           },
>     imageClickAction: "close",
>     tapAction: "toggle-controls",
>     pswpModule: PhotoSwipe,
>   });
77,78c107,108
< 	lightbox.on('itemData', (ev) => {
< 		const { itemData } = ev;
---
>   lightbox.on("itemData", (ev) => {
>     const { itemData } = ev;
80,81c110,111
< 		// element is children
< 		const { element } = itemData;
---
>     // element is children
>     const { element } = itemData;
83,84c113,114
< 		const id = element.dataset.id;
< 		const file = props.mediaList.find(media => media.id === id);
---
>     const id = element.dataset.id;
>     const file = props.mediaList.find((media) => media.id === id);
86,96c116,127
< 		itemData.src = file.url;
< 		itemData.w = Number(file.properties.width);
< 		itemData.h = Number(file.properties.height);
< 		if (file.properties.orientation != null && file.properties.orientation >= 5) {
< 			[itemData.w, itemData.h] = [itemData.h, itemData.w];
< 		}
< 		itemData.msrc = file.thumbnailUrl;
< 		itemData.alt = file.comment || file.name;
< 		itemData.comment = file.comment || file.name;
< 		itemData.thumbCropped = true;
< 	});
---
>     itemData.src = file.url;
>     itemData.w = Number(file.properties.width);
>     itemData.h = Number(file.properties.height);
>     if (
>       file.properties.orientation != null &&
>       file.properties.orientation >= 5
>     ) {
>       [itemData.w, itemData.h] = [itemData.h, itemData.w];
>     }
>     itemData.msrc = file.thumbnailUrl;
>     itemData.thumbCropped = true;
>   });
98,115c129
< 	lightbox.on('uiRegister', () => {
< 		lightbox.pswp.ui.registerElement({
< 			name: 'altText',
< 			className: 'pwsp__alt-text-container',
< 			appendTo: 'wrapper',
< 			onInit: (el, pwsp) => {
< 				let textBox = document.createElement('p');
< 				textBox.className = 'pwsp__alt-text _acrylic';
< 				el.appendChild(textBox);
< 
< 				pwsp.on('change', (a) => {
< 					textBox.textContent = pwsp.currSlide.data.comment;
< 				});
< 			},
< 		});
< 	});
< 
< 	lightbox.init();
---
>   lightbox.init();
119,121c133,138
< 	if (file.type === 'image/svg+xml') return true; // svgのwebpublic/thumbnailはpngなのでtrue
< 	// FILE_TYPE_BROWSERSAFEに適合しないものはブラウザで表示するのに不適切
< 	return (file.type.startsWith('video') || file.type.startsWith('image')) && FILE_TYPE_BROWSERSAFE.includes(file.type);
---
>   if (file.type === "image/svg+xml") return true; // svgのwebpublic/thumbnailはpngなのでtrue
>   // FILE_TYPE_BROWSERSAFEに適合しないものはブラウザで表示するのに不適切
>   return (
>     (file.type.startsWith("video") || file.type.startsWith("image")) &&
>     FILE_TYPE_BROWSERSAFE.includes(file.type)
>   );
127,130c144,147
< 	> .gird-container {
< 		position: relative;
< 		width: 100%;
< 		margin-top: 4px;
---
>   > .gird-container {
>     position: relative;
>     width: 100%;
>     margin-top: 4px;
132,136c149,153
< 		&:before {
< 			content: '';
< 			display: block;
< 			padding-top: 56.25% // 16:9;
< 		}
---
>     &:before {
>       content: "";
>       display: block;
>       padding-top: 56.25%; // 16:9;
>     }
138,145c155,162
< 		> div {
< 			position: absolute;
< 			top: 0;
< 			right: 0;
< 			bottom: 0;
< 			left: 0;
< 			display: grid;
< 			grid-gap: 8px;
---
>     > div {
>       position: absolute;
>       top: 0;
>       right: 0;
>       bottom: 0;
>       left: 0;
>       display: grid;
>       grid-gap: 8px;
147,150c164,167
< 			> * {
< 				overflow: hidden;
< 				border-radius: 6px;
< 			}
---
>       > * {
>         overflow: hidden;
>         border-radius: 6px;
>       }
152,154c169,171
< 			&[data-count="1"] {
< 				grid-template-rows: 1fr;
< 			}
---
>       &[data-count="1"] {
>         grid-template-rows: 1fr;
>       }
156,159c173,176
< 			&[data-count="2"] {
< 				grid-template-columns: 1fr 1fr;
< 				grid-template-rows: 1fr;
< 			}
---
>       &[data-count="2"] {
>         grid-template-columns: 1fr 1fr;
>         grid-template-rows: 1fr;
>       }
161,163c178,180
< 			&[data-count="3"] {
< 				grid-template-columns: 1fr 0.5fr;
< 				grid-template-rows: 1fr 1fr;
---
>       &[data-count="3"] {
>         grid-template-columns: 1fr 0.5fr;
>         grid-template-rows: 1fr 1fr;
165,167c182,184
< 				> *:nth-child(1) {
< 					grid-row: 1 / 3;
< 				}
---
>         > *:nth-child(1) {
>           grid-row: 1 / 3;
>         }
169,173c186,190
< 				> *:nth-child(3) {
< 					grid-column: 2 / 3;
< 					grid-row: 2 / 3;
< 				}
< 			}
---
>         > *:nth-child(3) {
>           grid-column: 2 / 3;
>           grid-row: 2 / 3;
>         }
>       }
175,178c192,195
< 			&[data-count="4"] {
< 				grid-template-columns: 1fr 1fr;
< 				grid-template-rows: 1fr 1fr;
< 			}
---
>       &[data-count="4"] {
>         grid-template-columns: 1fr 1fr;
>         grid-template-rows: 1fr 1fr;
>       }
180,183c197,200
< 			> *:nth-child(1) {
< 				grid-column: 1 / 2;
< 				grid-row: 1 / 2;
< 			}
---
>       > *:nth-child(1) {
>         grid-column: 1 / 2;
>         grid-row: 1 / 2;
>       }
185,188c202,205
< 			> *:nth-child(2) {
< 				grid-column: 2 / 3;
< 				grid-row: 1 / 2;
< 			}
---
>       > *:nth-child(2) {
>         grid-column: 2 / 3;
>         grid-row: 1 / 2;
>       }
190,193c207,210
< 			> *:nth-child(3) {
< 				grid-column: 1 / 2;
< 				grid-row: 2 / 3;
< 			}
---
>       > *:nth-child(3) {
>         grid-column: 1 / 2;
>         grid-row: 2 / 3;
>       }
195,200c212,217
< 			> *:nth-child(4) {
< 				grid-column: 2 / 3;
< 				grid-row: 2 / 3;
< 			}
< 		}
< 	}
---
>       > *:nth-child(4) {
>         grid-column: 2 / 3;
>         grid-row: 2 / 3;
>       }
>     }
>   }
206c223
< 	// なぜか機能しない
---
>   // なぜか機能しない
208,239c225
< 	z-index: 2000000;
< 	--pswp-bg: var(--modalBg);
< }
< 
< .pswp__bg {
< 	background: var(--modalBg);
< 	backdrop-filter: var(--modalBgFilter);
< }
< 
< .pwsp__alt-text-container {
< 	display: flex;
< 	flex-direction: row;
< 	align-items: center;
< 
< 	position: absolute;
< 	bottom: 30px;
< 	left: 50%;
< 	transform: translateX(-50%);
< 
< 	width: 75%;
< 	max-width: 800px;
< }
< 
< .pwsp__alt-text {
< 	color: var(--fg);
< 	margin: 0 auto;
< 	text-align: center;
< 	padding: var(--margin);
< 	border-radius: var(--radius);
< 	max-height: 8em;
< 	overflow-y: auto;
< 	text-shadow: var(--bg) 0 0 10px, var(--bg) 0 0 3px, var(--bg) 0 0 3px;
---
>   z-index: 2000000;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMediaVideo.vue RiricaV13/components/MkMediaVideo.vue
2,23c2,24
< <div v-if="hide" class="icozogqfvdetwohsdglrbswgrejoxbdj" @click="hide = false">
< 	<div>
< 		<b><i class="ti ti-alert-triangle"></i> {{ $ts.sensitive }}</b>
< 		<span>{{ $ts.clickToShow }}</span>
< 	</div>
< </div>
< <div v-else class="kkjnbbplepmiyuadieoenjgutgcmtsvu">
< 	<video
< 		:poster="video.thumbnailUrl"
< 		:title="video.comment"
< 		:alt="video.comment"
< 		preload="none"
< 		controls
< 		@contextmenu.stop
< 	>
< 		<source 
< 			:src="video.url" 
< 			:type="video.type"
< 		>
< 	</video>
< 	<i class="ti ti-eye-off" @click="hide = true"></i>
< </div>
---
>   <div
>     v-if="hide"
>     class="icozogqfvdetwohsdglrbswgrejoxbdj"
>     @click="hide = false"
>   >
>     <div>
>       <b><i class="fas fa-exclamation-triangle"></i> {{ $ts.sensitive }}</b>
>       <span>{{ $ts.clickToShow }}</span>
>     </div>
>   </div>
>   <div v-else class="kkjnbbplepmiyuadieoenjgutgcmtsvu">
>     <video
>       :poster="video.thumbnailUrl"
>       :title="video.comment"
>       :alt="video.comment"
>       preload="none"
>       controls
>       @contextmenu.stop
>     >
>       <source :src="video.url" :type="video.type" />
>     </video>
>     <i class="fas fa-eye-slash" @click="hide = true"></i>
>   </div>
27,29c28,30
< import { ref } from 'vue';
< import * as misskey from 'misskey-js';
< import { defaultStore } from '@/store';
---
> import { ref } from "vue";
> import * as misskey from "misskey-js";
> import { defaultStore } from "@/store";
32c33
< 	video: misskey.entities.DriveFile;
---
>   video: misskey.entities.DriveFile;
35c36,40
< const hide = ref((defaultStore.state.nsfw === 'force') ? true : props.video.isSensitive && (defaultStore.state.nsfw !== 'ignore'));
---
> const hide = ref(
>   defaultStore.state.nsfw === "force"
>     ? true
>     : props.video.isSensitive && defaultStore.state.nsfw !== "ignore"
> );
40c45
< 	position: relative;
---
>   position: relative;
42,55c47,60
< 	> i {
< 		display: block;
< 		position: absolute;
< 		border-radius: 6px;
< 		background-color: var(--fg);
< 		color: var(--accentLighten);
< 		font-size: 14px;
< 		opacity: .5;
< 		padding: 3px 6px;
< 		text-align: center;
< 		cursor: pointer;
< 		top: 12px;
< 		right: 12px;
< 	}
---
>   > i {
>     display: block;
>     position: absolute;
>     border-radius: 6px;
>     background-color: var(--fg);
>     color: var(--accentLighten);
>     font-size: 14px;
>     opacity: 0.5;
>     padding: 3px 6px;
>     text-align: center;
>     cursor: pointer;
>     top: 12px;
>     right: 12px;
>   }
57,60c62,65
< 	> video {
< 		display: flex;
< 		justify-content: center;
< 		align-items: center;
---
>   > video {
>     display: flex;
>     justify-content: center;
>     align-items: center;
62,68c67,73
< 		font-size: 3.5em;
< 		overflow: hidden;
< 		background-position: center;
< 		background-size: cover;
< 		width: 100%;
< 		height: 100%;
< 	}
---
>     font-size: 3.5em;
>     overflow: hidden;
>     background-position: center;
>     background-size: cover;
>     width: 100%;
>     height: 100%;
>   }
72,76c77,81
< 	display: flex;
< 	justify-content: center;
< 	align-items: center;
< 	background: #111;
< 	color: #fff;
---
>   display: flex;
>   justify-content: center;
>   align-items: center;
>   background: #111;
>   color: #fff;
78,81c83,86
< 	> div {
< 		display: table-cell;
< 		text-align: center;
< 		font-size: 12px;
---
>   > div {
>     display: table-cell;
>     text-align: center;
>     font-size: 12px;
83,86c88,91
< 		> b {
< 			display: block;
< 		}
< 	}
---
>     > b {
>       display: block;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMention.vue RiricaV13/components/MkMention.vue
2,8c2,30
< <MkA v-user-preview="canonical" :class="[$style.root, { [$style.isMe]: isMe }]" :to="url" :style="{ background: bgCss }">
< 	<img :class="$style.icon" :src="`/avatar/@${username}@${host}`" alt="">
< 	<span>
< 		<span :class="$style.username">@{{ username }}</span>
< 		<span v-if="(host != localHost) || $store.state.showFullAcct" :class="$style.host">@{{ toUnicode(host) }}</span>
< 	</span>
< </MkA>
---
>   <MkA
>     v-if="url.startsWith('/')"
>     v-user-preview="canonical"
>     class="akbvjaqn"
>     :class="{ isMe }"
>     :to="url"
>     :style="{ background: bgCss }"
>   >
>     <img class="icon" :src="`${uri}/avatar/@${avatarSite}`" alt="" />
>     <span class="main">
>       <span class="username">@{{ username }}</span>
>       <span v-if="host != localHost || $store.state.showFullAcct" class="host"
>         >@{{ toUnicode(host) }}</span
>       >
>     </span>
>   </MkA>
>   <a
>     v-else
>     class="akbvjaqn"
>     :href="url"
>     target="_blank"
>     rel="noopener"
>     :style="{ background: bgCss }"
>   >
>     <span class="main">
>       <span class="username">@{{ username }}</span>
>       <span class="host">@{{ toUnicode(host) }}</span>
>     </span>
>   </a>
12,16c34,38
< import { toUnicode } from 'punycode';
< import { } from 'vue';
< import tinycolor from 'tinycolor2';
< import { host as localHost } from '@/config';
< import { $i } from '@/account';
---
> import { toUnicode } from "punycode";
> import {} from "vue";
> import tinycolor from "tinycolor2";
> import { host as localHost } from "@/config";
> import { $i } from "@/account";
19,20c41,42
< 	username: string;
< 	host: string;
---
>   username: string;
>   host: string;
21a44
> const uri = JSON.parse(localStorage.getItem("instance")).uri
23c46,49
< const canonical = props.host === localHost ? `@${props.username}` : `@${props.username}@${toUnicode(props.host)}`;
---
> const canonical =
>   props.host === localHost
>     ? `@${props.username}`
>     : `@${props.username}@${toUnicode(props.host)}`;
24a51,54
> const avatarSite = props.host === localHost
>   ? `@${props.username}@${toUnicode(uri.replace("https://", ""))}`
>   : `@${props.username}@${toUnicode(props.host)}`;
> 
27,29c57,60
< const isMe = $i && (
< 	`@${props.username}@${toUnicode(props.host)}` === `@${$i.username}@${toUnicode(localHost)}`.toLowerCase()
< );
---
> const isMe =
>   $i &&
>   `@${props.username}@${toUnicode(props.host)}` ===
>     `@${$i.username}@${toUnicode(localHost)}`.toLowerCase();
31c62,66
< const bg = tinycolor(getComputedStyle(document.documentElement).getPropertyValue(isMe ? '--mentionMe' : '--mention'));
---
> const bg = tinycolor(
>   getComputedStyle(document.documentElement).getPropertyValue(
>     isMe ? "--mentionMe" : "--mention"
>   )
> );
36,41c71,76
< <style lang="scss" module>
< .root {
< 	display: inline-block;
< 	padding: 4px 8px 4px 4px;
< 	border-radius: 999px;
< 	color: var(--mention);
---
> <style lang="scss" scoped>
> .akbvjaqn {
>   display: inline-block;
>   padding: 4px 8px 4px 4px;
>   border-radius: 999px;
>   color: var(--mention);
43,46c78,80
< 	&.isMe {
< 		color: var(--mentionMe);
< 	}
< }
---
>   &.isMe {
>     color: var(--mentionMe);
>   }
48,55c82,89
< .icon {
< 	width: 1.5em;
< 	height: 1.5em;
< 	object-fit: cover;
< 	margin: 0 0.2em 0 0;
< 	vertical-align: bottom;
< 	border-radius: 100%;
< }
---
>   > .icon {
>     width: 1.5em;
>     height: 1.5em;
>     object-fit: cover;
>     margin: 0 0.2em 0 0;
>     vertical-align: bottom;
>     border-radius: 100%;
>   }
57,58c91,93
< .host {
< 	opacity: 0.5;
---
>   > .main > .host {
>     opacity: 0.5;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMenu.child.vue RiricaV13/components/MkMenu.child.vue
2,4c2,11
< <div ref="el" class="sfhdhdhr">
< 	<MkMenu ref="menu" :items="items" :align="align" :width="width" :as-drawer="false" @close="onChildClosed"/>
< </div>
---
>   <div ref="el" class="sfhdhdhr">
>     <MkMenu
>       ref="menu"
>       :items="items"
>       :align="align"
>       :width="width"
>       :as-drawer="false"
>       @close="onChildClosed"
>     />
>   </div>
8,12c15,26
< import { on } from 'events';
< import { nextTick, onBeforeUnmount, onMounted, onUnmounted, ref, shallowRef, watch } from 'vue';
< import MkMenu from './MkMenu.vue';
< import { MenuItem } from '@/types/menu';
< import * as os from '@/os';
---
> import { on } from "events";
> import {
>   nextTick,
>   onBeforeUnmount,
>   onMounted,
>   onUnmounted,
>   ref,
>   watch,
> } from "vue";
> import MkMenu from "./MkMenu.vue";
> import { MenuItem } from "@/types/menu";
> import * as os from "@/os";
15,19c29,33
< 	items: MenuItem[];
< 	targetElement: HTMLElement;
< 	rootElement: HTMLElement;
< 	width?: number;
< 	viaKeyboard?: boolean;
---
>   items: MenuItem[];
>   targetElement: HTMLElement;
>   rootElement: HTMLElement;
>   width?: number;
>   viaKeyboard?: boolean;
23,24c37,38
< 	(ev: 'closed'): void;
< 	(ev: 'actioned'): void;
---
>   (ev: "closed"): void;
>   (ev: "actioned"): void;
27,28c41,42
< const el = shallowRef<HTMLElement>();
< const align = 'left';
---
> const el = ref<HTMLElement>();
> const align = "left";
31,36c45,50
< 	const rootRect = props.rootElement.getBoundingClientRect();
< 	const rect = props.targetElement.getBoundingClientRect();
< 	const left = props.targetElement.offsetWidth;
< 	const top = (rect.top - rootRect.top) - 8;
< 	el.value.style.left = left + 'px';
< 	el.value.style.top = top + 'px';
---
>   const rootRect = props.rootElement.getBoundingClientRect();
>   const rect = props.targetElement.getBoundingClientRect();
>   const left = props.targetElement.offsetWidth;
>   const top = rect.top - rootRect.top - 8;
>   el.value.style.left = left + "px";
>   el.value.style.top = top + "px";
40,44c54,58
< 	if (actioned) {
< 		emit('actioned');
< 	} else {
< 		emit('closed');
< 	}
---
>   if (actioned) {
>     emit("actioned");
>   } else {
>     emit("closed");
>   }
47,50d60
< watch(() => props.targetElement, () => {
< 	setPosition();
< });
< 
52,55c62,65
< 	setPosition();
< 	nextTick(() => {
< 		setPosition();
< 	});
---
>   setPosition();
>   nextTick(() => {
>     setPosition();
>   });
59,61c69,71
< 	checkHit: (ev: MouseEvent) => {
< 		return (ev.target === el.value || el.value.contains(ev.target));
< 	},
---
>   checkHit: (ev: MouseEvent) => {
>     return ev.target === el.value || el.value.contains(ev.target);
>   },
67c77
< 	position: absolute;
---
>   position: absolute;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMenu.vue RiricaV13/components/MkMenu.vue
2,55c2,134
< <div>
< 	<div
< 		ref="itemsEl" v-hotkey="keymap"
< 		class="_popup _shadow"
< 		:class="[$style.root, { [$style.center]: align === 'center', [$style.asDrawer]: asDrawer }]"
< 		:style="{ width: (width && !asDrawer) ? width + 'px' : '', maxHeight: maxHeight ? maxHeight + 'px' : '' }"
< 		@contextmenu.self="e => e.preventDefault()"
< 	>
< 		<template v-for="(item, i) in items2">
< 			<div v-if="item === null" :class="$style.divider"></div>
< 			<span v-else-if="item.type === 'label'" :class="[$style.label, $style.item]">
< 				<span>{{ item.text }}</span>
< 			</span>
< 			<span v-else-if="item.type === 'pending'" :tabindex="i" :class="[$style.pending, $style.item]">
< 				<span><MkEllipsis/></span>
< 			</span>
< 			<MkA v-else-if="item.type === 'link'" :to="item.to" :tabindex="i" class="_button" :class="$style.item" @click.passive="close(true)" @mouseenter.passive="onItemMouseEnter(item)" @mouseleave.passive="onItemMouseLeave(item)">
< 				<i v-if="item.icon" class="ti-fw" :class="[$style.icon, item.icon]"></i>
< 				<MkAvatar v-if="item.avatar" :user="item.avatar" :class="$style.avatar"/>
< 				<span>{{ item.text }}</span>
< 				<span v-if="item.indicate" :class="$style.indicator"><i class="_indicatorCircle"></i></span>
< 			</MkA>
< 			<a v-else-if="item.type === 'a'" :href="item.href" :target="item.target" :download="item.download" :tabindex="i" class="_button" :class="$style.item" @click="close(true)" @mouseenter.passive="onItemMouseEnter(item)" @mouseleave.passive="onItemMouseLeave(item)">
< 				<i v-if="item.icon" class="ti-fw" :class="[$style.icon, item.icon]"></i>
< 				<span>{{ item.text }}</span>
< 				<span v-if="item.indicate" :class="$style.indicator"><i class="_indicatorCircle"></i></span>
< 			</a>
< 			<button v-else-if="item.type === 'user'" :tabindex="i" class="_button" :class="[$style.item, { [$style.active]: item.active }]" :disabled="item.active" @click="clicked(item.action, $event)" @mouseenter.passive="onItemMouseEnter(item)" @mouseleave.passive="onItemMouseLeave(item)">
< 				<MkAvatar :user="item.user" :class="$style.avatar"/><MkUserName :user="item.user"/>
< 				<span v-if="item.indicate" :class="$style.indicator"><i class="_indicatorCircle"></i></span>
< 			</button>
< 			<span v-else-if="item.type === 'switch'" :tabindex="i" :class="$style.item" @mouseenter.passive="onItemMouseEnter(item)" @mouseleave.passive="onItemMouseLeave(item)">
< 				<MkSwitch v-model="item.ref" :disabled="item.disabled" class="form-switch">{{ item.text }}</MkSwitch>
< 			</span>
< 			<button v-else-if="item.type === 'parent'" :tabindex="i" class="_button" :class="[$style.item, $style.parent, { [$style.childShowing]: childShowingItem === item }]" @mouseenter="showChildren(item, $event)">
< 				<i v-if="item.icon" class="ti-fw" :class="[$style.icon, item.icon]"></i>
< 				<span>{{ item.text }}</span>
< 				<span :class="$style.caret"><i class="ti ti-caret-right ti-fw"></i></span>
< 			</button>
< 			<button v-else :tabindex="i" class="_button" :class="[$style.item, { [$style.danger]: item.danger, [$style.active]: item.active }]" :disabled="item.active" @click="clicked(item.action, $event)" @mouseenter.passive="onItemMouseEnter(item)" @mouseleave.passive="onItemMouseLeave(item)">
< 				<i v-if="item.icon" class="ti-fw" :class="[$style.icon, item.icon]"></i>
< 				<MkAvatar v-if="item.avatar" :user="item.avatar" :class="$style.avatar"/>
< 				<span>{{ item.text }}</span>
< 				<span v-if="item.indicate" :class="$style.indicator"><i class="_indicatorCircle"></i></span>
< 			</button>
< 		</template>
< 		<span v-if="items2.length === 0" :class="[$style.none, $style.item]">
< 			<span>{{ i18n.ts.none }}</span>
< 		</span>
< 	</div>
< 	<div v-if="childMenu" :class="$style.child">
< 		<XChild ref="child" :items="childMenu" :target-element="childTarget" :root-element="itemsEl" showing @actioned="childActioned"/>
< 	</div>
< </div>
---
>   <div>
>     <div
>       ref="itemsEl"
>       v-hotkey="keymap"
>       class="rrevdjwt _popup _shadow"
>       :class="{ center: align === 'center', asDrawer }"
>       :style="{
>         width: width && !asDrawer ? width + 'px' : '',
>         maxHeight: maxHeight ? maxHeight + 'px' : '',
>       }"
>       @contextmenu.self="(e) => e.preventDefault()"
>     >
>       <template v-for="(item, i) in items2">
>         <div v-if="item === null" class="divider"></div>
>         <span v-else-if="item.type === 'label'" class="label item">
>           <span>{{ item.text }}</span>
>         </span>
>         <span
>           v-else-if="item.type === 'pending'"
>           :tabindex="i"
>           class="pending item"
>         >
>           <span><MkEllipsis /></span>
>         </span>
>         <MkA
>           v-else-if="item.type === 'link'"
>           :to="item.to"
>           :tabindex="i"
>           class="_button item"
>           @click.passive="close(true)"
>           @mouseenter.passive="onItemMouseEnter(item)"
>           @mouseleave.passive="onItemMouseLeave(item)"
>         >
>           <i v-if="item.icon" class="fa-fw" :class="item.icon"></i>
>           <MkAvatar v-if="item.avatar" :user="item.avatar" class="avatar" />
>           <span>{{ item.text }}</span>
>           <span v-if="item.indicate" class="indicator"
>             ><i class="fas fa-circle"></i
>           ></span>
>         </MkA>
>         <a
>           v-else-if="item.type === 'a'"
>           :href="item.href"
>           :target="item.target"
>           :download="item.download"
>           :tabindex="i"
>           class="_button item"
>           @click="close(true)"
>           @mouseenter.passive="onItemMouseEnter(item)"
>           @mouseleave.passive="onItemMouseLeave(item)"
>         >
>           <i v-if="item.icon" class="fa-fw" :class="item.icon"></i>
>           <span>{{ item.text }}</span>
>           <span v-if="item.indicate" class="indicator"
>             ><i class="fas fa-circle"></i
>           ></span>
>         </a>
>         <button
>           v-else-if="item.type === 'user'"
>           :tabindex="i"
>           class="_button item"
>           :class="{ active: item.active }"
>           :disabled="item.active"
>           @click="clicked(item.action, $event)"
>           @mouseenter.passive="onItemMouseEnter(item)"
>           @mouseleave.passive="onItemMouseLeave(item)"
>         >
>           <MkAvatar :user="item.user" class="avatar" /><MkUserName
>             :user="item.user"
>           />
>           [{{ item.user.host }}]
>           <span v-if="item.indicate" class="indicator"
>             ><i class="fas fa-circle"></i
>           ></span>
>         </button>
>         <span
>           v-else-if="item.type === 'switch'"
>           :tabindex="i"
>           class="item"
>           @mouseenter.passive="onItemMouseEnter(item)"
>           @mouseleave.passive="onItemMouseLeave(item)"
>         >
>           <FormSwitch
>             v-model="item.ref"
>             :disabled="item.disabled"
>             class="form-switch"
>             >{{ item.text }}</FormSwitch
>           >
>         </span>
>         <button
>           v-else-if="item.type === 'parent'"
>           :tabindex="i"
>           class="_button item parent"
>           :class="{ childShowing: childShowingItem === item }"
>           @mouseenter="showChildren(item, $event)"
>         >
>           <i v-if="item.icon" class="fa-fw" :class="item.icon"></i>
>           <span>{{ item.text }}</span>
>           <span class="caret"><i class="fas fa-caret-right fa-fw"></i></span>
>         </button>
>         <button
>           v-else
>           :tabindex="i"
>           class="_button item"
>           :class="{ danger: item.danger, active: item.active }"
>           :disabled="item.active"
>           @click="clicked(item.action, $event)"
>           @mouseenter.passive="onItemMouseEnter(item)"
>           @mouseleave.passive="onItemMouseLeave(item)"
>         >
>           <i v-if="item.icon" class="fa-fw" :class="item.icon"></i>
>           <MkAvatar v-if="item.avatar" :user="item.avatar" class="avatar" />
>           <span>{{ item.text }}</span>
>           <span v-if="item.indicate" class="indicator"
>             ><i class="fas fa-circle"></i
>           ></span>
>         </button>
>       </template>
>       <span v-if="items2.length === 0" class="none item">
>         <span>{{ i18n.ts.none }}</span>
>       </span>
>     </div>
>     <div v-if="childMenu" class="child">
>       <XChild
>         ref="child"
>         :items="childMenu"
>         :target-element="childTarget"
>         :root-element="itemsEl"
>         showing
>         @actioned="childActioned"
>       />
>     </div>
>   </div>
59,64c138,152
< import { defineAsyncComponent, nextTick, onBeforeUnmount, onMounted, onUnmounted, Ref, ref, watch } from 'vue';
< import { focusPrev, focusNext } from '@/scripts/focus';
< import MkSwitch from '@/components/MkSwitch.vue';
< import { MenuItem, InnerMenuItem, MenuPending, MenuAction } from '@/types/menu';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import {
>   defineAsyncComponent,
>   nextTick,
>   onBeforeUnmount,
>   onMounted,
>   onUnmounted,
>   Ref,
>   ref,
>   watch,
> } from "vue";
> import { focusPrev, focusNext } from "@/scripts/focus";
> import FormSwitch from "@/components/form/switch.vue";
> import { MenuItem, InnerMenuItem, MenuPending, MenuAction } from "@/types/menu";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
66c154
< const XChild = defineAsyncComponent(() => import('./MkMenu.child.vue'));
---
> const XChild = defineAsyncComponent(() => import("./MkMenu.child.vue"));
69,74c157,162
< 	items: MenuItem[];
< 	viaKeyboard?: boolean;
< 	asDrawer?: boolean;
< 	align?: 'center' | string;
< 	width?: number;
< 	maxHeight?: number;
---
>   items: MenuItem[];
>   viaKeyboard?: boolean;
>   asDrawer?: boolean;
>   align?: "center" | string;
>   width?: number;
>   maxHeight?: number;
78c166
< 	(ev: 'close', actioned?: boolean): void;
---
>   (ev: "close", actioned?: boolean): void;
81c169
< let itemsEl = $shallowRef<HTMLDivElement>();
---
> let itemsEl = $ref<HTMLDivElement>();
85c173
< let child = $shallowRef<InstanceType<typeof XChild>>();
---
> let child = $ref<InstanceType<typeof XChild>>();
88,90c176,178
< 	'up|k|shift+tab': focusUp,
< 	'down|j|tab': focusDown,
< 	'esc': close,
---
>   "up|k|shift+tab": focusUp,
>   "down|j|tab": focusDown,
>   esc: close,
95,96c183,188
< watch(() => props.items, () => {
< 	const items: (MenuItem | MenuPending)[] = [...props.items].filter(item => item !== undefined);
---
> watch(
>   () => props.items,
>   () => {
>     const items: (MenuItem | MenuPending)[] = [...props.items].filter(
>       (item) => item !== undefined
>     );
98,99c190,191
< 	for (let i = 0; i < items.length; i++) {
< 		const item = items[i];
---
>     for (let i = 0; i < items.length; i++) {
>       const item = items[i];
101,107d192
< 		if (item && 'then' in item) { // if item is Promise
< 			items[i] = { type: 'pending' };
< 			item.then(actualItem => {
< 				items2[i] = actualItem;
< 			});
< 		}
< 	}
109,112c194,201
< 	items2 = items as InnerMenuItem[];
< }, {
< 	immediate: true,
< });
---
>       if (item && "then" in item) {
>         // if item is Promise
>         items[i] = { type: "pending" };
>         item.then((actualItem) => {
>           items2[i] = actualItem;
>         });
>       }
>     }
113a203,209
>     items2 = items as InnerMenuItem[];
>   },
>   {
>     immediate: true,
>   }
> );
> 
115c211
< let childTarget = $shallowRef<HTMLElement | null>();
---
> let childTarget = $ref<HTMLElement | null>();
118,119c214,215
< 	childMenu = null;
< 	childShowingItem = null;
---
>   childMenu = null;
>   childShowingItem = null;
123,124c219,220
< 	closeChild();
< 	close(true);
---
>   closeChild();
>   close(true);
128,130c224,230
< 	if (childTarget && (event.target === childTarget || childTarget.contains(event.target))) return;
< 	if (child && child.checkHit(event)) return;
< 	closeChild();
---
>   if (
>     childTarget &&
>     (event.target === childTarget || childTarget.contains(event.target))
>   )
>     return;
>   if (child && child.checkHit(event)) return;
>   closeChild();
135,137c235,237
< 	childCloseTimer = window.setTimeout(() => {
< 		closeChild();
< 	}, 300);
---
>   childCloseTimer = window.setTimeout(() => {
>     closeChild();
>   }, 300);
140c240
< 	if (childCloseTimer) window.clearTimeout(childCloseTimer);
---
>   if (childCloseTimer) window.clearTimeout(childCloseTimer);
144,151c244,251
< 	if (props.asDrawer) {
< 		os.popupMenu(item.children, ev.currentTarget ?? ev.target);
< 		close();
< 	} else {
< 		childTarget = ev.currentTarget ?? ev.target;
< 		childMenu = item.children;
< 		childShowingItem = item;
< 	}
---
>   if (props.asDrawer) {
>     os.popupMenu(item.children, ev.currentTarget ?? ev.target);
>     close();
>   } else {
>     childTarget = ev.currentTarget ?? ev.target;
>     childMenu = item.children;
>     childShowingItem = item;
>   }
155,156c255,256
< 	fn(ev);
< 	close(true);
---
>   fn(ev);
>   close(true);
160c260
< 	emit('close', actioned);
---
>   emit("close", actioned);
164c264
< 	focusPrev(document.activeElement);
---
>   focusPrev(document.activeElement);
168c268
< 	focusNext(document.activeElement);
---
>   focusNext(document.activeElement);
172,176c272,276
< 	if (props.viaKeyboard) {
< 		nextTick(() => {
< 			focusNext(itemsEl.children[0], true, false);
< 		});
< 	}
---
>   if (props.viaKeyboard) {
>     nextTick(() => {
>       focusNext(itemsEl.children[0], true, false);
>     });
>   }
178,181c278
< 	// TODO: アクティブな要素までスクロール
< 	//itemsEl.scrollTo();
< 
< 	document.addEventListener('mousedown', onGlobalMousedown, { passive: true });
---
>   document.addEventListener("mousedown", onGlobalMousedown, { passive: true });
185c282
< 	document.removeEventListener('mousedown', onGlobalMousedown);
---
>   document.removeEventListener("mousedown", onGlobalMousedown);
189,195c286,292
< <style lang="scss" module>
< .root {
< 	padding: 8px 0;
< 	box-sizing: border-box;
< 	min-width: 200px;
< 	overflow: auto;
< 	overscroll-behavior: contain;
---
> <style lang="scss" scoped>
> .rrevdjwt {
>   padding: 8px 0;
>   box-sizing: border-box;
>   min-width: 200px;
>   overflow: auto;
>   overscroll-behavior: contain;
197,201c294,298
< 	&.center {
< 		> .item {
< 			text-align: center;
< 		}
< 	}
---
>   &.center {
>     > .item {
>       text-align: center;
>     }
>   }
203,208c300,311
< 	&.asDrawer {
< 		padding: 12px 0 max(env(safe-area-inset-bottom, 0px), 12px) 0;
< 		width: 100%;
< 		border-radius: 24px;
< 		border-bottom-right-radius: 0;
< 		border-bottom-left-radius: 0;
---
>   > .item {
>     display: block;
>     position: relative;
>     padding: 6px 16px;
>     width: 100%;
>     box-sizing: border-box;
>     white-space: nowrap;
>     font-size: 0.9em;
>     line-height: 20px;
>     text-align: left;
>     overflow: hidden;
>     text-overflow: ellipsis;
210,212c313,324
< 		> .item {
< 			font-size: 1em;
< 			padding: 12px 24px;
---
>     &:before {
>       content: "";
>       display: block;
>       position: absolute;
>       top: 0;
>       left: 0;
>       right: 0;
>       margin: auto;
>       width: calc(100% - 16px);
>       height: 100%;
>       border-radius: 6px;
>     }
214,217c326,328
< 			&:before {
< 				width: calc(100% - 24px);
< 				border-radius: 12px;
< 			}
---
>     > * {
>       position: relative;
>     }
219,223c330,332
< 			> .icon {
< 				margin-right: 14px;
< 				width: 24px;
< 			}
< 		}
---
>     &:not(:disabled):hover {
>       color: var(--accent);
>       text-decoration: none;
225,229c334,337
< 		> .divider {
< 			margin: 12px 0;
< 		}
< 	}
< }
---
>       &:before {
>         background: var(--accentedBg);
>       }
>     }
231,242c339,340
< .item {
< 	display: block;
< 	position: relative;
< 	padding: 5px 16px;
< 	width: 100%;
< 	box-sizing: border-box;
< 	white-space: nowrap;
< 	font-size: 0.9em;
< 	line-height: 20px;
< 	text-align: left;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
---
>     &.danger {
>       color: #ff2a2a;
244,256c342,343
< 	&:before {
< 		content: "";
< 		display: block;
< 		position: absolute;
< 		z-index: -1;
< 		top: 0;
< 		left: 0;
< 		right: 0;
< 		margin: auto;
< 		width: calc(100% - 16px);
< 		height: 100%;
< 		border-radius: 6px;
< 	}
---
>       &:hover {
>         color: #fff;
258,260c345,348
< 	&:not(:disabled):hover {
< 		color: var(--accent);
< 		text-decoration: none;
---
>         &:before {
>           background: #ff4242;
>         }
>       }
262,265c350,351
< 		&:before {
< 			background: var(--accentedBg);
< 		}
< 	}
---
>       &:active {
>         color: #fff;
267,268c353,357
< 	&.danger {
< 		color: #ff2a2a;
---
>         &:before {
>           background: #d42e2e;
>         }
>       }
>     }
270,271c359,361
< 		&:hover {
< 			color: #fff;
---
>     &.active {
>       color: var(--fgOnAccent);
>       opacity: 1;
273,276c363,366
< 			&:before {
< 				background: #ff4242;
< 			}
< 		}
---
>       &:before {
>         background: var(--accent);
>       }
>     }
278,279c368,370
< 		&:active {
< 			color: #fff;
---
>     &:not(:active):focus-visible {
>       box-shadow: 0 0 0 2px var(--focus) inset;
>     }
281,285c372,375
< 			&:before {
< 				background: #d42e2e !important;
< 			}
< 		}
< 	}
---
>     &.label {
>       pointer-events: none;
>       font-size: 0.7em;
>       padding-bottom: 4px;
287,290c377,380
< 	&:active,
< 	&.active {
< 		color: var(--fgOnAccent) !important;
< 		opacity: 1;
---
>       > span {
>         opacity: 0.7;
>       }
>     }
292,295c382,385
< 		&:before {
< 			background: var(--accent) !important;
< 		}
< 	}
---
>     &.pending {
>       pointer-events: none;
>       opacity: 0.7;
>     }
297,299c387,390
< 	&:not(:active):focus-visible {
< 		box-shadow: 0 0 0 2px var(--focus) inset;
< 	}
---
>     &.none {
>       pointer-events: none;
>       opacity: 0.7;
>     }
301,304c392,395
< 	&.label {
< 		pointer-events: none;
< 		font-size: 0.7em;
< 		padding-bottom: 4px;
---
>     &.parent {
>       display: flex;
>       align-items: center;
>       cursor: default;
306,309c397,399
< 		> span {
< 			opacity: 0.7;
< 		}
< 	}
---
>       > .caret {
>         margin-left: auto;
>       }
311,314c401,403
< 	&.pending {
< 		pointer-events: none;
< 		opacity: 0.7;
< 	}
---
>       &.childShowing {
>         color: var(--accent);
>         text-decoration: none;
316,319c405,409
< 	&.none {
< 		pointer-events: none;
< 		opacity: 0.7;
< 	}
---
>         &:before {
>           background: var(--accentedBg);
>         }
>       }
>     }
321,324c411,414
< 	&.parent {
< 		display: flex;
< 		align-items: center;
< 		cursor: default;
---
>     > i {
>       margin-right: 5px;
>       width: 20px;
>     }
326,328c416,420
< 		&.childShowing {
< 			color: var(--accent);
< 			text-decoration: none;
---
>     > .avatar {
>       margin-right: 5px;
>       width: 20px;
>       height: 20px;
>     }
330,335c422,430
< 			&:before {
< 				background: var(--accentedBg);
< 			}
< 		}
< 	}
< }
---
>     > .indicator {
>       position: absolute;
>       top: 5px;
>       left: 13px;
>       color: var(--indicator);
>       font-size: 12px;
>       animation: blink 1s infinite;
>     }
>   }
337,339c432,435
< .icon {
< 	margin-right: 8px;
< }
---
>   > .divider {
>     margin: 8px 0;
>     border-top: solid 0.5px var(--divider);
>   }
341,343c437,442
< .caret {
< 	margin-left: auto;
< }
---
>   &.asDrawer {
>     padding: 12px 0 calc(env(safe-area-inset-bottom, 0px) + 12px) 0;
>     width: 100%;
>     border-radius: 24px;
>     border-bottom-right-radius: 0;
>     border-bottom-left-radius: 0;
345,349c444,446
< .avatar {
< 	margin-right: 5px;
< 	width: 20px;
< 	height: 20px;
< }
---
>     > .item {
>       font-size: 1em;
>       padding: 12px 24px;
351,358c448,451
< .indicator {
< 	position: absolute;
< 	top: 5px;
< 	left: 13px;
< 	color: var(--indicator);
< 	font-size: 12px;
< 	animation: blink 1s infinite;
< }
---
>       &:before {
>         width: calc(100% - 24px);
>         border-radius: 12px;
>       }
360,362c453,462
< .divider {
< 	margin: 8px 0;
< 	border-top: solid 0.5px var(--divider);
---
>       > i {
>         margin-right: 14px;
>         width: 24px;
>       }
>     }
> 
>     > .divider {
>       margin: 12px 0;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkMiniChart.vue RiricaV13/components/MkMiniChart.vue
2,25c2,20
< <svg :viewBox="`0 0 ${ viewBoxX } ${ viewBoxY }`" style="overflow:visible">
< 	<defs>
< 		<linearGradient :id="gradientId" x1="0" x2="0" y1="1" y2="0">
< 			<stop offset="0%" :stop-color="color" stop-opacity="0"></stop>
< 			<stop offset="100%" :stop-color="color" stop-opacity="0.65"></stop>
< 		</linearGradient>
< 	</defs>
< 	<polygon
< 		:points="polygonPoints"
< 		:style="`stroke: none; fill: url(#${ gradientId });`"
< 	/>
< 	<polyline
< 		:points="polylinePoints"
< 		fill="none"
< 		:stroke="color"
< 		stroke-width="2"
< 	/>
< 	<circle
< 		:cx="headX"
< 		:cy="headY"
< 		r="3"
< 		:fill="color"
< 	/>
< </svg>
---
>   <svg :viewBox="`0 0 ${viewBoxX} ${viewBoxY}`" style="overflow: visible">
>     <defs>
>       <linearGradient :id="gradientId" x1="0" x2="0" y1="1" y2="0">
>         <stop offset="0%" :stop-color="color" stop-opacity="0"></stop>
>         <stop offset="100%" :stop-color="color" stop-opacity="0.65"></stop>
>       </linearGradient>
>     </defs>
>     <polygon
>       :points="polygonPoints"
>       :style="`stroke: none; fill: url(#${gradientId});`"
>     />
>     <polyline
>       :points="polylinePoints"
>       fill="none"
>       :stroke="color"
>       stroke-width="2"
>     />
>     <circle :cx="headX" :cy="headY" r="3" :fill="color" />
>   </svg>
29,32c24,27
< import { onUnmounted, watch } from 'vue';
< import { v4 as uuid } from 'uuid';
< import tinycolor from 'tinycolor2';
< import { useInterval } from '@/scripts/use-interval';
---
> import { onUnmounted, watch } from "vue";
> import { v4 as uuid } from "uuid";
> import tinycolor from "tinycolor2";
> import { useInterval } from "@/scripts/use-interval";
35c30
< 	src: number[];
---
>   src: number[];
41,42c36,37
< let polylinePoints = $ref('');
< let polygonPoints = $ref('');
---
> let polylinePoints = $ref("");
> let polygonPoints = $ref("");
46c41,43
< const accent = tinycolor(getComputedStyle(document.documentElement).getPropertyValue('--accent'));
---
> const accent = tinycolor(
>   getComputedStyle(document.documentElement).getPropertyValue("--accent")
> );
50,51c47,48
< 	const stats = props.src.slice().reverse();
< 	const peak = Math.max.apply(null, stats) || 1;
---
>   const stats = props.src.slice().reverse();
>   const peak = Math.max.apply(null, stats) || 1;
53,56c50,53
< 	const _polylinePoints = stats.map((n, i) => [
< 		i * (viewBoxX / (stats.length - 1)),
< 		(1 - (n / peak)) * viewBoxY,
< 	]);
---
>   const _polylinePoints = stats.map((n, i) => [
>     i * (viewBoxX / (stats.length - 1)),
>     (1 - n / peak) * viewBoxY,
>   ]);
58c55
< 	polylinePoints = _polylinePoints.map(xy => `${xy[0]},${xy[1]}`).join(' ');
---
>   polylinePoints = _polylinePoints.map((xy) => `${xy[0]},${xy[1]}`).join(" ");
60c57
< 	polygonPoints = `0,${ viewBoxY } ${ polylinePoints } ${ viewBoxX },${ viewBoxY }`;
---
>   polygonPoints = `0,${viewBoxY} ${polylinePoints} ${viewBoxX},${viewBoxY}`;
62,63c59,60
< 	headX = _polylinePoints[_polylinePoints.length - 1][0];
< 	headY = _polylinePoints[_polylinePoints.length - 1][1];
---
>   headX = _polylinePoints[_polylinePoints.length - 1][0];
>   headY = _polylinePoints[_polylinePoints.length - 1][1];
70,71c67,68
< 	immediate: false,
< 	afterMounted: true,
---
>   immediate: false,
>   afterMounted: true,
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkModal.vue RiricaV13/components/MkModal.vue
2,16c2,52
< <Transition
< 	:name="transitionName"
< 	:enter-active-class="$style['transition_' + transitionName + '_enterActive']"
< 	:leave-active-class="$style['transition_' + transitionName + '_leaveActive']"
< 	:enter-from-class="$style['transition_' + transitionName + '_enterFrom']"
< 	:leave-to-class="$style['transition_' + transitionName + '_leaveTo']"
< 	:duration="transitionDuration" appear @after-leave="emit('closed')" @enter="emit('opening')" @after-enter="onOpened"
< >
< 	<div v-show="manualShowing != null ? manualShowing : showing" v-hotkey.global="keymap" :class="[$style.root, { [$style.drawer]: type === 'drawer', [$style.dialog]: type === 'dialog', [$style.popup]: type === 'popup' }]" :style="{ zIndex, pointerEvents: (manualShowing != null ? manualShowing : showing) ? 'auto' : 'none', '--transformOrigin': transformOrigin }">
< 		<div class="_modalBg data-cy-bg" :class="[$style.bg, { [$style.bgTransparent]: isEnableBgTransparent, 'data-cy-transparent': isEnableBgTransparent }]" :style="{ zIndex }" @click="onBgClick" @mousedown="onBgClick" @contextmenu.prevent.stop="() => {}"></div>
< 		<div ref="content" :class="[$style.content, { [$style.fixed]: fixed }]" :style="{ zIndex }" @click.self="onBgClick">
< 			<slot :max-height="maxHeight" :type="type"></slot>
< 		</div>
< 	</div>
< </Transition>
---
>   <transition
>     :name="
>       $store.state.animation
>         ? type === 'drawer'
>           ? 'modal-drawer'
>           : type === 'popup'
>           ? 'modal-popup'
>           : 'modal'
>         : ''
>     "
>     :duration="$store.state.animation ? 200 : 0"
>     appear
>     @after-leave="emit('closed')"
>     @enter="emit('opening')"
>     @after-enter="onOpened"
>   >
>     <div
>       v-show="manualShowing != null ? manualShowing : showing"
>       v-hotkey.global="keymap"
>       class="qzhlnise"
>       :class="{
>         drawer: type === 'drawer',
>         dialog: type === 'dialog' || type === 'dialog:top',
>         popup: type === 'popup',
>       }"
>       :style="{
>         zIndex,
>         pointerEvents: (manualShowing != null ? manualShowing : showing)
>           ? 'auto'
>           : 'none',
>         '--transformOrigin': transformOrigin,
>       }"
>     >
>       <div
>         class="bg _modalBg"
>         :class="{ transparent: transparentBg && type === 'popup' }"
>         :style="{ zIndex }"
>         @click="onBgClick"
>         @contextmenu.prevent.stop="() => {}"
>       ></div>
>       <div
>         ref="content"
>         class="content"
>         :class="{ fixed, top: type === 'dialog:top' }"
>         :style="{ zIndex }"
>         @click.self="onBgClick"
>       >
>         <slot :max-height="maxHeight" :type="type"></slot>
>       </div>
>     </div>
>   </transition>
20,24c56,60
< import { nextTick, onMounted, watch, provide } from 'vue';
< import * as os from '@/os';
< import { isTouchUsing } from '@/scripts/touch';
< import { defaultStore } from '@/store';
< import { deviceKind } from '@/scripts/device-kind';
---
> import { nextTick, onMounted, watch, provide } from "vue";
> import * as os from "@/os";
> import { isTouchUsing } from "@/scripts/touch";
> import { defaultStore } from "@/store";
> import { deviceKind } from "@/scripts/device-kind";
27,33c63,69
< 	if (el == null || el.tagName === 'BODY') return null;
< 	const position = window.getComputedStyle(el).getPropertyValue('position');
< 	if (position === 'fixed') {
< 		return el;
< 	} else {
< 		return getFixedContainer(el.parentElement);
< 	}
---
>   if (el == null || el.tagName === "BODY") return null;
>   const position = window.getComputedStyle(el).getPropertyValue("position");
>   if (position === "fixed") {
>     return el;
>   } else {
>     return getFixedContainer(el.parentElement);
>   }
36c72
< type ModalTypes = 'popup' | 'dialog' | 'drawer';
---
> type ModalTypes = "popup" | "dialog" | "dialog:top" | "drawer";
38,54c74,93
< const props = withDefaults(defineProps<{
< 	manualShowing?: boolean | null;
< 	anchor?: { x: string; y: string; };
< 	src?: HTMLElement;
< 	preferType?: ModalTypes | 'auto';
< 	zPriority?: 'low' | 'middle' | 'high';
< 	noOverlap?: boolean;
< 	transparentBg?: boolean;
< }>(), {
< 	manualShowing: null,
< 	src: null,
< 	anchor: () => ({ x: 'center', y: 'bottom' }),
< 	preferType: 'auto',
< 	zPriority: 'low',
< 	noOverlap: true,
< 	transparentBg: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     manualShowing?: boolean | null;
>     anchor?: { x: string; y: string };
>     src?: HTMLElement;
>     preferType?: ModalTypes | "auto";
>     zPriority?: "low" | "middle" | "high";
>     noOverlap?: boolean;
>     transparentBg?: boolean;
>   }>(),
>   {
>     manualShowing: null,
>     src: null,
>     anchor: () => ({ x: "center", y: "bottom" }),
>     preferType: "auto",
>     zPriority: "low",
>     noOverlap: true,
>     transparentBg: false,
>   }
> );
57,62c96,101
< 	(ev: 'opening'): void;
< 	(ev: 'opened'): void;
< 	(ev: 'click'): void;
< 	(ev: 'esc'): void;
< 	(ev: 'close'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "opening"): void;
>   (ev: "opened"): void;
>   (ev: "click"): void;
>   (ev: "esc"): void;
>   (ev: "close"): void;
>   (ev: "closed"): void;
65c104
< provide('modal', true);
---
> provide("modal", true);
69c108
< let transformOrigin = $ref('center');
---
> let transformOrigin = $ref("center");
71c110
< let content = $shallowRef<HTMLElement>();
---
> let content = $ref<HTMLElement>();
73,83c112,125
< let useSendAnime = $ref(false);
< const type = $computed<ModalTypes>(() => {
< 	if (props.preferType === 'auto') {
< 		if (!defaultStore.state.disableDrawer && isTouchUsing && deviceKind === 'smartphone') {
< 			return 'drawer';
< 		} else {
< 			return props.src != null ? 'popup' : 'dialog';
< 		}
< 	} else {
< 		return props.preferType!;
< 	}
---
> const type = $computed(() => {
>   if (props.preferType === "auto") {
>     if (
>       !defaultStore.state.disableDrawer &&
>       isTouchUsing &&
>       deviceKind === "smartphone"
>     ) {
>       return "drawer";
>     } else {
>       return props.src != null ? "popup" : "dialog";
>     }
>   } else {
>     return props.preferType!;
>   }
85,107d126
< const isEnableBgTransparent = $computed(() => props.transparentBg && (type === 'popup'));
< let transitionName = $computed((() =>
< 	defaultStore.state.animation
< 		? useSendAnime
< 			? 'send'
< 			: type === 'drawer'
< 				? 'modal-drawer'
< 				: type === 'popup'
< 					? 'modal-popup'
< 					: 'modal'
< 		: ''
< ));
< let transitionDuration = $computed((() =>
< 	transitionName === 'send'
< 		? 400
< 		: transitionName === 'modal-popup'
< 			? 100
< 			: transitionName === 'modal'
< 				? 200
< 				: transitionName === 'modal-drawer'
< 					? 200
< 					: 0
< ));
111,114c130,135
< function close(opts: { useSendAnimation?: boolean } = {}) {
< 	if (opts.useSendAnimation) {
< 		useSendAnime = true;
< 	}
---
> const close = () => {
>   // eslint-disable-next-line vue/no-mutating-props
>   if (props.src) props.src.style.pointerEvents = "auto";
>   showing = false;
>   emit("close");
> };
116,120c137,140
< 	// eslint-disable-next-line vue/no-mutating-props
< 	if (props.src) props.src.style.pointerEvents = 'auto';
< 	showing = false;
< 	emit('close');
< }
---
> const onBgClick = () => {
>   if (contentClicking) return;
>   emit("click");
> };
122,124c142,143
< function onBgClick() {
< 	if (contentClicking) return;
< 	emit('click');
---
> if (type === "drawer") {
>   maxHeight = window.innerHeight / 1.5;
127,130d145
< if (type === 'drawer') {
< 	maxHeight = window.innerHeight / 1.5;
< }
< 
132c147
< 	'esc': () => emit('esc'),
---
>   esc: () => emit("esc"),
138,140c153,155
< 	if (props.src == null) return;
< 	if (type === 'drawer') return;
< 	if (type === 'dialog') return;
---
>   if (props.src == null) return;
>   if (type === "drawer") return;
>   if (type === "dialog") return;
142c157
< 	if (content == null) return;
---
>   if (content == null) return;
144c159
< 	const srcRect = props.src.getBoundingClientRect();
---
>   const srcRect = props.src.getBoundingClientRect();
146,147c161,162
< 	const width = content!.offsetWidth;
< 	const height = content!.offsetHeight;
---
>   const width = content!.offsetWidth;
>   const height = content!.offsetHeight;
149,150c164,165
< 	let left;
< 	let top;
---
>   let left;
>   let top;
152,153c167,168
< 	const x = srcRect.left + (fixed ? 0 : window.pageXOffset);
< 	const y = srcRect.top + (fixed ? 0 : window.pageYOffset);
---
>   const x = srcRect.left + (fixed ? 0 : window.pageXOffset);
>   const y = srcRect.top + (fixed ? 0 : window.pageYOffset);
155,161c170,176
< 	if (props.anchor.x === 'center') {
< 		left = x + (props.src.offsetWidth / 2) - (width / 2);
< 	} else if (props.anchor.x === 'left') {
< 		// TODO
< 	} else if (props.anchor.x === 'right') {
< 		left = x + props.src.offsetWidth;
< 	}
---
>   if (props.anchor.x === "center") {
>     left = x + props.src.offsetWidth / 2 - width / 2;
>   } else if (props.anchor.x === "left") {
>     // TODO
>   } else if (props.anchor.x === "right") {
>     left = x + props.src.offsetWidth;
>   }
163,169c178,184
< 	if (props.anchor.y === 'center') {
< 		top = (y - (height / 2));
< 	} else if (props.anchor.y === 'top') {
< 		// TODO
< 	} else if (props.anchor.y === 'bottom') {
< 		top = y + props.src.offsetHeight;
< 	}
---
>   if (props.anchor.y === "center") {
>     top = y - height / 2;
>   } else if (props.anchor.y === "top") {
>     // TODO
>   } else if (props.anchor.y === "bottom") {
>     top = y + props.src.offsetHeight;
>   }
171,175c186,190
< 	if (fixed) {
< 		// 画面から横にはみ出る場合
< 		if (left + width > window.innerWidth) {
< 			left = window.innerWidth - width;
< 		}
---
>   if (fixed) {
>     // 画面から横にはみ出る場合
>     if (left + width > window.innerWidth) {
>       left = window.innerWidth - width;
>     }
177,178c192,193
< 		const underSpace = (window.innerHeight - MARGIN) - top;
< 		const upperSpace = (srcRect.top - MARGIN);
---
>     const underSpace = window.innerHeight - MARGIN - top;
>     const upperSpace = srcRect.top - MARGIN;
180,199c195,214
< 		// 画面から縦にはみ出る場合
< 		if (top + height > (window.innerHeight - MARGIN)) {
< 			if (props.noOverlap && props.anchor.x === 'center') {
< 				if (underSpace >= (upperSpace / 3)) {
< 					maxHeight = underSpace;
< 				} else {
< 					maxHeight = upperSpace;
< 					top = (upperSpace + MARGIN) - height;
< 				}
< 			} else {
< 				top = (window.innerHeight - MARGIN) - height;
< 			}
< 		} else {
< 			maxHeight = underSpace;
< 		}
< 	} else {
< 		// 画面から横にはみ出る場合
< 		if (left + width - window.pageXOffset > window.innerWidth) {
< 			left = window.innerWidth - width + window.pageXOffset - 1;
< 		}
---
>     // 画面から縦にはみ出る場合
>     if (top + height > window.innerHeight - MARGIN) {
>       if (props.noOverlap && props.anchor.x === "center") {
>         if (underSpace >= upperSpace / 3) {
>           maxHeight = underSpace;
>         } else {
>           maxHeight = upperSpace;
>           top = upperSpace + MARGIN - height;
>         }
>       } else {
>         top = window.innerHeight - MARGIN - height;
>       }
>     } else {
>       maxHeight = underSpace;
>     }
>   } else {
>     // 画面から横にはみ出る場合
>     if (left + width - window.pageXOffset > window.innerWidth) {
>       left = window.innerWidth - width + window.pageXOffset - 1;
>     }
201,202c216,217
< 		const underSpace = (window.innerHeight - MARGIN) - (top - window.pageYOffset);
< 		const upperSpace = (srcRect.top - MARGIN);
---
>     const underSpace = window.innerHeight - MARGIN - (top - window.pageYOffset);
>     const upperSpace = srcRect.top - MARGIN;
204,219c219,234
< 		// 画面から縦にはみ出る場合
< 		if (top + height - window.pageYOffset > (window.innerHeight - MARGIN)) {
< 			if (props.noOverlap && props.anchor.x === 'center') {
< 				if (underSpace >= (upperSpace / 3)) {
< 					maxHeight = underSpace;
< 				} else {
< 					maxHeight = upperSpace;
< 					top = window.pageYOffset + ((upperSpace + MARGIN) - height);
< 				}
< 			} else {
< 				top = (window.innerHeight - MARGIN) - height + window.pageYOffset - 1;
< 			}
< 		} else {
< 			maxHeight = underSpace;
< 		}
< 	}
---
>     // 画面から縦にはみ出る場合
>     if (top + height - window.pageYOffset > window.innerHeight - MARGIN) {
>       if (props.noOverlap && props.anchor.x === "center") {
>         if (underSpace >= upperSpace / 3) {
>           maxHeight = underSpace;
>         } else {
>           maxHeight = upperSpace;
>           top = window.pageYOffset + (upperSpace + MARGIN - height);
>         }
>       } else {
>         top = window.innerHeight - MARGIN - height + window.pageYOffset - 1;
>       }
>     } else {
>       maxHeight = underSpace;
>     }
>   }
221,223c236,238
< 	if (top < 0) {
< 		top = MARGIN;
< 	}
---
>   if (top < 0) {
>     top = MARGIN;
>   }
225,227c240,242
< 	if (left < 0) {
< 		left = 0;
< 	}
---
>   if (left < 0) {
>     left = 0;
>   }
229,230c244,245
< 	let transformOriginX = 'center';
< 	let transformOriginY = 'center';
---
>   let transformOriginX = "center";
>   let transformOriginY = "center";
232,236c247,254
< 	if (top >= srcRect.top + props.src.offsetHeight + (fixed ? 0 : window.pageYOffset)) {
< 		transformOriginY = 'top';
< 	} else if ((top + height) <= srcRect.top + (fixed ? 0 : window.pageYOffset)) {
< 		transformOriginY = 'bottom';
< 	}
---
>   if (
>     top >=
>     srcRect.top + props.src.offsetHeight + (fixed ? 0 : window.pageYOffset)
>   ) {
>     transformOriginY = "top";
>   } else if (top + height <= srcRect.top + (fixed ? 0 : window.pageYOffset)) {
>     transformOriginY = "bottom";
>   }
238,242c256,263
< 	if (left >= srcRect.left + props.src.offsetWidth + (fixed ? 0 : window.pageXOffset)) {
< 		transformOriginX = 'left';
< 	} else if ((left + width) <= srcRect.left + (fixed ? 0 : window.pageXOffset)) {
< 		transformOriginX = 'right';
< 	}
---
>   if (
>     left >=
>     srcRect.left + props.src.offsetWidth + (fixed ? 0 : window.pageXOffset)
>   ) {
>     transformOriginX = "left";
>   } else if (left + width <= srcRect.left + (fixed ? 0 : window.pageXOffset)) {
>     transformOriginX = "right";
>   }
244c265
< 	transformOrigin = `${transformOriginX} ${transformOriginY}`;
---
>   transformOrigin = `${transformOriginX} ${transformOriginY}`;
246,247c267,268
< 	content.style.left = left + 'px';
< 	content.style.top = top + 'px';
---
>   content.style.left = left + "px";
>   content.style.top = top + "px";
251c272
< 	emit('opened');
---
>   emit("opened");
253,263c274,292
< 	// モーダルコンテンツにマウスボタンが押され、コンテンツ外でマウスボタンが離されたときにモーダルバックグラウンドクリックと判定させないためにマウスイベントを監視しフラグ管理する
< 	const el = content!.children[0];
< 	el.addEventListener('mousedown', ev => {
< 		contentClicking = true;
< 		window.addEventListener('mouseup', ev => {
< 			// click イベントより先に mouseup イベントが発生するかもしれないのでちょっと待つ
< 			window.setTimeout(() => {
< 				contentClicking = false;
< 			}, 100);
< 		}, { passive: true, once: true });
< 	}, { passive: true });
---
>   // モーダルコンテンツにマウスボタンが押され、コンテンツ外でマウスボタンが離されたときにモーダルバックグラウンドクリックと判定させないためにマウスイベントを監視しフラグ管理する
>   const el = content!.children[0];
>   el.addEventListener(
>     "mousedown",
>     (ev) => {
>       contentClicking = true;
>       window.addEventListener(
>         "mouseup",
>         (ev) => {
>           // click イベントより先に mouseup イベントが発生するかもしれないのでちょっと待つ
>           window.setTimeout(() => {
>             contentClicking = false;
>           }, 100);
>         },
>         { passive: true, once: true }
>       );
>     },
>     { passive: true }
>   );
267,272c296,303
< 	watch(() => props.src, async () => {
< 		if (props.src) {
< 			// eslint-disable-next-line vue/no-mutating-props
< 			props.src.style.pointerEvents = 'none';
< 		}
< 		fixed = (type === 'drawer') || (getFixedContainer(props.src) != null);
---
>   watch(
>     () => props.src,
>     async () => {
>       if (props.src) {
>         // eslint-disable-next-line vue/no-mutating-props
>         props.src.style.pointerEvents = "none";
>       }
>       fixed = type === "drawer" || getFixedContainer(props.src) != null;
274c305
< 		await nextTick();
---
>       await nextTick();
276,277c307,310
< 		align();
< 	}, { immediate: true });
---
>       align();
>     },
>     { immediate: true }
>   );
279,283c312,316
< 	nextTick(() => {
< 		new ResizeObserver((entries, observer) => {
< 			align();
< 		}).observe(content!);
< 	});
---
>   nextTick(() => {
>     new ResizeObserver((entries, observer) => {
>       align();
>     }).observe(content!);
>   });
287c320
< 	close,
---
>   close,
291,296c324,329
< <style lang="scss" module>
< .transition_send_enterActive,
< .transition_send_leaveActive {
< 	> .bg {
< 		transition: opacity 0.3s !important;
< 	}
---
> <style lang="scss" scoped>
> .modal-enter-active,
> .modal-leave-active {
>   > .bg {
>     transition: opacity 0.2s !important;
>   }
298,301c331,334
< 	> .content {
<     transform: translateY(0px);
< 		transition: opacity 0.3s ease-in, transform 0.3s cubic-bezier(.5,-0.5,1,.5) !important;
< 	}
---
>   > .content {
>     transform-origin: var(--transformOrigin);
>     transition: opacity 0.2s, transform 0.2s !important;
>   }
303,307c336,340
< .transition_send_enterFrom,
< .transition_send_leaveTo {
< 	> .bg {
< 		opacity: 0;
< 	}
---
> .modal-enter-from,
> .modal-leave-to {
>   > .bg {
>     opacity: 0;
>   }
309,313c342,347
< 	> .content {
< 		pointer-events: none;
< 		opacity: 0;
< 		transform: translateY(-300px);
< 	}
---
>   > .content {
>     pointer-events: none;
>     opacity: 0;
>     transform-origin: var(--transformOrigin);
>     transform: scale(0.9);
>   }
316,320c350,354
< .transition_modal_enterActive,
< .transition_modal_leaveActive {
< 	> .bg {
< 		transition: opacity 0.2s !important;
< 	}
---
> .modal-popup-enter-active,
> .modal-popup-leave-active {
>   > .bg {
>     transition: opacity 0.2s !important;
>   }
322,325c356,360
< 	> .content {
< 		transform-origin: var(--transformOrigin);
< 		transition: opacity 0.2s, transform 0.2s !important;
< 	}
---
>   > .content {
>     transform-origin: var(--transformOrigin);
>     transition: opacity 0.2s cubic-bezier(0, 0, 0.2, 1),
>       transform 0.2s cubic-bezier(0, 0, 0.2, 1) !important;
>   }
327,331c362,366
< .transition_modal_enterFrom,
< .transition_modal_leaveTo {
< 	> .bg {
< 		opacity: 0;
< 	}
---
> .modal-popup-enter-from,
> .modal-popup-leave-to {
>   > .bg {
>     opacity: 0;
>   }
333,338c368,373
< 	> .content {
< 		pointer-events: none;
< 		opacity: 0;
< 		transform-origin: var(--transformOrigin);
< 		transform: scale(0.9);
< 	}
---
>   > .content {
>     pointer-events: none;
>     opacity: 0;
>     transform-origin: var(--transformOrigin);
>     transform: scale(0.9);
>   }
341,345c376,379
< .transition_modal-popup_enterActive,
< .transition_modal-popup_leaveActive {
< 	> .bg {
< 		transition: opacity 0.1s !important;
< 	}
---
> .modal-drawer-enter-active {
>   > .bg {
>     transition: opacity 0.2s !important;
>   }
347,350c381,383
< 	> .content {
< 		transform-origin: var(--transformOrigin);
< 		transition: opacity 0.1s cubic-bezier(0, 0, 0.2, 1), transform 0.1s cubic-bezier(0, 0, 0.2, 1) !important;
< 	}
---
>   > .content {
>     transition: transform 0.2s cubic-bezier(0, 0.5, 0, 1) !important;
>   }
352,356c385,388
< .transition_modal-popup_enterFrom,
< .transition_modal-popup_leaveTo {
< 	> .bg {
< 		opacity: 0;
< 	}
---
> .modal-drawer-leave-active {
>   > .bg {
>     transition: opacity 0.2s !important;
>   }
358,363c390,392
< 	> .content {
< 		pointer-events: none;
< 		opacity: 0;
< 		transform-origin: var(--transformOrigin);
< 		transform: scale(0.9);
< 	}
---
>   > .content {
>     transition: transform 0.2s cubic-bezier(0, 0.5, 0, 1) !important;
>   }
364a394,398
> .modal-drawer-enter-from,
> .modal-drawer-leave-to {
>   > .bg {
>     opacity: 0;
>   }
366,373c400,403
< .transition_modal-drawer_enterActive {
< 	> .bg {
< 		transition: opacity 0.2s !important;
< 	}
< 
< 	> .content {
< 		transition: transform 0.2s cubic-bezier(0,.5,0,1) !important;
< 	}
---
>   > .content {
>     pointer-events: none;
>     transform: translateY(100%);
>   }
375,378d404
< .transition_modal-drawer_leaveActive {
< 	> .bg {
< 		transition: opacity 0.2s !important;
< 	}
380,388c406,413
< 	> .content {
< 		transition: transform 0.2s cubic-bezier(0,.5,0,1) !important;
< 	}
< }
< .transition_modal-drawer_enterFrom,
< .transition_modal-drawer_leaveTo {
< 	> .bg {
< 		opacity: 0;
< 	}
---
> .qzhlnise {
>   > .bg {
>     &.transparent {
>       background: transparent;
>       -webkit-backdrop-filter: none;
>       backdrop-filter: none;
>     }
>   }
390,394c415,440
< 	> .content {
< 		pointer-events: none;
< 		transform: translateY(100%);
< 	}
< }
---
>   &.dialog {
>     > .content {
>       position: fixed;
>       top: 0;
>       bottom: 0;
>       left: 0;
>       right: 0;
>       margin: auto;
>       padding: 32px;
>       // TODO: mask-imageはiOSだとやたら重い。なんとかしたい
>       -webkit-mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 32px,
>         rgba(0, 0, 0, 1) calc(100% - 32px),
>         rgba(0, 0, 0, 0) 100%
>       );
>       mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 32px,
>         rgba(0, 0, 0, 1) calc(100% - 32px),
>         rgba(0, 0, 0, 0) 100%
>       );
>       overflow: auto;
>       display: flex;
396,410c442,458
< .root {
< 	&.dialog {
< 		> .content {
< 			position: fixed;
< 			top: 0;
< 			bottom: 0;
< 			left: 0;
< 			right: 0;
< 			margin: auto;
< 			padding: 32px;
< 			// TODO: mask-imageはiOSだとやたら重い。なんとかしたい
< 			-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 32px, rgba(0,0,0,1) calc(100% - 32px), rgba(0,0,0,0) 100%);
< 			mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 32px, rgba(0,0,0,1) calc(100% - 32px), rgba(0,0,0,0) 100%);
< 			overflow: auto;
< 			display: flex;
---
>       @media (max-width: 500px) {
>         padding: 16px;
>         -webkit-mask-image: linear-gradient(
>           0deg,
>           rgba(0, 0, 0, 0) 0%,
>           rgba(0, 0, 0, 1) 16px,
>           rgba(0, 0, 0, 1) calc(100% - 16px),
>           rgba(0, 0, 0, 0) 100%
>         );
>         mask-image: linear-gradient(
>           0deg,
>           rgba(0, 0, 0, 0) 0%,
>           rgba(0, 0, 0, 1) 16px,
>           rgba(0, 0, 0, 1) calc(100% - 16px),
>           rgba(0, 0, 0, 0) 100%
>         );
>       }
412,418c460,462
< 			@media (max-width: 500px) {
< 				padding: 16px;
< 				-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 16px, rgba(0,0,0,1) calc(100% - 16px), rgba(0,0,0,0) 100%);
< 				mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 16px, rgba(0,0,0,1) calc(100% - 16px), rgba(0,0,0,0) 100%);
< 			}
< 		}
< 	}
---
>       > ::v-deep(*) {
>         margin: auto;
>       }
420,422c464,470
< 	&.popup {
< 		> .content {
< 			position: absolute;
---
>       &.top {
>         > ::v-deep(*) {
>           margin-top: 0;
>         }
>       }
>     }
>   }
424,428c472,474
< 			&.fixed {
< 				position: fixed;
< 			}
< 		}
< 	}
---
>   &.popup {
>     > .content {
>       position: absolute;
430,436c476,480
< 	&.drawer {
< 		position: fixed;
< 		top: 0;
< 		left: 0;
< 		width: 100%;
< 		height: 100%;
< 		overflow: clip;
---
>       &.fixed {
>         position: fixed;
>       }
>     }
>   }
438,446c482,488
< 		> .content {
< 			position: fixed;
< 			bottom: 0;
< 			left: 0;
< 			right: 0;
< 			margin: auto;
< 		}
< 	}
< }
---
>   &.drawer {
>     position: fixed;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     overflow: clip;
448,453c490,501
< .bg {
< 	&.bgTransparent {
< 		background: transparent;
< 		-webkit-backdrop-filter: none;
< 		backdrop-filter: none;
< 	}
---
>     > .content {
>       position: fixed;
>       bottom: 0;
>       left: 0;
>       right: 0;
>       margin: auto;
> 
>       > ::v-deep(*) {
>         margin: auto;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkModalPageWindow.vue RiricaV13/components/MkModalPageWindow.vue
2,20c2,44
< <MkModal ref="modal" @click="$emit('click')" @closed="$emit('closed')">
< 	<div ref="rootEl" class="hrmcaedk" :style="{ width: `${width}px`, height: (height ? `min(${height}px, 100%)` : '100%') }">
< 		<div class="header" @contextmenu="onContextmenu">
< 			<button v-if="history.length > 0" v-tooltip="$ts.goBack" class="_button" @click="back()"><i class="ti ti-arrow-left"></i></button>
< 			<span v-else style="display: inline-block; width: 20px"></span>
< 			<span v-if="pageMetadata?.value" class="title">
< 				<i v-if="pageMetadata?.value.icon" class="icon" :class="pageMetadata?.value.icon"></i>
< 				<span>{{ pageMetadata?.value.title }}</span>
< 			</span>
< 			<button class="_button" @click="$refs.modal.close()"><i class="ti ti-x"></i></button>
< 		</div>
< 		<div class="body" style="container-type: inline-size;">
< 			<MkStickyContainer>
< 				<template #header><MkPageHeader v-if="pageMetadata?.value && !pageMetadata?.value.hideHeader" :info="pageMetadata?.value"/></template>
< 				<RouterView :router="router"/>
< 			</MkStickyContainer>
< 		</div>
< 	</div>
< </MkModal>
---
>   <MkModal ref="modal" @click="$emit('click')" @closed="$emit('closed')">
>     <div
>       ref="rootEl"
>       class="hrmcaedk _narrow_"
>       :style="{
>         width: `${width}px`,
>         height: height ? `min(${height}px, 100%)` : '100%',
>       }"
>     >
>       <div class="header" @contextmenu="onContextmenu">
>         <button
>           v-if="history.length > 0"
>           v-tooltip="$ts.goBack"
>           class="_button"
>           @click="back()"
>         >
>           <i class="fas fa-arrow-left"></i>
>         </button>
>         <span v-else style="display: inline-block; width: 20px"></span>
>         <span v-if="pageMetadata?.value" class="title">
>           <i
>             v-if="pageMetadata?.value.icon"
>             class="icon"
>             :class="pageMetadata?.value.icon"
>           ></i>
>           <span>{{ pageMetadata?.value.title }}</span>
>         </span>
>         <button class="_button" @click="$refs.modal.close()">
>           <i class="fas fa-times"></i>
>         </button>
>       </div>
>       <div class="body">
>         <MkStickyContainer>
>           <template #header
>             ><MkPageHeader
>               v-if="pageMetadata?.value && !pageMetadata?.value.hideHeader"
>               :info="pageMetadata?.value"
>           /></template>
>           <RouterView :router="router" />
>         </MkStickyContainer>
>       </div>
>     </div>
>   </MkModal>
24,33c48,61
< import { ComputedRef, provide } from 'vue';
< import MkModal from '@/components/MkModal.vue';
< import { popout as _popout } from '@/scripts/popout';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { url } from '@/config';
< import * as os from '@/os';
< import { mainRouter, routes } from '@/router';
< import { i18n } from '@/i18n';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import { Router } from '@/nirax';
---
> import { ComputedRef, provide } from "vue";
> import MkModal from "@/components/MkModal.vue";
> import { popout as _popout } from "@/scripts/popout";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { url } from "@/config";
> import * as os from "@/os";
> import { mainRouter, routes } from "@/router";
> import { i18n } from "@/i18n";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
> import { Router } from "@/nirax";
36c64
< 	initialPath: string;
---
>   initialPath: string;
40,41c68,69
< 	(ev: 'closed'): void;
< 	(ev: 'click'): void;
---
>   (ev: "closed"): void;
>   (ev: "click"): void;
46,48c74
< router.addListener('push', ctx => {
< 	
< });
---
> router.addListener("push", (ctx) => {});
52c78
< let modal = $shallowRef<InstanceType<typeof MkModal>>();
---
> let modal = $ref<InstanceType<typeof MkModal>>();
58c84
< provide('router', router);
---
> provide("router", router);
60c86
< 	pageMetadata = info;
---
>   pageMetadata = info;
62,63c88,89
< provide('shouldOmitHeaderTitle', true);
< provide('shouldHeaderThin', true);
---
> provide("shouldOmitHeaderTitle", true);
> provide("shouldHeaderThin", true);
67,91c93,124
< 	return [{
< 		type: 'label',
< 		text: path,
< 	}, {
< 		icon: 'ti ti-player-eject',
< 		text: i18n.ts.showInPage,
< 		action: expand,
< 	}, {
< 		icon: 'ti ti-window-maximize',
< 		text: i18n.ts.popout,
< 		action: popout,
< 	}, null, {
< 		icon: 'ti ti-external-link',
< 		text: i18n.ts.openInNewTab,
< 		action: () => {
< 			window.open(pageUrl, '_blank');
< 			modal.close();
< 		},
< 	}, {
< 		icon: 'ti ti-link',
< 		text: i18n.ts.copyLink,
< 		action: () => {
< 			copyToClipboard(pageUrl);
< 		},
< 	}];
---
>   return [
>     {
>       type: "label",
>       text: path,
>     },
>     {
>       icon: "fas fa-expand-alt",
>       text: i18n.ts.showInPage,
>       action: expand,
>     },
>     {
>       icon: "fas fa-external-link-alt",
>       text: i18n.ts.popout,
>       action: popout,
>     },
>     null,
>     {
>       icon: "fas fa-external-link-alt",
>       text: i18n.ts.openInNewTab,
>       action: () => {
>         window.open(pageUrl, "_blank");
>         modal.close();
>       },
>     },
>     {
>       icon: "fas fa-link",
>       text: i18n.ts.copyLink,
>       action: () => {
>         copyToClipboard(pageUrl);
>       },
>     },
>   ];
95,96c128,129
< 	if (record) history.push(router.getCurrentPath());
< 	router.push(path);
---
>   if (record) history.push(router.getCurrentPath());
>   router.push(path);
100c133
< 	navigate(history.pop(), false);
---
>   navigate(history.pop(), false);
104,105c137,138
< 	mainRouter.push(path);
< 	modal.close();
---
>   mainRouter.push(path);
>   modal.close();
109,110c142,143
< 	_popout(path, rootEl);
< 	modal.close();
---
>   _popout(path, rootEl);
>   modal.close();
114c147
< 	os.contextMenu(contextmenu, ev);
---
>   os.contextMenu(contextmenu, ev);
120,125c153,157
< 	margin: auto;
< 	overflow: hidden;
< 	display: flex;
< 	flex-direction: column;
< 	contain: content;
< 	border-radius: var(--radius);
---
>   overflow: hidden;
>   display: flex;
>   flex-direction: column;
>   contain: content;
>   border-radius: var(--radius);
127c159
< 	--root-margin: 24px;
---
>   --root-margin: 24px;
129,131c161,163
< 	@media (max-width: 500px) {
< 		--root-margin: 16px;
< 	}
---
>   @media (max-width: 500px) {
>     --root-margin: 16px;
>   }
133,146c165,178
< 	> .header {
< 		$height: 52px;
< 		$height-narrow: 42px;
< 		display: flex;
< 		flex-shrink: 0;
< 		height: $height;
< 		line-height: $height;
< 		font-weight: bold;
< 		white-space: nowrap;
< 		overflow: hidden;
< 		text-overflow: ellipsis;
< 		background: var(--windowHeader);
< 		-webkit-backdrop-filter: var(--blur, blur(15px));
< 		backdrop-filter: var(--blur, blur(15px));
---
>   > .header {
>     $height: 52px;
>     $height-narrow: 42px;
>     display: flex;
>     flex-shrink: 0;
>     height: $height;
>     line-height: $height;
>     font-weight: bold;
>     white-space: nowrap;
>     overflow: hidden;
>     text-overflow: ellipsis;
>     background: var(--windowHeader);
>     -webkit-backdrop-filter: var(--blur, blur(15px));
>     backdrop-filter: var(--blur, blur(15px));
148,150c180,182
< 		> button {
< 			height: $height;
< 			width: $height;
---
>     > button {
>       height: $height;
>       width: $height;
152,155c184,187
< 			&:hover {
< 				color: var(--fgHighlighted);
< 			}
< 		}
---
>       &:hover {
>         color: var(--fgHighlighted);
>       }
>     }
157,160c189,192
< 		@media (max-width: 500px) {
< 			height: $height-narrow;
< 			line-height: $height-narrow;
< 			padding-left: 16px;
---
>     @media (max-width: 500px) {
>       height: $height-narrow;
>       line-height: $height-narrow;
>       padding-left: 16px;
162,166c194,198
< 			> button {
< 				height: $height-narrow;
< 				width: $height-narrow;
< 			}
< 		}
---
>       > button {
>         height: $height-narrow;
>         width: $height-narrow;
>       }
>     }
168,169c200,201
< 		> .title {
< 			flex: 1;
---
>     > .title {
>       flex: 1;
171,175c203,207
< 			> .icon {
< 				margin-right: 0.5em;
< 			}
< 		}
< 	}
---
>       > .icon {
>         margin-right: 0.5em;
>       }
>     }
>   }
177,180c209,212
< 	> .body {
< 		overflow: auto;
< 		background: var(--bg);
< 	}
---
>   > .body {
>     overflow: auto;
>     background: var(--bg);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkModalWindow.vue RiricaV13/components/MkModalWindow.vue
2,16c2,46
< <MkModal ref="modal" :prefer-type="'dialog'" @click="onBgClick" @closed="$emit('closed')">
< 	<div ref="rootEl" class="ebkgoccj" :style="{ width: `${width}px`, height: scroll ? (height ? `${height}px` : null) : (height ? `min(${height}px, 100%)` : '100%') }" @keydown="onKeydown">
< 		<div ref="headerEl" class="header">
< 			<button v-if="withOkButton" class="_button" @click="$emit('close')"><i class="ti ti-x"></i></button>
< 			<span class="title">
< 				<slot name="header"></slot>
< 			</span>
< 			<button v-if="!withOkButton" class="_button" @click="$emit('close')"><i class="ti ti-x"></i></button>
< 			<button v-if="withOkButton" class="_button" :disabled="okButtonDisabled" @click="$emit('ok')"><i class="ti ti-check"></i></button>
< 		</div>
< 		<div class="body">
< 			<slot :width="bodyWidth" :height="bodyHeight"></slot>
< 		</div>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :prefer-type="'dialog'"
>     @click="onBgClick"
>     @closed="$emit('closed')"
>   >
>     <div
>       ref="rootEl"
>       class="ebkgoccj _narrow_"
>       :style="{
>         width: `${width}px`,
>         height: scroll
>           ? height
>             ? `${height}px`
>             : null
>           : height
>           ? `min(${height}px, 100%)`
>           : '100%',
>       }"
>       @keydown="onKeydown"
>     >
>       <div ref="headerEl" class="header">
>         <button v-if="withOkButton" class="_button" @click="$emit('close')">
>           <i class="fas fa-times"></i>
>         </button>
>         <span class="title">
>           <slot name="header"></slot>
>         </span>
>         <button v-if="!withOkButton" class="_button" @click="$emit('close')">
>           <i class="fas fa-times"></i>
>         </button>
>         <button
>           v-if="withOkButton"
>           class="_button"
>           :disabled="okButtonDisabled"
>           @click="$emit('ok')"
>         >
>           <i class="fas fa-check"></i>
>         </button>
>       </div>
>       <div class="body">
>         <slot :width="bodyWidth" :height="bodyHeight"></slot>
>       </div>
>     </div>
>   </MkModal>
20,21c50,51
< import { onMounted, onUnmounted } from 'vue';
< import MkModal from './MkModal.vue';
---
> import { onMounted, onUnmounted } from "vue";
> import MkModal from "./MkModal.vue";
23,35c53,68
< const props = withDefaults(defineProps<{
< 	withOkButton: boolean;
< 	okButtonDisabled: boolean;
< 	width: number;
< 	height: number | null;
< 	scroll: boolean;
< }>(), {
< 	withOkButton: false,
< 	okButtonDisabled: false,
< 	width: 400,
< 	height: null,
< 	scroll: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     withOkButton: boolean;
>     okButtonDisabled: boolean;
>     width: number;
>     height: number | null;
>     scroll: boolean;
>   }>(),
>   {
>     withOkButton: false,
>     okButtonDisabled: false,
>     width: 400,
>     height: null,
>     scroll: true,
>   }
> );
38,41c71,74
< 	(event: 'click'): void;
< 	(event: 'close'): void;
< 	(event: 'closed'): void;
< 	(event: 'ok'): void;
---
>   (event: "click"): void;
>   (event: "close"): void;
>   (event: "closed"): void;
>   (event: "ok"): void;
44,46c77,79
< let modal = $shallowRef<InstanceType<typeof MkModal>>();
< let rootEl = $shallowRef<HTMLElement>();
< let headerEl = $shallowRef<HTMLElement>();
---
> let modal = $ref<InstanceType<typeof MkModal>>();
> let rootEl = $ref<HTMLElement>();
> let headerEl = $ref<HTMLElement>();
51c84
< 	modal.close();
---
>   modal.close();
55c88
< 	emit('click');
---
>   emit("click");
59,63c92,97
< 	if (evt.which === 27) { // Esc
< 		evt.preventDefault();
< 		evt.stopPropagation();
< 		close();
< 	}
---
>   if (evt.which === 27) {
>     // Esc
>     evt.preventDefault();
>     evt.stopPropagation();
>     close();
>   }
67,68c101,102
< 	bodyWidth = rootEl.offsetWidth;
< 	bodyHeight = rootEl.offsetHeight - headerEl.offsetHeight;
---
>   bodyWidth = rootEl.offsetWidth;
>   bodyHeight = rootEl.offsetHeight - headerEl.offsetHeight;
72,74c106,108
< 	bodyWidth = rootEl.offsetWidth;
< 	bodyHeight = rootEl.offsetHeight - headerEl.offsetHeight;
< 	ro.observe(rootEl);
---
>   bodyWidth = rootEl.offsetWidth;
>   bodyHeight = rootEl.offsetHeight - headerEl.offsetHeight;
>   ro.observe(rootEl);
78c112
< 	ro.disconnect();
---
>   ro.disconnect();
82c116
< 	close,
---
>   close,
88,94c122,126
< 	margin: auto;
< 	overflow: hidden;
< 	display: flex;
< 	flex-direction: column;
< 	contain: content;
< 	container-type: inline-size;
< 	border-radius: var(--radius);
---
>   overflow: hidden;
>   display: flex;
>   flex-direction: column;
>   contain: content;
>   border-radius: var(--radius);
96c128
< 	--root-margin: 24px;
---
>   --root-margin: 24px;
98,100c130,132
< 	@media (max-width: 500px) {
< 		--root-margin: 16px;
< 	}
---
>   @media (max-width: 500px) {
>     --root-margin: 16px;
>   }
102,109c134,141
< 	> .header {
< 		$height: 46px;
< 		$height-narrow: 42px;
< 		display: flex;
< 		flex-shrink: 0;
< 		background: var(--windowHeader);
< 		-webkit-backdrop-filter: var(--blur, blur(15px));
< 		backdrop-filter: var(--blur, blur(15px));
---
>   > .header {
>     $height: 46px;
>     $height-narrow: 42px;
>     display: flex;
>     flex-shrink: 0;
>     background: var(--windowHeader);
>     -webkit-backdrop-filter: var(--blur, blur(15px));
>     backdrop-filter: var(--blur, blur(15px));
111,113c143,145
< 		> button {
< 			height: $height;
< 			width: $height;
---
>     > button {
>       height: $height;
>       width: $height;
115,119c147,151
< 			@media (max-width: 500px) {
< 				height: $height-narrow;
< 				width: $height-narrow;
< 			}
< 		}
---
>       @media (max-width: 500px) {
>         height: $height-narrow;
>         width: $height-narrow;
>       }
>     }
121,129c153,161
< 		> .title {
< 			flex: 1;
< 			line-height: $height;
< 			padding-left: 32px;
< 			font-weight: bold;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			pointer-events: none;
---
>     > .title {
>       flex: 1;
>       line-height: $height;
>       padding-left: 32px;
>       font-weight: bold;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       pointer-events: none;
131,135c163,167
< 			@media (max-width: 500px) {
< 				line-height: $height-narrow;
< 				padding-left: 16px;
< 			}
< 		}
---
>       @media (max-width: 500px) {
>         line-height: $height-narrow;
>         padding-left: 16px;
>       }
>     }
137,140c169,172
< 		> button + .title {
< 			padding-left: 0;
< 		}
< 	}
---
>     > button + .title {
>       padding-left: 0;
>     }
>   }
142,146c174,178
< 	> .body {
< 		flex: 1;
< 		overflow: auto;
< 		background: var(--panel);
< 	}
---
>   > .body {
>     flex: 1;
>     overflow: auto;
>     background: var(--panel);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNote.vue RiricaV13/components/MkNote.vue
2,115c2,205
< <div
< 	v-if="!muted"
< 	v-show="!isDeleted"
< 	ref="el"
< 	v-hotkey="keymap"
< 	:class="$style.root"
< 	:tabindex="!isDeleted ? '-1' : null"
< >
< 	<MkNoteSub v-if="appearNote.reply" :note="appearNote.reply" :class="$style.replyTo"/>
< 	<div v-if="pinned" :class="$style.tip"><i class="ti ti-pin"></i> {{ i18n.ts.pinnedNote }}</div>
< 	<!--<div v-if="appearNote._prId_" class="tip"><i class="fas fa-bullhorn"></i> {{ i18n.ts.promotion }}<button class="_textButton hide" @click="readPromo()">{{ i18n.ts.hideThisNote }} <i class="ti ti-x"></i></button></div>-->
< 	<!--<div v-if="appearNote._featuredId_" class="tip"><i class="ti ti-bolt"></i> {{ i18n.ts.featured }}</div>-->
< 	<div v-if="isRenote" :class="$style.renote">
< 		<MkAvatar v-once :class="$style.renoteAvatar" :user="note.user" link preview/>
< 		<i class="ti ti-repeat" style="margin-right: 4px;"></i>
< 		<I18n :src="i18n.ts.renotedBy" tag="span" :class="$style.renoteText">
< 			<template #user>
< 				<MkA v-user-preview="note.userId" :class="$style.renoteUserName" :to="userPage(note.user)">
< 					<MkUserName :user="note.user"/>
< 				</MkA>
< 			</template>
< 		</I18n>
< 		<div :class="$style.renoteInfo">
< 			<button ref="renoteTime" :class="$style.renoteTime" class="_button" @click="showRenoteMenu()">
< 				<i v-if="isMyRenote" class="ti ti-dots" :class="$style.renoteMenu"></i>
< 				<MkTime :time="note.createdAt"/>
< 			</button>
< 			<span v-if="note.visibility !== 'public'" style="margin-left: 0.5em;" :title="i18n.ts._visibility[note.visibility]">
< 				<i v-if="note.visibility === 'home'" class="ti ti-home"></i>
< 				<i v-else-if="note.visibility === 'followers'" class="ti ti-lock"></i>
< 				<i v-else-if="note.visibility === 'specified'" ref="specified" class="ti ti-mail"></i>
< 			</span>
< 			<span v-if="note.localOnly" style="margin-left: 0.5em;" :title="i18n.ts._visibility['localOnly']"><i class="ti ti-world-off"></i></span>
< 		</div>
< 	</div>
< 	<article :class="$style.article" @contextmenu.stop="onContextmenu">
< 		<MkAvatar v-once :class="$style.avatar" :user="appearNote.user" link preview/>
< 		<div :class="$style.main">
< 			<MkNoteHeader :class="$style.header" :note="appearNote" :mini="true"/>
< 			<MkInstanceTicker v-if="showTicker" :class="$style.ticker" :instance="appearNote.user.instance"/>
< 			<div style="container-type: inline-size;">
< 				<p v-if="appearNote.cw != null" :class="$style.cw">
< 					<Mfm v-if="appearNote.cw != ''" style="margin-right: 8px;" :text="appearNote.cw" :author="appearNote.user" :i="$i"/>
< 					<MkCwButton v-model="showContent" :note="appearNote"/>
< 				</p>
< 				<div v-show="appearNote.cw == null || showContent" :class="[{ [$style.contentCollapsed]: collapsed }]">
< 					<div :class="$style.text">
< 						<span v-if="appearNote.isHidden" style="opacity: 0.5">({{ i18n.ts.private }})</span>
< 						<MkA v-if="appearNote.replyId" :class="$style.replyIcon" :to="`/notes/${appearNote.replyId}`"><i class="ti ti-arrow-back-up"></i></MkA>
< 						<Mfm v-if="appearNote.text" v-once :text="appearNote.text" :author="appearNote.user" :i="$i"/>
< 						<div v-if="translating || translation" :class="$style.translation">
< 							<MkLoading v-if="translating" mini/>
< 							<div v-else :class="$style.translated">
< 								<b>{{ $t('translatedFrom', { x: translation.sourceLang }) }}: </b>
< 								<Mfm :text="translation.text" :author="appearNote.user" :i="$i"/>
< 							</div>
< 						</div>
< 					</div>
< 					<div v-if="appearNote.files.length > 0" :class="$style.files">
< 						<MkMediaList :media-list="appearNote.files"/>
< 					</div>
< 					<MkPoll v-if="appearNote.poll" ref="pollViewer" :note="appearNote" :class="$style.poll"/>
< 					<MkUrlPreview v-for="url in urls" :key="url" :url="url" :compact="true" :detail="false" :class="$style.urlPreview"/>
< 					<div v-if="appearNote.renote" :class="$style.quote"><MkNoteSimple :note="appearNote.renote" :class="$style.quoteNote"/></div>
< 					<button v-if="isLong && collapsed" :class="$style.collapsed" class="_button" @click="collapsed = false">
< 						<span :class="$style.collapsedLabel">{{ i18n.ts.showMore }}</span>
< 					</button>
< 					<button v-else-if="isLong && !collapsed" :class="$style.showLess" class="_button" @click="collapsed = true">
< 						<span :class="$style.showLessLabel">{{ i18n.ts.showLess }}</span>
< 					</button>
< 				</div>
< 				<MkA v-if="appearNote.channel && !inChannel" :class="$style.channel" :to="`/channels/${appearNote.channel.id}`"><i class="ti ti-device-tv"></i> {{ appearNote.channel.name }}</MkA>
< 			</div>
< 			<footer :class="$style.footer">
< 				<MkReactionsViewer ref="reactionsViewer" :note="appearNote"/>
< 				<button :class="$style.footerButton" class="_button" @click="reply()">
< 					<i class="ti ti-arrow-back-up"></i>
< 					<p v-if="appearNote.repliesCount > 0" :class="$style.footerButtonCount">{{ appearNote.repliesCount }}</p>
< 				</button>
< 				<button
< 					v-if="canRenote"
< 					ref="renoteButton"
< 					:class="$style.footerButton"
< 					class="_button"
< 					@mousedown="renote()"
< 				>
< 					<i class="ti ti-repeat"></i>
< 					<p v-if="appearNote.renoteCount > 0" :class="$style.footerButtonCount">{{ appearNote.renoteCount }}</p>
< 				</button>
< 				<button v-else :class="$style.footerButton" class="_button" disabled>
< 					<i class="ti ti-ban"></i>
< 				</button>
< 				<button v-if="appearNote.myReaction == null" ref="reactButton" :class="$style.footerButton" class="_button" @mousedown="react()">
< 					<i class="ti ti-plus"></i>
< 				</button>
< 				<button v-if="appearNote.myReaction != null" ref="reactButton" :class="$style.footerButton" class="_button" @click="undoReact(appearNote)">
< 					<i class="ti ti-minus"></i>
< 				</button>
< 				<button ref="menuButton" :class="$style.footerButton" class="_button" @mousedown="menu()">
< 					<i class="ti ti-dots"></i>
< 				</button>
< 			</footer>
< 		</div>
< 	</article>
< </div>
< <div v-else :class="$style.muted" @click="muted = false">
< 	<I18n :src="i18n.ts.userSaysSomething" tag="small">
< 		<template #name>
< 			<MkA v-user-preview="appearNote.userId" :to="userPage(appearNote.user)">
< 				<MkUserName :user="appearNote.user"/>
< 			</MkA>
< 		</template>
< 	</I18n>
< </div>
---
>   <div
>     v-if="!muted"
>     v-show="!isDeleted"
>     ref="el"
>     v-hotkey="keymap"
>     v-size="{ max: [500, 450, 350, 300] }"
>     class="tkcbzcuz"
>     :tabindex="!isDeleted ? '-1' : null"
>     :class="{ renote: isRenote }"
>   >
>     <MkNoteSub
>       v-if="appearNote.reply"
>       :note="appearNote.reply"
>       class="reply-to"
>     />
>     <div v-if="pinned" class="info">
>       <i class="fas fa-thumbtack"></i> {{ i18n.ts.pinnedNote }}
>     </div>
>     <div v-if="appearNote._prId_" class="info">
>       <i class="fas fa-bullhorn"></i> {{ i18n.ts.promotion
>       }}<button class="_textButton hide" @click="readPromo()">
>         {{ i18n.ts.hideThisNote }} <i class="fas fa-times"></i>
>       </button>
>     </div>
>     <div v-if="appearNote._featuredId_" class="info">
>       <i class="fas fa-bolt"></i> {{ i18n.ts.featured }}
>     </div>
>     <div v-if="isRenote" class="renote">
>       <MkAvatar class="avatar" :user="note.user" />
>       <i class="fas fa-retweet"></i>
>       <I18n :src="i18n.ts.renotedBy" tag="span">
>         <template #user>
>           <MkA
>             v-user-preview="note.userId"
>             class="name"
>             :to="userPage(note.user)"
>           >
>             <MkUserName :user="note.user" />
>           </MkA>
>         </template>
>       </I18n>
>       <div class="info">
>         <button ref="renoteTime" class="_button time" @click="showRenoteMenu()">
>           <i v-if="isMyRenote" class="fas fa-ellipsis-h dropdownIcon"></i>
>           <MkTime :time="note.createdAt" />
>         </button>
>         <MkVisibility :note="note" />
>       </div>
>     </div>
>     <article class="article" @contextmenu.stop="onContextmenu">
>       <MkAvatar class="avatar" :user="appearNote.user" />
>       <div class="main">
>         <XNoteHeader class="header" :note="appearNote" :mini="true" />
>         <MkInstanceTicker
>           v-if="showTicker"
>           class="ticker"
>           :instance="appearNote.user.instance"
>         />
>         <div class="body">
>           <p v-if="appearNote.cw != null" class="cw">
>             <Mfm
>               v-if="appearNote.cw != ''"
>               class="text"
>               :text="appearNote.cw"
>               :author="appearNote.user"
>               :i="$i"
>               :custom-emojis="appearNote.emojis"
>             />
>             <XCwButton v-model="showContent" :note="appearNote" />
>           </p>
>           <div
>             v-show="appearNote.cw == null || showContent"
>             class="content"
>             :class="{ collapsed, isLong }"
>           >
>             <div class="text">
>               <span v-if="appearNote.isHidden" style="opacity: 0.5"
>                 >({{ i18n.ts.private }})</span
>               >
>               <MkA
>                 v-if="appearNote.replyId"
>                 class="reply"
>                 :to="`/notes/${appearNote.replyId}`"
>                 ><i class="fas fa-reply"></i
>               ></MkA>
>               <Mfm
>                 v-if="appearNote.text"
>                 :text="appearNote.text"
>                 :author="appearNote.user"
>                 :i="$i"
>                 :custom-emojis="appearNote.emojis"
>               />
>               <a v-if="appearNote.renote != null" class="rp">RN:</a>
>               <div v-if="translating || translation" class="translation">
>                 <MkLoading v-if="translating" mini />
>                 <div v-else class="translated">
>                   <b
>                     >{{ $t("translatedFrom", { x: translation.sourceLang }) }}:
>                   </b>
>                   <Mfm
>                     :text="translation.text"
>                     :author="appearNote.user"
>                     :i="$i"
>                     :custom-emojis="appearNote.emojis"
>                   />
>                 </div>
>               </div>
>             </div>
>             <div v-if="appearNote.files.length > 0" class="files">
>               <XMediaList :media-list="appearNote.files" />
>             </div>
>             <XPoll
>               v-if="appearNote.poll"
>               ref="pollViewer"
>               :note="appearNote"
>               class="poll"
>             />
>             <MkUrlPreview
>               v-for="url in urls"
>               :key="url"
>               :url="url"
>               :compact="true"
>               :detail="false"
>               class="url-preview"
>             />
>             <div v-if="appearNote.renote" class="renote">
>               <XNoteSimple :note="appearNote.renote" />
>             </div>
>             <button
>               v-if="isLong && collapsed"
>               class="fade _button"
>               @click="collapsed = false"
>             >
>               <span>{{ i18n.ts.showMore }}</span>
>             </button>
>             <button
>               v-else-if="isLong && !collapsed"
>               class="showLess _button"
>               @click="collapsed = true"
>             >
>               <span>{{ i18n.ts.showLess }}</span>
>             </button>
>           </div>
>           <MkA
>             v-if="appearNote.channel && !inChannel"
>             class="channel"
>             :to="`/channels/${appearNote.channel.id}`"
>             ><i class="fas fa-satellite-dish"></i>
>             {{ appearNote.channel.name }}</MkA
>           >
>         </div>
>         <footer class="footer">
>           <XReactionsViewer ref="reactionsViewer" :note="appearNote" />
>           <button class="button _button" @click="reply()">
>             <template v-if="appearNote.reply"
>               ><i class="fas fa-reply-all"></i
>             ></template>
>             <template v-else><i class="fas fa-reply"></i></template>
>             <p v-if="appearNote.repliesCount > 0" class="count">
>               {{ appearNote.repliesCount }}
>             </p>
>           </button>
>           <XRenoteButton
>             ref="renoteButton"
>             class="button"
>             :note="appearNote"
>             :count="appearNote.renoteCount"
>           />
>           <button
>             v-if="appearNote.myReaction == null"
>             ref="reactButton"
>             class="button _button"
>             @click="react()"
>           >
>             <i class="fas fa-plus"></i>
>           </button>
>           <button
>             v-if="appearNote.myReaction != null"
>             ref="reactButton"
>             class="button _button reacted"
>             @click="undoReact(appearNote)"
>           >
>             <i class="fas fa-minus"></i>
>           </button>
>           <button ref="menuButton" class="button _button" @click="menu()">
>             <i class="fas fa-ellipsis-h"></i>
>           </button>
>         </footer>
>       </div>
>     </article>
>   </div>
>   <div v-else class="muted" @click="muted = false">
>     <I18n :src="i18n.ts.userSaysSomething" tag="small">
>       <template #name>
>         <MkA
>           v-user-preview="appearNote.userId"
>           class="name"
>           :to="userPage(appearNote.user)"
>         >
>           <MkUserName :user="appearNote.user" />
>         </MkA>
>       </template>
>     </I18n>
>   </div>
119,146c209,243
< import { computed, inject, onMounted, onUnmounted, reactive, ref, shallowRef, Ref } from 'vue';
< import * as mfm from 'mfm-js';
< import * as misskey from 'misskey-js';
< import MkNoteSub from '@/components/MkNoteSub.vue';
< import MkNoteHeader from '@/components/MkNoteHeader.vue';
< import MkNoteSimple from '@/components/MkNoteSimple.vue';
< import MkReactionsViewer from '@/components/MkReactionsViewer.vue';
< import MkMediaList from '@/components/MkMediaList.vue';
< import MkCwButton from '@/components/MkCwButton.vue';
< import MkPoll from '@/components/MkPoll.vue';
< import MkUsersTooltip from '@/components/MkUsersTooltip.vue';
< import MkUrlPreview from '@/components/MkUrlPreview.vue';
< import MkInstanceTicker from '@/components/MkInstanceTicker.vue';
< import { pleaseLogin } from '@/scripts/please-login';
< import { focusPrev, focusNext } from '@/scripts/focus';
< import { checkWordMute } from '@/scripts/check-word-mute';
< import { userPage } from '@/filters/user';
< import * as os from '@/os';
< import { defaultStore, noteViewInterruptors } from '@/store';
< import { reactionPicker } from '@/scripts/reaction-picker';
< import { extractUrlFromMfm } from '@/scripts/extract-url-from-mfm';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { getNoteMenu } from '@/scripts/get-note-menu';
< import { useNoteCapture } from '@/scripts/use-note-capture';
< import { deepClone } from '@/scripts/clone';
< import { useTooltip } from '@/scripts/use-tooltip';
< import { claimAchievement } from '@/scripts/achievements';
---
> import {
>   computed,
>   inject,
>   onMounted,
>   onUnmounted,
>   reactive,
>   ref,
>   Ref,
> } from "vue";
> import * as mfm from "mfm-js";
> import * as misskey from "misskey-js";
> import MkNoteSub from "@/components/MkNoteSub.vue";
> import XNoteHeader from "@/components/MkNoteHeader.vue";
> import XNoteSimple from "@/components/MkNoteSimple.vue";
> import XReactionsViewer from "@/components/MkReactionsViewer.vue";
> import XMediaList from "@/components/MkMediaList.vue";
> import XCwButton from "@/components/MkCwButton.vue";
> import XPoll from "@/components/MkPoll.vue";
> import XRenoteButton from "@/components/MkRenoteButton.vue";
> import MkUrlPreview from "@/components/MkUrlPreview.vue";
> import MkInstanceTicker from "@/components/MkInstanceTicker.vue";
> import MkVisibility from "@/components/MkVisibility.vue";
> import { pleaseLogin } from "@/scripts/please-login";
> import { focusPrev, focusNext } from "@/scripts/focus";
> import { checkWordMute } from "@/scripts/check-word-mute";
> import { userPage } from "@/filters/user";
> import * as os from "@/os";
> import { defaultStore, noteViewInterruptors } from "@/store";
> import { reactionPicker } from "@/scripts/reaction-picker";
> import { extractUrlFromMfm } from "@/scripts/extract-url-from-mfm";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { getNoteMenu } from "@/scripts/get-note-menu";
> import { useNoteCapture } from "@/scripts/use-note-capture";
> import { deepClone } from "@/scripts/clone";
149,150c246,247
< 	note: misskey.entities.Note;
< 	pinned?: boolean;
---
>   note: misskey.entities.Note;
>   pinned?: boolean;
153c250
< const inChannel = inject('inChannel', null);
---
> const inChannel = inject("inChannel", null);
159,165c256,262
< 	onMounted(async () => {
< 		let result = deepClone(note);
< 		for (const interruptor of noteViewInterruptors) {
< 			result = await interruptor.handler(result);
< 		}
< 		note = result;
< 	});
---
>   onMounted(async () => {
>     let result = deepClone(note);
>     for (const interruptor of noteViewInterruptors) {
>       result = await interruptor.handler(result);
>     }
>     note = result;
>   });
168,173c265,269
< const isRenote = (
< 	note.renote != null &&
< 	note.text == null &&
< 	note.fileIds.length === 0 &&
< 	note.poll == null
< );
---
> const isRenote =
>   note.renote != null &&
>   note.text == null &&
>   note.fileIds.length === 0 &&
>   note.poll == null;
175,181c271,279
< const el = shallowRef<HTMLElement>();
< const menuButton = shallowRef<HTMLElement>();
< const renoteButton = shallowRef<HTMLElement>();
< const renoteTime = shallowRef<HTMLElement>();
< const reactButton = shallowRef<HTMLElement>();
< let appearNote = $computed(() => isRenote ? note.renote as misskey.entities.Note : note);
< const isMyRenote = $i && ($i.id === note.userId);
---
> const el = ref<HTMLElement>();
> const menuButton = ref<HTMLElement>();
> const renoteButton = ref<InstanceType<typeof XRenoteButton>>();
> const renoteTime = ref<HTMLElement>();
> const reactButton = ref<HTMLElement>();
> let appearNote = $computed(() =>
>   isRenote ? (note.renote as misskey.entities.Note) : note
> );
> const isMyRenote = $i && $i.id === note.userId;
183,186c281,284
< const isLong = (appearNote.cw == null && appearNote.text != null && (
< 	(appearNote.text.split('\n').length > 9) ||
< 	(appearNote.text.length > 500)
< ));
---
> const isLong =
>   appearNote.cw == null &&
>   appearNote.text != null &&
>   (appearNote.text.split("\n").length > 9 || appearNote.text.length > 500);
192,194c290,295
< const urls = appearNote.text ? extractUrlFromMfm(mfm.parse(appearNote.text)) : null;
< const showTicker = (defaultStore.state.instanceTicker === 'always') || (defaultStore.state.instanceTicker === 'remote' && appearNote.user.instance);
< const canRenote = computed(() => ['public', 'home'].includes(appearNote.visibility) || appearNote.userId === $i.id);
---
> const urls = appearNote.text
>   ? extractUrlFromMfm(mfm.parse(appearNote.text))
>   : null;
> const showTicker =
>   defaultStore.state.instanceTicker === "always" ||
>   (defaultStore.state.instanceTicker === "remote" && appearNote.user.instance);
197,204c298,305
< 	'r': () => reply(true),
< 	'e|a|plus': () => react(true),
< 	'q': () => renoteButton.value.renote(true),
< 	'up|k|shift+tab': focusBefore,
< 	'down|j|tab': focusAfter,
< 	'esc': blur,
< 	'm|o': () => menu(true),
< 	's': () => showContent.value !== showContent.value,
---
>   r: () => reply(true),
>   "e|a|plus": () => react(true),
>   q: () => renoteButton.value.renote(true),
>   "up|k|shift+tab": focusBefore,
>   "down|j|tab": focusAfter,
>   esc: blur,
>   "m|o": () => menu(true),
>   s: () => showContent.value !== showContent.value,
208,210c309,311
< 	rootEl: el,
< 	note: $$(appearNote),
< 	isDeletedRef: isDeleted,
---
>   rootEl: el,
>   note: $$(appearNote),
>   isDeletedRef: isDeleted,
213,253d313
< useTooltip(renoteButton, async (showing) => {
< 	const renotes = await os.api('notes/renotes', {
< 		noteId: appearNote.id,
< 		limit: 11,
< 	});
< 
< 	const users = renotes.map(x => x.user);
< 
< 	if (users.length < 1) return;
< 
< 	os.popup(MkUsersTooltip, {
< 		showing,
< 		users,
< 		count: appearNote.renoteCount,
< 		targetElement: renoteButton.value,
< 	}, {}, 'closed');
< });
< 
< function renote(viaKeyboard = false) {
< 	pleaseLogin();
< 	os.popupMenu([{
< 		text: i18n.ts.renote,
< 		icon: 'ti ti-repeat',
< 		action: () => {
< 			os.api('notes/create', {
< 				renoteId: appearNote.id,
< 			});
< 		},
< 	}, {
< 		text: i18n.ts.quote,
< 		icon: 'ti ti-quote',
< 		action: () => {
< 			os.post({
< 				renote: appearNote,
< 			});
< 		},
< 	}], renoteButton.value, {
< 		viaKeyboard,
< 	});
< }
< 
255,261c315,324
< 	pleaseLogin();
< 	os.post({
< 		reply: appearNote,
< 		animation: !viaKeyboard,
< 	}, () => {
< 		focus();
< 	});
---
>   pleaseLogin();
>   os.post(
>     {
>       reply: appearNote,
>       animation: !viaKeyboard,
>     },
>     () => {
>       focus();
>     }
>   );
265,277c328,341
< 	pleaseLogin();
< 	blur();
< 	reactionPicker.show(reactButton.value, reaction => {
< 		os.api('notes/reactions/create', {
< 			noteId: appearNote.id,
< 			reaction: reaction,
< 		});
< 		if (appearNote.text && appearNote.text.length > 100 && (Date.now() - new Date(appearNote.createdAt).getTime() < 1000 * 3)) {
< 			claimAchievement('reactWithoutRead');
< 		}
< 	}, () => {
< 		focus();
< 	});
---
>   pleaseLogin();
>   blur();
>   reactionPicker.show(
>     reactButton.value,
>     (reaction) => {
>       os.api("notes/reactions/create", {
>         noteId: appearNote.id,
>         reaction: reaction,
>       });
>     },
>     () => {
>       focus();
>     }
>   );
281,285c345,349
< 	const oldReaction = note.myReaction;
< 	if (!oldReaction) return;
< 	os.api('notes/reactions/delete', {
< 		noteId: note.id,
< 	});
---
>   const oldReaction = note.myReaction;
>   if (!oldReaction) return;
>   os.api("notes/reactions/delete", {
>     noteId: note.id,
>   });
288c352,355
< const currentClipPage = inject<Ref<misskey.entities.Clip> | null>('currentClipPage', null);
---
> const currentClipPage = inject<Ref<misskey.entities.Clip> | null>(
>   "currentClipPage",
>   null
> );
291,298c358,365
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target)) return;
< 	if (window.getSelection().toString() !== '') return;
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target)) return;
>   if (window.getSelection().toString() !== "") return;
300,305c367,382
< 	if (defaultStore.state.useReactionPickerForContextMenu) {
< 		ev.preventDefault();
< 		react();
< 	} else {
< 		os.contextMenu(getNoteMenu({ note: note, translating, translation, menuButton, isDeleted, currentClipPage }), ev).then(focus);
< 	}
---
>   if (defaultStore.state.useReactionPickerForContextMenu) {
>     ev.preventDefault();
>     react();
>   } else {
>     os.contextMenu(
>       getNoteMenu({
>         note: note,
>         translating,
>         translation,
>         menuButton,
>         isDeleted,
>         currentClipPage,
>       }),
>       ev
>     ).then(focus);
>   }
309,311c386,399
< 	os.popupMenu(getNoteMenu({ note: note, translating, translation, menuButton, isDeleted, currentClipPage }), menuButton.value, {
< 		viaKeyboard,
< 	}).then(focus);
---
>   os.popupMenu(
>     getNoteMenu({
>       note: note,
>       translating,
>       translation,
>       menuButton,
>       isDeleted,
>       currentClipPage,
>     }),
>     menuButton.value,
>     {
>       viaKeyboard,
>     }
>   ).then(focus);
315,328c403,422
< 	if (!isMyRenote) return;
< 	os.popupMenu([{
< 		text: i18n.ts.unrenote,
< 		icon: 'ti ti-trash',
< 		danger: true,
< 		action: () => {
< 			os.api('notes/delete', {
< 				noteId: note.id,
< 			});
< 			isDeleted.value = true;
< 		},
< 	}], renoteTime.value, {
< 		viaKeyboard: viaKeyboard,
< 	});
---
>   if (!isMyRenote) return;
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.unrenote,
>         icon: "fas fa-trash-alt",
>         danger: true,
>         action: () => {
>           os.api("notes/delete", {
>             noteId: note.id,
>           });
>           isDeleted.value = true;
>         },
>       },
>     ],
>     renoteTime.value,
>     {
>       viaKeyboard: viaKeyboard,
>     }
>   );
332c426
< 	el.value.focus();
---
>   el.value.focus();
336c430
< 	el.value.blur();
---
>   el.value.blur();
340c434
< 	focusPrev(el.value);
---
>   focusPrev(el.value);
344c438
< 	focusNext(el.value);
---
>   focusNext(el.value);
348,351c442,445
< 	os.api('promo/read', {
< 		noteId: appearNote.id,
< 	});
< 	isDeleted.value = true;
---
>   os.api("promo/read", {
>     noteId: appearNote.id,
>   });
>   isDeleted.value = true;
355,361c449,455
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	transition: box-shadow 0.1s ease;
< 	font-size: 1.05em;
< 	overflow: clip;
< 	contain: content;
---
> <style lang="scss" scoped>
> .tkcbzcuz {
>   position: relative;
>   transition: box-shadow 0.1s ease;
>   font-size: 1.05em;
>   overflow: clip;
>   contain: content;
363,368c457,462
< 	// これらの指定はパフォーマンス向上には有効だが、ノートの高さは一定でないため、
< 	// 下の方までスクロールすると上のノートの高さがここで決め打ちされたものに変化し、表示しているノートの位置が変わってしまう
< 	// ノートがマウントされたときに自身の高さを取得し contain-intrinsic-size を設定しなおせばほぼ解決できそうだが、
< 	// 今度はその処理自体がパフォーマンス低下の原因にならないか懸念される。また、被リアクションでも高さは変化するため、やはり多少のズレは生じる
< 	// 一度レンダリングされた要素はブラウザがよしなにサイズを覚えておいてくれるような実装になるまで待った方が良さそう(なるのか？)
< 	//content-visibility: auto;
---
>   // これらの指定はパフォーマンス向上には有効だが、ノートの高さは一定でないため、
>   // 下の方までスクロールすると上のノートの高さがここで決め打ちされたものに変化し、表示しているノートの位置が変わってしまう
>   // ノートがマウントされたときに自身の高さを取得し contain-intrinsic-size を設定しなおせばほぼ解決できそうだが、
>   // 今度はその処理自体がパフォーマンス低下の原因にならないか懸念される。また、被リアクションでも高さは変化するため、やはり多少のズレは生じる
>   // 一度レンダリングされた要素はブラウザがよしなにサイズを覚えておいてくれるような実装になるまで待った方が良さそう(なるのか？)
>   //content-visibility: auto;
371,372c465,466
< 	&:focus-visible {
< 		outline: none;
---
>   &:focus-visible {
>     outline: none;
374,391c468,485
< 		&:after {
< 			content: "";
< 			pointer-events: none;
< 			display: block;
< 			position: absolute;
< 			z-index: 10;
< 			top: 0;
< 			left: 0;
< 			right: 0;
< 			bottom: 0;
< 			margin: auto;
< 			width: calc(100% - 8px);
< 			height: calc(100% - 8px);
< 			border: dashed 1px var(--focus);
< 			border-radius: var(--radius);
< 			box-sizing: border-box;
< 		}
< 	}
---
>     &:after {
>       content: "";
>       pointer-events: none;
>       display: block;
>       position: absolute;
>       z-index: 10;
>       top: 0;
>       left: 0;
>       right: 0;
>       bottom: 0;
>       margin: auto;
>       width: calc(100% - 8px);
>       height: calc(100% - 8px);
>       border: dashed 1px var(--focus);
>       border-radius: var(--radius);
>       box-sizing: border-box;
>     }
>   }
393,396c487,489
< 	&:hover > .article > .main > .footer > .footerButton {
< 		opacity: 1;
< 	}
< }
---
>   &:hover > .article > .main > .footer > .button {
>     opacity: 1;
>   }
398,406c491,498
< .tip {
< 	display: flex;
< 	align-items: center;
< 	padding: 16px 32px 8px 32px;
< 	line-height: 24px;
< 	font-size: 90%;
< 	white-space: pre;
< 	color: #d28a3f;
< }
---
>   > .info {
>     display: flex;
>     align-items: center;
>     padding: 16px 32px 8px 32px;
>     line-height: 24px;
>     font-size: 90%;
>     white-space: pre;
>     color: #d28a3f;
408,410c500,502
< .tip + .article {
< 	padding-top: 8px;
< }
---
>     > i {
>       margin-right: 4px;
>     }
412,415c504,508
< .replyTo {
< 	opacity: 0.7;
< 	padding-bottom: 0;
< }
---
>     > .hide {
>       margin-left: auto;
>       color: inherit;
>     }
>   }
417,423c510,512
< .renote {
< 	display: flex;
< 	align-items: center;
< 	padding: 16px 32px 8px 32px;
< 	line-height: 28px;
< 	white-space: pre;
< 	color: var(--renote);
---
>   > .info + .article {
>     padding-top: 8px;
>   }
425,428c514,517
< 	& + .article {
< 		padding-top: 8px;
< 	}
< }
---
>   > .reply-to {
>     opacity: 0.7;
>     padding-bottom: 0;
>   }
430,437c519,525
< .renoteAvatar {
< 	flex-shrink: 0;
< 	display: inline-block;
< 	width: 28px;
< 	height: 28px;
< 	margin: 0 8px 0 0;
< 	border-radius: 6px;
< }
---
>   > .renote {
>     display: flex;
>     align-items: center;
>     padding: 16px 32px 8px 32px;
>     line-height: 28px;
>     white-space: pre;
>     color: var(--renote);
439,444c527,534
< .renoteText {
< 	overflow: hidden;
< 	flex-shrink: 1;
< 	text-overflow: ellipsis;
< 	white-space: nowrap;
< }
---
>     > .avatar {
>       flex-shrink: 0;
>       display: inline-block;
>       width: 28px;
>       height: 28px;
>       margin: 0 8px 0 0;
>       border-radius: 6px;
>     }
446,448c536,538
< .renoteUserName {
< 	font-weight: bold;
< }
---
>     > i {
>       margin-right: 4px;
>     }
450,453c540,544
< .renoteInfo {
< 	margin-left: auto;
< 	font-size: 0.9em;
< }
---
>     > span {
>       overflow: hidden;
>       flex-shrink: 1;
>       text-overflow: ellipsis;
>       white-space: nowrap;
455,458c546,549
< .renoteTime {
< 	flex-shrink: 0;
< 	color: inherit;
< }
---
>       > .name {
>         font-weight: bold;
>       }
>     }
460,462c551,553
< .renoteMenu {
< 	margin-right: 4px;
< }
---
>     > .info {
>       margin-left: auto;
>       font-size: 0.9em;
464,467c555,557
< .article {
< 	display: flex;
< 	padding: 28px 32px 18px;
< }
---
>       > .time {
>         flex-shrink: 0;
>         color: inherit;
469,478c559,564
< .avatar {
< 	flex-shrink: 0;
< 	display: block !important;
< 	margin: 0 14px 8px 0;
< 	width: 58px;
< 	height: 58px;
< 	position: sticky !important;
< 	top: calc(22px + var(--stickyTop, 0px));
< 	left: 0;
< }
---
>         > .dropdownIcon {
>           margin-right: 4px;
>         }
>       }
>     }
>   }
480,483c566,568
< .main {
< 	flex: 1;
< 	min-width: 0;
< }
---
>   > .renote + .article {
>     padding-top: 8px;
>   }
485,491c570,572
< .cw {
< 	cursor: default;
< 	display: block;
< 	margin: 0;
< 	padding: 0;
< 	overflow-wrap: break-word;
< }
---
>   > .article {
>     display: flex;
>     padding: 28px 32px 18px;
493,498c574,583
< .showLess {
< 	width: 100%;
< 	margin-top: 1em;
< 	position: sticky;
< 	bottom: 1em;
< }
---
>     > .avatar {
>       flex-shrink: 0;
>       display: block;
>       margin: 0 14px 8px 0;
>       width: 58px;
>       height: 58px;
>       position: sticky;
>       top: calc(22px + var(--stickyTop, 0px));
>       left: 0;
>     }
500,507c585,587
< .showLessLabel {
< 	display: inline-block;
< 	background: var(--popup);
< 	padding: 6px 10px;
< 	font-size: 0.8em;
< 	border-radius: 999px;
< 	box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
< }
---
>     > .main {
>       flex: 1;
>       min-width: 0;
509,513c589,595
< .contentCollapsed {
< 	position: relative;
< 	max-height: 9em;
< 	overflow: clip;
< }
---
>       > .body {
>         > .cw {
>           cursor: default;
>           display: block;
>           margin: 0;
>           padding: 0;
>           overflow-wrap: break-word;
515,522c597,600
< .collapsed {
< 	display: block;
< 	position: absolute;
< 	bottom: 0;
< 	left: 0;
< 	width: 100%;
< 	height: 64px;
< 	background: linear-gradient(0deg, var(--panel), var(--X15));
---
>           > .text {
>             margin-right: 8px;
>           }
>         }
524,527c602,608
< 	&:hover > .collapsedLabel {
< 		background: var(--panelHighlight);
< 	}
< }
---
>         > .content {
>           &.isLong {
>             > .showLess {
>               width: 100%;
>               margin-top: 1em;
>               position: sticky;
>               bottom: 1em;
529,536c610,619
< .collapsedLabel {
< 	display: inline-block;
< 	background: var(--panel);
< 	padding: 6px 10px;
< 	font-size: 0.8em;
< 	border-radius: 999px;
< 	box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
< }
---
>               > span {
>                 display: inline-block;
>                 background: var(--popup);
>                 padding: 6px 10px;
>                 font-size: 0.8em;
>                 border-radius: 999px;
>                 box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
>               }
>             }
>           }
538,540c621,624
< .text {
< 	overflow-wrap: break-word;
< }
---
>           &.collapsed {
>             position: relative;
>             max-height: 9em;
>             overflow: hidden;
542,545c626,633
< .replyIcon {
< 	color: var(--accent);
< 	margin-right: 0.5em;
< }
---
>             > .fade {
>               display: block;
>               position: absolute;
>               bottom: 0;
>               left: 0;
>               width: 100%;
>               height: 64px;
>               background: linear-gradient(0deg, var(--panel), var(--X15));
547,552c635,642
< .translation {
< 	border: solid 0.5px var(--divider);
< 	border-radius: var(--radius);
< 	padding: 12px;
< 	margin-top: 8px;
< }
---
>               > span {
>                 display: inline-block;
>                 background: var(--panel);
>                 padding: 6px 10px;
>                 font-size: 0.8em;
>                 border-radius: 999px;
>                 box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
>               }
554,556c644,650
< .urlPreview {
< 	margin-top: 8px;
< }
---
>               &:hover {
>                 > span {
>                   background: var(--panelHighlight);
>                 }
>               }
>             }
>           }
558,560c652,653
< .poll {
< 	font-size: 80%;
< }
---
>           > .text {
>             overflow-wrap: break-word;
562,564c655,658
< .quote {
< 	padding: 8px 0;
< }
---
>             > .reply {
>               color: var(--accent);
>               margin-right: 0.5em;
>             }
566,570c660,664
< .quoteNote {
< 	padding: 16px;
< 	border: dashed 1px var(--renote);
< 	border-radius: 8px;
< }
---
>             > .rp {
>               margin-left: 4px;
>               font-style: oblique;
>               color: var(--renote);
>             }
572,575c666,672
< .channel {
< 	opacity: 0.7;
< 	font-size: 80%;
< }
---
>             > .translation {
>               border: solid 0.5px var(--divider);
>               border-radius: var(--radius);
>               padding: 12px;
>               margin-top: 8px;
>             }
>           }
577,580c674,676
< .footerButton {
< 	margin: 0;
< 	padding: 8px;
< 	opacity: 0.7;
---
>           > .url-preview {
>             margin-top: 8px;
>           }
582,584c678,680
< 	&:not(:last-child) {
< 		margin-right: 28px;
< 	}
---
>           > .poll {
>             font-size: 80%;
>           }
586,589c682,683
< 	&:hover {
< 		color: var(--fgHighlighted);
< 	}
< }
---
>           > .renote {
>             padding: 8px 0;
591,595c685,691
< .footerButtonCount {
< 	display: inline;
< 	margin: 0 0 0 8px;
< 	opacity: 0.7;
< }
---
>             > * {
>               padding: 16px;
>               border: dashed 1px var(--renote);
>               border-radius: 8px;
>             }
>           }
>         }
597,600c693,697
< @container (max-width: 500px) {
< 	.root {
< 		font-size: 0.9em;
< 	}
---
>         > .channel {
>           opacity: 0.7;
>           font-size: 80%;
>         }
>       }
602,606c699,703
< 	.avatar {
< 		width: 50px;
< 		height: 50px;
< 	}
< }
---
>       > .footer {
>         > .button {
>           margin: 0;
>           padding: 8px;
>           opacity: 0.7;
608,611c705,707
< @container (max-width: 450px) {
< 	.renote {
< 		padding: 8px 16px 0 16px;
< 	}
---
>           &:not(:last-child) {
>             margin-right: 28px;
>           }
613,615c709,711
< 	.tip {
< 		padding: 8px 16px 0 16px;
< 	}
---
>           &:hover {
>             color: var(--fgHighlighted);
>           }
617,619c713,717
< 	.article {
< 		padding: 14px 16px 9px;
< 	}
---
>           > .count {
>             display: inline;
>             margin: 0 0 0 8px;
>             opacity: 0.7;
>           }
621,627c719,725
< 	.avatar {
< 		margin: 0 10px 8px 0;
< 		width: 46px;
< 		height: 46px;
< 		top: calc(14px + var(--stickyTop, 0px));
< 	}
< }
---
>           &.reacted {
>             color: var(--accent);
>           }
>         }
>       }
>     }
>   }
629,635c727,729
< @container (max-width: 350px) {
< 	.footerButton {
< 		&:not(:last-child) {
< 			margin-right: 18px;
< 		}
< 	}
< }
---
>   > .reply {
>     border-top: solid 0.5px var(--divider);
>   }
637,641c731,732
< @container (max-width: 300px) {
< 	.avatar {
< 		width: 44px;
< 		height: 44px;
< 	}
---
>   &.max-width_500px {
>     font-size: 0.9em;
643,647c734,794
< 	.footerButton {
< 		&:not(:last-child) {
< 			margin-right: 12px;
< 		}
< 	}
---
>     > .article {
>       > .avatar {
>         width: 50px;
>         height: 50px;
>       }
>     }
>   }
> 
>   &.max-width_450px {
>     > .renote {
>       padding: 8px 16px 0 16px;
>     }
> 
>     > .info {
>       padding: 8px 16px 0 16px;
>     }
> 
>     > .article {
>       padding: 14px 16px 9px;
> 
>       > .avatar {
>         margin: 0 10px 8px 0;
>         width: 46px;
>         height: 46px;
>         top: calc(14px + var(--stickyTop, 0px));
>       }
>     }
>   }
> 
>   &.max-width_350px {
>     > .article {
>       > .main {
>         > .footer {
>           > .button {
>             &:not(:last-child) {
>               margin-right: 18px;
>             }
>           }
>         }
>       }
>     }
>   }
> 
>   &.max-width_300px {
>     > .article {
>       > .avatar {
>         width: 44px;
>         height: 44px;
>       }
> 
>       > .main {
>         > .footer {
>           > .button {
>             &:not(:last-child) {
>               margin-right: 12px;
>             }
>           }
>         }
>       }
>     }
>   }
651,653c798,800
< 	padding: 8px;
< 	text-align: center;
< 	opacity: 0.7;
---
>   padding: 8px;
>   text-align: center;
>   opacity: 0.7;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNoteDetailed.vue RiricaV13/components/MkNoteDetailed.vue
2,132c2,214
< <div
< 	v-if="!muted"
< 	v-show="!isDeleted"
< 	ref="el"
< 	v-hotkey="keymap"
< 	class="lxwezrsl"
< 	:tabindex="!isDeleted ? '-1' : null"
< 	:class="{ renote: isRenote }"
< >
< 	<MkNoteSub v-for="note in conversation" :key="note.id" class="reply-to-more" :note="note"/>
< 	<MkNoteSub v-if="appearNote.reply" :note="appearNote.reply" class="reply-to"/>
< 	<div v-if="isRenote" class="renote">
< 		<MkAvatar class="avatar" :user="note.user" link preview/>
< 		<i class="ti ti-repeat"></i>
< 		<I18n :src="i18n.ts.renotedBy" tag="span">
< 			<template #user>
< 				<MkA v-user-preview="note.userId" class="name" :to="userPage(note.user)">
< 					<MkUserName :user="note.user"/>
< 				</MkA>
< 			</template>
< 		</I18n>
< 		<div class="info">
< 			<button ref="renoteTime" class="_button time" @click="showRenoteMenu()">
< 				<i v-if="isMyRenote" class="ti ti-dots dropdownIcon"></i>
< 				<MkTime :time="note.createdAt"/>
< 			</button>
< 			<span v-if="note.visibility !== 'public'" style="margin-left: 0.5em;" :title="i18n.ts._visibility[note.visibility]">
< 				<i v-if="note.visibility === 'home'" class="ti ti-home"></i>
< 				<i v-else-if="note.visibility === 'followers'" class="ti ti-lock"></i>
< 				<i v-else-if="note.visibility === 'specified'" ref="specified" class="ti ti-mail"></i>
< 			</span>
< 			<span v-if="note.localOnly" style="margin-left: 0.5em;" :title="i18n.ts._visibility['localOnly']"><i class="ti ti-world-off"></i></span>
< 		</div>
< 	</div>
< 	<article class="article" @contextmenu.stop="onContextmenu">
< 		<header class="header">
< 			<MkAvatar class="avatar" :user="appearNote.user" indicator link preview/>
< 			<div class="body">
< 				<div class="top">
< 					<MkA v-user-preview="appearNote.user.id" class="name" :to="userPage(appearNote.user)">
< 						<MkUserName :nowrap="false" :user="appearNote.user"/>
< 					</MkA>
< 					<span v-if="appearNote.user.isBot" class="is-bot">bot</span>
< 					<div class="info">
< 						<span v-if="appearNote.visibility !== 'public'" style="margin-left: 0.5em;" :title="i18n.ts._visibility[appearNote.visibility]">
< 							<i v-if="appearNote.visibility === 'home'" class="ti ti-home"></i>
< 							<i v-else-if="appearNote.visibility === 'followers'" class="ti ti-lock"></i>
< 							<i v-else-if="appearNote.visibility === 'specified'" ref="specified" class="ti ti-mail"></i>
< 						</span>
< 						<span v-if="appearNote.localOnly" style="margin-left: 0.5em;" :title="i18n.ts._visibility['localOnly']"><i class="ti ti-world-off"></i></span>
< 					</div>
< 				</div>
< 				<div class="username"><MkAcct :user="appearNote.user"/></div>
< 				<MkInstanceTicker v-if="showTicker" class="ticker" :instance="appearNote.user.instance"/>
< 			</div>
< 		</header>
< 		<div class="main">
< 			<div class="body">
< 				<p v-if="appearNote.cw != null" class="cw">
< 					<Mfm v-if="appearNote.cw != ''" class="text" :text="appearNote.cw" :author="appearNote.user" :i="$i"/>
< 					<MkCwButton v-model="showContent" :note="appearNote"/>
< 				</p>
< 				<div v-show="appearNote.cw == null || showContent" class="content">
< 					<div class="text">
< 						<span v-if="appearNote.isHidden" style="opacity: 0.5">({{ i18n.ts.private }})</span>
< 						<MkA v-if="appearNote.replyId" class="reply" :to="`/notes/${appearNote.replyId}`"><i class="ti ti-arrow-back-up"></i></MkA>
< 						<Mfm v-if="appearNote.text" :text="appearNote.text" :author="appearNote.user" :i="$i"/>
< 						<a v-if="appearNote.renote != null" class="rp">RN:</a>
< 						<div v-if="translating || translation" class="translation">
< 							<MkLoading v-if="translating" mini/>
< 							<div v-else class="translated">
< 								<b>{{ $t('translatedFrom', { x: translation.sourceLang }) }}: </b>
< 								<Mfm :text="translation.text" :author="appearNote.user" :i="$i"/>
< 							</div>
< 						</div>
< 					</div>
< 					<div v-if="appearNote.files.length > 0" class="files">
< 						<MkMediaList :media-list="appearNote.files"/>
< 					</div>
< 					<MkPoll v-if="appearNote.poll" ref="pollViewer" :note="appearNote" class="poll"/>
< 					<MkUrlPreview v-for="url in urls" :key="url" :url="url" :compact="true" :detail="true" class="url-preview"/>
< 					<div v-if="appearNote.renote" class="renote"><MkNoteSimple :note="appearNote.renote" class="note"/></div>
< 				</div>
< 				<MkA v-if="appearNote.channel && !inChannel" class="channel" :to="`/channels/${appearNote.channel.id}`"><i class="ti ti-device-tv"></i> {{ appearNote.channel.name }}</MkA>
< 			</div>
< 			<footer class="footer">
< 				<div class="info">
< 					<MkA class="created-at" :to="notePage(appearNote)">
< 						<MkTime :time="appearNote.createdAt" mode="detail"/>
< 					</MkA>
< 				</div>
< 				<MkReactionsViewer ref="reactionsViewer" :note="appearNote"/>
< 				<button class="button _button" @click="reply()">
< 					<i class="ti ti-arrow-back-up"></i>
< 					<p v-if="appearNote.repliesCount > 0" class="count">{{ appearNote.repliesCount }}</p>
< 				</button>
< 				<button
< 					v-if="canRenote"
< 					ref="renoteButton"
< 					class="button _button"
< 					@mousedown="renote()"
< 				>
< 					<i class="ti ti-repeat"></i>
< 					<p v-if="appearNote.renoteCount > 0" class="count">{{ appearNote.renoteCount }}</p>
< 				</button>
< 				<button v-else class="button _button" disabled>
< 					<i class="ti ti-ban"></i>
< 				</button>
< 				<button v-if="appearNote.myReaction == null" ref="reactButton" class="button _button" @mousedown="react()">
< 					<i class="ti ti-plus"></i>
< 				</button>
< 				<button v-if="appearNote.myReaction != null" ref="reactButton" class="button _button reacted" @click="undoReact(appearNote)">
< 					<i class="ti ti-minus"></i>
< 				</button>
< 				<button ref="menuButton" class="button _button" @mousedown="menu()">
< 					<i class="ti ti-dots"></i>
< 				</button>
< 			</footer>
< 		</div>
< 	</article>
< 	<MkNoteSub v-for="note in replies" :key="note.id" :note="note" class="reply" :detail="true"/>
< </div>
< <div v-else class="_panel muted" @click="muted = false">
< 	<I18n :src="i18n.ts.userSaysSomething" tag="small">
< 		<template #name>
< 			<MkA v-user-preview="appearNote.userId" class="name" :to="userPage(appearNote.user)">
< 				<MkUserName :user="appearNote.user"/>
< 			</MkA>
< 		</template>
< 	</I18n>
< </div>
---
>   <div
>     v-if="!muted"
>     v-show="!isDeleted"
>     ref="el"
>     v-hotkey="keymap"
>     v-size="{ max: [500, 450, 350, 300] }"
>     class="lxwezrsl _block"
>     :tabindex="!isDeleted ? '-1' : null"
>     :class="{ renote: isRenote }"
>   >
>     <MkNoteSub
>       v-for="note in conversation"
>       :key="note.id"
>       class="reply-to-more"
>       :note="note"
>     />
>     <MkNoteSub
>       v-if="appearNote.reply"
>       :note="appearNote.reply"
>       class="reply-to"
>     />
>     <div v-if="isRenote" class="renote">
>       <MkAvatar class="avatar" :user="note.user" />
>       <i class="fas fa-retweet"></i>
>       <I18n :src="i18n.ts.renotedBy" tag="span">
>         <template #user>
>           <MkA
>             v-user-preview="note.userId"
>             class="name"
>             :to="userPage(note.user)"
>           >
>             <MkUserName :user="note.user" />
>           </MkA>
>         </template>
>       </I18n>
>       <div class="info">
>         <button ref="renoteTime" class="_button time" @click="showRenoteMenu()">
>           <i v-if="isMyRenote" class="fas fa-ellipsis-h dropdownIcon"></i>
>           <MkTime :time="note.createdAt" />
>         </button>
>         <MkVisibility :note="note" />
>       </div>
>     </div>
>     <article class="article" @contextmenu.stop="onContextmenu">
>       <header class="header">
>         <MkAvatar
>           class="avatar"
>           :user="appearNote.user"
>           :show-indicator="true"
>         />
>         <div class="body">
>           <div class="top">
>             <MkA
>               v-user-preview="appearNote.user.id"
>               class="name"
>               :to="userPage(appearNote.user)"
>             >
>               <MkUserName :nowrap="false" :user="appearNote.user" />
>             </MkA>
>             <span v-if="appearNote.user.isBot" class="is-bot">bot</span>
>             <div class="info">
>               <MkVisibility :note="appearNote" />
>             </div>
>           </div>
>           <div class="username"><MkAcct :user="appearNote.user" /></div>
>           <MkInstanceTicker
>             v-if="showTicker"
>             class="ticker"
>             :instance="appearNote.user.instance"
>           />
>         </div>
>       </header>
>       <div class="main">
>         <div class="body">
>           <p v-if="appearNote.cw != null" class="cw">
>             <Mfm
>               v-if="appearNote.cw != ''"
>               class="text"
>               :text="appearNote.cw"
>               :author="appearNote.user"
>               :i="$i"
>               :custom-emojis="appearNote.emojis"
>             />
>             <XCwButton v-model="showContent" :note="appearNote" />
>           </p>
>           <div v-show="appearNote.cw == null || showContent" class="content">
>             <div class="text">
>               <span v-if="appearNote.isHidden" style="opacity: 0.5"
>                 >({{ i18n.ts.private }})</span
>               >
>               <MkA
>                 v-if="appearNote.replyId"
>                 class="reply"
>                 :to="`/notes/${appearNote.replyId}`"
>                 ><i class="fas fa-reply"></i
>               ></MkA>
>               <Mfm
>                 v-if="appearNote.text"
>                 :text="appearNote.text"
>                 :author="appearNote.user"
>                 :i="$i"
>                 :custom-emojis="appearNote.emojis"
>               />
>               <a v-if="appearNote.renote != null" class="rp">RN:</a>
>               <div v-if="translating || translation" class="translation">
>                 <MkLoading v-if="translating" mini />
>                 <div v-else class="translated">
>                   <b
>                     >{{ $t("translatedFrom", { x: translation.sourceLang }) }}:
>                   </b>
>                   <Mfm
>                     :text="translation.text"
>                     :author="appearNote.user"
>                     :i="$i"
>                     :custom-emojis="appearNote.emojis"
>                   />
>                 </div>
>               </div>
>             </div>
>             <div v-if="appearNote.files.length > 0" class="files">
>               <XMediaList :media-list="appearNote.files" />
>             </div>
>             <XPoll
>               v-if="appearNote.poll"
>               ref="pollViewer"
>               :note="appearNote"
>               class="poll"
>             />
>             <MkUrlPreview
>               v-for="url in urls"
>               :key="url"
>               :url="url"
>               :compact="true"
>               :detail="true"
>               class="url-preview"
>             />
>             <div v-if="appearNote.renote" class="renote">
>               <XNoteSimple :note="appearNote.renote" />
>             </div>
>           </div>
>           <MkA
>             v-if="appearNote.channel && !inChannel"
>             class="channel"
>             :to="`/channels/${appearNote.channel.id}`"
>             ><i class="fas fa-satellite-dish"></i>
>             {{ appearNote.channel.name }}</MkA
>           >
>         </div>
>         <footer class="footer">
>           <div class="info">
>             <MkA class="created-at" :to="notePage(appearNote)">
>               <MkTime :time="appearNote.createdAt" mode="detail" />
>             </MkA>
>           </div>
>           <XReactionsViewer ref="reactionsViewer" :note="appearNote" />
>           <button class="button _button" @click="reply()">
>             <template v-if="appearNote.reply"
>               ><i class="fas fa-reply-all"></i
>             ></template>
>             <template v-else><i class="fas fa-reply"></i></template>
>             <p v-if="appearNote.repliesCount > 0" class="count">
>               {{ appearNote.repliesCount }}
>             </p>
>           </button>
>           <XRenoteButton
>             ref="renoteButton"
>             class="button"
>             :note="appearNote"
>             :count="appearNote.renoteCount"
>           />
>           <button
>             v-if="appearNote.myReaction == null"
>             ref="reactButton"
>             class="button _button"
>             @click="react()"
>           >
>             <i class="fas fa-plus"></i>
>           </button>
>           <button
>             v-if="appearNote.myReaction != null"
>             ref="reactButton"
>             class="button _button reacted"
>             @click="undoReact(appearNote)"
>           >
>             <i class="fas fa-minus"></i>
>           </button>
>           <button ref="menuButton" class="button _button" @click="menu()">
>             <i class="fas fa-ellipsis-h"></i>
>           </button>
>         </footer>
>       </div>
>     </article>
>     <MkNoteSub
>       v-for="note in replies"
>       :key="note.id"
>       :note="note"
>       class="reply"
>       :detail="true"
>     />
>   </div>
>   <div v-else class="_panel muted" @click="muted = false">
>     <I18n :src="i18n.ts.userSaysSomething" tag="small">
>       <template #name>
>         <MkA
>           v-user-preview="appearNote.userId"
>           class="name"
>           :to="userPage(appearNote.user)"
>         >
>           <MkUserName :user="appearNote.user" />
>         </MkA>
>       </template>
>     </I18n>
>   </div>
136,162c218,243
< import { computed, inject, onMounted, onUnmounted, reactive, ref, shallowRef } from 'vue';
< import * as mfm from 'mfm-js';
< import * as misskey from 'misskey-js';
< import MkNoteSub from '@/components/MkNoteSub.vue';
< import MkNoteSimple from '@/components/MkNoteSimple.vue';
< import MkReactionsViewer from '@/components/MkReactionsViewer.vue';
< import MkMediaList from '@/components/MkMediaList.vue';
< import MkCwButton from '@/components/MkCwButton.vue';
< import MkPoll from '@/components/MkPoll.vue';
< import MkUsersTooltip from '@/components/MkUsersTooltip.vue';
< import MkUrlPreview from '@/components/MkUrlPreview.vue';
< import MkInstanceTicker from '@/components/MkInstanceTicker.vue';
< import { pleaseLogin } from '@/scripts/please-login';
< import { checkWordMute } from '@/scripts/check-word-mute';
< import { userPage } from '@/filters/user';
< import { notePage } from '@/filters/note';
< import * as os from '@/os';
< import { defaultStore, noteViewInterruptors } from '@/store';
< import { reactionPicker } from '@/scripts/reaction-picker';
< import { extractUrlFromMfm } from '@/scripts/extract-url-from-mfm';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { getNoteMenu } from '@/scripts/get-note-menu';
< import { useNoteCapture } from '@/scripts/use-note-capture';
< import { deepClone } from '@/scripts/clone';
< import { useTooltip } from '@/scripts/use-tooltip';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { computed, inject, onMounted, onUnmounted, reactive, ref } from "vue";
> import * as mfm from "mfm-js";
> import * as misskey from "misskey-js";
> import MkNoteSub from "@/components/MkNoteSub.vue";
> import XNoteSimple from "@/components/MkNoteSimple.vue";
> import XReactionsViewer from "@/components/MkReactionsViewer.vue";
> import XMediaList from "@/components/MkMediaList.vue";
> import XCwButton from "@/components/MkCwButton.vue";
> import XPoll from "@/components/MkPoll.vue";
> import XRenoteButton from "@/components/MkRenoteButton.vue";
> import MkUrlPreview from "@/components/MkUrlPreview.vue";
> import MkInstanceTicker from "@/components/MkInstanceTicker.vue";
> import MkVisibility from "@/components/MkVisibility.vue";
> import { pleaseLogin } from "@/scripts/please-login";
> import { checkWordMute } from "@/scripts/check-word-mute";
> import { userPage } from "@/filters/user";
> import { notePage } from "@/filters/note";
> import * as os from "@/os";
> import { defaultStore, noteViewInterruptors } from "@/store";
> import { reactionPicker } from "@/scripts/reaction-picker";
> import { extractUrlFromMfm } from "@/scripts/extract-url-from-mfm";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { getNoteMenu } from "@/scripts/get-note-menu";
> import { useNoteCapture } from "@/scripts/use-note-capture";
> import { deepClone } from "@/scripts/clone";
165,166c246,247
< 	note: misskey.entities.Note;
< 	pinned?: boolean;
---
>   note: misskey.entities.Note;
>   pinned?: boolean;
169c250
< const inChannel = inject('inChannel', null);
---
> const inChannel = inject("inChannel", null);
175,181c256,262
< 	onMounted(async () => {
< 		let result = deepClone(note);
< 		for (const interruptor of noteViewInterruptors) {
< 			result = await interruptor.handler(result);
< 		}
< 		note = result;
< 	});
---
>   onMounted(async () => {
>     let result = deepClone(note);
>     for (const interruptor of noteViewInterruptors) {
>       result = await interruptor.handler(result);
>     }
>     note = result;
>   });
184,189c265,269
< const isRenote = (
< 	note.renote != null &&
< 	note.text == null &&
< 	note.fileIds.length === 0 &&
< 	note.poll == null
< );
---
> const isRenote =
>   note.renote != null &&
>   note.text == null &&
>   note.fileIds.length === 0 &&
>   note.poll == null;
191,197c271,279
< const el = shallowRef<HTMLElement>();
< const menuButton = shallowRef<HTMLElement>();
< const renoteButton = shallowRef<HTMLElement>();
< const renoteTime = shallowRef<HTMLElement>();
< const reactButton = shallowRef<HTMLElement>();
< let appearNote = $computed(() => isRenote ? note.renote as misskey.entities.Note : note);
< const isMyRenote = $i && ($i.id === note.userId);
---
> const el = ref<HTMLElement>();
> const menuButton = ref<HTMLElement>();
> const renoteButton = ref<InstanceType<typeof XRenoteButton>>();
> const renoteTime = ref<HTMLElement>();
> const reactButton = ref<HTMLElement>();
> let appearNote = $computed(() =>
>   isRenote ? (note.renote as misskey.entities.Note) : note
> );
> const isMyRenote = $i && $i.id === note.userId;
203,204c285,290
< const urls = appearNote.text ? extractUrlFromMfm(mfm.parse(appearNote.text)) : null;
< const showTicker = (defaultStore.state.instanceTicker === 'always') || (defaultStore.state.instanceTicker === 'remote' && appearNote.user.instance);
---
> const urls = appearNote.text
>   ? extractUrlFromMfm(mfm.parse(appearNote.text))
>   : null;
> const showTicker =
>   defaultStore.state.instanceTicker === "always" ||
>   (defaultStore.state.instanceTicker === "remote" && appearNote.user.instance);
207d292
< const canRenote = computed(() => ['public', 'home'].includes(appearNote.visibility) || appearNote.userId === $i.id);
210,215c295,300
< 	'r': () => reply(true),
< 	'e|a|plus': () => react(true),
< 	'q': () => renoteButton.value.renote(true),
< 	'esc': blur,
< 	'm|o': () => menu(true),
< 	's': () => showContent.value !== showContent.value,
---
>   r: () => reply(true),
>   "e|a|plus": () => react(true),
>   q: () => renoteButton.value.renote(true),
>   esc: blur,
>   "m|o": () => menu(true),
>   s: () => showContent.value !== showContent.value,
219,221c304,306
< 	rootEl: el,
< 	note: $$(appearNote),
< 	isDeletedRef: isDeleted,
---
>   rootEl: el,
>   note: $$(appearNote),
>   isDeletedRef: isDeleted,
224,264d308
< useTooltip(renoteButton, async (showing) => {
< 	const renotes = await os.api('notes/renotes', {
< 		noteId: appearNote.id,
< 		limit: 11,
< 	});
< 
< 	const users = renotes.map(x => x.user);
< 
< 	if (users.length < 1) return;
< 
< 	os.popup(MkUsersTooltip, {
< 		showing,
< 		users,
< 		count: appearNote.renoteCount,
< 		targetElement: renoteButton.value,
< 	}, {}, 'closed');
< });
< 
< function renote(viaKeyboard = false) {
< 	pleaseLogin();
< 	os.popupMenu([{
< 		text: i18n.ts.renote,
< 		icon: 'ti ti-repeat',
< 		action: () => {
< 			os.api('notes/create', {
< 				renoteId: appearNote.id,
< 			});
< 		},
< 	}, {
< 		text: i18n.ts.quote,
< 		icon: 'ti ti-quote',
< 		action: () => {
< 			os.post({
< 				renote: appearNote,
< 			});
< 		},
< 	}], renoteButton.value, {
< 		viaKeyboard,
< 	});
< }
< 
266,272c310,319
< 	pleaseLogin();
< 	os.post({
< 		reply: appearNote,
< 		animation: !viaKeyboard,
< 	}, () => {
< 		focus();
< 	});
---
>   pleaseLogin();
>   os.post(
>     {
>       reply: appearNote,
>       animation: !viaKeyboard,
>     },
>     () => {
>       focus();
>     }
>   );
276,288c323,336
< 	pleaseLogin();
< 	blur();
< 	reactionPicker.show(reactButton.value, reaction => {
< 		os.api('notes/reactions/create', {
< 			noteId: appearNote.id,
< 			reaction: reaction,
< 		});
< 		if (appearNote.text && appearNote.text.length > 100 && (Date.now() - new Date(appearNote.createdAt).getTime() < 1000 * 3)) {
< 			claimAchievement('reactWithoutRead');
< 		}
< 	}, () => {
< 		focus();
< 	});
---
>   pleaseLogin();
>   blur();
>   reactionPicker.show(
>     reactButton.value,
>     (reaction) => {
>       os.api("notes/reactions/create", {
>         noteId: appearNote.id,
>         reaction: reaction,
>       });
>     },
>     () => {
>       focus();
>     }
>   );
292,296c340,344
< 	const oldReaction = note.myReaction;
< 	if (!oldReaction) return;
< 	os.api('notes/reactions/delete', {
< 		noteId: note.id,
< 	});
---
>   const oldReaction = note.myReaction;
>   if (!oldReaction) return;
>   os.api("notes/reactions/delete", {
>     noteId: note.id,
>   });
300,307c348,355
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target)) return;
< 	if (window.getSelection().toString() !== '') return;
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target)) return;
>   if (window.getSelection().toString() !== "") return;
309,314c357,371
< 	if (defaultStore.state.useReactionPickerForContextMenu) {
< 		ev.preventDefault();
< 		react();
< 	} else {
< 		os.contextMenu(getNoteMenu({ note: note, translating, translation, menuButton, isDeleted }), ev).then(focus);
< 	}
---
>   if (defaultStore.state.useReactionPickerForContextMenu) {
>     ev.preventDefault();
>     react();
>   } else {
>     os.contextMenu(
>       getNoteMenu({
>         note: note,
>         translating,
>         translation,
>         menuButton,
>         isDeleted,
>       }),
>       ev
>     ).then(focus);
>   }
318,320c375,387
< 	os.popupMenu(getNoteMenu({ note: note, translating, translation, menuButton, isDeleted }), menuButton.value, {
< 		viaKeyboard,
< 	}).then(focus);
---
>   os.popupMenu(
>     getNoteMenu({
>       note: note,
>       translating,
>       translation,
>       menuButton,
>       isDeleted,
>     }),
>     menuButton.value,
>     {
>       viaKeyboard,
>     }
>   ).then(focus);
324,337c391,410
< 	if (!isMyRenote) return;
< 	os.popupMenu([{
< 		text: i18n.ts.unrenote,
< 		icon: 'ti ti-trash',
< 		danger: true,
< 		action: () => {
< 			os.api('notes/delete', {
< 				noteId: note.id,
< 			});
< 			isDeleted.value = true;
< 		},
< 	}], renoteTime.value, {
< 		viaKeyboard: viaKeyboard,
< 	});
---
>   if (!isMyRenote) return;
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.unrenote,
>         icon: "fas fa-trash-alt",
>         danger: true,
>         action: () => {
>           os.api("notes/delete", {
>             noteId: note.id,
>           });
>           isDeleted.value = true;
>         },
>       },
>     ],
>     renoteTime.value,
>     {
>       viaKeyboard: viaKeyboard,
>     }
>   );
341c414
< 	el.value.focus();
---
>   el.value.focus();
345c418
< 	el.value.blur();
---
>   el.value.blur();
348,352c421,425
< os.api('notes/children', {
< 	noteId: appearNote.id,
< 	limit: 30,
< }).then(res => {
< 	replies.value = res;
---
> os.api("notes/children", {
>   noteId: appearNote.id,
>   limit: 30,
> }).then((res) => {
>   replies.value = res;
356,360c429,433
< 	os.api('notes/conversation', {
< 		noteId: appearNote.replyId,
< 	}).then(res => {
< 		conversation.value = res.reverse();
< 	});
---
>   os.api("notes/conversation", {
>     noteId: appearNote.replyId,
>   }).then((res) => {
>     conversation.value = res.reverse();
>   });
366,369c439,442
< 	position: relative;
< 	transition: box-shadow 0.1s ease;
< 	overflow: clip;
< 	contain: content;
---
>   position: relative;
>   transition: box-shadow 0.1s ease;
>   overflow: hidden;
>   contain: content;
371,372c444,445
< 	&:focus-visible {
< 		outline: none;
---
>   &:focus-visible {
>     outline: none;
374,391c447,464
< 		&:after {
< 			content: "";
< 			pointer-events: none;
< 			display: block;
< 			position: absolute;
< 			z-index: 10;
< 			top: 0;
< 			left: 0;
< 			right: 0;
< 			bottom: 0;
< 			margin: auto;
< 			width: calc(100% - 8px);
< 			height: calc(100% - 8px);
< 			border: dashed 1px var(--focus);
< 			border-radius: var(--radius);
< 			box-sizing: border-box;
< 		}
< 	}
---
>     &:after {
>       content: "";
>       pointer-events: none;
>       display: block;
>       position: absolute;
>       z-index: 10;
>       top: 0;
>       left: 0;
>       right: 0;
>       bottom: 0;
>       margin: auto;
>       width: calc(100% - 8px);
>       height: calc(100% - 8px);
>       border: dashed 1px var(--focus);
>       border-radius: var(--radius);
>       box-sizing: border-box;
>     }
>   }
393,395c466,468
< 	&:hover > .article > .main > .footer > .button {
< 		opacity: 1;
< 	}
---
>   &:hover > .article > .main > .footer > .button {
>     opacity: 1;
>   }
397,400c470,473
< 	> .reply-to {
< 		opacity: 0.7;
< 		padding-bottom: 0;
< 	}
---
>   > .reply-to {
>     opacity: 0.7;
>     padding-bottom: 0;
>   }
402,404c475,477
< 	> .reply-to-more {
< 		opacity: 0.7;
< 	}
---
>   > .reply-to-more {
>     opacity: 0.7;
>   }
406,412c479,485
< 	> .renote {
< 		display: flex;
< 		align-items: center;
< 		padding: 16px 32px 8px 32px;
< 		line-height: 28px;
< 		white-space: pre;
< 		color: var(--renote);
---
>   > .renote {
>     display: flex;
>     align-items: center;
>     padding: 16px 32px 8px 32px;
>     line-height: 28px;
>     white-space: pre;
>     color: var(--renote);
414,421c487,494
< 		> .avatar {
< 			flex-shrink: 0;
< 			display: inline-block;
< 			width: 28px;
< 			height: 28px;
< 			margin: 0 8px 0 0;
< 			border-radius: 6px;
< 		}
---
>     > .avatar {
>       flex-shrink: 0;
>       display: inline-block;
>       width: 28px;
>       height: 28px;
>       margin: 0 8px 0 0;
>       border-radius: 6px;
>     }
423,425c496,498
< 		> i {
< 			margin-right: 4px;
< 		}
---
>     > i {
>       margin-right: 4px;
>     }
427,431c500,504
< 		> span {
< 			overflow: hidden;
< 			flex-shrink: 1;
< 			text-overflow: ellipsis;
< 			white-space: nowrap;
---
>     > span {
>       overflow: hidden;
>       flex-shrink: 1;
>       text-overflow: ellipsis;
>       white-space: nowrap;
433,436c506,509
< 			> .name {
< 				font-weight: bold;
< 			}
< 		}
---
>       > .name {
>         font-weight: bold;
>       }
>     }
438,440c511,513
< 		> .info {
< 			margin-left: auto;
< 			font-size: 0.9em;
---
>     > .info {
>       margin-left: auto;
>       font-size: 0.9em;
442,444c515,517
< 			> .time {
< 				flex-shrink: 0;
< 				color: inherit;
---
>       > .time {
>         flex-shrink: 0;
>         color: inherit;
446,451c519,524
< 				> .dropdownIcon {
< 					margin-right: 4px;
< 				}
< 			}
< 		}
< 	}
---
>         > .dropdownIcon {
>           margin-right: 4px;
>         }
>       }
>     }
>   }
453,455c526,528
< 	> .renote + .article {
< 		padding-top: 8px;
< 	}
---
>   > .renote + .article {
>     padding-top: 8px;
>   }
457,459c530,532
< 	> .article {
< 		padding: 32px;
< 		font-size: 1.2em;
---
>   > .article {
>     padding: 32px;
>     font-size: 1.2em;
461,465c534,538
< 		> .header {
< 			display: flex;
< 			position: relative;
< 			margin-bottom: 16px;
< 			align-items: center;
---
>     > .header {
>       display: flex;
>       position: relative;
>       margin-bottom: 16px;
>       align-items: center;
467,472c540,545
< 			> .avatar {
< 				display: block;
< 				flex-shrink: 0;
< 				width: 58px;
< 				height: 58px;
< 			}
---
>       > .avatar {
>         display: block;
>         flex-shrink: 0;
>         width: 58px;
>         height: 58px;
>       }
474,480c547,553
< 			> .body {
< 				flex: 1;
< 				display: flex;
< 				flex-direction: column;
< 				justify-content: center;
< 				padding-left: 16px;
< 				font-size: 0.95em;
---
>       > .body {
>         flex: 1;
>         display: flex;
>         flex-direction: column;
>         justify-content: center;
>         padding-left: 16px;
>         font-size: 0.95em;
482,486c555,559
< 				> .top {
< 					> .name {
< 						font-weight: bold;
< 						line-height: 1.3;
< 					}
---
>         > .top {
>           > .name {
>             font-weight: bold;
>             line-height: 1.3;
>           }
488,496c561,569
< 					> .is-bot {
< 						display: inline-block;
< 						margin: 0 0.5em;
< 						padding: 4px 6px;
< 						font-size: 80%;
< 						line-height: 1;
< 						border: solid 0.5px var(--divider);
< 						border-radius: 4px;
< 					}
---
>           > .is-bot {
>             display: inline-block;
>             margin: 0 0.5em;
>             padding: 4px 6px;
>             font-size: 80%;
>             line-height: 1;
>             border: solid 0.5px var(--divider);
>             border-radius: 4px;
>           }
498,501c571,574
< 					> .info {
< 						float: right;
< 					}
< 				}
---
>           > .info {
>             float: right;
>           }
>         }
503,509c576,582
< 				> .username {
< 					margin-bottom: 2px;
< 					line-height: 1.3;
< 					word-wrap: anywhere;
< 				}
< 			}
< 		}
---
>         > .username {
>           margin-bottom: 2px;
>           line-height: 1.3;
>           word-wrap: anywhere;
>         }
>       }
>     }
511,513c584,591
< 		> .main {
< 			> .body {
< 				container-type: inline-size;
---
>     > .main {
>       > .body {
>         > .cw {
>           cursor: default;
>           display: block;
>           margin: 0;
>           padding: 0;
>           overflow-wrap: break-word;
515,520c593,596
< 				> .cw {
< 					cursor: default;
< 					display: block;
< 					margin: 0;
< 					padding: 0;
< 					overflow-wrap: break-word;
---
>           > .text {
>             margin-right: 8px;
>           }
>         }
522,525c598,600
< 					> .text {
< 						margin-right: 8px;
< 					}
< 				}
---
>         > .content {
>           > .text {
>             overflow-wrap: break-word;
527,529c602,605
< 				> .content {
< 					> .text {
< 						overflow-wrap: break-word;
---
>             > .reply {
>               color: var(--accent);
>               margin-right: 0.5em;
>             }
531,534c607,611
< 						> .reply {
< 							color: var(--accent);
< 							margin-right: 0.5em;
< 						}
---
>             > .rp {
>               margin-left: 4px;
>               font-style: oblique;
>               color: var(--renote);
>             }
536,540c613,619
< 						> .rp {
< 							margin-left: 4px;
< 							font-style: oblique;
< 							color: var(--renote);
< 						}
---
>             > .translation {
>               border: solid 0.5px var(--divider);
>               border-radius: var(--radius);
>               padding: 12px;
>               margin-top: 8px;
>             }
>           }
542,548c621,623
< 						> .translation {
< 							border: solid 0.5px var(--divider);
< 							border-radius: var(--radius);
< 							padding: 12px;
< 							margin-top: 8px;
< 						}
< 					}
---
>           > .url-preview {
>             margin-top: 8px;
>           }
550,552c625,627
< 					> .url-preview {
< 						margin-top: 8px;
< 					}
---
>           > .poll {
>             font-size: 80%;
>           }
554,556c629,630
< 					> .poll {
< 						font-size: 80%;
< 					}
---
>           > .renote {
>             padding: 8px 0;
558,559c632,638
< 					> .renote {
< 						padding: 8px 0;
---
>             > * {
>               padding: 16px;
>               border: dashed 1px var(--renote);
>               border-radius: 8px;
>             }
>           }
>         }
561,567c640,644
< 						> .note {
< 							padding: 16px;
< 							border: dashed 1px var(--renote);
< 							border-radius: 8px;
< 						}
< 					}
< 				}
---
>         > .channel {
>           opacity: 0.7;
>           font-size: 80%;
>         }
>       }
569,573c646,651
< 				> .channel {
< 					opacity: 0.7;
< 					font-size: 80%;
< 				}
< 			}
---
>       > .footer {
>         > .info {
>           margin: 16px 0;
>           opacity: 0.7;
>           font-size: 0.9em;
>         }
575,580c653,656
< 			> .footer {
< 				> .info {
< 					margin: 16px 0;
< 					opacity: 0.7;
< 					font-size: 0.9em;
< 				}
---
>         > .button {
>           margin: 0;
>           padding: 8px;
>           opacity: 0.7;
582,585c658,660
< 				> .button {
< 					margin: 0;
< 					padding: 8px;
< 					opacity: 0.7;
---
>           &:not(:last-child) {
>             margin-right: 28px;
>           }
587,589c662,664
< 					&:not(:last-child) {
< 						margin-right: 28px;
< 					}
---
>           &:hover {
>             color: var(--fgHighlighted);
>           }
591,593c666,670
< 					&:hover {
< 						color: var(--fgHighlighted);
< 					}
---
>           > .count {
>             display: inline;
>             margin: 0 0 0 8px;
>             opacity: 0.7;
>           }
595,599c672,678
< 					> .count {
< 						display: inline;
< 						margin: 0 0 0 8px;
< 						opacity: 0.7;
< 					}
---
>           &.reacted {
>             color: var(--accent);
>           }
>         }
>       }
>     }
>   }
601,607c680,682
< 					&.reacted {
< 						color: var(--accent);
< 					}
< 				}
< 			}
< 		}
< 	}
---
>   > .reply {
>     border-top: solid 0.5px var(--divider);
>   }
609,612c684,686
< 	> .reply {
< 		border-top: solid 0.5px var(--divider);
< 	}
< }
---
>   &.max-width_500px {
>     font-size: 0.9em;
>   }
614,618c688,691
< @container (max-width: 500px) {
< 	.lxwezrsl {
< 		font-size: 0.9em;
< 	}
< }
---
>   &.max-width_450px {
>     > .renote {
>       padding: 8px 16px 0 16px;
>     }
620,624c693,694
< @container (max-width: 450px) {
< 	.lxwezrsl {
< 		> .renote {
< 			padding: 8px 16px 0 16px;
< 		}
---
>     > .article {
>       padding: 16px;
626,627c696,703
< 		> .article {
< 			padding: 16px;
---
>       > .header {
>         > .avatar {
>           width: 50px;
>           height: 50px;
>         }
>       }
>     }
>   }
629,637c705,717
< 			> .header {
< 				> .avatar {
< 					width: 50px;
< 					height: 50px;
< 				}
< 			}
< 		}
< 	}
< }
---
>   &.max-width_350px {
>     > .article {
>       > .main {
>         > .footer {
>           > .button {
>             &:not(:last-child) {
>               margin-right: 18px;
>             }
>           }
>         }
>       }
>     }
>   }
639,653c719,720
< @container (max-width: 350px) {
< 	.lxwezrsl {
< 		> .article {
< 			> .main {
< 				> .footer {
< 					> .button {
< 						&:not(:last-child) {
< 							margin-right: 18px;
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
< }
---
>   &.max-width_300px {
>     font-size: 0.825em;
655,657c722,728
< @container (max-width: 300px) {
< 	.lxwezrsl {
< 		font-size: 0.825em;
---
>     > .article {
>       > .header {
>         > .avatar {
>           width: 50px;
>           height: 50px;
>         }
>       }
659,677c730,740
< 		> .article {
< 			> .header {
< 				> .avatar {
< 					width: 50px;
< 					height: 50px;
< 				}
< 			}
< 
< 			> .main {
< 				> .footer {
< 					> .button {
< 						&:not(:last-child) {
< 							margin-right: 12px;
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
---
>       > .main {
>         > .footer {
>           > .button {
>             &:not(:last-child) {
>               margin-right: 12px;
>             }
>           }
>         }
>       }
>     }
>   }
681,683c744,746
< 	padding: 8px;
< 	text-align: center;
< 	opacity: 0.7;
---
>   padding: 8px;
>   text-align: center;
>   opacity: 0.7;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNoteHeader.vue RiricaV13/components/MkNoteHeader.vue
2,19c2,14
< <header :class="$style.root">
< 	<MkA v-once v-user-preview="note.user.id" :class="$style.name" :to="userPage(note.user)">
< 		<MkUserName :user="note.user"/>
< 	</MkA>
< 	<div v-if="note.user.isBot" :class="$style.isBot">bot</div>
< 	<div :class="$style.username"><MkAcct :user="note.user"/></div>
< 	<div :class="$style.info">
< 		<MkA :to="notePage(note)">
< 			<MkTime :time="note.createdAt"/>
< 		</MkA>
< 		<span v-if="note.visibility !== 'public'" style="margin-left: 0.5em;" :title="i18n.ts._visibility[note.visibility]">
< 			<i v-if="note.visibility === 'home'" class="ti ti-home"></i>
< 			<i v-else-if="note.visibility === 'followers'" class="ti ti-lock"></i>
< 			<i v-else-if="note.visibility === 'specified'" ref="specified" class="ti ti-mail"></i>
< 		</span>
< 		<span v-if="note.localOnly" style="margin-left: 0.5em;" :title="i18n.ts._visibility['localOnly']"><i class="ti ti-world-off"></i></span>
< 	</div>
< </header>
---
>   <header class="kkwtjztg">
>     <MkA v-user-preview="note.user.id" class="name" :to="userPage(note.user)">
>       <MkUserName :user="note.user" />
>     </MkA>
>     <div v-if="note.user.isBot" class="is-bot">bot</div>
>     <div class="username"><MkAcct :user="note.user" /></div>
>     <div class="info">
>       <MkA class="created-at" :to="notePage(note)">
>         <MkTime :time="note.createdAt" />
>       </MkA>
>       <MkVisibility :note="note" />
>     </div>
>   </header>
23,27c18,22
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import { i18n } from '@/i18n';
< import { notePage } from '@/filters/note';
< import { userPage } from '@/filters/user';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import MkVisibility from "@/components/MkVisibility.vue";
> import { notePage } from "@/filters/note";
> import { userPage } from "@/filters/user";
30,31c25,26
< 	note: misskey.entities.Note;
< 	pinned?: boolean;
---
>   note: misskey.entities.Note;
>   pinned?: boolean;
35,40c30,34
< <style lang="scss" module>
< .root {
< 	display: flex;
< 	align-items: baseline;
< 	white-space: nowrap;
< }
---
> <style lang="scss" scoped>
> .kkwtjztg {
>   display: flex;
>   align-items: baseline;
>   white-space: nowrap;
42,51c36,45
< .name {
< 	flex-shrink: 1;
< 	display: block;
< 	margin: 0 .5em 0 0;
< 	padding: 0;
< 	overflow: hidden;
< 	font-size: 1em;
< 	font-weight: bold;
< 	text-decoration: none;
< 	text-overflow: ellipsis;
---
>   > .name {
>     flex-shrink: 1;
>     display: block;
>     margin: 0 0.5em 0 0;
>     padding: 0;
>     overflow: hidden;
>     font-size: 1em;
>     font-weight: bold;
>     text-decoration: none;
>     text-overflow: ellipsis;
53,56c47,50
< 	&:hover {
< 		text-decoration: underline;
< 	}
< }
---
>     &:hover {
>       text-decoration: underline;
>     }
>   }
58,66c52,60
< .isBot {
< 	flex-shrink: 0;
< 	align-self: center;
< 	margin: 0 .5em 0 0;
< 	padding: 1px 6px;
< 	font-size: 80%;
< 	border: solid 0.5px var(--divider);
< 	border-radius: 3px;
< }
---
>   > .is-bot {
>     flex-shrink: 0;
>     align-self: center;
>     margin: 0 0.5em 0 0;
>     padding: 1px 6px;
>     font-size: 80%;
>     border: solid 0.5px var(--divider);
>     border-radius: 3px;
>   }
68,73c62,67
< .username {
< 	flex-shrink: 9999999;
< 	margin: 0 .5em 0 0;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
< }
---
>   > .username {
>     flex-shrink: 9999999;
>     margin: 0 0.5em 0 0;
>     overflow: hidden;
>     text-overflow: ellipsis;
>   }
75,78c69,73
< .info {
< 	flex-shrink: 0;
< 	margin-left: auto;
< 	font-size: 0.9em;
---
>   > .info {
>     flex-shrink: 0;
>     margin-left: auto;
>     font-size: 0.9em;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNotePreview.vue RiricaV13/components/MkNotePreview.vue
2,14c2,14
< <div :class="$style.root">
< 	<MkAvatar :class="$style.avatar" :user="$i" link preview/>
< 	<div :class="$style.main">
< 		<div :class="$style.header">
< 			<MkUserName :user="$i"/>
< 		</div>
< 		<div>
< 			<div :class="$style.content">
< 				<Mfm :text="text.trim()" :author="$i" :i="$i"/>
< 			</div>
< 		</div>
< 	</div>
< </div>
---
>   <div v-size="{ min: [350, 500] }" class="fefdfafb">
>     <MkAvatar class="avatar" :user="$i" />
>     <div class="main">
>       <div class="header">
>         <MkUserName :user="$i" />
>       </div>
>       <div class="body">
>         <div class="content">
>           <Mfm :text="text.trim()" :author="$i" :i="$i" />
>         </div>
>       </div>
>     </div>
>   </div>
18c18
< import { } from 'vue';
---
> import {} from "vue";
21c21
< 	text: string;
---
>   text: string;
25,32c25,31
< <style lang="scss" module>
< .root {
< 	display: flex;
< 	margin: 0;
< 	padding: 0;
< 	overflow: clip;
< 	font-size: 0.95em;
< }
---
> <style lang="scss" scoped>
> .fefdfafb {
>   display: flex;
>   margin: 0;
>   padding: 0;
>   overflow: clip;
>   font-size: 0.95em;
34,42c33,39
< .avatar {
< 	flex-shrink: 0 !important;
< 	display: block !important;
< 	margin: 0 10px 0 0 !important;
< 	width: 40px !important;
< 	height: 40px !important;
< 	border-radius: 8px !important;
< 	pointer-events: none !important;
< }
---
>   &.min-width_350px {
>     > .avatar {
>       margin: 0 10px 0 0;
>       width: 44px;
>       height: 44px;
>     }
>   }
44,47c41,47
< .main {
< 	flex: 1;
< 	min-width: 0;
< }
---
>   &.min-width_500px {
>     > .avatar {
>       margin: 0 12px 0 0;
>       width: 48px;
>       height: 48px;
>     }
>   }
49,52c49,57
< .header {
< 	margin-bottom: 2px;
< 	font-weight: bold;
< }
---
>   > .avatar {
>     flex-shrink: 0;
>     display: block;
>     margin: 0 10px 0 0;
>     width: 40px;
>     height: 40px;
>     border-radius: 8px;
>     pointer-events: none;
>   }
54,60c59,61
< @container (min-width: 350px) {
< 	.avatar {
< 		margin: 0 10px 0 0 !important;
< 		width: 44px !important;
< 		height: 44px !important;
< 	}
< }
---
>   > .main {
>     flex: 1;
>     min-width: 0;
62,67c63,89
< @container (min-width: 500px) {
< 	.avatar {
< 		margin: 0 12px 0 0 !important;
< 		width: 48px !important;
< 		height: 48px !important;
< 	}
---
>     > .header {
>       margin-bottom: 2px;
>       font-weight: bold;
>     }
> 
>     > .body {
>       > .cw {
>         cursor: default;
>         display: block;
>         margin: 0;
>         padding: 0;
>         overflow-wrap: break-word;
> 
>         > .text {
>           margin-right: 8px;
>         }
>       }
> 
>       > .content {
>         > .text {
>           cursor: default;
>           margin: 0;
>           padding: 0;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNoteSimple.vue RiricaV13/components/MkNoteSimple.vue
2,16c2,23
< <div :class="$style.root">
< 	<MkAvatar :class="$style.avatar" :user="note.user" link preview/>
< 	<div :class="$style.main">
< 		<MkNoteHeader :class="$style.header" :note="note" :mini="true"/>
< 		<div>
< 			<p v-if="note.cw != null" :class="$style.cw">
< 				<Mfm v-if="note.cw != ''" style="margin-right: 8px;" :text="note.cw" :author="note.user" :i="$i"/>
< 				<MkCwButton v-model="showContent" :note="note"/>
< 			</p>
< 			<div v-show="note.cw == null || showContent">
< 				<MkSubNoteContent :class="$style.text" :note="note"/>
< 			</div>
< 		</div>
< 	</div>
< </div>
---
>   <div v-size="{ min: [350, 500] }" class="yohlumlk">
>     <MkAvatar class="avatar" :user="note.user" />
>     <div class="main">
>       <XNoteHeader class="header" :note="note" :mini="true" />
>       <div class="body">
>         <p v-if="note.cw != null" class="cw">
>           <Mfm
>             v-if="note.cw != ''"
>             class="text"
>             :text="note.cw"
>             :author="note.user"
>             :i="$i"
>             :custom-emojis="note.emojis"
>           />
>           <XCwButton v-model="showContent" :note="note" />
>         </p>
>         <div v-show="note.cw == null || showContent" class="content">
>           <MkSubNoteContent class="text" :note="note" />
>         </div>
>       </div>
>     </div>
>   </div>
20,24c27,31
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkNoteHeader from '@/components/MkNoteHeader.vue';
< import MkSubNoteContent from '@/components/MkSubNoteContent.vue';
< import MkCwButton from '@/components/MkCwButton.vue';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import XNoteHeader from "@/components/MkNoteHeader.vue";
> import MkSubNoteContent from "@/components/MkSubNoteContent.vue";
> import XCwButton from "@/components/MkCwButton.vue";
27,28c34,35
< 	note: misskey.entities.Note;
< 	pinned?: boolean;
---
>   note: misskey.entities.Note;
>   pinned?: boolean;
34,41c41,47
< <style lang="scss" module>
< .root {
< 	display: flex;
< 	margin: 0;
< 	padding: 0;
< 	overflow: clip;
< 	font-size: 0.95em;
< }
---
> <style lang="scss" scoped>
> .yohlumlk {
>   display: flex;
>   margin: 0;
>   padding: 0;
>   overflow: clip;
>   font-size: 0.95em;
43,50c49,55
< .avatar {
< 	flex-shrink: 0;
< 	display: block;
< 	margin: 0 10px 0 0;
< 	width: 40px;
< 	height: 40px;
< 	border-radius: 8px;
< }
---
>   &.min-width_350px {
>     > .avatar {
>       margin: 0 10px 0 0;
>       width: 44px;
>       height: 44px;
>     }
>   }
52,55c57,63
< .main {
< 	flex: 1;
< 	min-width: 0;
< }
---
>   &.min-width_500px {
>     > .avatar {
>       margin: 0 12px 0 0;
>       width: 48px;
>       height: 48px;
>     }
>   }
57,59c65,72
< .header {
< 	margin-bottom: 2px;
< }
---
>   > .avatar {
>     flex-shrink: 0;
>     display: block;
>     margin: 0 10px 0 0;
>     width: 40px;
>     height: 40px;
>     border-radius: 8px;
>   }
61,67c74,76
< .cw {
< 	cursor: default;
< 	display: block;
< 	margin: 0;
< 	padding: 0;
< 	overflow-wrap: break-word;
< }
---
>   > .main {
>     flex: 1;
>     min-width: 0;
69,73c78,80
< .text {
< 	cursor: default;
< 	margin: 0;
< 	padding: 0;
< }
---
>     > .header {
>       margin-bottom: 2px;
>     }
75,81c82,88
< @container (min-width: 350px) {
< 	.avatar {
< 		margin: 0 10px 0 0;
< 		width: 44px;
< 		height: 44px;
< 	}
< }
---
>     > .body {
>       > .cw {
>         cursor: default;
>         display: block;
>         margin: 0;
>         padding: 0;
>         overflow-wrap: break-word;
83,88c90,103
< @container (min-width: 500px) {
< 	.avatar {
< 		margin: 0 12px 0 0;
< 		width: 48px;
< 		height: 48px;
< 	}
---
>         > .text {
>           margin-right: 8px;
>         }
>       }
> 
>       > .content {
>         > .text {
>           cursor: default;
>           margin: 0;
>           padding: 0;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNoteSub.vue RiricaV13/components/MkNoteSub.vue
2,24c2,44
< <div :class="[$style.root, { [$style.children]: depth > 1 }]">
< 	<div :class="$style.main">
< 		<MkAvatar :class="$style.avatar" :user="note.user" link preview/>
< 		<div :class="$style.body">
< 			<MkNoteHeader :class="$style.header" :note="note" :mini="true"/>
< 			<div>
< 				<p v-if="note.cw != null" :class="$style.cw">
< 					<Mfm v-if="note.cw != ''" style="margin-right: 8px;" :text="note.cw" :author="note.user" :i="$i"/>
< 					<MkCwButton v-model="showContent" :note="note"/>
< 				</p>
< 				<div v-show="note.cw == null || showContent">
< 					<MkSubNoteContent :class="$style.text" :note="note"/>
< 				</div>
< 			</div>
< 		</div>
< 	</div>
< 	<template v-if="depth < 5">
< 		<MkNoteSub v-for="reply in replies" :key="reply.id" :note="reply" :class="$style.reply" :detail="true" :depth="depth + 1"/>
< 	</template>
< 	<div v-else :class="$style.more">
< 		<MkA class="_link" :to="notePage(note)">{{ i18n.ts.continueThread }} <i class="ti ti-chevron-double-right"></i></MkA>
< 	</div>
< </div>
---
>   <div
>     v-size="{ max: [450] }"
>     class="wrpstxzv"
>     :class="{ children: depth > 1 }"
>   >
>     <div class="main">
>       <MkAvatar class="avatar" :user="note.user" />
>       <div class="body">
>         <XNoteHeader class="header" :note="note" :mini="true" />
>         <div class="body">
>           <p v-if="note.cw != null" class="cw">
>             <Mfm
>               v-if="note.cw != ''"
>               class="text"
>               :text="note.cw"
>               :author="note.user"
>               :i="$i"
>               :custom-emojis="note.emojis"
>             />
>             <XCwButton v-model="showContent" :note="note" />
>           </p>
>           <div v-show="note.cw == null || showContent" class="content">
>             <MkSubNoteContent class="text" :note="note" />
>           </div>
>         </div>
>       </div>
>     </div>
>     <template v-if="depth < 5">
>       <MkNoteSub
>         v-for="reply in replies"
>         :key="reply.id"
>         :note="reply"
>         class="reply"
>         :detail="true"
>         :depth="depth + 1"
>       />
>     </template>
>     <div v-else class="more">
>       <MkA class="text _link" :to="notePage(note)"
>         >{{ i18n.ts.continueThread }} <i class="fas fa-angle-double-right"></i
>       ></MkA>
>     </div>
>   </div>
28,35c48,55
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkNoteHeader from '@/components/MkNoteHeader.vue';
< import MkSubNoteContent from '@/components/MkSubNoteContent.vue';
< import MkCwButton from '@/components/MkCwButton.vue';
< import { notePage } from '@/filters/note';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import XNoteHeader from "@/components/MkNoteHeader.vue";
> import MkSubNoteContent from "@/components/MkSubNoteContent.vue";
> import XCwButton from "@/components/MkCwButton.vue";
> import { notePage } from "@/filters/note";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
37,39c57,60
< const props = withDefaults(defineProps<{
< 	note: misskey.entities.Note;
< 	detail?: boolean;
---
> const props = withDefaults(
>   defineProps<{
>     note: misskey.entities.Note;
>     detail?: boolean;
41,45c62,68
< 	// how many notes are in between this one and the note being viewed in detail
< 	depth?: number;
< }>(), {
< 	depth: 1,
< });
---
>     // how many notes are in between this one and the note being viewed in detail
>     depth?: number;
>   }>(),
>   {
>     depth: 1,
>   }
> );
51,56c74,79
< 	os.api('notes/children', {
< 		noteId: props.note.id,
< 		limit: 5,
< 	}).then(res => {
< 		replies = res;
< 	});
---
>   os.api("notes/children", {
>     noteId: props.note.id,
>     limit: 5,
>   }).then((res) => {
>     replies = res;
>   });
60,63c83,86
< <style lang="scss" module>
< .root {
< 	padding: 16px 32px;
< 	font-size: 0.9em;
---
> <style lang="scss" scoped>
> .wrpstxzv {
>   padding: 16px 32px;
>   font-size: 0.9em;
65,69c88,90
< 	&.children {
< 		padding: 10px 0 0 16px;
< 		font-size: 1em;
< 	}
< }
---
>   &.max-width_450px {
>     padding: 14px 16px;
>   }
71,73c92,94
< .main {
< 	display: flex;
< }
---
>   &.children {
>     padding: 10px 0 0 16px;
>     font-size: 1em;
75,82c96,99
< .avatar {
< 	flex-shrink: 0;
< 	display: block;
< 	margin: 0 8px 0 0;
< 	width: 38px;
< 	height: 38px;
< 	border-radius: 8px;
< }
---
>     &.max-width_450px {
>       padding: 10px 0 0 8px;
>     }
>   }
84,87c101,102
< .body {
< 	flex: 1;
< 	min-width: 0;
< }
---
>   > .main {
>     display: flex;
89,91c104,111
< .header {
< 	margin-bottom: 2px;
< }
---
>     > .avatar {
>       flex-shrink: 0;
>       display: block;
>       margin: 0 8px 0 0;
>       width: 38px;
>       height: 38px;
>       border-radius: 8px;
>     }
93,99c113,115
< .cw {
< 	cursor: default;
< 	display: block;
< 	margin: 0;
< 	padding: 0;
< 	overflow-wrap: break-word;
< }
---
>     > .body {
>       flex: 1;
>       min-width: 0;
101,104c117,119
< .text {
< 	margin: 0;
< 	padding: 0;
< }
---
>       > .header {
>         margin-bottom: 2px;
>       }
106,109c121,127
< .reply, .more {
< 	border-left: solid 0.5px var(--divider);
< 	margin-top: 10px;
< }
---
>       > .body {
>         > .cw {
>           cursor: default;
>           display: block;
>           margin: 0;
>           padding: 0;
>           overflow-wrap: break-word;
111,113c129,132
< .more {
< 	padding: 10px 0 0 16px;
< }
---
>           > .text {
>             margin-right: 8px;
>           }
>         }
115,117c134,142
< @container (max-width: 450px) {
< 	.root {
< 		padding: 14px 16px;
---
>         > .content {
>           > .text {
>             margin: 0;
>             padding: 0;
>           }
>         }
>       }
>     }
>   }
119,122c144,152
< 		&.children {
< 			padding: 10px 0 0 8px;
< 		}
< 	}
---
>   > .reply,
>   > .more {
>     border-left: solid 0.5px var(--divider);
>     margin-top: 10px;
>   }
> 
>   > .more {
>     padding: 10px 0 0 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNotes.vue RiricaV13/components/MkNotes.vue
2,8c2,8
< <MkPagination ref="pagingComponent" :pagination="pagination">
< 	<template #empty>
< 		<div class="_fullinfo">
< 			<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 			<div>{{ i18n.ts.noNotes }}</div>
< 		</div>
< 	</template>
---
>   <MkPagination ref="pagingComponent" :pagination="pagination">
>     <template #empty>
>       <div class="_fullinfo">
>         <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>         <div>{{ i18n.ts.noNotes }}</div>
>       </div>
>     </template>
10,26c10,30
< 	<template #default="{ items: notes }">
< 		<div :class="[$style.root, { [$style.noGap]: noGap }]">
< 			<MkDateSeparatedList
< 				ref="notes"
< 				v-slot="{ item: note }"
< 				:items="notes"
< 				:direction="pagination.reversed ? 'up' : 'down'"
< 				:reversed="pagination.reversed"
< 				:no-gap="noGap"
< 				:ad="true"
< 				:class="$style.notes"
< 			>
< 				<XNote :key="note._featuredId_ || note._prId_ || note.id" :class="$style.note" :note="note"/>
< 			</MkDateSeparatedList>
< 		</div>
< 	</template>
< </MkPagination>
---
>     <template #default="{ items: notes }">
>       <div class="giivymft" :class="{ noGap }">
>         <XList
>           ref="notes"
>           v-slot="{ item: note }"
>           :items="notes"
>           :direction="pagination.reversed ? 'up' : 'down'"
>           :reversed="pagination.reversed"
>           :no-gap="noGap"
>           :ad="true"
>           class="notes"
>         >
>           <XNote
>             :key="note._featuredId_ || note._prId_ || note.id"
>             class="qtqtichx"
>             :note="note"
>           />
>         </XList>
>       </div>
>     </template>
>   </MkPagination>
30,34c34,38
< import { shallowRef } from 'vue';
< import XNote from '@/components/MkNote.vue';
< import MkDateSeparatedList from '@/components/MkDateSeparatedList.vue';
< import MkPagination, { Paging } from '@/components/MkPagination.vue';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import XNote from "@/components/MkNote.vue";
> import XList from "@/components/MkDateSeparatedList.vue";
> import MkPagination, { Paging } from "@/components/MkPagination.vue";
> import { i18n } from "@/i18n";
37,38c41,42
< 	pagination: Paging;
< 	noGap?: boolean;
---
>   pagination: Paging;
>   noGap?: boolean;
41c45
< const pagingComponent = shallowRef<InstanceType<typeof MkPagination>>();
---
> const pagingComponent = ref<InstanceType<typeof MkPagination>>();
44c48
< 	pagingComponent,
---
>   pagingComponent,
48,54c52,58
< <style lang="scss" module>
< .root {
< 	&.noGap {
< 		> .notes {
< 			background: var(--panel);
< 		}
< 	}
---
> <style lang="scss" scoped>
> .giivymft {
>   &.noGap {
>     > .notes {
>       background: var(--panel);
>     }
>   }
56,58c60,62
< 	&:not(.noGap) {
< 		> .notes {
< 			background: var(--bg);
---
>   &:not(.noGap) {
>     > .notes {
>       background: var(--bg);
60,65c64,69
< 			.note {
< 				background: var(--panel);
< 				border-radius: var(--radius);
< 			}
< 		}
< 	}
---
>       .qtqtichx {
>         background: var(--panel);
>         border-radius: var(--radius);
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNotification.vue RiricaV13/components/MkNotification.vue
2,75c2,234
< <div ref="elRef" :class="$style.root">
< 	<div v-once :class="$style.head">
< 		<MkAvatar v-if="notification.type === 'pollEnded'" :class="$style.icon" :user="notification.note.user" link preview/>
< 		<MkAvatar v-else-if="notification.type === 'achievementEarned'" :class="$style.icon" :user="$i" link preview/>
< 		<MkAvatar v-else-if="notification.user" :class="$style.icon" :user="notification.user" link preview/>
< 		<img v-else-if="notification.icon" :class="$style.icon" :src="notification.icon" alt=""/>
< 		<div :class="[$style.subIcon, $style['t_' + notification.type]]">
< 			<i v-if="notification.type === 'follow'" class="ti ti-plus"></i>
< 			<i v-else-if="notification.type === 'receiveFollowRequest'" class="ti ti-clock"></i>
< 			<i v-else-if="notification.type === 'followRequestAccepted'" class="ti ti-check"></i>
< 			<i v-else-if="notification.type === 'groupInvited'" class="ti ti-certificate-2"></i>
< 			<i v-else-if="notification.type === 'renote'" class="ti ti-repeat"></i>
< 			<i v-else-if="notification.type === 'reply'" class="ti ti-arrow-back-up"></i>
< 			<i v-else-if="notification.type === 'mention'" class="ti ti-at"></i>
< 			<i v-else-if="notification.type === 'quote'" class="ti ti-quote"></i>
< 			<i v-else-if="notification.type === 'pollEnded'" class="ti ti-chart-arrows"></i>
< 			<i v-else-if="notification.type === 'achievementEarned'" class="ti ti-medal"></i>
< 			<!-- notification.reaction が null になることはまずないが、ここでoptional chaining使うと一部ブラウザで刺さるので念の為 -->
< 			<MkReactionIcon
< 				v-else-if="notification.type === 'reaction'"
< 				ref="reactionRef"
< 				:reaction="notification.reaction ? notification.reaction.replace(/^:(\w+):$/, ':$1@.:') : notification.reaction"
< 				:custom-emojis="notification.note.emojis"
< 				:no-style="true"
< 				style="width: 100%; height: 100%;"
< 			/>
< 		</div>
< 	</div>
< 	<div :class="$style.tail">
< 		<header :class="$style.header">
< 			<span v-if="notification.type === 'pollEnded'">{{ i18n.ts._notification.pollEnded }}</span>
< 			<span v-else-if="notification.type === 'achievementEarned'">{{ i18n.ts._notification.achievementEarned }}</span>
< 			<MkA v-else-if="notification.user" v-user-preview="notification.user.id" :class="$style.headerName" :to="userPage(notification.user)"><MkUserName :user="notification.user"/></MkA>
< 			<span v-else>{{ notification.header }}</span>
< 			<MkTime v-if="withTime" :time="notification.createdAt" :class="$style.headerTime"/>
< 		</header>
< 		<div v-once :class="$style.content">
< 			<MkA v-if="notification.type === 'reaction'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note)">
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 				<Mfm :text="getNoteSummary(notification.note)" :plain="true" :nowrap="!full" :author="notification.note.user"/>
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'renote'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note.renote)">
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 				<Mfm :text="getNoteSummary(notification.note.renote)" :plain="true" :nowrap="!full" :author="notification.note.renote.user"/>
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'reply'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note)">
< 				<Mfm :text="getNoteSummary(notification.note)" :plain="true" :nowrap="!full" :author="notification.note.user"/>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'mention'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note)">
< 				<Mfm :text="getNoteSummary(notification.note)" :plain="true" :nowrap="!full" :author="notification.note.user"/>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'quote'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note)">
< 				<Mfm :text="getNoteSummary(notification.note)" :plain="true" :nowrap="!full" :author="notification.note.user"/>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'pollEnded'" :class="$style.text" :to="notePage(notification.note)" :title="getNoteSummary(notification.note)">
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 				<Mfm :text="getNoteSummary(notification.note)" :plain="true" :nowrap="!full" :author="notification.note.user"/>
< 				<i class="ti ti-quote" :class="$style.quote"></i>
< 			</MkA>
< 			<MkA v-else-if="notification.type === 'achievementEarned'" :class="$style.text" to="/my/achievements">
< 				{{ i18n.ts._achievements._types['_' + notification.achievement].title }}
< 			</MkA>
< 			<span v-else-if="notification.type === 'follow'" :class="$style.text" style="opacity: 0.6;">{{ i18n.ts.youGotNewFollower }}<div v-if="full"><MkFollowButton :user="notification.user" :full="true"/></div></span>
< 			<span v-else-if="notification.type === 'followRequestAccepted'" :class="$style.text" style="opacity: 0.6;">{{ i18n.ts.followRequestAccepted }}</span>
< 			<span v-else-if="notification.type === 'receiveFollowRequest'" :class="$style.text" style="opacity: 0.6;">{{ i18n.ts.receiveFollowRequest }}<div v-if="full && !followRequestDone"><button class="_textButton" @click="acceptFollowRequest()">{{ i18n.ts.accept }}</button> | <button class="_textButton" @click="rejectFollowRequest()">{{ i18n.ts.reject }}</button></div></span>
< 			<span v-else-if="notification.type === 'groupInvited'" :class="$style.text" style="opacity: 0.6;">{{ i18n.ts.groupInvited }}: <b>{{ notification.invitation.group.name }}</b><div v-if="full && !groupInviteDone"><button class="_textButton" @click="acceptGroupInvitation()">{{ i18n.ts.accept }}</button> | <button class="_textButton" @click="rejectGroupInvitation()">{{ i18n.ts.reject }}</button></div></span>
< 			<span v-else-if="notification.type === 'app'" :class="$style.text">
< 				<Mfm :text="notification.body" :nowrap="!full"/>
< 			</span>
< 		</div>
< 	</div>
< </div>
---
>   <div
>     ref="elRef"
>     v-size="{ max: [500, 600] }"
>     class="qglefbjs"
>     :class="notification.type"
>   >
>     <div class="head">
>       <MkAvatar
>         v-if="notification.type === 'pollEnded'"
>         class="icon"
>         :user="notification.note.user"
>       />
>       <MkAvatar
>         v-else-if="notification.user"
>         class="icon"
>         :user="notification.user"
>       />
>       <img
>         v-else-if="notification.icon"
>         class="icon"
>         :src="notification.icon"
>         alt=""
>       />
>       <div class="sub-icon" :class="notification.type">
>         <i v-if="notification.type === 'follow'" class="fas fa-plus"></i>
>         <i
>           v-else-if="notification.type === 'receiveFollowRequest'"
>           class="fas fa-clock"
>         ></i>
>         <i
>           v-else-if="notification.type === 'followRequestAccepted'"
>           class="fas fa-check"
>         ></i>
>         <i
>           v-else-if="notification.type === 'groupInvited'"
>           class="fas fa-id-card-alt"
>         ></i>
>         <i
>           v-else-if="notification.type === 'renote'"
>           class="fas fa-retweet"
>         ></i>
>         <i v-else-if="notification.type === 'reply'" class="fas fa-reply"></i>
>         <i v-else-if="notification.type === 'mention'" class="fas fa-at"></i>
>         <i
>           v-else-if="notification.type === 'quote'"
>           class="fas fa-quote-left"
>         ></i>
>         <i
>           v-else-if="notification.type === 'pollVote'"
>           class="fas fa-poll-h"
>         ></i>
>         <i
>           v-else-if="notification.type === 'pollEnded'"
>           class="fas fa-poll-h"
>         ></i>
>         <!-- notification.reaction が null になることはまずないが、ここでoptional chaining使うと一部ブラウザで刺さるので念の為 -->
>         <XReactionIcon
>           v-else-if="notification.type === 'reaction'"
>           ref="reactionRef"
>           :reaction="
>             notification.reaction
>               ? notification.reaction.replace(/^:(\w+):$/, ':$1@.:')
>               : notification.reaction
>           "
>           :custom-emojis="notification.note.emojis"
>           :no-style="true"
>         />
>       </div>
>     </div>
>     <div class="tail">
>       <header>
>         <span v-if="notification.type === 'pollEnded'">{{
>           i18n.ts._notification.pollEnded
>         }}</span>
>         <MkA
>           v-else-if="notification.user"
>           v-user-preview="notification.user.id"
>           class="name"
>           :to="userPage(notification.user)"
>           ><MkUserName :user="notification.user"
>         /></MkA>
>         <span v-else>{{ notification.header }}</span>
>         <MkTime v-if="withTime" :time="notification.createdAt" class="time" />
>       </header>
>       <MkA
>         v-if="notification.type === 'reaction'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <i class="fas fa-quote-left"></i>
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>         <i class="fas fa-quote-right"></i>
>       </MkA>
>       <MkA
>         v-if="notification.type === 'renote'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note.renote)"
>       >
>         <i class="fas fa-quote-left"></i>
>         <Mfm
>           :text="getNoteSummary(notification.note.renote)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.renote.emojis"
>         />
>         <i class="fas fa-quote-right"></i>
>       </MkA>
>       <MkA
>         v-if="notification.type === 'reply'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>       </MkA>
>       <MkA
>         v-if="notification.type === 'mention'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>       </MkA>
>       <MkA
>         v-if="notification.type === 'quote'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>       </MkA>
>       <MkA
>         v-if="notification.type === 'pollVote'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <i class="fas fa-quote-left"></i>
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>         <i class="fas fa-quote-right"></i>
>       </MkA>
>       <MkA
>         v-if="notification.type === 'pollEnded'"
>         class="text"
>         :to="notePage(notification.note)"
>         :title="getNoteSummary(notification.note)"
>       >
>         <i class="fas fa-quote-left"></i>
>         <Mfm
>           :text="getNoteSummary(notification.note)"
>           :plain="true"
>           :nowrap="!full"
>           :custom-emojis="notification.note.emojis"
>         />
>         <i class="fas fa-quote-right"></i>
>       </MkA>
>       <span
>         v-if="notification.type === 'follow'"
>         class="text"
>         style="opacity: 0.6"
>         >{{ i18n.ts.youGotNewFollower }}
>         <div v-if="full">
>           <MkFollowButton :user="notification.user" :full="true" /></div
>       ></span>
>       <span
>         v-if="notification.type === 'followRequestAccepted'"
>         class="text"
>         style="opacity: 0.6"
>         >{{ i18n.ts.followRequestAccepted }}</span
>       >
>       <span
>         v-if="notification.type === 'receiveFollowRequest'"
>         class="text"
>         style="opacity: 0.6"
>         >{{ i18n.ts.receiveFollowRequest }}
>         <div v-if="full && !followRequestDone">
>           <button class="_textButton" @click="acceptFollowRequest()">
>             {{ i18n.ts.accept }}
>           </button>
>           |
>           <button class="_textButton" @click="rejectFollowRequest()">
>             {{ i18n.ts.reject }}
>           </button>
>         </div></span
>       >
>       <span
>         v-if="notification.type === 'groupInvited'"
>         class="text"
>         style="opacity: 0.6"
>         >{{ i18n.ts.groupInvited }}:
>         <b>{{ notification.invitation.group.name }}</b>
>         <div v-if="full && !groupInviteDone">
>           <button class="_textButton" @click="acceptGroupInvitation()">
>             {{ i18n.ts.accept }}
>           </button>
>           |
>           <button class="_textButton" @click="rejectGroupInvitation()">
>             {{ i18n.ts.reject }}
>           </button>
>         </div></span
>       >
>       <span v-if="notification.type === 'app'" class="text">
>         <Mfm :text="notification.body" :nowrap="!full" />
>       </span>
>     </div>
>   </div>
79,91c238,249
< import { ref, shallowRef, onMounted, onUnmounted, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import MkReactionIcon from '@/components/MkReactionIcon.vue';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import XReactionTooltip from '@/components/MkReactionTooltip.vue';
< import { getNoteSummary } from '@/scripts/get-note-summary';
< import { notePage } from '@/filters/note';
< import { userPage } from '@/filters/user';
< import { i18n } from '@/i18n';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { useTooltip } from '@/scripts/use-tooltip';
< import { $i } from '@/account';
---
> import { ref, onMounted, onUnmounted, watch } from "vue";
> import * as misskey from "misskey-js";
> import XReactionIcon from "@/components/MkReactionIcon.vue";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import XReactionTooltip from "@/components/MkReactionTooltip.vue";
> import { getNoteSummary } from "@/scripts/get-note-summary";
> import { notePage } from "@/filters/note";
> import { userPage } from "@/filters/user";
> import { i18n } from "@/i18n";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { useTooltip } from "@/scripts/use-tooltip";
93,100c251,261
< const props = withDefaults(defineProps<{
< 	notification: misskey.entities.Notification;
< 	withTime?: boolean;
< 	full?: boolean;
< }>(), {
< 	withTime: false,
< 	full: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     notification: misskey.entities.Notification;
>     withTime?: boolean;
>     full?: boolean;
>   }>(),
>   {
>     withTime: false,
>     full: false,
>   }
> );
102c263
< const elRef = shallowRef<HTMLElement>(null);
---
> const elRef = ref<HTMLElement>(null);
109,116c270,277
< 	if (!props.notification.isRead) {
< 		readObserver = new IntersectionObserver((entries, observer) => {
< 			if (!entries.some(entry => entry.isIntersecting)) return;
< 			stream.send('readNotification', {
< 				id: props.notification.id,
< 			});
< 			observer.disconnect();
< 		});
---
>   if (!props.notification.isRead) {
>     readObserver = new IntersectionObserver((entries, observer) => {
>       if (!entries.some((entry) => entry.isIntersecting)) return;
>       stream.send("readNotification", {
>         id: props.notification.id,
>       });
>       observer.disconnect();
>     });
118c279
< 		readObserver.observe(elRef.value);
---
>     readObserver.observe(elRef.value);
120,121c281,282
< 		connection = stream.useChannel('main');
< 		connection.on('readAllNotifications', () => readObserver.disconnect());
---
>     connection = stream.useChannel("main");
>     connection.on("readAllNotifications", () => readObserver.disconnect());
123,126c284,287
< 		watch(props.notification.isRead, () => {
< 			readObserver.disconnect();
< 		});
< 	}
---
>     watch(props.notification.isRead, () => {
>       readObserver.disconnect();
>     });
>   }
130,131c291,292
< 	if (readObserver) readObserver.disconnect();
< 	if (connection) connection.dispose();
---
>   if (readObserver) readObserver.disconnect();
>   if (connection) connection.dispose();
138,139c299,300
< 	followRequestDone.value = true;
< 	os.api('following/requests/accept', { userId: props.notification.user.id });
---
>   followRequestDone.value = true;
>   os.api("following/requests/accept", { userId: props.notification.user.id });
143,144c304,305
< 	followRequestDone.value = true;
< 	os.api('following/requests/reject', { userId: props.notification.user.id });
---
>   followRequestDone.value = true;
>   os.api("following/requests/reject", { userId: props.notification.user.id });
148,149c309,312
< 	groupInviteDone.value = true;
< 	os.apiWithDialog('users/groups/invitations/accept', { invitationId: props.notification.invitation.id });
---
>   groupInviteDone.value = true;
>   os.apiWithDialog("users/groups/invitations/accept", {
>     invitationId: props.notification.invitation.id,
>   });
153,154c316,319
< 	groupInviteDone.value = true;
< 	os.api('users/groups/invitations/reject', { invitationId: props.notification.invitation.id });
---
>   groupInviteDone.value = true;
>   os.api("users/groups/invitations/reject", {
>     invitationId: props.notification.invitation.id,
>   });
158,163c323,335
< 	os.popup(XReactionTooltip, {
< 		showing,
< 		reaction: props.notification.reaction ? props.notification.reaction.replace(/^:(\w+):$/, ':$1@.:') : props.notification.reaction,
< 		emojis: props.notification.note.emojis,
< 		targetElement: reactionRef.value.$el,
< 	}, {}, 'closed');
---
>   os.popup(
>     XReactionTooltip,
>     {
>       showing,
>       reaction: props.notification.reaction
>         ? props.notification.reaction.replace(/^:(\w+):$/, ":$1@.:")
>         : props.notification.reaction,
>       emojis: props.notification.note.emojis,
>       targetElement: reactionRef.value.$el,
>     },
>     {},
>     "closed"
>   );
167,176c339,347
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	box-sizing: border-box;
< 	padding: 24px 32px;
< 	font-size: 0.9em;
< 	overflow-wrap: break-word;
< 	display: flex;
< 	contain: content;
< }
---
> <style lang="scss" scoped>
> .qglefbjs {
>   position: relative;
>   box-sizing: border-box;
>   padding: 24px 32px;
>   font-size: 0.9em;
>   overflow-wrap: break-word;
>   display: flex;
>   contain: content;
178,185c349,352
< .head {
< 	position: sticky;
< 	top: 0;
< 	flex-shrink: 0;
< 	width: 42px;
< 	height: 42px;
< 	margin-right: 8px;
< }
---
>   &.max-width_600px {
>     padding: 16px;
>     font-size: 0.9em;
>   }
187,192c354,357
< .icon {
< 	display: block;
< 	width: 100%;
< 	height: 100%;
< 	border-radius: 6px;
< }
---
>   &.max-width_500px {
>     padding: 12px;
>     font-size: 0.85em;
>   }
194,207c359,365
< .subIcon {
< 	position: absolute;
< 	z-index: 1;
< 	bottom: -2px;
< 	right: -2px;
< 	width: 20px;
< 	height: 20px;
< 	box-sizing: border-box;
< 	border-radius: 100%;
< 	background: var(--panel);
< 	box-shadow: 0 0 0 3px var(--panel);
< 	font-size: 12px;
< 	text-align: center;
< 	color: #fff;
---
>   > .head {
>     position: sticky;
>     top: 0;
>     flex-shrink: 0;
>     width: 42px;
>     height: 42px;
>     margin-right: 8px;
209,212c367,372
< 	&:empty {
< 		display: none;
< 	}
< }
---
>     > .icon {
>       display: block;
>       width: 100%;
>       height: 100%;
>       border-radius: 6px;
>     }
214,218c374,386
< .t_follow, .t_followRequestAccepted, .t_receiveFollowRequest, .t_groupInvited {
< 	padding: 3px;
< 	background: #36aed2;
< 	pointer-events: none;
< }
---
>     > .sub-icon {
>       position: absolute;
>       z-index: 1;
>       bottom: -2px;
>       right: -2px;
>       width: 20px;
>       height: 20px;
>       box-sizing: border-box;
>       border-radius: 100%;
>       background: var(--panel);
>       box-shadow: 0 0 0 3px var(--panel);
>       font-size: 12px;
>       text-align: center;
220,224c388,390
< .t_renote {
< 	padding: 3px;
< 	background: #36d298;
< 	pointer-events: none;
< }
---
>       &:empty {
>         display: none;
>       }
226,230c392,396
< .t_quote {
< 	padding: 3px;
< 	background: #36d298;
< 	pointer-events: none;
< }
---
>       > * {
>         color: #fff;
>         width: 100%;
>         height: 100%;
>       }
232,236c398,405
< .t_reply {
< 	padding: 3px;
< 	background: #007aff;
< 	pointer-events: none;
< }
---
>       &.follow,
>       &.followRequestAccepted,
>       &.receiveFollowRequest,
>       &.groupInvited {
>         padding: 3px;
>         background: #36aed2;
>         pointer-events: none;
>       }
238,242c407,411
< .t_mention {
< 	padding: 3px;
< 	background: #88a6b7;
< 	pointer-events: none;
< }
---
>       &.renote {
>         padding: 3px;
>         background: #36d298;
>         pointer-events: none;
>       }
244,248c413,417
< .t_pollEnded {
< 	padding: 3px;
< 	background: #88a6b7;
< 	pointer-events: none;
< }
---
>       &.quote {
>         padding: 3px;
>         background: #36d298;
>         pointer-events: none;
>       }
250,254c419,423
< .t_achievementEarned {
< 	padding: 3px;
< 	background: #cb9a11;
< 	pointer-events: none;
< }
---
>       &.reply {
>         padding: 3px;
>         background: #007aff;
>         pointer-events: none;
>       }
256,259c425,429
< .tail {
< 	flex: 1;
< 	min-width: 0;
< }
---
>       &.mention {
>         padding: 3px;
>         background: #88a6b7;
>         pointer-events: none;
>       }
261,265c431,435
< .header {
< 	display: flex;
< 	align-items: baseline;
< 	white-space: nowrap;
< }
---
>       &.pollVote {
>         padding: 3px;
>         background: #88a6b7;
>         pointer-events: none;
>       }
267,272c437,443
< .headerName {
< 	text-overflow: ellipsis;
< 	white-space: nowrap;
< 	min-width: 0;
< 	overflow: hidden;
< }
---
>       &.pollEnded {
>         padding: 3px;
>         background: #88a6b7;
>         pointer-events: none;
>       }
>     }
>   }
274,277c445,447
< .headerTime {
< 	margin-left: auto;
< 	font-size: 0.9em;
< }
---
>   > .tail {
>     flex: 1;
>     min-width: 0;
279,280c449,452
< .content {
< }
---
>     > header {
>       display: flex;
>       align-items: baseline;
>       white-space: nowrap;
282,286c454,459
< .text {
< 	display: flex;
< 	width: 100%;
< 	overflow: clip;
< }
---
>       > .name {
>         text-overflow: ellipsis;
>         white-space: nowrap;
>         min-width: 0;
>         overflow: hidden;
>       }
288,292c461,465
< .quote {
< 	vertical-align: super;
< 	font-size: 50%;
< 	opacity: 0.5;
< }
---
>       > .time {
>         margin-left: auto;
>         font-size: 0.9em;
>       }
>     }
294,296c467,470
< .quote:first-child {
< 	margin-right: 4px;
< }
---
>     > .text {
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
298,300c472,476
< .quote:last-child {
< 	margin-left: 4px;
< }
---
>       > i {
>         vertical-align: super;
>         font-size: 50%;
>         opacity: 0.5;
>       }
302,307c478,480
< @container (max-width: 600px) {
< 	.root {
< 		padding: 16px;
< 		font-size: 0.9em;
< 	}
< }
---
>       > i:first-child {
>         margin-right: 4px;
>       }
309,313c482,486
< @container (max-width: 500px) {
< 	.root {
< 		padding: 12px;
< 		font-size: 0.85em;
< 	}
---
>       > i:last-child {
>         margin-left: 4px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNotificationSettingWindow.vue RiricaV13/components/MkNotificationSettingWindow.vue
2,32c2,32
< <MkModalWindow
< 	ref="dialog"
< 	:width="400"
< 	:height="450"
< 	:with-ok-button="true"
< 	:ok-button-disabled="false"
< 	@ok="ok()"
< 	@close="dialog.close()"
< 	@closed="emit('closed')"
< >
< 	<template #header>{{ i18n.ts.notificationSetting }}</template>
< 
< 	<MkSpacer :margin-min="20" :margin-max="28">
< 		<div class="_gaps_m">
< 			<template v-if="showGlobalToggle">
< 				<MkSwitch v-model="useGlobalSetting">
< 					{{ i18n.ts.useGlobalSetting }}
< 					<template #caption>{{ i18n.ts.useGlobalSettingDesc }}</template>
< 				</MkSwitch>
< 			</template>
< 			<template v-if="!useGlobalSetting">
< 				<MkInfo>{{ i18n.ts.notificationSettingDesc }}</MkInfo>
< 				<div class="_buttons">
< 					<MkButton inline @click="disableAll">{{ i18n.ts.disableAll }}</MkButton>
< 					<MkButton inline @click="enableAll">{{ i18n.ts.enableAll }}</MkButton>
< 				</div>
< 				<MkSwitch v-for="ntype in notificationTypes" :key="ntype" v-model="typesMap[ntype]">{{ i18n.t(`_notification._types.${ntype}`) }}</MkSwitch>
< 			</template>
< 		</div>
< 	</MkSpacer>
< </MkModalWindow>
---
>   <XModalWindow
>     ref="dialog"
>     :width="400"
>     :height="450"
>     :with-ok-button="true"
>     :ok-button-disabled="false"
>     @ok="ok()"
>     @close="dialog.close()"
>     @closed="emit('closed')"
>   >
>     <template #header>{{ i18n.ts.notificationSetting }}</template>
>     <div class="_monolithic_">
>       <div v-if="showGlobalToggle" class="_section">
>         <MkSwitch v-model="useGlobalSetting">
>           {{ i18n.ts.useGlobalSetting }}
>           <template #caption>{{ i18n.ts.useGlobalSettingDesc }}</template>
>         </MkSwitch>
>       </div>
>       <div v-if="!useGlobalSetting" class="_section">
>         <MkInfo>{{ i18n.ts.notificationSettingDesc }}</MkInfo>
>         <MkButton inline @click="disableAll">{{ i18n.ts.disableAll }}</MkButton>
>         <MkButton inline @click="enableAll">{{ i18n.ts.enableAll }}</MkButton>
>         <MkSwitch
>           v-for="ntype in notificationTypes"
>           :key="ntype"
>           v-model="typesMap[ntype]"
>           >{{ i18n.t(`_notification._types.${ntype}`) }}</MkSwitch
>         >
>       </div>
>     </div>
>   </XModalWindow>
36,42c36,42
< import { } from 'vue';
< import { notificationTypes } from 'misskey-js';
< import MkSwitch from './MkSwitch.vue';
< import MkInfo from './MkInfo.vue';
< import MkButton from './MkButton.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import { notificationTypes } from "misskey-js";
> import MkSwitch from "./form/switch.vue";
> import MkInfo from "./MkInfo.vue";
> import MkButton from "./MkButton.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import { i18n } from "@/i18n";
45,46c45,46
< 	(ev: 'done', v: { includingTypes: string[] | null }): void,
< 	(ev: 'closed'): void,
---
>   (ev: "done", v: { includingTypes: string[] | null }): void;
>   (ev: "closed"): void;
49,55c49,58
< const props = withDefaults(defineProps<{
< 	includingTypes?: typeof notificationTypes[number][] | null;
< 	showGlobalToggle?: boolean;
< }>(), {
< 	includingTypes: () => [],
< 	showGlobalToggle: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     includingTypes?: typeof notificationTypes[number][] | null;
>     showGlobalToggle?: boolean;
>   }>(),
>   {
>     includingTypes: () => [],
>     showGlobalToggle: true,
>   }
> );
59c62
< const dialog = $shallowRef<InstanceType<typeof MkModalWindow>>();
---
> const dialog = $ref<InstanceType<typeof XModalWindow>>();
62c65,68
< let useGlobalSetting = $ref((includingTypes === null || includingTypes.length === 0) && props.showGlobalToggle);
---
> let useGlobalSetting = $ref(
>   (includingTypes === null || includingTypes.length === 0) &&
>     props.showGlobalToggle
> );
65c71
< 	typesMap[ntype] = includingTypes.includes(ntype);
---
>   typesMap[ntype] = includingTypes.includes(ntype);
69,76c75,83
< 	if (useGlobalSetting) {
< 		emit('done', { includingTypes: null });
< 	} else {
< 		emit('done', {
< 			includingTypes: (Object.keys(typesMap) as typeof notificationTypes[number][])
< 				.filter(type => typesMap[type]),
< 		});
< 	}
---
>   if (useGlobalSetting) {
>     emit("done", { includingTypes: null });
>   } else {
>     emit("done", {
>       includingTypes: (
>         Object.keys(typesMap) as typeof notificationTypes[number][]
>       ).filter((type) => typesMap[type]),
>     });
>   }
78c85
< 	dialog.close();
---
>   dialog.close();
82,84c89,91
< 	for (const type in typesMap) {
< 		typesMap[type as typeof notificationTypes[number]] = false;
< 	}
---
>   for (const type in typesMap) {
>     typesMap[type as typeof notificationTypes[number]] = false;
>   }
88,90c95,97
< 	for (const type in typesMap) {
< 		typesMap[type as typeof notificationTypes[number]] = true;
< 	}
---
>   for (const type in typesMap) {
>     typesMap[type as typeof notificationTypes[number]] = true;
>   }
Only in RiricaV13/components: MkNotificationToast.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNotifications.vue RiricaV13/components/MkNotifications.vue
2,8c2,8
< <MkPagination ref="pagingComponent" :pagination="pagination">
< 	<template #empty>
< 		<div class="_fullinfo">
< 			<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 			<div>{{ i18n.ts.noNotifications }}</div>
< 		</div>
< 	</template>
---
>   <MkPagination ref="pagingComponent" :pagination="pagination">
>     <template #empty>
>       <div class="_fullinfo">
>         <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>         <div>{{ i18n.ts.noNotifications }}</div>
>       </div>
>     </template>
10,16c10,32
< 	<template #default="{ items: notifications }">
< 		<MkDateSeparatedList v-slot="{ item: notification }" :class="$style.list" :items="notifications" :no-gap="true">
< 			<XNote v-if="['reply', 'quote', 'mention'].includes(notification.type)" :key="notification.id" :note="notification.note"/>
< 			<XNotification v-else :key="notification.id" :notification="notification" :with-time="true" :full="false" class="_panel notification"/>
< 		</MkDateSeparatedList>
< 	</template>
< </MkPagination>
---
>     <template #default="{ items: notifications }">
>       <XList
>         v-slot="{ item: notification }"
>         class="elsfgstc"
>         :items="notifications"
>         :no-gap="true"
>       >
>         <XNote
>           v-if="['reply', 'quote', 'mention'].includes(notification.type)"
>           :key="notification.id"
>           :note="notification.note"
>         />
>         <XNotification
>           v-else
>           :key="notification.id"
>           :notification="notification"
>           :with-time="true"
>           :full="true"
>           class="_panel notification"
>         />
>       </XList>
>     </template>
>   </MkPagination>
20,29c36,52
< import { defineComponent, markRaw, onUnmounted, onMounted, computed, shallowRef } from 'vue';
< import { notificationTypes } from 'misskey-js';
< import MkPagination, { Paging } from '@/components/MkPagination.vue';
< import XNotification from '@/components/MkNotification.vue';
< import MkDateSeparatedList from '@/components/MkDateSeparatedList.vue';
< import XNote from '@/components/MkNote.vue';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
---
> import {
>   defineComponent,
>   markRaw,
>   onUnmounted,
>   onMounted,
>   computed,
>   ref,
> } from "vue";
> import { notificationTypes } from "misskey-js";
> import MkPagination, { Paging } from "@/components/MkPagination.vue";
> import XNotification from "@/components/MkNotification.vue";
> import XList from "@/components/MkDateSeparatedList.vue";
> import XNote from "@/components/MkNote.vue";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
32,33c55,56
< 	includeTypes?: typeof notificationTypes[number][];
< 	unreadOnly?: boolean;
---
>   includeTypes?: typeof notificationTypes[number][];
>   unreadOnly?: boolean;
36c59
< const pagingComponent = shallowRef<InstanceType<typeof MkPagination>>();
---
> const pagingComponent = ref<InstanceType<typeof MkPagination>>();
39,45c62,68
< 	endpoint: 'i/notifications' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		includeTypes: props.includeTypes ?? undefined,
< 		excludeTypes: props.includeTypes ? undefined : $i.mutingNotificationTypes,
< 		unreadOnly: props.unreadOnly,
< 	})),
---
>   endpoint: "i/notifications" as const,
>   limit: 10,
>   params: computed(() => ({
>     includeTypes: props.includeTypes ?? undefined,
>     excludeTypes: props.includeTypes ? undefined : $i.mutingNotificationTypes,
>     unreadOnly: props.unreadOnly,
>   })),
49,54c72,79
< 	const isMuted = props.includeTypes ? !props.includeTypes.includes(notification.type) : $i.mutingNotificationTypes.includes(notification.type);
< 	if (isMuted || document.visibilityState === 'visible') {
< 		stream.send('readNotification', {
< 			id: notification.id,
< 		});
< 	}
---
>   const isMuted = props.includeTypes
>     ? !props.includeTypes.includes(notification.type)
>     : $i.mutingNotificationTypes.includes(notification.type);
>   if (isMuted || document.visibilityState === "visible") {
>     stream.send("readNotification", {
>       id: notification.id,
>     });
>   }
56,61c81,86
< 	if (!isMuted) {
< 		pagingComponent.value.prepend({
< 			...notification,
< 			isRead: document.visibilityState === 'visible',
< 		});
< 	}
---
>   if (!isMuted) {
>     pagingComponent.value.prepend({
>       ...notification,
>       isRead: document.visibilityState === "visible",
>     });
>   }
67,92c92,117
< 	connection = stream.useChannel('main');
< 	connection.on('notification', onNotification);
< 	connection.on('readAllNotifications', () => {
< 		if (pagingComponent.value) {
< 			for (const item of pagingComponent.value.queue) {
< 				item.isRead = true;
< 			}
< 			for (const item of pagingComponent.value.items) {
< 				item.isRead = true;
< 			}
< 		}
< 	});
< 	connection.on('readNotifications', notificationIds => {
< 		if (pagingComponent.value) {
< 			for (let i = 0; i < pagingComponent.value.queue.length; i++) {
< 				if (notificationIds.includes(pagingComponent.value.queue[i].id)) {
< 					pagingComponent.value.queue[i].isRead = true;
< 				}
< 			}
< 			for (let i = 0; i < (pagingComponent.value.items || []).length; i++) {
< 				if (notificationIds.includes(pagingComponent.value.items[i].id)) {
< 					pagingComponent.value.items[i].isRead = true;
< 				}
< 			}
< 		}
< 	});
---
>   connection = stream.useChannel("main");
>   connection.on("notification", onNotification);
>   connection.on("readAllNotifications", () => {
>     if (pagingComponent.value) {
>       for (const item of pagingComponent.value.queue) {
>         item.isRead = true;
>       }
>       for (const item of pagingComponent.value.items) {
>         item.isRead = true;
>       }
>     }
>   });
>   connection.on("readNotifications", (notificationIds) => {
>     if (pagingComponent.value) {
>       for (let i = 0; i < pagingComponent.value.queue.length; i++) {
>         if (notificationIds.includes(pagingComponent.value.queue[i].id)) {
>           pagingComponent.value.queue[i].isRead = true;
>         }
>       }
>       for (let i = 0; i < (pagingComponent.value.items || []).length; i++) {
>         if (notificationIds.includes(pagingComponent.value.items[i].id)) {
>           pagingComponent.value.items[i].isRead = true;
>         }
>       }
>     }
>   });
96c121
< 	if (connection) connection.dispose();
---
>   if (connection) connection.dispose();
100,102c125,127
< <style lang="scss" module>
< .list {
< 	background: var(--panel);
---
> <style lang="scss" scoped>
> .elsfgstc {
>   background: var(--panel);
Only in misskeyV13/packages/frontend/src/components: MkNumber.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkNumberDiff.vue RiricaV13/components/MkNumberDiff.vue
2,4c2,5
< <span class="ceaaebcd" :class="{ isPlus, isMinus, isZero }">
< 	<slot name="before"></slot>{{ isPlus ? '+' : '' }}{{ number(value) }}<slot name="after"></slot>
< </span>
---
>   <span class="ceaaebcd" :class="{ isPlus, isMinus, isZero }">
>     <slot name="before"></slot>{{ isPlus ? "+" : "" }}{{ number(value)
>     }}<slot name="after"></slot>
>   </span>
8,9c9,10
< import { computed, defineComponent } from 'vue';
< import number from '@/filters/number';
---
> import { computed, defineComponent } from "vue";
> import number from "@/filters/number";
12,17c13,18
< 	props: {
< 		value: {
< 			type: Number,
< 			required: true,
< 		},
< 	},
---
>   props: {
>     value: {
>       type: Number,
>       required: true,
>     },
>   },
19,29c20,30
< 	setup(props) {
< 		const isPlus = computed(() => props.value > 0);
< 		const isMinus = computed(() => props.value < 0);
< 		const isZero = computed(() => props.value === 0);
< 		return {
< 			isPlus,
< 			isMinus,
< 			isZero,
< 			number,
< 		};
< 	},
---
>   setup(props) {
>     const isPlus = computed(() => props.value > 0);
>     const isMinus = computed(() => props.value < 0);
>     const isZero = computed(() => props.value === 0);
>     return {
>       isPlus,
>       isMinus,
>       isZero,
>       number,
>     };
>   },
35,37c36,38
< 	&.isPlus {
< 		color: var(--success);
< 	}
---
>   &.isPlus {
>     color: var(--success);
>   }
39,41c40,42
< 	&.isMinus {
< 		color: var(--error);
< 	}
---
>   &.isMinus {
>     color: var(--error);
>   }
43,45c44,46
< 	&.isZero {
< 		opacity: 0.5;
< 	}
---
>   &.isZero {
>     opacity: 0.5;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkObjectView.value.vue RiricaV13/components/MkObjectView.value.vue
2,28c2,48
< <div class="igpposuu _monospace">
< 	<div v-if="value === null" class="null">null</div>
< 	<div v-else-if="typeof value === 'boolean'" class="boolean" :class="{ true: value, false: !value }">{{ value ? 'true' : 'false' }}</div>
< 	<div v-else-if="typeof value === 'string'" class="string">"{{ value }}"</div>
< 	<div v-else-if="typeof value === 'number'" class="number">{{ number(value) }}</div>
< 	<div v-else-if="isArray(value) && isEmpty(value)" class="array empty">[]</div>
< 	<div v-else-if="isArray(value)" class="array">
< 		<div v-for="i in value.length" class="element">
< 			{{ i }}: <XValue :value="value[i - 1]" collapsed/>
< 		</div>
< 	</div>
< 	<div v-else-if="isObject(value) && isEmpty(value)" class="object empty">{}</div>
< 	<div v-else-if="isObject(value)" class="object">
< 		<div v-for="k in Object.keys(value)" class="kv">
< 			<button class="toggle _button" :class="{ visible: collapsable(value[k]) }" @click="collapsed[k] = !collapsed[k]">{{ collapsed[k] ? '+' : '-' }}</button>
< 			<div class="k">{{ k }}:</div>
< 			<div v-if="collapsed[k]" class="v">
< 				<button class="_button" @click="collapsed[k] = !collapsed[k]">
< 					<template v-if="typeof value[k] === 'string'">"..."</template>
< 					<template v-else-if="isArray(value[k])">[...]</template>
< 					<template v-else-if="isObject(value[k])">{...}</template>
< 				</button>
< 			</div>
< 			<div v-else class="v"><XValue :value="value[k]"/></div>
< 		</div>
< 	</div>
< </div>
---
>   <div class="igpposuu _monospace">
>     <div v-if="value === null" class="null">null</div>
>     <div
>       v-else-if="typeof value === 'boolean'"
>       class="boolean"
>       :class="{ true: value, false: !value }"
>     >
>       {{ value ? "true" : "false" }}
>     </div>
>     <div v-else-if="typeof value === 'string'" class="string">
>       "{{ value }}"
>     </div>
>     <div v-else-if="typeof value === 'number'" class="number">
>       {{ number(value) }}
>     </div>
>     <div v-else-if="isArray(value) && isEmpty(value)" class="array empty">
>       []
>     </div>
>     <div v-else-if="isArray(value)" class="array">
>       <div v-for="i in value.length" class="element">
>         {{ i }}: <XValue :value="value[i - 1]" collapsed />
>       </div>
>     </div>
>     <div v-else-if="isObject(value) && isEmpty(value)" class="object empty">
>       {}
>     </div>
>     <div v-else-if="isObject(value)" class="object">
>       <div v-for="k in Object.keys(value)" class="kv">
>         <button
>           class="toggle _button"
>           :class="{ visible: collapsable(value[k]) }"
>           @click="collapsed[k] = !collapsed[k]"
>         >
>           {{ collapsed[k] ? "+" : "-" }}
>         </button>
>         <div class="k">{{ k }}:</div>
>         <div v-if="collapsed[k]" class="v">
>           <button class="_button" @click="collapsed[k] = !collapsed[k]">
>             <template v-if="typeof value[k] === 'string'">"..."</template>
>             <template v-else-if="isArray(value[k])">[...]</template>
>             <template v-else-if="isObject(value[k])">{...}</template>
>           </button>
>         </div>
>         <div v-else class="v"><XValue :value="value[k]" /></div>
>       </div>
>     </div>
>   </div>
32,33c52,53
< import { computed, defineComponent, reactive, ref } from 'vue';
< import number from '@/filters/number';
---
> import { computed, defineComponent, reactive, ref } from "vue";
> import number from "@/filters/number";
36c56
< 	name: 'XValue',
---
>   name: "XValue",
38,42c58,62
< 	props: {
< 		value: {
< 			required: true,
< 		},
< 	},
---
>   props: {
>     value: {
>       required: true,
>     },
>   },
44,45c64,65
< 	setup(props) {
< 		const collapsed = reactive({});
---
>   setup(props) {
>     const collapsed = reactive({});
47,51c67,71
< 		if (isObject(props.value)) {
< 			for (const key in props.value) {
< 				collapsed[key] = collapsable(props.value[key]);
< 			}
< 		}
---
>     if (isObject(props.value)) {
>       for (const key in props.value) {
>         collapsed[key] = collapsable(props.value[key]);
>       }
>     }
53,55c73,75
< 		function isObject(v): boolean {
< 			return typeof v === 'object' && !Array.isArray(v) && v !== null;
< 		}
---
>     function isObject(v): boolean {
>       return typeof v === "object" && !Array.isArray(v) && v !== null;
>     }
57,59c77,79
< 		function isArray(v): boolean {
< 			return Array.isArray(v);
< 		}
---
>     function isArray(v): boolean {
>       return Array.isArray(v);
>     }
61,63c81,86
< 		function isEmpty(v): boolean {
< 			return (isArray(v) && v.length === 0) || (isObject(v) && Object.keys(v).length === 0);
< 		}
---
>     function isEmpty(v): boolean {
>       return (
>         (isArray(v) && v.length === 0) ||
>         (isObject(v) && Object.keys(v).length === 0)
>       );
>     }
65,67c88,90
< 		function collapsable(v): boolean {
< 			return (isObject(v) || isArray(v)) && !isEmpty(v);
< 		}
---
>     function collapsable(v): boolean {
>       return (isObject(v) || isArray(v)) && !isEmpty(v);
>     }
69,77c92,100
< 		return {
< 			number,
< 			collapsed,
< 			isObject,
< 			isArray,
< 			isEmpty,
< 			collapsable,
< 		};
< 	},
---
>     return {
>       number,
>       collapsed,
>       isObject,
>       isArray,
>       isEmpty,
>       collapsable,
>     };
>   },
83c106
< 	display: inline;
---
>   display: inline;
85,88c108,111
< 	> .null {
< 		display: inline;
< 		opacity: 0.7;
< 	}
---
>   > .null {
>     display: inline;
>     opacity: 0.7;
>   }
90,92c113,115
< 	> .boolean {
< 		display: inline;
< 		color: var(--codeBoolean);
---
>   > .boolean {
>     display: inline;
>     color: var(--codeBoolean);
94,96c117,119
< 		&.true {
< 			font-weight: bold;
< 		}
---
>     &.true {
>       font-weight: bold;
>     }
98,101c121,124
< 		&.false {
< 			opacity: 0.7;
< 		}
< 	}
---
>     &.false {
>       opacity: 0.7;
>     }
>   }
103,106c126,129
< 	> .string {
< 		display: inline;
< 		color: var(--codeString);
< 	}
---
>   > .string {
>     display: inline;
>     color: var(--codeString);
>   }
108,111c131,134
< 	> .number {
< 		display: inline;
< 		color: var(--codeNumber);
< 	}
---
>   > .number {
>     display: inline;
>     color: var(--codeNumber);
>   }
113,116c136,139
< 	> .array.empty {
< 		display: inline;
< 		opacity: 0.7;
< 	}
---
>   > .array.empty {
>     display: inline;
>     opacity: 0.7;
>   }
118,119c141,142
< 	> .array:not(.empty) {
< 		display: inline;
---
>   > .array:not(.empty) {
>     display: inline;
121,125c144,148
< 		> .element {
< 			display: block;
< 			padding-left: 16px;
< 		}
< 	}
---
>     > .element {
>       display: block;
>       padding-left: 16px;
>     }
>   }
127,130c150,153
< 	> .object.empty {
< 		display: inline;
< 		opacity: 0.7;
< 	}
---
>   > .object.empty {
>     display: inline;
>     opacity: 0.7;
>   }
132,133c155,156
< 	> .object:not(.empty) {
< 		display: inline;
---
>   > .object:not(.empty) {
>     display: inline;
135,137c158,160
< 		> .kv {
< 			display: block;
< 			padding-left: 16px;
---
>     > .kv {
>       display: block;
>       padding-left: 16px;
139,142c162,165
< 			> .toggle {
< 				width: 16px;
< 				color: var(--accent);
< 				visibility: hidden;
---
>       > .toggle {
>         width: 16px;
>         color: var(--accent);
>         visibility: hidden;
144,147c167,170
< 				&.visible {
< 					visibility: visible;
< 				}
< 			}
---
>         &.visible {
>           visibility: visible;
>         }
>       }
149,152c172,175
< 			> .k {
< 				display: inline;
< 				margin-right: 8px;
< 			}
---
>       > .k {
>         display: inline;
>         margin-right: 8px;
>       }
154,158c177,181
< 			> .v {
< 				display: inline;
< 			}
< 		}
< 	}
---
>       > .v {
>         display: inline;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkObjectView.vue RiricaV13/components/MkObjectView.vue
2,4c2,4
< <div class="zhyxdalp">
< 	<XValue :value="value" :collapsed="false"/>
< </div>
---
>   <div class="zhyxdalp">
>     <XValue :value="value" :collapsed="false" />
>   </div>
8,9c8,9
< import { } from 'vue';
< import XValue from './MkObjectView.value.vue';
---
> import {} from "vue";
> import XValue from "./MkObjectView.value.vue";
12c12
< 	value: Record<string, unknown>;
---
>   value: Record<string, unknown>;
18d17
< 
Only in misskeyV13/packages/frontend/src/components: MkOmit.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPagePreview.vue RiricaV13/components/MkPagePreview.vue
2,14c2,28
< <MkA :to="`/@${page.user.username}/pages/${page.name}`" class="vhpxefrj" tabindex="-1">
< 	<div v-if="page.eyeCatchingImage" class="thumbnail" :style="`background-image: url('${page.eyeCatchingImage.thumbnailUrl}')`"></div>
< 	<article>
< 		<header>
< 			<h1 :title="page.title">{{ page.title }}</h1>
< 		</header>
< 		<p v-if="page.summary" :title="page.summary">{{ page.summary.length > 85 ? page.summary.slice(0, 85) + '…' : page.summary }}</p>
< 		<footer>
< 			<img class="icon" :src="page.user.avatarUrl"/>
< 			<p>{{ userName(page.user) }}</p>
< 		</footer>
< 	</article>
< </MkA>
---
>   <MkA
>     :to="`/@${page.user.username}/pages/${page.name}`"
>     class="vhpxefrj _block"
>     tabindex="-1"
>   >
>     <div
>       v-if="page.eyeCatchingImage"
>       class="thumbnail"
>       :style="`background-image: url('${page.eyeCatchingImage.thumbnailUrl}')`"
>     ></div>
>     <article>
>       <header>
>         <h1 :title="page.title">{{ page.title }}</h1>
>       </header>
>       <p v-if="page.summary" :title="page.summary">
>         {{
>           page.summary.length > 85
>             ? page.summary.slice(0, 85) + "…"
>             : page.summary
>         }}
>       </p>
>       <footer>
>         <img class="icon" :src="page.user.avatarUrl" />
>         <p>{{ userName(page.user) }}</p>
>       </footer>
>     </article>
>   </MkA>
17,21c31,34
< <script lang="ts" setup>
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import { userName } from '@/filters/user';
< import * as os from '@/os';
---
> <script lang="ts">
> import { defineComponent } from "vue";
> import { userName } from "@/filters/user";
> import * as os from "@/os";
23,25c36,46
< const props = defineProps<{
< 	page: misskey.entities.Page;
< }>();
---
> export default defineComponent({
>   props: {
>     page: {
>       type: Object,
>       required: true,
>     },
>   },
>   methods: {
>     userName,
>   },
> });
30c51
< 	display: block;
---
>   display: block;
32,35c53,56
< 	&:hover {
< 		text-decoration: none;
< 		color: var(--accent);
< 	}
---
>   &:hover {
>     text-decoration: none;
>     color: var(--accent);
>   }
37,44c58,65
< 	> .thumbnail {
< 		width: 100%;
< 		height: 200px;
< 		background-position: center;
< 		background-size: cover;
< 		display: flex;
< 		justify-content: center;
< 		align-items: center;
---
>   > .thumbnail {
>     width: 100%;
>     height: 200px;
>     background-position: center;
>     background-size: cover;
>     display: flex;
>     justify-content: center;
>     align-items: center;
46,48c67,69
< 		> button {
< 			font-size: 3.5em;
< 			opacity: 0.7;
---
>     > button {
>       font-size: 3.5em;
>       opacity: 0.7;
50,54c71,75
< 			&:hover {
< 				font-size: 4em;
< 				opacity: 0.9;
< 			}
< 		}
---
>       &:hover {
>         font-size: 4em;
>         opacity: 0.9;
>       }
>     }
56,60c77,81
< 		& + article {
< 			left: 100px;
< 			width: calc(100% - 100px);
< 		}
< 	}
---
>     & + article {
>       left: 100px;
>       width: calc(100% - 100px);
>     }
>   }
62,63c83,84
< 	> article {
< 		padding: 16px;
---
>   > article {
>     padding: 16px;
65,66c86,87
< 		> header {
< 			margin-bottom: 8px;
---
>     > header {
>       margin-bottom: 8px;
68,73c89,94
< 			> h1 {
< 				margin: 0;
< 				font-size: 1em;
< 				color: var(--urlPreviewTitle);
< 			}
< 		}
---
>       > h1 {
>         margin: 0;
>         font-size: 1em;
>         color: var(--urlPreviewTitle);
>       }
>     }
75,79c96,100
< 		> p {
< 			margin: 0;
< 			color: var(--urlPreviewText);
< 			font-size: 0.8em;
< 		}
---
>     > p {
>       margin: 0;
>       color: var(--urlPreviewText);
>       font-size: 0.8em;
>     }
81,83c102,104
< 		> footer {
< 			margin-top: 8px;
< 			height: 16px;
---
>     > footer {
>       margin-top: 8px;
>       height: 16px;
85,91c106,112
< 			> img {
< 				display: inline-block;
< 				width: 16px;
< 				height: 16px;
< 				margin-right: 4px;
< 				vertical-align: top;
< 			}
---
>       > img {
>         display: inline-block;
>         width: 16px;
>         height: 16px;
>         margin-right: 4px;
>         vertical-align: top;
>       }
93,102c114,123
< 			> p {
< 				display: inline-block;
< 				margin: 0;
< 				color: var(--urlPreviewInfo);
< 				font-size: 0.8em;
< 				line-height: 16px;
< 				vertical-align: top;
< 			}
< 		}
< 	}
---
>       > p {
>         display: inline-block;
>         margin: 0;
>         color: var(--urlPreviewInfo);
>         font-size: 0.8em;
>         line-height: 16px;
>         vertical-align: top;
>       }
>     }
>   }
104,108c125,129
< 	@media (max-width: 700px) {
< 		> .thumbnail {
< 			position: relative;
< 			width: 100%;
< 			height: 100px;
---
>   @media (max-width: 700px) {
>     > .thumbnail {
>       position: relative;
>       width: 100%;
>       height: 100px;
110,115c131,136
< 			& + article {
< 				left: 0;
< 				width: 100%;
< 			}
< 		}
< 	}
---
>       & + article {
>         left: 0;
>         width: 100%;
>       }
>     }
>   }
117,118c138,139
< 	@media (max-width: 550px) {
< 		font-size: 12px;
---
>   @media (max-width: 550px) {
>     font-size: 12px;
120,122c141,143
< 		> .thumbnail {
< 			height: 80px;
< 		}
---
>     > .thumbnail {
>       height: 80px;
>     }
124,127c145,148
< 		> article {
< 			padding: 12px;
< 		}
< 	}
---
>     > article {
>       padding: 12px;
>     }
>   }
129,130c150,151
< 	@media (max-width: 500px) {
< 		font-size: 10px;
---
>   @media (max-width: 500px) {
>     font-size: 10px;
132,134c153,155
< 		> .thumbnail {
< 			height: 70px;
< 		}
---
>     > .thumbnail {
>       height: 70px;
>     }
136,137c157,158
< 		> article {
< 			padding: 8px;
---
>     > article {
>       padding: 8px;
139,141c160,162
< 			> header {
< 				margin-bottom: 4px;
< 			}
---
>       > header {
>         margin-bottom: 4px;
>       }
143,144c164,165
< 			> footer {
< 				margin-top: 4px;
---
>       > footer {
>         margin-top: 4px;
146,152c167,173
< 				> img {
< 					width: 12px;
< 					height: 12px;
< 				}
< 			}
< 		}
< 	}
---
>         > img {
>           width: 12px;
>           height: 12px;
>         }
>       }
>     }
>   }
154d174
< 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPageWindow.vue RiricaV13/components/MkPageWindow.vue
2,18c2,23
< <MkWindow
< 	ref="windowEl"
< 	:initial-width="500"
< 	:initial-height="500"
< 	:can-resize="true"
< 	:close-button="true"
< 	:buttons-left="buttonsLeft"
< 	:buttons-right="buttonsRight"
< 	:contextmenu="contextmenu"
< 	@closed="$emit('closed')"
< >
< 	<template #header>
< 		<template v-if="pageMetadata?.value">
< 			<i v-if="pageMetadata.value.icon" class="icon" :class="pageMetadata.value.icon" style="margin-right: 0.5em;"></i>
< 			<span>{{ pageMetadata.value.title }}</span>
< 		</template>
< 	</template>
---
>   <XWindow
>     ref="windowEl"
>     :initial-width="500"
>     :initial-height="500"
>     :can-resize="true"
>     :close-button="true"
>     :buttons-left="buttonsLeft"
>     :buttons-right="buttonsRight"
>     :contextmenu="contextmenu"
>     @closed="$emit('closed')"
>   >
>     <template #header>
>       <template v-if="pageMetadata?.value">
>         <i
>           v-if="pageMetadata.value.icon"
>           class="icon"
>           :class="pageMetadata.value.icon"
>           style="margin-right: 0.5em"
>         ></i>
>         <span>{{ pageMetadata.value.title }}</span>
>       </template>
>     </template>
20,23c25,28
< 	<div :class="$style.root" :style="{ background: pageMetadata?.value?.bg }" style="container-type: inline-size;">
< 		<RouterView :router="router"/>
< 	</div>
< </MkWindow>
---
>     <div class="yrolvcoq" :style="{ background: pageMetadata?.value?.bg }">
>       <RouterView :router="router" />
>     </div>
>   </XWindow>
27,39c32,46
< import { ComputedRef, inject, onMounted, onUnmounted, provide } from 'vue';
< import RouterView from '@/components/global/RouterView.vue';
< import MkWindow from '@/components/MkWindow.vue';
< import { popout as _popout } from '@/scripts/popout';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { url } from '@/config';
< import * as os from '@/os';
< import { mainRouter, routes } from '@/router';
< import { Router } from '@/nirax';
< import { i18n } from '@/i18n';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import { openingWindowsCount } from '@/os';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { ComputedRef, inject, provide } from "vue";
> import RouterView from "@/components/global/RouterView.vue";
> import XWindow from "@/components/MkWindow.vue";
> import { popout as _popout } from "@/scripts/popout";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { url } from "@/config";
> import * as os from "@/os";
> import { mainRouter, routes } from "@/router";
> import { Router } from "@/nirax";
> import { i18n } from "@/i18n";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
42c49
< 	initialPath: string;
---
>   initialPath: string;
46c53
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
52,56c59,65
< let windowEl = $shallowRef<InstanceType<typeof MkWindow>>();
< const history = $ref<{ path: string; key: any; }[]>([{
< 	path: router.getCurrentPath(),
< 	key: router.getCurrentKey(),
< }]);
---
> let windowEl = $ref<InstanceType<typeof XWindow>>();
> const history = $ref<{ path: string; key: any }[]>([
>   {
>     path: router.getCurrentPath(),
>     key: router.getCurrentKey(),
>   },
> ]);
58c67
< 	const buttons = [];
---
>   const buttons = [];
60,65c69,74
< 	if (history.length > 1) {
< 		buttons.push({
< 			icon: 'ti ti-arrow-left',
< 			onClick: back,
< 		});
< 	}
---
>   if (history.length > 1) {
>     buttons.push({
>       icon: "fas fa-arrow-left",
>       onClick: back,
>     });
>   }
67c76
< 	return buttons;
---
>   return buttons;
70,74c79,85
< 	const buttons = [{
< 		icon: 'ti ti-player-eject',
< 		title: i18n.ts.showInPage,
< 		onClick: expand,
< 	}];
---
>   const buttons = [
>     {
>       icon: "fas fa-expand-alt",
>       title: i18n.ts.showInPage,
>       onClick: expand,
>     },
>   ];
76c87
< 	return buttons;
---
>   return buttons;
79,80c90,91
< router.addListener('push', ctx => {
< 	history.push({ path: ctx.path, key: ctx.key });
---
> router.addListener("push", (ctx) => {
>   history.push({ path: ctx.path, key: ctx.key });
83c94
< provide('router', router);
---
> provide("router", router);
85c96
< 	pageMetadata = info;
---
>   pageMetadata = info;
87,89c98,99
< provide('shouldOmitHeaderTitle', true);
< provide('shouldHeaderThin', true);
< provide('forceSpacerMin', true);
---
> provide("shouldOmitHeaderTitle", true);
> provide("shouldHeaderThin", true);
91,112c101,127
< const contextmenu = $computed(() => ([{
< 	icon: 'ti ti-player-eject',
< 	text: i18n.ts.showInPage,
< 	action: expand,
< }, {
< 	icon: 'ti ti-window-maximize',
< 	text: i18n.ts.popout,
< 	action: popout,
< }, {
< 	icon: 'ti ti-external-link',
< 	text: i18n.ts.openInNewTab,
< 	action: () => {
< 		window.open(url + router.getCurrentPath(), '_blank');
< 		windowEl.close();
< 	},
< }, {
< 	icon: 'ti ti-link',
< 	text: i18n.ts.copyLink,
< 	action: () => {
< 		copyToClipboard(url + router.getCurrentPath());
< 	},
< }]));
---
> const contextmenu = $computed(() => [
>   {
>     icon: "fas fa-expand-alt",
>     text: i18n.ts.showInPage,
>     action: expand,
>   },
>   {
>     icon: "fas fa-external-link-alt",
>     text: i18n.ts.popout,
>     action: popout,
>   },
>   {
>     icon: "fas fa-external-link-alt",
>     text: i18n.ts.openInNewTab,
>     action: () => {
>       window.open(url + router.getCurrentPath(), "_blank");
>       windowEl.close();
>     },
>   },
>   {
>     icon: "fas fa-link",
>     text: i18n.ts.copyLink,
>     action: () => {
>       copyToClipboard(url + router.getCurrentPath());
>     },
>   },
> ]);
113a129,132
> function menu(ev) {
>   os.popupMenu(contextmenu, ev.currentTarget ?? ev.target);
> }
> 
115,116c134,138
< 	history.pop();
< 	router.replace(history[history.length - 1].path, history[history.length - 1].key);
---
>   history.pop();
>   router.replace(
>     history[history.length - 1].path,
>     history[history.length - 1].key
>   );
120c142
< 	windowEl.close();
---
>   windowEl.close();
124,125c146,147
< 	mainRouter.push(router.getCurrentPath(), 'forcePage');
< 	windowEl.close();
---
>   mainRouter.push(router.getCurrentPath(), "forcePage");
>   windowEl.close();
129,130c151,152
< 	_popout(router.getCurrentPath(), windowEl.$el);
< 	windowEl.close();
---
>   _popout(router.getCurrentPath(), windowEl.$el);
>   windowEl.close();
133,143d154
< onMounted(() => {
< 	openingWindowsCount.value++;
< 	if (openingWindowsCount.value >= 3) {
< 		claimAchievement('open3windows');
< 	}
< });
< 
< onUnmounted(() => {
< 	openingWindowsCount.value--;
< });
< 
145c156
< 	close,
---
>   close,
149,154c160,163
< <style lang="scss" module>
< .root {
< 	min-height: 100%;
< 	background: var(--bg);
< 
< 	--margin: var(--marginHalf);
---
> <style lang="scss" scoped>
> .yrolvcoq {
>   min-height: 100%;
>   background: var(--bg);
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPagination.vue RiricaV13/components/MkPagination.vue
2,9c2,3
< <Transition
< 	:enter-active-class="$store.state.animation ? $style.transition_fade_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_fade_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_fade_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_fade_leaveTo : ''"
< 	mode="out-in"
< >
< 	<MkLoading v-if="fetching"/>
---
>   <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>     <MkLoading v-if="fetching" />
11c5
< 	<MkError v-else-if="error" @retry="init()"/>
---
>     <MkError v-else-if="error" @retry="init()" />
13,20c7,14
< 	<div v-else-if="empty" key="_empty_" class="empty">
< 		<slot name="empty">
< 			<div class="_fullinfo">
< 				<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 				<div>{{ i18n.ts.nothing }}</div>
< 			</div>
< 		</slot>
< 	</div>
---
>     <div v-else-if="empty" key="_empty_" class="empty">
>       <slot name="empty">
>         <div class="_fullinfo">
>           <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>           <div>{{ i18n.ts.nothing }}</div>
>         </div>
>       </slot>
>     </div>
22,37c16,58
< 	<div v-else ref="rootEl">
< 		<div v-show="pagination.reversed && more" key="_more_" class="_margin">
< 			<MkButton v-if="!moreFetching" v-appear="(enableInfiniteScroll && !props.disableAutoLoad) ? fetchMore : null" :class="$style.more" :disabled="moreFetching" :style="{ cursor: moreFetching ? 'wait' : 'pointer' }" primary @click="fetchMore">
< 				{{ i18n.ts.loadMore }}
< 			</MkButton>
< 			<MkLoading v-else class="loading"/>
< 		</div>
< 		<slot :items="items" :fetching="fetching || moreFetching"></slot>
< 		<div v-show="!pagination.reversed && more" key="_more_" class="_margin">
< 			<MkButton v-if="!moreFetching" v-appear="(enableInfiniteScroll && !props.disableAutoLoad) ? fetchMore : null" :class="$style.more" :disabled="moreFetching" :style="{ cursor: moreFetching ? 'wait' : 'pointer' }" primary @click="fetchMore">
< 				{{ i18n.ts.loadMore }}
< 			</MkButton>
< 			<MkLoading v-else class="loading"/>
< 		</div>
< 	</div>
< </Transition>
---
>     <div v-else ref="rootEl">
>       <div
>         v-show="pagination.reversed && more"
>         key="_more_"
>         class="cxiknjgy _gap"
>       >
>         <MkButton
>           v-if="!moreFetching"
>           class="button"
>           :disabled="moreFetching"
>           :style="{ cursor: moreFetching ? 'wait' : 'pointer' }"
>           primary
>           @click="fetchMoreAhead"
>         >
>           {{ i18n.ts.loadMore }}
>         </MkButton>
>         <MkLoading v-else class="loading" />
>       </div>
>       <slot :items="items"></slot>
>       <div
>         v-show="!pagination.reversed && more"
>         key="_more_"
>         class="cxiknjgy _gap"
>       >
>         <MkButton
>           v-if="!moreFetching"
>           v-appear="
>             $store.state.enableInfiniteScroll && !disableAutoLoad
>               ? fetchMore
>               : null
>           "
>           class="button"
>           :disabled="moreFetching"
>           :style="{ cursor: moreFetching ? 'wait' : 'pointer' }"
>           primary
>           @click="fetchMore"
>         >
>           {{ i18n.ts.loadMore }}
>         </MkButton>
>         <MkLoading v-else class="loading" />
>       </div>
>     </div>
>   </transition>
40,48c61,82
< <script lang="ts">
< import { computed, ComputedRef, isRef, nextTick, onActivated, onBeforeUnmount, onDeactivated, onMounted, ref, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import * as os from '@/os';
< import { onScrollTop, isTopVisible, getBodyScrollHeight, getScrollContainer, onScrollBottom, scrollToBottom, scroll, isBottomVisible } from '@/scripts/scroll';
< import MkButton from '@/components/MkButton.vue';
< import { defaultStore } from '@/store';
< import { MisskeyEntity } from '@/types/date-separated-list';
< import { i18n } from '@/i18n';
---
> <script lang="ts" setup>
> import {
>   computed,
>   ComputedRef,
>   isRef,
>   markRaw,
>   onActivated,
>   onDeactivated,
>   Ref,
>   ref,
>   watch,
> } from "vue";
> import * as misskey from "misskey-js";
> import * as os from "@/os";
> import {
>   onScrollTop,
>   isTopVisible,
>   getScrollPosition,
>   getScrollContainer,
> } from "@/scripts/scroll";
> import MkButton from "@/components/MkButton.vue";
> import { i18n } from "@/i18n";
51d84
< const TOLERANCE = 16;
53,56c86,93
< export type Paging<E extends keyof misskey.Endpoints = keyof misskey.Endpoints> = {
< 	endpoint: E;
< 	limit: number;
< 	params?: misskey.Endpoints[E]['req'] | ComputedRef<misskey.Endpoints[E]['req']>;
---
> export type Paging<
>   E extends keyof misskey.Endpoints = keyof misskey.Endpoints
> > = {
>   endpoint: E;
>   limit: number;
>   params?:
>     | misskey.Endpoints[E]["req"]
>     | ComputedRef<misskey.Endpoints[E]["req"]>;
58,62c95,99
< 	/**
< 	 * 検索APIのような、ページング不可なエンドポイントを利用する場合
< 	 * (そのようなAPIをこの関数で使うのは若干矛盾してるけど)
< 	 */
< 	noPaging?: boolean;
---
>   /**
>    * 検索APIのような、ページング不可なエンドポイントを利用する場合
>    * (そのようなAPIをこの関数で使うのは若干矛盾してるけど)
>    */
>   noPaging?: boolean;
64,67c101,104
< 	/**
< 	 * items 配列の中身を逆順にする(新しい方が最後)
< 	 */
< 	reversed?: boolean;
---
>   /**
>    * items 配列の中身を逆順にする(新しい方が最後)
>    */
>   reversed?: boolean;
69,71c106
< 	offsetMode?: boolean;
< 
< 	pageEl?: HTMLElement;
---
>   offsetMode?: boolean;
73,81d107
< </script>
< <script lang="ts" setup>
< const props = withDefaults(defineProps<{
< 	pagination: Paging;
< 	disableAutoLoad?: boolean;
< 	displayLimit?: number;
< }>(), {
< 	displayLimit: 20,
< });
82a109,119
> const props = withDefaults(
>   defineProps<{
>     pagination: Paging;
>     disableAutoLoad?: boolean;
>     displayLimit?: number;
>   }>(),
>   {
>     displayLimit: 30,
>   }
> );
> 
84c121
< 	(ev: 'queue', count: number): void;
---
>   (ev: "queue", count: number): void;
87c124
< let rootEl = $shallowRef<HTMLElement>();
---
> type Item = { id: string; [another: string]: unknown };
89,95c126,128
< // 遡り中かどうか
< let backed = $ref(false);
< 
< let scrollRemove = $ref<(() => void) | null>(null);
< 
< const items = ref<MisskeyEntity[]>([]);
< const queue = ref<MisskeyEntity[]>([]);
---
> const rootEl = ref<HTMLElement>();
> const items = ref<Item[]>([]);
> const queue = ref<Item[]>([]);
99a133
> const backed = ref(false); // 遡り中か否か
103,105d136
< const {
< 	enableInfiniteScroll,
< } = defaultStore.reactiveState;
107,108c138,183
< const contentEl = $computed(() => props.pagination.pageEl || rootEl);
< const scrollableElement = $computed(() => getScrollContainer(contentEl));
---
> const init = async (): Promise<void> => {
>   queue.value = [];
>   fetching.value = true;
>   const params = props.pagination.params
>     ? isRef(props.pagination.params)
>       ? props.pagination.params.value
>       : props.pagination.params
>     : {};
>   await os
>     .api(props.pagination.endpoint, {
>       ...params,
>       limit: props.pagination.noPaging
>         ? props.pagination.limit || 10
>         : (props.pagination.limit || 10) + 1,
>     })
>     .then(
>       (res) => {
>         for (let i = 0; i < res.length; i++) {
>           const item = res[i];
>           if (props.pagination.reversed) {
>             if (i === res.length - 2) item._shouldInsertAd_ = true;
>           } else {
>             if (i === 3) item._shouldInsertAd_ = true;
>           }
>         }
>         if (
>           !props.pagination.noPaging &&
>           res.length > (props.pagination.limit || 10)
>         ) {
>           res.pop();
>           items.value = props.pagination.reversed ? [...res].reverse() : res;
>           more.value = true;
>         } else {
>           items.value = props.pagination.reversed ? [...res].reverse() : res;
>           more.value = false;
>         }
>         offset.value = res.length;
>         error.value = false;
>         fetching.value = false;
>       },
>       (err) => {
>         error.value = true;
>         fetching.value = false;
>       }
>     );
> };
110,185c185,187
< // 先頭が表示されているかどうかを検出
< // https://qiita.com/mkataigi/items/0154aefd2223ce23398e
< let scrollObserver = $ref<IntersectionObserver>();
< 
< watch([() => props.pagination.reversed, $$(scrollableElement)], () => {
< 	if (scrollObserver) scrollObserver.disconnect();
< 
< 	scrollObserver = new IntersectionObserver(entries => {
< 		backed = entries[0].isIntersecting;
< 	}, {
< 		root: scrollableElement,
< 		rootMargin: props.pagination.reversed ? '-100% 0px 100% 0px' : '100% 0px -100% 0px',
< 		threshold: 0.01,
< 	});
< }, { immediate: true });
< 
< watch($$(rootEl), () => {
< 	scrollObserver.disconnect();
< 	nextTick(() => {
< 		if (rootEl) scrollObserver.observe(rootEl);
< 	});
< });
< 
< watch([$$(backed), $$(contentEl)], () => {
< 	if (!backed) {
< 		if (!contentEl) return;
< 
< 		scrollRemove = (props.pagination.reversed ? onScrollBottom : onScrollTop)(contentEl, executeQueue, TOLERANCE);
< 	} else {
< 		if (scrollRemove) scrollRemove();
< 		scrollRemove = null;
< 	}
< });
< 
< if (props.pagination.params && isRef(props.pagination.params)) {
< 	watch(props.pagination.params, init, { deep: true });
< }
< 
< watch(queue, (a, b) => {
< 	if (a.length === 0 && b.length === 0) return;
< 	emit('queue', queue.value.length);
< }, { deep: true });
< 
< async function init(): Promise<void> {
< 	queue.value = [];
< 	fetching.value = true;
< 	const params = props.pagination.params ? isRef(props.pagination.params) ? props.pagination.params.value : props.pagination.params : {};
< 	await os.api(props.pagination.endpoint, {
< 		...params,
< 		limit: props.pagination.noPaging ? (props.pagination.limit || 10) : (props.pagination.limit || 10) + 1,
< 	}).then(res => {
< 		for (let i = 0; i < res.length; i++) {
< 			const item = res[i];
< 			if (i === 3) item._shouldInsertAd_ = true;
< 		}
< 		if (!props.pagination.noPaging && (res.length > (props.pagination.limit || 10))) {
< 			res.pop();
< 			if (props.pagination.reversed) moreFetching.value = true;
< 			items.value = res;
< 			more.value = true;
< 		} else {
< 			items.value = res;
< 			more.value = false;
< 		}
< 		offset.value = res.length;
< 		error.value = false;
< 		fetching.value = false;
< 	}, err => {
< 		error.value = true;
< 		fetching.value = false;
< 	});
< }
< 
< const reload = (): Promise<void> => {
< 	items.value = [];
< 	return init();
---
> const reload = (): void => {
>   items.value = [];
>   init();
189,251c191,249
< 	if (!more.value || fetching.value || moreFetching.value || items.value.length === 0) return;
< 	moreFetching.value = true;
< 	const params = props.pagination.params ? isRef(props.pagination.params) ? props.pagination.params.value : props.pagination.params : {};
< 	await os.api(props.pagination.endpoint, {
< 		...params,
< 		limit: SECOND_FETCH_LIMIT + 1,
< 		...(props.pagination.offsetMode ? {
< 			offset: offset.value,
< 		} : {
< 			untilId: items.value[items.value.length - 1].id,
< 		}),
< 	}).then(res => {
< 		for (let i = 0; i < res.length; i++) {
< 			const item = res[i];
< 			if (i === 10) item._shouldInsertAd_ = true;
< 		}
< 
< 		const reverseConcat = _res => {
< 			const oldHeight = scrollableElement ? scrollableElement.scrollHeight : getBodyScrollHeight();
< 			const oldScroll = scrollableElement ? scrollableElement.scrollTop : window.scrollY;
< 
< 			items.value = items.value.concat(_res);
< 
< 			return nextTick(() => {
< 				if (scrollableElement) {
< 					scroll(scrollableElement, { top: oldScroll + (scrollableElement.scrollHeight - oldHeight), behavior: 'instant' });
< 				} else {
< 					window.scroll({ top: oldScroll + (getBodyScrollHeight() - oldHeight), behavior: 'instant' });
< 				}
< 
< 				return nextTick();
< 			});
< 		};
< 
< 		if (res.length > SECOND_FETCH_LIMIT) {
< 			res.pop();
< 
< 			if (props.pagination.reversed) {
< 				reverseConcat(res).then(() => {
< 					more.value = true;
< 					moreFetching.value = false;
< 				});
< 			} else {
< 				items.value = items.value.concat(res);
< 				more.value = true;
< 				moreFetching.value = false;
< 			}
< 		} else {
< 			if (props.pagination.reversed) {
< 				reverseConcat(res).then(() => {
< 					more.value = false;
< 					moreFetching.value = false;
< 				});
< 			} else {
< 				items.value = items.value.concat(res);
< 				more.value = false;
< 				moreFetching.value = false;
< 			}
< 		}
< 		offset.value += res.length;
< 	}, err => {
< 		moreFetching.value = false;
< 	});
---
>   if (
>     !more.value ||
>     fetching.value ||
>     moreFetching.value ||
>     items.value.length === 0
>   )
>     return;
>   moreFetching.value = true;
>   backed.value = true;
>   const params = props.pagination.params
>     ? isRef(props.pagination.params)
>       ? props.pagination.params.value
>       : props.pagination.params
>     : {};
>   await os
>     .api(props.pagination.endpoint, {
>       ...params,
>       limit: SECOND_FETCH_LIMIT + 1,
>       ...(props.pagination.offsetMode
>         ? {
>             offset: offset.value,
>           }
>         : props.pagination.reversed
>         ? {
>             sinceId: items.value[0].id,
>           }
>         : {
>             untilId: items.value[items.value.length - 1].id,
>           }),
>     })
>     .then(
>       (res) => {
>         for (let i = 0; i < res.length; i++) {
>           const item = res[i];
>           if (props.pagination.reversed) {
>             if (i === res.length - 9) item._shouldInsertAd_ = true;
>           } else {
>             if (i === 10) item._shouldInsertAd_ = true;
>           }
>         }
>         if (res.length > SECOND_FETCH_LIMIT) {
>           res.pop();
>           items.value = props.pagination.reversed
>             ? [...res].reverse().concat(items.value)
>             : items.value.concat(res);
>           more.value = true;
>         } else {
>           items.value = props.pagination.reversed
>             ? [...res].reverse().concat(items.value)
>             : items.value.concat(res);
>           more.value = false;
>         }
>         offset.value += res.length;
>         moreFetching.value = false;
>       },
>       (err) => {
>         moreFetching.value = false;
>       }
>     );
255,279c253,302
< 	if (!more.value || fetching.value || moreFetching.value || items.value.length === 0) return;
< 	moreFetching.value = true;
< 	const params = props.pagination.params ? isRef(props.pagination.params) ? props.pagination.params.value : props.pagination.params : {};
< 	await os.api(props.pagination.endpoint, {
< 		...params,
< 		limit: SECOND_FETCH_LIMIT + 1,
< 		...(props.pagination.offsetMode ? {
< 			offset: offset.value,
< 		} : {
< 			sinceId: items.value[items.value.length - 1].id,
< 		}),
< 	}).then(res => {
< 		if (res.length > SECOND_FETCH_LIMIT) {
< 			res.pop();
< 			items.value = items.value.concat(res);
< 			more.value = true;
< 		} else {
< 			items.value = items.value.concat(res);
< 			more.value = false;
< 		}
< 		offset.value += res.length;
< 		moreFetching.value = false;
< 	}, err => {
< 		moreFetching.value = false;
< 	});
---
>   if (
>     !more.value ||
>     fetching.value ||
>     moreFetching.value ||
>     items.value.length === 0
>   )
>     return;
>   moreFetching.value = true;
>   const params = props.pagination.params
>     ? isRef(props.pagination.params)
>       ? props.pagination.params.value
>       : props.pagination.params
>     : {};
>   await os
>     .api(props.pagination.endpoint, {
>       ...params,
>       limit: SECOND_FETCH_LIMIT + 1,
>       ...(props.pagination.offsetMode
>         ? {
>             offset: offset.value,
>           }
>         : props.pagination.reversed
>         ? {
>             untilId: items.value[0].id,
>           }
>         : {
>             sinceId: items.value[items.value.length - 1].id,
>           }),
>     })
>     .then(
>       (res) => {
>         if (res.length > SECOND_FETCH_LIMIT) {
>           res.pop();
>           items.value = props.pagination.reversed
>             ? [...res].reverse().concat(items.value)
>             : items.value.concat(res);
>           more.value = true;
>         } else {
>           items.value = props.pagination.reversed
>             ? [...res].reverse().concat(items.value)
>             : items.value.concat(res);
>           more.value = false;
>         }
>         offset.value += res.length;
>         moreFetching.value = false;
>       },
>       (err) => {
>         moreFetching.value = false;
>       }
>     );
282,287c305,336
< const prepend = (item: MisskeyEntity): void => {
< 	// 初回表示時はunshiftだけでOK
< 	if (!rootEl) {
< 		items.value.unshift(item);
< 		return;
< 	}
---
> const prepend = (item: Item): void => {
>   if (props.pagination.reversed) {
>     if (rootEl.value) {
>       const container = getScrollContainer(rootEl.value);
>       if (container == null) {
>         // TODO?
>       } else {
>         const pos = getScrollPosition(rootEl.value);
>         const viewHeight = container.clientHeight;
>         const height = container.scrollHeight;
>         const isBottom = pos + viewHeight > height - 32;
>         if (isBottom) {
>           // オーバーフローしたら古いアイテムは捨てる
>           if (items.value.length >= props.displayLimit) {
>             // このやり方だとVue 3.2以降アニメーションが動かなくなる
>             //items.value = items.value.slice(-props.displayLimit);
>             while (items.value.length >= props.displayLimit) {
>               items.value.shift();
>             }
>             more.value = true;
>           }
>         }
>       }
>     }
>     items.value.push(item);
>     // TODO
>   } else {
>     // 初回表示時はunshiftだけでOK
>     if (!rootEl.value) {
>       items.value.unshift(item);
>       return;
>     }
289c338,340
< 	const isTop = isBackTop.value || (props.pagination.reversed ? isBottomVisible : isTopVisible)(contentEl, TOLERANCE);
---
>     const isTop =
>       isBackTop.value ||
>       (document.body.contains(rootEl.value) && isTopVisible(rootEl.value));
291,292c342,364
< 	if (isTop) unshiftItems([item]);
< 	else prependQueue(item);
---
>     if (isTop) {
>       // Prepend the item
>       items.value.unshift(item);
> 
>       // オーバーフローしたら古いアイテムは捨てる
>       if (items.value.length >= props.displayLimit) {
>         // このやり方だとVue 3.2以降アニメーションが動かなくなる
>         //this.items = items.value.slice(0, props.displayLimit);
>         while (items.value.length >= props.displayLimit) {
>           items.value.pop();
>         }
>         more.value = true;
>       }
>     } else {
>       queue.value.push(item);
>       onScrollTop(rootEl.value, () => {
>         for (const item of queue.value) {
>           prepend(item);
>         }
>         queue.value = [];
>       });
>     }
>   }
295,316c367,368
< function unshiftItems(newItems: MisskeyEntity[]) {
< 	const length = newItems.length + items.value.length;
< 	items.value = [...newItems, ...items.value].slice(0, props.displayLimit);
< 
< 	if (length >= props.displayLimit) more.value = true;
< }
< 
< function executeQueue() {
< 	if (queue.value.length === 0) return;
< 	unshiftItems(queue.value);
< 	queue.value = [];
< }
< 
< function prependQueue(newItem: MisskeyEntity) {
< 	queue.value.unshift(newItem);
< 	if (queue.value.length >= props.displayLimit) {
< 		queue.value.pop();
< 	}
< }
< 
< const appendItem = (item: MisskeyEntity): void => {
< 	items.value.push(item);
---
> const append = (item: Item): void => {
>   items.value.push(item);
319,321c371,373
< const removeItem = (finder: (item: MisskeyEntity) => boolean) => {
< 	const i = items.value.findIndex(finder);
< 	items.value.splice(i, 1);
---
> const removeItem = (finder: (item: Item) => boolean) => {
>   const i = items.value.findIndex(finder);
>   items.value.splice(i, 1);
324,326c376,378
< const updateItem = (id: MisskeyEntity['id'], replacer: (old: MisskeyEntity) => MisskeyEntity): void => {
< 	const i = items.value.findIndex(item => item.id === id);
< 	items.value[i] = replacer(items.value[i]);
---
> const updateItem = (id: Item["id"], replacer: (old: Item) => Item): void => {
>   const i = items.value.findIndex((item) => item.id === id);
>   items.value[i] = replacer(items.value[i]);
329c381,383
< const inited = init();
---
> if (props.pagination.params && isRef(props.pagination.params)) {
>   watch(props.pagination.params, init, { deep: true });
> }
330a385,395
> watch(
>   queue,
>   (a, b) => {
>     if (a.length === 0 && b.length === 0) return;
>     emit("queue", queue.value.length);
>   },
>   { deep: true }
> );
> 
> init();
> 
332c397
< 	isBackTop.value = false;
---
>   isBackTop.value = false;
336c401
< 	isBackTop.value = props.pagination.reversed ? window.scrollY >= (rootEl ? rootEl.scrollHeight - window.innerHeight : 0) : window.scrollY === 0;
---
>   isBackTop.value = window.scrollY === 0;
339,362d403
< function toBottom() {
< 	scrollToBottom(contentEl);
< }
< 
< onMounted(() => {
< 	inited.then(() => {
< 		if (props.pagination.reversed) {
< 			nextTick(() => {
< 				setTimeout(toBottom, 800);
< 
< 				// scrollToBottomでmoreFetchingボタンが画面外まで出るまで
< 				// more = trueを遅らせる
< 				setTimeout(() => {
< 					moreFetching.value = false;
< 				}, 2000);
< 			});
< 		}
< 	});
< });
< 
< onBeforeUnmount(() => {
< 	scrollObserver.disconnect();
< });
< 
364,373c405,412
< 	items,
< 	queue,
< 	backed,
< 	more,
< 	inited,
< 	reload,
< 	prepend,
< 	append: appendItem,
< 	removeItem,
< 	updateItem,
---
>   items,
>   queue,
>   backed,
>   reload,
>   prepend,
>   append,
>   removeItem,
>   updateItem,
377,380c416,419
< <style lang="scss" module>
< .transition_fade_enterActive,
< .transition_fade_leaveActive {
< 	transition: opacity 0.125s ease;
---
> <style lang="scss" scoped>
> .fade-enter-active,
> .fade-leave-active {
>   transition: opacity 0.125s ease;
382,384c421,423
< .transition_fade_enterFrom,
< .transition_fade_leaveTo {
< 	opacity: 0;
---
> .fade-enter-from,
> .fade-leave-to {
>   opacity: 0;
387,389c426,430
< .more {
< 	margin-left: auto;
< 	margin-right: auto;
---
> .cxiknjgy {
>   > .button {
>     margin-left: auto;
>     margin-right: auto;
>   }
Only in misskeyV13/packages/frontend/src/components: MkPlusOneEffect.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPoll.vue RiricaV13/components/MkPoll.vue
2,21c2,37
< <div class="tivcixzd" :class="{ done: closed || isVoted }">
< 	<ul>
< 		<li v-for="(choice, i) in note.poll.choices" :key="i" :class="{ voted: choice.voted }" @click="vote(i)">
< 			<div class="backdrop" :style="{ 'width': `${showResult ? (choice.votes / total * 100) : 0}%` }"></div>
< 			<span>
< 				<template v-if="choice.isVoted"><i class="ti ti-check"></i></template>
< 				<Mfm :text="choice.text" :plain="true"/>
< 				<span v-if="showResult" class="votes">({{ $t('_poll.votesCount', { n: choice.votes }) }})</span>
< 			</span>
< 		</li>
< 	</ul>
< 	<p v-if="!readOnly">
< 		<span>{{ $t('_poll.totalVotes', { n: total }) }}</span>
< 		<span> · </span>
< 		<a v-if="!closed && !isVoted" @click="showResult = !showResult">{{ showResult ? i18n.ts._poll.vote : i18n.ts._poll.showResult }}</a>
< 		<span v-if="isVoted">{{ i18n.ts._poll.voted }}</span>
< 		<span v-else-if="closed">{{ i18n.ts._poll.closed }}</span>
< 		<span v-if="remaining > 0"> · {{ timer }}</span>
< 	</p>
< </div>
---
>   <div class="tivcixzd" :class="{ done: closed || isVoted }">
>     <ul>
>       <li
>         v-for="(choice, i) in note.poll.choices"
>         :key="i"
>         :class="{ voted: choice.voted }"
>         @click="vote(i)"
>       >
>         <div
>           class="backdrop"
>           :style="{
>             width: `${showResult ? (choice.votes / total) * 100 : 0}%`,
>           }"
>         ></div>
>         <span>
>           <template v-if="choice.isVoted"
>             ><i class="fas fa-check"></i
>           ></template>
>           <Mfm :text="choice.text" :plain="true" :custom-emojis="note.emojis" />
>           <span v-if="showResult" class="votes"
>             >({{ $t("_poll.votesCount", { n: choice.votes }) }})</span
>           >
>         </span>
>       </li>
>     </ul>
>     <p v-if="!readOnly">
>       <span>{{ $t("_poll.totalVotes", { n: total }) }}</span>
>       <span> · </span>
>       <a v-if="!closed && !isVoted" @click="showResult = !showResult">{{
>         showResult ? i18n.ts._poll.vote : i18n.ts._poll.showResult
>       }}</a>
>       <span v-if="isVoted">{{ i18n.ts._poll.voted }}</span>
>       <span v-else-if="closed">{{ i18n.ts._poll.closed }}</span>
>       <span v-if="remaining > 0"> · {{ timer }}</span>
>     </p>
>   </div>
25,31c41,47
< import { computed, onUnmounted, ref, toRef } from 'vue';
< import * as misskey from 'misskey-js';
< import { sum } from '@/scripts/array';
< import { pleaseLogin } from '@/scripts/please-login';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { useInterval } from '@/scripts/use-interval';
---
> import { computed, onUnmounted, ref, toRef } from "vue";
> import * as misskey from "misskey-js";
> import { sum } from "@/scripts/array";
> import { pleaseLogin } from "@/scripts/please-login";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { useInterval } from "@/scripts/use-interval";
34,35c50,51
< 	note: misskey.entities.Note;
< 	readOnly?: boolean;
---
>   note: misskey.entities.Note;
>   readOnly?: boolean;
40c56
< const total = computed(() => sum(props.note.poll.choices.map(x => x.votes)));
---
> const total = computed(() => sum(props.note.poll.choices.map((x) => x.votes)));
42,51c58,78
< const isVoted = computed(() => !props.note.poll.multiple && props.note.poll.choices.some(c => c.isVoted));
< const timer = computed(() => i18n.t(
< 	remaining.value >= 86400 ? '_poll.remainingDays' :
< 	remaining.value >= 3600 ? '_poll.remainingHours' :
< 	remaining.value >= 60 ? '_poll.remainingMinutes' : '_poll.remainingSeconds', {
< 		s: Math.floor(remaining.value % 60),
< 		m: Math.floor(remaining.value / 60) % 60,
< 		h: Math.floor(remaining.value / 3600) % 24,
< 		d: Math.floor(remaining.value / 86400),
< 	}));
---
> const isVoted = computed(
>   () =>
>     !props.note.poll.multiple && props.note.poll.choices.some((c) => c.isVoted)
> );
> const timer = computed(() =>
>   i18n.t(
>     remaining.value >= 86400
>       ? "_poll.remainingDays"
>       : remaining.value >= 3600
>       ? "_poll.remainingHours"
>       : remaining.value >= 60
>       ? "_poll.remainingMinutes"
>       : "_poll.remainingSeconds",
>     {
>       s: Math.floor(remaining.value % 60),
>       m: Math.floor(remaining.value / 60) % 60,
>       h: Math.floor(remaining.value / 3600) % 24,
>       d: Math.floor(remaining.value / 86400),
>     }
>   )
> );
57,62c84,92
< 	const tick = () => {
< 		remaining.value = Math.floor(Math.max(new Date(props.note.poll.expiresAt).getTime() - Date.now(), 0) / 1000);
< 		if (remaining.value === 0) {
< 			showResult.value = true;
< 		}
< 	};
---
>   const tick = () => {
>     remaining.value = Math.floor(
>       Math.max(new Date(props.note.poll.expiresAt).getTime() - Date.now(), 0) /
>         1000
>     );
>     if (remaining.value === 0) {
>       showResult.value = true;
>     }
>   };
64,67c94,97
< 	useInterval(tick, 3000, {
< 		immediate: true,
< 		afterMounted: false,
< 	});
---
>   useInterval(tick, 3000, {
>     immediate: true,
>     afterMounted: false,
>   });
71c101
< 	pleaseLogin();
---
>   pleaseLogin();
73c103
< 	if (props.readOnly || closed.value || isVoted.value) return;
---
>   if (props.readOnly || closed.value || isVoted.value) return;
75,79c105,109
< 	const { canceled } = await os.confirm({
< 		type: 'question',
< 		text: i18n.t('voteConfirm', { choice: props.note.poll.choices[id].text }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "question",
>     text: i18n.t("voteConfirm", { choice: props.note.poll.choices[id].text }),
>   });
>   if (canceled) return;
81,85c111,115
< 	await os.api('notes/polls/vote', {
< 		noteId: props.note.id,
< 		choice: id,
< 	});
< 	if (!showResult.value) showResult.value = !props.note.poll.multiple;
---
>   await os.api("notes/polls/vote", {
>     noteId: props.note.id,
>     choice: id,
>   });
>   if (!showResult.value) showResult.value = !props.note.poll.multiple;
91,95c121,125
< 	> ul {
< 		display: block;
< 		margin: 0;
< 		padding: 0;
< 		list-style: none;
---
>   > ul {
>     display: block;
>     margin: 0;
>     padding: 0;
>     list-style: none;
97,106c127,136
< 		> li {
< 			display: block;
< 			position: relative;
< 			margin: 4px 0;
< 			padding: 4px;
< 			//border: solid 0.5px var(--divider);
< 			background: var(--accentedBg);
< 			border-radius: 4px;
< 			overflow: clip;
< 			cursor: pointer;
---
>     > li {
>       display: block;
>       position: relative;
>       margin: 4px 0;
>       padding: 4px;
>       //border: solid 0.5px var(--divider);
>       background: var(--accentedBg);
>       border-radius: 4px;
>       overflow: hidden;
>       cursor: pointer;
108,116c138,150
< 			> .backdrop {
< 				position: absolute;
< 				top: 0;
< 				left: 0;
< 				height: 100%;
< 				background: var(--accent);
< 				background: linear-gradient(90deg,var(--buttonGradateA),var(--buttonGradateB));
< 				transition: width 1s ease;
< 			}
---
>       > .backdrop {
>         position: absolute;
>         top: 0;
>         left: 0;
>         height: 100%;
>         background: var(--accent);
>         background: linear-gradient(
>           90deg,
>           var(--buttonGradateA),
>           var(--buttonGradateB)
>         );
>         transition: width 1s ease;
>       }
118,123c152,157
< 			> span {
< 				position: relative;
< 				display: inline-block;
< 				padding: 3px 5px;
< 				background: var(--panel);
< 				border-radius: 3px;
---
>       > span {
>         position: relative;
>         display: inline-block;
>         padding: 3px 5px;
>         background: var(--panel);
>         border-radius: 3px;
125,128c159,162
< 				> i {
< 					margin-right: 4px;
< 					color: var(--accent);
< 				}
---
>         > i {
>           margin-right: 4px;
>           color: var(--accent);
>         }
130,136c164,170
< 				> .votes {
< 					margin-left: 4px;
< 					opacity: 0.7;
< 				}
< 			}
< 		}
< 	}
---
>         > .votes {
>           margin-left: 4px;
>           opacity: 0.7;
>         }
>       }
>     }
>   }
138,139c172,173
< 	> p {
< 		color: var(--fg);
---
>   > p {
>     color: var(--fg);
141,144c175,178
< 		a {
< 			color: inherit;
< 		}
< 	}
---
>     a {
>       color: inherit;
>     }
>   }
146,150c180,184
< 	&.done {
< 		> ul > li {
< 			cursor: default;
< 		}
< 	}
---
>   &.done {
>     > ul > li {
>       cursor: default;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPollEditor.vue RiricaV13/components/MkPollEditor.vue
2,47c2,56
< <div class="zmdxowus">
< 	<p v-if="choices.length < 2" class="caution">
< 		<i class="ti ti-alert-triangle"></i>{{ i18n.ts._poll.noOnlyOneChoice }}
< 	</p>
< 	<ul>
< 		<li v-for="(choice, i) in choices" :key="i">
< 			<MkInput class="input" small :model-value="choice" :placeholder="$t('_poll.choiceN', { n: i + 1 })" @update:model-value="onInput(i, $event)">
< 			</MkInput>
< 			<button class="_button" @click="remove(i)">
< 				<i class="ti ti-x"></i>
< 			</button>
< 		</li>
< 	</ul>
< 	<MkButton v-if="choices.length < 10" class="add" @click="add">{{ i18n.ts.add }}</MkButton>
< 	<MkButton v-else class="add" disabled>{{ i18n.ts._poll.noMore }}</MkButton>
< 	<MkSwitch v-model="multiple">{{ i18n.ts._poll.canMultipleVote }}</MkSwitch>
< 	<section>
< 		<div>
< 			<MkSelect v-model="expiration" small>
< 				<template #label>{{ i18n.ts._poll.expiration }}</template>
< 				<option value="infinite">{{ i18n.ts._poll.infinite }}</option>
< 				<option value="at">{{ i18n.ts._poll.at }}</option>
< 				<option value="after">{{ i18n.ts._poll.after }}</option>
< 			</MkSelect>
< 			<section v-if="expiration === 'at'">
< 				<MkInput v-model="atDate" small type="date" class="input">
< 					<template #label>{{ i18n.ts._poll.deadlineDate }}</template>
< 				</MkInput>
< 				<MkInput v-model="atTime" small type="time" class="input">
< 					<template #label>{{ i18n.ts._poll.deadlineTime }}</template>
< 				</MkInput>
< 			</section>
< 			<section v-else-if="expiration === 'after'">
< 				<MkInput v-model="after" small type="number" class="input">
< 					<template #label>{{ i18n.ts._poll.duration }}</template>
< 				</MkInput>
< 				<MkSelect v-model="unit" small>
< 					<option value="second">{{ i18n.ts._time.second }}</option>
< 					<option value="minute">{{ i18n.ts._time.minute }}</option>
< 					<option value="hour">{{ i18n.ts._time.hour }}</option>
< 					<option value="day">{{ i18n.ts._time.day }}</option>
< 				</MkSelect>
< 			</section>
< 		</div>
< 	</section>
< </div>
---
>   <div class="zmdxowus">
>     <p v-if="choices.length < 2" class="caution">
>       <i class="fas fa-exclamation-triangle"></i
>       >{{ i18n.ts._poll.noOnlyOneChoice }}
>     </p>
>     <ul>
>       <li v-for="(choice, i) in choices" :key="i">
>         <MkInput
>           class="input"
>           small
>           :model-value="choice"
>           :placeholder="$t('_poll.choiceN', { n: i + 1 })"
>           @update:modelValue="onInput(i, $event)"
>         >
>         </MkInput>
>         <button class="_button" @click="remove(i)">
>           <i class="fas fa-times"></i>
>         </button>
>       </li>
>     </ul>
>     <MkButton v-if="choices.length < 10" class="add" @click="add">{{
>       i18n.ts.add
>     }}</MkButton>
>     <MkButton v-else class="add" disabled>{{ i18n.ts._poll.noMore }}</MkButton>
>     <MkSwitch v-model="multiple">{{ i18n.ts._poll.canMultipleVote }}</MkSwitch>
>     <section>
>       <div>
>         <MkSelect v-model="expiration" small>
>           <template #label>{{ i18n.ts._poll.expiration }}</template>
>           <option value="infinite">{{ i18n.ts._poll.infinite }}</option>
>           <option value="at">{{ i18n.ts._poll.at }}</option>
>           <option value="after">{{ i18n.ts._poll.after }}</option>
>         </MkSelect>
>         <section v-if="expiration === 'at'">
>           <MkInput v-model="atDate" small type="date" class="input">
>             <template #label>{{ i18n.ts._poll.deadlineDate }}</template>
>           </MkInput>
>           <MkInput v-model="atTime" small type="time" class="input">
>             <template #label>{{ i18n.ts._poll.deadlineTime }}</template>
>           </MkInput>
>         </section>
>         <section v-else-if="expiration === 'after'">
>           <MkInput v-model="after" small type="number" class="input">
>             <template #label>{{ i18n.ts._poll.duration }}</template>
>           </MkInput>
>           <MkSelect v-model="unit" small>
>             <option value="second">{{ i18n.ts._time.second }}</option>
>             <option value="minute">{{ i18n.ts._time.minute }}</option>
>             <option value="hour">{{ i18n.ts._time.hour }}</option>
>             <option value="day">{{ i18n.ts._time.day }}</option>
>           </MkSelect>
>         </section>
>       </div>
>     </section>
>   </div>
51,58c60,67
< import { ref, watch } from 'vue';
< import MkInput from './MkInput.vue';
< import MkSelect from './MkSelect.vue';
< import MkSwitch from './MkSwitch.vue';
< import MkButton from './MkButton.vue';
< import { formatDateTimeString } from '@/scripts/format-time-string';
< import { addTime } from '@/scripts/time';
< import { i18n } from '@/i18n';
---
> import { ref, watch } from "vue";
> import MkInput from "./form/input.vue";
> import MkSelect from "./form/select.vue";
> import MkSwitch from "./form/switch.vue";
> import MkButton from "./MkButton.vue";
> import { formatDateTimeString } from "@/scripts/format-time-string";
> import { addTime } from "@/scripts/time";
> import { i18n } from "@/i18n";
61,66c70,75
< 	modelValue: {
< 		expiresAt: string;
< 		expiredAfter: number;
< 		choices: string[];
< 		multiple: boolean;
< 	};
---
>   modelValue: {
>     expiresAt: string;
>     expiredAfter: number;
>     choices: string[];
>     multiple: boolean;
>   };
69,74c78,86
< 	(ev: 'update:modelValue', v: {
< 		expiresAt: string;
< 		expiredAfter: number;
< 		choices: string[];
< 		multiple: boolean;
< 	}): void;
---
>   (
>     ev: "update:modelValue",
>     v: {
>       expiresAt: string;
>       expiredAfter: number;
>       choices: string[];
>       multiple: boolean;
>     }
>   ): void;
79,81c91,95
< const expiration = ref('infinite');
< const atDate = ref(formatDateTimeString(addTime(new Date(), 1, 'day'), 'yyyy-MM-dd'));
< const atTime = ref('00:00');
---
> const expiration = ref("infinite");
> const atDate = ref(
>   formatDateTimeString(addTime(new Date(), 1, "day"), "yyyy-MM-dd")
> );
> const atTime = ref("00:00");
83c97
< const unit = ref('second');
---
> const unit = ref("second");
86,90c100,104
< 	expiration.value = 'at';
< 	atDate.value = atTime.value = props.modelValue.expiresAt;
< } else if (typeof props.modelValue.expiredAfter === 'number') {
< 	expiration.value = 'after';
< 	after.value = props.modelValue.expiredAfter / 1000;
---
>   expiration.value = "at";
>   atDate.value = atTime.value = props.modelValue.expiresAt;
> } else if (typeof props.modelValue.expiredAfter === "number") {
>   expiration.value = "after";
>   after.value = props.modelValue.expiredAfter / 1000;
92c106
< 	expiration.value = 'infinite';
---
>   expiration.value = "infinite";
96c110
< 	choices.value[i] = value;
---
>   choices.value[i] = value;
100,104c114,118
< 	choices.value.push('');
< 	// TODO
< 	// nextTick(() => {
< 	//   (this.$refs.choices as any).childNodes[this.choices.length - 1].childNodes[0].focus();
< 	// });
---
>   choices.value.push("");
>   // TODO
>   // nextTick(() => {
>   //   (this.$refs.choices as any).childNodes[this.choices.length - 1].childNodes[0].focus();
>   // });
108c122
< 	choices.value = choices.value.filter((_, _i) => _i !== i);
---
>   choices.value = choices.value.filter((_, _i) => _i !== i);
112,114c126,128
< 	const calcAt = () => {
< 		return new Date(`${atDate.value} ${atTime.value}`).getTime();
< 	};
---
>   const calcAt = () => {
>     return new Date(`${atDate.value} ${atTime.value}`).getTime();
>   };
116,128c130,147
< 	const calcAfter = () => {
< 		let base = parseInt(after.value);
< 		switch (unit.value) {
< 			case 'day': base *= 24;
< 				// fallthrough
< 			case 'hour': base *= 60;
< 				// fallthrough
< 			case 'minute': base *= 60;
< 				// fallthrough
< 			case 'second': return base *= 1000;
< 			default: return null;
< 		}
< 	};
---
>   const calcAfter = () => {
>     let base = parseInt(after.value);
>     switch (unit.value) {
>       case "day":
>         base *= 24;
>       // fallthrough
>       case "hour":
>         base *= 60;
>       // fallthrough
>       case "minute":
>         base *= 60;
>       // fallthrough
>       case "second":
>         return (base *= 1000);
>       default:
>         return null;
>     }
>   };
130,137c149,157
< 	return {
< 		choices: choices.value,
< 		multiple: multiple.value,
< 		...(
< 			expiration.value === 'at' ? { expiresAt: calcAt() } :
< 			expiration.value === 'after' ? { expiredAfter: calcAfter() } : {}
< 		),
< 	};
---
>   return {
>     choices: choices.value,
>     multiple: multiple.value,
>     ...(expiration.value === "at"
>       ? { expiresAt: calcAt() }
>       : expiration.value === "after"
>       ? { expiredAfter: calcAfter() }
>       : {}),
>   };
140,142c160,166
< watch([choices, multiple, expiration, atDate, atTime, after, unit], () => emit('update:modelValue', get()), {
< 	deep: true,
< });
---
> watch(
>   [choices, multiple, expiration, atDate, atTime, after, unit],
>   () => emit("update:modelValue", get()),
>   {
>     deep: true,
>   }
> );
147c171
< 	padding: 8px 16px;
---
>   padding: 8px 16px;
149,152c173,176
< 	> .caution {
< 		margin: 0 0 8px 0;
< 		font-size: 0.8em;
< 		color: #f00;
---
>   > .caution {
>     margin: 0 0 8px 0;
>     font-size: 0.8em;
>     color: #f00;
154,157c178,181
< 		> i {
< 			margin-right: 4px;
< 		}
< 	}
---
>     > i {
>       margin-right: 4px;
>     }
>   }
159,163c183,187
< 	> ul {
< 		display: block;
< 		margin: 0;
< 		padding: 0;
< 		list-style: none;
---
>   > ul {
>     display: block;
>     margin: 0;
>     padding: 0;
>     list-style: none;
165,169c189,193
< 		> li {
< 			display: flex;
< 			margin: 8px 0;
< 			padding: 0;
< 			width: 100%;
---
>     > li {
>       display: flex;
>       margin: 8px 0;
>       padding: 0;
>       width: 100%;
171,173c195,197
< 			> .input {
< 				flex: 1;
< 			}
---
>       > .input {
>         flex: 1;
>       }
175,180c199,204
< 			> button {
< 				width: 32px;
< 				padding: 4px 0;
< 			}
< 		}
< 	}
---
>       > button {
>         width: 32px;
>         padding: 4px 0;
>       }
>     }
>   }
182,185c206,209
< 	> .add {
< 		margin: 8px 0;
< 		z-index: 1;
< 	}
---
>   > .add {
>     margin: 8px 0;
>     z-index: 1;
>   }
187,188c211,212
< 	> section {
< 		margin: 16px 0 0 0;
---
>   > section {
>     margin: 16px 0 0 0;
190,195c214,219
< 		> div {
< 			margin: 0 8px;
< 			display: flex;
< 			flex-direction: row;
< 			flex-wrap: wrap;
< 			gap: 12px;
---
>     > div {
>       margin: 0 8px;
>       display: flex;
>       flex-direction: row;
>       flex-wrap: wrap;
>       gap: 12px;
197,198c221,222
< 			&:last-child {
< 				flex: 1 0 auto;
---
>       &:last-child {
>         flex: 1 0 auto;
200,202c224,226
< 				> div {
< 					flex-grow: 1;
< 				}
---
>         > div {
>           flex-grow: 1;
>         }
204,209c228,233
< 				> section {
< 					// MAGIC: Prevent div above from growing unless wrapped to its own line
< 					flex-grow: 9999;
< 					align-items: end;
< 					display: flex;
< 					gap: 4px;
---
>         > section {
>           // MAGIC: Prevent div above from growing unless wrapped to its own line
>           flex-grow: 9999;
>           align-items: end;
>           display: flex;
>           gap: 4px;
211,217c235,241
< 					> .input {
< 						flex: 1 1 auto;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > .input {
>             flex: 1 1 auto;
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPopupMenu.vue RiricaV13/components/MkPopupMenu.vue
2,4c2,21
< <MkModal ref="modal" v-slot="{ type, maxHeight }" :z-priority="'high'" :src="src" :transparent-bg="true" @click="modal.close()" @close="emit('closing')" @closed="emit('closed')">
< 	<MkMenu :items="items" :align="align" :width="width" :max-height="maxHeight" :as-drawer="type === 'drawer'" :class="{ [$style.drawer]: type === 'drawer' }" @close="modal.close()"/>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     v-slot="{ type, maxHeight }"
>     :z-priority="'high'"
>     :src="src"
>     :transparent-bg="true"
>     @click="modal.close()"
>     @closed="emit('closed')"
>   >
>     <MkMenu
>       :items="items"
>       :align="align"
>       :width="width"
>       :max-height="maxHeight"
>       :as-drawer="type === 'drawer'"
>       class="sfhdhdhq"
>       :class="{ drawer: type === 'drawer' }"
>       @close="modal.close()"
>     />
>   </MkModal>
8,11c25,28
< import { } from 'vue';
< import MkModal from './MkModal.vue';
< import MkMenu from './MkMenu.vue';
< import { MenuItem } from '@/types/menu';
---
> import {} from "vue";
> import MkModal from "./MkModal.vue";
> import MkMenu from "./MkMenu.vue";
> import { MenuItem } from "@/types/menu";
14,18c31,35
< 	items: MenuItem[];
< 	align?: 'center' | string;
< 	width?: number;
< 	viaKeyboard?: boolean;
< 	src?: any;
---
>   items: MenuItem[];
>   align?: "center" | string;
>   width?: number;
>   viaKeyboard?: boolean;
>   src?: any;
22,23c39
< 	(ev: 'closed'): void;
< 	(ev: 'closing'): void;
---
>   (ev: "closed"): void;
26c42
< let modal = $shallowRef<InstanceType<typeof MkModal>>();
---
> let modal = $ref<InstanceType<typeof MkModal>>();
29,33c45,51
< <style lang="scss" module>
< .drawer {
< 	border-radius: 24px;
< 	border-bottom-right-radius: 0;
< 	border-bottom-left-radius: 0;
---
> <style lang="scss" scoped>
> .sfhdhdhq {
>   &.drawer {
>     border-radius: 24px;
>     border-bottom-right-radius: 0;
>     border-bottom-left-radius: 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPostForm.vue RiricaV13/components/MkPostForm.vue
2,68c2,205
< <div
< 	:class="[$style.root, { [$style.modal]: modal, _popup: modal }]"
< 	@dragover.stop="onDragover"
< 	@dragenter="onDragenter"
< 	@dragleave="onDragleave"
< 	@drop.stop="onDrop"
< >
< 	<header :class="$style.header">
< 		<button v-if="!fixed" :class="$style.cancel" class="_button" @click="cancel"><i class="ti ti-x"></i></button>
< 		<button v-click-anime v-tooltip="i18n.ts.switchAccount" :class="$style.account" class="_button" @click="openAccountMenu">
< 			<MkAvatar :user="postAccount ?? $i" :class="$style.avatar"/>
< 		</button>
< 		<div :class="$style.headerRight">
< 			<span :class="[$style.textCount, { [$style.textOver]: textLength > maxTextLength }]">{{ maxTextLength - textLength }}</span>
< 			<span v-if="localOnly" :class="$style.localOnly"><i class="ti ti-world-off"></i></span>
< 			<button ref="visibilityButton" v-tooltip="i18n.ts.visibility" class="_button" :class="$style.visibility" :disabled="channel != null" @click="setVisibility">
< 				<span v-if="visibility === 'public'"><i class="ti ti-world"></i></span>
< 				<span v-if="visibility === 'home'"><i class="ti ti-home"></i></span>
< 				<span v-if="visibility === 'followers'"><i class="ti ti-lock"></i></span>
< 				<span v-if="visibility === 'specified'"><i class="ti ti-mail"></i></span>
< 			</button>
< 			<button v-tooltip="i18n.ts.previewNoteText" class="_button" :class="[$style.previewButton, { [$style.previewButtonActive]: showPreview }]" @click="showPreview = !showPreview"><i class="ti ti-eye"></i></button>
< 			<button v-click-anime class="_button" :class="[$style.submit, { [$style.submitPosting]: posting }]" :disabled="!canPost" data-cy-open-post-form-submit @click="post">
< 				<div :class="$style.submitInner">
< 					<template v-if="posted"></template>
< 					<template v-else-if="posting"><MkEllipsis/></template>
< 					<template v-else>{{ submitText }}</template>
< 					<i style="margin-left: 6px;" :class="posted ? 'ti ti-check' : reply ? 'ti ti-arrow-back-up' : renote ? 'ti ti-quote' : 'ti ti-send'"></i>
< 				</div>
< 			</button>
< 		</div>
< 	</header>
< 	<div :class="[$style.form]">
< 		<MkNoteSimple v-if="reply" :class="$style.targetNote" :note="reply"/>
< 		<MkNoteSimple v-if="renote" :class="$style.targetNote" :note="renote"/>
< 		<div v-if="quoteId" :class="$style.withQuote"><i class="ti ti-quote"></i> {{ i18n.ts.quoteAttached }}<button @click="quoteId = null"><i class="ti ti-x"></i></button></div>
< 		<div v-if="visibility === 'specified'" :class="$style.toSpecified">
< 			<span style="margin-right: 8px;">{{ i18n.ts.recipient }}</span>
< 			<div :class="$style.visibleUsers">
< 				<span v-for="u in visibleUsers" :key="u.id" :class="$style.visibleUser">
< 					<MkAcct :user="u"/>
< 					<button class="_button" style="padding: 4px 8px;" @click="removeVisibleUser(u)"><i class="ti ti-x"></i></button>
< 				</span>
< 				<button class="_buttonPrimary" style="padding: 4px; border-radius: 8px;" @click="addVisibleUser"><i class="ti ti-plus ti-fw"></i></button>
< 			</div>
< 		</div>
< 		<MkInfo v-if="hasNotSpecifiedMentions" warn :class="$style.hasNotSpecifiedMentions">{{ i18n.ts.notSpecifiedMentionWarning }} - <button class="_textButton" @click="addMissingMention()">{{ i18n.ts.add }}</button></MkInfo>
< 		<input v-show="useCw" ref="cwInputEl" v-model="cw" :class="$style.cw" :placeholder="i18n.ts.annotation" @keydown="onKeydown">
< 		<textarea ref="textareaEl" v-model="text" :class="[$style.text, { [$style.withCw]: useCw }]" :disabled="posting || posted" :placeholder="placeholder" data-cy-post-form-text @keydown="onKeydown" @paste="onPaste" @compositionupdate="onCompositionUpdate" @compositionend="onCompositionEnd"/>
< 		<input v-show="withHashtags" ref="hashtagsInputEl" v-model="hashtags" :class="$style.hashtags" :placeholder="i18n.ts.hashtags" list="hashtags">
< 		<XPostFormAttaches v-model="files" :class="$style.attaches" @detach="detachFile" @change-sensitive="updateFileSensitive" @change-name="updateFileName"/>
< 		<MkPollEditor v-if="poll" v-model="poll" @destroyed="poll = null"/>
< 		<XNotePreview v-if="showPreview" :class="$style.preview" :text="text"/>
< 		<footer :class="$style.footer">
< 			<button v-tooltip="i18n.ts.attachFile" class="_button" :class="$style.footerButton" @click="chooseFileFrom"><i class="ti ti-photo-plus"></i></button>
< 			<button v-tooltip="i18n.ts.poll" class="_button" :class="[$style.footerButton, { [$style.footerButtonActive]: poll }]" @click="togglePoll"><i class="ti ti-chart-arrows"></i></button>
< 			<button v-tooltip="i18n.ts.useCw" class="_button" :class="[$style.footerButton, { [$style.footerButtonActive]: useCw }]" @click="useCw = !useCw"><i class="ti ti-eye-off"></i></button>
< 			<button v-tooltip="i18n.ts.mention" class="_button" :class="$style.footerButton" @click="insertMention"><i class="ti ti-at"></i></button>
< 			<button v-tooltip="i18n.ts.hashtags" class="_button" :class="[$style.footerButton, { [$style.footerButtonActive]: withHashtags }]" @click="withHashtags = !withHashtags"><i class="ti ti-hash"></i></button>
< 			<button v-tooltip="i18n.ts.emoji" class="_button" :class="$style.footerButton" @click="insertEmoji"><i class="ti ti-mood-happy"></i></button>
< 			<button v-if="postFormActions.length > 0" v-tooltip="i18n.ts.plugin" class="_button" :class="$style.footerButton" @click="showActions"><i class="ti ti-plug"></i></button>
< 		</footer>
< 		<datalist id="hashtags">
< 			<option v-for="hashtag in recentHashtags" :key="hashtag" :value="hashtag"/>
< 		</datalist>
< 	</div>
< </div>
---
>   <div
>     v-size="{ max: [310, 500] }"
>     class="gafaadew"
>     :class="{ modal, _popup: modal }"
>     @dragover.stop="onDragover"
>     @dragenter="onDragenter"
>     @dragleave="onDragleave"
>     @drop.stop="onDrop"
>   >
>     <header>
>       <button v-if="!fixed" class="cancel _button" @click="cancel">
>         <i class="fas fa-times"></i>
>       </button>
>       <button
>         v-click-anime
>         v-tooltip="i18n.ts.switchAccount"
>         class="account _button"
>         @click="openAccountMenu"
>       >
>         <MkAvatar :user="postAccount ?? $i" class="avatar" />
>       </button>
>       <div class="right">
>         <span
>           class="text-count"
>           :class="{ over: textLength > maxTextLength }"
>           >{{ maxTextLength - textLength }}</span
>         >
>         <span v-if="localOnly" class="local-only"
>           ><i class="fas fa-biohazard"></i
>         ></span>
>         <button
>           ref="visibilityButton"
>           v-tooltip="i18n.ts.visibility"
>           class="_button visibility"
>           :disabled="channel != null"
>           @click="setVisibility"
>         >
>           <span v-if="visibility === 'public'"
>             ><i class="fas fa-globe"></i
>           ></span>
>           <span v-if="visibility === 'home'"><i class="fas fa-home"></i></span>
>           <span v-if="visibility === 'followers'"
>             ><i class="fas fa-unlock"></i
>           ></span>
>           <span v-if="visibility === 'specified'"
>             ><i class="fas fa-envelope"></i
>           ></span>
>         </button>
>         <button
>           v-tooltip="i18n.ts.previewNoteText"
>           class="_button preview"
>           :class="{ active: showPreview }"
>           @click="showPreview = !showPreview"
>         >
>           <i class="fas fa-file-code"></i>
>         </button>
>         <button
>           class="submit _buttonGradate"
>           :disabled="!canPost"
>           data-cy-open-post-form-submit
>           @click="post"
>         >
>           {{ submitText
>           }}<i
>             :class="
>               reply
>                 ? 'fas fa-reply'
>                 : renote
>                 ? 'fas fa-quote-right'
>                 : 'fas fa-paper-plane'
>             "
>           ></i>
>         </button>
>       </div>
>     </header>
>     <div class="form" :class="{ fixed }">
>       <XNoteSimple v-if="reply" class="preview" :note="reply" />
>       <XNoteSimple v-if="renote" class="preview" :note="renote" />
>       <div v-if="quoteId" class="with-quote">
>         <i class="fas fa-quote-left"></i> {{ i18n.ts.quoteAttached
>         }}<button @click="quoteId = null"><i class="fas fa-times"></i></button>
>       </div>
>       <div v-if="visibility === 'specified'" class="to-specified">
>         <span style="margin-right: 8px">{{ i18n.ts.recipient }}</span>
>         <div class="visibleUsers">
>           <span v-for="u in visibleUsers" :key="u.id">
>             <MkAcct :user="u" />
>             <button class="_button" @click="removeVisibleUser(u)">
>               <i class="fas fa-times"></i>
>             </button>
>           </span>
>           <button class="_buttonPrimary" @click="addVisibleUser">
>             <i class="fas fa-plus fa-fw"></i>
>           </button>
>         </div>
>       </div>
>       <MkInfo
>         v-if="hasNotSpecifiedMentions"
>         warn
>         class="hasNotSpecifiedMentions"
>         >{{ i18n.ts.notSpecifiedMentionWarning }} -
>         <button class="_textButton" @click="addMissingMention()">
>           {{ i18n.ts.add }}
>         </button></MkInfo
>       >
>       <input
>         v-show="useCw"
>         ref="cwInputEl"
>         v-model="cw"
>         class="cw"
>         :placeholder="i18n.ts.annotation"
>         @keydown="onKeydown"
>       />
>       <textarea
>         ref="textareaEl"
>         v-model="text"
>         class="text"
>         :class="{ withCw: useCw }"
>         :disabled="posting"
>         :placeholder="placeholder"
>         data-cy-post-form-text
>         @keydown="onKeydown"
>         @paste="onPaste"
>         @compositionupdate="onCompositionUpdate"
>         @compositionend="onCompositionEnd"
>       />
>       <input
>         v-show="withHashtags"
>         ref="hashtagsInputEl"
>         v-model="hashtags"
>         class="hashtags"
>         :placeholder="i18n.ts.hashtags"
>         list="hashtags"
>       />
>       <XPostFormAttaches
>         class="attaches"
>         :files="files"
>         @updated="updateFiles"
>         @detach="detachFile"
>         @changeSensitive="updateFileSensitive"
>         @changeName="updateFileName"
>       />
>       <XPollEditor v-if="poll" v-model="poll" @destroyed="poll = null" />
>       <XNotePreview v-if="showPreview" class="preview" :text="text" />
>       <footer>
>         <button
>           v-tooltip="i18n.ts.attachFile"
>           class="_button"
>           @click="chooseFileFrom"
>         >
>           <i class="fas fa-photo-video"></i>
>         </button>
>         <button
>           v-tooltip="i18n.ts.poll"
>           class="_button"
>           :class="{ active: poll }"
>           @click="togglePoll"
>         >
>           <i class="fas fa-poll-h"></i>
>         </button>
>         <button
>           v-tooltip="i18n.ts.useCw"
>           class="_button"
>           :class="{ active: useCw }"
>           @click="useCw = !useCw"
>         >
>           <i class="fas fa-eye-slash"></i>
>         </button>
>         <button
>           v-tooltip="i18n.ts.mention"
>           class="_button"
>           @click="insertMention"
>         >
>           <i class="fas fa-at"></i>
>         </button>
>         <button
>           v-tooltip="i18n.ts.hashtags"
>           class="_button"
>           :class="{ active: withHashtags }"
>           @click="withHashtags = !withHashtags"
>         >
>           <i class="fas fa-hashtag"></i>
>         </button>
>         <button v-tooltip="i18n.ts.emoji" class="_button" @click="insertEmoji">
>           <i class="fas fa-laugh-squint"></i>
>         </button>
>         <button
>           v-if="postFormActions.length > 0"
>           v-tooltip="i18n.ts.plugin"
>           class="_button"
>           @click="showActions"
>         >
>           <i class="fas fa-plug"></i>
>         </button>
>       </footer>
>       <datalist id="hashtags">
>         <option
>           v-for="hashtag in recentHashtags"
>           :key="hashtag"
>           :value="hashtag"
>         />
>       </datalist>
>     </div>
>   </div>
72,101c209,239
< import { inject, watch, nextTick, onMounted, defineAsyncComponent } from 'vue';
< import * as mfm from 'mfm-js';
< import * as misskey from 'misskey-js';
< import insertTextAtCursor from 'insert-text-at-cursor';
< import { length } from 'stringz';
< import { toASCII } from 'punycode/';
< import * as Acct from 'misskey-js/built/acct';
< import { throttle } from 'throttle-debounce';
< import MkNoteSimple from '@/components/MkNoteSimple.vue';
< import XNotePreview from '@/components/MkNotePreview.vue';
< import XPostFormAttaches from '@/components/MkPostFormAttaches.vue';
< import MkPollEditor from '@/components/MkPollEditor.vue';
< import { host, url } from '@/config';
< import { erase, unique } from '@/scripts/array';
< import { extractMentions } from '@/scripts/extract-mentions';
< import { formatTimeString } from '@/scripts/format-time-string';
< import { Autocomplete } from '@/scripts/autocomplete';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { selectFiles } from '@/scripts/select-file';
< import { defaultStore, notePostInterruptors, postFormActions } from '@/store';
< import MkInfo from '@/components/MkInfo.vue';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import { $i, notesCount, incNotesCount, getAccounts, openAccountMenu as openAccountMenu_ } from '@/account';
< import { uploadFile } from '@/scripts/upload';
< import { deepClone } from '@/scripts/clone';
< import MkRippleEffect from '@/components/MkRippleEffect.vue';
< import { miLocalStorage } from '@/local-storage';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { inject, watch, nextTick, onMounted, defineAsyncComponent } from "vue";
> import * as mfm from "mfm-js";
> import * as misskey from "misskey-js";
> import insertTextAtCursor from "insert-text-at-cursor";
> import { length } from "stringz";
> import { toASCII } from "punycode/";
> import * as Acct from "misskey-js/built/acct";
> import { throttle } from "throttle-debounce";
> import XNoteSimple from "@/components/MkNoteSimple.vue";
> import XNotePreview from "@/components/MkNotePreview.vue";
> import XPostFormAttaches from "@/components/MkPostFormAttaches.vue";
> import XPollEditor from "@/components/MkPollEditor.vue";
> import { host, url } from "@/config";
> import { erase, unique } from "@/scripts/array";
> import { extractMentions } from "@/scripts/extract-mentions";
> import { formatTimeString } from "@/scripts/format-time-string";
> import { Autocomplete } from "@/scripts/autocomplete";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { selectFiles } from "@/scripts/select-file";
> import { defaultStore, notePostInterruptors, postFormActions } from "@/store";
> import MkInfo from "@/components/MkInfo.vue";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import {
>   $i,
>   getAccounts,
>   openAccountMenu as openAccountMenu_,
> } from "@/account";
> import { uploadFile } from "@/scripts/upload";
> import { deepClone } from "@/scripts/clone";
103c241
< const modal = inject('modal');
---
> const modal = inject("modal");
105,124c243,264
< const props = withDefaults(defineProps<{
< 	reply?: misskey.entities.Note;
< 	renote?: misskey.entities.Note;
< 	channel?: any; // TODO
< 	mention?: misskey.entities.User;
< 	specified?: misskey.entities.User;
< 	initialText?: string;
< 	initialVisibility?: typeof misskey.noteVisibilities;
< 	initialFiles?: misskey.entities.DriveFile[];
< 	initialLocalOnly?: boolean;
< 	initialVisibleUsers?: misskey.entities.User[];
< 	initialNote?: misskey.entities.Note;
< 	instant?: boolean;
< 	fixed?: boolean;
< 	autofocus?: boolean;
< 	freezeAfterPosted?: boolean;
< }>(), {
< 	initialVisibleUsers: () => [],
< 	autofocus: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     reply?: misskey.entities.Note;
>     renote?: misskey.entities.Note;
>     channel?: any; // TODO
>     mention?: misskey.entities.User;
>     specified?: misskey.entities.User;
>     initialText?: string;
>     initialVisibility?: typeof misskey.noteVisibilities;
>     initialFiles?: misskey.entities.DriveFile[];
>     initialLocalOnly?: boolean;
>     initialVisibleUsers?: misskey.entities.User[];
>     initialNote?: misskey.entities.Note;
>     instant?: boolean;
>     fixed?: boolean;
>     autofocus?: boolean;
>   }>(),
>   {
>     initialVisibleUsers: () => [],
>     autofocus: true,
>   }
> );
127,129c267,269
< 	(ev: 'posted'): void;
< 	(ev: 'cancel'): void;
< 	(ev: 'esc'): void;
---
>   (ev: "posted"): void;
>   (ev: "cancel"): void;
>   (ev: "esc"): void;
132,135c272,275
< const textareaEl = $shallowRef<HTMLTextAreaElement | null>(null);
< const cwInputEl = $shallowRef<HTMLInputElement | null>(null);
< const hashtagsInputEl = $shallowRef<HTMLInputElement | null>(null);
< const visibilityButton = $shallowRef<HTMLElement | null>(null);
---
> const textareaEl = $ref<HTMLTextAreaElement | null>(null);
> const cwInputEl = $ref<HTMLInputElement | null>(null);
> const hashtagsInputEl = $ref<HTMLInputElement | null>(null);
> const visibilityButton = $ref<HTMLElement | null>(null);
138,139c278
< let posted = $ref(false);
< let text = $ref(props.initialText ?? '');
---
> let text = $ref(props.initialText ?? "");
142,145c281,284
< 	choices: string[];
< 	multiple: boolean;
< 	expiresAt: string | null;
< 	expiredAfter: string | null;
---
>   choices: string[];
>   multiple: boolean;
>   expiresAt: string | null;
>   expiredAfter: string | null;
150,151c289,300
< let localOnly = $ref<boolean>(props.initialLocalOnly ?? defaultStore.state.rememberNoteVisibility ? defaultStore.state.localOnly : defaultStore.state.defaultNoteLocalOnly);
< let visibility = $ref(props.initialVisibility ?? (defaultStore.state.rememberNoteVisibility ? defaultStore.state.visibility : defaultStore.state.defaultNoteVisibility) as typeof misskey.noteVisibilities[number]);
---
> let localOnly = $ref<boolean>(
>   props.initialLocalOnly ?? defaultStore.state.rememberNoteVisibility
>     ? defaultStore.state.localOnly
>     : defaultStore.state.defaultNoteLocalOnly
> );
> let visibility = $ref(
>   props.initialVisibility ??
>     ((defaultStore.state.rememberNoteVisibility
>       ? defaultStore.state.visibility
>       : defaultStore.state
>           .defaultNoteVisibility) as typeof misskey.noteVisibilities[number])
> );
154c303
< 	props.initialVisibleUsers.forEach(pushVisibleUser);
---
>   props.initialVisibleUsers.forEach(pushVisibleUser);
160,161c309,310
< let recentHashtags = $ref(JSON.parse(miLocalStorage.getItem('hashtags') || '[]'));
< let imeText = $ref('');
---
> let recentHashtags = $ref(JSON.parse(localStorage.getItem("hashtags") || "[]"));
> let imeText = $ref("");
164,166c313,315
< 	if (props.channel) {
< 		stream.send('typingOnChannel', { channel: props.channel.id });
< 	}
---
>   if (props.channel) {
>     stream.send("typingOnChannel", { channel: props.channel.id });
>   }
170c319
< 	let key = props.channel ? `channel:${props.channel.id}` : '';
---
>   let key = props.channel ? `channel:${props.channel.id}` : "";
172,178c321,327
< 	if (props.renote) {
< 		key += `renote:${props.renote.id}`;
< 	} else if (props.reply) {
< 		key += `reply:${props.reply.id}`;
< 	} else {
< 		key += 'note';
< 	}
---
>   if (props.renote) {
>     key += `renote:${props.renote.id}`;
>   } else if (props.reply) {
>     key += `reply:${props.reply.id}`;
>   } else {
>     key += "note";
>   }
180c329
< 	return key;
---
>   return key;
184,200c333,349
< 	if (props.renote) {
< 		return i18n.ts._postForm.quotePlaceholder;
< 	} else if (props.reply) {
< 		return i18n.ts._postForm.replyPlaceholder;
< 	} else if (props.channel) {
< 		return i18n.ts._postForm.channelPlaceholder;
< 	} else {
< 		const xs = [
< 			i18n.ts._postForm._placeholders.a,
< 			i18n.ts._postForm._placeholders.b,
< 			i18n.ts._postForm._placeholders.c,
< 			i18n.ts._postForm._placeholders.d,
< 			i18n.ts._postForm._placeholders.e,
< 			i18n.ts._postForm._placeholders.f,
< 		];
< 		return xs[Math.floor(Math.random() * xs.length)];
< 	}
---
>   if (props.renote) {
>     return i18n.ts._postForm.quotePlaceholder;
>   } else if (props.reply) {
>     return i18n.ts._postForm.replyPlaceholder;
>   } else if (props.channel) {
>     return i18n.ts._postForm.channelPlaceholder;
>   } else {
>     const xs = [
>       i18n.ts._postForm._placeholders.a,
>       i18n.ts._postForm._placeholders.b,
>       i18n.ts._postForm._placeholders.c,
>       i18n.ts._postForm._placeholders.d,
>       i18n.ts._postForm._placeholders.e,
>       i18n.ts._postForm._placeholders.f,
>     ];
>     return xs[Math.floor(Math.random() * xs.length)];
>   }
204,208c353,357
< 	return props.renote
< 		? i18n.ts.quote
< 		: props.reply
< 			? i18n.ts.reply
< 			: i18n.ts.note;
---
>   return props.renote
>     ? i18n.ts.quote
>     : props.reply
>     ? i18n.ts.reply
>     : i18n.ts.note;
212c361
< 	return length((text + imeText).trim());
---
>   return length((text + imeText).trim());
216c365
< 	return instance ? instance.maxNoteTextLength : 1000;
---
>   return instance ? instance.maxNoteTextLength : 1000;
220,223c369,374
< 	return !posting && !posted &&
< 		(1 <= textLength || 1 <= files.length || !!poll || !!props.renote) &&
< 		(textLength <= maxTextLength) &&
< 		(!poll || poll.choices.length >= 2);
---
>   return (
>     !posting &&
>     (1 <= textLength || 1 <= files.length || !!poll || !!props.renote) &&
>     textLength <= maxTextLength &&
>     (!poll || poll.choices.length >= 2)
>   );
226,227c377,380
< const withHashtags = $computed(defaultStore.makeGetterSetter('postFormWithHashtags'));
< const hashtags = $computed(defaultStore.makeGetterSetter('postFormHashtags'));
---
> const withHashtags = $computed(
>   defaultStore.makeGetterSetter("postFormWithHashtags")
> );
> const hashtags = $computed(defaultStore.makeGetterSetter("postFormHashtags"));
230c383
< 	checkMissingMention();
---
>   checkMissingMention();
233,237c386,394
< watch($$(visibleUsers), () => {
< 	checkMissingMention();
< }, {
< 	deep: true,
< });
---
> watch(
>   $$(visibleUsers),
>   () => {
>     checkMissingMention();
>   },
>   {
>     deep: true,
>   }
> );
240,241c397,400
< 	text = props.mention.host ? `@${props.mention.username}@${toASCII(props.mention.host)}` : `@${props.mention.username}`;
< 	text += ' ';
---
>   text = props.mention.host
>     ? `@${props.mention.username}@${toASCII(props.mention.host)}`
>     : `@${props.mention.username}`;
>   text += " ";
244,245c403,410
< if (props.reply && (props.reply.user.username !== $i.username || (props.reply.user.host != null && props.reply.user.host !== host))) {
< 	text = `@${props.reply.user.username}${props.reply.user.host != null ? '@' + toASCII(props.reply.user.host) : ''} `;
---
> if (
>   props.reply &&
>   (props.reply.user.username !== $i.username ||
>     (props.reply.user.host != null && props.reply.user.host !== host))
> ) {
>   text = `@${props.reply.user.username}${
>     props.reply.user.host != null ? "@" + toASCII(props.reply.user.host) : ""
>   } `;
249,250c414,415
< 	const ast = mfm.parse(props.reply.text);
< 	const otherHost = props.reply.user.host;
---
>   const ast = mfm.parse(props.reply.text);
>   const otherHost = props.reply.user.host;
252,257c417,422
< 	for (const x of extractMentions(ast)) {
< 		const mention = x.host ?
< 			`@${x.username}@${toASCII(x.host)}` :
< 			(otherHost == null || otherHost === host) ?
< 				`@${x.username}` :
< 				`@${x.username}@${toASCII(otherHost)}`;
---
>   for (const x of extractMentions(ast)) {
>     const mention = x.host
>       ? `@${x.username}@${toASCII(x.host)}`
>       : otherHost == null || otherHost === host
>       ? `@${x.username}`
>       : `@${x.username}@${toASCII(otherHost)}`;
259,260c424,426
< 		// 自分は除外
< 		if ($i.username === x.username && (x.host == null || x.host === host)) continue;
---
>     // 自分は除外
>     if ($i.username === x.username && (x.host == null || x.host === host))
>       continue;
262,263c428,429
< 		// 重複は除外
< 		if (text.includes(`${mention} `)) continue;
---
>     // 重複は除外
>     if (text.includes(`${mention} `)) continue;
265,266c431,432
< 		text += `${mention} `;
< 	}
---
>     text += `${mention} `;
>   }
270,271c436,437
< 	visibility = 'public';
< 	localOnly = true; // TODO: チャンネルが連合するようになった折には消す
---
>   visibility = "public";
>   localOnly = true; // TODO: チャンネルが連合するようになった折には消す
275,282c441,454
< if (props.reply && ['home', 'followers', 'specified'].includes(props.reply.visibility)) {
< 	if (props.reply.visibility === 'home' && visibility === 'followers') {
< 		visibility = 'followers';
< 	} else if (['home', 'followers'].includes(props.reply.visibility) && visibility === 'specified') {
< 		visibility = 'specified';
< 	} else {
< 		visibility = props.reply.visibility;
< 	}
---
> if (
>   props.reply &&
>   ["home", "followers", "specified"].includes(props.reply.visibility)
> ) {
>   if (props.reply.visibility === "home" && visibility === "followers") {
>     visibility = "followers";
>   } else if (
>     ["home", "followers"].includes(props.reply.visibility) &&
>     visibility === "specified"
>   ) {
>     visibility = "specified";
>   } else {
>     visibility = props.reply.visibility;
>   }
284,291c456,465
< 	if (visibility === 'specified') {
< 		if (props.reply.visibleUserIds) {
< 			os.api('users/show', {
< 				userIds: props.reply.visibleUserIds.filter(uid => uid !== $i.id && uid !== props.reply.userId),
< 			}).then(users => {
< 				users.forEach(pushVisibleUser);
< 			});
< 		}
---
>   if (visibility === "specified") {
>     if (props.reply.visibleUserIds) {
>       os.api("users/show", {
>         userIds: props.reply.visibleUserIds.filter(
>           (uid) => uid !== $i.id && uid !== props.reply.userId
>         ),
>       }).then((users) => {
>         users.forEach(pushVisibleUser);
>       });
>     }
293,298c467,472
< 		if (props.reply.userId !== $i.id) {
< 			os.api('users/show', { userId: props.reply.userId }).then(user => {
< 				pushVisibleUser(user);
< 			});
< 		}
< 	}
---
>     if (props.reply.userId !== $i.id) {
>       os.api("users/show", { userId: props.reply.userId }).then((user) => {
>         pushVisibleUser(user);
>       });
>     }
>   }
302,303c476,477
< 	visibility = 'specified';
< 	pushVisibleUser(props.specified);
---
>   visibility = "specified";
>   pushVisibleUser(props.specified);
308,309c482,483
< 	useCw = true;
< 	cw = props.reply.cw;
---
>   useCw = true;
>   cw = props.reply.cw;
313,319c487,493
< 	watch($$(text), () => saveDraft());
< 	watch($$(useCw), () => saveDraft());
< 	watch($$(cw), () => saveDraft());
< 	watch($$(poll), () => saveDraft());
< 	watch($$(files), () => saveDraft(), { deep: true });
< 	watch($$(visibility), () => saveDraft());
< 	watch($$(localOnly), () => saveDraft());
---
>   watch($$(text), () => saveDraft());
>   watch($$(useCw), () => saveDraft());
>   watch($$(cw), () => saveDraft());
>   watch($$(poll), () => saveDraft());
>   watch($$(files), () => saveDraft(), { deep: true });
>   watch($$(visibility), () => saveDraft());
>   watch($$(localOnly), () => saveDraft());
323,324c497,498
< 	if (visibility === 'specified') {
< 		const ast = mfm.parse(text);
---
>   if (visibility === "specified") {
>     const ast = mfm.parse(text);
326,333c500,511
< 		for (const x of extractMentions(ast)) {
< 			if (!visibleUsers.some(u => (u.username === x.username) && (u.host === x.host))) {
< 				hasNotSpecifiedMentions = true;
< 				return;
< 			}
< 		}
< 		hasNotSpecifiedMentions = false;
< 	}
---
>     for (const x of extractMentions(ast)) {
>       if (
>         !visibleUsers.some(
>           (u) => u.username === x.username && u.host === x.host
>         )
>       ) {
>         hasNotSpecifiedMentions = true;
>         return;
>       }
>     }
>     hasNotSpecifiedMentions = false;
>   }
337c515
< 	const ast = mfm.parse(text);
---
>   const ast = mfm.parse(text);
339,345c517,527
< 	for (const x of extractMentions(ast)) {
< 		if (!visibleUsers.some(u => (u.username === x.username) && (u.host === x.host))) {
< 			os.api('users/show', { username: x.username, host: x.host }).then(user => {
< 				visibleUsers.push(user);
< 			});
< 		}
< 	}
---
>   for (const x of extractMentions(ast)) {
>     if (
>       !visibleUsers.some((u) => u.username === x.username && u.host === x.host)
>     ) {
>       os.api("users/show", { username: x.username, host: x.host }).then(
>         (user) => {
>           visibleUsers.push(user);
>         }
>       );
>     }
>   }
349,358c531,540
< 	if (poll) {
< 		poll = null;
< 	} else {
< 		poll = {
< 			choices: ['', ''],
< 			multiple: false,
< 			expiresAt: null,
< 			expiredAfter: null,
< 		};
< 	}
---
>   if (poll) {
>     poll = null;
>   } else {
>     poll = {
>       choices: ["", ""],
>       multiple: false,
>       expiresAt: null,
>       expiredAfter: null,
>     };
>   }
362c544
< 	insertTextAtCursor(textareaEl, ` #${tag} `);
---
>   insertTextAtCursor(textareaEl, ` #${tag} `);
366,369c548,554
< 	if (textareaEl) {
< 		textareaEl.focus();
< 		textareaEl.setSelectionRange(textareaEl.value.length, textareaEl.value.length);
< 	}
---
>   if (textareaEl) {
>     textareaEl.focus();
>     textareaEl.setSelectionRange(
>       textareaEl.value.length,
>       textareaEl.value.length
>     );
>   }
373,377c558,564
< 	selectFiles(ev.currentTarget ?? ev.target, i18n.ts.attachFile).then(files_ => {
< 		for (const file of files_) {
< 			files.push(file);
< 		}
< 	});
---
>   selectFiles(ev.currentTarget ?? ev.target, i18n.ts.attachFile).then(
>     (files_) => {
>       for (const file of files_) {
>         files.push(file);
>       }
>     }
>   );
381c568
< 	files = files.filter(x => x.id !== id);
---
>   files = files.filter((x) => x.id !== id);
383a571,574
> function updateFiles(_files) {
>   files = _files;
> }
> 
385c576
< 	files[files.findIndex(x => x.id === file.id)].isSensitive = sensitive;
---
>   files[files.findIndex((x) => x.id === file.id)].isSensitive = sensitive;
389c580
< 	files[files.findIndex(x => x.id === file.id)].name = name;
---
>   files[files.findIndex((x) => x.id === file.id)].name = name;
393,395c584,586
< 	uploadFile(file, defaultStore.state.uploadFolder, name).then(res => {
< 		files.push(res);
< 	});
---
>   uploadFile(file, defaultStore.state.uploadFolder, name).then((res) => {
>     files.push(res);
>   });
399,402c590,593
< 	if (props.channel) {
< 		// TODO: information dialog
< 		return;
< 	}
---
>   if (props.channel) {
>     // TODO: information dialog
>     return;
>   }
404,421c595,617
< 	os.popup(defineAsyncComponent(() => import('@/components/MkVisibilityPicker.vue')), {
< 		currentVisibility: visibility,
< 		currentLocalOnly: localOnly,
< 		src: visibilityButton,
< 	}, {
< 		changeVisibility: v => {
< 			visibility = v;
< 			if (defaultStore.state.rememberNoteVisibility) {
< 				defaultStore.set('visibility', visibility);
< 			}
< 		},
< 		changeLocalOnly: v => {
< 			localOnly = v;
< 			if (defaultStore.state.rememberNoteVisibility) {
< 				defaultStore.set('localOnly', localOnly);
< 			}
< 		},
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkVisibilityPicker.vue")),
>     {
>       currentVisibility: visibility,
>       currentLocalOnly: localOnly,
>       src: visibilityButton,
>     },
>     {
>       changeVisibility: (v) => {
>         visibility = v;
>         if (defaultStore.state.rememberNoteVisibility) {
>           defaultStore.set("visibility", visibility);
>         }
>       },
>       changeLocalOnly: (v) => {
>         localOnly = v;
>         if (defaultStore.state.rememberNoteVisibility) {
>           defaultStore.set("localOnly", localOnly);
>         }
>       },
>     },
>     "closed"
>   );
425,427c621,627
< 	if (!visibleUsers.some(u => u.username === user.username && u.host === user.host)) {
< 		visibleUsers.push(user);
< 	}
---
>   if (
>     !visibleUsers.some(
>       (u) => u.username === user.username && u.host === user.host
>     )
>   ) {
>     visibleUsers.push(user);
>   }
431,433c631,633
< 	os.selectUser().then(user => {
< 		pushVisibleUser(user);
< 	});
---
>   os.selectUser().then((user) => {
>     pushVisibleUser(user);
>   });
437c637
< 	visibleUsers = erase(user, visibleUsers);
---
>   visibleUsers = erase(user, visibleUsers);
441,444c641,644
< 	text = '';
< 	files = [];
< 	poll = null;
< 	quoteId = null;
---
>   text = "";
>   files = [];
>   poll = null;
>   quoteId = null;
448,450c648,655
< 	if ((ev.which === 10 || ev.which === 13) && (ev.ctrlKey || ev.metaKey) && canPost) post();
< 	if (ev.which === 27) emit('esc');
< 	typing();
---
>   if (
>     (ev.which === 10 || ev.which === 13) &&
>     (ev.ctrlKey || ev.metaKey) &&
>     canPost
>   )
>     post();
>   if (ev.which === 27) emit("esc");
>   typing();
454,455c659,660
< 	imeText = ev.data;
< 	typing();
---
>   imeText = ev.data;
>   typing();
459c664
< 	imeText = '';
---
>   imeText = "";
463,471c668,681
< 	for (const { item, i } of Array.from(ev.clipboardData.items).map((item, i) => ({ item, i }))) {
< 		if (item.kind === 'file') {
< 			const file = item.getAsFile();
< 			const lio = file.name.lastIndexOf('.');
< 			const ext = lio >= 0 ? file.name.slice(lio) : '';
< 			const formatted = `${formatTimeString(new Date(file.lastModified), defaultStore.state.pastedFileName).replace(/{{number}}/g, `${i + 1}`)}${ext}`;
< 			upload(file, formatted);
< 		}
< 	}
---
>   for (const { item, i } of Array.from(ev.clipboardData.items).map(
>     (item, i) => ({ item, i })
>   )) {
>     if (item.kind === "file") {
>       const file = item.getAsFile();
>       const lio = file.name.lastIndexOf(".");
>       const ext = lio >= 0 ? file.name.slice(lio) : "";
>       const formatted = `${formatTimeString(
>         new Date(file.lastModified),
>         defaultStore.state.pastedFileName
>       ).replace(/{{number}}/g, `${i + 1}`)}${ext}`;
>       upload(file, formatted);
>     }
>   }
473c683
< 	const paste = ev.clipboardData.getData('text');
---
>   const paste = ev.clipboardData.getData("text");
475,476c685,686
< 	if (!props.renote && !quoteId && paste.startsWith(url + '/notes/')) {
< 		ev.preventDefault();
---
>   if (!props.renote && !quoteId && paste.startsWith(url + "/notes/")) {
>     ev.preventDefault();
478,485c688,695
< 		os.confirm({
< 			type: 'info',
< 			text: i18n.ts.quoteQuestion,
< 		}).then(({ canceled }) => {
< 			if (canceled) {
< 				insertTextAtCursor(textareaEl, paste);
< 				return;
< 			}
---
>     os.confirm({
>       type: "info",
>       text: i18n.ts.quoteQuestion,
>     }).then(({ canceled }) => {
>       if (canceled) {
>         insertTextAtCursor(textareaEl, paste);
>         return;
>       }
487,489c697,699
< 			quoteId = paste.substr(url.length).match(/^\/notes\/(.+?)\/?$/)[1];
< 		});
< 	}
---
>       quoteId = paste.substr(url.length).match(/^\/notes\/(.+?)\/?$/)[1];
>     });
>   }
493,515c703,725
< 	if (!ev.dataTransfer.items[0]) return;
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
< 	if (isFile || isDriveFile) {
< 		ev.preventDefault();
< 		draghover = true;
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	}
---
>   if (!ev.dataTransfer.items[0]) return;
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
>   if (isFile || isDriveFile) {
>     ev.preventDefault();
>     draghover = true;
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   }
519c729
< 	draghover = true;
---
>   draghover = true;
523c733
< 	draghover = false;
---
>   draghover = false;
527c737
< 	draghover = false;
---
>   draghover = false;
529,534c739,744
< 	// ファイルだったら
< 	if (ev.dataTransfer.files.length > 0) {
< 		ev.preventDefault();
< 		for (const x of Array.from(ev.dataTransfer.files)) upload(x);
< 		return;
< 	}
---
>   // ファイルだったら
>   if (ev.dataTransfer.files.length > 0) {
>     ev.preventDefault();
>     for (const x of Array.from(ev.dataTransfer.files)) upload(x);
>     return;
>   }
536,543c746,753
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		const file = JSON.parse(driveFile);
< 		files.push(file);
< 		ev.preventDefault();
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     const file = JSON.parse(driveFile);
>     files.push(file);
>     ev.preventDefault();
>   }
>   //#endregion
547c757
< 	const draftData = JSON.parse(miLocalStorage.getItem('drafts') || '{}');
---
>   const draftData = JSON.parse(localStorage.getItem("drafts") || "{}");
549,560c759,770
< 	draftData[draftKey] = {
< 		updatedAt: new Date(),
< 		data: {
< 			text: text,
< 			useCw: useCw,
< 			cw: cw,
< 			visibility: visibility,
< 			localOnly: localOnly,
< 			files: files,
< 			poll: poll,
< 		},
< 	};
---
>   draftData[draftKey] = {
>     updatedAt: new Date(),
>     data: {
>       text: text,
>       useCw: useCw,
>       cw: cw,
>       visibility: visibility,
>       localOnly: localOnly,
>       files: files,
>       poll: poll,
>     },
>   };
562c772
< 	miLocalStorage.setItem('drafts', JSON.stringify(draftData));
---
>   localStorage.setItem("drafts", JSON.stringify(draftData));
566c776
< 	const draftData = JSON.parse(miLocalStorage.getItem('drafts') ?? '{}');
---
>   const draftData = JSON.parse(localStorage.getItem("drafts") || "{}");
568c778
< 	delete draftData[draftKey];
---
>   delete draftData[draftKey];
570c780
< 	miLocalStorage.setItem('drafts', JSON.stringify(draftData));
---
>   localStorage.setItem("drafts", JSON.stringify(draftData));
573,580c783,796
< async function post(ev?: MouseEvent) {
< 	if (ev) {
< 		const el = ev.currentTarget ?? ev.target;
< 		const rect = el.getBoundingClientRect();
< 		const x = rect.left + (el.offsetWidth / 2);
< 		const y = rect.top + (el.offsetHeight / 2);
< 		os.popup(MkRippleEffect, { x, y }, {}, 'end');
< 	}
---
> async function post() {
>   let postData = {
>     text: text === "" ? undefined : text,
>     fileIds: files.length > 0 ? files.map((f) => f.id) : undefined,
>     replyId: props.reply ? props.reply.id : undefined,
>     renoteId: props.renote ? props.renote.id : quoteId ? quoteId : undefined,
>     channelId: props.channel ? props.channel.id : undefined,
>     poll: poll || undefined,
>     cw: useCw ? cw || "" : undefined,
>     localOnly: localOnly,
>     visibility: visibility,
>     visibleUserIds:
>       visibility === "specified" ? visibleUsers.map((u) => u.id) : undefined,
>   };
582,593c798,805
< 	let postData = {
< 		text: text === '' ? undefined : text,
< 		fileIds: files.length > 0 ? files.map(f => f.id) : undefined,
< 		replyId: props.reply ? props.reply.id : undefined,
< 		renoteId: props.renote ? props.renote.id : quoteId ? quoteId : undefined,
< 		channelId: props.channel ? props.channel.id : undefined,
< 		poll: poll,
< 		cw: useCw ? cw ?? '' : undefined,
< 		localOnly: localOnly,
< 		visibility: visibility,
< 		visibleUserIds: visibility === 'specified' ? visibleUsers.map(u => u.id) : undefined,
< 	};
---
>   if (withHashtags && hashtags && hashtags.trim() !== "") {
>     const hashtags_ = hashtags
>       .trim()
>       .split(" ")
>       .map((x) => (x.startsWith("#") ? x : "#" + x))
>       .join(" ");
>     postData.text = postData.text ? `${postData.text} ${hashtags_}` : hashtags_;
>   }
595,598c807,812
< 	if (withHashtags && hashtags && hashtags.trim() !== '') {
< 		const hashtags_ = hashtags.trim().split(' ').map(x => x.startsWith('#') ? x : '#' + x).join(' ');
< 		postData.text = postData.text ? `${postData.text} ${hashtags_}` : hashtags_;
< 	}
---
>   // plugin
>   if (notePostInterruptors.length > 0) {
>     for (const interruptor of notePostInterruptors) {
>       postData = await interruptor.handler(deepClone(postData));
>     }
>   }
600,605c814
< 	// plugin
< 	if (notePostInterruptors.length > 0) {
< 		for (const interruptor of notePostInterruptors) {
< 			postData = await interruptor.handler(deepClone(postData));
< 		}
< 	}
---
>   let token = undefined;
607c816,819
< 	let token = undefined;
---
>   if (postAccount) {
>     const storedAccounts = await getAccounts();
>     token = storedAccounts.find((x) => x.id === postAccount.id)?.token;
>   }
609,666c821,851
< 	if (postAccount) {
< 		const storedAccounts = await getAccounts();
< 		token = storedAccounts.find(x => x.id === postAccount.id)?.token;
< 	}
< 
< 	posting = true;
< 	os.api('notes/create', postData, token).then(() => {
< 		if (props.freezeAfterPosted) {
< 			posted = true;
< 		} else {
< 			clear();
< 		}
< 		nextTick(() => {
< 			deleteDraft();
< 			emit('posted');
< 			if (postData.text && postData.text !== '') {
< 				const hashtags_ = mfm.parse(postData.text).filter(x => x.type === 'hashtag').map(x => x.props.hashtag);
< 				const history = JSON.parse(miLocalStorage.getItem('hashtags') || '[]') as string[];
< 				miLocalStorage.setItem('hashtags', JSON.stringify(unique(hashtags_.concat(history))));
< 			}
< 			posting = false;
< 			postAccount = null;
< 
< 			incNotesCount();
< 			if (notesCount === 1) {
< 				claimAchievement('notes1');
< 			}
< 
< 			const text = postData.text?.toLowerCase() ?? '';
< 			if ((text.includes('love') || text.includes('❤')) && text.includes('misskey')) {
< 				claimAchievement('iLoveMisskey');
< 			}
< 			if (text.includes('Efrlqw8ytg4'.toLowerCase()) || text.includes('XVCwzwxdHuA'.toLowerCase())) {
< 				claimAchievement('brainDiver');
< 			}
< 
< 			if (props.renote && (props.renote.userId === $i.id) && text.length > 0) {
< 				claimAchievement('selfQuote');
< 			}
< 
< 			const date = new Date();
< 			const h = date.getHours();
< 			const m = date.getMinutes();
< 			const s = date.getSeconds();
< 			if (h >= 0 && h <= 3) {
< 				claimAchievement('postedAtLateNight');
< 			}
< 			if (m === 0 && s === 0) {
< 				claimAchievement('postedAt0min0sec');
< 			}
< 		});
< 	}).catch(err => {
< 		posting = false;
< 		os.alert({
< 			type: 'error',
< 			text: err.message + '\n' + (err as any).id,
< 		});
< 	});
---
>   posting = true;
>   os.api("notes/create", postData, token)
>     .then(() => {
>       clear();
>       nextTick(() => {
>         deleteDraft();
>         emit("posted");
>         if (postData.text && postData.text !== "") {
>           const hashtags_ = mfm
>             .parse(postData.text)
>             .filter((x) => x.type === "hashtag")
>             .map((x) => x.props.hashtag);
>           const history = JSON.parse(
>             localStorage.getItem("hashtags") || "[]"
>           ) as string[];
>           localStorage.setItem(
>             "hashtags",
>             JSON.stringify(unique(hashtags_.concat(history)))
>           );
>         }
>         posting = false;
>         postAccount = null;
>       });
>     })
>     .catch((err) => {
>       posting = false;
>       os.alert({
>         type: "error",
>         text: err.message + "\n" + (err as any).id,
>       });
>     });
670c855
< 	emit('cancel');
---
>   emit("cancel");
674,676c859,861
< 	os.selectUser().then(user => {
< 		insertTextAtCursor(textareaEl, '@' + Acct.toString(user) + ' ');
< 	});
---
>   os.selectUser().then((user) => {
>     insertTextAtCursor(textareaEl, "@" + Acct.toString(user) + " ");
>   });
680c865
< 	os.openEmojiPicker(ev.currentTarget ?? ev.target, {}, textareaEl);
---
>   os.openEmojiPicker(ev.currentTarget ?? ev.target, {}, textareaEl);
684,693c869,886
< 	os.popupMenu(postFormActions.map(action => ({
< 		text: action.title,
< 		action: () => {
< 			action.handler({
< 				text: text,
< 			}, (key, value) => {
< 				if (key === 'text') { text = value; }
< 			});
< 		},
< 	})), ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     postFormActions.map((action) => ({
>       text: action.title,
>       action: () => {
>         action.handler(
>           {
>             text: text,
>           },
>           (key, value) => {
>             if (key === "text") {
>               text = value;
>             }
>           }
>         );
>       },
>     })),
>     ev.currentTarget ?? ev.target
>   );
699,710c892,906
< 	openAccountMenu_({
< 		withExtraOperation: false,
< 		includeCurrentAccount: true,
< 		active: postAccount != null ? postAccount.id : $i.id,
< 		onChoose: (account) => {
< 			if (account.id === $i.id) {
< 				postAccount = null;
< 			} else {
< 				postAccount = account;
< 			}
< 		},
< 	}, ev);
---
>   openAccountMenu_(
>     {
>       withExtraOperation: false,
>       includeCurrentAccount: true,
>       active: postAccount != null ? postAccount.id : $i.id,
>       onChoose: (account) => {
>         if (account.id === $i.id) {
>           postAccount = null;
>         } else {
>           postAccount = account;
>         }
>       },
>     },
>     ev
>   );
714,715c910,911
< 	if (props.autofocus) {
< 		focus();
---
>   if (props.autofocus) {
>     focus();
717,720c913,916
< 		nextTick(() => {
< 			focus();
< 		});
< 	}
---
>     nextTick(() => {
>       focus();
>     });
>   }
722,725c918,921
< 	// TODO: detach when unmount
< 	new Autocomplete(textareaEl, $$(text));
< 	new Autocomplete(cwInputEl, $$(cw));
< 	new Autocomplete(hashtagsInputEl, $$(hashtags));
---
>   // TODO: detach when unmount
>   new Autocomplete(textareaEl, $$(text));
>   new Autocomplete(cwInputEl, $$(cw));
>   new Autocomplete(hashtagsInputEl, $$(hashtags));
727,742c923,940
< 	nextTick(() => {
< 		// 書きかけの投稿を復元
< 		if (!props.instant && !props.mention && !props.specified) {
< 			const draft = JSON.parse(miLocalStorage.getItem('drafts') || '{}')[draftKey];
< 			if (draft) {
< 				text = draft.data.text;
< 				useCw = draft.data.useCw;
< 				cw = draft.data.cw;
< 				visibility = draft.data.visibility;
< 				localOnly = draft.data.localOnly;
< 				files = (draft.data.files || []).filter(draftFile => draftFile);
< 				if (draft.data.poll) {
< 					poll = draft.data.poll;
< 				}
< 			}
< 		}
---
>   nextTick(() => {
>     // 書きかけの投稿を復元
>     if (!props.instant && !props.mention && !props.specified) {
>       const draft = JSON.parse(localStorage.getItem("drafts") || "{}")[
>         draftKey
>       ];
>       if (draft) {
>         text = draft.data.text;
>         useCw = draft.data.useCw;
>         cw = draft.data.cw;
>         visibility = draft.data.visibility;
>         localOnly = draft.data.localOnly;
>         files = (draft.data.files || []).filter((draftFile) => draftFile);
>         if (draft.data.poll) {
>           poll = draft.data.poll;
>         }
>       }
>     }
744,762c942,960
< 		// 削除して編集
< 		if (props.initialNote) {
< 			const init = props.initialNote;
< 			text = init.text ? init.text : '';
< 			files = init.files;
< 			cw = init.cw;
< 			useCw = init.cw != null;
< 			if (init.poll) {
< 				poll = {
< 					choices: init.poll.choices.map(x => x.text),
< 					multiple: init.poll.multiple,
< 					expiresAt: init.poll.expiresAt,
< 					expiredAfter: init.poll.expiredAfter,
< 				};
< 			}
< 			visibility = init.visibility;
< 			localOnly = init.localOnly;
< 			quoteId = init.renote ? init.renote.id : null;
< 		}
---
>     // 削除して編集
>     if (props.initialNote) {
>       const init = props.initialNote;
>       text = init.text ? init.text : "";
>       files = init.files;
>       cw = init.cw;
>       useCw = init.cw != null;
>       if (init.poll) {
>         poll = {
>           choices: init.poll.choices.map((x) => x.text),
>           multiple: init.poll.multiple,
>           expiresAt: init.poll.expiresAt,
>           expiredAfter: init.poll.expiredAfter,
>         };
>       }
>       visibility = init.visibility;
>       localOnly = init.localOnly;
>       quoteId = init.renote ? init.renote.id : null;
>     }
764,765c962,963
< 		nextTick(() => watchForDraft());
< 	});
---
>     nextTick(() => watchForDraft());
>   });
767,770d964
< 
< defineExpose({
< 	clear,
< });
773,775c967,969
< <style lang="scss" module>
< .root {
< 	position: relative;
---
> <style lang="scss" scoped>
> .gafaadew {
>   position: relative;
777,781c971,974
< 	&.modal {
< 		width: 100%;
< 		max-width: 520px;
< 	}
< }
---
>   &.modal {
>     width: 100%;
>     max-width: 520px;
>   }
783,786c976,978
< .header {
< 	z-index: 1000;
< 	height: 66px;
< }
---
>   > header {
>     z-index: 1000;
>     height: 66px;
788,793c980,985
< .cancel {
< 	padding: 0;
< 	font-size: 1em;
< 	width: 64px;
< 	line-height: 66px;
< }
---
>     > .cancel {
>       padding: 0;
>       font-size: 20px;
>       width: 64px;
>       line-height: 66px;
>     }
795,800c987,991
< .account {
< 	height: 100%;
< 	aspect-ratio: 1/1;
< 	display: inline-flex;
< 	vertical-align: bottom;
< }
---
>     > .account {
>       height: 100%;
>       aspect-ratio: 1/1;
>       display: inline-flex;
>       vertical-align: bottom;
802,806c993,998
< .avatar {
< 	width: 28px;
< 	height: 28px;
< 	margin: auto;
< }
---
>       > .avatar {
>         width: 28px;
>         height: 28px;
>         margin: auto;
>       }
>     }
808,812c1000,1003
< .headerRight {
< 	position: absolute;
< 	top: 0;
< 	right: 0;
< }
---
>     > .right {
>       position: absolute;
>       top: 0;
>       right: 0;
814,817c1005,1008
< .textCount {
< 	opacity: 0.7;
< 	line-height: 66px;
< }
---
>       > .text-count {
>         opacity: 0.7;
>         line-height: 66px;
>       }
819,822c1010,1013
< .visibility {
< 	height: 34px;
< 	width: 34px;
< 	margin: 0 0 0 8px;
---
>       > .visibility {
>         height: 34px;
>         width: 34px;
>         margin: 0 0 0 8px;
824,827c1015,1018
< 	& + .localOnly {
< 		margin-left: 0 !important;
< 	}
< }
---
>         & + .localOnly {
>           margin-left: 0 !important;
>         }
>       }
829,832c1020,1023
< .localOnly {
< 	margin: 0 0 0 12px;
< 	opacity: 0.7;
< }
---
>       > .local-only {
>         margin: 0 0 0 12px;
>         opacity: 0.7;
>       }
834,841c1025,1032
< .previewButton {
< 	display: inline-block;
< 	padding: 0;
< 	margin: 0 8px 0 0;
< 	font-size: 16px;
< 	width: 34px;
< 	height: 34px;
< 	border-radius: 6px;
---
>       > .preview {
>         display: inline-block;
>         padding: 0;
>         margin: 0 8px 0 0;
>         font-size: 16px;
>         width: 34px;
>         height: 34px;
>         border-radius: 6px;
843,845c1034,1036
< 	&:hover {
< 		background: var(--X5);
< 	}
---
>         &:hover {
>           background: var(--X5);
>         }
847,850c1038,1041
< 	&.previewButtonActive {
< 		color: var(--accent);
< 	}
< }
---
>         &.active {
>           color: var(--accent);
>         }
>       }
852,854c1043,1050
< .submit {
< 	margin: 16px 16px 16px 0;
< 	vertical-align: bottom;
---
>       > .submit {
>         margin: 16px 16px 16px 0;
>         padding: 0 12px;
>         line-height: 34px;
>         font-weight: bold;
>         vertical-align: bottom;
>         border-radius: 4px;
>         font-size: 0.9em;
856,858c1052,1054
< 	&:disabled {
< 		opacity: 0.7;
< 	}
---
>         &:disabled {
>           opacity: 0.7;
>         }
860,862c1056,1061
< 	&.posting {
< 		cursor: wait;
< 	}
---
>         > i {
>           margin-left: 6px;
>         }
>       }
>     }
>   }
864,868c1063,1066
< 	&:not(:disabled):hover {
< 		> .inner {
< 			background: linear-gradient(90deg, var(--X8), var(--X8));
< 		}
< 	}
---
>   > .form {
>     > .preview {
>       padding: 16px;
>     }
870,875c1068,1070
< 	&:not(:disabled):active {
< 		> .inner {
< 			background: linear-gradient(90deg, var(--X8), var(--X8));
< 		}
< 	}
< }
---
>     > .with-quote {
>       margin: 0 0 8px 0;
>       color: var(--accent);
877,887c1072,1074
< .submitInner {
< 	padding: 0 12px;
< 	line-height: 34px;
< 	font-weight: bold;
< 	border-radius: 4px;
< 	font-size: 0.9em;
< 	min-width: 90px;
< 	box-sizing: border-box;
< 	color: var(--fgOnAccent);
< 	background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< }
---
>       > button {
>         padding: 4px 8px;
>         color: var(--accentAlpha04);
889,890c1076,1078
< .form {
< }
---
>         &:hover {
>           color: var(--accentAlpha06);
>         }
892,894c1080,1084
< .preview {
< 	padding: 16px 20px 0 20px;
< }
---
>         &:active {
>           color: var(--accentDarken30);
>         }
>       }
>     }
896,898c1086,1090
< .targetNote {
< 	padding: 0 20px 16px 20px;
< }
---
>     > .to-specified {
>       padding: 6px 24px;
>       margin-bottom: 8px;
>       overflow: auto;
>       white-space: nowrap;
900,903c1092,1095
< .withQuote {
< 	margin: 0 0 8px 0;
< 	color: var(--accent);
< }
---
>       > .visibleUsers {
>         display: inline;
>         top: -1px;
>         font-size: 14px;
905,910c1097,1100
< .toSpecified {
< 	padding: 6px 24px;
< 	margin-bottom: 8px;
< 	overflow: auto;
< 	white-space: nowrap;
< }
---
>         > button {
>           padding: 4px;
>           border-radius: 8px;
>         }
912,916c1102,1106
< .visibleUsers {
< 	display: inline;
< 	top: -1px;
< 	font-size: 14px;
< }
---
>         > span {
>           margin-right: 14px;
>           padding: 8px 0 8px 8px;
>           border-radius: 8px;
>           background: var(--X4);
918,923c1108,1113
< .visibleUser {
< 	margin-right: 14px;
< 	padding: 8px 0 8px 8px;
< 	border-radius: 8px;
< 	background: var(--X4);
< }
---
>           > button {
>             padding: 4px 8px;
>           }
>         }
>       }
>     }
925,927c1115,1117
< .hasNotSpecifiedMentions {
< 	margin: 0 20px 16px 20px;
< }
---
>     > .hasNotSpecifiedMentions {
>       margin: 0 20px 16px 20px;
>     }
929,942c1119,1132
< .cw,
< .hashtags,
< .text {
< 	display: block;
< 	box-sizing: border-box;
< 	padding: 0 24px;
< 	margin: 0;
< 	width: 100%;
< 	font-size: 16px;
< 	border: none;
< 	border-radius: 0;
< 	background: transparent;
< 	color: var(--fg);
< 	font-family: inherit;
---
>     > .cw,
>     > .hashtags,
>     > .text {
>       display: block;
>       box-sizing: border-box;
>       padding: 0 24px;
>       margin: 0;
>       width: 100%;
>       font-size: 16px;
>       border: none;
>       border-radius: 0;
>       background: transparent;
>       color: var(--fg);
>       font-family: inherit;
944,946c1134,1136
< 	&:focus {
< 		outline: none;
< 	}
---
>       &:focus {
>         outline: none;
>       }
948,951c1138,1141
< 	&:disabled {
< 		opacity: 0.5;
< 	}
< }
---
>       &:disabled {
>         opacity: 0.5;
>       }
>     }
953,957c1143,1147
< .cw {
< 	z-index: 1;
< 	padding-bottom: 8px;
< 	border-bottom: solid 0.5px var(--divider);
< }
---
>     > .cw {
>       z-index: 1;
>       padding-bottom: 8px;
>       border-bottom: solid 0.5px var(--divider);
>     }
959,964c1149,1154
< .hashtags {
< 	z-index: 1;
< 	padding-top: 8px;
< 	padding-bottom: 8px;
< 	border-top: solid 0.5px var(--divider);
< }
---
>     > .hashtags {
>       z-index: 1;
>       padding-top: 8px;
>       padding-bottom: 8px;
>       border-top: solid 0.5px var(--divider);
>     }
966,969c1156,1159
< .text {
< 	max-width: 100%;
< 	min-width: 100%;
< 	min-height: 90px;
---
>     > .text {
>       max-width: 100%;
>       min-width: 100%;
>       min-height: 90px;
971,974c1161,1164
< 	&.withCw {
< 		padding-top: 8px;
< 	}
< }
---
>       &.withCw {
>         padding-top: 8px;
>       }
>     }
976,978c1166,1167
< .footer {
< 	padding: 0 16px 16px 16px;
< }
---
>     > footer {
>       padding: 0 16px 16px 16px;
980,987c1169,1176
< .footerButton {
< 	display: inline-block;
< 	padding: 0;
< 	margin: 0;
< 	font-size: 1em;
< 	width: 46px;
< 	height: 46px;
< 	border-radius: 6px;
---
>       > button {
>         display: inline-block;
>         padding: 0;
>         margin: 0;
>         font-size: 16px;
>         width: 48px;
>         height: 48px;
>         border-radius: 6px;
989,991c1178,1180
< 	&:hover {
< 		background: var(--X5);
< 	}
---
>         &:hover {
>           background: var(--X5);
>         }
993,996c1182,1187
< 	&.footerButtonActive {
< 		color: var(--accent);
< 	}
< }
---
>         &.active {
>           color: var(--accent);
>         }
>       }
>     }
>   }
998,1000c1189,1191
< @container (max-width: 500px) {
< 	.header {
< 		height: 50px;
---
>   &.max-width_500px {
>     > header {
>       height: 50px;
1002,1005c1193,1196
< 		> .cancel {
< 			width: 50px;
< 			line-height: 50px;
< 		}
---
>       > .cancel {
>         width: 50px;
>         line-height: 50px;
>       }
1007,1010c1198,1201
< 		> .headerRight {
< 			> .textCount {
< 				line-height: 50px;
< 			}
---
>       > .right {
>         > .text-count {
>           line-height: 50px;
>         }
1012,1016c1203,1207
< 			> .submit {
< 				margin: 8px;
< 			}
< 		}
< 	}
---
>         > .submit {
>           margin: 8px;
>         }
>       }
>     }
1018,1020c1209,1212
< 	.toSpecified {
< 		padding: 6px 16px;
< 	}
---
>     > .form {
>       > .to-specified {
>         padding: 6px 16px;
>       }
1022,1026c1214,1218
< 	.cw,
< 	.hashtags,
< 	.text {
< 		padding: 0 16px;
< 	}
---
>       > .cw,
>       > .hashtags,
>       > .text {
>         padding: 0 16px;
>       }
1028,1030c1220,1222
< 	.text {
< 		min-height: 80px;
< 	}
---
>       > .text {
>         min-height: 80px;
>       }
1032,1035c1224,1228
< 	.footer {
< 		padding: 0 8px 8px 8px;
< 	}
< }
---
>       > footer {
>         padding: 0 8px 8px 8px;
>       }
>     }
>   }
1037,1042c1230,1240
< @container (max-width: 310px) {
< 	.footerButton {
< 		font-size: 14px;
< 		width: 44px;
< 		height: 44px;
< 	}
---
>   &.max-width_310px {
>     > .form {
>       > footer {
>         > button {
>           font-size: 14px;
>           width: 44px;
>           height: 44px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPostFormAttaches.vue RiricaV13/components/MkPostFormAttaches.vue
2,14c2,30
< <div v-show="props.modelValue.length != 0" class="skeikyzd">
< 	<Sortable :model-value="props.modelValue" class="files" item-key="id" :animation="150" :delay="100" :delay-on-touch-only="true" @update:model-value="v => emit('update:modelValue', v)">
< 		<template #item="{element}">
< 			<div class="file" @click="showFileMenu(element, $event)" @contextmenu.prevent="showFileMenu(element, $event)">
< 				<MkDriveFileThumbnail :data-id="element.id" class="thumbnail" :file="element" fit="cover"/>
< 				<div v-if="element.isSensitive" class="sensitive">
< 					<i class="ti ti-alert-triangle icon"></i>
< 				</div>
< 			</div>
< 		</template>
< 	</Sortable>
< 	<p class="remain">{{ 16 - props.modelValue.length }}/16</p>
< </div>
---
>   <div v-show="files.length != 0" class="skeikyzd">
>     <XDraggable
>       v-model="_files"
>       class="files"
>       item-key="id"
>       animation="150"
>       delay="100"
>       delay-on-touch-only="true"
>     >
>       <template #item="{ element }">
>         <div
>           class="file"
>           @click="showFileMenu(element, $event)"
>           @contextmenu.prevent="showFileMenu(element, $event)"
>         >
>           <MkDriveFileThumbnail
>             :data-id="element.id"
>             class="thumbnail"
>             :file="element"
>             fit="cover"
>           />
>           <div v-if="element.isSensitive" class="sensitive">
>             <i class="fas fa-exclamation-triangle icon"></i>
>           </div>
>         </div>
>       </template>
>     </XDraggable>
>     <p class="remain">{{ 16 - files.length }}/16</p>
>   </div>
17,22c33,36
< <script lang="ts" setup>
< import { defineAsyncComponent, watch } from 'vue';
< import MkDriveFileThumbnail from '@/components/MkDriveFileThumbnail.vue';
< import * as os from '@/os';
< import { deepClone } from '@/scripts/clone';
< import { i18n } from '@/i18n';
---
> <script lang="ts">
> import { defineComponent, defineAsyncComponent } from "vue";
> import MkDriveFileThumbnail from "@/components/MkDriveFileThumbnail.vue";
> import * as os from "@/os";
24c38,44
< const Sortable = defineAsyncComponent(() => import('vuedraggable').then(x => x.default));
---
> export default defineComponent({
>   components: {
>     XDraggable: defineAsyncComponent(() =>
>       import("vuedraggable").then((x) => x.default)
>     ),
>     MkDriveFileThumbnail,
>   },
26,29c46,55
< const props = defineProps<{
< 	modelValue: any[];
< 	detachMediaFn: () => void;
< }>();
---
>   props: {
>     files: {
>       type: Array,
>       required: true,
>     },
>     detachMediaFn: {
>       type: Function,
>       required: false,
>     },
>   },
31,36c57
< const emit = defineEmits<{
< 	(ev: 'update:modelValue', value: any[]): void;
< 	(ev: 'detach'): void;
< 	(ev: 'changeSensitive'): void;
< 	(ev: 'changeName'): void;
< }>();
---
>   emits: ["updated", "detach", "changeSensitive", "changeName"],
38c59,63
< let menuShowing = false;
---
>   data() {
>     return {
>       menu: null as Promise<null> | null,
>     };
>   },
40,46c65,74
< function detachMedia(id) {
< 	if (props.detachMediaFn) {
< 		props.detachMediaFn(id);
< 	} else {
< 		emit('detach', id);
< 	}
< }
---
>   computed: {
>     _files: {
>       get() {
>         return this.files;
>       },
>       set(value) {
>         this.$emit("updated", value);
>       },
>     },
>   },
48,70c76,106
< function toggleSensitive(file) {
< 	os.api('drive/files/update', {
< 		fileId: file.id,
< 		isSensitive: !file.isSensitive,
< 	}).then(() => {
< 		emit('changeSensitive', file, !file.isSensitive);
< 	});
< }
< async function rename(file) {
< 	const { canceled, result } = await os.inputText({
< 		title: i18n.ts.enterFileName,
< 		default: file.name,
< 		allowEmpty: false,
< 	});
< 	if (canceled) return;
< 	os.api('drive/files/update', {
< 		fileId: file.id,
< 		name: result,
< 	}).then(() => {
< 		emit('changeName', file, result);
< 		file.name = result;
< 	});
< }
---
>   methods: {
>     detachMedia(id) {
>       if (this.detachMediaFn) {
>         this.detachMediaFn(id);
>       } else {
>         this.$emit("detach", id);
>       }
>     },
>     toggleSensitive(file) {
>       os.api("drive/files/update", {
>         fileId: file.id,
>         isSensitive: !file.isSensitive,
>       }).then(() => {
>         this.$emit("changeSensitive", file, !file.isSensitive);
>       });
>     },
>     async rename(file) {
>       const { canceled, result } = await os.inputText({
>         title: this.$ts.enterFileName,
>         default: file.name,
>         allowEmpty: false,
>       });
>       if (canceled) return;
>       os.api("drive/files/update", {
>         fileId: file.id,
>         name: result,
>       }).then(() => {
>         this.$emit("changeName", file, result);
>         file.name = result;
>       });
>     },
72,87c108,133
< async function describe(file) {
< 	os.popup(defineAsyncComponent(() => import('@/components/MkFileCaptionEditWindow.vue')), {
< 		default: file.comment !== null ? file.comment : '',
< 		file: file,
< 	}, {
< 		done: caption => {
< 			let comment = caption.length === 0 ? null : caption;
< 			os.api('drive/files/update', {
< 				fileId: file.id,
< 				comment: comment,
< 			}).then(() => {
< 				file.comment = comment;
< 			});
< 		},
< 	}, 'closed');
< }
---
>     async describe(file) {
>       os.popup(
>         defineAsyncComponent(() => import("@/components/MkMediaCaption.vue")),
>         {
>           title: this.$ts.describeFile,
>           input: {
>             placeholder: this.$ts.inputNewDescription,
>             default: file.comment !== null ? file.comment : "",
>           },
>           image: file,
>         },
>         {
>           done: (result) => {
>             if (!result || result.canceled) return;
>             let comment = result.result.length === 0 ? null : result.result;
>             os.api("drive/files/update", {
>               fileId: file.id,
>               comment: comment,
>             }).then(() => {
>               file.comment = comment;
>             });
>           },
>         },
>         "closed"
>       );
>     },
89,109c135,176
< function showFileMenu(file, ev: MouseEvent) {
< 	if (menuShowing) return;
< 	os.popupMenu([{
< 		text: i18n.ts.renameFile,
< 		icon: 'ti ti-forms',
< 		action: () => { rename(file); },
< 	}, {
< 		text: file.isSensitive ? i18n.ts.unmarkAsSensitive : i18n.ts.markAsSensitive,
< 		icon: file.isSensitive ? 'ti ti-eye-off' : 'ti ti-eye',
< 		action: () => { toggleSensitive(file); },
< 	}, {
< 		text: i18n.ts.describeFile,
< 		icon: 'ti ti-text-caption',
< 		action: () => { describe(file); },
< 	}, {
< 		text: i18n.ts.attachCancel,
< 		icon: 'ti ti-circle-x',
< 		action: () => { detachMedia(file.id); },
< 	}], ev.currentTarget ?? ev.target).then(() => menuShowing = false);
< 	menuShowing = true;
< }
---
>     showFileMenu(file, ev: MouseEvent) {
>       if (this.menu) return;
>       this.menu = os
>         .popupMenu(
>           [
>             {
>               text: this.$ts.renameFile,
>               icon: "fas fa-i-cursor",
>               action: () => {
>                 this.rename(file);
>               },
>             },
>             {
>               text: file.isSensitive
>                 ? this.$ts.unmarkAsSensitive
>                 : this.$ts.markAsSensitive,
>               icon: file.isSensitive ? "fas fa-eye-slash" : "fas fa-eye",
>               action: () => {
>                 this.toggleSensitive(file);
>               },
>             },
>             {
>               text: this.$ts.describeFile,
>               icon: "fas fa-i-cursor",
>               action: () => {
>                 this.describe(file);
>               },
>             },
>             {
>               text: this.$ts.attachCancel,
>               icon: "fas fa-times-circle",
>               action: () => {
>                 this.detachMedia(file.id);
>               },
>             },
>           ],
>           ev.currentTarget ?? ev.target
>         )
>         .then(() => (this.menu = null));
>     },
>   },
> });
114,115c181,182
< 	padding: 8px 16px;
< 	position: relative;
---
>   padding: 8px 16px;
>   position: relative;
117,119c184,186
< 	> .files {
< 		display: flex;
< 		flex-wrap: wrap;
---
>   > .files {
>     display: flex;
>     flex-wrap: wrap;
121,128c188,195
< 		> .file {
< 			position: relative;
< 			width: 64px;
< 			height: 64px;
< 			margin-right: 4px;
< 			border-radius: 4px;
< 			overflow: hidden;
< 			cursor: move;
---
>     > .file {
>       position: relative;
>       width: 64px;
>       height: 64px;
>       margin-right: 4px;
>       border-radius: 4px;
>       overflow: hidden;
>       cursor: move;
130,132c197,199
< 			&:hover > .remove {
< 				display: block;
< 			}
---
>       &:hover > .remove {
>         display: block;
>       }
134,139c201,206
< 			> .thumbnail {
< 				width: 100%;
< 				height: 100%;
< 				z-index: 1;
< 				color: var(--fg);
< 			}
---
>       > .thumbnail {
>         width: 100%;
>         height: 100%;
>         z-index: 1;
>         color: var(--fg);
>       }
141,150c208,217
< 			> .sensitive {
< 				display: flex;
< 				position: absolute;
< 				width: 64px;
< 				height: 64px;
< 				top: 0;
< 				left: 0;
< 				z-index: 2;
< 				background: rgba(17, 17, 17, .7);
< 				color: #fff;
---
>       > .sensitive {
>         display: flex;
>         position: absolute;
>         width: 64px;
>         height: 64px;
>         top: 0;
>         left: 0;
>         z-index: 2;
>         background: rgba(17, 17, 17, 0.7);
>         color: #fff;
152,157c219,224
< 				> .icon {
< 					margin: auto;
< 				}
< 			}
< 		}
< 	}
---
>         > .icon {
>           margin: auto;
>         }
>       }
>     }
>   }
159,166c226,233
< 	> .remain {
< 		display: block;
< 		position: absolute;
< 		top: 8px;
< 		right: 8px;
< 		margin: 0;
< 		padding: 0;
< 	}
---
>   > .remain {
>     display: block;
>     position: absolute;
>     top: 8px;
>     right: 8px;
>     margin: 0;
>     padding: 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkPostFormDialog.vue RiricaV13/components/MkPostFormDialog.vue
2,4c2,14
< <MkModal ref="modal" :prefer-type="'dialog'" @click="modal.close()" @closed="onModalClosed()">
< 	<MkPostForm ref="form" style="margin: 0 auto auto auto;" v-bind="props" autofocus freeze-after-posted @posted="onPosted" @cancel="modal.close()" @esc="modal.close()"/>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :prefer-type="'dialog:top'"
>     @click="$refs.modal.close()"
>     @closed="$emit('closed')"
>   >
>     <MkPostForm
>       v-bind="$attrs"
>       @posted="$refs.modal.close()"
>       @cancel="$refs.modal.close()"
>       @esc="$refs.modal.close()"
>     />
>   </MkModal>
7,11c17,20
< <script lang="ts" setup>
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkModal from '@/components/MkModal.vue';
< import MkPostForm from '@/components/MkPostForm.vue';
---
> <script lang="ts">
> import { defineComponent } from "vue";
> import MkModal from "@/components/MkModal.vue";
> import MkPostForm from "@/components/MkPostForm.vue";
13,45c22,28
< const props = defineProps<{
< 	reply?: misskey.entities.Note;
< 	renote?: misskey.entities.Note;
< 	channel?: any; // TODO
< 	mention?: misskey.entities.User;
< 	specified?: misskey.entities.User;
< 	initialText?: string;
< 	initialVisibility?: typeof misskey.noteVisibilities;
< 	initialFiles?: misskey.entities.DriveFile[];
< 	initialLocalOnly?: boolean;
< 	initialVisibleUsers?: misskey.entities.User[];
< 	initialNote?: misskey.entities.Note;
< 	instant?: boolean;
< 	fixed?: boolean;
< 	autofocus?: boolean;
< }>();
< 
< const emit = defineEmits<{
< 	(ev: 'closed'): void;
< }>();
< 
< let modal = $shallowRef<InstanceType<typeof MkModal>>();
< let form = $shallowRef<InstanceType<typeof MkPostForm>>();
< 
< function onPosted() {
< 	modal.close({
< 		useSendAnimation: true,
< 	});
< }
< 
< function onModalClosed() {
< 	emit('closed');
< }
---
> export default defineComponent({
>   components: {
>     MkModal,
>     MkPostForm,
>   },
>   emits: ["closed"],
> });
Only in misskeyV13/packages/frontend/src/components: MkPushNotificationAllowButton.vue
Only in misskeyV13/packages/frontend/src/components: MkRadio.vue
Only in misskeyV13/packages/frontend/src/components: MkRadios.vue
Only in misskeyV13/packages/frontend/src/components: MkRange.vue
Only in misskeyV13/packages/frontend/src/components: MkReactedUsersDialog.vue
Only in misskeyV13/packages/frontend/src/components: MkReactionEffect.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkReactionIcon.vue RiricaV13/components/MkReactionIcon.vue
2c2,8
< <MkEmoji :emoji="reaction" :is-reaction="true" :normal="true" :no-style="noStyle"/>
---
>   <MkEmoji
>     :emoji="reaction"
>     :custom-emojis="customEmojis || []"
>     :is-reaction="true"
>     :normal="true"
>     :no-style="noStyle"
>   />
6c12
< import { } from 'vue';
---
> import {} from "vue";
9,10c15,17
< 	reaction: string;
< 	noStyle?: boolean;
---
>   reaction: string;
>   customEmojis?: any[]; // TODO
>   noStyle?: boolean;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkReactionTooltip.vue RiricaV13/components/MkReactionTooltip.vue
2,7c2,17
< <MkTooltip ref="tooltip" :showing="showing" :target-element="targetElement" :max-width="340" @closed="emit('closed')">
< 	<div :class="$style.root">
< 		<MkReactionIcon :reaction="reaction" :class="$style.icon" :no-style="true"/>
< 		<div :class="$style.name">{{ reaction.replace('@.', '') }}</div>
< 	</div>
< </MkTooltip>
---
>   <MkTooltip
>     ref="tooltip"
>     :target-element="targetElement"
>     :max-width="340"
>     @closed="emit('closed')"
>   >
>     <div class="beeadbfb">
>       <XReactionIcon
>         :reaction="reaction"
>         :custom-emojis="emojis"
>         class="icon"
>         :no-style="true"
>       />
>       <div class="name">{{ reaction.replace("@.", "") }}</div>
>     </div>
>   </MkTooltip>
11,13c21,23
< import { } from 'vue';
< import MkTooltip from './MkTooltip.vue';
< import MkReactionIcon from '@/components/MkReactionIcon.vue';
---
> import {} from "vue";
> import MkTooltip from "./MkTooltip.vue";
> import XReactionIcon from "@/components/MkReactionIcon.vue";
15,18c25,28
< defineProps<{
< 	showing: boolean;
< 	reaction: string;
< 	targetElement: HTMLElement;
---
> const props = defineProps<{
>   reaction: string;
>   emojis: any[]; // TODO
>   targetElement: HTMLElement;
22c32
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
26,29c36,38
< <style lang="scss" module>
< .root {
< 	text-align: center;
< }
---
> <style lang="scss" scoped>
> .beeadbfb {
>   text-align: center;
31,37c40,45
< .icon {
< 	display: block;
< 	width: 60px;
< 	font-size: 60px; // unicodeな絵文字についてはwidthが効かないため
< 	margin: 0 auto;
< 	object-fit: contain;
< }
---
>   > .icon {
>     display: block;
>     width: 60px;
>     font-size: 60px; // unicodeな絵文字についてはwidthが効かないため
>     margin: 0 auto;
>   }
39,40c47,49
< .name {
< 	font-size: 0.9em;
---
>   > .name {
>     font-size: 0.9em;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkReactionsViewer.details.vue RiricaV13/components/MkReactionsViewer.details.vue
2,16c2,26
< <MkTooltip ref="tooltip" :showing="showing" :target-element="targetElement" :max-width="340" @closed="emit('closed')">
< 	<div :class="$style.root">
< 		<div :class="$style.reaction">
< 			<MkReactionIcon :reaction="reaction" :class="$style.reactionIcon" :no-style="true"/>
< 			<div :class="$style.reactionName">{{ getReactionName(reaction) }}</div>
< 		</div>
< 		<div :class="$style.users">
< 			<div v-for="u in users" :key="u.id" :class="$style.user">
< 				<MkAvatar :class="$style.avatar" :user="u"/>
< 				<MkUserName :user="u" :nowrap="true"/>
< 			</div>
< 			<div v-if="users.length > 10">+{{ count - 10 }}</div>
< 		</div>
< 	</div>
< </MkTooltip>
---
>   <MkTooltip
>     ref="tooltip"
>     :target-element="targetElement"
>     :max-width="340"
>     @closed="emit('closed')"
>   >
>     <div class="bqxuuuey">
>       <div class="reaction">
>         <XReactionIcon
>           :reaction="reaction"
>           :custom-emojis="emojis"
>           class="icon"
>           :no-style="true"
>         />
>         <div class="name">{{ reaction.replace("@.", "") }}</div>
>       </div>
>       <div class="users">
>         <div v-for="u in users" :key="u.id" class="user">
>           <MkAvatar class="avatar" :user="u" />
>           <MkUserName class="name" :user="u" :nowrap="true" />
>         </div>
>         <div v-if="users.length > 10" class="omitted">+{{ count - 10 }}</div>
>       </div>
>     </div>
>   </MkTooltip>
20,23c30,32
< import { } from 'vue';
< import MkTooltip from './MkTooltip.vue';
< import MkReactionIcon from '@/components/MkReactionIcon.vue';
< import { getEmojiName } from '@/scripts/emojilist';
---
> import {} from "vue";
> import MkTooltip from "./MkTooltip.vue";
> import XReactionIcon from "@/components/MkReactionIcon.vue";
25,30c34,39
< defineProps<{
< 	showing: boolean;
< 	reaction: string;
< 	users: any[]; // TODO
< 	count: number;
< 	targetElement: HTMLElement;
---
> const props = defineProps<{
>   reaction: string;
>   users: any[]; // TODO
>   count: number;
>   emojis: any[]; // TODO
>   targetElement: HTMLElement;
34c43
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
36,43d44
< 
< function getReactionName(reaction: string): string {
< 	const trimLocal = reaction.replace('@.', '');
< 	if (trimLocal.startsWith(':')) {
< 		return trimLocal;
< 	}
< 	return getEmojiName(reaction) ?? reaction;
< }
46,49c47,49
< <style lang="scss" module>
< .root {
< 	display: flex;
< }
---
> <style lang="scss" scoped>
> .bqxuuuey {
>   display: flex;
51,54c51,53
< .reaction {
< 	max-width: 100px;
< 	text-align: center;
< }
---
>   > .reaction {
>     max-width: 100px;
>     text-align: center;
56,62c55,60
< .reactionIcon {
< 	display: block;
< 	width: 60px;
< 	font-size: 60px; // unicodeな絵文字についてはwidthが効かないため
< 	object-fit: contain;
< 	margin: 0 auto;
< }
---
>     > .icon {
>       display: block;
>       width: 60px;
>       font-size: 60px; // unicodeな絵文字についてはwidthが効かないため
>       margin: 0 auto;
>     }
64,66c62,65
< .reactionName {
< 	font-size: 1em;
< }
---
>     > .name {
>       font-size: 1em;
>     }
>   }
68,77c67,75
< .users {
< 	flex: 1;
< 	min-width: 0;
< 	font-size: 0.95em;
< 	border-left: solid 0.5px var(--divider);
< 	padding-left: 10px;
< 	margin-left: 10px;
< 	margin-right: 14px;
< 	text-align: left;
< }
---
>   > .users {
>     flex: 1;
>     min-width: 0;
>     font-size: 0.95em;
>     border-left: solid 0.5px var(--divider);
>     padding-left: 10px;
>     margin-left: 10px;
>     margin-right: 14px;
>     text-align: left;
79,83c77,81
< .user {
< 	line-height: 24px;
< 	white-space: nowrap;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
---
>     > .user {
>       line-height: 24px;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
85,88c83,85
< 	&:not(:last-child) {
< 		margin-bottom: 3px;
< 	}
< }
---
>       &:not(:last-child) {
>         margin-bottom: 3px;
>       }
90,93c87,93
< .avatar {
< 	width: 24px;
< 	height: 24px;
< 	margin-right: 3px;
---
>       > .avatar {
>         width: 24px;
>         height: 24px;
>         margin-right: 3px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkReactionsViewer.reaction.vue RiricaV13/components/MkReactionsViewer.reaction.vue
2,11c2,16
< <button
< 	ref="buttonEl"
< 	v-ripple="canToggle"
< 	class="_button"
< 	:class="[$style.root, { [$style.reacted]: note.myReaction == reaction, [$style.canToggle]: canToggle }]"
< 	@click="toggleReaction()"
< >
< 	<MkReactionIcon :class="$style.icon" :reaction="reaction"/>
< 	<span :class="$style.count">{{ count }}</span>
< </button>
---
>   <button
>     v-if="count > 0"
>     ref="buttonRef"
>     v-ripple="canToggle"
>     class="hkzvhatu _button"
>     :class="{ reacted: note.myReaction == reaction, canToggle }"
>     @click="toggleReaction()"
>   >
>     <XReactionIcon
>       class="icon"
>       :reaction="reaction"
>       :custom-emojis="note.emojis"
>     />
>     <span class="count">{{ count }}</span>
>   </button>
15,24c20,26
< import { computed, onMounted, ref, shallowRef, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import XDetails from '@/components/MkReactionsViewer.details.vue';
< import MkReactionIcon from '@/components/MkReactionIcon.vue';
< import * as os from '@/os';
< import { useTooltip } from '@/scripts/use-tooltip';
< import { $i } from '@/account';
< import MkReactionEffect from '@/components/MkReactionEffect.vue';
< import { claimAchievement } from '@/scripts/achievements';
< import { defaultStore } from '@/store';
---
> import { computed, onMounted, ref, watch } from "vue";
> import * as misskey from "misskey-js";
> import XDetails from "@/components/MkReactionsViewer.details.vue";
> import XReactionIcon from "@/components/MkReactionIcon.vue";
> import * as os from "@/os";
> import { useTooltip } from "@/scripts/use-tooltip";
> import { $i } from "@/account";
27,30c29,32
< 	reaction: string;
< 	count: number;
< 	isInitial: boolean;
< 	note: misskey.entities.Note;
---
>   reaction: string;
>   count: number;
>   isInitial: boolean;
>   note: misskey.entities.Note;
33c35
< const buttonEl = shallowRef<HTMLElement>();
---
> const buttonRef = ref<HTMLElement>();
38c40
< 	if (!canToggle.value) return;
---
>   if (!canToggle.value) return;
40,60c42,59
< 	const oldReaction = props.note.myReaction;
< 	if (oldReaction) {
< 		os.api('notes/reactions/delete', {
< 			noteId: props.note.id,
< 		}).then(() => {
< 			if (oldReaction !== props.reaction) {
< 				os.api('notes/reactions/create', {
< 					noteId: props.note.id,
< 					reaction: props.reaction,
< 				});
< 			}
< 		});
< 	} else {
< 		os.api('notes/reactions/create', {
< 			noteId: props.note.id,
< 			reaction: props.reaction,
< 		});
< 		if (props.note.text && props.note.text.length > 100 && (Date.now() - new Date(props.note.createdAt).getTime() < 1000 * 3)) {
< 			claimAchievement('reactWithoutRead');
< 		}
< 	}
---
>   const oldReaction = props.note.myReaction;
>   if (oldReaction) {
>     os.api("notes/reactions/delete", {
>       noteId: props.note.id,
>     }).then(() => {
>       if (oldReaction !== props.reaction) {
>         os.api("notes/reactions/create", {
>           noteId: props.note.id,
>           reaction: props.reaction,
>         });
>       }
>     });
>   } else {
>     os.api("notes/reactions/create", {
>       noteId: props.note.id,
>       reaction: props.reaction,
>     });
>   }
64,65c63
< 	if (document.hidden) return;
< 	if (!defaultStore.state.animation) return;
---
>   if (document.hidden) return;
67,70c65
< 	const rect = buttonEl.value.getBoundingClientRect();
< 	const x = rect.left + 16;
< 	const y = rect.top + (buttonEl.value.offsetHeight / 2);
< 	os.popup(MkReactionEffect, { reaction: props.reaction, x, y }, {}, 'end');
---
>   // TODO: 新しくリアクションが付いたことが視覚的に分かりやすいアニメーション
73,75c68,73
< watch(() => props.count, (newCount, oldCount) => {
< 	if (oldCount < newCount) anime();
< });
---
> watch(
>   () => props.count,
>   (newCount, oldCount) => {
>     if (oldCount < newCount) anime();
>   }
> );
78c76
< 	if (!props.isInitial) anime();
---
>   if (!props.isInitial) anime();
81,87c79,87
< useTooltip(buttonEl, async (showing) => {
< 	const reactions = await os.apiGet('notes/reactions', {
< 		noteId: props.note.id,
< 		type: props.reaction,
< 		limit: 11,
< 		_cacheKey_: props.count,
< 	});
---
> useTooltip(
>   buttonRef,
>   async (showing) => {
>     const reactions = await os.apiGet("notes/reactions", {
>       noteId: props.note.id,
>       type: props.reaction,
>       limit: 11,
>       _cacheKey_: props.count,
>     });
89c89
< 	const users = reactions.map(x => x.user);
---
>     const users = reactions.map((x) => x.user);
91,98c91,106
< 	os.popup(XDetails, {
< 		showing,
< 		reaction: props.reaction,
< 		users,
< 		count: props.count,
< 		targetElement: buttonEl.value,
< 	}, {}, 'closed');
< }, 100);
---
>     os.popup(
>       XDetails,
>       {
>         showing,
>         reaction: props.reaction,
>         emojis: props.note.emojis,
>         users,
>         count: props.count,
>         targetElement: buttonRef.value,
>       },
>       {},
>       "closed"
>     );
>   },
>   100
> );
101,107c109,115
< <style lang="scss" module>
< .root {
< 	display: inline-block;
< 	height: 32px;
< 	margin: 2px;
< 	padding: 0 6px;
< 	border-radius: 4px;
---
> <style lang="scss" scoped>
> .hkzvhatu {
>   display: inline-block;
>   height: 32px;
>   margin: 2px;
>   padding: 0 6px;
>   border-radius: 4px;
109,110c117,118
< 	&.canToggle {
< 		background: rgba(0, 0, 0, 0.05);
---
>   &.canToggle {
>     background: rgba(0, 0, 0, 0.05);
112,115c120,123
< 		&:hover {
< 			background: rgba(0, 0, 0, 0.1);
< 		}
< 	}
---
>     &:hover {
>       background: rgba(0, 0, 0, 0.1);
>     }
>   }
117,119c125,127
< 	&:not(.canToggle) {
< 		cursor: default;
< 	}
---
>   &:not(.canToggle) {
>     cursor: default;
>   }
121,122c129,130
< 	&.reacted {
< 		background: var(--accent);
---
>   &.reacted {
>     background: var(--accent);
124,126c132,134
< 		&:hover {
< 			background: var(--accent);
< 		}
---
>     &:hover {
>       background: var(--accent);
>     }
128,130c136,138
< 		> .count {
< 			color: var(--fgOnAccent);
< 		}
---
>     > .count {
>       color: var(--fgOnAccent);
>     }
132,136c140,143
< 		> .icon {
< 			filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.5));
< 		}
< 	}
< }
---
>     > .icon {
>       filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.5));
>     }
>   }
138,141c145,149
< .count {
< 	font-size: 0.9em;
< 	line-height: 32px;
< 	margin: 0 0 0 4px;
---
>   > .count {
>     font-size: 0.9em;
>     line-height: 32px;
>     margin: 0 0 0 4px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkReactionsViewer.vue RiricaV13/components/MkReactionsViewer.vue
2,11c2,11
< <TransitionGroup
< 	:enter-active-class="$store.state.animation ? $style.transition_x_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_x_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_x_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_x_leaveTo : ''"
< 	:move-class="$store.state.animation ? $style.transition_x_move : ''"
< 	tag="div" :class="$style.root"
< >
< 	<XReaction v-for="(count, reaction) in note.reactions" :key="reaction" :reaction="reaction" :count="count" :is-initial="initialReactions.has(reaction)" :note="note"/>
< </TransitionGroup>
---
>   <div class="tdflqwzn" :class="{ isMe }">
>     <XReaction
>       v-for="(count, reaction) in note.reactions"
>       :key="reaction"
>       :reaction="reaction"
>       :count="count"
>       :is-initial="initialReactions.has(reaction)"
>       :note="note"
>     />
>   </div>
15,18c15,18
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import { $i } from '@/account';
< import XReaction from '@/components/MkReactionsViewer.reaction.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import { $i } from "@/account";
> import XReaction from "@/components/MkReactionsViewer.reaction.vue";
21c21
< 	note: misskey.entities.Note;
---
>   note: misskey.entities.Note;
29,42c29,31
< <style lang="scss" module>
< .transition_x_move,
< .transition_x_enterActive,
< .transition_x_leaveActive {
< 	transition: opacity 0.2s cubic-bezier(0,.5,.5,1), transform 0.2s cubic-bezier(0,.5,.5,1) !important;
< }
< .transition_x_enterFrom,
< .transition_x_leaveTo {
< 	opacity: 0;
< 	transform: scale(0.7);
< }
< .transition_x_leaveActive {
< 	position: absolute;
< }
---
> <style lang="scss" scoped>
> .tdflqwzn {
>   margin: 4px -2px 0 -2px;
44,45c33,35
< .root {
< 	margin: 4px -2px 0 -2px;
---
>   &:empty {
>     display: none;
>   }
47,49c37,41
< 	&:empty {
< 		display: none;
< 	}
---
>   &.isMe {
>     > span {
>       cursor: default !important;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkRemoteCaution.vue RiricaV13/components/MkRemoteCaution.vue
2c2,8
< <div :class="$style.root"><i class="ti ti-alert-triangle" style="margin-right: 8px;"></i>{{ i18n.ts.remoteUserCaution }}<a :class="$style.link" :href="href" rel="nofollow noopener" target="_blank">{{ i18n.ts.showOnRemote }}</a></div>
---
>   <div class="jmgmzlwq _block">
>     <i class="fas fa-exclamation-triangle" style="margin-right: 8px"></i
>     >{{ i18n.ts.remoteUserCaution
>     }}<a class="link" :href="href" rel="nofollow noopener" target="_blank">{{
>       i18n.ts.showOnRemote
>     }}</a>
>   </div>
6c12
< import { i18n } from '@/i18n';
---
> import { i18n } from "@/i18n";
9c15
< 	href: string;
---
>   href: string;
13,21c19,24
< <style lang="scss" module>
< .root {
< 	font-size: 0.8em;
< 	padding: 16px;
< 	background: var(--infoWarnBg);
< 	color: var(--infoWarnFg);
< 	border-radius: var(--radius);
< 	overflow: clip;
< }
---
> <style lang="scss" scoped>
> .jmgmzlwq {
>   font-size: 0.8em;
>   padding: 16px;
>   background: var(--infoWarnBg);
>   color: var(--infoWarnFg);
23,25c26,29
< .link {
< 	margin-left: 4px;
< 	color: var(--accent);
---
>   > .link {
>     margin-left: 4px;
>     color: var(--accent);
>   }
Only in RiricaV13/components: MkRenoteButton.vue
Only in misskeyV13/packages/frontend/src/components: MkRetentionHeatmap.vue
Only in RiricaV13/components: MkRipple.vue
Only in misskeyV13/packages/frontend/src/components: MkRippleEffect.vue
Only in misskeyV13/packages/frontend/src/components: MkRolePreview.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSample.vue RiricaV13/components/MkSample.vue
2,27c2,27
< <div class="">
< 	<div class="">
< 		<MkInput v-model="text">
< 			<template #label>Text</template>
< 		</MkInput>
< 		<MkSwitch v-model="flag">
< 			<span>Switch is now {{ flag ? 'on' : 'off' }}</span>
< 		</MkSwitch>
< 		<div style="margin: 32px 0;">
< 			<MkRadio v-model="radio" value="misskey">Misskey</MkRadio>
< 			<MkRadio v-model="radio" value="mastodon">Mastodon</MkRadio>
< 			<MkRadio v-model="radio" value="pleroma">Pleroma</MkRadio>
< 		</div>
< 		<MkButton inline>This is</MkButton>
< 		<MkButton inline primary>the button</MkButton>
< 	</div>
< 	<div class="" style="pointer-events: none;">
< 		<Mfm :text="mfm"/>
< 	</div>
< 	<div class="">
< 		<MkButton inline primary @click="openMenu">Open menu</MkButton>
< 		<MkButton inline primary @click="openDialog">Open dialog</MkButton>
< 		<MkButton inline primary @click="openForm">Open form</MkButton>
< 		<MkButton inline primary @click="openDrive">Open drive</MkButton>
< 	</div>
< </div>
---
>   <div class="_card">
>     <div class="_content">
>       <MkInput v-model="text">
>         <template #label>Text</template>
>       </MkInput>
>       <MkSwitch v-model="flag">
>         <span>Switch is now {{ flag ? "on" : "off" }}</span>
>       </MkSwitch>
>       <div style="margin: 32px 0">
>         <MkRadio v-model="radio" value="misskey">Misskey</MkRadio>
>         <MkRadio v-model="radio" value="mastodon">Mastodon</MkRadio>
>         <MkRadio v-model="radio" value="pleroma">Pleroma</MkRadio>
>       </div>
>       <MkButton inline>This is</MkButton>
>       <MkButton inline primary>the button</MkButton>
>     </div>
>     <div class="_content" style="pointer-events: none">
>       <Mfm :text="mfm" />
>     </div>
>     <div class="_content">
>       <MkButton inline primary @click="openMenu">Open menu</MkButton>
>       <MkButton inline primary @click="openDialog">Open dialog</MkButton>
>       <MkButton inline primary @click="openForm">Open form</MkButton>
>       <MkButton inline primary @click="openDrive">Open drive</MkButton>
>     </div>
>   </div>
31,38c31,38
< import { defineComponent } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkRadio from '@/components/MkRadio.vue';
< import * as os from '@/os';
< import * as config from '@/config';
---
> import { defineComponent } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkRadio from "@/components/form/radio.vue";
> import * as os from "@/os";
> import * as config from "@/config";
41,47c41,47
< 	components: {
< 		MkButton,
< 		MkInput,
< 		MkSwitch,
< 		MkTextarea,
< 		MkRadio,
< 	},
---
>   components: {
>     MkButton,
>     MkInput,
>     MkSwitch,
>     MkTextarea,
>     MkRadio,
>   },
49,56c49,60
< 	data() {
< 		return {
< 			text: '',
< 			flag: true,
< 			radio: 'misskey',
< 			mfm: `Hello world! This is an @example mention. BTW you are @${this.$i ? this.$i.username : 'guest'}.\nAlso, here is ${config.url} and [example link](${config.url}). for more details, see https://example.com.\nAs you know #misskey is open-source software.`,
< 		};
< 	},
---
>   data() {
>     return {
>       text: "",
>       flag: true,
>       radio: "misskey",
>       mfm: `Hello world! This is an @example mention. BTW you are @${
>         this.$i ? this.$i.username : "guest"
>       }.\nAlso, here is ${config.url} and [example link](${
>         config.url
>       }). for more details, see https://example.com.\nAs you know #misskey is open-source software.`,
>     };
>   },
58,65c62,69
< 	methods: {
< 		async openDialog() {
< 			os.alert({
< 				type: 'warning',
< 				title: 'Oh my Aichan',
< 				text: 'Lorem ipsum dolor sit amet, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.',
< 			});
< 		},
---
>   methods: {
>     async openDialog() {
>       os.alert({
>         type: "warning",
>         title: "Oh my Aichan",
>         text: "Lorem ipsum dolor sit amet, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
>       });
>     },
67,85c71,89
< 		async openForm() {
< 			os.form('Example form', {
< 				foo: {
< 					type: 'boolean',
< 					default: true,
< 					label: 'This is a boolean property',
< 				},
< 				bar: {
< 					type: 'number',
< 					default: 300,
< 					label: 'This is a number property',
< 				},
< 				baz: {
< 					type: 'string',
< 					default: 'Misskey makes you happy.',
< 					label: 'This is a string property',
< 				},
< 			});
< 		},
---
>     async openForm() {
>       os.form("Example form", {
>         foo: {
>           type: "boolean",
>           default: true,
>           label: "This is a boolean property",
>         },
>         bar: {
>           type: "number",
>           default: 300,
>           label: "This is a number property",
>         },
>         baz: {
>           type: "string",
>           default: "Misskey makes you happy.",
>           label: "This is a string property",
>         },
>       });
>     },
87,89c91,93
< 		async openDrive() {
< 			os.selectDriveFile();
< 		},
---
>     async openDrive() {
>       os.selectDriveFile();
>     },
91,93c95,97
< 		async selectUser() {
< 			os.selectUser();
< 		},
---
>     async selectUser() {
>       os.selectUser();
>     },
95,114c99,128
< 		async openMenu(ev) {
< 			os.popupMenu([{
< 				type: 'label',
< 				text: 'Fruits',
< 			}, {
< 				text: 'Create some apples',
< 				action: () => {},
< 			}, {
< 				text: 'Read some oranges',
< 				action: () => {},
< 			}, {
< 				text: 'Update some melons',
< 				action: () => {},
< 			}, null, {
< 				text: 'Delete some bananas',
< 				danger: true,
< 				action: () => {},
< 			}], ev.currentTarget ?? ev.target);
< 		},
< 	},
---
>     async openMenu(ev) {
>       os.popupMenu(
>         [
>           {
>             type: "label",
>             text: "Fruits",
>           },
>           {
>             text: "Create some apples",
>             action: () => {},
>           },
>           {
>             text: "Read some oranges",
>             action: () => {},
>           },
>           {
>             text: "Update some melons",
>             action: () => {},
>           },
>           null,
>           {
>             text: "Delete some bananas",
>             danger: true,
>             action: () => {},
>           },
>         ],
>         ev.currentTarget ?? ev.target
>       );
>     },
>   },
Only in misskeyV13/packages/frontend/src/components: MkSelect.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSignin.vue RiricaV13/components/MkSignin.vue
2,17c2,49
< <form class="eppvobhk" :class="{ signing, totpLogin }" @submit.prevent="onSubmit">
< 	<div class="auth _gaps_m">
< 		<div v-show="withAvatar" class="avatar" :style="{ backgroundImage: user ? `url('${ user.avatarUrl }')` : null, marginBottom: message ? '1.5em' : null }"></div>
< 		<MkInfo v-if="message">
< 			{{ message }}
< 		</MkInfo>
< 		<div v-if="!totpLogin" class="normal-signin _gaps_m">
< 			<MkInput v-model="username" :placeholder="i18n.ts.username" type="text" pattern="^[a-zA-Z0-9_]+$" :spellcheck="false" autocomplete="username" autofocus required data-cy-signin-username @update:model-value="onUsernameChange">
< 				<template #prefix>@</template>
< 				<template #suffix>@{{ host }}</template>
< 			</MkInput>
< 			<MkInput v-if="!user || user && !user.usePasswordLessLogin" v-model="password" :placeholder="i18n.ts.password" type="password" :with-password-toggle="true" required data-cy-signin-password>
< 				<template #prefix><i class="ti ti-lock"></i></template>
< 				<template #caption><button class="_textButton" type="button" @click="resetPassword">{{ i18n.ts.forgotPassword }}</button></template>
< 			</MkInput>
< 			<MkButton type="submit" large primary rounded :disabled="signing" style="margin: 0 auto;">{{ signing ? i18n.ts.loggingIn : i18n.ts.login }}</MkButton>
---
> <MkImageViewer v-if="howto1" :image="{ url: '/client-assets/img/howto1.jpg'}" @close="howto1 = false"/>
> <MkImageViewer v-if="howto2" :image="{ url: '/client-assets/img/howto2.jpg'}" @close="howto2 = false"/>
> <form
> 	class="eppvobhk _monolithic_"
> 	:class="{ signing, totpLogin }"
> 	@submit.prevent="onSubmit"
> >
> 	<div class="auth _section _formRoot">
> 		<div class="normal-signin">
> 			{{ i18n.ts.ririca.instance }}
> 			<Select v-model="instanceUrl" large :model-value="instances[0]?.url">
> 				<option value="other">{{ i18n.ts.ririca.selectInstanceYourself }}</option>
> 				<option
> 					v-for="(instance, i) in instances" :key="instance.url" :value="instance.url"
> 					:selected="i === 0"
> 				>
> 					{{ instance.name }}
> 				</option>
> 			</Select>
> 			<template v-if="instanceUrl === 'other'">
> 				URL
> 				<MkInput
> 
> 					v-model="instanceUrlOther"
> 					:spellcheck="false"
> 					autofocus
> 					required
> 				/>
> 			</template>
> 
> 
> 			{{ i18n.ts.ririca.accessToken }}
> 			<MkInput
> 				v-model="token"
> 				:spellcheck="false"
> 				autofocus
> 				required
> 				data-cy-signin-username
> 			></MkInput>
> 			<MkButton
> 				class="_formBlock"
> 				type="submit"
> 				primary
> 				:disabled="signing"
> 				style="margin: 0 auto"
> 			>
> 				{{ signing ? i18n.ts.loggingIn : i18n.ts.login }}
> 			</MkButton>
19,40c51,53
< 		<div v-if="totpLogin" class="2fa-signin" :class="{ securityKeys: user && user.securityKeys }">
< 			<div v-if="user && user.securityKeys" class="twofa-group tap-group">
< 				<p>{{ i18n.ts.tapSecurityKey }}</p>
< 				<MkButton v-if="!queryingKey" @click="queryKey">
< 					{{ i18n.ts.retry }}
< 				</MkButton>
< 			</div>
< 			<div v-if="user && user.securityKeys" class="or-hr">
< 				<p class="or-msg">{{ i18n.ts.or }}</p>
< 			</div>
< 			<div class="twofa-group totp-group">
< 				<p style="margin-bottom:0;">{{ i18n.ts.twoStepAuthentication }}</p>
< 				<MkInput v-if="user && user.usePasswordLessLogin" v-model="password" type="password" :with-password-toggle="true" required>
< 					<template #label>{{ i18n.ts.password }}</template>
< 					<template #prefix><i class="ti ti-lock"></i></template>
< 				</MkInput>
< 				<MkInput v-model="token" type="text" pattern="^[0-9]{6}$" autocomplete="off" :spellcheck="false" required>
< 					<template #label>{{ i18n.ts.token }}</template>
< 					<template #prefix><i class="ti ti-123"></i></template>
< 				</MkInput>
< 				<MkButton type="submit" :disabled="signing" large primary rounded style="margin: 0 auto;">{{ signing ? i18n.ts.loggingIn : i18n.ts.login }}</MkButton>
< 			</div>
---
> 
> 		<div style="display: flex; justify-content: center;">
> 			<a href="https://misskey.io/notes/99l9jqqun2" target="_blank" style="color: var(--link); text-align: center">{{ i18n.ts.ririca.howToCreateToken }}</a>
43,47d55
< 	<div class="social">
< 		<a v-if="meta && meta.enableTwitterIntegration" class="_borderButton _margin" :href="`${apiUrl}/signin/twitter`"><i class="ti ti-brand-twitter" style="margin-right: 4px;"></i>{{ $t('signinWith', { x: 'Twitter' }) }}</a>
< 		<a v-if="meta && meta.enableGithubIntegration" class="_borderButton _margin" :href="`${apiUrl}/signin/github`"><i class="ti ti-brand-github" style="margin-right: 4px;"></i>{{ $t('signinWith', { x: 'GitHub' }) }}</a>
< 		<a v-if="meta && meta.enableDiscordIntegration" class="_borderButton _margin" :href="`${apiUrl}/signin/discord`"><i class="ti ti-brand-discord" style="margin-right: 4px;"></i>{{ $t('signinWith', { x: 'Discord' }) }}</a>
< 	</div>
52,63c60,72
< import { defineAsyncComponent } from 'vue';
< import { toUnicode } from 'punycode/';
< import { showSuspendedDialog } from '../scripts/show-suspended-dialog';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import { apiUrl, host as configHost } from '@/config';
< import { byteify, hexify } from '@/scripts/2fa';
< import * as os from '@/os';
< import { login } from '@/account';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import { defineAsyncComponent } from "vue";
> import { toUnicode } from "punycode/";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import MkMediaImage from "@/components/MkMediaImage.vue";
> import MkImageViewer from "@/components/MkImageViewer.vue";
> import * as os from "@/os";
> import { login } from "@/account";
> import { showSuspendedDialog } from "../scripts/show-suspended-dialog";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
> import Select from "@/components/form/select.vue";
67,70c76,78
< let username = $ref('');
< let password = $ref('');
< let token = $ref('');
< let host = $ref(toUnicode(configHost));
---
> let username = $ref("");
> let password = $ref("");
> let token = $ref("");
76a85,86
> const instanceUrl = $ref("")
> const instanceUrlOther = $ref("")
79a90,92
> const howto1 = $ref(false)
> const howto2 = $ref(false)
> 
81c94
< 	(ev: 'login', v: any): void;
---
>   (ev: "login", v: any): void;
85,99c98,112
< 	withAvatar: {
< 		type: Boolean,
< 		required: false,
< 		default: true,
< 	},
< 	autoSet: {
< 		type: Boolean,
< 		required: false,
< 		default: false,
< 	},
< 	message: {
< 		type: String,
< 		required: false,
< 		default: '',
< 	},
---
>   withAvatar: {
>     type: Boolean,
>     required: false,
>     default: true,
>   },
>   autoSet: {
>     type: Boolean,
>     required: false,
>     default: false,
>   },
>   message: {
>     type: String,
>     required: false,
>     default: "",
>   },
103,109c116,125
< 	os.api('users/show', {
< 		username: username,
< 	}).then(userResponse => {
< 		user = userResponse;
< 	}, () => {
< 		user = null;
< 	});
---
>   os.api("users/show", {
>     username: username,
>   }).then(
>     (userResponse) => {
>       user = userResponse;
>     },
>     () => {
>       user = null;
>     }
>   );
112,115c128,131
< function onLogin(res) {
< 	if (props.autoSet) {
< 		return login(res.i);
< 	}
---
> function onLogin(res: any) {
>   if (props.autoSet) {
>     return login(res.i, res.instance);
>   }
118,158c134,141
< function queryKey() {
< 	queryingKey = true;
< 	return navigator.credentials.get({
< 		publicKey: {
< 			challenge: byteify(challengeData.challenge, 'base64'),
< 			allowCredentials: challengeData.securityKeys.map(key => ({
< 				id: byteify(key.id, 'hex'),
< 				type: 'public-key',
< 				transports: ['usb', 'nfc', 'ble', 'internal'],
< 			})),
< 			timeout: 60 * 1000,
< 		},
< 	}).catch(() => {
< 		queryingKey = false;
< 		return Promise.reject(null);
< 	}).then(credential => {
< 		queryingKey = false;
< 		signing = true;
< 		return os.api('signin', {
< 			username,
< 			password,
< 			signature: hexify(credential.response.signature),
< 			authenticatorData: hexify(credential.response.authenticatorData),
< 			clientDataJSON: hexify(credential.response.clientDataJSON),
< 			credentialId: credential.id,
< 			challengeId: challengeData.challengeId,
< 			'hcaptcha-response': hCaptchaResponse,
< 			'g-recaptcha-response': reCaptchaResponse,
< 		});
< 	}).then(res => {
< 		emit('login', res);
< 		return onLogin(res);
< 	}).catch(err => {
< 		if (err === null) return;
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.signinFailed,
< 		});
< 		signing = false;
< 	});
< }
---
> const instanceUrlResult = $computed(() => {
>   if(instanceUrl === 'other'){
>     // うっかりhttps://を入れてもreplaceされるから大丈夫
>     // new URL.origin
>     return new URL("https://" + instanceUrlOther.replace("https://", "")).origin
>   }
>   return "https://" + instanceUrl
> })
161,191c144,149
< 	signing = true;
< 	console.log('submit');
< 	if (!totpLogin && user && user.twoFactorEnabled) {
< 		if (window.PublicKeyCredential && user.securityKeys) {
< 			os.api('signin', {
< 				username,
< 				password,
< 				'hcaptcha-response': hCaptchaResponse,
< 				'g-recaptcha-response': reCaptchaResponse,
< 			}).then(res => {
< 				totpLogin = true;
< 				signing = false;
< 				challengeData = res;
< 				return queryKey();
< 			}).catch(loginFailed);
< 		} else {
< 			totpLogin = true;
< 			signing = false;
< 		}
< 	} else {
< 		os.api('signin', {
< 			username,
< 			password,
< 			'hcaptcha-response': hCaptchaResponse,
< 			'g-recaptcha-response': reCaptchaResponse,
< 			token: user && user.twoFactorEnabled ? token : undefined,
< 		}).then(res => {
< 			emit('login', res);
< 			onLogin(res);
< 		}).catch(loginFailed);
< 	}
---
>   signing = true;
>   console.log("submit");
>   if (!token.value) {
>     login(token, instanceUrlResult);
>     signing = false;
>   }
195,232c153,190
< 	switch (err.id) {
< 		case '6cc579cc-885d-43d8-95c2-b8c7fc963280': {
< 			os.alert({
< 				type: 'error',
< 				title: i18n.ts.loginFailed,
< 				text: i18n.ts.noSuchUser,
< 			});
< 			break;
< 		}
< 		case '932c904e-9460-45b7-9ce6-7ed33be7eb2c': {
< 			os.alert({
< 				type: 'error',
< 				title: i18n.ts.loginFailed,
< 				text: i18n.ts.incorrectPassword,
< 			});
< 			break;
< 		}
< 		case 'e03a5f46-d309-4865-9b69-56282d94e1eb': {
< 			showSuspendedDialog();
< 			break;
< 		}
< 		case '22d05606-fbcf-421a-a2db-b32610dcfd1b': {
< 			os.alert({
< 				type: 'error',
< 				title: i18n.ts.loginFailed,
< 				text: i18n.ts.rateLimitExceeded,
< 			});
< 			break;
< 		}
< 		default: {
< 			console.log(err);
< 			os.alert({
< 				type: 'error',
< 				title: i18n.ts.loginFailed,
< 				text: JSON.stringify(err),
< 			});
< 		}
< 	}
---
>   switch (err.id) {
>     case "6cc579cc-885d-43d8-95c2-b8c7fc963280": {
>       os.alert({
>         type: "error",
>         title: i18n.ts.loginFailed,
>         text: i18n.ts.noSuchUser,
>       });
>       break;
>     }
>     case "932c904e-9460-45b7-9ce6-7ed33be7eb2c": {
>       os.alert({
>         type: "error",
>         title: i18n.ts.loginFailed,
>         text: i18n.ts.incorrectPassword,
>       });
>       break;
>     }
>     case "e03a5f46-d309-4865-9b69-56282d94e1eb": {
>       showSuspendedDialog();
>       break;
>     }
>     case "22d05606-fbcf-421a-a2db-b32610dcfd1b": {
>       os.alert({
>         type: "error",
>         title: i18n.ts.loginFailed,
>         text: i18n.ts.rateLimitExceeded,
>       });
>       break;
>     }
>     default: {
>       console.log(err);
>       os.alert({
>         type: "error",
>         title: i18n.ts.loginFailed,
>         text: JSON.stringify(err),
>       });
>     }
>   }
234,236c192,194
< 	challengeData = null;
< 	totpLogin = false;
< 	signing = false;
---
>   challengeData = null;
>   totpLogin = false;
>   signing = false;
240,241c198,203
< 	os.popup(defineAsyncComponent(() => import('@/components/MkForgotPassword.vue')), {}, {
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkForgotPassword.vue")),
>     {},
>     {},
>     "closed"
>   );
242a205,213
> 
> let instances = $ref([])
> 
> fetch("https://instanceapp.misskey.page/instances.json").then(res => {
>   res.json().then(data => {
>     instances = data.instancesInfos
>   })
> })
> 
247,257c218,228
< 	> .auth {
< 		> .avatar {
< 			margin: 0 auto 0 auto;
< 			width: 64px;
< 			height: 64px;
< 			background: #ddd;
< 			background-position: center;
< 			background-size: cover;
< 			border-radius: 100%;
< 		}
< 	}
---
>   > .auth {
>     > .avatar {
>       margin: 0 auto 0 auto;
>       width: 64px;
>       height: 64px;
>       background: #ddd;
>       background-position: center;
>       background-size: cover;
>       border-radius: 100%;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSigninDialog.vue RiricaV13/components/MkSigninDialog.vue
2,9c2,9
< <MkModalWindow
< 	ref="dialog"
< 	:width="370"
< 	:height="400"
< 	@close="onClose"
< 	@closed="emit('closed')"
< >
< 	<template #header>{{ i18n.ts.login }}</template>
---
>   <XModalWindow
>     ref="dialog"
>     :width="370"
>     :height="400"
>     @close="onClose"
>     @closed="emit('closed')"
>   >
>     <template #header>{{ i18n.ts.login }}</template>
11,14c11,12
< 	<MkSpacer :margin-min="20" :margin-max="28">
< 		<MkSignin :auto-set="autoSet" :message="message" @login="onLogin"/>
< 	</MkSpacer>
< </MkModalWindow>
---
>     <MkSignin :auto-set="autoSet" :message="message" @login="onLogin" />
>   </XModalWindow>
18,21c16,19
< import { } from 'vue';
< import MkSignin from '@/components/MkSignin.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import MkSignin from "@/components/MkSignin.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import { i18n } from "@/i18n";
23,29c21,30
< const props = withDefaults(defineProps<{
< 	autoSet?: boolean;
< 	message?: string,
< }>(), {
< 	autoSet: false,
< 	message: '',
< });
---
> const props = withDefaults(
>   defineProps<{
>     autoSet?: boolean;
>     message?: string;
>   }>(),
>   {
>     autoSet: false,
>     message: "",
>   }
> );
32,34c33,35
< 	(ev: 'done'): void;
< 	(ev: 'closed'): void;
< 	(ev: 'cancelled'): void;
---
>   (ev: "done"): void;
>   (ev: "closed"): void;
>   (ev: "cancelled"): void;
37c38
< const dialog = $shallowRef<InstanceType<typeof MkModalWindow>>();
---
> const dialog = $ref<InstanceType<typeof XModalWindow>>();
40,41c41,42
< 	emit('cancelled');
< 	dialog.close();
---
>   emit("cancelled");
>   dialog.close();
45,46c46,47
< 	emit('done', res);
< 	dialog.close();
---
>   emit("done", res);
>   dialog.close();
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSignup.vue RiricaV13/components/MkSignup.vue
2,64c2,238
< <form class="qlvuhzng _gaps_m" autocomplete="new-password" @submit.prevent="onSubmit">
< 	<MkInput v-if="instance.disableRegistration" v-model="invitationCode" type="text" :spellcheck="false" required>
< 		<template #label>{{ i18n.ts.invitationCode }}</template>
< 		<template #prefix><i class="ti ti-key"></i></template>
< 	</MkInput>
< 	<MkInput v-model="username" type="text" pattern="^[a-zA-Z0-9_]{1,20}$" :spellcheck="false" required data-cy-signup-username @update:model-value="onChangeUsername">
< 		<template #label>{{ i18n.ts.username }} <div v-tooltip:dialog="i18n.ts.usernameInfo" class="_button _help"><i class="ti ti-question-circle"></i></div></template>
< 		<template #prefix>@</template>
< 		<template #suffix>@{{ host }}</template>
< 		<template #caption>
< 			<span v-if="usernameState === 'wait'" style="color:#999"><MkLoading :em="true"/> {{ i18n.ts.checking }}</span>
< 			<span v-else-if="usernameState === 'ok'" style="color: var(--success)"><i class="ti ti-check ti-fw"></i> {{ i18n.ts.available }}</span>
< 			<span v-else-if="usernameState === 'unavailable'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.unavailable }}</span>
< 			<span v-else-if="usernameState === 'error'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.error }}</span>
< 			<span v-else-if="usernameState === 'invalid-format'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.usernameInvalidFormat }}</span>
< 			<span v-else-if="usernameState === 'min-range'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.tooShort }}</span>
< 			<span v-else-if="usernameState === 'max-range'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.tooLong }}</span>
< 		</template>
< 	</MkInput>
< 	<MkInput v-if="instance.emailRequiredForSignup" v-model="email" :debounce="true" type="email" :spellcheck="false" required data-cy-signup-email @update:model-value="onChangeEmail">
< 		<template #label>{{ i18n.ts.emailAddress }} <div v-tooltip:dialog="i18n.ts._signup.emailAddressInfo" class="_button _help"><i class="ti ti-question-circle"></i></div></template>
< 		<template #prefix><i class="ti ti-mail"></i></template>
< 		<template #caption>
< 			<span v-if="emailState === 'wait'" style="color:#999"><MkLoading :em="true"/> {{ i18n.ts.checking }}</span>
< 			<span v-else-if="emailState === 'ok'" style="color: var(--success)"><i class="ti ti-check ti-fw"></i> {{ i18n.ts.available }}</span>
< 			<span v-else-if="emailState === 'unavailable:used'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts._emailUnavailable.used }}</span>
< 			<span v-else-if="emailState === 'unavailable:format'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts._emailUnavailable.format }}</span>
< 			<span v-else-if="emailState === 'unavailable:disposable'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts._emailUnavailable.disposable }}</span>
< 			<span v-else-if="emailState === 'unavailable:mx'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts._emailUnavailable.mx }}</span>
< 			<span v-else-if="emailState === 'unavailable:smtp'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts._emailUnavailable.smtp }}</span>
< 			<span v-else-if="emailState === 'unavailable'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.unavailable }}</span>
< 			<span v-else-if="emailState === 'error'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.error }}</span>
< 		</template>
< 	</MkInput>
< 	<MkInput v-model="password" type="password" autocomplete="new-password" required data-cy-signup-password @update:model-value="onChangePassword">
< 		<template #label>{{ i18n.ts.password }}</template>
< 		<template #prefix><i class="ti ti-lock"></i></template>
< 		<template #caption>
< 			<span v-if="passwordStrength == 'low'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.weakPassword }}</span>
< 			<span v-if="passwordStrength == 'medium'" style="color: var(--warn)"><i class="ti ti-check ti-fw"></i> {{ i18n.ts.normalPassword }}</span>
< 			<span v-if="passwordStrength == 'high'" style="color: var(--success)"><i class="ti ti-check ti-fw"></i> {{ i18n.ts.strongPassword }}</span>
< 		</template>
< 	</MkInput>
< 	<MkInput v-model="retypedPassword" type="password" autocomplete="new-password" required data-cy-signup-password-retype @update:model-value="onChangePasswordRetype">
< 		<template #label>{{ i18n.ts.password }} ({{ i18n.ts.retype }})</template>
< 		<template #prefix><i class="ti ti-lock"></i></template>
< 		<template #caption>
< 			<span v-if="passwordRetypeState == 'match'" style="color: var(--success)"><i class="ti ti-check ti-fw"></i> {{ i18n.ts.passwordMatched }}</span>
< 			<span v-if="passwordRetypeState == 'not-match'" style="color: var(--error)"><i class="ti ti-alert-triangle ti-fw"></i> {{ i18n.ts.passwordNotMatched }}</span>
< 		</template>
< 	</MkInput>
< 	<MkSwitch v-if="instance.tosUrl" v-model="ToSAgreement" class="tou">
< 		<I18n :src="i18n.ts.agreeTo">
< 			<template #0>
< 				<a :href="instance.tosUrl" class="_link" target="_blank">{{ i18n.ts.tos }}</a>
< 			</template>
< 		</I18n>
< 	</MkSwitch>
< 	<MkCaptcha v-if="instance.enableHcaptcha" ref="hcaptcha" v-model="hCaptchaResponse" class="captcha" provider="hcaptcha" :sitekey="instance.hcaptchaSiteKey"/>
< 	<MkCaptcha v-if="instance.enableRecaptcha" ref="recaptcha" v-model="reCaptchaResponse" class="captcha" provider="recaptcha" :sitekey="instance.recaptchaSiteKey"/>
< 	<MkCaptcha v-if="instance.enableTurnstile" ref="turnstile" v-model="turnstileResponse" class="captcha" provider="turnstile" :sitekey="instance.turnstileSiteKey"/>
< 	<MkButton type="submit" :disabled="shouldDisableSubmitting" gradate data-cy-signup-submit>{{ i18n.ts.start }}</MkButton>
< </form>
---
>   <form
>     class="qlvuhzng _formRoot"
>     autocomplete="new-password"
>     @submit.prevent="onSubmit"
>   >
>     <MkInput
>       v-if="instance.disableRegistration"
>       v-model="invitationCode"
>       class="_formBlock"
>       type="text"
>       :spellcheck="false"
>       required
>     >
>       <template #label>{{ i18n.ts.invitationCode }}</template>
>       <template #prefix><i class="fas fa-key"></i></template>
>     </MkInput>
>     <MkInput
>       v-model="username"
>       class="_formBlock"
>       type="text"
>       pattern="^[a-zA-Z0-9_]{1,20}$"
>       :spellcheck="false"
>       required
>       data-cy-signup-username
>       @update:modelValue="onChangeUsername"
>     >
>       <template #label
>         >{{ i18n.ts.username }}
>         <div v-tooltip:dialog="i18n.ts.usernameInfo" class="_button _help">
>           <i class="far fa-question-circle"></i></div
>       ></template>
>       <template #prefix>@</template>
>       <template #suffix>@{{ host }}</template>
>       <template #caption>
>         <span v-if="usernameState === 'wait'" style="color: #999"
>           ><i class="fas fa-spinner fa-pulse fa-fw"></i>
>           {{ i18n.ts.checking }}</span
>         >
>         <span v-else-if="usernameState === 'ok'" style="color: var(--success)"
>           ><i class="fas fa-check fa-fw"></i> {{ i18n.ts.available }}</span
>         >
>         <span
>           v-else-if="usernameState === 'unavailable'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.unavailable }}</span
>         >
>         <span v-else-if="usernameState === 'error'" style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.error }}</span
>         >
>         <span
>           v-else-if="usernameState === 'invalid-format'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.usernameInvalidFormat }}</span
>         >
>         <span
>           v-else-if="usernameState === 'min-range'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.tooShort }}</span
>         >
>         <span
>           v-else-if="usernameState === 'max-range'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.tooLong }}</span
>         >
>       </template>
>     </MkInput>
>     <MkInput
>       v-if="instance.emailRequiredForSignup"
>       v-model="email"
>       class="_formBlock"
>       :debounce="true"
>       type="email"
>       :spellcheck="false"
>       required
>       data-cy-signup-email
>       @update:modelValue="onChangeEmail"
>     >
>       <template #label
>         >{{ i18n.ts.emailAddress }}
>         <div
>           v-tooltip:dialog="i18n.ts._signup.emailAddressInfo"
>           class="_button _help"
>         >
>           <i class="far fa-question-circle"></i></div
>       ></template>
>       <template #prefix><i class="fas fa-envelope"></i></template>
>       <template #caption>
>         <span v-if="emailState === 'wait'" style="color: #999"
>           ><i class="fas fa-spinner fa-pulse fa-fw"></i>
>           {{ i18n.ts.checking }}</span
>         >
>         <span v-else-if="emailState === 'ok'" style="color: var(--success)"
>           ><i class="fas fa-check fa-fw"></i> {{ i18n.ts.available }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable:used'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts._emailUnavailable.used }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable:format'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts._emailUnavailable.format }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable:disposable'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts._emailUnavailable.disposable }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable:mx'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts._emailUnavailable.mx }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable:smtp'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts._emailUnavailable.smtp }}</span
>         >
>         <span
>           v-else-if="emailState === 'unavailable'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.unavailable }}</span
>         >
>         <span v-else-if="emailState === 'error'" style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.error }}</span
>         >
>       </template>
>     </MkInput>
>     <MkInput
>       v-model="password"
>       class="_formBlock"
>       type="password"
>       autocomplete="new-password"
>       required
>       data-cy-signup-password
>       @update:modelValue="onChangePassword"
>     >
>       <template #label>{{ i18n.ts.password }}</template>
>       <template #prefix><i class="fas fa-lock"></i></template>
>       <template #caption>
>         <span v-if="passwordStrength == 'low'" style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.weakPassword }}</span
>         >
>         <span v-if="passwordStrength == 'medium'" style="color: var(--warn)"
>           ><i class="fas fa-check fa-fw"></i> {{ i18n.ts.normalPassword }}</span
>         >
>         <span v-if="passwordStrength == 'high'" style="color: var(--success)"
>           ><i class="fas fa-check fa-fw"></i> {{ i18n.ts.strongPassword }}</span
>         >
>       </template>
>     </MkInput>
>     <MkInput
>       v-model="retypedPassword"
>       class="_formBlock"
>       type="password"
>       autocomplete="new-password"
>       required
>       data-cy-signup-password-retype
>       @update:modelValue="onChangePasswordRetype"
>     >
>       <template #label>{{ i18n.ts.password }} ({{ i18n.ts.retype }})</template>
>       <template #prefix><i class="fas fa-lock"></i></template>
>       <template #caption>
>         <span
>           v-if="passwordRetypeState == 'match'"
>           style="color: var(--success)"
>           ><i class="fas fa-check fa-fw"></i>
>           {{ i18n.ts.passwordMatched }}</span
>         >
>         <span
>           v-if="passwordRetypeState == 'not-match'"
>           style="color: var(--error)"
>           ><i class="fas fa-exclamation-triangle fa-fw"></i>
>           {{ i18n.ts.passwordNotMatched }}</span
>         >
>       </template>
>     </MkInput>
>     <MkSwitch
>       v-if="instance.tosUrl"
>       v-model="ToSAgreement"
>       class="_formBlock tou"
>     >
>       <I18n :src="i18n.ts.agreeTo">
>         <template #0>
>           <a :href="instance.tosUrl" class="_link" target="_blank">{{
>             i18n.ts.tos
>           }}</a>
>         </template>
>       </I18n>
>     </MkSwitch>
>     <MkCaptcha
>       v-if="instance.enableHcaptcha"
>       ref="hcaptcha"
>       v-model="hCaptchaResponse"
>       class="_formBlock captcha"
>       provider="hcaptcha"
>       :sitekey="instance.hcaptchaSiteKey"
>     />
>     <MkCaptcha
>       v-if="instance.enableRecaptcha"
>       ref="recaptcha"
>       v-model="reCaptchaResponse"
>       class="_formBlock captcha"
>       provider="recaptcha"
>       :sitekey="instance.recaptchaSiteKey"
>     />
>     <MkCaptcha
>       v-if="instance.enableTurnstile"
>       ref="turnstile"
>       v-model="turnstileResponse"
>       class="_formBlock captcha"
>       provider="turnstile"
>       :sitekey="instance.turnstileSiteKey"
>     />
>     <MkButton
>       class="_formBlock"
>       type="submit"
>       :disabled="shouldDisableSubmitting"
>       gradate
>       data-cy-signup-submit
>       >{{ i18n.ts.start }}</MkButton
>     >
>   </form>
68,79c242,253
< import { } from 'vue';
< import getPasswordStrength from 'syuilo-password-strength';
< import { toUnicode } from 'punycode/';
< import MkButton from './MkButton.vue';
< import MkInput from './MkInput.vue';
< import MkSwitch from './MkSwitch.vue';
< import MkCaptcha from '@/components/MkCaptcha.vue';
< import * as config from '@/config';
< import * as os from '@/os';
< import { login } from '@/account';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import getPasswordStrength from "syuilo-password-strength";
> import { toUnicode } from "punycode/";
> import MkButton from "./MkButton.vue";
> import MkInput from "./form/input.vue";
> import MkSwitch from "./form/switch.vue";
> import MkCaptcha from "@/components/MkCaptcha.vue";
> import * as config from "@/config";
> import * as os from "@/os";
> import { login } from "@/account";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
81,85c255,262
< const props = withDefaults(defineProps<{
< 	autoSet?: boolean;
< }>(), {
< 	autoSet: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     autoSet?: boolean;
>   }>(),
>   {
>     autoSet: false,
>   }
> );
88,89c265,266
< 	(ev: 'signup', user: Record<string, any>): void;
< 	(ev: 'signupEmailPending'): void;
---
>   (ev: "signup", user: Record<string, any>): void;
>   (ev: "signupEmailPending"): void;
98,106c275,301
< let username: string = $ref('');
< let password: string = $ref('');
< let retypedPassword: string = $ref('');
< let invitationCode: string = $ref('');
< let email = $ref('');
< let usernameState: null | 'wait' | 'ok' | 'unavailable' | 'error' | 'invalid-format' | 'min-range' | 'max-range' = $ref(null);
< let emailState: null | 'wait' | 'ok' | 'unavailable:used' | 'unavailable:format' | 'unavailable:disposable' | 'unavailable:mx' | 'unavailable:smtp' | 'unavailable' | 'error' = $ref(null);
< let passwordStrength: '' | 'low' | 'medium' | 'high' = $ref('');
< let passwordRetypeState: null | 'match' | 'not-match' = $ref(null);
---
> let username: string = $ref("");
> let password: string = $ref("");
> let retypedPassword: string = $ref("");
> let invitationCode: string = $ref("");
> let email = $ref("");
> let usernameState:
>   | null
>   | "wait"
>   | "ok"
>   | "unavailable"
>   | "error"
>   | "invalid-format"
>   | "min-range"
>   | "max-range" = $ref(null);
> let emailState:
>   | null
>   | "wait"
>   | "ok"
>   | "unavailable:used"
>   | "unavailable:format"
>   | "unavailable:disposable"
>   | "unavailable:mx"
>   | "unavailable:smtp"
>   | "unavailable"
>   | "error" = $ref(null);
> let passwordStrength: "" | "low" | "medium" | "high" = $ref("");
> let passwordRetypeState: null | "match" | "not-match" = $ref(null);
114,119c309,316
< 	return submitting ||
< 		instance.tosUrl && !ToSAgreement ||
< 		instance.enableHcaptcha && !hCaptchaResponse ||
< 		instance.enableRecaptcha && !reCaptchaResponse ||
< 		instance.enableTurnstile && !turnstileResponse ||
< 		passwordRetypeState === 'not-match';
---
>   return (
>     submitting ||
>     (instance.tosUrl && !ToSAgreement) ||
>     (instance.enableHcaptcha && !hCaptchaResponse) ||
>     (instance.enableRecaptcha && !reCaptchaResponse) ||
>     (instance.enableTurnstile && !turnstileResponse) ||
>     passwordRetypeState === "not-match"
>   );
123,126c320,323
< 	if (username === '') {
< 		usernameState = null;
< 		return;
< 	}
---
>   if (username === "") {
>     usernameState = null;
>     return;
>   }
128,133c325,332
< 	{
< 		const err =
< 			!username.match(/^[a-zA-Z0-9_]+$/) ? 'invalid-format' :
< 			username.length < 1 ? 'min-range' :
< 			username.length > 20 ? 'max-range' :
< 			null;
---
>   {
>     const err = !username.match(/^[a-zA-Z0-9_]+$/)
>       ? "invalid-format"
>       : username.length < 1
>       ? "min-range"
>       : username.length > 20
>       ? "max-range"
>       : null;
135,139c334,338
< 		if (err) {
< 			usernameState = err;
< 			return;
< 		}
< 	}
---
>     if (err) {
>       usernameState = err;
>       return;
>     }
>   }
141c340
< 	usernameState = 'wait';
---
>   usernameState = "wait";
143,149c342,350
< 	os.api('username/available', {
< 		username,
< 	}).then(result => {
< 		usernameState = result.available ? 'ok' : 'unavailable';
< 	}).catch(() => {
< 		usernameState = 'error';
< 	});
---
>   os.api("username/available", {
>     username,
>   })
>     .then((result) => {
>       usernameState = result.available ? "ok" : "unavailable";
>     })
>     .catch(() => {
>       usernameState = "error";
>     });
153,156c354,357
< 	if (email === '') {
< 		emailState = null;
< 		return;
< 	}
---
>   if (email === "") {
>     emailState = null;
>     return;
>   }
158c359
< 	emailState = 'wait';
---
>   emailState = "wait";
160,172c361,381
< 	os.api('email-address/available', {
< 		emailAddress: email,
< 	}).then(result => {
< 		emailState = result.available ? 'ok' :
< 			result.reason === 'used' ? 'unavailable:used' :
< 			result.reason === 'format' ? 'unavailable:format' :
< 			result.reason === 'disposable' ? 'unavailable:disposable' :
< 			result.reason === 'mx' ? 'unavailable:mx' :
< 			result.reason === 'smtp' ? 'unavailable:smtp' :
< 			'unavailable';
< 	}).catch(() => {
< 		emailState = 'error';
< 	});
---
>   os.api("email-address/available", {
>     emailAddress: email,
>   })
>     .then((result) => {
>       emailState = result.available
>         ? "ok"
>         : result.reason === "used"
>         ? "unavailable:used"
>         : result.reason === "format"
>         ? "unavailable:format"
>         : result.reason === "disposable"
>         ? "unavailable:disposable"
>         : result.reason === "mx"
>         ? "unavailable:mx"
>         : result.reason === "smtp"
>         ? "unavailable:smtp"
>         : "unavailable";
>     })
>     .catch(() => {
>       emailState = "error";
>     });
176,179c385,388
< 	if (password === '') {
< 		passwordStrength = '';
< 		return;
< 	}
---
>   if (password === "") {
>     passwordStrength = "";
>     return;
>   }
181,182c390,392
< 	const strength = getPasswordStrength(password);
< 	passwordStrength = strength > 0.7 ? 'high' : strength > 0.3 ? 'medium' : 'low';
---
>   const strength = getPasswordStrength(password);
>   passwordStrength =
>     strength > 0.7 ? "high" : strength > 0.3 ? "medium" : "low";
186,189c396,399
< 	if (retypedPassword === '') {
< 		passwordRetypeState = null;
< 		return;
< 	}
---
>   if (retypedPassword === "") {
>     passwordRetypeState = null;
>     return;
>   }
191c401
< 	passwordRetypeState = password === retypedPassword ? 'match' : 'not-match';
---
>   passwordRetypeState = password === retypedPassword ? "match" : "not-match";
195,196c405,406
< 	if (submitting) return;
< 	submitting = true;
---
>   if (submitting) return;
>   submitting = true;
198,219c408,430
< 	os.api('signup', {
< 		username,
< 		password,
< 		emailAddress: email,
< 		invitationCode,
< 		'hcaptcha-response': hCaptchaResponse,
< 		'g-recaptcha-response': reCaptchaResponse,
< 		'turnstile-response': turnstileResponse,
< 	}).then(() => {
< 		if (instance.emailRequiredForSignup) {
< 			os.alert({
< 				type: 'success',
< 				title: i18n.ts._signup.almostThere,
< 				text: i18n.t('_signup.emailSent', { email }),
< 			});
< 			emit('signupEmailPending');
< 		} else {
< 			os.api('signin', {
< 				username,
< 				password,
< 			}).then(res => {
< 				emit('signup', res);
---
>   os.api("signup", {
>     username,
>     password,
>     emailAddress: email,
>     invitationCode,
>     "hcaptcha-response": hCaptchaResponse,
>     "g-recaptcha-response": reCaptchaResponse,
>     "turnstile-response": turnstileResponse,
>   })
>     .then(() => {
>       if (instance.emailRequiredForSignup) {
>         os.alert({
>           type: "success",
>           title: i18n.ts._signup.almostThere,
>           text: i18n.t("_signup.emailSent", { email }),
>         });
>         emit("signupEmailPending");
>       } else {
>         os.api("signin", {
>           username,
>           password,
>         }).then((res) => {
>           emit("signup", res);
221,230c432,442
< 				if (props.autoSet) {
< 					login(res.i);
< 				}
< 			});
< 		}
< 	}).catch(() => {
< 		submitting = false;
< 		hcaptcha.reset?.();
< 		recaptcha.reset?.();
< 		turnstile.reset?.();
---
>           if (props.autoSet) {
>             login(res.i);
>           }
>         });
>       }
>     })
>     .catch(() => {
>       submitting = false;
>       hcaptcha.reset?.();
>       recaptcha.reset?.();
>       turnstile.reset?.();
232,236c444,448
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.somethingHappened,
< 		});
< 	});
---
>       os.alert({
>         type: "error",
>         text: i18n.ts.somethingHappened,
>       });
>     });
242,244c454,456
< 	.captcha {
< 		margin: 16px 0;
< 	}
---
>   .captcha {
>     margin: 16px 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSignupDialog.vue RiricaV13/components/MkSignupDialog.vue
2,9c2,9
< <MkModalWindow
< 	ref="dialog"
< 	:width="366"
< 	:height="500"
< 	@close="dialog.close()"
< 	@closed="$emit('closed')"
< >
< 	<template #header>{{ i18n.ts.signup }}</template>
---
>   <XModalWindow
>     ref="dialog"
>     :width="366"
>     :height="500"
>     @close="dialog.close()"
>     @closed="$emit('closed')"
>   >
>     <template #header>{{ i18n.ts.signup }}</template>
11,14c11,20
< 	<MkSpacer :margin-min="20" :margin-max="28">
< 		<XSignup :auto-set="autoSet" @signup="onSignup" @signup-email-pending="onSignupEmailPending"/>
< 	</MkSpacer>
< </MkModalWindow>
---
>     <div class="_monolithic_">
>       <div class="_section">
>         <XSignup
>           :auto-set="autoSet"
>           @signup="onSignup"
>           @signupEmailPending="onSignupEmailPending"
>         />
>       </div>
>     </div>
>   </XModalWindow>
18,21c24,27
< import { } from 'vue';
< import XSignup from '@/components/MkSignup.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import XSignup from "@/components/MkSignup.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import { i18n } from "@/i18n";
23,27c29,36
< const props = withDefaults(defineProps<{
< 	autoSet?: boolean;
< }>(), {
< 	autoSet: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     autoSet?: boolean;
>   }>(),
>   {
>     autoSet: false,
>   }
> );
30,31c39,40
< 	(ev: 'done'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "done"): void;
>   (ev: "closed"): void;
34c43
< const dialog = $shallowRef<InstanceType<typeof MkModalWindow>>();
---
> const dialog = $ref<InstanceType<typeof XModalWindow>>();
37,38c46,47
< 	emit('done', res);
< 	dialog.close();
---
>   emit("done", res);
>   dialog.close();
42c51
< 	dialog.close();
---
>   dialog.close();
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSparkle.vue RiricaV13/components/MkSparkle.vue
2,6c2,6
< <span :class="$style.root">
< 	<span ref="el" style="display: inline-block;">
< 		<slot></slot>
< 	</span>
< 	<!-- なぜか path に対する key が機能しないため
---
>   <span class="mk-sparkle">
>     <span ref="el">
>       <!--		<slot></slot>-->
>     </span>
>     <!-- なぜか path に対する key が機能しないため
35,63c35,70
< 	<svg v-for="particle in particles" :key="particle.id" :width="width" :height="height" :viewBox="`0 0 ${width} ${height}`" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top: -32px; left: -32px;">
< 		<path
< 			style="transform-origin: center; transform-box: fill-box;"
< 			:transform="`translate(${particle.x} ${particle.y})`"
< 			:fill="particle.color"
< 			d="M29.427,2.011C29.721,0.83 30.782,0 32,0C33.218,0 34.279,0.83 34.573,2.011L39.455,21.646C39.629,22.347 39.991,22.987 40.502,23.498C41.013,24.009 41.653,24.371 42.354,24.545L61.989,29.427C63.17,29.721 64,30.782 64,32C64,33.218 63.17,34.279 61.989,34.573L42.354,39.455C41.653,39.629 41.013,39.991 40.502,40.502C39.991,41.013 39.629,41.653 39.455,42.354L34.573,61.989C34.279,63.17 33.218,64 32,64C30.782,64 29.721,63.17 29.427,61.989L24.545,42.354C24.371,41.653 24.009,41.013 23.498,40.502C22.987,39.991 22.347,39.629 21.646,39.455L2.011,34.573C0.83,34.279 0,33.218 0,32C0,30.782 0.83,29.721 2.011,29.427L21.646,24.545C22.347,24.371 22.987,24.009 23.498,23.498C24.009,22.987 24.371,22.347 24.545,21.646L29.427,2.011Z"
< 		>
< 			<animateTransform
< 				attributeName="transform"
< 				attributeType="XML"
< 				type="rotate"
< 				from="0 0 0"
< 				to="360 0 0"
< 				:dur="`${particle.dur}ms`"
< 				repeatCount="1"
< 				additive="sum"
< 			/>
< 			<animateTransform
< 				attributeName="transform"
< 				attributeType="XML"
< 				type="scale"
< 				:values="`0; ${particle.size}; 0`"
< 				:dur="`${particle.dur}ms`"
< 				repeatCount="1"
< 				additive="sum"
< 			/>
< 		</path>
< 	</svg>
< </span>
---
>     <svg
>       v-for="particle in particles"
>       :key="particle.id"
>       :width="width"
>       :height="height"
>       :viewBox="`0 0 ${width} ${height}`"
>       xmlns="http://www.w3.org/2000/svg"
>     >
>       <path
>         style="transform-origin: center; transform-box: fill-box"
>         :transform="`translate(${particle.x} ${particle.y})`"
>         :fill="particle.color"
>         d="M29.427,2.011C29.721,0.83 30.782,0 32,0C33.218,0 34.279,0.83 34.573,2.011L39.455,21.646C39.629,22.347 39.991,22.987 40.502,23.498C41.013,24.009 41.653,24.371 42.354,24.545L61.989,29.427C63.17,29.721 64,30.782 64,32C64,33.218 63.17,34.279 61.989,34.573L42.354,39.455C41.653,39.629 41.013,39.991 40.502,40.502C39.991,41.013 39.629,41.653 39.455,42.354L34.573,61.989C34.279,63.17 33.218,64 32,64C30.782,64 29.721,63.17 29.427,61.989L24.545,42.354C24.371,41.653 24.009,41.013 23.498,40.502C22.987,39.991 22.347,39.629 21.646,39.455L2.011,34.573C0.83,34.279 0,33.218 0,32C0,30.782 0.83,29.721 2.011,29.427L21.646,24.545C22.347,24.371 22.987,24.009 23.498,23.498C24.009,22.987 24.371,22.347 24.545,21.646L29.427,2.011Z"
>       >
>         <animateTransform
>           attributeName="transform"
>           attributeType="XML"
>           type="rotate"
>           from="0 0 0"
>           to="360 0 0"
>           :dur="`${particle.dur}ms`"
>           repeatCount="1"
>           additive="sum"
>         />
>         <animateTransform
>           attributeName="transform"
>           attributeType="XML"
>           type="scale"
>           :values="`0; ${particle.size}; 0`"
>           :dur="`${particle.dur}ms`"
>           repeatCount="1"
>           additive="sum"
>         />
>       </path>
>     </svg>
>   </span>
67c74
< import { onMounted, onUnmounted, ref, shallowRef } from 'vue';
---
> import { onMounted, onUnmounted, ref } from "vue";
70c77
< const el = shallowRef<HTMLElement>();
---
> const el = ref<HTMLElement>();
73c80
< const colors = ['#FF1493', '#00FFFF', '#FFE202', '#FFE202', '#FFE202'];
---
> const colors = ["#FF1493", "#00FFFF", "#FFE202", "#FFE202", "#FFE202"];
78,99c85,106
< 	ro = new ResizeObserver((entries, observer) => {
< 		width.value = el.value?.offsetWidth + 64;
< 		height.value = el.value?.offsetHeight + 64;
< 	});
< 	ro.observe(el.value);
< 	const add = () => {
< 		if (stop) return;
< 		const x = (Math.random() * (width.value - 64));
< 		const y = (Math.random() * (height.value - 64));
< 		const sizeFactor = Math.random();
< 		const particle = {
< 			id: Math.random().toString(),
< 			x,
< 			y,
< 			size: 0.2 + ((sizeFactor / 10) * 3),
< 			dur: 1000 + (sizeFactor * 1000),
< 			color: colors[Math.floor(Math.random() * colors.length)],
< 		};
< 		particles.value.push(particle);
< 		window.setTimeout(() => {
< 			particles.value = particles.value.filter(x => x.id !== particle.id);
< 		}, particle.dur - 100);
---
>   ro = new ResizeObserver((entries, observer) => {
>     width.value = el.value?.offsetWidth + 64;
>     height.value = el.value?.offsetHeight + 64;
>   });
>   ro.observe(el.value);
>   const add = () => {
>     if (stop) return;
>     const x = Math.random() * (width.value - 64);
>     const y = Math.random() * (height.value - 64);
>     const sizeFactor = Math.random();
>     const particle = {
>       id: Math.random().toString(),
>       x,
>       y,
>       size: 0.2 + (sizeFactor / 10) * 3,
>       dur: 1000 + sizeFactor * 1000,
>       color: colors[Math.floor(Math.random() * colors.length)],
>     };
>     particles.value.push(particle);
>     window.setTimeout(() => {
>       particles.value = particles.value.filter((x) => x.id !== particle.id);
>     }, particle.dur - 100);
101,105c108,112
< 		window.setTimeout(() => {
< 			add();
< 		}, 500 + (Math.random() * 500));
< 	};
< 	add();
---
>     window.setTimeout(() => {
>       add();
>     }, 500 + Math.random() * 500);
>   };
>   add();
109,110c116,117
< 	if (ro) ro.disconnect();
< 	stop = true;
---
>   if (ro) ro.disconnect();
>   stop = true;
114,118c121,135
< <style lang="scss" module>
< .root {
< 	position: relative;
< 	display: inline-block;
< 	pointer-events: none;
---
> <style lang="scss" scoped>
> .mk-sparkle {
>   position: relative;
>   display: inline-block;
> 
>   > span {
>     display: inline-block;
>   }
> 
>   > svg {
>     position: absolute;
>     top: -32px;
>     left: -32px;
>     pointer-events: none;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSubNoteContent.vue RiricaV13/components/MkSubNoteContent.vue
2,21c2,35
< <div :class="[$style.root, { [$style.collapsed]: collapsed }]">
< 	<div :class="$style.body">
< 		<span v-if="note.isHidden" style="opacity: 0.5">({{ i18n.ts.private }})</span>
< 		<span v-if="note.deletedAt" style="opacity: 0.5">({{ i18n.ts.deleted }})</span>
< 		<MkA v-if="note.replyId" :class="$style.reply" :to="`/notes/${note.replyId}`"><i class="ti ti-arrow-back-up"></i></MkA>
< 		<Mfm v-if="note.text" v-once :text="note.text" :author="note.user" :i="$i"/>
< 		<MkA v-if="note.renoteId" :class="$style.rp" :to="`/notes/${note.renoteId}`">RN: ...</MkA>
< 	</div>
< 	<details v-if="note.files.length > 0">
< 		<summary>({{ $t('withNFiles', { n: note.files.length }) }})</summary>
< 		<MkMediaList :media-list="note.files"/>
< 	</details>
< 	<details v-if="note.poll">
< 		<summary>{{ i18n.ts.poll }}</summary>
< 		<MkPoll :note="note"/>
< 	</details>
< 	<button v-if="collapsed" :class="$style.fade" class="_button" @click="collapsed = false">
< 		<span :class="$style.fadeLabel">{{ i18n.ts.showMore }}</span>
< 	</button>
< </div>
---
>   <div class="wrmlmaau" :class="{ collapsed }">
>     <div class="body">
>       <span v-if="note.isHidden" style="opacity: 0.5"
>         >({{ i18n.ts.private }})</span
>       >
>       <span v-if="note.deletedAt" style="opacity: 0.5"
>         >({{ i18n.ts.deleted }})</span
>       >
>       <MkA v-if="note.replyId" class="reply" :to="`/notes/${note.replyId}`"
>         ><i class="fas fa-reply"></i
>       ></MkA>
>       <Mfm
>         v-if="note.text"
>         :text="note.text"
>         :author="note.user"
>         :i="$i"
>         :custom-emojis="note.emojis"
>       />
>       <MkA v-if="note.renoteId" class="rp" :to="`/notes/${note.renoteId}`"
>         >RN: ...</MkA
>       >
>     </div>
>     <details v-if="note.files.length > 0">
>       <summary>({{ $t("withNFiles", { n: note.files.length }) }})</summary>
>       <XMediaList :media-list="note.files" />
>     </details>
>     <details v-if="note.poll">
>       <summary>{{ i18n.ts.poll }}</summary>
>       <XPoll :note="note" />
>     </details>
>     <button v-if="collapsed" class="fade _button" @click="collapsed = false">
>       <span>{{ i18n.ts.showMore }}</span>
>     </button>
>   </div>
25,29c39,43
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkMediaList from '@/components/MkMediaList.vue';
< import MkPoll from '@/components/MkPoll.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import XMediaList from "@/components/MkMediaList.vue";
> import XPoll from "@/components/MkPoll.vue";
> import { i18n } from "@/i18n";
32c46
< 	note: misskey.entities.Note;
---
>   note: misskey.entities.Note;
36,39c50,53
< 	props.note.cw == null && props.note.text != null && (
< 		(props.note.text.split('\n').length > 9) ||
< 		(props.note.text.length > 500)
< 	));
---
>   props.note.cw == null &&
>     props.note.text != null &&
>     (props.note.text.split("\n").length > 9 || props.note.text.length > 500)
> );
42,44c56,58
< <style lang="scss" module>
< .root {
< 	overflow-wrap: break-word;
---
> <style lang="scss" scoped>
> .wrmlmaau {
>   overflow-wrap: break-word;
46,49c60,64
< 	&.collapsed {
< 		position: relative;
< 		max-height: 9em;
< 		overflow: clip;
---
>   > .body {
>     > .reply {
>       margin-right: 6px;
>       color: var(--accent);
>     }
51,58c66,71
< 		> .fade {
< 			display: block;
< 			position: absolute;
< 			bottom: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 64px;
< 			background: linear-gradient(0deg, var(--panel), var(--X15));
---
>     > .rp {
>       margin-left: 4px;
>       font-style: oblique;
>       color: var(--renote);
>     }
>   }
60,67c73,76
< 			> .fadeLabel {
< 				display: inline-block;
< 				background: var(--panel);
< 				padding: 6px 10px;
< 				font-size: 0.8em;
< 				border-radius: 999px;
< 				box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
< 			}
---
>   &.collapsed {
>     position: relative;
>     max-height: 9em;
>     overflow: hidden;
69,76c78,85
< 			&:hover {
< 				> .fadeLabel {
< 					background: var(--panelHighlight);
< 				}
< 			}
< 		}
< 	}
< }
---
>     > .fade {
>       display: block;
>       position: absolute;
>       bottom: 0;
>       left: 0;
>       width: 100%;
>       height: 64px;
>       background: linear-gradient(0deg, var(--panel), var(--X15));
78c87,94
< .body {
---
>       > span {
>         display: inline-block;
>         background: var(--panel);
>         padding: 6px 10px;
>         font-size: 0.8em;
>         border-radius: 999px;
>         box-shadow: 0 2px 6px rgb(0 0 0 / 20%);
>       }
80,90c96,102
< }
< 
< .reply {
< 	margin-right: 6px;
< 	color: var(--accent);
< }
< 
< .rp {
< 	margin-left: 4px;
< 	font-style: oblique;
< 	color: var(--renote);
---
>       &:hover {
>         > span {
>           background: var(--panelHighlight);
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkSuperMenu.vue RiricaV13/components/MkSuperMenu.vue
2,4c2,4
< <div class="rrevdjwu" :class="{ grid }">
< 	<div v-for="group in def" class="group">
< 		<div v-if="group.title" class="title">{{ group.title }}</div>
---
>   <div class="rrevdjwu" :class="{ grid }">
>     <div v-for="group in def" class="group">
>       <div v-if="group.title" class="title">{{ group.title }}</div>
6,23c6,43
< 		<div class="items">
< 			<template v-for="(item, i) in group.items">
< 				<a v-if="item.type === 'a'" :href="item.href" :target="item.target" :tabindex="i" class="_button item" :class="{ danger: item.danger, active: item.active }">
< 					<span v-if="item.icon" class="icon"><i :class="item.icon" class="ti-fw"></i></span>
< 					<span class="text">{{ item.text }}</span>
< 				</a>
< 				<button v-else-if="item.type === 'button'" :tabindex="i" class="_button item" :class="{ danger: item.danger, active: item.active }" :disabled="item.active" @click="ev => item.action(ev)">
< 					<span v-if="item.icon" class="icon"><i :class="item.icon" class="ti-fw"></i></span>
< 					<span class="text">{{ item.text }}</span>
< 				</button>
< 				<MkA v-else :to="item.to" :tabindex="i" class="_button item" :class="{ danger: item.danger, active: item.active }">
< 					<span v-if="item.icon" class="icon"><i :class="item.icon" class="ti-fw"></i></span>
< 					<span class="text">{{ item.text }}</span>
< 				</MkA>
< 			</template>
< 		</div>
< 	</div>
< </div>
---
>       <div class="items">
>         <template v-for="(item, i) in group.items">
>           <a
>             v-if="item.type === 'a'"
>             :href="item.href"
>             :target="item.target"
>             :tabindex="i"
>             class="_button item"
>             :class="{ danger: item.danger, active: item.active }"
>           >
>             <i v-if="item.icon" class="icon fa-fw" :class="item.icon"></i>
>             <span class="text">{{ item.text }}</span>
>           </a>
>           <button
>             v-else-if="item.type === 'button'"
>             :tabindex="i"
>             class="_button item"
>             :class="{ danger: item.danger, active: item.active }"
>             :disabled="item.active"
>             @click="(ev) => item.action(ev)"
>           >
>             <i v-if="item.icon" class="icon fa-fw" :class="item.icon"></i>
>             <span class="text">{{ item.text }}</span>
>           </button>
>           <MkA
>             v-else
>             :to="item.to"
>             :tabindex="i"
>             class="_button item"
>             :class="{ danger: item.danger, active: item.active }"
>           >
>             <i v-if="item.icon" class="icon fa-fw" :class="item.icon"></i>
>             <span class="text">{{ item.text }}</span>
>           </MkA>
>         </template>
>       </div>
>     </div>
>   </div>
27c47
< import { defineComponent, ref, unref } from 'vue';
---
> import { defineComponent, ref, unref } from "vue";
30,40c50,60
< 	props: {
< 		def: {
< 			type: Array,
< 			required: true,
< 		},
< 		grid: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 	},
---
>   props: {
>     def: {
>       type: Array,
>       required: true,
>     },
>     grid: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>   },
46,51c66,71
< 	> .group {
< 		& + .group {
< 			margin-top: 16px;
< 			padding-top: 16px;
< 			border-top: solid 0.5px var(--divider);
< 		}
---
>   > .group {
>     & + .group {
>       margin-top: 16px;
>       padding-top: 16px;
>       border-top: solid 0.5px var(--divider);
>     }
53,67c73,77
< 		> .title {
< 			opacity: 0.7;
< 			margin: 0 0 8px 0;
< 			font-size: 0.9em;
< 		}
< 	
< 		> .items {
< 			> .item {
< 				display: flex;
< 				align-items: center;
< 				width: 100%;
< 				box-sizing: border-box;
< 				padding: 9px 16px 9px 8px;
< 				border-radius: 9px;
< 				font-size: 0.9em;
---
>     > .title {
>       opacity: 0.7;
>       margin: 0 0 8px 0;
>       font-size: 0.9em;
>     }
69,72c79,87
< 				&:hover {
< 					text-decoration: none;
< 					background: var(--panelHighlight);
< 				}
---
>     > .items {
>       > .item {
>         display: flex;
>         align-items: center;
>         width: 100%;
>         box-sizing: border-box;
>         padding: 10px 16px 10px 8px;
>         border-radius: 9px;
>         font-size: 0.9em;
74,77c89,92
< 				&.active {
< 					color: var(--accent);
< 					background: var(--accentedBg);
< 				}
---
>         &:hover {
>           text-decoration: none;
>           background: var(--panelHighlight);
>         }
79,81c94,97
< 				&.danger {
< 					color: var(--error);
< 				}
---
>         &.active {
>           color: var(--accent);
>           background: var(--accentedBg);
>         }
83,89c99,101
< 				> .icon {
< 					width: 32px;
< 					margin-right: 2px;
< 					flex-shrink: 0;
< 					text-align: center;
< 					opacity: 0.8;
< 				}
---
>         &.danger {
>           color: var(--error);
>         }
91,95c103,109
< 				> .text {
< 					white-space: normal;
< 					padding-right: 12px;
< 					flex-shrink: 1;
< 				}
---
>         > .icon {
>           width: 32px;
>           margin-right: 2px;
>           flex-shrink: 0;
>           text-align: center;
>           opacity: 0.8;
>         }
97,99c111,119
< 			}
< 		}
< 	}
---
>         > .text {
>           white-space: nowrap;
>           text-overflow: ellipsis;
>           overflow: hidden;
>           padding-right: 12px;
>         }
>       }
>     }
>   }
101,106c121,126
< 	&.grid {
< 		> .group {
< 			& + .group {
< 				padding-top: 0;
< 				border-top: none;
< 			}
---
>   &.grid {
>     > .group {
>       & + .group {
>         padding-top: 0;
>         border-top: none;
>       }
108,109c128,129
< 			margin-left: 0;
< 			margin-right: 0;
---
>       margin-left: 0;
>       margin-right: 0;
111,115c131,135
< 			> .title {
< 				font-size: 1em;
< 				opacity: 0.7;
< 				margin: 0 0 8px 16px;
< 			}
---
>       > .title {
>         font-size: 1em;
>         opacity: 0.7;
>         margin: 0 0 8px 16px;
>       }
117,121c137,141
< 			> .items {
< 				display: grid;
< 				grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
< 				grid-gap: 16px;
< 				padding: 0 16px;
---
>       > .items {
>         display: grid;
>         grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
>         grid-gap: 8px;
>         padding: 0 16px;
123,126c143,148
< 				> .item {
< 					flex-direction: column;
< 					text-align: center;
< 					padding: 0;
---
>         > .item {
>           flex-direction: column;
>           padding: 18px 16px 16px 16px;
>           background: var(--panel);
>           border-radius: 8px;
>           text-align: center;
128,131c150,155
< 					&:hover {
< 						text-decoration: none;
< 						background: none;
< 						color: var(--accent);
---
>           > .icon {
>             display: block;
>             margin-right: 0;
>             margin-bottom: 12px;
>             font-size: 1.5em;
>           }
133,159c157,165
< 						> .icon {
< 							background: var(--accentedBg);
< 						}
< 					}
< 
< 					> .icon {
< 						display: grid;
< 						place-content: center;
< 						margin-right: 0;
< 						margin-bottom: 6px;
< 						font-size: 1.5em;
< 						width: 60px;
< 						height: 60px;
< 						aspect-ratio: 1;
< 						background: var(--panel);
< 						border-radius: 100%;
< 					}
< 
< 					> .text {
< 						padding-right: 0;
< 						width: 100%;
< 						font-size: 0.8em;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > .text {
>             padding-right: 0;
>             width: 100%;
>             font-size: 0.8em;
>           }
>         }
>       }
>     }
>   }
Only in misskeyV13/packages/frontend/src/components: MkSwitch.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkTab.vue RiricaV13/components/MkTab.vue
2c2
< import { defineComponent, h, resolveDirective, withDirectives } from 'vue';
---
> import { defineComponent, h, resolveDirective, withDirectives } from "vue";
5,11c5,11
< 	props: {
< 		modelValue: {
< 			required: true,
< 		},
< 	},
< 	render() {
< 		const options = this.$slots.default();
---
>   props: {
>     modelValue: {
>       required: true,
>     },
>   },
>   render() {
>     const options = this.$slots.default();
13,25c13,42
< 		return h('div', {
< 			class: 'pxhvhrfw',
< 		}, options.map(option => withDirectives(h('button', {
< 			class: ['_button', { active: this.modelValue === option.props.value }],
< 			key: option.key,
< 			disabled: this.modelValue === option.props.value,
< 			onClick: () => {
< 				this.$emit('update:modelValue', option.props.value);
< 			},
< 		}, option.children), [
< 			[resolveDirective('click-anime')],
< 		])));
< 	},
---
>     return withDirectives(
>       h(
>         "div",
>         {
>           class: "pxhvhrfw",
>         },
>         options.map((option) =>
>           withDirectives(
>             h(
>               "button",
>               {
>                 class: [
>                   "_button",
>                   { active: this.modelValue === option.props.value },
>                 ],
>                 key: option.key,
>                 disabled: this.modelValue === option.props.value,
>                 onClick: () => {
>                   this.$emit("update:modelValue", option.props.value);
>                 },
>               },
>               option.children
>             ),
>             [[resolveDirective("click-anime")]]
>           )
>         )
>       ),
>       [[resolveDirective("size"), { max: [500] }]]
>     );
>   },
31,32c48,49
< 	display: flex;
< 	font-size: 90%;
---
>   display: flex;
>   font-size: 90%;
34,37c51,54
< 	> button {
< 		flex: 1;
< 		padding: 10px 8px;
< 		border-radius: var(--radius);
---
>   > button {
>     flex: 1;
>     padding: 10px 8px;
>     border-radius: var(--radius);
39,42c56,59
< 		&:disabled {
< 			opacity: 1 !important;
< 			cursor: default;
< 		}
---
>     &:disabled {
>       opacity: 1 !important;
>       cursor: default;
>     }
44,47c61,64
< 		&.active {
< 			color: var(--accent);
< 			background: var(--accentedBg);
< 		}
---
>     &.active {
>       color: var(--accent);
>       background: var(--accentedBg);
>     }
49,52c66,69
< 		&:not(.active):hover {
< 			color: var(--fgHighlighted);
< 			background: var(--panelHighlight);
< 		}
---
>     &:not(.active):hover {
>       color: var(--fgHighlighted);
>       background: var(--panelHighlight);
>     }
54,56c71,73
< 		&:not(:first-child) {
< 			margin-left: 8px;
< 		}
---
>     &:not(:first-child) {
>       margin-left: 8px;
>     }
58,62c75,78
< 		> .icon {
< 			margin-right: 6px;
< 		}
< 	}
< }
---
>     > .icon {
>       margin-right: 6px;
>     }
>   }
64,66c80,81
< @container (max-width: 500px) {
< 	.pxhvhrfw {
< 		font-size: 80%;
---
>   &.max-width_500px {
>     font-size: 80%;
68,71c83,86
< 		> button {
< 			padding: 11px 8px;
< 		}
< 	}
---
>     > button {
>       padding: 11px 8px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkTagCloud.vue RiricaV13/components/MkTagCloud.vue
2,9c2,16
< <div ref="rootEl" class="meijqfqm">
< 	<canvas :id="idForCanvas" ref="canvasEl" class="canvas" :width="width" height="300" @contextmenu.prevent="() => {}"></canvas>
< 	<div :id="idForTags" ref="tagsEl" class="tags">
< 		<ul>
< 			<slot></slot>
< 		</ul>
< 	</div>
< </div>
---
>   <div ref="rootEl" class="meijqfqm">
>     <canvas
>       :id="idForCanvas"
>       ref="canvasEl"
>       class="canvas"
>       :width="width"
>       height="300"
>       @contextmenu.prevent="() => {}"
>     ></canvas>
>     <div :id="idForTags" ref="tagsEl" class="tags">
>       <ul>
>         <slot></slot>
>       </ul>
>     </div>
>   </div>
13,14c20,21
< import { onMounted, ref, watch, PropType, onBeforeUnmount } from 'vue';
< import tinycolor from 'tinycolor2';
---
> import { onMounted, ref, watch, PropType, onBeforeUnmount } from "vue";
> import tinycolor from "tinycolor2";
17c24
< const SAFE_FOR_HTML_ID = 'abcdefghijklmnopqrstuvwxyz';
---
> const SAFE_FOR_HTML_ID = "abcdefghijklmnopqrstuvwxyz";
19,20c26,35
< const idForCanvas = Array.from(Array(16)).map(() => SAFE_FOR_HTML_ID[Math.floor(Math.random() * SAFE_FOR_HTML_ID.length)]).join('');
< const idForTags = Array.from(Array(16)).map(() => SAFE_FOR_HTML_ID[Math.floor(Math.random() * SAFE_FOR_HTML_ID.length)]).join('');
---
> const idForCanvas = Array.from(Array(16))
>   .map(
>     () => SAFE_FOR_HTML_ID[Math.floor(Math.random() * SAFE_FOR_HTML_ID.length)]
>   )
>   .join("");
> const idForTags = Array.from(Array(16))
>   .map(
>     () => SAFE_FOR_HTML_ID[Math.floor(Math.random() * SAFE_FOR_HTML_ID.length)]
>   )
>   .join("");
22,24c37,39
< let rootEl = $shallowRef<HTMLElement | null>(null);
< let canvasEl = $shallowRef<HTMLCanvasElement | null>(null);
< let tagsEl = $shallowRef<HTMLElement | null>(null);
---
> let rootEl = $ref<HTMLElement | null>(null);
> let canvasEl = $ref<HTMLCanvasElement | null>(null);
> let tagsEl = $ref<HTMLElement | null>(null);
28,46c43,63
< 	try {
< 		window.TagCanvas.Start(idForCanvas, idForTags, {
< 			textColour: '#ffffff',
< 			outlineColour: tinycolor(computedStyle.getPropertyValue('--accent')).toHexString(),
< 			outlineRadius: 10,
< 			initial: [-0.030, -0.010],
< 			frontSelect: true,
< 			imageRadius: 8,
< 			//dragControl: true,
< 			dragThreshold: 3,
< 			wheelZoom: false,
< 			reverse: true,
< 			depth: 0.5,
< 			maxSpeed: 0.2,
< 			minSpeed: 0.003,
< 			stretchX: 0.8,
< 			stretchY: 0.8,
< 		});
< 	} catch (err) {}
---
>   try {
>     window.TagCanvas.Start(idForCanvas, idForTags, {
>       textColour: "#ffffff",
>       outlineColour: tinycolor(
>         computedStyle.getPropertyValue("--accent")
>       ).toHexString(),
>       outlineRadius: 10,
>       initial: [-0.03, -0.01],
>       frontSelect: true,
>       imageRadius: 8,
>       //dragControl: true,
>       dragThreshold: 3,
>       wheelZoom: false,
>       reverse: true,
>       depth: 0.5,
>       maxSpeed: 0.2,
>       minSpeed: 0.003,
>       stretchX: 0.8,
>       stretchY: 0.8,
>     });
>   } catch (err) {}
50c67
< 	width = rootEl.offsetWidth;
---
>   width = rootEl.offsetWidth;
52,59c69,80
< 	if (loaded) {
< 		available = true;
< 	} else {
< 		document.head.appendChild(Object.assign(document.createElement('script'), {
< 			async: true,
< 			src: '/client-assets/tagcanvas.min.js',
< 		})).addEventListener('load', () => available = true);
< 	}
---
>   if (loaded) {
>     available = true;
>   } else {
>     document.head
>       .appendChild(
>         Object.assign(document.createElement("script"), {
>           async: true,
>           src: "/client-assets/tagcanvas.min.js",
>         })
>       )
>       .addEventListener("load", () => (available = true));
>   }
63c84
< 	if (window.TagCanvas) window.TagCanvas.Delete(idForCanvas);
---
>   if (window.TagCanvas) window.TagCanvas.Delete(idForCanvas);
67,69c88,90
< 	update: () => {
< 		window.TagCanvas.Update(idForCanvas);
< 	},
---
>   update: () => {
>     window.TagCanvas.Update(idForCanvas);
>   },
75,78c96,99
< 	position: relative;
< 	overflow: clip;
< 	display: grid;
< 	place-items: center;
---
>   position: relative;
>   overflow: clip;
>   display: grid;
>   place-items: center;
80,82c101,103
< 	> .canvas {
< 		display: block;
< 	}
---
>   > .canvas {
>     display: block;
>   }
84,88c105,109
< 	> .tags {
< 		position: absolute;
< 		top: 999px;
< 		left: 999px;
< 	}
---
>   > .tags {
>     position: absolute;
>     top: 999px;
>     left: 999px;
>   }
Only in misskeyV13/packages/frontend/src/components: MkTextarea.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkTimeline.vue RiricaV13/components/MkTimeline.vue
2c2,7
< <XNotes ref="tlComponent" :no-gap="!$store.state.showGapBetweenNotesInTimeline" :pagination="pagination" @queue="emit('queue', $event)"/>
---
>   <XNotes
>     ref="tlComponent"
>     :no-gap="!$store.state.showGapBetweenNotesInTimeline"
>     :pagination="pagination"
>     @queue="emit('queue', $event)"
>   />
6,11c11,16
< import { ref, computed, provide, onUnmounted } from 'vue';
< import XNotes from '@/components/MkNotes.vue';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import * as sound from '@/scripts/sound';
< import { $i } from '@/account';
---
> import { ref, computed, provide, onUnmounted } from "vue";
> import XNotes from "@/components/MkNotes.vue";
> import { stream } from "@/stream";
> import * as sound from "@/scripts/sound";
> import { $i } from "@/account";
> import {App} from "@capacitor/app";
14,18c19,23
< 	src: string;
< 	list?: string;
< 	antenna?: string;
< 	channel?: string;
< 	sound?: boolean;
---
>   src: string;
>   list?: string;
>   antenna?: string;
>   channel?: string;
>   sound?: boolean;
22,23c27,28
< 	(ev: 'note'): void;
< 	(ev: 'queue', count: number): void;
---
>   (ev: "note"): void;
>   (ev: "queue", count: number): void;
26c31,34
< provide('inChannel', computed(() => props.src === 'channel'));
---
> provide(
>   "inChannel",
>   computed(() => props.src === "channel")
> );
30,31c38,39
< const prepend = note => {
< 	tlComponent.pagingComponent?.prepend(note);
---
> const prepend = (note) => {
>   tlComponent.pagingComponent?.prepend(note);
33c41
< 	emit('note');
---
>   emit("note");
35,37c43,45
< 	if (props.sound) {
< 		sound.play($i && (note.userId === $i.id) ? 'noteMy' : 'note');
< 	}
---
>   if (props.sound) {
>     sound.play($i && note.userId === $i.id ? "noteMy" : "note");
>   }
41c49
< 	tlComponent.pagingComponent?.reload();
---
>   tlComponent.pagingComponent?.reload();
45c53
< 	tlComponent.pagingComponent?.reload();
---
>   tlComponent.pagingComponent?.reload();
49,51c57,59
< 	if (!tlComponent.pagingComponent?.backed) {
< 		tlComponent.pagingComponent?.reload();
< 	}
---
>   if (!tlComponent.pagingComponent?.backed) {
>     tlComponent.pagingComponent?.reload();
>   }
57a66,79
> function connect(){
>   if (props.src === "antenna") {
>     endpoint = "antennas/notes";
>     query = {
>       antennaId: props.antenna,
>     };
>     connection = stream.useChannel("antenna", {
>       antennaId: props.antenna,
>     });
>     connection.on("note", prepend);
>   } else if (props.src === "home") {
>     endpoint = "notes/timeline";
>     connection = stream.useChannel("homeTimeline");
>     connection.on("note", prepend);
59,123c81,132
< if (props.src === 'antenna') {
< 	endpoint = 'antennas/notes';
< 	query = {
< 		antennaId: props.antenna,
< 	};
< 	connection = stream.useChannel('antenna', {
< 		antennaId: props.antenna,
< 	});
< 	connection.on('note', prepend);
< } else if (props.src === 'home') {
< 	endpoint = 'notes/timeline';
< 	connection = stream.useChannel('homeTimeline');
< 	connection.on('note', prepend);
< 
< 	connection2 = stream.useChannel('main');
< 	connection2.on('follow', onChangeFollowing);
< 	connection2.on('unfollow', onChangeFollowing);
< } else if (props.src === 'local') {
< 	endpoint = 'notes/local-timeline';
< 	connection = stream.useChannel('localTimeline');
< 	connection.on('note', prepend);
< } else if (props.src === 'social') {
< 	endpoint = 'notes/hybrid-timeline';
< 	connection = stream.useChannel('hybridTimeline');
< 	connection.on('note', prepend);
< } else if (props.src === 'global') {
< 	endpoint = 'notes/global-timeline';
< 	connection = stream.useChannel('globalTimeline');
< 	connection.on('note', prepend);
< } else if (props.src === 'mentions') {
< 	endpoint = 'notes/mentions';
< 	connection = stream.useChannel('main');
< 	connection.on('mention', prepend);
< } else if (props.src === 'directs') {
< 	endpoint = 'notes/mentions';
< 	query = {
< 		visibility: 'specified',
< 	};
< 	const onNote = note => {
< 		if (note.visibility === 'specified') {
< 			prepend(note);
< 		}
< 	};
< 	connection = stream.useChannel('main');
< 	connection.on('mention', onNote);
< } else if (props.src === 'list') {
< 	endpoint = 'notes/user-list-timeline';
< 	query = {
< 		listId: props.list,
< 	};
< 	connection = stream.useChannel('userList', {
< 		listId: props.list,
< 	});
< 	connection.on('note', prepend);
< 	connection.on('userAdded', onUserAdded);
< 	connection.on('userRemoved', onUserRemoved);
< } else if (props.src === 'channel') {
< 	endpoint = 'channels/timeline';
< 	query = {
< 		channelId: props.channel,
< 	};
< 	connection = stream.useChannel('channel', {
< 		channelId: props.channel,
< 	});
< 	connection.on('note', prepend);
---
>     connection2 = stream.useChannel("main");
>     connection2.on("follow", onChangeFollowing);
>     connection2.on("unfollow", onChangeFollowing);
>   } else if (props.src === "local") {
>     endpoint = "notes/local-timeline";
>     connection = stream.useChannel("localTimeline");
>     connection.on("note", prepend);
>   } else if (props.src === "social") {
>     endpoint = "notes/hybrid-timeline";
>     connection = stream.useChannel("hybridTimeline");
>     connection.on("note", prepend);
>   } else if (props.src === "global") {
>     endpoint = "notes/global-timeline";
>     connection = stream.useChannel("globalTimeline");
>     connection.on("note", prepend);
>   } else if (props.src === "mentions") {
>     endpoint = "notes/mentions";
>     connection = stream.useChannel("main");
>     connection.on("mention", prepend);
>   } else if (props.src === "directs") {
>     endpoint = "notes/mentions";
>     query = {
>       visibility: "specified",
>     };
>     const onNote = (note) => {
>       if (note.visibility === "specified") {
>         prepend(note);
>       }
>     };
>     connection = stream.useChannel("main");
>     connection.on("mention", onNote);
>   } else if (props.src === "list") {
>     endpoint = "notes/user-list-timeline";
>     query = {
>       listId: props.list,
>     };
>     connection = stream.useChannel("userList", {
>       listId: props.list,
>     });
>     connection.on("note", prepend);
>     connection.on("userAdded", onUserAdded);
>     connection.on("userRemoved", onUserRemoved);
>   } else if (props.src === "channel") {
>     endpoint = "channels/timeline";
>     query = {
>       channelId: props.channel,
>     };
>     connection = stream.useChannel("channel", {
>       channelId: props.channel,
>     });
>     connection.on("note", prepend);
>   }
124a134
> connect()
125a136,138
> 
> 
> 
127,129c140,142
< 	endpoint: endpoint,
< 	limit: 10,
< 	params: query,
---
>   endpoint: endpoint,
>   limit: 10,
>   params: query,
133,134c146
< 	connection.dispose();
< 	if (connection2) connection2.dispose();
---
>   dissconect()
136a149,153
> function dissconect(){
>   connection.dispose();
>   if (connection2) connection2.dispose();
> }
> 
142a160,169
> 
> App.addListener('appStateChange', async ({ isActive }) => {
>   if(isActive){
>     dissconect()
>     connect()
>   }else {
>     dissconect()
>   }
> });
> 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkToast.vue RiricaV13/components/MkToast.vue
2,16c2,14
< <div>
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_toast_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_toast_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_toast_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_toast_leaveTo : ''"
< 		appear @after-leave="emit('closed')"
< 	>
< 		<div v-if="showing" class="_acrylic" :class="$style.root" :style="{ zIndex }">
< 			<div style="padding: 16px 24px;">
< 				{{ message }}
< 			</div>
< 		</div>
< 	</Transition>
< </div>
---
>   <div class="mk-toast">
>     <transition
>       :name="$store.state.animation ? 'toast' : ''"
>       appear
>       @after-leave="emit('closed')"
>     >
>       <div v-if="showing" class="body _acrylic" :style="{ zIndex }">
>         <div class="message">
>           {{ message }}
>         </div>
>       </div>
>     </transition>
>   </div>
20,21c18,19
< import { onMounted, ref } from 'vue';
< import * as os from '@/os';
---
> import { onMounted, ref } from "vue";
> import * as os from "@/os";
24c22
< 	message: string;
---
>   message: string;
28c26
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
31c29
< const zIndex = os.claimZIndex('high');
---
> const zIndex = os.claimZIndex("high");
35,37c33,35
< 	window.setTimeout(() => {
< 		showing = false;
< 	}, 4000);
---
>   window.setTimeout(() => {
>     showing = false;
>   }, 4000);
41,44c39,42
< <style lang="scss" module>
< .transition_toast_enterActive,
< .transition_toast_leaveActive {
< 	transition: opacity 0.3s, transform 0.3s !important;
---
> <style lang="scss" scoped>
> .toast-enter-active,
> .toast-leave-active {
>   transition: opacity 0.3s, transform 0.3s !important;
46,49c44,47
< .transition_toast_enterFrom,
< .transition_toast_leaveTo {
< 	opacity: 0;
< 	transform: translateY(-100%);
---
> .toast-enter-from,
> .toast-leave-to {
>   opacity: 0;
>   transform: translateY(-100%);
52,66c50,70
< .root {
< 	position: fixed;
< 	left: 0;
< 	right: 0;
< 	top: 0;
< 	margin: 0 auto;
< 	margin-top: 16px;
< 	min-width: 300px;
< 	max-width: calc(100% - 32px);
< 	width: min-content;
< 	box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
< 	border-radius: 8px;
< 	overflow: clip;
< 	text-align: center;
< 	pointer-events: none;
---
> .mk-toast {
>   > .body {
>     position: fixed;
>     left: 0;
>     right: 0;
>     top: 0;
>     margin: 0 auto;
>     margin-top: 16px;
>     min-width: 300px;
>     max-width: calc(100% - 32px);
>     width: min-content;
>     box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
>     border-radius: 8px;
>     overflow: clip;
>     text-align: center;
>     pointer-events: none;
> 
>     > .message {
>       padding: 16px 24px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkTokenGenerateWindow.vue RiricaV13/components/MkTokenGenerateWindow.vue
2,33c2,35
< <MkModalWindow
< 	ref="dialog"
< 	:width="400"
< 	:height="450"
< 	:with-ok-button="true"
< 	:ok-button-disabled="false"
< 	:can-close="false"
< 	@close="dialog.close()"
< 	@closed="$emit('closed')"
< 	@ok="ok()"
< >
< 	<template #header>{{ title || $ts.generateAccessToken }}</template>
< 
< 	<MkSpacer :margin-min="20" :margin-max="28">
< 		<div class="_gaps_m">
< 			<div v-if="information">
< 				<MkInfo warn>{{ information }}</MkInfo>
< 			</div>
< 			<div>
< 				<MkInput v-model="name">
< 					<template #label>{{ $ts.name }}</template>
< 				</MkInput>
< 			</div>
< 			<div><b>{{ $ts.permission }}</b></div>
< 			<div class="_buttons">
< 				<MkButton inline @click="disableAll">{{ i18n.ts.disableAll }}</MkButton>
< 				<MkButton inline @click="enableAll">{{ i18n.ts.enableAll }}</MkButton>
< 			</div>
< 			<MkSwitch v-for="kind in (initialPermissions || kinds)" :key="kind" v-model="permissions[kind]">{{ $t(`_permissions.${kind}`) }}</MkSwitch>
< 		</div>
< 	</MkSpacer>
< </MkModalWindow>
---
>   <XModalWindow
>     ref="dialog"
>     :width="400"
>     :height="450"
>     :with-ok-button="true"
>     :ok-button-disabled="false"
>     :can-close="false"
>     @close="dialog.close()"
>     @closed="$emit('closed')"
>     @ok="ok()"
>   >
>     <template #header>{{ title || $ts.generateAccessToken }}</template>
>     <div v-if="information" class="_section">
>       <MkInfo warn>{{ information }}</MkInfo>
>     </div>
>     <div class="_section">
>       <MkInput v-model="name">
>         <template #label>{{ $ts.name }}</template>
>       </MkInput>
>     </div>
>     <div class="_section">
>       <div style="margin-bottom: 16px">
>         <b>{{ $ts.permission }}</b>
>       </div>
>       <MkButton inline @click="disableAll">{{ $ts.disableAll }}</MkButton>
>       <MkButton inline @click="enableAll">{{ $ts.enableAll }}</MkButton>
>       <MkSwitch
>         v-for="kind in initialPermissions || kinds"
>         :key="kind"
>         v-model="permissions[kind]"
>         >{{ $t(`_permissions.${kind}`) }}</MkSwitch
>       >
>     </div>
>   </XModalWindow>
37,44c39,45
< import { } from 'vue';
< import { permissions as kinds } from 'misskey-js';
< import MkInput from './MkInput.vue';
< import MkSwitch from './MkSwitch.vue';
< import MkButton from './MkButton.vue';
< import MkInfo from './MkInfo.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import { permissions as kinds } from "misskey-js";
> import MkInput from "./form/input.vue";
> import MkSwitch from "./form/switch.vue";
> import MkButton from "./MkButton.vue";
> import MkInfo from "./MkInfo.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
46,56c47,60
< const props = withDefaults(defineProps<{
< 	title?: string | null;
< 	information?: string | null;
< 	initialName?: string | null;
< 	initialPermissions?: string[] | null;
< }>(), {
< 	title: null,
< 	information: null,
< 	initialName: null,
< 	initialPermissions: null,
< });
---
> const props = withDefaults(
>   defineProps<{
>     title?: string | null;
>     information?: string | null;
>     initialName?: string | null;
>     initialPermissions?: string[] | null;
>   }>(),
>   {
>     title: null,
>     information: null,
>     initialName: null,
>     initialPermissions: null,
>   }
> );
59,60c63,64
< 	(ev: 'closed'): void;
< 	(ev: 'done', result: { name: string | null, permissions: string[] }): void;
---
>   (ev: "closed"): void;
>   (ev: "done", result: { name: string | null; permissions: string[] }): void;
63c67
< const dialog = $shallowRef<InstanceType<typeof MkModalWindow>>();
---
> const dialog = $ref<InstanceType<typeof XModalWindow>>();
68,70c72,74
< 	for (const kind of props.initialPermissions) {
< 		permissions[kind] = true;
< 	}
---
>   for (const kind of props.initialPermissions) {
>     permissions[kind] = true;
>   }
72,74c76,78
< 	for (const kind of kinds) {
< 		permissions[kind] = false;
< 	}
---
>   for (const kind of kinds) {
>     permissions[kind] = false;
>   }
78,82c82,86
< 	emit('done', {
< 		name: name,
< 		permissions: Object.keys(permissions).filter(p => permissions[p]),
< 	});
< 	dialog.close();
---
>   emit("done", {
>     name: name,
>     permissions: Object.keys(permissions).filter((p) => permissions[p]),
>   });
>   dialog.close();
86,88c90,92
< 	for (const p in permissions) {
< 		permissions[p] = false;
< 	}
---
>   for (const p in permissions) {
>     permissions[p] = false;
>   }
92,94c96,98
< 	for (const p in permissions) {
< 		permissions[p] = true;
< 	}
---
>   for (const p in permissions) {
>     permissions[p] = true;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkTooltip.vue RiricaV13/components/MkTooltip.vue
2,15c2,18
< <Transition
< 	:enter-active-class="$store.state.animation ? $style.transition_tooltip_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_tooltip_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_tooltip_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_tooltip_leaveTo : ''"
< 	appear @after-leave="emit('closed')"
< >
< 	<div v-show="showing" ref="el" :class="$style.root" class="_acrylic _shadow" :style="{ zIndex, maxWidth: maxWidth + 'px' }">
< 		<slot>
< 			<Mfm v-if="asMfm" :text="text"/>
< 			<span v-else>{{ text }}</span>
< 		</slot>
< 	</div>
< </Transition>
---
>   <transition
>     :name="$store.state.animation ? 'tooltip' : ''"
>     appear
>     @after-leave="emit('closed')"
>   >
>     <div
>       v-show="showing"
>       ref="el"
>       class="buebdbiu _acrylic _shadow"
>       :style="{ zIndex, maxWidth: maxWidth + 'px' }"
>     >
>       <slot>
>         <Mfm v-if="asMfm" :text="text" />
>         <span v-else>{{ text }}</span>
>       </slot>
>     </div>
>   </transition>
19,21c22,24
< import { nextTick, onMounted, onUnmounted, ref, shallowRef } from 'vue';
< import * as os from '@/os';
< import { calcPopupPosition } from '@/scripts/popup-position';
---
> import { nextTick, onMounted, onUnmounted, ref } from "vue";
> import * as os from "@/os";
> import { calcPopupPosition } from "@/scripts/popup-position";
23,37c26,43
< const props = withDefaults(defineProps<{
< 	showing: boolean;
< 	targetElement?: HTMLElement;
< 	x?: number;
< 	y?: number;
< 	text?: string;
< 	asMfm?: boolean;
< 	maxWidth?: number;
< 	direction?: 'top' | 'bottom' | 'right' | 'left';
< 	innerMargin?: number;
< }>(), {
< 	maxWidth: 250,
< 	direction: 'top',
< 	innerMargin: 0,
< });
---
> const props = withDefaults(
>   defineProps<{
>     showing: boolean;
>     targetElement?: HTMLElement;
>     x?: number;
>     y?: number;
>     text?: string;
>     asMfm?: boolean;
>     maxWidth?: number;
>     direction?: "top" | "bottom" | "right" | "left";
>     innerMargin?: number;
>   }>(),
>   {
>     maxWidth: 250,
>     direction: "top",
>     innerMargin: 0,
>   }
> );
40c46
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
43,44c49,50
< const el = shallowRef<HTMLElement>();
< const zIndex = os.claimZIndex('high');
---
> const el = ref<HTMLElement>();
> const zIndex = os.claimZIndex("high");
47,54c53,60
< 	const data = calcPopupPosition(el.value, {
< 		anchorElement: props.targetElement,
< 		direction: props.direction,
< 		align: 'center',
< 		innerMargin: props.innerMargin,
< 		x: props.x,
< 		y: props.y,
< 	});
---
>   const data = calcPopupPosition(el.value, {
>     anchorElement: props.targetElement,
>     direction: props.direction,
>     align: "center",
>     innerMargin: props.innerMargin,
>     x: props.x,
>     y: props.y,
>   });
56,58c62,64
< 	el.value.style.transformOrigin = data.transformOrigin;
< 	el.value.style.left = data.left + 'px';
< 	el.value.style.top = data.top + 'px';
---
>   el.value.style.transformOrigin = data.transformOrigin;
>   el.value.style.left = data.left + "px";
>   el.value.style.top = data.top + "px";
64,65c70,71
< 	nextTick(() => {
< 		setPosition();
---
>   nextTick(() => {
>     setPosition();
67,72c73,78
< 		const loop = () => {
< 			loopHandler = window.requestAnimationFrame(() => {
< 				setPosition();
< 				loop();
< 			});
< 		};
---
>     const loop = () => {
>       loopHandler = window.requestAnimationFrame(() => {
>         setPosition();
>         loop();
>       });
>     };
74,75c80,81
< 		loop();
< 	});
---
>     loop();
>   });
79c85
< 	window.cancelAnimationFrame(loopHandler);
---
>   window.cancelAnimationFrame(loopHandler);
83,88c89,95
< <style lang="scss" module>
< .transition_tooltip_enterActive,
< .transition_tooltip_leaveActive {
< 	opacity: 1;
< 	transform: scale(1);
< 	transition: transform 200ms cubic-bezier(0.23, 1, 0.32, 1), opacity 200ms cubic-bezier(0.23, 1, 0.32, 1);
---
> <style lang="scss" scoped>
> .tooltip-enter-active,
> .tooltip-leave-active {
>   opacity: 1;
>   transform: scale(1);
>   transition: transform 200ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 200ms cubic-bezier(0.23, 1, 0.32, 1);
90,93c97,100
< .transition_tooltip_enterFrom,
< .transition_tooltip_leaveTo {
< 	opacity: 0;
< 	transform: scale(0.75);
---
> .tooltip-enter-from,
> .tooltip-leave-active {
>   opacity: 0;
>   transform: scale(0.75);
96,105c103,112
< .root {
< 	position: absolute;
< 	font-size: 0.8em;
< 	padding: 8px 12px;
< 	box-sizing: border-box;
< 	text-align: center;
< 	border-radius: 4px;
< 	border: solid 0.5px var(--divider);
< 	pointer-events: none;
< 	transform-origin: center center;
---
> .buebdbiu {
>   position: absolute;
>   font-size: 0.8em;
>   padding: 8px 12px;
>   box-sizing: border-box;
>   text-align: center;
>   border-radius: 4px;
>   border: solid 0.5px var(--divider);
>   pointer-events: none;
>   transform-origin: center center;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUpdated.vue RiricaV13/components/MkUpdated.vue
2,9c2,18
< <MkModal ref="modal" :z-priority="'middle'" @click="$refs.modal.close()" @closed="$emit('closed')">
< 	<div :class="$style.root">
< 		<div :class="$style.title"><MkSparkle>{{ i18n.ts.misskeyUpdated }}</MkSparkle></div>
< 		<div :class="$style.version">✨{{ version }}🚀</div>
< 		<MkButton full @click="whatIsNew">{{ i18n.ts.whatIsNew }}</MkButton>
< 		<MkButton :class="$style.gotIt" primary full @click="$refs.modal.close()">{{ i18n.ts.gotIt }}</MkButton>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :z-priority="'middle'"
>     @click="$refs.modal.close()"
>     @closed="$emit('closed')"
>   >
>     <div class="ewlycnyt">
>       <div class="title">
>         <MkSparkle>{{ i18n.ts.misskeyUpdated }}</MkSparkle>
>       </div>
>       <div class="version">✨{{ version }}🚀</div>
>       <MkButton full @click="whatIsNew">{{ i18n.ts.whatIsNew }}</MkButton>
>       <MkButton class="gotIt" primary full @click="$refs.modal.close()">{{
>         i18n.ts.gotIt
>       }}</MkButton>
>     </div>
>   </MkModal>
13,19c22,27
< import { onMounted, shallowRef } from 'vue';
< import MkModal from '@/components/MkModal.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkSparkle from '@/components/MkSparkle.vue';
< import { version } from '@/config';
< import { i18n } from '@/i18n';
< import { confetti } from '@/scripts/confetti';
---
> import { ref } from "vue";
> import MkModal from "@/components/MkModal.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkSparkle from "@/components/MkSparkle.vue";
> import { version } from "@/config";
> import { i18n } from "@/i18n";
21c29
< const modal = shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = ref<InstanceType<typeof MkModal>>();
24,25c32,39
< 	modal.value.close();
< 	window.open(`https://misskey-hub.net/docs/releases.html#_${version.replace(/\./g, '-')}`, '_blank');
---
>   modal.value.close();
>   window.open(
>     `https://misskey-hub.net/docs/releases.html#_${version.replace(
>       /\./g,
>       "-"
>     )}`,
>     "_blank"
>   );
27,32d40
< 
< onMounted(() => {
< 	confetti({
< 		duration: 1000 * 3,
< 	});
< });
35,46c43,52
< <style lang="scss" module>
< .root {
< 	margin: auto;
< 	position: relative;
< 	padding: 32px;
< 	min-width: 320px;
< 	max-width: 480px;
< 	box-sizing: border-box;
< 	text-align: center;
< 	background: var(--panel);
< 	border-radius: var(--radius);
< }
---
> <style lang="scss" scoped>
> .ewlycnyt {
>   position: relative;
>   padding: 32px;
>   min-width: 320px;
>   max-width: 480px;
>   box-sizing: border-box;
>   text-align: center;
>   background: var(--panel);
>   border-radius: var(--radius);
48,50c54,56
< .title {
< 	font-weight: bold;
< }
---
>   > .title {
>     font-weight: bold;
>   }
52,54c58,60
< .version {
< 	margin: 1em 0;
< }
---
>   > .version {
>     margin: 1em 0;
>   }
56,57c62,64
< .gotIt {
< 	margin: 8px 0 0 0;
---
>   > .gotIt {
>     margin: 8px 0 0 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUrlPreview.vue RiricaV13/components/MkUrlPreview.vue
2,43c2,94
< <div v-if="playerEnabled" :class="$style.player" :style="`padding: ${(player.height || 0) / (player.width || 1) * 100}% 0 0`">
< 	<button :class="$style.disablePlayer" :title="i18n.ts.disablePlayer" @click="playerEnabled = false"><i class="ti ti-x"></i></button>
< 	<iframe :class="$style.playerIframe" :src="player.url + (player.url.match(/\?/) ? '&autoplay=1&auto_play=1' : '?autoplay=1&auto_play=1')" :width="player.width || '100%'" :heigth="player.height || 250" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen/>
< </div>
< <div v-else-if="tweetId && tweetExpanded" ref="twitter" :class="$style.twitter">
< 	<iframe ref="tweet" scrolling="no" frameborder="no" :style="{ position: 'relative', width: '100%', height: `${tweetHeight}px` }" :src="`https://platform.twitter.com/embed/index.html?embedId=${embedId}&amp;hideCard=false&amp;hideThread=false&amp;lang=en&amp;theme=${$store.state.darkMode ? 'dark' : 'light'}&amp;id=${tweetId}`"></iframe>
< </div>
< <div v-else :class="$style.urlPreview">
< 	<component :is="self ? 'MkA' : 'a'" :class="[$style.link, { [$style.compact]: compact }]" :[attr]="self ? url.substr(local.length) : url" rel="nofollow noopener" :target="target" :title="url">
< 		<div v-if="thumbnail" :class="$style.thumbnail" :style="`background-image: url('${thumbnail}')`">
< 		</div>
< 		<article :class="$style.body">
< 			<header :class="$style.header">
< 				<h1 v-if="unknownUrl" :class="$style.title">{{ url }}</h1>
< 				<h1 v-else-if="fetching" :class="$style.title"><MkEllipsis/></h1>
< 				<h1 v-else :class="$style.title" :title="title">{{ title }}</h1>
< 			</header>
< 			<p v-if="unknownUrl" :class="$style.text">{{ i18n.ts.cannotLoad }}</p>
< 			<p v-else-if="fetching" :class="$style.text"><MkEllipsis/></p>
< 			<p v-else-if="description" :class="$style.text" :title="description">{{ description.length > 85 ? description.slice(0, 85) + '…' : description }}</p>
< 			<footer :class="$style.footer">
< 				<img v-if="icon" :class="$style.siteIcon" :src="icon"/>
< 				<p v-if="unknownUrl" :class="$style.siteName">?</p>
< 				<p v-else-if="fetching" :class="$style.siteName"><MkEllipsis/></p>
< 				<p v-else :class="$style.siteName" :title="sitename">{{ sitename }}</p>
< 			</footer>
< 		</article>
< 	</component>
< 	<div v-if="tweetId" :class="$style.action">
< 		<MkButton :small="true" inline @click="tweetExpanded = true">
< 			<i class="ti ti-brand-twitter"></i> {{ i18n.ts.expandTweet }}
< 		</MkButton>
< 	</div>
< 	<div v-if="!playerEnabled && player.url" :class="$style.action">
< 		<MkButton :small="true" inline @click="playerEnabled = true">
< 			<i class="ti ti-player-play"></i> {{ i18n.ts.enablePlayer }}
< 		</MkButton>
< 		<MkButton v-if="!isMobile" :small="true" inline @click="openPlayer()">
< 			<i class="ti ti-picture-in-picture"></i> {{ i18n.ts.openInWindow }}
< 		</MkButton>
< 	</div>
< </div>
---
>   <div
>     v-if="playerEnabled"
>     class="player"
>     :style="`padding: ${
>       ((player.height || 0) / (player.width || 1)) * 100
>     }% 0 0`"
>   >
>     <button
>       class="disablePlayer"
>       :title="i18n.ts.disablePlayer"
>       @click="playerEnabled = false"
>     >
>       <i class="fas fa-times"></i>
>     </button>
>     <iframe
>       :src="
>         player.url +
>         (player.url.match(/\?/)
>           ? '&autoplay=1&auto_play=1'
>           : '?autoplay=1&auto_play=1')
>       "
>       :width="player.width || '100%'"
>       :heigth="player.height || 250"
>       frameborder="0"
>       allow="autoplay; encrypted-media"
>       allowfullscreen
>     />
>   </div>
>   <div v-else-if="tweetId && tweetExpanded" ref="twitter" class="twitter">
>     <iframe
>       ref="tweet"
>       scrolling="no"
>       frameborder="no"
>       :style="{
>         position: 'relative',
>         width: '100%',
>         height: `${tweetHeight}px`,
>       }"
>       :src="`https://platform.twitter.com/embed/index.html?embedId=${embedId}&amp;hideCard=false&amp;hideThread=false&amp;lang=en&amp;theme=${
>         $store.state.darkMode ? 'dark' : 'light'
>       }&amp;id=${tweetId}`"
>     ></iframe>
>   </div>
>   <div v-else v-size="{ max: [400, 350] }" class="mk-url-preview">
>     <transition :name="$store.state.animation ? 'zoom' : ''" mode="out-in">
>       <component
>         :is="self ? 'MkA' : 'a'"
>         v-if="!fetching"
>         class="link"
>         :class="{ compact }"
>         :[attr]="self ? url.substr(local.length) : url"
>         rel="nofollow noopener"
>         :target="target"
>         :title="url"
>       >
>         <div
>           v-if="thumbnail"
>           class="thumbnail"
>           :style="`background-image: url('${thumbnail}')`"
>         >
>           <button
>             v-if="!playerEnabled && player.url"
>             class="_button"
>             :title="i18n.ts.enablePlayer"
>             @click.prevent="isMobile ? (playerEnabled = true) : openPlayer()"
>           >
>             <i class="fas fa-play-circle"></i>
>           </button>
>         </div>
>         <article>
>           <header>
>             <h1 :title="title">{{ title }}</h1>
>           </header>
>           <p v-if="description" :title="description">
>             {{
>               description.length > 85
>                 ? description.slice(0, 85) + "…"
>                 : description
>             }}
>           </p>
>           <footer>
>             <img v-if="icon" class="icon" :src="icon" />
>             <p :title="sitename">{{ sitename }}</p>
>           </footer>
>         </article>
>       </component>
>     </transition>
>     <div v-if="tweetId" class="expandTweet">
>       <a @click="tweetExpanded = true">
>         <i class="fab fa-twitter"></i> {{ i18n.ts.expandTweet }}
>       </a>
>     </div>
>   </div>
47,53c98,102
< import { defineAsyncComponent, onMounted, onUnmounted } from 'vue';
< import { url as local } from '@/config';
< import { i18n } from '@/i18n';
< import * as os from '@/os';
< import { deviceKind } from '@/scripts/device-kind';
< import MkButton from '@/components/MkButton.vue';
< import { versatileLang } from '@/scripts/intl-const';
---
> import { defineAsyncComponent, onMounted, onUnmounted } from "vue";
> import { url as local, lang } from "@/config";
> import { i18n } from "@/i18n";
> import * as os from "@/os";
> import { deviceKind } from "@/scripts/device-kind";
55,62c104,114
< const props = withDefaults(defineProps<{
< 	url: string;
< 	detail?: boolean;
< 	compact?: boolean;
< }>(), {
< 	detail: false,
< 	compact: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     url: string;
>     detail?: boolean;
>     compact?: boolean;
>   }>(),
>   {
>     detail: false,
>     compact: false,
>   }
> );
65c117,119
< const isMobile = $ref(deviceKind === 'smartphone' || window.innerWidth <= MOBILE_THRESHOLD);
---
> const isMobile = $ref(
>   deviceKind === "smartphone" || window.innerWidth <= MOBILE_THRESHOLD
> );
68,69c122,123
< const attr = self ? 'to' : 'href';
< const target = self ? null : '_blank';
---
> const attr = self ? "to" : "href";
> const target = self ? null : "_blank";
77,79c131,133
< 	url: null,
< 	width: null,
< 	height: null,
---
>   url: null,
>   width: null,
>   height: null,
84c138
< const embedId = `embed${Math.random().toString().replace(/\D/, '')}`;
---
> const embedId = `embed${Math.random().toString().replace(/\D/, "")}`;
86d139
< let unknownUrl = $ref(false);
90,92c143,148
< if (requestUrl.hostname === 'twitter.com' || requestUrl.hostname === 'mobile.twitter.com') {
< 	const m = requestUrl.pathname.match(/^\/.+\/status(?:es)?\/(\d+)/);
< 	if (m) tweetId = m[1];
---
> if (
>   requestUrl.hostname === "twitter.com" ||
>   requestUrl.hostname === "mobile.twitter.com"
> ) {
>   const m = requestUrl.pathname.match(/^\/.+\/status(?:es)?\/(\d+)/);
>   if (m) tweetId = m[1];
95,96c151,155
< if (requestUrl.hostname === 'music.youtube.com' && requestUrl.pathname.match('^/(?:watch|channel)')) {
< 	requestUrl.hostname = 'www.youtube.com';
---
> if (
>   requestUrl.hostname === "music.youtube.com" &&
>   requestUrl.pathname.match("^/(?:watch|channel)")
> ) {
>   requestUrl.hostname = "www.youtube.com";
99c158
< requestUrl.hash = '';
---
> const requestLang = (lang || "ja-JP").replace("ja-KS", "ja-JP");
101,115c160
< window.fetch(`/url?url=${encodeURIComponent(requestUrl.href)}&lang=${versatileLang}`).then(res => {
< 	res.json().then(info => {
< 		if (info.url == null) {
< 			unknownUrl = true;
< 			return;
< 		}
< 		title = info.title;
< 		description = info.description;
< 		thumbnail = info.thumbnail;
< 		icon = info.icon;
< 		sitename = info.sitename;
< 		fetching = false;
< 		player = info.player;
< 	});
< });
---
> requestUrl.hash = "";
116a162,176
> window
>   .fetch(`/url?url=${encodeURIComponent(requestUrl.href)}&lang=${requestLang}`)
>   .then((res) => {
>     res.json().then((info) => {
>       if (info.url == null) return;
>       title = info.title;
>       description = info.description;
>       thumbnail = info.thumbnail;
>       icon = info.icon;
>       sitename = info.sitename;
>       fetching = false;
>       player = info.player;
>     });
>   });
> 
118,123c178,183
< 	if (message.origin !== 'https://platform.twitter.com') return;
< 	const embed = message.data?.['twttr.embed'];
< 	if (embed?.method !== 'twttr.private.resize') return;
< 	if (embed?.id !== embedId) return;
< 	const height = embed?.params[0]?.height;
< 	if (height) tweetHeight = height;
---
>   if (message.origin !== "https://platform.twitter.com") return;
>   const embed = message.data?.["twttr.embed"];
>   if (embed?.method !== "twttr.private.resize") return;
>   if (embed?.id !== embedId) return;
>   const height = embed?.params[0]?.height;
>   if (height) tweetHeight = height;
127,129c187,192
< 	os.popup(defineAsyncComponent(() => import('@/components/MkYoutubePlayer.vue')), {
< 		url: requestUrl.href,
< 	});
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkYoutubePlayer.vue")),
>     {
>       url: requestUrl.href,
>     }
>   );
132c195
< (window as any).addEventListener('message', adjustTweetHeight);
---
> (window as any).addEventListener("message", adjustTweetHeight);
135c198
< 	(window as any).removeEventListener('message', adjustTweetHeight);
---
>   (window as any).removeEventListener("message", adjustTweetHeight);
139c202
< <style lang="scss" module>
---
> <style lang="scss" scoped>
141,143c204,205
< 	position: relative;
< 	width: 100%;
< }
---
>   position: relative;
>   width: 100%;
145,156c207,218
< .disablePlayer {
< 	position: absolute;
< 	top: -1.5em;
< 	right: 0;
< 	font-size: 1em;
< 	width: 1.5em;
< 	height: 1.5em;
< 	padding: 0;
< 	margin: 0;
< 	color: var(--fg);
< 	background: rgba(128, 128, 128, 0.2);
< 	opacity: 0.7;
---
>   > button {
>     position: absolute;
>     top: -1.5em;
>     right: 0;
>     font-size: 1em;
>     width: 1.5em;
>     height: 1.5em;
>     padding: 0;
>     margin: 0;
>     color: var(--fg);
>     background: rgba(128, 128, 128, 0.2);
>     opacity: 0.7;
158,161c220,223
< 	&:hover {
< 		opacity: 0.9;
< 	}
< }
---
>     &:hover {
>       opacity: 0.9;
>     }
>   }
163,168c225,231
< .playerIframe {
< 	height: 100%;
< 	left: 0;
< 	position: absolute;
< 	top: 0;
< 	width: 100%;
---
>   > iframe {
>     height: 100%;
>     left: 0;
>     position: absolute;
>     top: 0;
>     width: 100%;
>   }
171c234,237
< .twitter {
---
> .mk-url-preview {
>   &.max-width_400px {
>     > .link {
>       font-size: 12px;
173c239,241
< }
---
>       > .thumbnail {
>         height: 80px;
>       }
175,176c243,247
< .urlPreview {
< }
---
>       > article {
>         padding: 12px;
>       }
>     }
>   }
178,184c249,251
< .link {
< 	position: relative;
< 	display: block;
< 	font-size: 14px;
< 	box-shadow: 0 0 0 1px var(--divider);
< 	border-radius: 8px;
< 	overflow: clip;
---
>   &.max-width_350px {
>     > .link {
>       font-size: 10px;
186,188c253,255
< 	&:hover {
< 		text-decoration: none;
< 		border-color: rgba(0, 0, 0, 0.2);
---
>       > .thumbnail {
>         height: 70px;
>       }
190,193c257,258
< 		> .body > .header > .title {
< 			text-decoration: underline;
< 		}
< 	}
---
>       > article {
>         padding: 8px;
195,204c260,262
< 	&.compact {
< 		> .body {
< 			> .header .title, .text, .footer {
< 				overflow: hidden;
< 				white-space: nowrap;
< 				text-overflow: ellipsis;
< 			}
< 		}
< 	}
< }
---
>         > header {
>           margin-bottom: 4px;
>         }
206,214c264,265
< .thumbnail {
< 	position: absolute;
< 	width: 100px;
< 	height: 100%;
< 	background-position: center;
< 	background-size: cover;
< 	display: flex;
< 	justify-content: center;
< 	align-items: center;
---
>         > footer {
>           margin-top: 4px;
216,220c267,272
< 	& + .body {
< 		left: 100px;
< 		width: calc(100% - 100px);
< 	}
< }
---
>           > img {
>             width: 12px;
>             height: 12px;
>           }
>         }
>       }
222,226c274,279
< .body {
< 	position: relative;
< 	box-sizing: border-box;
< 	padding: 16px;
< }
---
>       &.compact {
>         > .thumbnail {
>           position: absolute;
>           width: 56px;
>           height: 100%;
>         }
228,230c281,284
< .header {
< 	margin-bottom: 8px;
< }
---
>         > article {
>           left: 56px;
>           width: calc(100% - 56px);
>           padding: 4px;
232,235c286,288
< .title {
< 	margin: 0;
< 	font-size: 1em;
< }
---
>           > header {
>             margin-bottom: 2px;
>           }
237,240c290,296
< .text {
< 	margin: 0;
< 	font-size: 0.8em;
< }
---
>           > footer {
>             margin-top: 2px;
>           }
>         }
>       }
>     }
>   }
242,245c298,304
< .footer {
< 	margin-top: 8px;
< 	height: 16px;
< }
---
>   > .link {
>     position: relative;
>     display: block;
>     font-size: 14px;
>     box-shadow: 0 0 0 1px var(--divider);
>     border-radius: 8px;
>     overflow: hidden;
247,253c306,308
< .siteIcon {
< 	display: inline-block;
< 	width: 16px;
< 	height: 16px;
< 	margin-right: 4px;
< 	vertical-align: top;
< }
---
>     &:hover {
>       text-decoration: none;
>       border-color: rgba(0, 0, 0, 0.2);
255,262c310,313
< .siteName {
< 	display: inline-block;
< 	margin: 0;
< 	color: var(--urlPreviewInfo);
< 	font-size: 0.8em;
< 	line-height: 16px;
< 	vertical-align: top;
< }
---
>       > article > header > h1 {
>         text-decoration: underline;
>       }
>     }
264,269c315,323
< .action {
< 	display: flex;
< 	gap: 6px;
< 	flex-wrap: wrap;
< 	margin-top: 6px;
< }
---
>     > .thumbnail {
>       position: absolute;
>       width: 100px;
>       height: 100%;
>       background-position: center;
>       background-size: cover;
>       display: flex;
>       justify-content: center;
>       align-items: center;
271,274c325,327
< @container (max-width: 400px) {
< 	.link {
< 		font-size: 12px;
< 	}
---
>       > button {
>         font-size: 3.5em;
>         opacity: 0.7;
276,278c329,333
< 	.thumbnail {
< 		height: 80px;
< 	}
---
>         &:hover {
>           font-size: 4em;
>           opacity: 0.9;
>         }
>       }
280,283c335,339
< 	.body {
< 		padding: 12px;
< 	}
< }
---
>       & + article {
>         left: 100px;
>         width: calc(100% - 100px);
>       }
>     }
285,287c341,344
< @container (max-width: 350px) {
< 	.link {
< 		font-size: 10px;
---
>     > article {
>       position: relative;
>       box-sizing: border-box;
>       padding: 16px;
289,294c346,347
< 		&.compact {
< 			> .thumbnail {
< 				position: absolute;
< 				width: 56px;
< 				height: 100%;
< 			}
---
>       > header {
>         margin-bottom: 8px;
296,299c349,353
< 			> .body {
< 				left: 56px;
< 				width: calc(100% - 56px);
< 				padding: 4px;
---
>         > h1 {
>           margin: 0;
>           font-size: 1em;
>         }
>       }
301,303c355,358
< 				> .header {
< 					margin-bottom: 2px;
< 				}
---
>       > p {
>         margin: 0;
>         font-size: 0.8em;
>       }
305,310c360,362
< 				> .footer {
< 					margin-top: 2px;
< 				}
< 			}
< 		}
< 	}
---
>       > footer {
>         margin-top: 8px;
>         height: 16px;
312,314c364,370
< 	.thumbnail {
< 		height: 70px;
< 	}
---
>         > img {
>           display: inline-block;
>           width: 16px;
>           height: 16px;
>           margin-right: 4px;
>           vertical-align: top;
>         }
316,318c372,381
< 	.body {
< 		padding: 8px;
< 	}
---
>         > p {
>           display: inline-block;
>           margin: 0;
>           color: var(--urlPreviewInfo);
>           font-size: 0.8em;
>           line-height: 16px;
>           vertical-align: top;
>         }
>       }
>     }
320,331c383,394
< 	.header {
< 		margin-bottom: 4px;
< 	}
< 
< 	.footer {
< 		margin-top: 4px;
< 	}
< 
< 	.siteIcon {
< 		width: 12px;
< 		height: 12px;
< 	}
---
>     &.compact {
>       > article {
>         > header h1,
>         p,
>         footer {
>           overflow: hidden;
>           white-space: nowrap;
>           text-overflow: ellipsis;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUrlPreviewPopup.vue RiricaV13/components/MkUrlPreviewPopup.vue
2,6c2,9
< <div class="fgmtyycl" :style="{ zIndex, top: top + 'px', left: left + 'px' }">
< 	<Transition :name="$store.state.animation ? '_transition_zoom' : ''" @after-leave="emit('closed')">
< 		<MkUrlPreview v-if="showing" class="_popup _shadow" :url="url"/>
< 	</Transition>
< </div>
---
>   <div class="fgmtyycl" :style="{ zIndex, top: top + 'px', left: left + 'px' }">
>     <transition
>       :name="$store.state.animation ? 'zoom' : ''"
>       @after-leave="emit('closed')"
>     >
>       <MkUrlPreview v-if="showing" class="_popup _shadow" :url="url" />
>     </transition>
>   </div>
10,12c13,15
< import { onMounted } from 'vue';
< import MkUrlPreview from '@/components/MkUrlPreview.vue';
< import * as os from '@/os';
---
> import { onMounted } from "vue";
> import MkUrlPreview from "@/components/MkUrlPreview.vue";
> import * as os from "@/os";
15,17c18,20
< 	showing: boolean;
< 	url: string;
< 	source: HTMLElement;
---
>   showing: boolean;
>   url: string;
>   source: HTMLElement;
21c24
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
24c27
< const zIndex = os.claimZIndex('middle');
---
> const zIndex = os.claimZIndex("middle");
29,31c32,36
< 	const rect = props.source.getBoundingClientRect();
< 	const x = Math.max((rect.left + (props.source.offsetWidth / 2)) - (300 / 2), 6) + window.pageXOffset;
< 	const y = rect.top + props.source.offsetHeight + window.pageYOffset;
---
>   const rect = props.source.getBoundingClientRect();
>   const x =
>     Math.max(rect.left + props.source.offsetWidth / 2 - 300 / 2, 6) +
>     window.pageXOffset;
>   const y = rect.top + props.source.offsetHeight + window.pageYOffset;
33,34c38,39
< 	top = y;
< 	left = x;
---
>   top = y;
>   left = x;
40,43c45,48
< 	position: absolute;
< 	width: 500px;
< 	max-width: calc(90vw - 12px);
< 	pointer-events: none;
---
>   position: absolute;
>   width: 500px;
>   max-width: calc(90vw - 12px);
>   pointer-events: none;
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserCardMini.vue RiricaV13/components/MkUserCardMini.vue
2,9c2,21
< <div v-adaptive-bg :class="[$style.root, { yellow: user.isSilenced, red: user.isSuspended, gray: false }]">
< 	<MkAvatar class="avatar" :user="user" indicator/>
< 	<div class="body">
< 		<span class="name"><MkUserName class="name" :user="user"/></span>
< 		<span class="sub"><span class="acct _monospace">@{{ acct(user) }}</span></span>
< 	</div>
< 	<MkMiniChart v-if="chartValues" class="chart" :src="chartValues"/>
< </div>
---
>   <div
>     :class="[
>       $style.root,
>       { yellow: user.isSilenced, red: user.isSuspended, gray: false },
>     ]"
>   >
>     <MkAvatar
>       class="avatar"
>       :user="user"
>       :disable-link="true"
>       :show-indicator="true"
>     />
>     <div class="body">
>       <span class="name"><MkUserName class="name" :user="user" /></span>
>       <span class="sub"
>         ><span class="acct _monospace">@{{ acct(user) }}</span></span
>       >
>     </div>
>     <MkMiniChart v-if="chartValues" class="chart" :src="chartValues" />
>   </div>
13,17c25,28
< import * as misskey from 'misskey-js';
< import { onMounted } from 'vue';
< import MkMiniChart from '@/components/MkMiniChart.vue';
< import * as os from '@/os';
< import { acct } from '@/filters/user';
---
> import * as misskey from "misskey-js";
> import MkMiniChart from "@/components/MkMiniChart.vue";
> import * as os from "@/os";
> import { acct } from "@/filters/user";
19,24c30,32
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.User;
< 	withChart: boolean;
< }>(), {
< 	withChart: true,
< });
---
> const props = defineProps<{
>   user: misskey.entities.User;
> }>();
28,35c36,43
< onMounted(() => {
< 	if (props.withChart) {
< 		os.apiGet('charts/user/notes', { userId: props.user.id, limit: 16 + 1, span: 'day' }).then(res => {
< 			// 今日のぶんの値はまだ途中の値であり、それも含めると大抵の場合前日よりも下降しているようなグラフになってしまうため今日は弾く
< 			res.inc.splice(0, 1);
< 			chartValues = res.inc;
< 		});
< 	}
---
> os.apiGet("charts/user/notes", {
>   userId: props.user.id,
>   limit: 16 + 1,
>   span: "day",
> }).then((res) => {
>   // 今日のぶんの値はまだ途中の値であり、それも含めると大抵の場合前日よりも下降しているようなグラフになってしまうため今日は弾く
>   res.inc.splice(0, 1);
>   chartValues = res.inc;
41,42c49,50
< 	$bodyTitleHieght: 18px;
< 	$bodyInfoHieght: 16px;
---
>   $bodyTitleHieght: 18px;
>   $bodyInfoHieght: 16px;
44,48c52,56
< 	display: flex;
< 	align-items: center;
< 	padding: 16px;
< 	background: var(--panel);
< 	border-radius: 8px;
---
>   display: flex;
>   align-items: center;
>   padding: 16px;
>   background: var(--panel);
>   border-radius: 8px;
50,55c58,63
< 	> :global(.avatar) {
< 		display: block;
< 		width: ($bodyTitleHieght + $bodyInfoHieght);
< 		height: ($bodyTitleHieght + $bodyInfoHieght);
< 		margin-right: 12px;
< 	}
---
>   > :global(.avatar) {
>     display: block;
>     width: ($bodyTitleHieght + $bodyInfoHieght);
>     height: ($bodyTitleHieght + $bodyInfoHieght);
>     margin-right: 12px;
>   }
57,62c65,70
< 	> :global(.body) {
< 		flex: 1;
< 		overflow: hidden;
< 		font-size: 0.9em;
< 		color: var(--fg);
< 		padding-right: 8px;
---
>   > :global(.body) {
>     flex: 1;
>     overflow: hidden;
>     font-size: 0.9em;
>     color: var(--fg);
>     padding-right: 8px;
64,71c72,79
< 		> :global(.name) {
< 			display: block;
< 			width: 100%;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			line-height: $bodyTitleHieght;
< 		}
---
>     > :global(.name) {
>       display: block;
>       width: 100%;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       line-height: $bodyTitleHieght;
>     }
73,83c81,91
< 		> :global(.sub) {
< 			display: block;
< 			width: 100%;
< 			font-size: 95%;
< 			opacity: 0.7;
< 			line-height: $bodyInfoHieght;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
< 	}
---
>     > :global(.sub) {
>       display: block;
>       width: 100%;
>       font-size: 95%;
>       opacity: 0.7;
>       line-height: $bodyInfoHieght;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
>   }
85,87c93,95
< 	> :global(.chart) {
< 		height: 30px;
< 	}
---
>   > :global(.chart) {
>     height: 30px;
>   }
89,93c97,110
< 	&:global(.yellow) {
< 		--c: rgb(255 196 0 / 15%);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.yellow) {
>     --c: rgb(255 196 0 / 15%);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
95,99c112,125
< 	&:global(.red) {
< 		--c: rgb(255 0 0 / 15%);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.red) {
>     --c: rgb(255 0 0 / 15%);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
101,105c127,140
< 	&:global(.gray) {
< 		--c: var(--bg);
< 		background-image: linear-gradient(45deg, var(--c) 16.67%, transparent 16.67%, transparent 50%, var(--c) 50%, var(--c) 66.67%, transparent 66.67%, transparent 100%);
< 		background-size: 16px 16px;
< 	}
---
>   &:global(.gray) {
>     --c: var(--bg);
>     background-image: linear-gradient(
>       45deg,
>       var(--c) 16.67%,
>       transparent 16.67%,
>       transparent 50%,
>       var(--c) 50%,
>       var(--c) 66.67%,
>       transparent 66.67%,
>       transparent 100%
>     );
>     background-size: 16px 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserInfo.vue RiricaV13/components/MkUserInfo.vue
2,28c2,55
< <div class="_panel vjnjpkug">
< 	<div class="banner" :style="user.bannerUrl ? `background-image: url(${user.bannerUrl})` : ''"></div>
< 	<MkAvatar class="avatar" :user="user" indicator/>
< 	<div class="title">
< 		<MkA class="name" :to="userPage(user)"><MkUserName :user="user" :nowrap="false"/></MkA>
< 		<p class="username"><MkAcct :user="user"/></p>
< 	</div>
< 	<span v-if="$i && $i.id !== user.id && user.isFollowed" class="followed">{{ $ts.followsYou }}</span>
< 	<div class="description">
< 		<div v-if="user.description" class="mfm">
< 			<Mfm :text="user.description" :author="user" :i="$i"/>
< 		</div>
< 		<span v-else style="opacity: 0.7;">{{ i18n.ts.noAccountDescription }}</span>
< 	</div>
< 	<div class="status">
< 		<div>
< 			<p>{{ i18n.ts.notes }}</p><span>{{ user.notesCount }}</span>
< 		</div>
< 		<div>
< 			<p>{{ i18n.ts.following }}</p><span>{{ user.followingCount }}</span>
< 		</div>
< 		<div>
< 			<p>{{ i18n.ts.followers }}</p><span>{{ user.followersCount }}</span>
< 		</div>
< 	</div>
< 	<MkFollowButton v-if="$i && user.id != $i.id" class="koudoku-button" :user="user" mini/>
< </div>
---
>   <div class="_panel vjnjpkug">
>     <div
>       class="banner"
>       :style="user.bannerUrl ? `background-image: url(${user.bannerUrl})` : ''"
>     ></div>
>     <MkAvatar
>       class="avatar"
>       :user="user"
>       :disable-preview="true"
>       :show-indicator="true"
>     />
>     <div class="title">
>       <MkA class="name" :to="userPage(user)"
>         ><MkUserName :user="user" :nowrap="false"
>       /></MkA>
>       <p class="username"><MkAcct :user="user" /></p>
>     </div>
>     <span v-if="$i && $i.id !== user.id && user.isFollowed" class="followed">{{
>       $ts.followsYou
>     }}</span>
>     <div class="description">
>       <div v-if="user.description" class="mfm">
>         <Mfm
>           :text="user.description"
>           :author="user"
>           :i="$i"
>           :custom-emojis="user.emojis"
>         />
>       </div>
>       <span v-else style="opacity: 0.7">{{
>         i18n.ts.noAccountDescription
>       }}</span>
>     </div>
>     <div class="status">
>       <div>
>         <p>{{ i18n.ts.notes }}</p>
>         <span>{{ user.notesCount }}</span>
>       </div>
>       <div>
>         <p>{{ i18n.ts.following }}</p>
>         <span>{{ user.followingCount }}</span>
>       </div>
>       <div>
>         <p>{{ i18n.ts.followers }}</p>
>         <span>{{ user.followersCount }}</span>
>       </div>
>     </div>
>     <MkFollowButton
>       v-if="$i && user.id != $i.id"
>       class="koudoku-button"
>       :user="user"
>       mini
>     />
>   </div>
32,35c59,62
< import * as misskey from 'misskey-js';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import { userPage } from '@/filters/user';
< import { i18n } from '@/i18n';
---
> import * as misskey from "misskey-js";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import { userPage } from "@/filters/user";
> import { i18n } from "@/i18n";
38c65
< 	user: misskey.entities.UserDetailed;
---
>   user: misskey.entities.UserDetailed;
44c71
< 	position: relative;
---
>   position: relative;
46,51c73,78
< 	> .banner {
< 		height: 84px;
< 		background-color: rgba(0, 0, 0, 0.1);
< 		background-size: cover;
< 		background-position: center;
< 	}
---
>   > .banner {
>     height: 84px;
>     background-color: rgba(0, 0, 0, 0.1);
>     background-size: cover;
>     background-position: center;
>   }
53,62c80,89
< 	> .avatar {
< 		display: block;
< 		position: absolute;
< 		top: 62px;
< 		left: 13px;
< 		z-index: 2;
< 		width: 58px;
< 		height: 58px;
< 		border: solid 4px var(--panel);
< 	}
---
>   > .avatar {
>     display: block;
>     position: absolute;
>     top: 62px;
>     left: 13px;
>     z-index: 2;
>     width: 58px;
>     height: 58px;
>     border: solid 4px var(--panel);
>   }
64,66c91,93
< 	> .title {
< 		display: block;
< 		padding: 10px 0 10px 88px;
---
>   > .title {
>     display: block;
>     padding: 10px 0 10px 88px;
68,74c95,101
< 		> .name {
< 			display: inline-block;
< 			margin: 0;
< 			font-weight: bold;
< 			line-height: 16px;
< 			word-break: break-all;
< 		}
---
>     > .name {
>       display: inline-block;
>       margin: 0;
>       font-weight: bold;
>       line-height: 16px;
>       word-break: break-all;
>     }
76,100c103,111
< 		> .username {
< 			display: block;
< 			margin: 0;
< 			line-height: 16px;
< 			font-size: 0.8em;
< 			color: var(--fg);
< 			opacity: 0.7;
< 		}
< 	}
< 	
< 	> .followed {
< 		position: absolute;
< 		top: 12px;
< 		left: 12px;
< 		padding: 4px 8px;
< 		color: #fff;
< 		background: rgba(0, 0, 0, 0.7);
< 		font-size: 0.7em;
< 		border-radius: 6px;
< 	}
< 	
< 	> .description {
< 		padding: 16px;
< 		font-size: 0.8em;
< 		border-top: solid 0.5px var(--divider);
---
>     > .username {
>       display: block;
>       margin: 0;
>       line-height: 16px;
>       font-size: 0.8em;
>       color: var(--fg);
>       opacity: 0.7;
>     }
>   }
102,108c113,122
< 		> .mfm {
< 			display: -webkit-box;
< 			-webkit-line-clamp: 3;
< 			-webkit-box-orient: vertical;  
< 			overflow: hidden;
< 		}
< 	}
---
>   > .followed {
>     position: absolute;
>     top: 12px;
>     left: 12px;
>     padding: 4px 8px;
>     color: #fff;
>     background: rgba(0, 0, 0, 0.7);
>     font-size: 0.7em;
>     border-radius: 6px;
>   }
110,112c124,127
< 	> .status {
< 		padding: 10px 16px;
< 		border-top: solid 0.5px var(--divider);
---
>   > .description {
>     padding: 16px;
>     font-size: 0.8em;
>     border-top: solid 0.5px var(--divider);
114,116c129,135
< 		> div {
< 			display: inline-block;
< 			width: 33%;
---
>     > .mfm {
>       display: -webkit-box;
>       -webkit-line-clamp: 3;
>       -webkit-box-orient: vertical;
>       overflow: hidden;
>     }
>   }
118,122c137,139
< 			> p {
< 				margin: 0;
< 				font-size: 0.7em;
< 				color: var(--fg);
< 			}
---
>   > .status {
>     padding: 10px 16px;
>     border-top: solid 0.5px var(--divider);
124,129c141,143
< 			> span {
< 				font-size: 1em;
< 				color: var(--accent);
< 			}
< 		}
< 	}
---
>     > div {
>       display: inline-block;
>       width: 33%;
131,135c145,162
< 	> .koudoku-button {
< 		position: absolute;
< 		top: 8px;
< 		right: 8px;
< 	}
---
>       > p {
>         margin: 0;
>         font-size: 0.7em;
>         color: var(--fg);
>       }
> 
>       > span {
>         font-size: 1em;
>         color: var(--accent);
>       }
>     }
>   }
> 
>   > .koudoku-button {
>     position: absolute;
>     top: 8px;
>     right: 8px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserList.vue RiricaV13/components/MkUserList.vue
2,8c2,8
< <MkPagination :pagination="pagination">
< 	<template #empty>
< 		<div class="_fullinfo">
< 			<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 			<div>{{ i18n.ts.noUsers }}</div>
< 		</div>
< 	</template>
---
>   <MkPagination ref="pagingComponent" :pagination="pagination">
>     <template #empty>
>       <div class="_fullinfo">
>         <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>         <div>{{ i18n.ts.noUsers }}</div>
>       </div>
>     </template>
10,15c10,20
< 	<template #default="{ items: users }">
< 		<div class="efvhhmdq">
< 			<MkUserInfo v-for="user in users" :key="user.id" class="user" :user="user"/>
< 		</div>
< 	</template>
< </MkPagination>
---
>     <template #default="{ items: users }">
>       <div class="efvhhmdq">
>         <MkUserInfo
>           v-for="user in users"
>           :key="user.id"
>           class="user"
>           :user="user"
>         />
>       </div>
>     </template>
>   </MkPagination>
19,23c24,28
< import { shallowRef } from 'vue';
< import MkUserInfo from '@/components/MkUserInfo.vue';
< import MkPagination, { Paging } from '@/components/MkPagination.vue';
< import { userPage } from '@/filters/user';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import MkUserInfo from "@/components/MkUserInfo.vue";
> import MkPagination, { Paging } from "@/components/MkPagination.vue";
> import { userPage } from "@/filters/user";
> import { i18n } from "@/i18n";
26,27c31,32
< 	pagination: Paging;
< 	noGap?: boolean;
---
>   pagination: Paging;
>   noGap?: boolean;
28a34,35
> 
> const pagingComponent = ref<InstanceType<typeof MkPagination>>();
33,35c40,42
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
< 	grid-gap: var(--margin);
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
>   grid-gap: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserOnlineIndicator.vue RiricaV13/components/MkUserOnlineIndicator.vue
2c2
< <div v-tooltip="text" :class="[$style.root, $style['status_' + user.onlineStatus]]"></div>
---
>   <div v-tooltip="text" class="fzgwjkgc" :class="user.onlineStatus"></div>
6,8c6,8
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import { i18n } from "@/i18n";
11c11
< 	user: misskey.entities.User;
---
>   user: misskey.entities.User;
15,20c15,24
< 	switch (props.user.onlineStatus) {
< 		case 'online': return i18n.ts.online;
< 		case 'active': return i18n.ts.active;
< 		case 'offline': return i18n.ts.offline;
< 		case 'unknown': return i18n.ts.unknown;
< 	}
---
>   switch (props.user.onlineStatus) {
>     case "online":
>       return i18n.ts.online;
>     case "active":
>       return i18n.ts.active;
>     case "offline":
>       return i18n.ts.offline;
>     case "unknown":
>       return i18n.ts.unknown;
>   }
24,27c28,31
< <style lang="scss" module>
< .root {
< 	box-shadow: 0 0 0 3px var(--panel);
< 	border-radius: 120%; // Blinkのバグか知らんけど、100%ぴったりにすると何故か若干楕円でレンダリングされる
---
> <style lang="scss" scoped>
> .fzgwjkgc {
>   box-shadow: 0 0 0 3px var(--panel);
>   border-radius: 120%; // Blinkのバグか知らんけど、100%ぴったりにすると何故か若干楕円でレンダリングされる
29,31c33,35
< 	&.status_online {
< 		background: #58d4c9;
< 	}
---
>   &.online {
>     background: #58d4c9;
>   }
33,35c37,39
< 	&.status_active {
< 		background: #e4bc48;
< 	}
---
>   &.active {
>     background: #e4bc48;
>   }
37,39c41,43
< 	&.status_offline {
< 		background: #ea5353;
< 	}
---
>   &.offline {
>     background: #ea5353;
>   }
41,43c45,47
< 	&.status_unknown {
< 		background: #888;
< 	}
---
>   &.unknown {
>     background: #888;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserPreview.vue RiricaV13/components/MkUserPreview.vue
2,33c2,81
< <Transition :name="$store.state.animation ? 'popup' : ''" appear @after-leave="emit('closed')">
< 	<div v-if="showing" class="fxxzrfni _popup _shadow" :style="{ zIndex, top: top + 'px', left: left + 'px' }" @mouseover="() => { emit('mouseover'); }" @mouseleave="() => { emit('mouseleave'); }">
< 		<div v-if="user != null" class="info">
< 			<div class="banner" :style="user.bannerUrl ? `background-image: url(${user.bannerUrl})` : ''">
< 				<span v-if="$i && $i.id != user.id && user.isFollowed" class="followed">{{ $ts.followsYou }}</span>
< 			</div>
< 			<MkAvatar class="avatar" :user="user" indicator/>
< 			<div class="title">
< 				<MkA class="name" :to="userPage(user)"><MkUserName :user="user" :nowrap="false"/></MkA>
< 				<p class="username"><MkAcct :user="user"/></p>
< 			</div>
< 			<div class="description">
< 				<Mfm v-if="user.description" :text="user.description" :author="user" :i="$i"/>
< 			</div>
< 			<div class="status">
< 				<div>
< 					<p>{{ $ts.notes }}</p><span>{{ user.notesCount }}</span>
< 				</div>
< 				<div>
< 					<p>{{ $ts.following }}</p><span>{{ user.followingCount }}</span>
< 				</div>
< 				<div>
< 					<p>{{ $ts.followers }}</p><span>{{ user.followersCount }}</span>
< 				</div>
< 			</div>
< 			<MkFollowButton v-if="$i && user.id != $i.id" class="koudoku-button" :user="user" mini/>
< 		</div>
< 		<div v-else>
< 			<MkLoading/>
< 		</div>
< 	</div>
< </Transition>
---
>   <transition
>     :name="$store.state.animation ? 'popup' : ''"
>     appear
>     @after-leave="emit('closed')"
>   >
>     <div
>       v-if="showing"
>       class="fxxzrfni _popup _shadow"
>       :style="{ zIndex, top: top + 'px', left: left + 'px' }"
>       @mouseover="
>         () => {
>           emit('mouseover');
>         }
>       "
>       @mouseleave="
>         () => {
>           emit('mouseleave');
>         }
>       "
>     >
>       <div v-if="user != null" class="info">
>         <div
>           class="banner"
>           :style="
>             user.bannerUrl ? `background-image: url(${user.bannerUrl})` : ''
>           "
>         >
>           <span
>             v-if="$i && $i.id != user.id && user.isFollowed"
>             class="followed"
>             >{{ $ts.followsYou }}</span
>           >
>         </div>
>         <MkAvatar
>           class="avatar"
>           :user="user"
>           :disable-preview="true"
>           :show-indicator="true"
>         />
>         <div class="title">
>           <MkA class="name" :to="userPage(user)"
>             ><MkUserName :user="user" :nowrap="false"
>           /></MkA>
>           <p class="username"><MkAcct :user="user" /></p>
>         </div>
>         <div class="description">
>           <Mfm
>             v-if="user.description"
>             :text="user.description"
>             :author="user"
>             :i="$i"
>             :custom-emojis="user.emojis"
>           />
>         </div>
>         <div class="status">
>           <div>
>             <p>{{ $ts.notes }}</p>
>             <span>{{ user.notesCount }}</span>
>           </div>
>           <div>
>             <p>{{ $ts.following }}</p>
>             <span>{{ user.followingCount }}</span>
>           </div>
>           <div>
>             <p>{{ $ts.followers }}</p>
>             <span>{{ user.followersCount }}</span>
>           </div>
>         </div>
>         <MkFollowButton
>           v-if="$i && user.id != $i.id"
>           class="koudoku-button"
>           :user="user"
>           mini
>         />
>       </div>
>       <div v-else>
>         <MkLoading />
>       </div>
>     </div>
>   </transition>
37,42c85,90
< import { onMounted } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import * as misskey from 'misskey-js';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import { userPage } from '@/filters/user';
< import * as os from '@/os';
---
> import { onMounted } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import * as misskey from "misskey-js";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import { userPage } from "@/filters/user";
> import * as os from "@/os";
45,47c93,95
< 	showing: boolean;
< 	q: string;
< 	source: HTMLElement;
---
>   showing: boolean;
>   q: string;
>   source: HTMLElement;
51,53c99,101
< 	(ev: 'closed'): void;
< 	(ev: 'mouseover'): void;
< 	(ev: 'mouseleave'): void;
---
>   (ev: "closed"): void;
>   (ev: "mouseover"): void;
>   (ev: "mouseleave"): void;
56c104
< const zIndex = os.claimZIndex('middle');
---
> const zIndex = os.claimZIndex("middle");
62,67c110,115
< 	if (typeof props.q === 'object') {
< 		user = props.q;
< 	} else {
< 		const query = props.q.startsWith('@') ?
< 			Acct.parse(props.q.substr(1)) :
< 			{ userId: props.q };
---
>   if (typeof props.q === "object") {
>     user = props.q;
>   } else {
>     const query = props.q.startsWith("@")
>       ? Acct.parse(props.q.substr(1))
>       : { userId: props.q };
69,73c117,121
< 		os.api('users/show', query).then(res => {
< 			if (!props.showing) return;
< 			user = res;
< 		});
< 	}
---
>     os.api("users/show", query).then((res) => {
>       if (!props.showing) return;
>       user = res;
>     });
>   }
75,77c123,126
< 	const rect = props.source.getBoundingClientRect();
< 	const x = ((rect.left + (props.source.offsetWidth / 2)) - (300 / 2)) + window.pageXOffset;
< 	const y = rect.top + props.source.offsetHeight + window.pageYOffset;
---
>   const rect = props.source.getBoundingClientRect();
>   const x =
>     rect.left + props.source.offsetWidth / 2 - 300 / 2 + window.pageXOffset;
>   const y = rect.top + props.source.offsetHeight + window.pageYOffset;
79,80c128,129
< 	top = y;
< 	left = x;
---
>   top = y;
>   left = x;
85,86c134,136
< .popup-enter-active, .popup-leave-active {
< 	transition: opacity 0.3s, transform 0.3s !important;
---
> .popup-enter-active,
> .popup-leave-active {
>   transition: opacity 0.3s, transform 0.3s !important;
88,90c138,141
< .popup-enter-from, .popup-leave-to {
< 	opacity: 0;
< 	transform: scale(0.9);
---
> .popup-enter-from,
> .popup-leave-to {
>   opacity: 0;
>   transform: scale(0.9);
94,97c145,148
< 	position: absolute;
< 	width: 300px;
< 	overflow: hidden;
< 	transform-origin: center top;
---
>   position: absolute;
>   width: 300px;
>   overflow: hidden;
>   transform-origin: center top;
99,115c150,166
< 	> .info {
< 		> .banner {
< 			height: 84px;
< 			background-color: rgba(0, 0, 0, 0.1);
< 			background-size: cover;
< 			background-position: center;
< 			> .followed {
< 					position: absolute;
< 					top: 12px;
< 					left: 12px;
< 					padding: 4px 8px;
< 					color: #fff;
< 					background: rgba(0, 0, 0, 0.7);
< 					font-size: 0.7em;
< 					border-radius: 6px;
< 			}
< 		}
---
>   > .info {
>     > .banner {
>       height: 84px;
>       background-color: rgba(0, 0, 0, 0.1);
>       background-size: cover;
>       background-position: center;
>       > .followed {
>         position: absolute;
>         top: 12px;
>         left: 12px;
>         padding: 4px 8px;
>         color: #fff;
>         background: rgba(0, 0, 0, 0.7);
>         font-size: 0.7em;
>         border-radius: 6px;
>       }
>     }
117,127c168,178
< 		> .avatar {
< 			display: block;
< 			position: absolute;
< 			top: 62px;
< 			left: 13px;
< 			z-index: 2;
< 			width: 58px;
< 			height: 58px;
< 			border: solid 3px var(--face);
< 			border-radius: 8px;
< 		}
---
>     > .avatar {
>       display: block;
>       position: absolute;
>       top: 62px;
>       left: 13px;
>       z-index: 2;
>       width: 58px;
>       height: 58px;
>       border: solid 3px var(--face);
>       border-radius: 8px;
>     }
129,131c180,182
< 		> .title {
< 			display: block;
< 			padding: 8px 0 8px 82px;
---
>     > .title {
>       display: block;
>       padding: 8px 0 8px 82px;
133,139c184,190
< 			> .name {
< 				display: inline-block;
< 				margin: 0;
< 				font-weight: bold;
< 				line-height: 16px;
< 				word-break: break-all;
< 			}
---
>       > .name {
>         display: inline-block;
>         margin: 0;
>         font-weight: bold;
>         line-height: 16px;
>         word-break: break-all;
>       }
141,149c192,200
< 			> .username {
< 				display: block;
< 				margin: 0;
< 				line-height: 16px;
< 				font-size: 0.8em;
< 				color: var(--fg);
< 				opacity: 0.7;
< 			}
< 		}
---
>       > .username {
>         display: block;
>         margin: 0;
>         line-height: 16px;
>         font-size: 0.8em;
>         color: var(--fg);
>         opacity: 0.7;
>       }
>     }
151,155c202,206
< 		> .description {
< 			padding: 0 16px;
< 			font-size: 0.8em;
< 			color: var(--fg);
< 		}
---
>     > .description {
>       padding: 0 16px;
>       font-size: 0.8em;
>       color: var(--fg);
>     }
157,158c208,209
< 		> .status {
< 			padding: 8px 16px;
---
>     > .status {
>       padding: 8px 16px;
160,162c211,213
< 			> div {
< 				display: inline-block;
< 				width: 33%;
---
>       > div {
>         display: inline-block;
>         width: 33%;
164,168c215,219
< 				> p {
< 					margin: 0;
< 					font-size: 0.7em;
< 					color: var(--fg);
< 				}
---
>         > p {
>           margin: 0;
>           font-size: 0.7em;
>           color: var(--fg);
>         }
170,175c221,226
< 				> span {
< 					font-size: 1em;
< 					color: var(--accent);
< 				}
< 			}
< 		}
---
>         > span {
>           font-size: 1em;
>           color: var(--accent);
>         }
>       }
>     }
177,182c228,233
< 		> .koudoku-button {
< 			position: absolute;
< 			top: 8px;
< 			right: 8px;
< 		}
< 	}
---
>     > .koudoku-button {
>       position: absolute;
>       top: 8px;
>       right: 8px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUserSelectDialog.vue RiricaV13/components/MkUserSelectDialog.vue
2,51c2,73
< <MkModalWindow
< 	ref="dialogEl"
< 	:with-ok-button="true"
< 	:ok-button-disabled="selected == null"
< 	@click="cancel()"
< 	@close="cancel()"
< 	@ok="ok()"
< 	@closed="$emit('closed')"
< >
< 	<template #header>{{ i18n.ts.selectUser }}</template>
< 	<div :class="$style.root">
< 		<div :class="$style.form">
< 			<FormSplit :min-width="170">
< 				<MkInput v-model="username" :autofocus="true" @update:model-value="search">
< 					<template #label>{{ i18n.ts.username }}</template>
< 					<template #prefix>@</template>
< 				</MkInput>
< 				<MkInput v-model="host" @update:model-value="search">
< 					<template #label>{{ i18n.ts.host }}</template>
< 					<template #prefix>@</template>
< 				</MkInput>
< 			</FormSplit>
< 		</div>
< 		<div v-if="username != '' || host != ''" :class="[$style.result, { [$style.hit]: users.length > 0 }]">
< 			<div v-if="users.length > 0" :class="$style.users">
< 				<div v-for="user in users" :key="user.id" class="_button" :class="[$style.user, { [$style.selected]: selected && selected.id === user.id }]" @click="selected = user" @dblclick="ok()">
< 					<MkAvatar :user="user" :class="$style.avatar" indicator/>
< 					<div :class="$style.userBody">
< 						<MkUserName :user="user" :class="$style.userName"/>
< 						<MkAcct :user="user" :class="$style.userAcct"/>
< 					</div>
< 				</div>
< 			</div>
< 			<div v-else :class="$style.empty">
< 				<span>{{ i18n.ts.noUsers }}</span>
< 			</div>
< 		</div>
< 		<div v-if="username == '' && host == ''" :class="$style.recent">
< 			<div :class="$style.users">
< 				<div v-for="user in recentUsers" :key="user.id" class="_button" :class="[$style.user, { [$style.selected]: selected && selected.id === user.id }]" @click="selected = user" @dblclick="ok()">
< 					<MkAvatar :user="user" :class="$style.avatar" indicator/>
< 					<div :class="$style.userBody">
< 						<MkUserName :user="user" :class="$style.userName"/>
< 						<MkAcct :user="user" :class="$style.userAcct"/>
< 					</div>
< 				</div>
< 			</div>
< 		</div>
< 	</div>
< </MkModalWindow>
---
>   <XModalWindow
>     ref="dialogEl"
>     :with-ok-button="true"
>     :ok-button-disabled="selected == null"
>     @click="cancel()"
>     @close="cancel()"
>     @ok="ok()"
>     @closed="$emit('closed')"
>   >
>     <template #header>{{ i18n.ts.selectUser }}</template>
>     <div class="tbhwbxda">
>       <div class="form">
>         <FormSplit :min-width="170">
>           <MkInput
>             v-model="username"
>             :autofocus="true"
>             @update:modelValue="search"
>           >
>             <template #label>{{ i18n.ts.username }}</template>
>             <template #prefix>@</template>
>           </MkInput>
>           <MkInput v-model="host" @update:modelValue="search">
>             <template #label>{{ i18n.ts.host }}</template>
>             <template #prefix>@</template>
>           </MkInput>
>         </FormSplit>
>       </div>
>       <div
>         v-if="username != '' || host != ''"
>         class="result"
>         :class="{ hit: users.length > 0 }"
>       >
>         <div v-if="users.length > 0" class="users">
>           <div
>             v-for="user in users"
>             :key="user.id"
>             class="user"
>             :class="{ selected: selected && selected.id === user.id }"
>             @click="selected = user"
>             @dblclick="ok()"
>           >
>             <MkAvatar :user="user" class="avatar" :show-indicator="true" />
>             <div class="body">
>               <MkUserName :user="user" class="name" />
>               <MkAcct :user="user" class="acct" />
>             </div>
>           </div>
>         </div>
>         <div v-else class="empty">
>           <span>{{ i18n.ts.noUsers }}</span>
>         </div>
>       </div>
>       <div v-if="username == '' && host == ''" class="recent">
>         <div class="users">
>           <div
>             v-for="user in recentUsers"
>             :key="user.id"
>             class="user"
>             :class="{ selected: selected && selected.id === user.id }"
>             @click="selected = user"
>             @dblclick="ok()"
>           >
>             <MkAvatar :user="user" class="avatar" :show-indicator="true" />
>             <div class="body">
>               <MkUserName :user="user" class="name" />
>               <MkAcct :user="user" class="acct" />
>             </div>
>           </div>
>         </div>
>       </div>
>     </div>
>   </XModalWindow>
55,63c77,84
< import { nextTick, onMounted } from 'vue';
< import * as misskey from 'misskey-js';
< import MkInput from '@/components/MkInput.vue';
< import FormSplit from '@/components/form/split.vue';
< import MkModalWindow from '@/components/MkModalWindow.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
---
> import { nextTick, onMounted } from "vue";
> import * as misskey from "misskey-js";
> import MkInput from "@/components/form/input.vue";
> import FormSplit from "@/components/form/split.vue";
> import XModalWindow from "@/components/MkModalWindow.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
66,68c87,89
< 	(ev: 'ok', selected: misskey.entities.UserDetailed): void;
< 	(ev: 'cancel'): void;
< 	(ev: 'closed'): void;
---
>   (ev: "ok", selected: misskey.entities.UserDetailed): void;
>   (ev: "cancel"): void;
>   (ev: "closed"): void;
71,76c92,93
< const props = defineProps<{
< 	includeSelf?: boolean;
< }>();
< 
< let username = $ref('');
< let host = $ref('');
---
> let username = $ref("");
> let host = $ref("");
83,94c100,111
< 	if (username === '' && host === '') {
< 		users = [];
< 		return;
< 	}
< 	os.api('users/search-by-username-and-host', {
< 		username: username,
< 		host: host,
< 		limit: 10,
< 		detail: false,
< 	}).then(_users => {
< 		users = _users;
< 	});
---
>   if (username === "" && host === "") {
>     users = [];
>     return;
>   }
>   os.api("users/search-by-username-and-host", {
>     username: username,
>     host: host,
>     limit: 10,
>     detail: false,
>   }).then((_users) => {
>     users = _users;
>   });
98,100c115,117
< 	if (selected == null) return;
< 	emit('ok', selected);
< 	dialogEl.close();
---
>   if (selected == null) return;
>   emit("ok", selected);
>   dialogEl.close();
102,106c119,123
< 	// 最近使ったユーザー更新
< 	let recents = defaultStore.state.recentlyUsedUsers;
< 	recents = recents.filter(x => x !== selected.id);
< 	recents.unshift(selected.id);
< 	defaultStore.set('recentlyUsedUsers', recents.splice(0, 16));
---
>   // 最近使ったユーザー更新
>   let recents = defaultStore.state.recentlyUsedUsers;
>   recents = recents.filter((x) => x !== selected.id);
>   recents.unshift(selected.id);
>   defaultStore.set("recentlyUsedUsers", recents.splice(0, 16));
110,111c127,128
< 	emit('cancel');
< 	dialogEl.close();
---
>   emit("cancel");
>   dialogEl.close();
115,123c132,136
< 	os.api('users/show', {
< 		userIds: defaultStore.state.recentlyUsedUsers,
< 	}).then(users => {
< 		if (props.includeSelf) {
< 			recentUsers = [$i, ...users];
< 		} else {
< 			recentUsers = users;
< 		}
< 	});
---
>   os.api("users/show", {
>     userIds: defaultStore.state.recentlyUsedUsers,
>   }).then((users) => {
>     recentUsers = users;
>   });
127,129c140,144
< <style lang="scss" module>
< .root {
< }
---
> <style lang="scss" scoped>
> .tbhwbxda {
>   > .form {
>     padding: 0 var(--root-margin);
>   }
131,133c146,151
< .form {
< 	padding: 0 var(--root-margin);
< }
---
>   > .result,
>   > .recent {
>     display: flex;
>     flex-direction: column;
>     overflow: auto;
>     height: 100%;
135,140c153,155
< .result,
< .recent {
< 	display: flex;
< 	flex-direction: column;
< 	overflow: auto;
< 	height: 100%;
---
>     &.result.hit {
>       padding: 0;
>     }
142,144c157,159
< 	&.result.hit {
< 		padding: 0;
< 	}
---
>     &.recent {
>       padding: 0;
>     }
146,149c161,164
< 	&.recent {
< 		padding: 0;
< 	}
< }
---
>     > .users {
>       flex: 1;
>       overflow: auto;
>       padding: 8px 0;
151,155c166,170
< .users {
< 	flex: 1;
< 	overflow: auto;
< 	padding: 8px 0;
< }
---
>       > .user {
>         display: flex;
>         align-items: center;
>         padding: 8px var(--root-margin);
>         font-size: 14px;
157,161c172,174
< .user {
< 	display: flex;
< 	align-items: center;
< 	padding: 8px var(--root-margin);
< 	font-size: 14px;
---
>         &:hover {
>           background: var(--X7);
>         }
163,165c176,179
< 	&:hover {
< 		background: var(--X7);
< 	}
---
>         &.selected {
>           background: var(--accent);
>           color: #fff;
>         }
167,171c181,184
< 	&.selected {
< 		background: var(--accent);
< 		color: #fff;
< 	}
< }
---
>         > * {
>           pointer-events: none;
>           user-select: none;
>         }
173,176c186,189
< .userBody {
< 	padding: 0 8px;
< 	min-width: 0;
< }
---
>         > .avatar {
>           width: 45px;
>           height: 45px;
>         }
178,181c191,193
< .avatar {
< 	width: 45px;
< 	height: 45px;
< }
---
>         > .body {
>           padding: 0 8px;
>           min-width: 0;
183,186c195,198
< .userName {
< 	display: block;
< 	font-weight: bold;
< }
---
>           > .name {
>             display: block;
>             font-weight: bold;
>           }
188,190c200,205
< .userAcct {
< 	opacity: 0.5;
< }
---
>           > .acct {
>             opacity: 0.5;
>           }
>         }
>       }
>     }
192,195c207,211
< .empty {
< 	opacity: 0.7;
< 	text-align: center;
< 	padding: 16px;
---
>     > .empty {
>       opacity: 0.7;
>       text-align: center;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkUsersTooltip.vue RiricaV13/components/MkUsersTooltip.vue
2,10c2,17
< <MkTooltip ref="tooltip" :showing="showing" :target-element="targetElement" :max-width="250" @closed="emit('closed')">
< 	<div :class="$style.root">
< 		<div v-for="u in users" :key="u.id" :class="$style.user">
< 			<MkAvatar :class="$style.avatar" :user="u"/>
< 			<MkUserName :class="$style.name" :user="u" :nowrap="true"/>
< 		</div>
< 		<div v-if="users.length < count" :class="$style.omitted">+{{ count - users.length }}</div>
< 	</div>
< </MkTooltip>
---
>   <MkTooltip
>     ref="tooltip"
>     :target-element="targetElement"
>     :max-width="250"
>     @closed="emit('closed')"
>   >
>     <div class="beaffaef">
>       <div v-for="u in users" :key="u.id" class="user">
>         <MkAvatar class="avatar" :user="u" />
>         <MkUserName class="name" :user="u" :nowrap="true" />
>       </div>
>       <div v-if="users.length < count" class="omitted">
>         +{{ count - users.length }}
>       </div>
>     </div>
>   </MkTooltip>
14,15c21,22
< import { } from 'vue';
< import MkTooltip from './MkTooltip.vue';
---
> import {} from "vue";
> import MkTooltip from "./MkTooltip.vue";
17,21c24,27
< defineProps<{
< 	showing: boolean;
< 	users: any[]; // TODO
< 	count: number;
< 	targetElement: HTMLElement;
---
> const props = defineProps<{
>   users: any[]; // TODO
>   count: number;
>   targetElement: HTMLElement;
25c31
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
29,33c35,38
< <style lang="scss" module>
< .root {
< 	font-size: 0.9em;
< 	text-align: left;
< }
---
> <style lang="scss" scoped>
> .beaffaef {
>   font-size: 0.9em;
>   text-align: left;
35,39c40,44
< .user {
< 	line-height: 24px;
< 	white-space: nowrap;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
---
>   > .user {
>     line-height: 24px;
>     white-space: nowrap;
>     overflow: hidden;
>     text-overflow: ellipsis;
41,44c46,48
< 	&:not(:last-child) {
< 		margin-bottom: 3px;
< 	}
< }
---
>     &:not(:last-child) {
>       margin-bottom: 3px;
>     }
46,57c50,55
< .name {
< 
< }
< 
< .omitted {
< 	
< }
< 
< .avatar {
< 	width: 24px;
< 	height: 24px;
< 	margin-right: 3px;
---
>     > .avatar {
>       width: 24px;
>       height: 24px;
>       margin-right: 3px;
>     }
>   }
Only in RiricaV13/components: MkVisibility.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkVisibilityPicker.vue RiricaV13/components/MkVisibilityPicker.vue
2,42c2,81
< <MkModal ref="modal" :z-priority="'high'" :src="src" @click="modal.close()" @closed="emit('closed')">
< 	<div class="_popup" :class="$style.root">
< 		<button key="public" class="_button" :class="[$style.item, { [$style.active]: v === 'public' }]" data-index="1" @click="choose('public')">
< 			<div :class="$style.icon"><i class="ti ti-world"></i></div>
< 			<div :class="$style.body">
< 				<span :class="$style.itemTitle">{{ i18n.ts._visibility.public }}</span>
< 				<span :class="$style.itemDescription">{{ i18n.ts._visibility.publicDescription }}</span>
< 			</div>
< 		</button>
< 		<button key="home" class="_button" :class="[$style.item, { [$style.active]: v === 'home' }]" data-index="2" @click="choose('home')">
< 			<div :class="$style.icon"><i class="ti ti-home"></i></div>
< 			<div :class="$style.body">
< 				<span :class="$style.itemTitle">{{ i18n.ts._visibility.home }}</span>
< 				<span :class="$style.itemDescription">{{ i18n.ts._visibility.homeDescription }}</span>
< 			</div>
< 		</button>
< 		<button key="followers" class="_button" :class="[$style.item, { [$style.active]: v === 'followers' }]" data-index="3" @click="choose('followers')">
< 			<div :class="$style.icon"><i class="ti ti-lock"></i></div>
< 			<div :class="$style.body">
< 				<span :class="$style.itemTitle">{{ i18n.ts._visibility.followers }}</span>
< 				<span :class="$style.itemDescription">{{ i18n.ts._visibility.followersDescription }}</span>
< 			</div>
< 		</button>
< 		<button key="specified" :disabled="localOnly" class="_button" :class="[$style.item, { [$style.active]: v === 'specified' }]" data-index="4" @click="choose('specified')">
< 			<div :class="$style.icon"><i class="ti ti-mail"></i></div>
< 			<div :class="$style.body">
< 				<span :class="$style.itemTitle">{{ i18n.ts._visibility.specified }}</span>
< 				<span :class="$style.itemDescription">{{ i18n.ts._visibility.specifiedDescription }}</span>
< 			</div>
< 		</button>
< 		<div :class="$style.divider"></div>
< 		<button key="localOnly" class="_button" :class="[$style.item, $style.localOnly, { [$style.active]: localOnly }]" data-index="5" @click="localOnly = !localOnly">
< 			<div :class="$style.icon"><i class="ti ti-world-off"></i></div>
< 			<div :class="$style.body">
< 				<span :class="$style.itemTitle">{{ i18n.ts._visibility.localOnly }}</span>
< 				<span :class="$style.itemDescription">{{ i18n.ts._visibility.localOnlyDescription }}</span>
< 			</div>
< 			<div :class="$style.toggle"><i :class="localOnly ? 'ti ti-toggle-right' : 'ti ti-toggle-left'"></i></div>
< 		</button>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :z-priority="'high'"
>     :src="src"
>     @click="modal.close()"
>     @closed="emit('closed')"
>   >
>     <div class="gqyayizv _popup">
>       <button
>         key="public"
>         class="_button"
>         :class="{ active: v === 'public' }"
>         data-index="1"
>         @click="choose('public')"
>       >
>         <div><i class="fas fa-globe"></i></div>
>         <div>
>           <span>{{ i18n.ts._visibility.public }}</span>
>           <span>{{ i18n.ts._visibility.publicDescription }}</span>
>         </div>
>       </button>
>       <button
>         key="home"
>         class="_button"
>         :class="{ active: v === 'home' }"
>         data-index="2"
>         @click="choose('home')"
>       >
>         <div><i class="fas fa-home"></i></div>
>         <div>
>           <span>{{ i18n.ts._visibility.home }}</span>
>           <span>{{ i18n.ts._visibility.homeDescription }}</span>
>         </div>
>       </button>
>       <button
>         key="followers"
>         class="_button"
>         :class="{ active: v === 'followers' }"
>         data-index="3"
>         @click="choose('followers')"
>       >
>         <div><i class="fas fa-unlock"></i></div>
>         <div>
>           <span>{{ i18n.ts._visibility.followers }}</span>
>           <span>{{ i18n.ts._visibility.followersDescription }}</span>
>         </div>
>       </button>
>       <button
>         key="specified"
>         :disabled="localOnly"
>         class="_button"
>         :class="{ active: v === 'specified' }"
>         data-index="4"
>         @click="choose('specified')"
>       >
>         <div><i class="fas fa-envelope"></i></div>
>         <div>
>           <span>{{ i18n.ts._visibility.specified }}</span>
>           <span>{{ i18n.ts._visibility.specifiedDescription }}</span>
>         </div>
>       </button>
>       <div class="divider"></div>
>       <button
>         key="localOnly"
>         class="_button localOnly"
>         :class="{ active: localOnly }"
>         data-index="5"
>         @click="localOnly = !localOnly"
>       >
>         <div><i class="fas fa-biohazard"></i></div>
>         <div>
>           <span>{{ i18n.ts._visibility.localOnly }}</span>
>           <span>{{ i18n.ts._visibility.localOnlyDescription }}</span>
>         </div>
>         <div>
>           <i :class="localOnly ? 'fas fa-toggle-on' : 'fas fa-toggle-off'"></i>
>         </div>
>       </button>
>     </div>
>   </MkModal>
46,49c85,88
< import { nextTick, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import MkModal from '@/components/MkModal.vue';
< import { i18n } from '@/i18n';
---
> import { nextTick, watch } from "vue";
> import * as misskey from "misskey-js";
> import MkModal from "@/components/MkModal.vue";
> import { i18n } from "@/i18n";
51c90
< const modal = $shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = $ref<InstanceType<typeof MkModal>>();
53,58c92,99
< const props = withDefaults(defineProps<{
< 	currentVisibility: typeof misskey.noteVisibilities[number];
< 	currentLocalOnly: boolean;
< 	src?: HTMLElement;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     currentVisibility: typeof misskey.noteVisibilities[number];
>     currentLocalOnly: boolean;
>     src?: HTMLElement;
>   }>(),
>   {}
> );
61,63c102,104
< 	(ev: 'changeVisibility', v: typeof misskey.noteVisibilities[number]): void;
< 	(ev: 'changeLocalOnly', v: boolean): void;
< 	(ev: 'closed'): void;
---
>   (ev: "changeVisibility", v: typeof misskey.noteVisibilities[number]): void;
>   (ev: "changeLocalOnly", v: boolean): void;
>   (ev: "closed"): void;
70c111
< 	emit('changeLocalOnly', localOnly);
---
>   emit("changeLocalOnly", localOnly);
74,78c115,119
< 	v = visibility;
< 	emit('changeVisibility', visibility);
< 	nextTick(() => {
< 		modal.close();
< 	});
---
>   v = visibility;
>   emit("changeVisibility", visibility);
>   nextTick(() => {
>     modal.close();
>   });
82,86c123,126
< <style lang="scss" module>
< .root {
< 	width: 240px;
< 	padding: 8px 0;
< }
---
> <style lang="scss" scoped>
> .gqyayizv {
>   width: 240px;
>   padding: 8px 0;
88,91c128,131
< .divider {
< 	margin: 8px 0;
< 	border-top: solid 0.5px var(--divider);
< }
---
>   > .divider {
>     margin: 8px 0;
>     border-top: solid 0.5px var(--divider);
>   }
93,99c133,139
< .item {
< 	display: flex;
< 	padding: 8px 14px;
< 	font-size: 12px;
< 	text-align: left;
< 	width: 100%;
< 	box-sizing: border-box;
---
>   > button {
>     display: flex;
>     padding: 8px 14px;
>     font-size: 12px;
>     text-align: left;
>     width: 100%;
>     box-sizing: border-box;
101,103c141,143
< 	&:hover {
< 		background: rgba(0, 0, 0, 0.05);
< 	}
---
>     &:hover {
>       background: rgba(0, 0, 0, 0.05);
>     }
105,107c145,147
< 	&:active {
< 		background: rgba(0, 0, 0, 0.1);
< 	}
---
>     &:active {
>       background: rgba(0, 0, 0, 0.1);
>     }
109,112c149,152
< 	&.active {
< 		color: var(--fgOnAccent);
< 		background: var(--accent);
< 	}
---
>     &.active {
>       color: var(--fgOnAccent);
>       background: var(--accent);
>     }
114,118c154,157
< 	&.localOnly.active {
< 		color: var(--accent);
< 		background: inherit;
< 	}
< }
---
>     &.localOnly.active {
>       color: var(--accent);
>       background: inherit;
>     }
120,130c159,169
< .icon {
< 	display: flex;
< 	justify-content: center;
< 	align-items: center;
< 	margin-right: 10px;
< 	width: 16px;
< 	top: 0;
< 	bottom: 0;
< 	margin-top: auto;
< 	margin-bottom: auto;
< }
---
>     > *:nth-child(1) {
>       display: flex;
>       justify-content: center;
>       align-items: center;
>       margin-right: 10px;
>       width: 16px;
>       top: 0;
>       bottom: 0;
>       margin-top: auto;
>       margin-bottom: auto;
>     }
132,137c171,175
< .body {
< 	flex: 1 1 auto;
< 	white-space: nowrap;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
< }
---
>     > *:nth-child(2) {
>       flex: 1 1 auto;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
139,142c177,180
< .itemTitle {
< 	display: block;
< 	font-weight: bold;
< }
---
>       > span:first-child {
>         display: block;
>         font-weight: bold;
>       }
144,146c182,185
< .itemDescription {
< 	opacity: 0.6;
< }
---
>       > span:last-child:not(:first-child) {
>         opacity: 0.6;
>       }
>     }
148,157c187,198
< .toggle {
< 	display: flex;
< 	justify-content: center;
< 	align-items: center;
< 	margin-left: 10px;
< 	width: 16px;
< 	top: 0;
< 	bottom: 0;
< 	margin-top: auto;
< 	margin-bottom: auto;
---
>     > *:nth-child(3) {
>       display: flex;
>       justify-content: center;
>       align-items: center;
>       margin-left: 10px;
>       width: 16px;
>       top: 0;
>       bottom: 0;
>       margin-top: auto;
>       margin-bottom: auto;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkWaitingDialog.vue RiricaV13/components/MkWaitingDialog.vue
2,8c2,14
< <MkModal ref="modal" :prefer-type="'dialog'" :z-priority="'high'" @click="success ? done() : () => {}" @closed="emit('closed')">
< 	<div :class="[$style.root, { [$style.iconOnly]: (text == null) || success }]">
< 		<i v-if="success" :class="[$style.icon, $style.success]" class="ti ti-check"></i>
< 		<MkLoading v-else :class="[$style.icon, $style.waiting]" :em="true"/>
< 		<div v-if="text && !success" :class="$style.text">{{ text }}<MkEllipsis/></div>
< 	</div>
< </MkModal>
---
>   <MkModal
>     ref="modal"
>     :prefer-type="'dialog'"
>     :z-priority="'high'"
>     @click="success ? done() : () => {}"
>     @closed="emit('closed')"
>   >
>     <div class="iuyakobc" :class="{ iconOnly: text == null || success }">
>       <i v-if="success" class="fas fa-check icon success"></i>
>       <i v-else class="fas fa-spinner fa-pulse icon waiting"></i>
>       <div v-if="text && !success" class="text">{{ text }}<MkEllipsis /></div>
>     </div>
>   </MkModal>
12,13c18,19
< import { watch, shallowRef } from 'vue';
< import MkModal from '@/components/MkModal.vue';
---
> import { watch, ref } from "vue";
> import MkModal from "@/components/MkModal.vue";
15c21
< const modal = shallowRef<InstanceType<typeof MkModal>>();
---
> const modal = ref<InstanceType<typeof MkModal>>();
18,20c24,26
< 	success: boolean;
< 	showing: boolean;
< 	text?: string;
---
>   success: boolean;
>   showing: boolean;
>   text?: string;
24,25c30,31
< 	(ev: 'done');
< 	(ev: 'closed');
---
>   (ev: "done");
>   (ev: "closed");
29,30c35,36
< 	emit('done');
< 	modal.value.close();
---
>   emit("done");
>   modal.value.close();
33,35c39,44
< watch(() => props.showing, () => {
< 	if (!props.showing) done();
< });
---
> watch(
>   () => props.showing,
>   () => {
>     if (!props.showing) done();
>   }
> );
38,47c47,55
< <style lang="scss" module>
< .root {
< 	margin: auto;
< 	position: relative;
< 	padding: 32px;
< 	box-sizing: border-box;
< 	text-align: center;
< 	background: var(--panel);
< 	border-radius: var(--radius);
< 	width: 250px;
---
> <style lang="scss" scoped>
> .iuyakobc {
>   position: relative;
>   padding: 32px;
>   box-sizing: border-box;
>   text-align: center;
>   background: var(--panel);
>   border-radius: var(--radius);
>   width: 250px;
49,57c57,64
< 	&.iconOnly {
< 		padding: 0;
< 		width: 96px;
< 		height: 96px;
< 		display: flex;
< 		align-items: center;
< 		justify-content: center;
< 	}
< }
---
>   &.iconOnly {
>     padding: 0;
>     width: 96px;
>     height: 96px;
>     display: flex;
>     align-items: center;
>     justify-content: center;
>   }
59,60c66,67
< .icon {
< 	font-size: 32px;
---
>   > .icon {
>     font-size: 32px;
62,64c69,71
< 	&.success {
< 		color: var(--accent);
< 	}
---
>     &.success {
>       color: var(--accent);
>     }
66,69c73,76
< 	&.waiting {
< 		opacity: 0.7;
< 	}
< }
---
>     &.waiting {
>       opacity: 0.7;
>     }
>   }
71,72c78,80
< .text {
< 	margin-top: 16px;
---
>   > .text {
>     margin-top: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkWidgets.vue RiricaV13/components/MkWidgets.vue
2,33c2,64
< <div :class="$style.root">
< 	<template v-if="edit">
< 		<header :class="$style['edit-header']">
< 			<MkSelect v-model="widgetAdderSelected" style="margin-bottom: var(--margin)" class="mk-widget-select">
< 				<template #label>{{ i18n.ts.selectWidget }}</template>
< 				<option v-for="widget in widgetDefs" :key="widget" :value="widget">{{ i18n.t(`_widgets.${widget}`) }}</option>
< 			</MkSelect>
< 			<MkButton inline primary class="mk-widget-add" @click="addWidget"><i class="ti ti-plus"></i> {{ i18n.ts.add }}</MkButton>
< 			<MkButton inline @click="$emit('exit')">{{ i18n.ts.close }}</MkButton>
< 		</header>
< 		<Sortable
< 			:model-value="props.widgets"
< 			item-key="id"
< 			handle=".handle"
< 			:animation="150"
< 			:group="{ name: 'SortableMkWidgets' }"
< 			:class="$style['edit-editing']"
< 			@update:model-value="v => emit('updateWidgets', v)"
< 		>
< 			<template #item="{element}">
< 				<div :class="[$style.widget, $style['customize-container']]" class="data-cy-customize-container">
< 					<button :class="$style['customize-container-config']" class="_button" @click.prevent.stop="configWidget(element.id)"><i class="ti ti-settings"></i></button>
< 					<button :class="$style['customize-container-remove']" class="_button data-cy-customize-container-remove" @click.prevent.stop="removeWidget(element)"><i class="ti ti-x"></i></button>
< 					<div class="handle">
< 						<component :is="`widget-${element.name}`" :ref="el => widgetRefs[element.id] = el" class="widget" :class="$style['customize-container-handle-widget']" :widget="element" @update-props="updateWidget(element.id, $event)"/>
< 					</div>
< 				</div>
< 			</template>
< 		</Sortable>
< 	</template>
< 	<component :is="`widget-${widget.name}`" v-for="widget in widgets" v-else :key="widget.id" :ref="el => widgetRefs[widget.id] = el" :class="$style.widget" :widget="widget" @update-props="updateWidget(widget.id, $event)" @contextmenu.stop="onContextmenu(widget, $event)"/>
< </div>
---
>   <div class="vjoppmmu">
>     <template v-if="edit">
>       <header>
>         <MkSelect
>           v-model="widgetAdderSelected"
>           style="margin-bottom: var(--margin)"
>           class="mk-widget-select"
>         >
>           <template #label>{{ i18n.ts.selectWidget }}</template>
>           <option v-for="widget in widgetDefs" :key="widget" :value="widget">
>             {{ i18n.t(`_widgets.${widget}`) }}
>           </option>
>         </MkSelect>
>         <MkButton inline primary class="mk-widget-add" @click="addWidget"
>           ><i class="fas fa-plus"></i> {{ i18n.ts.add }}</MkButton
>         >
>         <MkButton inline @click="$emit('exit')">{{ i18n.ts.close }}</MkButton>
>       </header>
>       <XDraggable
>         v-model="widgets_"
>         item-key="id"
>         handle=".handle"
>         animation="150"
>       >
>         <template #item="{ element }">
>           <div class="customize-container">
>             <button
>               class="config _button"
>               @click.prevent.stop="configWidget(element.id)"
>             >
>               <i class="fas fa-cog"></i>
>             </button>
>             <button
>               class="remove _button"
>               @click.prevent.stop="removeWidget(element)"
>             >
>               <i class="fas fa-times"></i>
>             </button>
>             <div class="handle">
>               <component
>                 :is="`mkw-${element.name}`"
>                 :ref="(el) => (widgetRefs[element.id] = el)"
>                 class="widget"
>                 :widget="element"
>                 @updateProps="updateWidget(element.id, $event)"
>               />
>             </div>
>           </div>
>         </template>
>       </XDraggable>
>     </template>
>     <component
>       :is="`mkw-${widget.name}`"
>       v-for="widget in widgets"
>       v-else
>       :key="widget.id"
>       :ref="(el) => (widgetRefs[widget.id] = el)"
>       class="widget"
>       :widget="widget"
>       @updateProps="updateWidget(widget.id, $event)"
>       @contextmenu.stop="onContextmenu(widget, $event)"
>     />
>   </div>
35,44c66
< <script lang="ts">
< export type Widget = {
< 	name: string;
< 	id: string;
< 	data: Record<string, any>;
< };
< export type DefaultStoredWidget = {
< 	place: string | null;
< } & Widget;
< </script>
---
> 
46,53c68,74
< import { defineAsyncComponent, reactive, ref, computed } from 'vue';
< import { v4 as uuid } from 'uuid';
< import MkSelect from '@/components/MkSelect.vue';
< import MkButton from '@/components/MkButton.vue';
< import { widgets as widgetDefs } from '@/widgets';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { deepClone } from '@/scripts/clone';
---
> import { defineAsyncComponent, reactive, ref, computed } from "vue";
> import { v4 as uuid } from "uuid";
> import MkSelect from "@/components/form/select.vue";
> import MkButton from "@/components/MkButton.vue";
> import { widgets as widgetDefs } from "@/widgets";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
55c76
< const Sortable = defineAsyncComponent(() => import('vuedraggable').then(x => x.default));
---
> const XDraggable = defineAsyncComponent(() => import("vuedraggable"));
56a78,83
> type Widget = {
>   name: string;
>   id: string;
>   data: Record<string, any>;
> };
> 
58,59c85,86
< 	widgets: Widget[];
< 	edit: boolean;
---
>   widgets: Widget[];
>   edit: boolean;
63,67c90,94
< 	(ev: 'updateWidgets', widgets: Widget[]): void;
< 	(ev: 'addWidget', widget: Widget): void;
< 	(ev: 'removeWidget', widget: Widget): void;
< 	(ev: 'updateWidget', widget: Partial<Widget>): void;
< 	(ev: 'exit'): void;
---
>   (ev: "updateWidgets", widgets: Widget[]): void;
>   (ev: "addWidget", widget: Widget): void;
>   (ev: "removeWidget", widget: Widget): void;
>   (ev: "updateWidget", widget: Partial<Widget>): void;
>   (ev: "exit"): void;
72c99
< 	widgetRefs[id].configure();
---
>   widgetRefs[id].configure();
76c103
< 	if (widgetAdderSelected.value == null) return;
---
>   if (widgetAdderSelected.value == null) return;
78,82c105,109
< 	emit('addWidget', {
< 		name: widgetAdderSelected.value,
< 		id: uuid(),
< 		data: {},
< 	});
---
>   emit("addWidget", {
>     name: widgetAdderSelected.value,
>     id: uuid(),
>     data: {},
>   });
84c111
< 	widgetAdderSelected.value = null;
---
>   widgetAdderSelected.value = null;
87c114
< 	emit('removeWidget', widget);
---
>   emit("removeWidget", widget);
90c117
< 	emit('updateWidget', { id, data });
---
>   emit("updateWidget", { id, data });
91a119,124
> const widgets_ = computed({
>   get: () => props.widgets,
>   set: (value) => {
>     emit("updateWidgets", value);
>   },
> });
94,102c127,141
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target)) return;
< 	if (['INPUT', 'TEXTAREA', 'IMG', 'VIDEO', 'CANVAS'].includes(ev.target.tagName) || ev.target.attributes['contenteditable']) return;
< 	if (window.getSelection()?.toString() !== '') return;
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target)) return;
>   if (
>     ["INPUT", "TEXTAREA", "IMG", "VIDEO", "CANVAS"].includes(
>       ev.target.tagName
>     ) ||
>     ev.target.attributes["contenteditable"]
>   )
>     return;
>   if (window.getSelection()?.toString() !== "") return;
104,113c143,158
< 	os.contextMenu([{
< 		type: 'label',
< 		text: i18n.t(`_widgets.${widget.name}`),
< 	}, {
< 		icon: 'ti ti-settings',
< 		text: i18n.ts.settings,
< 		action: () => {
< 			configWidget(widget.id);
< 		},
< 	}], ev);
---
>   os.contextMenu(
>     [
>       {
>         type: "label",
>         text: i18n.t(`_widgets.${widget.name}`),
>       },
>       {
>         icon: "fas fa-cog",
>         text: i18n.ts.settings,
>         action: () => {
>           configWidget(widget.id);
>         },
>       },
>     ],
>     ev
>   );
117,120c162,165
< <style lang="scss" module>
< .root {
< 	container-type: inline-size;
< }
---
> <style lang="scss" scoped>
> .vjoppmmu {
>   > header {
>     margin: 16px 0;
122,124c167,171
< .widget {
< 	contain: content;
< 	margin: var(--margin) 0;
---
>     > * {
>       width: 100%;
>       padding: 4px;
>     }
>   }
126,129c173,176
< 	&:first-of-type {
< 		margin-top: 0;
< 	}
< }
---
>   > .widget,
>   .customize-container {
>     contain: content;
>     margin: var(--margin) 0;
131,133c178,181
< .edit {
< 	&-header {
< 		margin: 16px 0;
---
>     &:first-of-type {
>       margin-top: 0;
>     }
>   }
135,139c183,185
< 		> * {
< 			width: 100%;
< 			padding: 4px;
< 		}
< 	}
---
>   .customize-container {
>     position: relative;
>     cursor: move;
141,144c187,197
< 	&-editing {
< 		min-height: 100px;
< 	}
< }
---
>     > .config,
>     > .remove {
>       position: absolute;
>       z-index: 10000;
>       top: 8px;
>       width: 32px;
>       height: 32px;
>       color: #fff;
>       background: rgba(#000, 0.7);
>       border-radius: 4px;
>     }
146,148c199,201
< .customize-container {
< 	position: relative;
< 	cursor: move;
---
>     > .config {
>       right: 8px + 8px + 32px;
>     }
150,160c203,205
< 	&-config,
< 	&-remove {
< 		position: absolute;
< 		z-index: 10000;
< 		top: 8px;
< 		width: 32px;
< 		height: 32px;
< 		color: #fff;
< 		background: rgba(#000, 0.7);
< 		border-radius: 4px;
< 	}
---
>     > .remove {
>       right: 8px;
>     }
162,176c207,212
< 	&-config {
< 		right: 8px + 8px + 32px;
< 	}
< 
< 	&-remove {
< 		right: 8px;
< 	}
< 
< 	&-handle {
< 
< 		&-widget {
< 			pointer-events: none;
< 		}
< 	}
< 
---
>     > .handle {
>       > .widget {
>         pointer-events: none;
>       }
>     }
>   }
178d213
< 
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkWindow.vue RiricaV13/components/MkWindow.vue
2,41c2,101
< <Transition
< 	:enter-active-class="$store.state.animation ? $style.transition_window_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_window_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_window_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_window_leaveTo : ''"
< 	appear
< 	@after-leave="$emit('closed')"
< >
< 	<div v-if="showing" ref="rootEl" :class="[$style.root, { [$style.maximized]: maximized }]">
< 		<div :class="$style.body" class="_shadow" @mousedown="onBodyMousedown" @keydown="onKeydown">
< 			<div :class="[$style.header, { [$style.mini]: mini }]" @contextmenu.prevent.stop="onContextmenu">
< 				<span :class="$style.headerLeft">
< 					<button v-for="button in buttonsLeft" v-tooltip="button.title" class="_button" :class="[$style.headerButton, { [$style.highlighted]: button.highlighted }]" @click="button.onClick"><i :class="button.icon"></i></button>
< 				</span>
< 				<span :class="$style.headerTitle" @mousedown.prevent="onHeaderMousedown" @touchstart.prevent="onHeaderMousedown">
< 					<slot name="header"></slot>
< 				</span>
< 				<span :class="$style.headerRight">
< 					<button v-for="button in buttonsRight" v-tooltip="button.title" class="_button" :class="[$style.headerButton, { [$style.highlighted]: button.highlighted }]" @click="button.onClick"><i :class="button.icon"></i></button>
< 					<button v-if="canResize && maximized" v-tooltip="i18n.ts.windowRestore" class="_button" :class="$style.headerButton" @click="unMaximize()"><i class="ti ti-picture-in-picture"></i></button>
< 					<button v-else-if="canResize && !maximized" v-tooltip="i18n.ts.windowMaximize" class="_button" :class="$style.headerButton" @click="maximize()"><i class="ti ti-rectangle"></i></button>
< 					<button v-if="closeButton" v-tooltip="i18n.ts.close" class="_button" :class="$style.headerButton" @click="close()"><i class="ti ti-x"></i></button>
< 				</span>
< 			</div>
< 			<div :class="$style.content">
< 				<slot></slot>
< 			</div>
< 		</div>
< 		<template v-if="canResize">
< 			<div :class="$style.handleTop" @mousedown.prevent="onTopHandleMousedown"></div>
< 			<div :class="$style.handleRight" @mousedown.prevent="onRightHandleMousedown"></div>
< 			<div :class="$style.handleBottom" @mousedown.prevent="onBottomHandleMousedown"></div>
< 			<div :class="$style.handleLeft" @mousedown.prevent="onLeftHandleMousedown"></div>
< 			<div :class="$style.handleTopLeft" @mousedown.prevent="onTopLeftHandleMousedown"></div>
< 			<div :class="$style.handleTopRight" @mousedown.prevent="onTopRightHandleMousedown"></div>
< 			<div :class="$style.handleBottomRight" @mousedown.prevent="onBottomRightHandleMousedown"></div>
< 			<div :class="$style.handleBottomLeft" @mousedown.prevent="onBottomLeftHandleMousedown"></div>
< 		</template>
< 	</div>
< </Transition>
---
>   <transition
>     :name="$store.state.animation ? 'window' : ''"
>     appear
>     @after-leave="$emit('closed')"
>   >
>     <div v-if="showing" ref="rootEl" class="ebkgocck" :class="{ maximized }">
>       <div
>         class="body _shadow _narrow_"
>         @mousedown="onBodyMousedown"
>         @keydown="onKeydown"
>       >
>         <div
>           class="header"
>           :class="{ mini }"
>           @contextmenu.prevent.stop="onContextmenu"
>         >
>           <span class="left">
>             <button
>               v-for="button in buttonsLeft"
>               v-tooltip="button.title"
>               class="button _button"
>               :class="{ highlighted: button.highlighted }"
>               @click="button.onClick"
>             >
>               <i :class="button.icon"></i>
>             </button>
>           </span>
>           <span
>             class="title"
>             @mousedown.prevent="onHeaderMousedown"
>             @touchstart.prevent="onHeaderMousedown"
>           >
>             <slot name="header"></slot>
>           </span>
>           <span class="right">
>             <button
>               v-for="button in buttonsRight"
>               v-tooltip="button.title"
>               class="button _button"
>               :class="{ highlighted: button.highlighted }"
>               @click="button.onClick"
>             >
>               <i :class="button.icon"></i>
>             </button>
>             <button
>               v-if="canResize && maximized"
>               class="button _button"
>               @click="unMaximize()"
>             >
>               <i class="fas fa-window-restore"></i>
>             </button>
>             <button
>               v-else-if="canResize && !maximized"
>               class="button _button"
>               @click="maximize()"
>             >
>               <i class="fas fa-window-maximize"></i>
>             </button>
>             <button v-if="closeButton" class="button _button" @click="close()">
>               <i class="fas fa-times"></i>
>             </button>
>           </span>
>         </div>
>         <div class="body">
>           <slot></slot>
>         </div>
>       </div>
>       <template v-if="canResize">
>         <div class="handle top" @mousedown.prevent="onTopHandleMousedown"></div>
>         <div
>           class="handle right"
>           @mousedown.prevent="onRightHandleMousedown"
>         ></div>
>         <div
>           class="handle bottom"
>           @mousedown.prevent="onBottomHandleMousedown"
>         ></div>
>         <div
>           class="handle left"
>           @mousedown.prevent="onLeftHandleMousedown"
>         ></div>
>         <div
>           class="handle top-left"
>           @mousedown.prevent="onTopLeftHandleMousedown"
>         ></div>
>         <div
>           class="handle top-right"
>           @mousedown.prevent="onTopRightHandleMousedown"
>         ></div>
>         <div
>           class="handle bottom-right"
>           @mousedown.prevent="onBottomRightHandleMousedown"
>         ></div>
>         <div
>           class="handle bottom-left"
>           @mousedown.prevent="onBottomLeftHandleMousedown"
>         ></div>
>       </template>
>     </div>
>   </transition>
45,49c105,108
< import { onBeforeUnmount, onMounted, provide } from 'vue';
< import contains from '@/scripts/contains';
< import * as os from '@/os';
< import { MenuItem } from '@/types/menu';
< import { i18n } from '@/i18n';
---
> import { onBeforeUnmount, onMounted, provide } from "vue";
> import contains from "@/scripts/contains";
> import * as os from "@/os";
> import { MenuItem } from "@/types/menu";
55,59c114,118
< 	window.addEventListener('mousemove', fn);
< 	window.addEventListener('touchmove', fn);
< 	window.addEventListener('mouseleave', dragClear.bind(null, fn));
< 	window.addEventListener('mouseup', dragClear.bind(null, fn));
< 	window.addEventListener('touchend', dragClear.bind(null, fn));
---
>   window.addEventListener("mousemove", fn);
>   window.addEventListener("touchmove", fn);
>   window.addEventListener("mouseleave", dragClear.bind(null, fn));
>   window.addEventListener("mouseup", dragClear.bind(null, fn));
>   window.addEventListener("touchend", dragClear.bind(null, fn));
63,67c122,126
< 	window.removeEventListener('mousemove', fn);
< 	window.removeEventListener('touchmove', fn);
< 	window.removeEventListener('mouseleave', dragClear);
< 	window.removeEventListener('mouseup', dragClear);
< 	window.removeEventListener('touchend', dragClear);
---
>   window.removeEventListener("mousemove", fn);
>   window.removeEventListener("touchmove", fn);
>   window.removeEventListener("mouseleave", dragClear);
>   window.removeEventListener("mouseup", dragClear);
>   window.removeEventListener("touchend", dragClear);
70,90c129,152
< const props = withDefaults(defineProps<{
< 	initialWidth: number;
< 	initialHeight: number | null;
< 	canResize?: boolean;
< 	closeButton?: boolean;
< 	mini?: boolean;
< 	front?: boolean;
< 	contextmenu?: MenuItem[] | null;
< 	buttonsLeft?: any[];
< 	buttonsRight?: any[];
< }>(), {
< 	initialWidth: 400,
< 	initialHeight: null,
< 	canResize: false,
< 	closeButton: true,
< 	mini: false,
< 	front: false,
< 	contextmenu: null,
< 	buttonsLeft: () => [],
< 	buttonsRight: () => [],
< });
---
> const props = withDefaults(
>   defineProps<{
>     initialWidth?: number;
>     initialHeight?: number | null;
>     canResize?: boolean;
>     closeButton?: boolean;
>     mini?: boolean;
>     front?: boolean;
>     contextmenu?: MenuItem[] | null;
>     buttonsLeft?: any[];
>     buttonsRight?: any[];
>   }>(),
>   {
>     initialWidth: 400,
>     initialHeight: null,
>     canResize: false,
>     closeButton: true,
>     mini: false,
>     front: false,
>     contextmenu: null,
>     buttonsLeft: () => [],
>     buttonsRight: () => [],
>   }
> );
93c155
< 	(ev: 'closed'): void;
---
>   (ev: "closed"): void;
96c158
< provide('inWindow', true);
---
> provide("inWindow", true);
98c160
< let rootEl = $shallowRef<HTMLElement | null>();
---
> let rootEl = $ref<HTMLElement | null>();
102,105c164,167
< let unMaximizedTop = '';
< let unMaximizedLeft = '';
< let unMaximizedWidth = '';
< let unMaximizedHeight = '';
---
> let unMaximizedTop = "";
> let unMaximizedLeft = "";
> let unMaximizedWidth = "";
> let unMaximizedHeight = "";
108c170
< 	showing = false;
---
>   showing = false;
112,116c174,179
< 	if (evt.which === 27) { // Esc
< 		evt.preventDefault();
< 		evt.stopPropagation();
< 		close();
< 	}
---
>   if (evt.which === 27) {
>     // Esc
>     evt.preventDefault();
>     evt.stopPropagation();
>     close();
>   }
120,122c183,185
< 	if (props.contextmenu) {
< 		os.contextMenu(props.contextmenu, ev);
< 	}
---
>   if (props.contextmenu) {
>     os.contextMenu(props.contextmenu, ev);
>   }
127,129c190,192
< 	if (rootEl) {
< 		rootEl.style.zIndex = os.claimZIndex(props.front ? 'middle' : 'low');
< 	}
---
>   if (rootEl) {
>     rootEl.style.zIndex = os.claimZIndex(props.front ? "middle" : "low");
>   }
133,141c196,204
< 	maximized = true;
< 	unMaximizedTop = rootEl.style.top;
< 	unMaximizedLeft = rootEl.style.left;
< 	unMaximizedWidth = rootEl.style.width;
< 	unMaximizedHeight = rootEl.style.height;
< 	rootEl.style.top = '0';
< 	rootEl.style.left = '0';
< 	rootEl.style.width = '100%';
< 	rootEl.style.height = '100%';
---
>   maximized = true;
>   unMaximizedTop = rootEl.style.top;
>   unMaximizedLeft = rootEl.style.left;
>   unMaximizedWidth = rootEl.style.width;
>   unMaximizedHeight = rootEl.style.height;
>   rootEl.style.top = "0";
>   rootEl.style.left = "0";
>   rootEl.style.width = "100%";
>   rootEl.style.height = "100%";
145,149c208,212
< 	maximized = false;
< 	rootEl.style.top = unMaximizedTop;
< 	rootEl.style.left = unMaximizedLeft;
< 	rootEl.style.width = unMaximizedWidth;
< 	rootEl.style.height = unMaximizedHeight;
---
>   maximized = false;
>   rootEl.style.top = unMaximizedTop;
>   rootEl.style.left = unMaximizedLeft;
>   rootEl.style.width = unMaximizedWidth;
>   rootEl.style.height = unMaximizedHeight;
153c216
< 	top();
---
>   top();
157c220
< 	maximize();
---
>   maximize();
161,162c224,225
< 	// 右クリックはコンテキストメニューを開こうとした可能性が高いため無視
< 	if (evt.button === 2) return;
---
>   // 右クリックはコンテキストメニューを開こうとした可能性が高いため無視
>   if (evt.button === 2) return;
164c227
< 	let beforeMaximized = false;
---
>   let beforeMaximized = false;
166,169c229,232
< 	if (maximized) {
< 		beforeMaximized = true;
< 		unMaximize();
< 	}
---
>   if (maximized) {
>     beforeMaximized = true;
>     unMaximize();
>   }
171,176c234,239
< 	// ダブルクリック判定
< 	if (Date.now() - beforeClickedAt < 300) {
< 		beforeClickedAt = Date.now();
< 		onDblClick();
< 		return;
< 	}
---
>   // ダブルクリック判定
>   if (Date.now() - beforeClickedAt < 300) {
>     beforeClickedAt = Date.now();
>     onDblClick();
>     return;
>   }
178c241
< 	beforeClickedAt = Date.now();
---
>   beforeClickedAt = Date.now();
180,181c243,244
< 	const main = rootEl;
< 	if (main == null) return;
---
>   const main = rootEl;
>   if (main == null) return;
183c246
< 	if (!contains(main, document.activeElement)) main.focus();
---
>   if (!contains(main, document.activeElement)) main.focus();
185c248
< 	const position = main.getBoundingClientRect();
---
>   const position = main.getBoundingClientRect();
187,194c250,265
< 	const clickX = evt.touches && evt.touches.length > 0 ? evt.touches[0].clientX : evt.clientX;
< 	const clickY = evt.touches && evt.touches.length > 0 ? evt.touches[0].clientY : evt.clientY;
< 	const moveBaseX = beforeMaximized ? parseInt(unMaximizedWidth, 10) / 2 : clickX - position.left; // TODO: parseIntやめる
< 	const moveBaseY = beforeMaximized ? 20 : clickY - position.top;
< 	const browserWidth = window.innerWidth;
< 	const browserHeight = window.innerHeight;
< 	const windowWidth = main.offsetWidth;
< 	const windowHeight = main.offsetHeight;
---
>   const clickX =
>     evt.touches && evt.touches.length > 0
>       ? evt.touches[0].clientX
>       : evt.clientX;
>   const clickY =
>     evt.touches && evt.touches.length > 0
>       ? evt.touches[0].clientY
>       : evt.clientY;
>   const moveBaseX = beforeMaximized
>     ? parseInt(unMaximizedWidth, 10) / 2
>     : clickX - position.left; // TODO: parseIntやめる
>   const moveBaseY = beforeMaximized ? 20 : clickY - position.top;
>   const browserWidth = window.innerWidth;
>   const browserHeight = window.innerHeight;
>   const windowWidth = main.offsetWidth;
>   const windowHeight = main.offsetHeight;
196,198c267,269
< 	function move(x: number, y: number) {
< 		let moveLeft = x - moveBaseX;
< 		let moveTop = y - moveBaseY;
---
>   function move(x: number, y: number) {
>     let moveLeft = x - moveBaseX;
>     let moveTop = y - moveBaseY;
200,201c271,273
< 		// 下はみ出し
< 		if (moveTop + windowHeight > browserHeight) moveTop = browserHeight - windowHeight;
---
>     // 下はみ出し
>     if (moveTop + windowHeight > browserHeight)
>       moveTop = browserHeight - windowHeight;
203,204c275,276
< 		// 左はみ出し
< 		if (moveLeft < 0) moveLeft = 0;
---
>     // 左はみ出し
>     if (moveLeft < 0) moveLeft = 0;
206,207c278,279
< 		// 上はみ出し
< 		if (moveTop < 0) moveTop = 0;
---
>     // 上はみ出し
>     if (moveTop < 0) moveTop = 0;
209,210c281,283
< 		// 右はみ出し
< 		if (moveLeft + windowWidth > browserWidth) moveLeft = browserWidth - windowWidth;
---
>     // 右はみ出し
>     if (moveLeft + windowWidth > browserWidth)
>       moveLeft = browserWidth - windowWidth;
212,214c285,287
< 		rootEl.style.left = moveLeft + 'px';
< 		rootEl.style.top = moveTop + 'px';
< 	}
---
>     rootEl.style.left = moveLeft + "px";
>     rootEl.style.top = moveTop + "px";
>   }
216,218c289,291
< 	if (beforeMaximized) {
< 		move(clickX, clickY);
< 	}
---
>   if (beforeMaximized) {
>     move(clickX, clickY);
>   }
220,223c293,298
< 	// 動かした時
< 	dragListen(me => {
< 		const x = me.touches && me.touches.length > 0 ? me.touches[0].clientX : me.clientX;
< 		const y = me.touches && me.touches.length > 0 ? me.touches[0].clientY : me.clientY;
---
>   // 動かした時
>   dragListen((me) => {
>     const x =
>       me.touches && me.touches.length > 0 ? me.touches[0].clientX : me.clientX;
>     const y =
>       me.touches && me.touches.length > 0 ? me.touches[0].clientY : me.clientY;
225,226c300,301
< 		move(x, y);
< 	});
---
>     move(x, y);
>   });
231,233c306
< 	const main = rootEl;
< 	// どういうわけかnullになることがある
< 	if (main == null) return;
---
>   const main = rootEl;
235,237c308,310
< 	const base = evt.clientY;
< 	const height = parseInt(getComputedStyle(main, '').height, 10);
< 	const top = parseInt(getComputedStyle(main, '').top, 10);
---
>   const base = evt.clientY;
>   const height = parseInt(getComputedStyle(main, "").height, 10);
>   const top = parseInt(getComputedStyle(main, "").top, 10);
239,254c312,329
< 	// 動かした時
< 	dragListen(me => {
< 		const move = me.clientY - base;
< 		if (top + move > 0) {
< 			if (height + -move > minHeight) {
< 				applyTransformHeight(height + -move);
< 				applyTransformTop(top + move);
< 			} else { // 最小の高さより小さくなろうとした時
< 				applyTransformHeight(minHeight);
< 				applyTransformTop(top + (height - minHeight));
< 			}
< 		} else { // 上のはみ出し時
< 			applyTransformHeight(top + height);
< 			applyTransformTop(0);
< 		}
< 	});
---
>   // 動かした時
>   dragListen((me) => {
>     const move = me.clientY - base;
>     if (top + move > 0) {
>       if (height + -move > minHeight) {
>         applyTransformHeight(height + -move);
>         applyTransformTop(top + move);
>       } else {
>         // 最小の高さより小さくなろうとした時
>         applyTransformHeight(minHeight);
>         applyTransformTop(top + (height - minHeight));
>       }
>     } else {
>       // 上のはみ出し時
>       applyTransformHeight(top + height);
>       applyTransformTop(0);
>     }
>   });
259,260c334
< 	const main = rootEl;
< 	if (main == null) return;
---
>   const main = rootEl;
262,265c336,339
< 	const base = evt.clientX;
< 	const width = parseInt(getComputedStyle(main, '').width, 10);
< 	const left = parseInt(getComputedStyle(main, '').left, 10);
< 	const browserWidth = window.innerWidth;
---
>   const base = evt.clientX;
>   const width = parseInt(getComputedStyle(main, "").width, 10);
>   const left = parseInt(getComputedStyle(main, "").left, 10);
>   const browserWidth = window.innerWidth;
267,279c341,355
< 	// 動かした時
< 	dragListen(me => {
< 		const move = me.clientX - base;
< 		if (left + width + move < browserWidth) {
< 			if (width + move > minWidth) {
< 				applyTransformWidth(width + move);
< 			} else { // 最小の幅より小さくなろうとした時
< 				applyTransformWidth(minWidth);
< 			}
< 		} else { // 右のはみ出し時
< 			applyTransformWidth(browserWidth - left);
< 		}
< 	});
---
>   // 動かした時
>   dragListen((me) => {
>     const move = me.clientX - base;
>     if (left + width + move < browserWidth) {
>       if (width + move > minWidth) {
>         applyTransformWidth(width + move);
>       } else {
>         // 最小の幅より小さくなろうとした時
>         applyTransformWidth(minWidth);
>       }
>     } else {
>       // 右のはみ出し時
>       applyTransformWidth(browserWidth - left);
>     }
>   });
284,285c360
< 	const main = rootEl;
< 	if (main == null) return;
---
>   const main = rootEl;
287,290c362,365
< 	const base = evt.clientY;
< 	const height = parseInt(getComputedStyle(main, '').height, 10);
< 	const top = parseInt(getComputedStyle(main, '').top, 10);
< 	const browserHeight = window.innerHeight;
---
>   const base = evt.clientY;
>   const height = parseInt(getComputedStyle(main, "").height, 10);
>   const top = parseInt(getComputedStyle(main, "").top, 10);
>   const browserHeight = window.innerHeight;
292,304c367,381
< 	// 動かした時
< 	dragListen(me => {
< 		const move = me.clientY - base;
< 		if (top + height + move < browserHeight) {
< 			if (height + move > minHeight) {
< 				applyTransformHeight(height + move);
< 			} else { // 最小の高さより小さくなろうとした時
< 				applyTransformHeight(minHeight);
< 			}
< 		} else { // 下のはみ出し時
< 			applyTransformHeight(browserHeight - top);
< 		}
< 	});
---
>   // 動かした時
>   dragListen((me) => {
>     const move = me.clientY - base;
>     if (top + height + move < browserHeight) {
>       if (height + move > minHeight) {
>         applyTransformHeight(height + move);
>       } else {
>         // 最小の高さより小さくなろうとした時
>         applyTransformHeight(minHeight);
>       }
>     } else {
>       // 下のはみ出し時
>       applyTransformHeight(browserHeight - top);
>     }
>   });
309,310c386
< 	const main = rootEl;
< 	if (main == null) return;
---
>   const main = rootEl;
312,314c388,390
< 	const base = evt.clientX;
< 	const width = parseInt(getComputedStyle(main, '').width, 10);
< 	const left = parseInt(getComputedStyle(main, '').left, 10);
---
>   const base = evt.clientX;
>   const width = parseInt(getComputedStyle(main, "").width, 10);
>   const left = parseInt(getComputedStyle(main, "").left, 10);
316,331c392,409
< 	// 動かした時
< 	dragListen(me => {
< 		const move = me.clientX - base;
< 		if (left + move > 0) {
< 			if (width + -move > minWidth) {
< 				applyTransformWidth(width + -move);
< 				applyTransformLeft(left + move);
< 			} else { // 最小の幅より小さくなろうとした時
< 				applyTransformWidth(minWidth);
< 				applyTransformLeft(left + (width - minWidth));
< 			}
< 		} else { // 左のはみ出し時
< 			applyTransformWidth(left + width);
< 			applyTransformLeft(0);
< 		}
< 	});
---
>   // 動かした時
>   dragListen((me) => {
>     const move = me.clientX - base;
>     if (left + move > 0) {
>       if (width + -move > minWidth) {
>         applyTransformWidth(width + -move);
>         applyTransformLeft(left + move);
>       } else {
>         // 最小の幅より小さくなろうとした時
>         applyTransformWidth(minWidth);
>         applyTransformLeft(left + (width - minWidth));
>       }
>     } else {
>       // 左のはみ出し時
>       applyTransformWidth(left + width);
>       applyTransformLeft(0);
>     }
>   });
336,337c414,415
< 	onTopHandleMousedown(evt);
< 	onLeftHandleMousedown(evt);
---
>   onTopHandleMousedown(evt);
>   onLeftHandleMousedown(evt);
342,343c420,421
< 	onTopHandleMousedown(evt);
< 	onRightHandleMousedown(evt);
---
>   onTopHandleMousedown(evt);
>   onRightHandleMousedown(evt);
348,349c426,427
< 	onBottomHandleMousedown(evt);
< 	onRightHandleMousedown(evt);
---
>   onBottomHandleMousedown(evt);
>   onRightHandleMousedown(evt);
354,355c432,433
< 	onBottomHandleMousedown(evt);
< 	onLeftHandleMousedown(evt);
---
>   onBottomHandleMousedown(evt);
>   onLeftHandleMousedown(evt);
360,361c438,439
< 	if (height > window.innerHeight) height = window.innerHeight;
< 	rootEl.style.height = height + 'px';
---
>   if (height > window.innerHeight) height = window.innerHeight;
>   rootEl.style.height = height + "px";
366,367c444,445
< 	if (width > window.innerWidth) width = window.innerWidth;
< 	rootEl.style.width = width + 'px';
---
>   if (width > window.innerWidth) width = window.innerWidth;
>   rootEl.style.width = width + "px";
372c450
< 	rootEl.style.top = top + 'px';
---
>   rootEl.style.top = top + "px";
377c455
< 	rootEl.style.left = left + 'px';
---
>   rootEl.style.left = left + "px";
381,392c459,470
< 	const main = rootEl;
< 	if (main == null) return;
< 
< 	const position = main.getBoundingClientRect();
< 	const browserWidth = window.innerWidth;
< 	const browserHeight = window.innerHeight;
< 	const windowWidth = main.offsetWidth;
< 	const windowHeight = main.offsetHeight;
< 	if (position.left < 0) main.style.left = '0'; // 左はみ出し
< 	if (position.top + windowHeight > browserHeight) main.style.top = browserHeight - windowHeight + 'px'; // 下はみ出し
< 	if (position.left + windowWidth > browserWidth) main.style.left = browserWidth - windowWidth + 'px'; // 右はみ出し
< 	if (position.top < 0) main.style.top = '0'; // 上はみ出し
---
>   const main = rootEl;
>   const position = main.getBoundingClientRect();
>   const browserWidth = window.innerWidth;
>   const browserHeight = window.innerHeight;
>   const windowWidth = main.offsetWidth;
>   const windowHeight = main.offsetHeight;
>   if (position.left < 0) main.style.left = "0"; // 左はみ出し
>   if (position.top + windowHeight > browserHeight)
>     main.style.top = browserHeight - windowHeight + "px"; // 下はみ出し
>   if (position.left + windowWidth > browserWidth)
>     main.style.left = browserWidth - windowWidth + "px"; // 右はみ出し
>   if (position.top < 0) main.style.top = "0"; // 上はみ出し
396,397c474,475
< 	applyTransformWidth(props.initialWidth);
< 	if (props.initialHeight) applyTransformHeight(props.initialHeight);
---
>   if (props.initialWidth) applyTransformWidth(props.initialWidth);
>   if (props.initialHeight) applyTransformHeight(props.initialHeight);
399,400c477,478
< 	applyTransformTop((window.innerHeight / 2) - (rootEl.offsetHeight / 2));
< 	applyTransformLeft((window.innerWidth / 2) - (rootEl.offsetWidth / 2));
---
>   applyTransformTop(window.innerHeight / 2 - rootEl.offsetHeight / 2);
>   applyTransformLeft(window.innerWidth / 2 - rootEl.offsetWidth / 2);
402,403c480,481
< 	// 他のウィンドウ内のボタンなどを押してこのウィンドウが開かれた場合、親が最前面になろうとするのでそれに隠されないようにする
< 	top();
---
>   // 他のウィンドウ内のボタンなどを押してこのウィンドウが開かれた場合、親が最前面になろうとするのでそれに隠されないようにする
>   top();
405c483
< 	window.addEventListener('resize', onBrowserResize);
---
>   window.addEventListener("resize", onBrowserResize);
409c487
< 	window.removeEventListener('resize', onBrowserResize);
---
>   window.removeEventListener("resize", onBrowserResize);
413c491
< 	close,
---
>   close,
417,420c495,498
< <style lang="scss" module>
< .transition_window_enterActive,
< .transition_window_leaveActive {
< 	transition: opacity 0.2s, transform 0.2s !important;
---
> <style lang="scss" scoped>
> .window-enter-active,
> .window-leave-active {
>   transition: opacity 0.2s, transform 0.2s !important;
422,426c500,504
< .transition_window_enterFrom,
< .transition_window_leaveTo {
< 	pointer-events: none;
< 	opacity: 0;
< 	transform: scale(0.9);
---
> .window-enter-from,
> .window-leave-to {
>   pointer-events: none;
>   opacity: 0;
>   transform: scale(0.9);
429,432c507,510
< .root {
< 	position: fixed;
< 	top: 0;
< 	left: 0;
---
> .ebkgocck {
>   position: fixed;
>   top: 0;
>   left: 0;
434,439c512,519
< 	&.maximized {
< 		> .body {
< 			border-radius: 0;
< 		}
< 	}
< }
---
>   > .body {
>     overflow: clip;
>     display: flex;
>     flex-direction: column;
>     contain: content;
>     width: 100%;
>     height: 100%;
>     border-radius: var(--radius);
441,449c521,522
< .body {
< 	overflow: clip;
< 	display: flex;
< 	flex-direction: column;
< 	contain: content;
< 	width: 100%;
< 	height: 100%;
< 	border-radius: var(--radius);
< }
---
>     > .header {
>       --height: 42px;
451,452c524,526
< .header {
< 	--height: 39px;
---
>       &.mini {
>         --height: 38px;
>       }
454,456c528,539
< 	&.mini {
< 		--height: 32px;
< 	}
---
>       display: flex;
>       position: relative;
>       z-index: 1;
>       flex-shrink: 0;
>       user-select: none;
>       height: var(--height);
>       background: var(--windowHeader);
>       -webkit-backdrop-filter: var(--blur, blur(15px));
>       backdrop-filter: var(--blur, blur(15px));
>       //border-bottom: solid 1px var(--divider);
>       font-size: 95%;
>       font-weight: bold;
458,470c541,545
< 	display: flex;
< 	position: relative;
< 	z-index: 1;
< 	flex-shrink: 0;
< 	user-select: none;
< 	height: var(--height);
< 	background: var(--windowHeader);
< 	-webkit-backdrop-filter: var(--blur, blur(15px));
< 	backdrop-filter: var(--blur, blur(15px));
< 	//border-bottom: solid 1px var(--divider);
< 	font-size: 95%;
< 	font-weight: bold;
< }
---
>       > .left,
>       > .right {
>         > .button {
>           height: var(--height);
>           width: var(--height);
472,474c547,549
< .headerButton {
< 	height: var(--height);
< 	width: var(--height);
---
>           &:hover {
>             color: var(--fgHighlighted);
>           }
476,478c551,555
< 	&:hover {
< 		color: var(--fgHighlighted);
< 	}
---
>           &.highlighted {
>             color: var(--accent);
>           }
>         }
>       }
480,483c557,559
< 	&.highlighted {
< 		color: var(--accent);
< 	}
< }
---
>       > .left {
>         margin-right: 16px;
>       }
485,487c561,563
< .headerLeft {
< 	margin-right: 16px;
< }
---
>       > .right {
>         min-width: 16px;
>       }
489,491c565,574
< .headerRight {
< 	min-width: 16px;
< }
---
>       > .title {
>         flex: 1;
>         position: relative;
>         line-height: var(--height);
>         white-space: nowrap;
>         overflow: hidden;
>         text-overflow: ellipsis;
>         cursor: move;
>       }
>     }
493,501c576,581
< .headerTitle {
< 	flex: 1;
< 	position: relative;
< 	line-height: var(--height);
< 	white-space: nowrap;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
< 	cursor: move;
< }
---
>     > .body {
>       flex: 1;
>       overflow: auto;
>       background: var(--panel);
>     }
>   }
503,508c583,584
< .content {
< 	flex: 1;
< 	overflow: auto;
< 	background: var(--panel);
< 	container-type: inline-size;
< }
---
>   > .handle {
>     $size: 8px;
510c586
< $handleSize: 8px;
---
>     position: absolute;
512,514c588,594
< .handle {
< 	position: absolute;
< }
---
>     &.top {
>       top: -($size);
>       left: 0;
>       width: 100%;
>       height: $size;
>       cursor: ns-resize;
>     }
516,523c596,602
< .handleTop {
< 	composes: handle;
< 	top: -($handleSize);
< 	left: 0;
< 	width: 100%;
< 	height: $handleSize;
< 	cursor: ns-resize;
< }
---
>     &.right {
>       top: 0;
>       right: -($size);
>       width: $size;
>       height: 100%;
>       cursor: ew-resize;
>     }
525,532c604,610
< .handleRight {
< 	composes: handle;
< 	top: 0;
< 	right: -($handleSize);
< 	width: $handleSize;
< 	height: 100%;
< 	cursor: ew-resize;
< }
---
>     &.bottom {
>       bottom: -($size);
>       left: 0;
>       width: 100%;
>       height: $size;
>       cursor: ns-resize;
>     }
534,541c612,618
< .handleBottom {
< 	composes: handle;
< 	bottom: -($handleSize);
< 	left: 0;
< 	width: 100%;
< 	height: $handleSize;
< 	cursor: ns-resize;
< }
---
>     &.left {
>       top: 0;
>       left: -($size);
>       width: $size;
>       height: 100%;
>       cursor: ew-resize;
>     }
543,550c620,626
< .handleLeft {
< 	composes: handle;
< 	top: 0;
< 	left: -($handleSize);
< 	width: $handleSize;
< 	height: 100%;
< 	cursor: ew-resize;
< }
---
>     &.top-left {
>       top: -($size);
>       left: -($size);
>       width: $size * 2;
>       height: $size * 2;
>       cursor: nwse-resize;
>     }
552,559c628,634
< .handleTopLeft {
< 	composes: handle;
< 	top: -($handleSize);
< 	left: -($handleSize);
< 	width: $handleSize * 2;
< 	height: $handleSize * 2;
< 	cursor: nwse-resize;
< }
---
>     &.top-right {
>       top: -($size);
>       right: -($size);
>       width: $size * 2;
>       height: $size * 2;
>       cursor: nesw-resize;
>     }
561,568c636,642
< .handleTopRight {
< 	composes: handle;
< 	top: -($handleSize);
< 	right: -($handleSize);
< 	width: $handleSize * 2;
< 	height: $handleSize * 2;
< 	cursor: nesw-resize;
< }
---
>     &.bottom-right {
>       bottom: -($size);
>       right: -($size);
>       width: $size * 2;
>       height: $size * 2;
>       cursor: nwse-resize;
>     }
570,577c644,651
< .handleBottomRight {
< 	composes: handle;
< 	bottom: -($handleSize);
< 	right: -($handleSize);
< 	width: $handleSize * 2;
< 	height: $handleSize * 2;
< 	cursor: nwse-resize;
< }
---
>     &.bottom-left {
>       bottom: -($size);
>       left: -($size);
>       width: $size * 2;
>       height: $size * 2;
>       cursor: nesw-resize;
>     }
>   }
579,585c653,657
< .handleBottomLeft {
< 	composes: handle;
< 	bottom: -($handleSize);
< 	left: -($handleSize);
< 	width: $handleSize * 2;
< 	height: $handleSize * 2;
< 	cursor: nesw-resize;
---
>   &.maximized {
>     > .body {
>       border-radius: 0;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/MkYoutubePlayer.vue RiricaV13/components/MkYoutubePlayer.vue
2,6c2,11
< <MkWindow :initial-width="640" :initial-height="402" :can-resize="true" :close-button="true">
< 	<template #header>
< 		<i class="icon ti ti-brand-youtube" style="margin-right: 0.5em;"></i>
< 		<span>{{ title ?? 'YouTube' }}</span>
< 	</template>
---
>   <XWindow
>     :initial-width="640"
>     :initial-height="402"
>     :can-resize="true"
>     :close-button="true"
>   >
>     <template #header>
>       <i class="icon fa-brands fa-youtube" style="margin-right: 0.5em"></i>
>       <span>{{ title ?? "YouTube Player" }}</span>
>     </template>
8,17c13,33
< 	<div class="poamfof">
< 		<Transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
< 			<div v-if="player.url" class="player">
< 				<iframe v-if="!fetching" :src="player.url + (player.url.match(/\?/) ? '&autoplay=1&auto_play=1' : '?autoplay=1&auto_play=1')" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen/>
< 			</div>
< 		</Transition>
< 		<MkLoading v-if="fetching"/>
< 		<MkError v-else-if="!player.url" @retry="ytFetch()"/>
< 	</div>
< </MkWindow>
---
>     <div class="poamfof">
>       <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>         <div v-if="player.url" class="player">
>           <iframe
>             v-if="!fetching"
>             :src="
>               player.url +
>               (player.url.match(/\?/)
>                 ? '&autoplay=1&auto_play=1'
>                 : '?autoplay=1&auto_play=1')
>             "
>             frameborder="0"
>             allow="autoplay; encrypted-media"
>             allowfullscreen
>           />
>         </div>
>       </transition>
>       <MkLoading v-if="fetching" />
>       <MkError v-else-if="!player.url" @retry="ytFetch()" />
>     </div>
>   </XWindow>
21,22c37,38
< import MkWindow from '@/components/MkWindow.vue';
< import { versatileLang } from '@/scripts/intl-const';
---
> import XWindow from "@/components/MkWindow.vue";
> import { lang } from "@/config";
25c41
< 	url: string;
---
>   url: string;
33,35c49,51
< 	url: null,
< 	width: null,
< 	height: null,
---
>   url: null,
>   width: null,
>   height: null,
37a54,55
> const requestLang = (lang ?? "ja-JP").replace("ja-KS", "ja-JP");
> 
39,47c57,69
< 	fetching = true;
< 	window.fetch(`/url?url=${encodeURIComponent(requestUrl.href)}&lang=${versatileLang}`).then(res => {
< 		res.json().then(info => {
< 			if (info.url == null) return;
< 			title = info.title;
< 			fetching = false;
< 			player = info.player;
< 		});
< 	});
---
>   fetching = true;
>   window
>     .fetch(
>       `/url?url=${encodeURIComponent(requestUrl.href)}&lang=${requestLang}`
>     )
>     .then((res) => {
>       res.json().then((info) => {
>         if (info.url == null) return;
>         title = info.title;
>         fetching = false;
>         player = info.player;
>       });
>     });
51d72
< 
56,58c77,79
< 	position: relative;
< 	overflow: hidden;
< 	height: 100%;
---
>   position: relative;
>   overflow: hidden;
>   height: 100%;
60,62c81,83
< 	.player {
< 		position: absolute;
< 		inset: 0;
---
>   .player {
>     position: absolute;
>     inset: 0;
64,68c85,89
< 		iframe {
< 			width: 100%;
< 			height: 100%;
< 		}
< 	}
---
>     iframe {
>       width: 100%;
>       height: 100%;
>     }
>   }
Only in RiricaV13/components/form: checkbox.vue
Only in RiricaV13/components/form: folder.vue
Only in RiricaV13/components/form: input.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/form/link.vue RiricaV13/components/form/link.vue
2,19c2,25
< <div class="ffcbddfc" :class="{ inline }">
< 	<a v-if="external" class="main _button" :href="to" target="_blank">
< 		<span class="icon"><slot name="icon"></slot></span>
< 		<span class="text"><slot></slot></span>
< 		<span class="right">
< 			<span class="text"><slot name="suffix"></slot></span>
< 			<i class="ti ti-external-link icon"></i>
< 		</span>
< 	</a>
< 	<MkA v-else class="main _button" :class="{ active }" :to="to" :behavior="behavior">
< 		<span class="icon"><slot name="icon"></slot></span>
< 		<span class="text"><slot></slot></span>
< 		<span class="right">
< 			<span class="text"><slot name="suffix"></slot></span>
< 			<i class="ti ti-chevron-right icon"></i>
< 		</span>
< 	</MkA>
< </div>
---
>   <div class="ffcbddfc" :class="{ inline }">
>     <a v-if="external" class="main _button" :href="to" target="_blank">
>       <span class="icon"><slot name="icon"></slot></span>
>       <span class="text"><slot></slot></span>
>       <span class="right">
>         <span class="text"><slot name="suffix"></slot></span>
>         <i class="fas fa-external-link-alt icon"></i>
>       </span>
>     </a>
>     <MkA
>       v-else
>       class="main _button"
>       :class="{ active }"
>       :to="to"
>       :behavior="behavior"
>     >
>       <span class="icon"><slot name="icon"></slot></span>
>       <span class="text"><slot></slot></span>
>       <span class="right">
>         <span class="text"><slot name="suffix"></slot></span>
>         <i class="fas fa-chevron-right icon"></i>
>       </span>
>     </MkA>
>   </div>
23c29
< import { } from 'vue';
---
> import {} from "vue";
26,30c32,36
< 	to: string;
< 	active?: boolean;
< 	external?: boolean;
< 	behavior?: null | 'window' | 'browser' | 'modalWindow';
< 	inline?: boolean;
---
>   to: string;
>   active?: boolean;
>   external?: boolean;
>   behavior?: null | "window" | "browser" | "modalWindow";
>   inline?: boolean;
36c42
< 	display: block;
---
>   display: block;
38,40c44,46
< 	&.inline {
< 		display: inline-block;
< 	}
---
>   &.inline {
>     display: inline-block;
>   }
42,50c48,56
< 	> .main {
< 		display: flex;
< 		align-items: center;
< 		width: 100%;
< 		box-sizing: border-box;
< 		padding: 10px 14px;
< 		background: var(--buttonBg);
< 		border-radius: 6px;
< 		font-size: 0.9em;
---
>   > .main {
>     display: flex;
>     align-items: center;
>     width: 100%;
>     box-sizing: border-box;
>     padding: 10px 14px;
>     background: var(--buttonBg);
>     border-radius: 6px;
>     font-size: 0.9em;
52,55c58,61
< 		&:hover {
< 			text-decoration: none;
< 			background: var(--buttonHoverBg);
< 		}
---
>     &:hover {
>       text-decoration: none;
>       background: var(--buttonHoverBg);
>     }
57,60c63,66
< 		&.active {
< 			color: var(--accent);
< 			background: var(--buttonHoverBg);
< 		}
---
>     &.active {
>       color: var(--accent);
>       background: var(--buttonHoverBg);
>     }
62,66c68,72
< 		> .icon {
< 			margin-right: 0.75em;
< 			flex-shrink: 0;
< 			text-align: center;
< 			color: var(--fgTransparentWeak);
---
>     > .icon {
>       margin-right: 0.75em;
>       flex-shrink: 0;
>       text-align: center;
>       color: var(--fgTransparentWeak);
68,69c74,75
< 			&:empty {
< 				display: none;
---
>       &:empty {
>         display: none;
71,75c77,81
< 				& + .text {
< 					padding-left: 4px;
< 				}
< 			}
< 		}
---
>         & + .text {
>           padding-left: 4px;
>         }
>       }
>     }
77,82c83,88
< 		> .text {
< 			flex-shrink: 1;
< 			white-space: normal;
< 			padding-right: 12px;
< 			text-align: center;
< 		}
---
>     > .text {
>       white-space: nowrap;
>       text-overflow: ellipsis;
>       overflow: hidden;
>       padding-right: 12px;
>     }
84,87c90,93
< 		> .right {
< 			margin-left: auto;
< 			opacity: 0.7;
< 			white-space: nowrap;
---
>     > .right {
>       margin-left: auto;
>       opacity: 0.7;
>       white-space: nowrap;
89,93c95,99
< 			> .text:not(:empty) {
< 				margin-right: 0.75em;
< 			}
< 		}
< 	}
---
>       > .text:not(:empty) {
>         margin-right: 0.75em;
>       }
>     }
>   }
Only in RiricaV13/components/form: radio.vue
Only in RiricaV13/components/form: radios.vue
Only in RiricaV13/components/form: range.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/form/section.vue RiricaV13/components/form/section.vue
2,7c2,7
< <div class="vrtktovh" :class="{ first }">
< 	<div class="label"><slot name="label"></slot></div>
< 	<div class="main">
< 		<slot></slot>
< 	</div>
< </div>
---
>   <div class="vrtktovh _formBlock">
>     <div class="label"><slot name="label"></slot></div>
>     <div class="main _formRoot">
>       <slot></slot>
>     </div>
>   </div>
10,14c10
< <script lang="ts" setup>
< defineProps<{
< 	first?: boolean;
< }>();
< </script>
---
> <script lang="ts" setup></script>
18,19c14,15
< 	border-top: solid 0.5px var(--divider);
< 	//border-bottom: solid 0.5px var(--divider);
---
>   border-top: solid 0.5px var(--divider);
>   border-bottom: solid 0.5px var(--divider);
21,24c17,19
< 	> .label {
< 		font-weight: bold;
< 		padding: 1.5em 0 0 0;
< 		margin: 0 0 16px 0;
---
>   & + .vrtktovh {
>     border-top: none;
>   }
26,29c21,23
< 		&:empty {
< 			display: none;
< 		}
< 	}
---
>   &:first-child {
>     border-top: none;
>   }
31,33c25,27
< 	> .main {
< 		margin: 1.5em 0 0 0;
< 	}
---
>   &:last-child {
>     border-bottom: none;
>   }
35,36c29,31
< 	&.first {
< 		border-top: none;
---
>   > .label {
>     font-weight: bold;
>     margin: 1.5em 0 16px 0;
38,41c33,40
< 		> .label {
< 			padding-top: 0;
< 		}
< 	}
---
>     &:empty {
>       display: none;
>     }
>   }
> 
>   > .main {
>     margin: 1.5em 0;
>   }
Only in RiricaV13/components/form: select.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/form/slot.vue RiricaV13/components/form/slot.vue
2,8c2,8
< <div class="adhpbeou">
< 	<div class="label" @click="focus"><slot name="label"></slot></div>
< 	<div class="content">
< 		<slot></slot>
< 	</div>
< 	<div class="caption"><slot name="caption"></slot></div>
< </div>
---
>   <div class="adhpbeou">
>     <div class="label" @click="focus"><slot name="label"></slot></div>
>     <div class="content">
>       <slot></slot>
>     </div>
>     <div class="caption"><slot name="caption"></slot></div>
>   </div>
12c12
< import { } from 'vue';
---
> import {} from "vue";
15c15
< 	// TODO
---
>   // TODO
21,24c21,24
< 	> .label {
< 		font-size: 0.85em;
< 		padding: 0 0 8px 0;
< 		user-select: none;
---
>   > .label {
>     font-size: 0.85em;
>     padding: 0 0 8px 0;
>     user-select: none;
26,29c26,29
< 		&:empty {
< 			display: none;
< 		}
< 	}
---
>     &:empty {
>       display: none;
>     }
>   }
31,34c31,34
< 	> .caption {
< 		font-size: 0.85em;
< 		padding: 8px 0 0 0;
< 		color: var(--fgTransparentWeak);
---
>   > .caption {
>     font-size: 0.85em;
>     padding: 8px 0 0 0;
>     color: var(--fgTransparentWeak);
36,39c36,39
< 		&:empty {
< 			display: none;
< 		}
< 	}
---
>     &:empty {
>       display: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/form/split.vue RiricaV13/components/form/split.vue
2,4c2,4
< <div :class="$style.root">
< 	<slot></slot>
< </div>
---
>   <div class="terlnhxf _formBlock">
>     <slot></slot>
>   </div>
8c8,15
< import { provide } from 'vue';
---
> const props = withDefaults(
>   defineProps<{
>     minWidth?: number;
>   }>(),
>   {
>     minWidth: 210,
>   }
> );
10,18c17
< const props = withDefaults(defineProps<{
< 	minWidth?: number;
< }>(), {
< 	minWidth: 210,
< });
< 
< provide('splited', true);
< 
< const minWidth = props.minWidth + 'px';
---
> const minWidth = props.minWidth + "px";
21,25c20,28
< <style lang="scss" module>
< .root {
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(v-bind('minWidth'), 1fr));
< 	grid-gap: 12px;
---
> <style lang="scss" scoped>
> .terlnhxf {
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(v-bind("minWidth"), 1fr));
>   grid-gap: 12px;
> 
>   > ::v-deep(*) {
>     margin: 0 !important;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/form/suspense.vue RiricaV13/components/form/suspense.vue
2,15c2,20
< <Transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
< 	<div v-if="pending">
< 		<MkLoading/>
< 	</div>
< 	<div v-else-if="resolved">
< 		<slot :result="result"></slot>
< 	</div>
< 	<div v-else>
< 		<div class="wszdbhzo">
< 			<div><i class="ti ti-alert-triangle"></i> {{ $ts.somethingHappened }}</div>
< 			<MkButton inline class="retry" @click="retry"><i class="ti ti-reload"></i> {{ $ts.retry }}</MkButton>
< 		</div>
< 	</div>
< </Transition>
---
>   <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>     <div v-if="pending">
>       <MkLoading />
>     </div>
>     <div v-else-if="resolved">
>       <slot :result="result"></slot>
>     </div>
>     <div v-else>
>       <div class="wszdbhzo">
>         <div>
>           <i class="fas fa-exclamation-triangle"></i>
>           {{ $ts.somethingHappened }}
>         </div>
>         <MkButton inline class="retry" @click="retry"
>           ><i class="fas fa-redo-alt"></i> {{ $ts.retry }}</MkButton
>         >
>       </div>
>     </div>
>   </transition>
19,20c24,25
< import { defineComponent, PropType, ref, watch } from 'vue';
< import MkButton from '@/components/MkButton.vue';
---
> import { defineComponent, PropType, ref, watch } from "vue";
> import MkButton from "@/components/MkButton.vue";
23,25c28,30
< 	components: {
< 		MkButton,
< 	},
---
>   components: {
>     MkButton,
>   },
27,32c32,37
< 	props: {
< 		p: {
< 			type: Function as PropType<() => Promise<any>>,
< 			required: true,
< 		},
< 	},
---
>   props: {
>     p: {
>       type: Function as PropType<() => Promise<any>>,
>       required: true,
>     },
>   },
34,38c39,43
< 	setup(props, context) {
< 		const pending = ref(true);
< 		const resolved = ref(false);
< 		const rejected = ref(false);
< 		const result = ref(null);
---
>   setup(props, context) {
>     const pending = ref(true);
>     const resolved = ref(false);
>     const rejected = ref(false);
>     const result = ref(null);
40,57c45,62
< 		const process = () => {
< 			if (props.p == null) {
< 				return;
< 			}
< 			const promise = props.p();
< 			pending.value = true;
< 			resolved.value = false;
< 			rejected.value = false;
< 			promise.then((_result) => {
< 				pending.value = false;
< 				resolved.value = true;
< 				result.value = _result;
< 			});
< 			promise.catch(() => {
< 				pending.value = false;
< 				rejected.value = true;
< 			});
< 		};
---
>     const process = () => {
>       if (props.p == null) {
>         return;
>       }
>       const promise = props.p();
>       pending.value = true;
>       resolved.value = false;
>       rejected.value = false;
>       promise.then((_result) => {
>         pending.value = false;
>         resolved.value = true;
>         result.value = _result;
>       });
>       promise.catch(() => {
>         pending.value = false;
>         rejected.value = true;
>       });
>     };
59,63c64,72
< 		watch(() => props.p, () => {
< 			process();
< 		}, {
< 			immediate: true,
< 		});
---
>     watch(
>       () => props.p,
>       () => {
>         process();
>       },
>       {
>         immediate: true,
>       }
>     );
65,67c74,76
< 		const retry = () => {
< 			process();
< 		};
---
>     const retry = () => {
>       process();
>     };
69,76c78,85
< 		return {
< 			pending,
< 			resolved,
< 			rejected,
< 			result,
< 			retry,
< 		};
< 	},
---
>     return {
>       pending,
>       resolved,
>       rejected,
>       result,
>       retry,
>     };
>   },
83c92
< 	transition: opacity 0.125s ease;
---
>   transition: opacity 0.125s ease;
87c96
< 	opacity: 0;
---
>   opacity: 0;
91,92c100,101
< 	padding: 16px;
< 	text-align: center;
---
>   padding: 16px;
>   text-align: center;
94,96c103,105
< 	> .retry {
< 		margin-top: 16px;
< 	}
---
>   > .retry {
>     margin-top: 16px;
>   }
Only in RiricaV13/components/form: switch.vue
Only in RiricaV13/components/form: textarea.vue
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkA.vue RiricaV13/components/global/MkA.vue
2,4c2,9
< <a :href="to" :class="active ? activeClass : null" @click.prevent="nav" @contextmenu.prevent.stop="onContextmenu">
< 	<slot></slot>
< </a>
---
>   <a
>     :href="to"
>     :class="active ? activeClass : null"
>     @click.prevent="nav"
>     @contextmenu.prevent.stop="onContextmenu"
>   >
>     <slot></slot>
>   </a>
8,14c13,19
< import { inject } from 'vue';
< import * as os from '@/os';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { url } from '@/config';
< import { popout as popout_ } from '@/scripts/popout';
< import { i18n } from '@/i18n';
< import { useRouter } from '@/router';
---
> import { inject } from "vue";
> import * as os from "@/os";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { url } from "@/config";
> import { popout as popout_ } from "@/scripts/popout";
> import { i18n } from "@/i18n";
> import { useRouter } from "@/router";
16,23c21,31
< const props = withDefaults(defineProps<{
< 	to: string;
< 	activeClass?: null | string;
< 	behavior?: null | 'window' | 'browser' | 'modalWindow';
< }>(), {
< 	activeClass: null,
< 	behavior: null,
< });
---
> const props = withDefaults(
>   defineProps<{
>     to: string;
>     activeClass?: null | string;
>     behavior?: null | "window" | "browser" | "modalWindow";
>   }>(),
>   {
>     activeClass: null,
>     behavior: null,
>   }
> );
28,34c36,42
< 	if (props.activeClass == null) return false;
< 	const resolved = router.resolve(props.to);
< 	if (resolved == null) return false;
< 	if (resolved.route.path === router.currentRoute.value.path) return true;
< 	if (resolved.route.name == null) return false;
< 	if (router.currentRoute.value.name == null) return false;
< 	return resolved.route.name === router.currentRoute.value.name;
---
>   if (props.activeClass == null) return false;
>   const resolved = router.resolve(props.to);
>   if (resolved == null) return false;
>   if (resolved.route.path === router.currentRoute.value.path) return true;
>   if (resolved.route.name == null) return false;
>   if (router.currentRoute.value.name == null) return false;
>   return resolved.route.name === router.currentRoute.value.name;
38,67c46,85
< 	const selection = window.getSelection();
< 	if (selection && selection.toString() !== '') return;
< 	os.contextMenu([{
< 		type: 'label',
< 		text: props.to,
< 	}, {
< 		icon: 'ti ti-app-window',
< 		text: i18n.ts.openInWindow,
< 		action: () => {
< 			os.pageWindow(props.to);
< 		},
< 	}, {
< 		icon: 'ti ti-player-eject',
< 		text: i18n.ts.showInPage,
< 		action: () => {
< 			router.push(props.to, 'forcePage');
< 		},
< 	}, null, {
< 		icon: 'ti ti-external-link',
< 		text: i18n.ts.openInNewTab,
< 		action: () => {
< 			window.open(props.to, '_blank');
< 		},
< 	}, {
< 		icon: 'ti ti-link',
< 		text: i18n.ts.copyLink,
< 		action: () => {
< 			copyToClipboard(`${url}${props.to}`);
< 		},
< 	}], ev);
---
>   const selection = window.getSelection();
>   if (selection && selection.toString() !== "") return;
>   os.contextMenu(
>     [
>       {
>         type: "label",
>         text: props.to,
>       },
>       {
>         icon: "fas fa-window-maximize",
>         text: i18n.ts.openInWindow,
>         action: () => {
>           os.pageWindow(props.to);
>         },
>       },
>       {
>         icon: "fas fa-expand-alt",
>         text: i18n.ts.showInPage,
>         action: () => {
>           router.push(props.to, "forcePage");
>         },
>       },
>       null,
>       {
>         icon: "fas fa-external-link-alt",
>         text: i18n.ts.openInNewTab,
>         action: () => {
>           window.open(props.to, "_blank");
>         },
>       },
>       {
>         icon: "fas fa-link",
>         text: i18n.ts.copyLink,
>         action: () => {
>           copyToClipboard(`${url}${props.to}`);
>         },
>       },
>     ],
>     ev
>   );
71c89
< 	os.pageWindow(props.to);
---
>   os.pageWindow(props.to);
75c93
< 	os.modalPageWindow(props.to);
---
>   os.modalPageWindow(props.to);
79c97
< 	popout_(props.to);
---
>   popout_(props.to);
83,86c101,104
< 	if (props.behavior === 'browser') {
< 		location.href = props.to;
< 		return;
< 	}
---
>   if (props.behavior === "browser") {
>     location.href = props.to;
>     return;
>   }
88,94c106,112
< 	if (props.behavior) {
< 		if (props.behavior === 'window') {
< 			return openWindow();
< 		} else if (props.behavior === 'modalWindow') {
< 			return modalWindow();
< 		}
< 	}
---
>   if (props.behavior) {
>     if (props.behavior === "window") {
>       return openWindow();
>     } else if (props.behavior === "modalWindow") {
>       return modalWindow();
>     }
>   }
96,98c114,116
< 	if (ev.shiftKey) {
< 		return openWindow();
< 	}
---
>   if (ev.shiftKey) {
>     return openWindow();
>   }
100c118
< 	router.push(props.to, ev.ctrlKey ? 'forcePage' : null);
---
>   router.push(props.to, ev.ctrlKey ? "forcePage" : null);
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkAcct.vue RiricaV13/components/global/MkAcct.vue
2,5c2,7
< <span>
< 	<span>@{{ user.username }}</span>
< 	<span v-if="user.host || detail || $store.state.showFullAcct" style="opacity: 0.5;">@{{ user.host || host }}</span>
< </span>
---
>   <span class="mk-acct">
>     <span class="name">@{{ user.username }}</span>
>     <span v-if="user.host || detail || $store.state.showFullAcct" class="host"
>       >@{{ user.host || host }}</span
>     >
>   </span>
9,11c11,13
< import * as misskey from 'misskey-js';
< import { toUnicode } from 'punycode/';
< import { host as hostRaw } from '@/config';
---
> import * as misskey from "misskey-js";
> import { toUnicode } from "punycode/";
> import { host as hostRaw } from "@/config";
14,15c16,17
< 	user: misskey.entities.UserDetailed;
< 	detail?: boolean;
---
>   user: misskey.entities.UserDetailed;
>   detail?: boolean;
20a23,29
> <style lang="scss" scoped>
> .mk-acct {
>   > .host {
>     opacity: 0.5;
>   }
> }
> </style>
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkAd.vue RiricaV13/components/global/MkAd.vue
2,6c2,8
< <div v-if="chosen && !shouldHide" :class="$style.root">
< 	<div v-if="!showMenu" :class="[$style.main, $style['form_' + chosen.place]]">
< 		<a :href="chosen.url" target="_blank" :class="$style.link">
< 			<img :src="chosen.imageUrl" :class="$style.img">
< 			<button class="_button" :class="$style.i" @click.prevent.stop="toggleMenu"><i :class="$style.iIcon" class="ti ti-info-circle"></i></button>
---
> <div v-if="chosen" class="qiivuoyo">
> 	<div v-if="!showMenu" class="main" :class="chosen.place">
> 		<a :href="chosen.url" target="_blank">
> 			<img :src="chosen.imageUrl"/>
> 			<button class="_button menu" @click.prevent.stop="toggleMenu">
> 				<span class="fas fa-info-circle info-circle"></span>
> 			</button>
9,10c11,12
< 	<div v-else :class="$style.menu">
< 		<div :class="$style.menuContainer">
---
> 	<div v-else class="menu">
> 		<div class="body">
13,15c15,24
< 			<MkButton v-if="chosen.ratio !== 0" :class="$style.menuButton" @click="reduceFrequency">{{ $ts._ad.reduceFrequencyOfThisAd }}</MkButton>
< 			<MkButton v-if="$i && $i.policies.canHideAds" :class="$style.menuButton" @click="hide">{{ $ts._ad.hide }}</MkButton>
< 			<button class="_textButton" @click="toggleMenu">{{ $ts._ad.back }}</button>
---
> 			<MkButton
> 				v-if="chosen.ratio !== 0"
> 				class="button"
> 				@click="reduceFrequency"
> 			>
> 				{{ $ts._ad.reduceFrequencyOfThisAd }}
> 			</MkButton>
> 			<button class="_textButton" @click="toggleMenu">
> 				{{ $ts._ad.back }}
> 			</button>
23,29c32,37
< import { ref } from 'vue';
< import { instance } from '@/instance';
< import { host } from '@/config';
< import MkButton from '@/components/MkButton.vue';
< import { defaultStore } from '@/store';
< import * as os from '@/os';
< import { $i } from '@/account';
---
> import { ref } from "vue";
> import { instance } from "@/instance";
> import { host } from "@/config";
> import MkButton from "@/components/MkButton.vue";
> import { defaultStore } from "@/store";
> import * as os from "@/os";
31c39
< type Ad = (typeof instance)['ads'][number];
---
> type Ad = typeof instance["ads"][number];
34,35c42,43
< 	prefer: string[];
< 	specify?: Ad;
---
>   prefer: string[];
>   specify?: Ad;
40c48
< 	showMenu.value = !showMenu.value;
---
>   showMenu.value = !showMenu.value;
44,46c52,54
< 	if (props.specify) {
< 		return props.specify;
< 	}
---
>   if (props.specify) {
>     return props.specify;
>   }
48,51c56,63
< 	const allAds = instance.ads.map(ad => defaultStore.state.mutedAds.includes(ad.id) ? {
< 		...ad,
< 		ratio: 0,
< 	} : ad);
---
>   const allAds = instance.ads?.map((ad) =>
>     defaultStore.state.mutedAds.includes(ad.id)
>       ? {
>           ...ad,
>           ratio: 0,
>         }
>       : ad
>   ) ?? [];
53c65
< 	let ads = allAds.filter(ad => props.prefer.includes(ad.place));
---
>   let ads = allAds.filter((ad) => props.prefer.includes(ad.place));
55,57c67,69
< 	if (ads.length === 0) {
< 		ads = allAds.filter(ad => ad.place === 'square');
< 	}
---
>   if (ads.length === 0) {
>     ads = allAds.filter((ad) => ad.place === "square");
>   }
59,60c71,72
< 	const lowPriorityAds = ads.filter(ad => ad.ratio === 0);
< 	ads = ads.filter(ad => ad.ratio !== 0);
---
>   const lowPriorityAds = ads.filter((ad) => ad.ratio === 0);
>   ads = ads.filter((ad) => ad.ratio !== 0);
62,68c74,80
< 	if (ads.length === 0) {
< 		if (lowPriorityAds.length !== 0) {
< 			return lowPriorityAds[Math.floor(Math.random() * lowPriorityAds.length)];
< 		} else {
< 			return null;
< 		}
< 	}
---
>   if (ads.length === 0) {
>     if (lowPriorityAds.length !== 0) {
>       return lowPriorityAds[Math.floor(Math.random() * lowPriorityAds.length)];
>     } else {
>       return null;
>     }
>   }
70,71c82,83
< 	const totalFactor = ads.reduce((a, b) => a + b.ratio, 0);
< 	const r = Math.random() * totalFactor;
---
>   const totalFactor = ads.reduce((a, b) => a + b.ratio, 0);
>   const r = Math.random() * totalFactor;
73,80c85,92
< 	let stackedFactor = 0;
< 	for (const ad of ads) {
< 		if (r >= stackedFactor && r <= stackedFactor + ad.ratio) {
< 			return ad;
< 		} else {
< 			stackedFactor += ad.ratio;
< 		}
< 	}
---
>   let stackedFactor = 0;
>   for (const ad of ads) {
>     if (r >= stackedFactor && r <= stackedFactor + ad.ratio) {
>       return ad;
>     } else {
>       stackedFactor += ad.ratio;
>     }
>   }
82c94
< 	return null;
---
>   return null;
86d97
< let shouldHide = $ref(chosen.value && $i && $i.policies.canHideAds && defaultStore.state.hiddenAds.includes(chosen.value.id));
89,94c100,105
< 	if (chosen.value == null) return;
< 	if (defaultStore.state.mutedAds.includes(chosen.value.id)) return;
< 	defaultStore.push('mutedAds', chosen.value.id);
< 	os.success();
< 	chosen.value = choseAd();
< 	showMenu.value = false;
---
>   if (chosen.value == null) return;
>   if (defaultStore.state.mutedAds.includes(chosen.value.id)) return;
>   defaultStore.push("mutedAds", chosen.value.id);
>   os.success();
>   chosen.value = choseAd();
>   showMenu.value = false;
96,102d106
< 
< function hide() {
< 	if (chosen.value == null) return;
< 	defaultStore.push('hiddenAds', chosen.value.id);
< 	os.success();
< 	shouldHide = true;
< }
105,109c109,118
< <style lang="scss" module>
< .root {
< 	background-size: auto auto;
< 	background-image: repeating-linear-gradient(45deg, transparent, transparent 8px, var(--ad) 8px, var(--ad) 14px );
< }
---
> <style lang="scss" scoped>
> .qiivuoyo {
>   background-size: auto auto;
>   background-image: repeating-linear-gradient(
>     45deg,
>     transparent,
>     transparent 8px,
>     var(--ad) 8px,
>     var(--ad) 14px
>   );
111,112c120,121
< .main {
< 	text-align: center;
---
>   > .main {
>     text-align: center;
114,120c123,126
< 	&.form_square {
< 		> .link,
< 		> .link > .img {
< 			max-width: min(300px, 100%);
< 			max-height: 300px;
< 		}
< 	}
---
>     > a {
>       display: inline-block;
>       position: relative;
>       vertical-align: bottom;
122,123c128,132
< 	&.form_horizontal {
< 		padding: 8px;
---
>       &:hover {
>         > img {
>           filter: contrast(120%);
>         }
>       }
125,130c134,139
< 		> .link,
< 		> .link > .img {
< 			max-width: min(600px, 100%);
< 			max-height: 80px;
< 		}
< 	}
---
>       > img {
>         display: block;
>         object-fit: contain;
>         margin: auto;
>         border-radius: 5px;
>       }
132,133c141,144
< 	&.form_horizontal-big {
< 		padding: 8px;
---
>       > .menu {
>         position: absolute;
>         top: 1px;
>         right: 1px;
135,140c146,152
< 		> .link,
< 		> .link > .img {
< 			max-width: min(600px, 100%);
< 			max-height: 250px;
< 		}
< 	}
---
>         > .info-circle {
>           border: 3px solid var(--panel);
>           border-radius: 50%;
>           background: var(--panel);
>         }
>       }
>     }
142,148c154,160
< 	&.form_vertical {
< 		> .link,
< 		> .link > .img {
< 			max-width: min(100px, 100%);
< 		}
< 	}
< }
---
>     &.square {
>       > a,
>       > a > img {
>         max-width: min(300px, 100%);
>         max-height: 300px;
>       }
>     }
150,153c162,163
< .link {
< 	display: inline-block;
< 	position: relative;
< 	vertical-align: bottom;
---
>     &.horizontal {
>       padding: 8px;
155,160c165,170
< 	&:hover {
< 		> .img {
< 			filter: contrast(120%);
< 		}
< 	}
< }
---
>       > a,
>       > a > img {
>         max-width: min(600px, 100%);
>         max-height: 80px;
>       }
>     }
162,167c172,173
< .img {
< 	display: block;
< 	object-fit: contain;
< 	margin: auto;
< 	border-radius: 5px;
< }
---
>     &.horizontal-big {
>       padding: 8px;
169,178c175,180
< .i {
< 	position: absolute;
< 	top: 1px;
< 	right: 1px;
< 	display: grid;
< 	place-content: center;
< 	background: var(--panel);
< 	border-radius: 100%;
< 	padding: 2px;
< }
---
>       > a,
>       > a > img {
>         max-width: min(600px, 100%);
>         max-height: 250px;
>       }
>     }
180,183c182,188
< .iIcon {
< 	font-size: 14px;
< 	line-height: 17px;
< }
---
>     &.vertical {
>       > a,
>       > a > img {
>         max-width: min(100px, 100%);
>       }
>     }
>   }
185,188c190,192
< .menu {
< 	padding: 8px;
< 	text-align: center;
< }
---
>   > .menu {
>     padding: 8px;
>     text-align: center;
190,195c194,198
< .menuContainer {
< 	padding: 8px;
< 	margin: 0 auto;
< 	max-width: 400px;
< 	border: solid 1px var(--divider);
< }
---
>     > .body {
>       padding: 8px;
>       margin: 0 auto;
>       max-width: 400px;
>       border: solid 1px var(--divider);
197,198c200,204
< .menuButton {
< 	margin: 8px auto;
---
>       > .button {
>         margin: 8px auto;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkAvatar.vue RiricaV13/components/global/MkAvatar.vue
2,9c2,34
< <span v-if="!link" v-user-preview="preview ? user.id : undefined" :class="[$style.root, { [$style.cat]: user.isCat, [$style.square]: $store.state.squareAvatars }]" class="_noSelect" :style="{ color }" :title="acct(user)" @click="onClick">
< 	<img :class="$style.inner" :src="url" decoding="async"/>
< 	<MkUserOnlineIndicator v-if="indicator" :class="$style.indicator" :user="user"/>
< </span>
< <MkA v-else v-user-preview="preview ? user.id : undefined" class="_noSelect" :class="[$style.root, { [$style.cat]: user.isCat, [$style.square]: $store.state.squareAvatars }]" :style="{ color }" :to="userPage(user)" :title="acct(user)" :target="target">
< 	<img :class="$style.inner" :src="url" decoding="async"/>
< 	<MkUserOnlineIndicator v-if="indicator" :class="$style.indicator" :user="user"/>
< </MkA>
---
>   <span
>     v-if="disableLink"
>     v-user-preview="disablePreview ? undefined : user.id"
>     class="eiwwqkts _noSelect"
>     :class="{ cat: user.isCat, square: $store.state.squareAvatars }"
>     :style="{ color }"
>     :title="acct(user)"
>     @click="onClick"
>   >
>     <img class="inner" :src="url" decoding="async" />
>     <MkUserOnlineIndicator
>       v-if="showIndicator"
>       class="indicator"
>       :user="user"
>     />
>   </span>
>   <MkA
>     v-else
>     v-user-preview="disablePreview ? undefined : user.id"
>     class="eiwwqkts _noSelect"
>     :class="{ cat: user.isCat, square: $store.state.squareAvatars }"
>     :style="{ color }"
>     :to="userPage(user)"
>     :title="acct(user)"
>     :target="target"
>   >
>     <img class="inner" :src="url" decoding="async" />
>     <MkUserOnlineIndicator
>       v-if="showIndicator"
>       class="indicator"
>       :user="user"
>     />
>   </MkA>
13,19c38,44
< import { onMounted, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import { getStaticImageUrl } from '@/scripts/media-proxy';
< import { extractAvgColorFromBlurhash } from '@/scripts/extract-avg-color-from-blurhash';
< import { acct, userPage } from '@/filters/user';
< import MkUserOnlineIndicator from '@/components/MkUserOnlineIndicator.vue';
< import { defaultStore } from '@/store';
---
> import { onMounted, watch } from "vue";
> import * as misskey from "misskey-js";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import { extractAvgColorFromBlurhash } from "@/scripts/extract-avg-color-from-blurhash";
> import { acct, userPage } from "@/filters/user";
> import MkUserOnlineIndicator from "@/components/MkUserOnlineIndicator.vue";
> import { defaultStore } from "@/store";
21,32c46,60
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.User;
< 	target?: string | null;
< 	link?: boolean;
< 	preview?: boolean;
< 	indicator?: boolean;
< }>(), {
< 	target: null,
< 	link: false,
< 	preview: false,
< 	indicator: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: misskey.entities.User;
>     target?: string | null;
>     disableLink?: boolean;
>     disablePreview?: boolean;
>     showIndicator?: boolean;
>   }>(),
>   {
>     target: null,
>     disableLink: false,
>     disablePreview: false,
>     showIndicator: false,
>   }
> );
35c63
< 	(ev: 'click', v: MouseEvent): void;
---
>   (ev: "click", v: MouseEvent): void;
38,40c66,70
< const url = $computed(() => defaultStore.state.disableShowingAnimatedImages
< 	? getStaticImageUrl(props.user.avatarUrl)
< 	: props.user.avatarUrl);
---
> const url = $computed(() =>
>   defaultStore.state.disableShowingAnimatedImages
>     ? getStaticImageUrl(props.user.avatarUrl)
>     : props.user.avatarUrl
> );
43c73
< 	emit('click', ev);
---
>   emit("click", ev);
48,52c78,86
< watch(() => props.user.avatarBlurhash, () => {
< 	color = extractAvgColorFromBlurhash(props.user.avatarBlurhash);
< }, {
< 	immediate: true,
< });
---
> watch(
>   () => props.user.avatarBlurhash,
>   () => {
>     color = extractAvgColorFromBlurhash(props.user.avatarBlurhash);
>   },
>   {
>     immediate: true,
>   }
> );
55c89
< <style lang="scss" module>
---
> <style lang="scss" scoped>
57,61c91,105
< 	from { transform: rotate(37.6deg) skew(30deg); }
< 	25% { transform: rotate(10deg) skew(30deg); }
< 	50% { transform: rotate(20deg) skew(30deg); }
< 	75% { transform: rotate(0deg) skew(30deg); }
< 	to { transform: rotate(37.6deg) skew(30deg); }
---
>   from {
>     transform: rotate(37.6deg) skew(30deg);
>   }
>   25% {
>     transform: rotate(10deg) skew(30deg);
>   }
>   50% {
>     transform: rotate(20deg) skew(30deg);
>   }
>   75% {
>     transform: rotate(0deg) skew(30deg);
>   }
>   to {
>     transform: rotate(37.6deg) skew(30deg);
>   }
65,69c109,123
< 	from { transform: rotate(-37.6deg) skew(-30deg); }
< 	30% { transform: rotate(-10deg) skew(-30deg); }
< 	55% { transform: rotate(-20deg) skew(-30deg); }
< 	75% { transform: rotate(0deg) skew(-30deg); }
< 	to { transform: rotate(-37.6deg) skew(-30deg); }
---
>   from {
>     transform: rotate(-37.6deg) skew(-30deg);
>   }
>   30% {
>     transform: rotate(-10deg) skew(-30deg);
>   }
>   55% {
>     transform: rotate(-20deg) skew(-30deg);
>   }
>   75% {
>     transform: rotate(0deg) skew(-30deg);
>   }
>   to {
>     transform: rotate(-37.6deg) skew(-30deg);
>   }
72,79c126,132
< .root {
< 	position: relative;
< 	display: inline-block;
< 	vertical-align: bottom;
< 	flex-shrink: 0;
< 	border-radius: 100%;
< 	line-height: 16px;
< }
---
> .eiwwqkts {
>   position: relative;
>   display: inline-block;
>   vertical-align: bottom;
>   flex-shrink: 0;
>   border-radius: 100%;
>   line-height: 16px;
81,93c134,146
< .inner {
< 	position: absolute;
< 	bottom: 0;
< 	left: 0;
< 	right: 0;
< 	top: 0;
< 	border-radius: 100%;
< 	z-index: 1;
< 	overflow: clip;
< 	object-fit: cover;
< 	width: 100%;
< 	height: 100%;
< }
---
>   > .inner {
>     position: absolute;
>     bottom: 0;
>     left: 0;
>     right: 0;
>     top: 0;
>     border-radius: 100%;
>     z-index: 1;
>     overflow: hidden;
>     object-fit: cover;
>     width: 100%;
>     height: 100%;
>   }
95,102c148,155
< .indicator {
< 	position: absolute;
< 	z-index: 1;
< 	bottom: 0;
< 	left: 0;
< 	width: 20%;
< 	height: 20%;
< }
---
>   > .indicator {
>     position: absolute;
>     z-index: 1;
>     bottom: 0;
>     left: 0;
>     width: 20%;
>     height: 20%;
>   }
104,105c157,158
< .square {
< 	border-radius: 20%;
---
>   &.square {
>     border-radius: 20%;
107,110c160,163
< 	> .inner {
< 		border-radius: 20%;
< 	}
< }
---
>     > .inner {
>       border-radius: 20%;
>     }
>   }
112,121c165,175
< .cat {
< 	&:before, &:after {
< 		background: #df548f;
< 		border: solid 4px currentColor;
< 		box-sizing: border-box;
< 		content: '';
< 		display: inline-block;
< 		height: 50%;
< 		width: 50%;
< 	}
---
>   &.cat {
>     &:before,
>     &:after {
>       background: #df548f;
>       border: solid 4px currentColor;
>       box-sizing: border-box;
>       content: "";
>       display: inline-block;
>       height: 50%;
>       width: 50%;
>     }
123,126c177,180
< 	&:before {
< 		border-radius: 0 75% 75%;
< 		transform: rotate(37.5deg) skew(30deg);
< 	}
---
>     &:before {
>       border-radius: 0 75% 75%;
>       transform: rotate(37.5deg) skew(30deg);
>     }
128,131c182,185
< 	&:after {
< 		border-radius: 75% 0 75% 75%;
< 		transform: rotate(-37.5deg) skew(-30deg);
< 	}
---
>     &:after {
>       border-radius: 75% 0 75% 75%;
>       transform: rotate(-37.5deg) skew(-30deg);
>     }
133,136c187,190
< 	&:hover {
< 		&:before {
< 			animation: earwiggleleft 1s infinite;
< 		}
---
>     &:hover {
>       &:before {
>         animation: earwiggleleft 1s infinite;
>       }
138,141c192,196
< 		&:after {
< 			animation: earwiggleright 1s infinite;
< 		}
< 	}
---
>       &:after {
>         animation: earwiggleright 1s infinite;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkEllipsis.vue RiricaV13/components/global/MkEllipsis.vue
2,4c2
< <span :class="$style.root">
< 	<span :class="$style.dot">.</span><span :class="$style.dot">.</span><span :class="$style.dot">.</span>
< </span>
---
>   <span class="mk-ellipsis"> <span>.</span><span>.</span><span>.</span> </span>
7,15c5,8
< <style lang="scss" module>
< @keyframes ellipsis {
< 	0%, 80%, 100% {
< 		opacity: 1;
< 	}
< 	40% {
< 		opacity: 0;
< 	}
< }
---
> <style lang="scss" scoped>
> .mk-ellipsis {
>   > span {
>     animation: ellipsis 1.4s infinite ease-in-out both;
17,19c10,12
< .root {
< 	
< }
---
>     &:nth-child(1) {
>       animation-delay: 0s;
>     }
21,22c14,16
< .dot {
< 	animation: ellipsis 1.4s infinite ease-in-out both;
---
>     &:nth-child(2) {
>       animation-delay: 0.16s;
>     }
24,26c18,22
< 	&:nth-child(1) {
< 		animation-delay: 0s;
< 	}
---
>     &:nth-child(3) {
>       animation-delay: 0.32s;
>     }
>   }
> }
28,34c24,32
< 	&:nth-child(2) {
< 		animation-delay: 0.16s;
< 	}
< 
< 	&:nth-child(3) {
< 		animation-delay: 0.32s;
< 	}
---
> @keyframes ellipsis {
>   0%,
>   80%,
>   100% {
>     opacity: 1;
>   }
>   40% {
>     opacity: 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkEmoji.vue RiricaV13/components/global/MkEmoji.vue
2,6c2,20
< <span v-if="isCustom && errored">:{{ customEmojiName }}:</span>
< <img v-else-if="isCustom" :class="[$style.root, $style.custom, { [$style.normal]: normal, [$style.noStyle]: noStyle }]" :src="url" :alt="alt" :title="alt" decoding="async" @error="errored = true" @load="errored = false"/>
< <img v-else-if="char && !useOsNativeEmojis" :class="$style.root" :src="url" :alt="alt" decoding="async" @pointerenter="computeTitle"/>
< <span v-else-if="char && useOsNativeEmojis" :alt="alt" @pointerenter="computeTitle">{{ char }}</span>
< <span v-else>{{ emoji }}</span>
---
>   <img
>     v-if="customEmoji"
>     class="mk-emoji custom"
>     :class="{ normal, noStyle }"
>     :src="url"
>     :alt="alt"
>     :title="alt"
>     decoding="async"
>   />
>   <img
>     v-else-if="char && !useOsNativeEmojis"
>     class="mk-emoji"
>     :src="url"
>     :alt="alt"
>     :title="alt"
>     decoding="async"
>   />
>   <span v-else-if="char && useOsNativeEmojis">{{ char }}</span>
>   <span v-else>{{ emoji }}</span>
10,15c24,29
< import { computed } from 'vue';
< import { getStaticImageUrl } from '@/scripts/media-proxy';
< import { char2twemojiFilePath, char2fluentEmojiFilePath } from '@/scripts/emoji-base';
< import { defaultStore } from '@/store';
< import { getEmojiName } from '@/scripts/emojilist';
< import { customEmojis } from '@/custom-emojis';
---
> import { computed, ref, watch } from "vue";
> import { CustomEmoji } from "misskey-js/built/entities";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import { char2filePath } from "@/scripts/twemoji-base";
> import { defaultStore } from "@/store";
> import { instance } from "@/instance";
18,22c32,36
< 	emoji: string;
< 	normal?: boolean;
< 	noStyle?: boolean;
< 	isReaction?: boolean;
< 	host?: string | null;
---
>   emoji: string;
>   normal?: boolean;
>   noStyle?: boolean;
>   customEmojis?: CustomEmoji[];
>   isReaction?: boolean;
25,30c39,51
< const char2path = defaultStore.state.emojiStyle === 'twemoji' ? char2twemojiFilePath : char2fluentEmojiFilePath;
< 
< const isCustom = computed(() => props.emoji.startsWith(':'));
< const customEmojiName = computed(() => props.emoji.substr(1, props.emoji.length - 2).replace('@.', ''));
< const char = computed(() => isCustom.value ? undefined : props.emoji);
< const useOsNativeEmojis = computed(() => defaultStore.state.emojiStyle === 'native' && !props.isReaction);
---
> const isCustom = computed(() => props.emoji.startsWith(":"));
> const char = computed(() => (isCustom.value ? null : props.emoji));
> const useOsNativeEmojis = computed(
>   () => defaultStore.state.useOsNativeEmojis && !props.isReaction
> );
> const ce = computed(() => props.customEmojis ?? instance.emojis ?? []);
> const customEmoji = computed(() =>
>   isCustom.value
>     ? ce.value.find(
>         (x) => x.name === props.emoji.substr(1, props.emoji.length - 2)
>       )
>     : null
> );
32,42c53,59
< 	if (char.value) {
< 		return char2path(char.value);
< 	} else if (props.host == null && !customEmojiName.value.includes('@')) {
< 		const found = customEmojis.value.find(x => x.name === customEmojiName.value);
< 		return found ? defaultStore.state.disableShowingAnimatedImages ? getStaticImageUrl(found.url) : found.url : null;
< 	} else {
< 		const rawUrl = props.host ? `/emoji/${customEmojiName.value}@${props.host}.webp` : `/emoji/${customEmojiName.value}.webp`;
< 		return defaultStore.state.disableShowingAnimatedImages
< 			? getStaticImageUrl(rawUrl)
< 			: rawUrl;
< 	}
---
>   if (char.value) {
>     return char2filePath(char.value);
>   } else {
>     return defaultStore.state.disableShowingAnimatedImages
>       ? getStaticImageUrl(customEmoji.value.url)
>       : customEmoji.value.url;
>   }
44,53c61,63
< const alt = computed(() => isCustom.value ? `:${customEmojiName.value}:` : char.value);
< let errored = $ref(isCustom.value && url.value == null);
< 
< // Searching from an array with 2000 items for every emoji felt like too energy-consuming, so I decided to do it lazily on pointerenter
< function computeTitle(event: PointerEvent): void {
< 	const title = isCustom.value
< 		? `:${customEmojiName.value}:`
< 		: (getEmojiName(char.value as string) ?? char.value as string);
< 	(event.target as HTMLElement).title = title;
< }
---
> const alt = computed(() =>
>   customEmoji.value ? `:${customEmoji.value.name}:` : char.value
> );
56,60c66,69
< <style lang="scss" module>
< .root {
< 	height: 1.25em;
< 	vertical-align: -0.25em;
< }
---
> <style lang="scss" scoped>
> .mk-emoji {
>   height: 1.25em;
>   vertical-align: -0.25em;
62,65c71,74
< .custom {
< 	height: 2.5em;
< 	vertical-align: middle;
< 	transition: transform 0.2s ease;
---
>   &.custom {
>     height: 2.5em;
>     vertical-align: middle;
>     transition: transform 0.2s ease;
67,70c76,78
< 	&:hover {
< 		transform: scale(1.2);
< 	}
< }
---
>     &:hover {
>       transform: scale(1.2);
>     }
72,74c80,82
< .normal {
< 	height: 1.25em;
< 	vertical-align: -0.25em;
---
>     &.normal {
>       height: 1.25em;
>       vertical-align: -0.25em;
76,79c84,88
< 	&:hover {
< 		transform: none;
< 	}
< }
---
>       &:hover {
>         transform: none;
>       }
>     }
>   }
81,82c90,92
< .noStyle {
< 	height: auto !important;
---
>   &.noStyle {
>     height: auto !important;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkError.vue RiricaV13/components/global/MkError.vue
2,8c2,13
< <Transition :name="$store.state.animation ? '_transition_zoom' : ''" appear>
< 	<div :class="$style.root">
< 		<img :class="$style.img" src="https://xn--931a.moe/assets/error.jpg" class="_ghost"/>
< 		<p :class="$style.text"><i class="ti ti-alert-triangle"></i> {{ i18n.ts.somethingHappened }}</p>
< 		<MkButton :class="$style.button" @click="() => $emit('retry')">{{ i18n.ts.retry }}</MkButton>
< 	</div>
< </Transition>
---
>   <transition :name="$store.state.animation ? 'zoom' : ''" appear>
>     <div class="mjndxjcg">
>       <img src="https://xn--931a.moe/assets/error.jpg" class="_ghost" />
>       <p>
>         <i class="fas fa-exclamation-triangle"></i>
>         {{ i18n.ts.somethingHappened }}
>       </p>
>       <MkButton class="button" @click="() => $emit('retry')">{{
>         i18n.ts.retry
>       }}</MkButton>
>     </div>
>   </transition>
12,13c17,18
< import MkButton from '@/components/MkButton.vue';
< import { i18n } from '@/i18n';
---
> import MkButton from "@/components/MkButton.vue";
> import { i18n } from "@/i18n";
16,21c21,24
< <style lang="scss" module>
< .root {
< 	padding: 32px;
< 	text-align: center;
<   align-items: center;
< }
---
> <style lang="scss" scoped>
> .mjndxjcg {
>   padding: 32px;
>   text-align: center;
23,25c26,28
< .text {
< 	margin: 0 0 8px 0;
< }
---
>   > p {
>     margin: 0 0 8px 0;
>   }
27,29c30,32
< .button {
< 	margin: 0 auto;
< }
---
>   > .button {
>     margin: 0 auto;
>   }
31,36c34,39
< .img {
< 	vertical-align: bottom;
<   width: 128px;
< 	height: 128px;
< 	margin-bottom: 16px;
< 	border-radius: 16px;
---
>   > img {
>     vertical-align: bottom;
>     height: 128px;
>     margin-bottom: 16px;
>     border-radius: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkLoading.vue RiricaV13/components/global/MkLoading.vue
2,15c2,40
< <div :class="[$style.root, { [$style.inline]: inline, [$style.colored]: colored, [$style.mini]: mini, [$style.em]: em }]">
< 	<div :class="$style.container">
< 		<svg :class="[$style.spinner, $style.bg]" viewBox="0 0 168 168" xmlns="http://www.w3.org/2000/svg">
< 			<g transform="matrix(1.125,0,0,1.125,12,12)">
< 				<circle cx="64" cy="64" r="64" style="fill:none;stroke:currentColor;stroke-width:21.33px;"/>
< 			</g>
< 		</svg>
< 		<svg :class="[$style.spinner, $style.fg]" viewBox="0 0 168 168" xmlns="http://www.w3.org/2000/svg">
< 			<g transform="matrix(1.125,0,0,1.125,12,12)">
< 				<path d="M128,64C128,28.654 99.346,0 64,0C99.346,0 128,28.654 128,64Z" style="fill:none;stroke:currentColor;stroke-width:21.33px;"/>
< 			</g>
< 		</svg>
< 	</div>
< </div>
---
>   <div
>     :class="[
>       $style.root,
>       {
>         [$style.inline]: inline,
>         [$style.colored]: colored,
>         [$style.mini]: mini,
>       },
>     ]"
>   >
>     <div :class="$style.container">
>       <svg
>         :class="[$style.spinner, $style.bg]"
>         viewBox="0 0 168 168"
>         xmlns="http://www.w3.org/2000/svg"
>       >
>         <g transform="matrix(1.125,0,0,1.125,12,12)">
>           <circle
>             cx="64"
>             cy="64"
>             r="64"
>             style="fill: none; stroke: currentColor; stroke-width: 21.33px"
>           />
>         </g>
>       </svg>
>       <svg
>         :class="[$style.spinner, $style.fg]"
>         viewBox="0 0 168 168"
>         xmlns="http://www.w3.org/2000/svg"
>       >
>         <g transform="matrix(1.125,0,0,1.125,12,12)">
>           <path
>             d="M128,64C128,28.654 99.346,0 64,0C99.346,0 128,28.654 128,64Z"
>             style="fill: none; stroke: currentColor; stroke-width: 21.33px"
>           />
>         </g>
>       </svg>
>     </div>
>   </div>
19c44
< import { } from 'vue';
---
> import {} from "vue";
21,31c46,57
< const props = withDefaults(defineProps<{
< 	inline?: boolean;
< 	colored?: boolean;
< 	mini?: boolean;
< 	em?: boolean;
< }>(), {
< 	inline: false,
< 	colored: true,
< 	mini: false,
< 	em: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     inline?: boolean;
>     colored?: boolean;
>     mini?: boolean;
>   }>(),
>   {
>     inline: false,
>     colored: true,
>     mini: false,
>   }
> );
36,41c62,67
< 	0% {
< 		transform: rotate(0deg);
< 	}
< 	100% {
< 		transform: rotate(360deg);
< 	}
---
>   0% {
>     transform: rotate(0deg);
>   }
>   100% {
>     transform: rotate(360deg);
>   }
45,47c71,73
< 	padding: 32px;
< 	text-align: center;
< 	cursor: wait;
---
>   padding: 32px;
>   text-align: center;
>   cursor: wait;
49c75
< 	--size: 38px;
---
>   --size: 38px;
51,53c77,79
< 	&.colored {
< 		color: var(--accent);
< 	}
---
>   &.colored {
>     color: var(--accent);
>   }
55,59c81,85
< 	&.inline {
< 		display: inline;
< 		padding: 0;
< 		--size: 32px;
< 	}
---
>   &.inline {
>     display: inline;
>     padding: 0;
>     --size: 32px;
>   }
61,71c87,90
< 	&.mini {
< 		padding: 16px;
< 		--size: 32px;
< 	}
< 
< 	&.em {
< 		display: inline-block;
< 		vertical-align: middle;
< 		padding: 0;
< 		--size: 1em;
< 	}
---
>   &.mini {
>     padding: 16px;
>     --size: 32px;
>   }
75,78c94,97
< 	position: relative;
< 	width: var(--size);
< 	height: var(--size);
< 	margin: 0 auto;
---
>   position: relative;
>   width: var(--size);
>   height: var(--size);
>   margin: 0 auto;
82,91c101,110
< 	position: absolute;
< 	top: 0;
< 	left: 0;
< 	width: var(--size);
< 	height: var(--size);
< 	fill-rule: evenodd;
< 	clip-rule: evenodd;
< 	stroke-linecap: round;
< 	stroke-linejoin: round;
< 	stroke-miterlimit: 1.5;
---
>   position: absolute;
>   top: 0;
>   left: 0;
>   width: var(--size);
>   height: var(--size);
>   fill-rule: evenodd;
>   clip-rule: evenodd;
>   stroke-linecap: round;
>   stroke-linejoin: round;
>   stroke-miterlimit: 1.5;
95c114
< 	opacity: 0.275;
---
>   opacity: 0.275;
99c118
< 	animation: spinner 0.5s linear infinite;
---
>   animation: spinner 0.5s linear infinite;
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkMisskeyFlavoredMarkdown.vue RiricaV13/components/global/MkMisskeyFlavoredMarkdown.vue
2c2,11
< <MfmCore :text="text" :plain="plain" :nowrap="nowrap" :author="author" :is-note="isNote" :class="[$style.root, { [$style.nowrap]: nowrap }]"/>
---
>   <MfmCore
>     :text="text"
>     :plain="plain"
>     :nowrap="nowrap"
>     :author="author"
>     :customEmojis="customEmojis"
>     :isNote="isNote"
>     class="havbbuyv"
>     :class="{ nowrap }"
>   />
6,7c15,16
< import { } from 'vue';
< import MfmCore from '@/components/mfm';
---
> import {} from "vue";
> import MfmCore from "@/components/mfm";
9,20c18,33
< const props = withDefaults(defineProps<{
< 	text: string;
< 	plain?: boolean;
< 	nowrap?: boolean;
< 	author?: any;
< 	isNote?: boolean;
< }>(), {
< 	plain: false,
< 	nowrap: false,
< 	author: null,
< 	isNote: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     text: string;
>     plain?: boolean;
>     nowrap?: boolean;
>     author?: any;
>     customEmojis?: any;
>     isNote?: boolean;
>   }>(),
>   {
>     plain: false,
>     nowrap: false,
>     author: null,
>     isNote: true,
>   }
> );
25,26c38,39
< 	filter: blur(6px);
< 	transition: filter 0.3s;
---
>   filter: blur(6px);
>   transition: filter 0.3s;
28,30c41,43
< 	&:hover {
< 		filter: blur(0px);
< 	}
---
>   &:hover {
>     filter: blur(0px);
>   }
34c47
< 	--mfm-zoom-size: 200%;
---
>   --mfm-zoom-size: 200%;
38c51
< 	--mfm-zoom-size: 400%;
---
>   --mfm-zoom-size: 400%;
42c55
< 	--mfm-zoom-size: 600%;
---
>   --mfm-zoom-size: 600%;
45,46c58,61
< .mfm-x2, .mfm-x3, .mfm-x4 {
< 	font-size: var(--mfm-zoom-size);
---
> .mfm-x2,
> .mfm-x3,
> .mfm-x4 {
>   font-size: var(--mfm-zoom-size);
48,50c63,67
< 	.mfm-x2, .mfm-x3, .mfm-x4 {
< 		/* only half effective */
< 		font-size: calc(var(--mfm-zoom-size) / 2 + 50%);
---
>   .mfm-x2,
>   .mfm-x3,
>   .mfm-x4 {
>     /* only half effective */
>     font-size: calc(var(--mfm-zoom-size) / 2 + 50%);
52,56c69,75
< 		.mfm-x2, .mfm-x3, .mfm-x4 {
< 			/* disabled */
< 			font-size: 100%;
< 		}
< 	}
---
>     .mfm-x2,
>     .mfm-x3,
>     .mfm-x4 {
>       /* disabled */
>       font-size: 100%;
>     }
>   }
60,61c79,84
< 	0% { transform: rotate(0deg); }
< 	100% { transform: rotate(360deg); }
---
>   0% {
>     transform: rotate(0deg);
>   }
>   100% {
>     transform: rotate(360deg);
>   }
65,66c88,93
< 	0% { transform: perspective(128px) rotateX(0deg); }
< 	100% { transform: perspective(128px) rotateX(360deg); }
---
>   0% {
>     transform: perspective(128px) rotateX(0deg);
>   }
>   100% {
>     transform: perspective(128px) rotateX(360deg);
>   }
70,71c97,102
< 	0% { transform: perspective(128px) rotateY(0deg); }
< 	100% { transform: perspective(128px) rotateY(360deg); }
---
>   0% {
>     transform: perspective(128px) rotateY(0deg);
>   }
>   100% {
>     transform: perspective(128px) rotateY(360deg);
>   }
75,79c106,120
< 	0% { transform: translateY(0); }
< 	25% { transform: translateY(-16px); }
< 	50% { transform: translateY(0); }
< 	75% { transform: translateY(-8px); }
< 	100% { transform: translateY(0); }
---
>   0% {
>     transform: translateY(0);
>   }
>   25% {
>     transform: translateY(-16px);
>   }
>   50% {
>     transform: translateY(0);
>   }
>   75% {
>     transform: translateY(-8px);
>   }
>   100% {
>     transform: translateY(0);
>   }
83,87c124,138
< 	0% { transform: translateY(0) scale(1, 1); }
< 	25% { transform: translateY(-16px) scale(1, 1); }
< 	50% { transform: translateY(0) scale(1, 1); }
< 	75% { transform: translateY(0) scale(1.5, 0.75); }
< 	100% { transform: translateY(0) scale(1, 1); }
---
>   0% {
>     transform: translateY(0) scale(1, 1);
>   }
>   25% {
>     transform: translateY(-16px) scale(1, 1);
>   }
>   50% {
>     transform: translateY(0) scale(1, 1);
>   }
>   75% {
>     transform: translateY(0) scale(1.5, 0.75);
>   }
>   100% {
>     transform: translateY(0) scale(1, 1);
>   }
94,114c145,207
< 	0% { transform: translate(7px, -2px) }
< 	5% { transform: translate(-3px, 1px) }
< 	10% { transform: translate(-7px, -1px) }
< 	15% { transform: translate(0px, -1px) }
< 	20% { transform: translate(-8px, 6px) }
< 	25% { transform: translate(-4px, -3px) }
< 	30% { transform: translate(-4px, -6px) }
< 	35% { transform: translate(-8px, -8px) }
< 	40% { transform: translate(4px, 6px) }
< 	45% { transform: translate(-3px, 1px) }
< 	50% { transform: translate(2px, -10px) }
< 	55% { transform: translate(-7px, 0px) }
< 	60% { transform: translate(-2px, 4px) }
< 	65% { transform: translate(3px, -8px) }
< 	70% { transform: translate(6px, 7px) }
< 	75% { transform: translate(-7px, -2px) }
< 	80% { transform: translate(-7px, -8px) }
< 	85% { transform: translate(9px, 3px) }
< 	90% { transform: translate(-3px, -2px) }
< 	95% { transform: translate(-10px, 2px) }
< 	100% { transform: translate(-2px, -6px) }
---
>   0% {
>     transform: translate(7px, -2px);
>   }
>   5% {
>     transform: translate(-3px, 1px);
>   }
>   10% {
>     transform: translate(-7px, -1px);
>   }
>   15% {
>     transform: translate(0px, -1px);
>   }
>   20% {
>     transform: translate(-8px, 6px);
>   }
>   25% {
>     transform: translate(-4px, -3px);
>   }
>   30% {
>     transform: translate(-4px, -6px);
>   }
>   35% {
>     transform: translate(-8px, -8px);
>   }
>   40% {
>     transform: translate(4px, 6px);
>   }
>   45% {
>     transform: translate(-3px, 1px);
>   }
>   50% {
>     transform: translate(2px, -10px);
>   }
>   55% {
>     transform: translate(-7px, 0px);
>   }
>   60% {
>     transform: translate(-2px, 4px);
>   }
>   65% {
>     transform: translate(3px, -8px);
>   }
>   70% {
>     transform: translate(6px, 7px);
>   }
>   75% {
>     transform: translate(-7px, -2px);
>   }
>   80% {
>     transform: translate(-7px, -8px);
>   }
>   85% {
>     transform: translate(9px, 3px);
>   }
>   90% {
>     transform: translate(-3px, -2px);
>   }
>   95% {
>     transform: translate(-10px, 2px);
>   }
>   100% {
>     transform: translate(-2px, -6px);
>   }
121,141c214,276
< 	0% { transform: translate(-3px, -1px) rotate(-8deg) }
< 	5% { transform: translate(0px, -1px) rotate(-10deg) }
< 	10% { transform: translate(1px, -3px) rotate(0deg) }
< 	15% { transform: translate(1px, 1px) rotate(11deg) }
< 	20% { transform: translate(-2px, 1px) rotate(1deg) }
< 	25% { transform: translate(-1px, -2px) rotate(-2deg) }
< 	30% { transform: translate(-1px, 2px) rotate(-3deg) }
< 	35% { transform: translate(2px, 1px) rotate(6deg) }
< 	40% { transform: translate(-2px, -3px) rotate(-9deg) }
< 	45% { transform: translate(0px, -1px) rotate(-12deg) }
< 	50% { transform: translate(1px, 2px) rotate(10deg) }
< 	55% { transform: translate(0px, -3px) rotate(8deg) }
< 	60% { transform: translate(1px, -1px) rotate(8deg) }
< 	65% { transform: translate(0px, -1px) rotate(-7deg) }
< 	70% { transform: translate(-1px, -3px) rotate(6deg) }
< 	75% { transform: translate(0px, -2px) rotate(4deg) }
< 	80% { transform: translate(-2px, -1px) rotate(3deg) }
< 	85% { transform: translate(1px, -3px) rotate(-10deg) }
< 	90% { transform: translate(1px, 0px) rotate(3deg) }
< 	95% { transform: translate(-2px, 0px) rotate(-3deg) }
< 	100% { transform: translate(2px, 1px) rotate(2deg) }
---
>   0% {
>     transform: translate(-3px, -1px) rotate(-8deg);
>   }
>   5% {
>     transform: translate(0px, -1px) rotate(-10deg);
>   }
>   10% {
>     transform: translate(1px, -3px) rotate(0deg);
>   }
>   15% {
>     transform: translate(1px, 1px) rotate(11deg);
>   }
>   20% {
>     transform: translate(-2px, 1px) rotate(1deg);
>   }
>   25% {
>     transform: translate(-1px, -2px) rotate(-2deg);
>   }
>   30% {
>     transform: translate(-1px, 2px) rotate(-3deg);
>   }
>   35% {
>     transform: translate(2px, 1px) rotate(6deg);
>   }
>   40% {
>     transform: translate(-2px, -3px) rotate(-9deg);
>   }
>   45% {
>     transform: translate(0px, -1px) rotate(-12deg);
>   }
>   50% {
>     transform: translate(1px, 2px) rotate(10deg);
>   }
>   55% {
>     transform: translate(0px, -3px) rotate(8deg);
>   }
>   60% {
>     transform: translate(1px, -1px) rotate(8deg);
>   }
>   65% {
>     transform: translate(0px, -1px) rotate(-7deg);
>   }
>   70% {
>     transform: translate(-1px, -3px) rotate(6deg);
>   }
>   75% {
>     transform: translate(0px, -2px) rotate(4deg);
>   }
>   80% {
>     transform: translate(-2px, -1px) rotate(3deg);
>   }
>   85% {
>     transform: translate(1px, -3px) rotate(-10deg);
>   }
>   90% {
>     transform: translate(1px, 0px) rotate(3deg);
>   }
>   95% {
>     transform: translate(-2px, 0px) rotate(-3deg);
>   }
>   100% {
>     transform: translate(2px, 1px) rotate(2deg);
>   }
145,151c280,300
< 	from { transform: scale3d(1, 1, 1); }
< 	30% { transform: scale3d(1.25, 0.75, 1); }
< 	40% { transform: scale3d(0.75, 1.25, 1); }
< 	50% { transform: scale3d(1.15, 0.85, 1); }
< 	65% { transform: scale3d(0.95, 1.05, 1); }
< 	75% { transform: scale3d(1.05, 0.95, 1); }
< 	to { transform: scale3d(1, 1, 1); }
---
>   from {
>     transform: scale3d(1, 1, 1);
>   }
>   30% {
>     transform: scale3d(1.25, 0.75, 1);
>   }
>   40% {
>     transform: scale3d(0.75, 1.25, 1);
>   }
>   50% {
>     transform: scale3d(1.15, 0.85, 1);
>   }
>   65% {
>     transform: scale3d(0.95, 1.05, 1);
>   }
>   75% {
>     transform: scale3d(1.05, 0.95, 1);
>   }
>   to {
>     transform: scale3d(1, 1, 1);
>   }
155,156c304,309
< 	0% { filter: hue-rotate(0deg) contrast(150%) saturate(150%); }
< 	100% { filter: hue-rotate(360deg) contrast(150%) saturate(150%); }
---
>   0% {
>     filter: hue-rotate(0deg) contrast(150%) saturate(150%);
>   }
>   100% {
>     filter: hue-rotate(360deg) contrast(150%) saturate(150%);
>   }
160,162c313,315
< <style lang="scss" module>
< .root {
< 	white-space: pre-wrap;
---
> <style lang="scss" scoped>
> .havbbuyv {
>   white-space: pre-wrap;
164,169c317,341
< 	&.nowrap {
< 		white-space: pre;
< 		word-wrap: normal; // https://codeday.me/jp/qa/20190424/690106.html
< 		overflow: hidden;
< 		text-overflow: ellipsis;
< 	}
---
>   &.nowrap {
>     white-space: pre;
>     word-wrap: normal; // https://codeday.me/jp/qa/20190424/690106.html
>     overflow: hidden;
>     text-overflow: ellipsis;
>   }
> 
>   ::v-deep(.quote) {
>     display: block;
>     margin: 8px;
>     padding: 6px 0 6px 12px;
>     color: var(--fg);
>     border-left: solid 3px var(--fg);
>     opacity: 0.7;
>   }
> 
>   ::v-deep(pre) {
>     font-size: 0.8em;
>   }
> 
>   > ::v-deep(code) {
>     font-size: 0.8em;
>     word-break: break-all;
>     padding: 4px 6px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkPageHeader.vue RiricaV13/components/global/MkPageHeader.vue
2,9c2,27
< <div v-if="show" ref="el" :class="[$style.root, { [$style.slim]: narrow, [$style.thin]: thin_ }]" :style="{ background: bg }" @click="onClick">
< 	<div v-if="narrow" :class="$style.buttonsLeft">
< 		<MkAvatar v-if="props.displayMyAvatar && $i" :class="$style.avatar" :user="$i"/>
< 	</div>
< 	<template v-if="metadata">
< 		<div v-if="!hideTitle" :class="$style.titleContainer" @click="showTabsPopup">
< 			<MkAvatar v-if="metadata.avatar" :class="$style.titleAvatar" :user="metadata.avatar" indicator/>
< 			<i v-else-if="metadata.icon" :class="[$style.titleIcon, metadata.icon]"></i>
---
>   <div
>     v-if="show"
>     ref="el"
>     class="fdidabkb"
>     :class="{ slim: narrow, thin: thin_ }"
>     :style="{ background: bg }"
>     @click="onClick"
>   >
>     <div v-if="narrow" class="buttons left">
>       <MkAvatar
>         v-if="props.displayMyAvatar && $i"
>         class="avatar"
>         :user="$i"
>         :disable-preview="true"
>       />
>     </div>
>     <template v-if="metadata">
>       <div v-if="!hideTitle" class="titleContainer" @click="showTabsPopup">
>         <MkAvatar
>           v-if="metadata.avatar"
>           class="avatar"
>           :user="metadata.avatar"
>           :disable-preview="true"
>           :show-indicator="true"
>         />
>         <i v-else-if="metadata.icon" class="icon" :class="metadata.icon"></i>
11,36c29,77
< 			<div :class="$style.title">
< 				<MkUserName v-if="metadata.userName" :user="metadata.userName" :nowrap="true"/>
< 				<div v-else-if="metadata.title">{{ metadata.title }}</div>
< 				<div v-if="!narrow && metadata.subtitle" :class="$style.subtitle">
< 					{{ metadata.subtitle }}
< 				</div>
< 				<div v-if="narrow && hasTabs" :class="[$style.subtitle, $style.activeTab]">
< 					{{ tabs.find(tab => tab.key === props.tab)?.title }}
< 					<i class="ti ti-chevron-down" :class="$style.chevron"></i>
< 				</div>
< 			</div>
< 		</div>
< 		<div v-if="!narrow || hideTitle" :class="$style.tabs">
< 			<button v-for="tab in tabs" :ref="(el) => tabRefs[tab.key] = (el as HTMLElement)" v-tooltip.noDelay="tab.title" class="_button" :class="[$style.tab, { [$style.active]: tab.key != null && tab.key === props.tab }]" @mousedown="(ev) => onTabMousedown(tab, ev)" @click="(ev) => onTabClick(tab, ev)">
< 				<i v-if="tab.icon" :class="[$style.tabIcon, tab.icon]"></i>
< 				<span v-if="!tab.iconOnly" :class="$style.tabTitle">{{ tab.title }}</span>
< 			</button>
< 			<div ref="tabHighlightEl" :class="$style.tabHighlight"></div>
< 		</div>
< 	</template>
< 	<div :class="$style.buttonsRight">
< 		<template v-for="action in actions">
< 			<button v-tooltip.noDelay="action.text" class="_button" :class="[$style.button, { [$style.highlighted]: action.highlighted }]" @click.stop="action.handler" @touchstart="preventDrag"><i :class="action.icon"></i></button>
< 		</template>
< 	</div>
< </div>
---
>         <div class="title">
>           <MkUserName
>             v-if="metadata.userName"
>             :user="metadata.userName"
>             :nowrap="true"
>             class="title"
>           />
>           <div v-else-if="metadata.title" class="title">
>             {{ metadata.title }}
>           </div>
>           <div v-if="!narrow && metadata.subtitle" class="subtitle">
>             {{ metadata.subtitle }}
>           </div>
>           <div v-if="narrow && hasTabs" class="subtitle activeTab">
>             {{ tabs.find((tab) => tab.key === props.tab)?.title }}
>             <i class="chevron fas fa-chevron-down"></i>
>           </div>
>         </div>
>       </div>
>       <div v-if="!narrow || hideTitle" class="tabs">
>         <button
>           v-for="tab in tabs"
>           :ref="(el) => (tabRefs[tab.key] = el)"
>           v-tooltip.noDelay="tab.title"
>           class="tab _button"
>           :class="{ active: tab.key != null && tab.key === props.tab }"
>           @mousedown="(ev) => onTabMousedown(tab, ev)"
>           @click="(ev) => onTabClick(tab, ev)"
>         >
>           <i v-if="tab.icon" class="icon" :class="tab.icon"></i>
>           <span v-if="!tab.iconOnly" class="title">{{ tab.title }}</span>
>         </button>
>         <div ref="tabHighlightEl" class="highlight"></div>
>       </div>
>     </template>
>     <div class="buttons right">
>       <template v-for="action in actions">
>         <button
>           v-tooltip.noDelay="action.text"
>           class="_button button"
>           :class="{ highlighted: action.highlighted }"
>           @click.stop="action.handler"
>           @touchstart="preventDrag"
>         >
>           <i :class="action.icon"></i>
>         </button>
>       </template>
>     </div>
>   </div>
40,46c81,98
< import { onMounted, onUnmounted, ref, inject, watch, nextTick } from 'vue';
< import tinycolor from 'tinycolor2';
< import { popupMenu } from '@/os';
< import { scrollToTop } from '@/scripts/scroll';
< import { globalEvents } from '@/events';
< import { injectPageMetadata } from '@/scripts/page-metadata';
< import { $i } from '@/account';
---
> import {
>   computed,
>   onMounted,
>   onUnmounted,
>   ref,
>   inject,
>   watch,
>   shallowReactive,
>   nextTick,
>   reactive,
> } from "vue";
> import tinycolor from "tinycolor2";
> import { popupMenu } from "@/os";
> import { scrollToTop } from "@/scripts/scroll";
> import { i18n } from "@/i18n";
> import { globalEvents } from "@/events";
> import { injectPageMetadata } from "@/scripts/page-metadata";
> import { $i } from "@/account";
49,53c101,105
< 	key: string;
< 	title: string;
< 	icon?: string;
< 	iconOnly?: boolean;
< 	onClick?: (ev: MouseEvent) => void;
---
>   key?: string | null;
>   title: string;
>   icon?: string;
>   iconOnly?: boolean;
>   onClick?: (ev: MouseEvent) => void;
56,69c108,118
< const props = withDefaults(defineProps<{
< 	tabs?: Tab[];
< 	tab?: string;
< 	actions?: {
< 		text: string;
< 		icon: string;
< 		highlighted?: boolean;
< 		handler: (ev: MouseEvent) => void;
< 	}[];
< 	thin?: boolean;
< 	displayMyAvatar?: boolean;
< }>(), {
< 	tabs: () => ([] as Tab[]),
< });
---
> const props = defineProps<{
>   tabs?: Tab[];
>   tab?: string;
>   actions?: {
>     text: string;
>     icon: string;
>     handler: (ev: MouseEvent) => void;
>   }[];
>   thin?: boolean;
>   displayMyAvatar?: boolean;
> }>();
72c121
< 	(ev: 'update:tab', key: string);
---
>   (ev: "update:tab", key: string);
77,78c126,127
< const hideTitle = inject('shouldOmitHeaderTitle', false);
< const thin_ = props.thin || inject('shouldHeaderThin', false);
---
> const hideTitle = inject("shouldOmitHeaderTitle", false);
> const thin_ = props.thin || inject("shouldHeaderThin", false);
80,83c129,132
< const el = $shallowRef<HTMLElement | undefined>(undefined);
< const tabRefs: Record<string, HTMLElement | null> = {};
< const tabHighlightEl = $shallowRef<HTMLElement | null>(null);
< const bg = ref<string | undefined>(undefined);
---
> const el = $ref<HTMLElement | null>(null);
> const tabRefs = {};
> const tabHighlightEl = $ref<HTMLElement | null>(null);
> const bg = ref(null);
85c134,135
< const hasTabs = $computed(() => props.tabs.length > 0);
---
> const height = ref(0);
> const hasTabs = $computed(() => props.tabs && props.tabs.length > 0);
88c138
< 	return !hideTitle || hasTabs || hasActions;
---
>   return !hideTitle || hasTabs || hasActions;
92,104c142,154
< 	if (!hasTabs) return;
< 	if (!narrow) return;
< 	ev.preventDefault();
< 	ev.stopPropagation();
< 	const menu = props.tabs.map(tab => ({
< 		text: tab.title,
< 		icon: tab.icon,
< 		active: tab.key != null && tab.key === props.tab,
< 		action: (ev) => {
< 			onTabClick(tab, ev);
< 		},
< 	}));
< 	popupMenu(menu, (ev.currentTarget ?? ev.target) as HTMLElement);
---
>   if (!hasTabs) return;
>   if (!narrow) return;
>   ev.preventDefault();
>   ev.stopPropagation();
>   const menu = props.tabs.map((tab) => ({
>     text: tab.title,
>     icon: tab.icon,
>     active: tab.key != null && tab.key === props.tab,
>     action: (ev) => {
>       onTabClick(tab, ev);
>     },
>   }));
>   popupMenu(menu, ev.currentTarget ?? ev.target);
108c158
< 	ev.stopPropagation();
---
>   ev.stopPropagation();
112,114c162
< 	if (el) {
< 		scrollToTop(el as HTMLElement, { behavior: 'smooth' });
< 	}
---
>   scrollToTop(el, { behavior: "smooth" });
118,121c166,169
< 	// ユーザビリティの観点からmousedown時にはonClickは呼ばない
< 	if (tab.key) {
< 		emit('update:tab', tab.key);
< 	}
---
>   // ユーザビリティの観点からmousedown時にはonClickは呼ばない
>   if (tab.key) {
>     emit("update:tab", tab.key);
>   }
125,132c173,180
< 	if (tab.onClick) {
< 		ev.preventDefault();
< 		ev.stopPropagation();
< 		tab.onClick(ev);
< 	}
< 	if (tab.key) {
< 		emit('update:tab', tab.key);
< 	}
---
>   if (tab.onClick) {
>     ev.preventDefault();
>     ev.stopPropagation();
>     tab.onClick(ev);
>   }
>   if (tab.key) {
>     emit("update:tab", tab.key);
>   }
136,139c184,193
< 	const rawBg = metadata?.bg || 'var(--bg)';
< 	const tinyBg = tinycolor(rawBg.startsWith('var(') ? getComputedStyle(document.documentElement).getPropertyValue(rawBg.slice(4, -1)) : rawBg);
< 	tinyBg.setAlpha(0.85);
< 	bg.value = tinyBg.toRgbString();
---
>   const rawBg = metadata?.bg || "var(--bg)";
>   const tinyBg = tinycolor(
>     rawBg.startsWith("var(")
>       ? getComputedStyle(document.documentElement).getPropertyValue(
>           rawBg.slice(4, -1)
>         )
>       : rawBg
>   );
>   tinyBg.setAlpha(0.85);
>   bg.value = tinyBg.toRgbString();
145,146c199,200
< 	calcBg();
< 	globalEvents.on('themeChanged', calcBg);
---
>   calcBg();
>   globalEvents.on("themeChanged", calcBg);
148,162c202,220
< 	watch(() => [props.tab, props.tabs], () => {
< 		nextTick(() => {
< 			const tabEl = props.tab ? tabRefs[props.tab] : undefined;
< 			if (tabEl && tabHighlightEl && tabEl.parentElement) {
< 				// offsetWidth や offsetLeft は少数を丸めてしまうため getBoundingClientRect を使う必要がある
< 				// https://developer.mozilla.org/ja/docs/Web/API/HTMLElement/offsetWidth#%E5%80%A4
< 				const parentRect = tabEl.parentElement.getBoundingClientRect();
< 				const rect = tabEl.getBoundingClientRect();
< 				tabHighlightEl.style.width = rect.width + 'px';
< 				tabHighlightEl.style.left = (rect.left - parentRect.left) + 'px';
< 			}
< 		});
< 	}, {
< 		immediate: true,
< 	});
---
>   watch(
>     () => [props.tab, props.tabs],
>     () => {
>       nextTick(() => {
>         const tabEl = tabRefs[props.tab];
>         if (tabEl && tabHighlightEl) {
>           // offsetWidth や offsetLeft は少数を丸めてしまうため getBoundingClientRect を使う必要がある
>           // https://developer.mozilla.org/ja/docs/Web/API/HTMLElement/offsetWidth#%E5%80%A4
>           const parentRect = tabEl.parentElement.getBoundingClientRect();
>           const rect = tabEl.getBoundingClientRect();
>           tabHighlightEl.style.width = rect.width + "px";
>           tabHighlightEl.style.left = rect.left - parentRect.left + "px";
>         }
>       });
>     },
>     {
>       immediate: true,
>     }
>   );
164,172c222,230
< 	if (el && el.parentElement) {
< 		narrow = el.parentElement.offsetWidth < 500;
< 		ro = new ResizeObserver((entries, observer) => {
< 			if (el.parentElement && document.body.contains(el as HTMLElement)) {
< 				narrow = el.parentElement.offsetWidth < 500;
< 			}
< 		});
< 		ro.observe(el.parentElement as HTMLElement);
< 	}
---
>   if (el && el.parentElement) {
>     narrow = el.parentElement.offsetWidth < 500;
>     ro = new ResizeObserver((entries, observer) => {
>       if (el.parentElement && document.body.contains(el)) {
>         narrow = el.parentElement.offsetWidth < 500;
>       }
>     });
>     ro.observe(el.parentElement);
>   }
176,177c234,235
< 	globalEvents.off('themeChanged', calcBg);
< 	if (ro) ro.disconnect();
---
>   globalEvents.off("themeChanged", calcBg);
>   if (ro) ro.disconnect();
181,190c239,248
< <style lang="scss" module>
< .root {
< 	--height: 50px;
< 	display: flex;
< 	width: 100%;
< 	-webkit-backdrop-filter: var(--blur, blur(15px));
< 	backdrop-filter: var(--blur, blur(15px));
< 	border-bottom: solid 0.5px var(--divider);
< 	contain: strict;
< 	height: var(--height);
---
> <style lang="scss" scoped>
> .fdidabkb {
>   --height: 55px;
>   display: flex;
>   width: 100%;
>   -webkit-backdrop-filter: var(--blur, blur(15px));
>   backdrop-filter: var(--blur, blur(15px));
>   border-bottom: solid 0.5px var(--divider);
>   contain: strict;
>   height: var(--height);
192,193c250,251
< 	&.thin {
< 		--height: 42px;
---
>   &.thin {
>     --height: 45px;
195,200c253,258
< 		> .buttons {
< 			> .button {
< 				font-size: 0.9em;
< 			}
< 		}
< 	}
---
>     > .buttons {
>       > .button {
>         font-size: 0.9em;
>       }
>     }
>   }
202,203c260,261
< 	&.slim {
< 		text-align: center;
---
>   &.slim {
>     text-align: center;
205,207c263,265
< 		> .titleContainer {
< 			flex: 1;
< 			margin: 0 auto;
---
>     > .titleContainer {
>       flex: 1;
>       margin: 0 auto;
209,211c267,269
< 			> *:first-child {
< 				margin-left: auto;
< 			}
---
>       > *:first-child {
>         margin-left: auto;
>       }
213,218c271,275
< 			> *:last-child {
< 				margin-right: auto;
< 			}
< 		}
< 	}
< }
---
>       > *:last-child {
>         margin-right: auto;
>       }
>     }
>   }
220,226c277,283
< .buttons {
< 	--margin: 8px;
< 	display: flex;
< 	align-items: center;
< 	min-width: var(--height);
< 	height: var(--height);
< 	margin: 0 var(--margin);
---
>   > .buttons {
>     --margin: 8px;
>     display: flex;
>     align-items: center;
>     min-width: var(--height);
>     height: var(--height);
>     margin: 0 var(--margin);
228,231c285,286
< 	&:empty {
< 		width: var(--height);
< 	}
< }
---
>     &.left {
>       margin-right: auto;
233,236c288,297
< .buttonsLeft {
< 	composes: buttons;
< 	margin-right: auto;
< }
---
>       > .avatar {
>         $size: 32px;
>         display: inline-block;
>         width: $size;
>         height: $size;
>         vertical-align: bottom;
>         margin: 0 8px;
>         pointer-events: none;
>       }
>     }
238,241c299,301
< .buttonsRight {
< 	composes: buttons;
< 	margin-left: auto;
< }
---
>     &.right {
>       margin-left: auto;
>     }
243,251c303,305
< .avatar {
< 	$size: 32px;
< 	display: inline-block;
< 	width: $size;
< 	height: $size;
< 	vertical-align: bottom;
< 	margin: 0 8px;
< 	pointer-events: none;
< }
---
>     &:empty {
>       width: var(--height);
>     }
253,261c307,315
< .button {
< 	display: flex;
< 	align-items: center;
< 	justify-content: center;
< 	height: calc(var(--height) - (var(--margin) * 2));
< 	width: calc(var(--height) - (var(--margin) * 2));
< 	box-sizing: border-box;
< 	position: relative;
< 	border-radius: 5px;
---
>     > .button {
>       display: flex;
>       align-items: center;
>       justify-content: center;
>       height: calc(var(--height) - (var(--margin) * 2));
>       width: calc(var(--height) - (var(--margin) * 2));
>       box-sizing: border-box;
>       position: relative;
>       border-radius: 5px;
263,265c317,319
< 	&:hover {
< 		background: rgba(0, 0, 0, 0.05);
< 	}
---
>       &:hover {
>         background: rgba(0, 0, 0, 0.05);
>       }
267,270c321,324
< 	&.highlighted {
< 		color: var(--accent);
< 	}
< }
---
>       &.highlighted {
>         color: var(--accent);
>       }
>     }
272,276c326,331
< .fullButton {
< 	& + .fullButton {
< 		margin-left: 12px;
< 	}
< }
---
>     > .fullButton {
>       & + .fullButton {
>         margin-left: 12px;
>       }
>     }
>   }
278,288c333,342
< .titleContainer {
< 	display: flex;
< 	align-items: center;
< 	max-width: 400px;
< 	overflow: auto;
< 	white-space: nowrap;
< 	text-align: left;
< 	font-weight: bold;
< 	flex-shrink: 0;
< 	margin-left: 24px;
< }
---
>   > .titleContainer {
>     display: flex;
>     align-items: center;
>     max-width: 400px;
>     overflow: auto;
>     white-space: nowrap;
>     text-align: left;
>     font-weight: bold;
>     flex-shrink: 0;
>     margin-left: 24px;
290,298c344,352
< .titleAvatar {
< 	$size: 32px;
< 	display: inline-block;
< 	width: $size;
< 	height: $size;
< 	vertical-align: bottom;
< 	margin: 0 8px;
< 	pointer-events: none;
< }
---
>     > .avatar {
>       $size: 32px;
>       display: inline-block;
>       width: $size;
>       height: $size;
>       vertical-align: bottom;
>       margin: 0 8px;
>       pointer-events: none;
>     }
300,304c354,358
< .titleIcon {
< 	margin-right: 8px;
< 	width: 16px;
< 	text-align: center;
< }
---
>     > .icon {
>       margin-right: 8px;
>       width: 16px;
>       text-align: center;
>     }
306,312c360,365
< .title {
< 	min-width: 0;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
< 	white-space: nowrap;
< 	line-height: 1.1;
< }
---
>     > .title {
>       min-width: 0;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       white-space: nowrap;
>       line-height: 1.1;
314,320c367,373
< .subtitle {
< 	opacity: 0.6;
< 	font-size: 0.8em;
< 	font-weight: normal;
< 	white-space: nowrap;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
---
>       > .subtitle {
>         opacity: 0.6;
>         font-size: 0.8em;
>         font-weight: normal;
>         white-space: nowrap;
>         overflow: hidden;
>         text-overflow: ellipsis;
322,323c375,376
< 	&.activeTab {
< 		text-align: center;
---
>         &.activeTab {
>           text-align: center;
325,330c378,385
< 		> .chevron {
< 			display: inline-block;
< 			margin-left: 6px;
< 		}
< 	}
< }
---
>           > .chevron {
>             display: inline-block;
>             margin-left: 6px;
>           }
>         }
>       }
>     }
>   }
332,338c387,392
< .tabs {
< 	position: relative;
< 	margin-left: 16px;
< 	font-size: 0.8em;
< 	overflow: auto;
< 	white-space: nowrap;
< }
---
>   > .tabs {
>     position: relative;
>     margin-left: 16px;
>     font-size: 0.8em;
>     overflow: auto;
>     white-space: nowrap;
340,346c394,400
< .tab {
< 	display: inline-block;
< 	position: relative;
< 	padding: 0 10px;
< 	height: 100%;
< 	font-weight: normal;
< 	opacity: 0.7;
---
>     > .tab {
>       display: inline-block;
>       position: relative;
>       padding: 0 10px;
>       height: 100%;
>       font-weight: normal;
>       opacity: 0.7;
348,350c402,404
< 	&:hover {
< 		opacity: 1;
< 	}
---
>       &:hover {
>         opacity: 1;
>       }
352,355c406,408
< 	&.active {
< 		opacity: 1;
< 	}
< }
---
>       &.active {
>         opacity: 1;
>       }
357,359c410,413
< .tabIcon + .tabTitle {
< 	margin-left: 8px;
< }
---
>       > .icon + .title {
>         margin-left: 8px;
>       }
>     }
361,368c415,424
< .tabHighlight {
< 	position: absolute;
< 	bottom: 0;
< 	height: 3px;
< 	background: var(--accent);
< 	border-radius: 999px;
< 	transition: all 0.2s ease;
< 	pointer-events: none;
---
>     > .highlight {
>       position: absolute;
>       bottom: 0;
>       height: 3px;
>       background: var(--accent);
>       border-radius: 999px;
>       transition: all 0.2s ease;
>       pointer-events: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkSpacer.vue RiricaV13/components/global/MkSpacer.vue
2,6c2,6
< <div :class="[$style.root, { [$style.rootMin]: forceSpacerMin }]">
< 	<div :class="$style.content">
< 		<slot></slot>
< 	</div>
< </div>
---
>   <div ref="root" :class="$style.root" :style="{ padding: margin + 'px' }">
>     <div ref="content" :class="$style.content">
>       <slot></slot>
>     </div>
>   </div>
10,11c10,11
< import { inject, onMounted, onUnmounted, ref } from 'vue';
< import { deviceKind } from '@/scripts/device-kind';
---
> import { inject, onMounted, onUnmounted, ref } from "vue";
> import { deviceKind } from "@/scripts/device-kind";
13,20c13,65
< const props = withDefaults(defineProps<{
< 	contentMax?: number | null;
< 	marginMin?: number;
< 	marginMax?: number;
< }>(), {
< 	contentMax: null,
< 	marginMin: 12,
< 	marginMax: 24,
---
> const props = withDefaults(
>   defineProps<{
>     contentMax?: number | null;
>     marginMin?: number;
>     marginMax?: number;
>   }>(),
>   {
>     contentMax: null,
>     marginMin: 12,
>     marginMax: 24,
>   }
> );
> 
> let ro: ResizeObserver;
> let root = $ref<HTMLElement>();
> let content = $ref<HTMLElement>();
> let margin = $ref(0);
> const shouldSpacerMin = inject("shouldSpacerMin", false);
> 
> const adjust = (rect: { width: number; height: number }) => {
>   if (shouldSpacerMin || deviceKind === "smartphone") {
>     margin = props.marginMin;
>     return;
>   }
> 
>   if (
>     rect.width > (props.contentMax ?? 0) ||
>     (rect.width > 360 && window.innerWidth > 400)
>   ) {
>     margin = props.marginMax;
>   } else {
>     margin = props.marginMin;
>   }
> };
> 
> onMounted(() => {
>   ro = new ResizeObserver((entries) => {
>     /* iOSが対応していない
> 		adjust({
> 			width: entries[0].borderBoxSize[0].inlineSize,
> 			height: entries[0].borderBoxSize[0].blockSize,
> 		});
> 		*/
>     adjust({
>       width: root!.offsetWidth,
>       height: root!.offsetHeight,
>     });
>   });
>   ro.observe(root!);
> 
>   if (props.contentMax) {
>     content!.style.maxWidth = `${props.contentMax}px`;
>   }
23c68,70
< const forceSpacerMin = inject('forceSpacerMin', false) || deviceKind === 'smartphone';
---
> onUnmounted(() => {
>   ro.disconnect();
> });
28,29c75,76
< 	box-sizing: border-box;
< 	width: 100%;
---
>   box-sizing: border-box;
>   width: 100%;
31,33d77
< .rootMin {
< 	padding: v-bind('props.marginMin + "px"') !important;
< }
36,50c80
< 	margin: 0 auto;
< 	max-width: v-bind('props.contentMax + "px"');
< 	container-type: inline-size;
< }
< 
< @container (max-width: 450px) {
< 	.root {
< 		padding: v-bind('props.marginMin + "px"');
< 	}
< }
< 
< @container (min-width: 451px) {
< 	.root {
< 		padding: v-bind('props.marginMax + "px"');
< 	}
---
>   margin: 0 auto;
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkStickyContainer.vue RiricaV13/components/global/MkStickyContainer.vue
2,9c2,9
< <div ref="rootEl">
< 	<div ref="headerEl">
< 		<slot name="header"></slot>
< 	</div>
< 	<div ref="bodyEl" :data-sticky-container-header-height="headerHeight">
< 		<slot></slot>
< 	</div>
< </div>
---
>   <div ref="rootEl">
>     <div ref="headerEl">
>       <slot name="header"></slot>
>     </div>
>     <div ref="bodyEl" :data-sticky-container-header-height="headerHeight">
>       <slot></slot>
>     </div>
>   </div>
15c15
< const CURRENT_STICKY_TOP = 'CURRENT_STICKY_TOP';
---
> const CURRENT_STICKY_TOP = "CURRENT_STICKY_TOP";
19c19
< import { onMounted, onUnmounted, provide, inject, Ref, ref, watch } from 'vue';
---
> import { onMounted, onUnmounted, provide, inject, Ref, ref, watch } from "vue";
21,23c21,23
< const rootEl = $shallowRef<HTMLElement>();
< const headerEl = $shallowRef<HTMLElement>();
< const bodyEl = $shallowRef<HTMLElement>();
---
> const rootEl = $ref<HTMLElement>();
> const headerEl = $ref<HTMLElement>();
> const bodyEl = $ref<HTMLElement>();
27c27
< const parentStickyTop = inject<Ref<number>>(CURRENT_STICKY_TOP, ref(0));
---
> const parentStickyTop = inject<Ref<number>>(CURRENT_STICKY_TOP, ref(document.querySelector<HTMLElement>("#header")?.offsetHeight));
31,32c31,33
< 	childStickyTop = parentStickyTop.value + headerEl.offsetHeight;
< 	headerHeight = headerEl.offsetHeight.toString();
---
> 
>   childStickyTop = parentStickyTop.value + headerEl.offsetHeight;
>   headerHeight = headerEl.offsetHeight.toString();
36,38c37,39
< 	window.setTimeout(() => {
< 		calc();
< 	}, 100);
---
>   window.setTimeout(() => {
>     calc();
>   }, 100);
42c43
< 	calc();
---
>   calc();
44c45
< 	watch(parentStickyTop, calc);
---
>   watch(parentStickyTop, calc);
46,50c47,55
< 	watch($$(childStickyTop), () => {
< 		bodyEl.style.setProperty('--stickyTop', `${childStickyTop}px`);
< 	}, {
< 		immediate: true,
< 	});
---
>   watch(
>     $$(childStickyTop),
>     () => {
>       bodyEl.style.setProperty("--stickyTop", `${childStickyTop}px`);
>     },
>     {
>       immediate: true,
>     }
>   );
52,54c57,59
< 	headerEl.style.position = 'sticky';
< 	headerEl.style.top = 'var(--stickyTop, 0)';
< 	headerEl.style.zIndex = '1000';
---
>   headerEl.style.position = "sticky";
>   headerEl.style.top = "var(--stickyTop, 0)";
>   headerEl.style.zIndex = "1000";
56c61
< 	observer.observe(headerEl);
---
>   observer.observe(headerEl);
60c65
< 	observer.disconnect();
---
>   observer.disconnect();
64,66c69
< <style lang="scss" module>
< 
< </style>
---
> <style lang="scss" module></style>
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkTime.vue RiricaV13/components/global/MkTime.vue
2,6c2,8
< <time :title="absolute">
< 	<template v-if="mode === 'relative'">{{ relative }}</template>
< 	<template v-else-if="mode === 'absolute'">{{ absolute }}</template>
< 	<template v-else-if="mode === 'detail'">{{ absolute }} ({{ relative }})</template>
< </time>
---
>   <time :title="absolute">
>     <template v-if="mode === 'relative'">{{ relative }}</template>
>     <template v-else-if="mode === 'absolute'">{{ absolute }}</template>
>     <template v-else-if="mode === 'detail'"
>       >{{ absolute }} ({{ relative }})</template
>     >
>   </time>
10,12c12,13
< import { onUnmounted } from 'vue';
< import { i18n } from '@/i18n';
< import { dateTimeFormat } from '@/scripts/intl-const';
---
> import { onUnmounted } from "vue";
> import { i18n } from "@/i18n";
14,19c15,23
< const props = withDefaults(defineProps<{
< 	time: Date | string;
< 	mode?: 'relative' | 'absolute' | 'detail';
< }>(), {
< 	mode: 'relative',
< });
---
> const props = withDefaults(
>   defineProps<{
>     time: Date | string;
>     mode?: "relative" | "absolute" | "detail";
>   }>(),
>   {
>     mode: "relative",
>   }
> );
21,22c25,27
< const _time = typeof props.time === 'string' ? new Date(props.time) : props.time;
< const absolute = dateTimeFormat.format(_time);
---
> const _time =
>   typeof props.time === "string" ? new Date(props.time) : props.time;
> const absolute = _time.toLocaleString();
26,36c31,48
< 	const ago = (now.getTime() - _time.getTime()) / 1000/*ms*/;
< 	return (
< 		ago >= 31536000 ? i18n.t('_ago.yearsAgo', { n: Math.round(ago / 31536000).toString() }) :
< 		ago >= 2592000 ? i18n.t('_ago.monthsAgo', { n: Math.round(ago / 2592000).toString() }) :
< 		ago >= 604800 ? i18n.t('_ago.weeksAgo', { n: Math.round(ago / 604800).toString() }) :
< 		ago >= 86400 ? i18n.t('_ago.daysAgo', { n: Math.round(ago / 86400).toString() }) :
< 		ago >= 3600 ? i18n.t('_ago.hoursAgo', { n: Math.round(ago / 3600).toString() }) :
< 		ago >= 60 ? i18n.t('_ago.minutesAgo', { n: (~~(ago / 60)).toString() }) :
< 		ago >= 10 ? i18n.t('_ago.secondsAgo', { n: (~~(ago % 60)).toString() }) :
< 		ago >= -1 ? i18n.ts._ago.justNow :
< 		i18n.ts._ago.future);
---
>   const ago = (now.getTime() - _time.getTime()) / 1000; /*ms*/
>   return ago >= 31536000
>     ? i18n.t("_ago.yearsAgo", { n: Math.round(ago / 31536000).toString() })
>     : ago >= 2592000
>     ? i18n.t("_ago.monthsAgo", { n: Math.round(ago / 2592000).toString() })
>     : ago >= 604800
>     ? i18n.t("_ago.weeksAgo", { n: Math.round(ago / 604800).toString() })
>     : ago >= 86400
>     ? i18n.t("_ago.daysAgo", { n: Math.round(ago / 86400).toString() })
>     : ago >= 3600
>     ? i18n.t("_ago.hoursAgo", { n: Math.round(ago / 3600).toString() })
>     : ago >= 60
>     ? i18n.t("_ago.minutesAgo", { n: (~~(ago / 60)).toString() })
>     : ago >= 10
>     ? i18n.t("_ago.secondsAgo", { n: (~~(ago % 60)).toString() })
>     : ago >= -1
>     ? i18n.ts._ago.justNow
>     : i18n.ts._ago.future;
39,40d50
< let tickId: number;
< 
42,44c52,53
< 	now = new Date();
< 	const ago = (now.getTime() - _time.getTime()) / 1000/*ms*/;
< 	const next = ago < 60 ? 10000 : ago < 3600 ? 60000 : 180000;
---
>   // TODO: パフォーマンス向上のため、このコンポーネントが画面内に表示されている場合のみ更新する
>   now = new Date();
46c55,57
< 	tickId = window.setTimeout(tick, next);
---
>   tickId = window.setTimeout(() => {
>     window.requestAnimationFrame(tick);
>   }, 10000);
49,50c60
< if (props.mode === 'relative' || props.mode === 'detail') {
< 	tick();
---
> let tickId: number;
52,54c62,67
< 	onUnmounted(() => {
< 		window.clearTimeout(tickId);
< 	});
---
> if (props.mode === "relative" || props.mode === "detail") {
>   tickId = window.requestAnimationFrame(tick);
> 
>   onUnmounted(() => {
>     window.cancelAnimationFrame(tickId);
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkUrl.vue RiricaV13/components/global/MkUrl.vue
2,18c2,28
< <component
< 	:is="self ? 'MkA' : 'a'" ref="el" :class="$style.root" class="_link" :[attr]="self ? props.url.substring(local.length) : props.url" :rel="rel" :target="target"
< 	@contextmenu.stop="() => {}"
< >
< 	<template v-if="!self">
< 		<span :class="$style.schema">{{ schema }}//</span>
< 		<span :class="$style.hostname">{{ hostname }}</span>
< 		<span v-if="port != ''" :class="$style.port">:{{ port }}</span>
< 	</template>
< 	<template v-if="pathname === '/' && self">
< 		<span :class="$style.self">{{ hostname }}</span>
< 	</template>
< 	<span v-if="pathname != ''" :class="$style.pathname">{{ self ? pathname.substring(1) : pathname }}</span>
< 	<span :class="$style.query">{{ query }}</span>
< 	<span :class="$style.hash">{{ hash }}</span>
< 	<i v-if="target === '_blank'" :class="$style.icon" class="ti ti-external-link"></i>
< </component>
---
>   <component
>     :is="self ? 'MkA' : 'a'"
>     ref="el"
>     class="ieqqeuvs _link"
>     :[attr]="self ? props.url.substring(local.length) : props.url"
>     :rel="rel"
>     :target="target"
>     @contextmenu.stop="() => {}"
>   >
>     <template v-if="!self">
>       <span class="schema">{{ schema }}//</span>
>       <span class="hostname">{{ hostname }}</span>
>       <span v-if="port != ''" class="port">:{{ port }}</span>
>     </template>
>     <template v-if="pathname === '/' && self">
>       <span class="self">{{ hostname }}</span>
>     </template>
>     <span v-if="pathname != ''" class="pathname">{{
>       self ? pathname.substring(1) : pathname
>     }}</span>
>     <span class="query">{{ query }}</span>
>     <span class="hash">{{ hash }}</span>
>     <i
>       v-if="target === '_blank'"
>       class="fas fa-external-link-square-alt icon"
>     ></i>
>   </component>
22,27c32,37
< import { defineAsyncComponent, ref } from 'vue';
< import { toUnicode as decodePunycode } from 'punycode/';
< import { url as local } from '@/config';
< import * as os from '@/os';
< import { useTooltip } from '@/scripts/use-tooltip';
< import { safeURIDecode } from '@/scripts/safe-uri-decode';
---
> import { defineAsyncComponent, ref } from "vue";
> import { toUnicode as decodePunycode } from "punycode/";
> import { url as local } from "@/config";
> import * as os from "@/os";
> import { useTooltip } from "@/scripts/use-tooltip";
> import { safeURIDecode } from "@/scripts/safe-uri-decode";
30,31c40,41
< 	url: string;
< 	rel?: string;
---
>   url: string;
>   rel?: string;
39,43c49,58
< 	os.popup(defineAsyncComponent(() => import('@/components/MkUrlPreviewPopup.vue')), {
< 		showing,
< 		url: props.url,
< 		source: el.value,
< 	}, {}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkUrlPreviewPopup.vue")),
>     {
>       showing,
>       url: props.url,
>       source: el.value,
>     },
>     {},
>     "closed"
>   );
52,53c67,68
< const attr = self ? 'to' : 'href';
< const target = self ? null : '_blank';
---
> const attr = self ? "to" : "href";
> const target = self ? null : "_blank";
56,59c71,73
< <style lang="scss" module>
< .root {
< 	word-break: break-all;
< }
---
> <style lang="scss" scoped>
> .ieqqeuvs {
>   word-break: break-all;
61,64c75,78
< .icon {
< 	padding-left: 2px;
< 	font-size: .9em;
< }
---
>   > .icon {
>     padding-left: 2px;
>     font-size: 0.9em;
>   }
66,68c80,82
< .self {
< 	font-weight: bold;
< }
---
>   > .self {
>     font-weight: bold;
>   }
70,72c84,86
< .schema {
< 	opacity: 0.5;
< }
---
>   > .schema {
>     opacity: 0.5;
>   }
74,76c88,90
< .hostname {
< 	font-weight: bold;
< }
---
>   > .hostname {
>     font-weight: bold;
>   }
78,80c92,94
< .pathname {
< 	opacity: 0.8;
< }
---
>   > .pathname {
>     opacity: 0.8;
>   }
82,84c96,98
< .query {
< 	opacity: 0.5;
< }
---
>   > .query {
>     opacity: 0.5;
>   }
86,87c100,102
< .hash {
< 	font-style: italic;
---
>   > .hash {
>     font-style: italic;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/MkUserName.vue RiricaV13/components/global/MkUserName.vue
2c2,7
< <Mfm :text="user.name ?? user.username" :author="user" :plain="true" :nowrap="nowrap"/>
---
>   <Mfm
>     :text="user.name || user.username"
>     :plain="true"
>     :nowrap="nowrap"
>     :custom-emojis="user.emojis"
>   />
6,7c11,12
< import { } from 'vue';
< import * as misskey from 'misskey-js';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
9,14c14,22
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.User;
< 	nowrap?: boolean;
< }>(), {
< 	nowrap: true,
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: misskey.entities.User;
>     nowrap?: boolean;
>   }>(),
>   {
>     nowrap: true,
>   }
> );
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/RouterView.vue RiricaV13/components/global/RouterView.vue
2,4c2,8
< <KeepAlive :max="defaultStore.state.numberOfPageCache">
< 	<Suspense :timeout="0">
< 		<component :is="currentPageComponent" :key="key" v-bind="Object.fromEntries(currentPageProps)"/>
---
>   <KeepAlive :max="defaultStore.state.numberOfPageCache">
>     <Suspense>
>       <component
>         :is="currentPageComponent"
>         :key="key"
>         v-bind="Object.fromEntries(currentPageProps)"
>       />
6,10c10,14
< 		<template #fallback>
< 			<MkLoading/>
< 		</template>
< 	</Suspense>
< </KeepAlive>
---
>       <template #fallback>
>         <MkLoading />
>       </template>
>     </Suspense>
>   </KeepAlive>
14,16c18,28
< import { inject, nextTick, onBeforeUnmount, onMounted, onUnmounted, provide, watch } from 'vue';
< import { Resolved, Router } from '@/nirax';
< import { defaultStore } from '@/store';
---
> import {
>   inject,
>   nextTick,
>   onBeforeUnmount,
>   onMounted,
>   onUnmounted,
>   provide,
>   watch,
> } from "vue";
> import { Resolved, Router } from "@/nirax";
> import { defaultStore } from "@/store";
19c31
< 	router?: Router;
---
>   router?: Router;
22c34
< const router = props.router ?? inject('router');
---
> const router = props.router ?? inject("router");
25c37
< 	throw new Error('no router provided');
---
>   throw new Error("no router provided");
28,29c40,41
< const currentDepth = inject('routerCurrentDepth', 0);
< provide('routerCurrentDepth', currentDepth + 1);
---
> const currentDepth = inject("routerCurrentDepth", 0);
> provide("routerCurrentDepth", currentDepth + 1);
32,40c44,52
< 	if (d === currentDepth) {
< 		return current;
< 	} else {
< 		if (current.child) {
< 			return resolveNested(current.child, d + 1);
< 		} else {
< 			return null;
< 		}
< 	}
---
>   if (d === currentDepth) {
>     return current;
>   } else {
>     if (current.child) {
>       return resolveNested(current.child, d + 1);
>     } else {
>       return null;
>     }
>   }
46c58,60
< let key = $ref(current.route.path + JSON.stringify(Object.fromEntries(current.props)));
---
> let key = $ref(
>   current.route.path + JSON.stringify(Object.fromEntries(current.props))
> );
49,53c63,67
< 	const current = resolveNested(resolved);
< 	if (current == null) return;
< 	currentPageComponent = current.route.component;
< 	currentPageProps = current.props;
< 	key = current.route.path + JSON.stringify(Object.fromEntries(current.props));
---
>   const current = resolveNested(resolved);
>   if (current == null) return;
>   currentPageComponent = current.route.component;
>   currentPageProps = current.props;
>   key = current.route.path + JSON.stringify(Object.fromEntries(current.props));
56c70
< router.addListener('change', onChange);
---
> router.addListener("change", onChange);
59c73
< 	router.removeListener('change', onChange);
---
>   router.removeListener("change", onChange);
diff --color=auto -r misskeyV13/packages/frontend/src/components/global/i18n.ts RiricaV13/components/global/i18n.ts
1c1
< import { h, defineComponent } from 'vue';
---
> import { h, defineComponent } from "vue";
4,25c4,25
< 	props: {
< 		src: {
< 			type: String,
< 			required: true,
< 		},
< 		tag: {
< 			type: String,
< 			required: false,
< 			default: 'span',
< 		},
< 		textTag: {
< 			type: String,
< 			required: false,
< 			default: null,
< 		},
< 	},
< 	render() {
< 		let str = this.src;
< 		const parsed = [] as (string | { arg: string; })[];
< 		while (true) {
< 			const nextBracketOpen = str.indexOf('{');
< 			const nextBracketClose = str.indexOf('}');
---
>   props: {
>     src: {
>       type: String,
>       required: true,
>     },
>     tag: {
>       type: String,
>       required: false,
>       default: "span",
>     },
>     textTag: {
>       type: String,
>       required: false,
>       default: null,
>     },
>   },
>   render() {
>     let str = this.src;
>     const parsed = [] as (string | { arg: string })[];
>     while (true) {
>       const nextBracketOpen = str.indexOf("{");
>       const nextBracketClose = str.indexOf("}");
27,35c27,35
< 			if (nextBracketOpen === -1) {
< 				parsed.push(str);
< 				break;
< 			} else {
< 				if (nextBracketOpen > 0) parsed.push(str.substr(0, nextBracketOpen));
< 				parsed.push({
< 					arg: str.substring(nextBracketOpen + 1, nextBracketClose),
< 				});
< 			}
---
>       if (nextBracketOpen === -1) {
>         parsed.push(str);
>         break;
>       } else {
>         if (nextBracketOpen > 0) parsed.push(str.substr(0, nextBracketOpen));
>         parsed.push({
>           arg: str.substring(nextBracketOpen + 1, nextBracketClose),
>         });
>       }
37,38c37,38
< 			str = str.substr(nextBracketClose + 1);
< 		}
---
>       str = str.substr(nextBracketClose + 1);
>     }
40,41c40,50
< 		return h(this.tag, parsed.map(x => typeof x === 'string' ? (this.textTag ? h(this.textTag, x) : x) : this.$slots[x.arg]()));
< 	},
---
>     return h(
>       this.tag,
>       parsed.map((x) =>
>         typeof x === "string"
>           ? this.textTag
>             ? h(this.textTag, x)
>             : x
>           : this.$slots[x.arg]()
>       )
>     );
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/index.ts RiricaV13/components/index.ts
1c1
< import { App } from 'vue';
---
> import { App } from "vue";
3,19c3,19
< import Mfm from './global/MkMisskeyFlavoredMarkdown.vue';
< import MkA from './global/MkA.vue';
< import MkAcct from './global/MkAcct.vue';
< import MkAvatar from './global/MkAvatar.vue';
< import MkEmoji from './global/MkEmoji.vue';
< import MkUserName from './global/MkUserName.vue';
< import MkEllipsis from './global/MkEllipsis.vue';
< import MkTime from './global/MkTime.vue';
< import MkUrl from './global/MkUrl.vue';
< import I18n from './global/i18n';
< import RouterView from './global/RouterView.vue';
< import MkLoading from './global/MkLoading.vue';
< import MkError from './global/MkError.vue';
< import MkAd from './global/MkAd.vue';
< import MkPageHeader from './global/MkPageHeader.vue';
< import MkSpacer from './global/MkSpacer.vue';
< import MkStickyContainer from './global/MkStickyContainer.vue';
---
> import Mfm from "./global/MkMisskeyFlavoredMarkdown.vue";
> import MkA from "./global/MkA.vue";
> import MkAcct from "./global/MkAcct.vue";
> import MkAvatar from "./global/MkAvatar.vue";
> import MkEmoji from "./global/MkEmoji.vue";
> import MkUserName from "./global/MkUserName.vue";
> import MkEllipsis from "./global/MkEllipsis.vue";
> import MkTime from "./global/MkTime.vue";
> import MkUrl from "./global/MkUrl.vue";
> import I18n from "./global/i18n";
> import RouterView from "./global/RouterView.vue";
> import MkLoading from "./global/MkLoading.vue";
> import MkError from "./global/MkError.vue";
> import MkAd from "./global/MkAd.vue";
> import MkPageHeader from "./global/MkPageHeader.vue";
> import MkSpacer from "./global/MkSpacer.vue";
> import MkStickyContainer from "./global/MkStickyContainer.vue";
21,38c21,38
< export default function(app: App) {
< 	app.component('I18n', I18n);
< 	app.component('RouterView', RouterView);
< 	app.component('Mfm', Mfm);
< 	app.component('MkA', MkA);
< 	app.component('MkAcct', MkAcct);
< 	app.component('MkAvatar', MkAvatar);
< 	app.component('MkEmoji', MkEmoji);
< 	app.component('MkUserName', MkUserName);
< 	app.component('MkEllipsis', MkEllipsis);
< 	app.component('MkTime', MkTime);
< 	app.component('MkUrl', MkUrl);
< 	app.component('MkLoading', MkLoading);
< 	app.component('MkError', MkError);
< 	app.component('MkAd', MkAd);
< 	app.component('MkPageHeader', MkPageHeader);
< 	app.component('MkSpacer', MkSpacer);
< 	app.component('MkStickyContainer', MkStickyContainer);
---
> export default function (app: App) {
>   app.component("I18n", I18n);
>   app.component("RouterView", RouterView);
>   app.component("Mfm", Mfm);
>   app.component("MkA", MkA);
>   app.component("MkAcct", MkAcct);
>   app.component("MkAvatar", MkAvatar);
>   app.component("MkEmoji", MkEmoji);
>   app.component("MkUserName", MkUserName);
>   app.component("MkEllipsis", MkEllipsis);
>   app.component("MkTime", MkTime);
>   app.component("MkUrl", MkUrl);
>   app.component("MkLoading", MkLoading);
>   app.component("MkError", MkError);
>   app.component("MkAd", MkAd);
>   app.component("MkPageHeader", MkPageHeader);
>   app.component("MkSpacer", MkSpacer);
>   app.component("MkStickyContainer", MkStickyContainer);
41,60c41,60
< declare module '@vue/runtime-core' {
< 	export interface GlobalComponents {
< 		I18n: typeof I18n;
< 		RouterView: typeof RouterView;
< 		Mfm: typeof Mfm;
< 		MkA: typeof MkA;
< 		MkAcct: typeof MkAcct;
< 		MkAvatar: typeof MkAvatar;
< 		MkEmoji: typeof MkEmoji;
< 		MkUserName: typeof MkUserName;
< 		MkEllipsis: typeof MkEllipsis;
< 		MkTime: typeof MkTime;
< 		MkUrl: typeof MkUrl;
< 		MkLoading: typeof MkLoading;
< 		MkError: typeof MkError;
< 		MkAd: typeof MkAd;
< 		MkPageHeader: typeof MkPageHeader;
< 		MkSpacer: typeof MkSpacer;
< 		MkStickyContainer: typeof MkStickyContainer;
< 	}
---
> declare module "@vue/runtime-core" {
>   export interface GlobalComponents {
>     I18n: typeof I18n;
>     RouterView: typeof RouterView;
>     Mfm: typeof Mfm;
>     MkA: typeof MkA;
>     MkAcct: typeof MkAcct;
>     MkAvatar: typeof MkAvatar;
>     MkEmoji: typeof MkEmoji;
>     MkUserName: typeof MkUserName;
>     MkEllipsis: typeof MkEllipsis;
>     MkTime: typeof MkTime;
>     MkUrl: typeof MkUrl;
>     MkLoading: typeof MkLoading;
>     MkError: typeof MkError;
>     MkAd: typeof MkAd;
>     MkPageHeader: typeof MkPageHeader;
>     MkSpacer: typeof MkSpacer;
>     MkStickyContainer: typeof MkStickyContainer;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/mfm.ts RiricaV13/components/mfm.ts
1,13c1,14
< import { VNode, defineComponent, h } from 'vue';
< import * as mfm from 'mfm-js';
< import MkUrl from '@/components/global/MkUrl.vue';
< import MkLink from '@/components/MkLink.vue';
< import MkMention from '@/components/MkMention.vue';
< import MkEmoji from '@/components/global/MkEmoji.vue';
< import { concat } from '@/scripts/array';
< import MkCode from '@/components/MkCode.vue';
< import MkGoogle from '@/components/MkGoogle.vue';
< import MkSparkle from '@/components/MkSparkle.vue';
< import MkA from '@/components/global/MkA.vue';
< import { host } from '@/config';
< import { MFM_TAGS } from '@/scripts/mfm-tags';
---
> import { VNode, defineComponent, h } from "vue";
> import * as mfm from "mfm-js";
> import MkUrl from "@/components/global/MkUrl.vue";
> import MkLink from "@/components/MkLink.vue";
> import MkMention from "@/components/MkMention.vue";
> import MkEmoji from "@/components/global/MkEmoji.vue";
> import { concat } from "@/scripts/array";
> import MkFormula from "@/components/MkFormula.vue";
> import MkCode from "@/components/MkCode.vue";
> import MkGoogle from "@/components/MkGoogle.vue";
> import MkSparkle from "@/components/MkSparkle.vue";
> import MkA from "@/components/global/MkA.vue";
> import { host } from "@/config";
> import { MFM_TAGS } from "@/scripts/mfm-tags";
15,23d15
< const QUOTE_STYLE = `
< display: block;
< margin: 8px;
< padding: 6px 0 6px 12px;
< color: var(--fg);
< border-left: solid 3px var(--fg);
< opacity: 0.7;
< `.split('\n').join(' ');
< 
25,50c17,45
< 	props: {
< 		text: {
< 			type: String,
< 			required: true,
< 		},
< 		plain: {
< 			type: Boolean,
< 			default: false,
< 		},
< 		nowrap: {
< 			type: Boolean,
< 			default: false,
< 		},
< 		author: {
< 			type: Object,
< 			default: null,
< 		},
< 		i: {
< 			type: Object,
< 			default: null,
< 		},
< 		isNote: {
< 			type: Boolean,
< 			default: true,
< 		},
< 	},
---
>   props: {
>     text: {
>       type: String,
>       required: true,
>     },
>     plain: {
>       type: Boolean,
>       default: false,
>     },
>     nowrap: {
>       type: Boolean,
>       default: false,
>     },
>     author: {
>       type: Object,
>       default: null,
>     },
>     i: {
>       type: Object,
>       default: null,
>     },
>     customEmojis: {
>       required: false,
>     },
>     isNote: {
>       type: Boolean,
>       default: true,
>     },
>   },
52,53c47,48
< 	render() {
< 		if (this.text == null || this.text === '') return;
---
>   render() {
>     if (this.text == null || this.text === "") return;
55c50,52
< 		const ast = (this.plain ? mfm.parseSimple : mfm.parse)(this.text);
---
>     const ast = (this.plain ? mfm.parseSimple : mfm.parse)(this.text, {
>       fnNameList: MFM_TAGS,
>     });
57,60c54,57
< 		const validTime = (t: string | null | undefined) => {
< 			if (t == null) return null;
< 			return t.match(/^[0-9.]+s$/) ? t : null;
< 		};
---
>     const validTime = (t: string | null | undefined) => {
>       if (t == null) return null;
>       return t.match(/^[0-9.]+s$/) ? t : null;
>     };
62,65c59,64
< 		const genEl = (ast: mfm.MfmNode[]) => ast.map((token): VNode | string | (VNode | string)[] => {
< 			switch (token.type) {
< 				case 'text': {
< 					const text = token.props.text.replace(/(\r\n|\n|\r)/g, '\n');
---
>     const genEl = (ast: mfm.MfmNode[]) =>
>       concat(
>         ast.map((token): VNode[] => {
>           switch (token.type) {
>             case "text": {
>               const text = token.props.text.replace(/(\r\n|\n|\r)/g, "\n");
67,78c66,77
< 					if (!this.plain) {
< 						const res: (VNode | string)[] = [];
< 						for (const t of text.split('\n')) {
< 							res.push(h('br'));
< 							res.push(t);
< 						}
< 						res.shift();
< 						return res;
< 					} else {
< 						return [text.replace(/\n/g, ' ')];
< 					}
< 				}
---
>               if (!this.plain) {
>                 const res = [];
>                 for (const t of text.split("\n")) {
>                   res.push(h("br"));
>                   res.push(t);
>                 }
>                 res.shift();
>                 return res;
>               } else {
>                 return [text.replace(/\n/g, " ")];
>               }
>             }
80,82c79,81
< 				case 'bold': {
< 					return [h('b', genEl(token.children))];
< 				}
---
>             case "bold": {
>               return [h("b", genEl(token.children))];
>             }
84,86c83,85
< 				case 'strike': {
< 					return [h('del', genEl(token.children))];
< 				}
---
>             case "strike": {
>               return [h("del", genEl(token.children))];
>             }
88,92c87,95
< 				case 'italic': {
< 					return h('i', {
< 						style: 'font-style: oblique;',
< 					}, genEl(token.children));
< 				}
---
>             case "italic": {
>               return h(
>                 "i",
>                 {
>                   style: "font-style: oblique;",
>                 },
>                 genEl(token.children)
>               );
>             }
94,229c97,261
< 				case 'fn': {
< 					// TODO: CSSを文字列で組み立てていくと token.props.args.~~~ 経由でCSSインジェクションできるのでよしなにやる
< 					let style;
< 					switch (token.props.name) {
< 						case 'tada': {
< 							const speed = validTime(token.props.args.speed) ?? '1s';
< 							style = 'font-size: 150%;' + (this.$store.state.animatedMfm ? `animation: tada ${speed} linear infinite both;` : '');
< 							break;
< 						}
< 						case 'jelly': {
< 							const speed = validTime(token.props.args.speed) ?? '1s';
< 							style = (this.$store.state.animatedMfm ? `animation: mfm-rubberBand ${speed} linear infinite both;` : '');
< 							break;
< 						}
< 						case 'twitch': {
< 							const speed = validTime(token.props.args.speed) ?? '0.5s';
< 							style = this.$store.state.animatedMfm ? `animation: mfm-twitch ${speed} ease infinite;` : '';
< 							break;
< 						}
< 						case 'shake': {
< 							const speed = validTime(token.props.args.speed) ?? '0.5s';
< 							style = this.$store.state.animatedMfm ? `animation: mfm-shake ${speed} ease infinite;` : '';
< 							break;
< 						}
< 						case 'spin': {
< 							const direction =
< 								token.props.args.left ? 'reverse' :
< 								token.props.args.alternate ? 'alternate' :
< 								'normal';
< 							const anime =
< 								token.props.args.x ? 'mfm-spinX' :
< 								token.props.args.y ? 'mfm-spinY' :
< 								'mfm-spin';
< 							const speed = validTime(token.props.args.speed) ?? '1.5s';
< 							style = this.$store.state.animatedMfm ? `animation: ${anime} ${speed} linear infinite; animation-direction: ${direction};` : '';
< 							break;
< 						}
< 						case 'jump': {
< 							const speed = validTime(token.props.args.speed) ?? '0.75s';
< 							style = this.$store.state.animatedMfm ? `animation: mfm-jump ${speed} linear infinite;` : '';
< 							break;
< 						}
< 						case 'bounce': {
< 							const speed = validTime(token.props.args.speed) ?? '0.75s';
< 							style = this.$store.state.animatedMfm ? `animation: mfm-bounce ${speed} linear infinite; transform-origin: center bottom;` : '';
< 							break;
< 						}
< 						case 'flip': {
< 							const transform =
< 								(token.props.args.h && token.props.args.v) ? 'scale(-1, -1)' :
< 								token.props.args.v ? 'scaleY(-1)' :
< 								'scaleX(-1)';
< 							style = `transform: ${transform};`;
< 							break;
< 						}
< 						case 'x2': {
< 							return h('span', {
< 								class: 'mfm-x2',
< 							}, genEl(token.children));
< 						}
< 						case 'x3': {
< 							return h('span', {
< 								class: 'mfm-x3',
< 							}, genEl(token.children));
< 						}
< 						case 'x4': {
< 							return h('span', {
< 								class: 'mfm-x4',
< 							}, genEl(token.children));
< 						}
< 						case 'font': {
< 							const family =
< 								token.props.args.serif ? 'serif' :
< 								token.props.args.monospace ? 'monospace' :
< 								token.props.args.cursive ? 'cursive' :
< 								token.props.args.fantasy ? 'fantasy' :
< 								token.props.args.emoji ? 'emoji' :
< 								token.props.args.math ? 'math' :
< 								null;
< 							if (family) style = `font-family: ${family};`;
< 							break;
< 						}
< 						case 'blur': {
< 							return h('span', {
< 								class: '_mfm_blur_',
< 							}, genEl(token.children));
< 						}
< 						case 'rainbow': {
< 							const speed = validTime(token.props.args.speed) ?? '1s';
< 							style = this.$store.state.animatedMfm ? `animation: mfm-rainbow ${speed} linear infinite;` : '';
< 							break;
< 						}
< 						case 'sparkle': {
< 							if (!this.$store.state.animatedMfm) {
< 								return genEl(token.children);
< 							}
< 							return h(MkSparkle, {}, genEl(token.children));
< 						}
< 						case 'rotate': {
< 							const degrees = parseFloat(token.props.args.deg) ?? '90';
< 							style = `transform: rotate(${degrees}deg); transform-origin: center center;`;
< 							break;
< 						}
< 						case 'position': {
< 							const x = parseFloat(token.props.args.x ?? '0');
< 							const y = parseFloat(token.props.args.y ?? '0');
< 							style = `transform: translateX(${x}em) translateY(${y}em);`;
< 							break;
< 						}
< 						case 'scale': {
< 							const x = Math.min(parseFloat(token.props.args.x ?? '1'), 5);
< 							const y = Math.min(parseFloat(token.props.args.y ?? '1'), 5);
< 							style = `transform: scale(${x}, ${y});`;
< 							break;
< 						}
< 						case 'fg': {
< 							let color = token.props.args.color;
< 							if (!/^[0-9a-f]{3,6}$/i.test(color)) color = 'f00';
< 							style = `color: #${color};`;
< 							break;
< 						}
< 						case 'bg': {
< 							let color = token.props.args.color;
< 							if (!/^[0-9a-f]{3,6}$/i.test(color)) color = 'f00';
< 							style = `background-color: #${color};`;
< 							break;
< 						}
< 					}
< 					if (style == null) {
< 						return h('span', {}, ['$[', token.props.name, ' ', ...genEl(token.children), ']']);
< 					} else {
< 						return h('span', {
< 							style: 'display: inline-block; ' + style,
< 						}, genEl(token.children));
< 					}
< 				}
---
>             case "fn": {
>               // TODO: CSSを文字列で組み立てていくと token.props.args.~~~ 経由でCSSインジェクションできるのでよしなにやる
>               let style;
>               switch (token.props.name) {
>                 case "tada": {
>                   const speed = validTime(token.props.args.speed) || "1s";
>                   style =
>                     "font-size: 150%;" +
>                     (this.$store.state.animatedMfm
>                       ? `animation: tada ${speed} linear infinite both;`
>                       : "");
>                   break;
>                 }
>                 case "jelly": {
>                   const speed = validTime(token.props.args.speed) || "1s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-rubberBand ${speed} linear infinite both;`
>                     : "";
>                   break;
>                 }
>                 case "twitch": {
>                   const speed = validTime(token.props.args.speed) || "0.5s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-twitch ${speed} ease infinite;`
>                     : "";
>                   break;
>                 }
>                 case "shake": {
>                   const speed = validTime(token.props.args.speed) || "0.5s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-shake ${speed} ease infinite;`
>                     : "";
>                   break;
>                 }
>                 case "spin": {
>                   const direction = token.props.args.left
>                     ? "reverse"
>                     : token.props.args.alternate
>                     ? "alternate"
>                     : "normal";
>                   const anime = token.props.args.x
>                     ? "mfm-spinX"
>                     : token.props.args.y
>                     ? "mfm-spinY"
>                     : "mfm-spin";
>                   const speed = validTime(token.props.args.speed) || "1.5s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: ${anime} ${speed} linear infinite; animation-direction: ${direction};`
>                     : "";
>                   break;
>                 }
>                 case "jump": {
>                   const speed = validTime(token.props.args.speed) || "0.75s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-jump ${speed} linear infinite;`
>                     : "";
>                   break;
>                 }
>                 case "bounce": {
>                   const speed = validTime(token.props.args.speed) || "0.75s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-bounce ${speed} linear infinite; transform-origin: center bottom;`
>                     : "";
>                   break;
>                 }
>                 case "flip": {
>                   const transform =
>                     token.props.args.h && token.props.args.v
>                       ? "scale(-1, -1)"
>                       : token.props.args.v
>                       ? "scaleY(-1)"
>                       : "scaleX(-1)";
>                   style = `transform: ${transform};`;
>                   break;
>                 }
>                 case "x2": {
>                   return h(
>                     "span",
>                     {
>                       class: "mfm-x2",
>                     },
>                     genEl(token.children)
>                   );
>                 }
>                 case "x3": {
>                   return h(
>                     "span",
>                     {
>                       class: "mfm-x3",
>                     },
>                     genEl(token.children)
>                   );
>                 }
>                 case "x4": {
>                   return h(
>                     "span",
>                     {
>                       class: "mfm-x4",
>                     },
>                     genEl(token.children)
>                   );
>                 }
>                 case "font": {
>                   const family = token.props.args.serif
>                     ? "serif"
>                     : token.props.args.monospace
>                     ? "monospace"
>                     : token.props.args.cursive
>                     ? "cursive"
>                     : token.props.args.fantasy
>                     ? "fantasy"
>                     : token.props.args.emoji
>                     ? "emoji"
>                     : token.props.args.math
>                     ? "math"
>                     : null;
>                   if (family) style = `font-family: ${family};`;
>                   break;
>                 }
>                 case "blur": {
>                   return h(
>                     "span",
>                     {
>                       class: "_mfm_blur_",
>                     },
>                     genEl(token.children)
>                   );
>                 }
>                 case "rainbow": {
>                   const speed = validTime(token.props.args.speed) || "1s";
>                   style = this.$store.state.animatedMfm
>                     ? `animation: mfm-rainbow ${speed} linear infinite;`
>                     : "";
>                   break;
>                 }
>                 case "sparkle": {
>                   if (!this.$store.state.animatedMfm) {
>                     return genEl(token.children);
>                   }
>                   return h(MkSparkle, {}, genEl(token.children));
>                 }
>                 case "rotate": {
>                   const degrees = parseInt(token.props.args.deg) || "90";
>                   style = `transform: rotate(${degrees}deg); transform-origin: center center;`;
>                   break;
>                 }
>               }
>               if (style == null) {
>                 return h("span", {}, [
>                   "$[",
>                   token.props.name,
>                   " ",
>                   ...genEl(token.children),
>                   "]",
>                 ]);
>               } else {
>                 return h(
>                   "span",
>                   {
>                     style: "display: inline-block;" + style,
>                   },
>                   genEl(token.children)
>                 );
>               }
>             }
231,235c263,273
< 				case 'small': {
< 					return [h('small', {
< 						style: 'opacity: 0.7;',
< 					}, genEl(token.children))];
< 				}
---
>             case "small": {
>               return [
>                 h(
>                   "small",
>                   {
>                     style: "opacity: 0.7;",
>                   },
>                   genEl(token.children)
>                 ),
>               ];
>             }
237,241c275,285
< 				case 'center': {
< 					return [h('div', {
< 						style: 'text-align:center;',
< 					}, genEl(token.children))];
< 				}
---
>             case "center": {
>               return [
>                 h(
>                   "div",
>                   {
>                     style: "text-align:center;",
>                   },
>                   genEl(token.children)
>                 ),
>               ];
>             }
243,249c287,295
< 				case 'url': {
< 					return [h(MkUrl, {
< 						key: Math.random(),
< 						url: token.props.url,
< 						rel: 'nofollow noopener',
< 					})];
< 				}
---
>             case "url": {
>               return [
>                 h(MkUrl, {
>                   key: Math.random(),
>                   url: token.props.url,
>                   rel: "nofollow noopener",
>                 }),
>               ];
>             }
251,257c297,309
< 				case 'link': {
< 					return [h(MkLink, {
< 						key: Math.random(),
< 						url: token.props.url,
< 						rel: 'nofollow noopener',
< 					}, genEl(token.children))];
< 				}
---
>             case "link": {
>               return [
>                 h(
>                   MkLink,
>                   {
>                     key: Math.random(),
>                     url: token.props.url,
>                     rel: "nofollow noopener",
>                   },
>                   genEl(token.children)
>                 ),
>               ];
>             }
259,265c311,324
< 				case 'mention': {
< 					return [h(MkMention, {
< 						key: Math.random(),
< 						host: (token.props.host == null && this.author && this.author.host != null ? this.author.host : token.props.host) || host,
< 						username: token.props.username,
< 					})];
< 				}
---
>             case "mention": {
>               return [
>                 h(MkMention, {
>                   key: Math.random(),
>                   host:
>                     (token.props.host == null &&
>                     this.author &&
>                     this.author.host != null
>                       ? this.author.host
>                       : token.props.host) || host,
>                   username: token.props.username,
>                 }),
>               ];
>             }
267,273c326,342
< 				case 'hashtag': {
< 					return [h(MkA, {
< 						key: Math.random(),
< 						to: this.isNote ? `/tags/${encodeURIComponent(token.props.hashtag)}` : `/explore/tags/${encodeURIComponent(token.props.hashtag)}`,
< 						style: 'color:var(--hashtag);',
< 					}, `#${token.props.hashtag}`)];
< 				}
---
>             case "hashtag": {
>               return [
>                 h(
>                   MkA,
>                   {
>                     key: Math.random(),
>                     to: this.isNote
>                       ? `/tags/${encodeURIComponent(token.props.hashtag)}`
>                       : `/explore/tags/${encodeURIComponent(
>                           token.props.hashtag
>                         )}`,
>                     style: "color:var(--hashtag);",
>                   },
>                   `#${token.props.hashtag}`
>                 ),
>               ];
>             }
275,281c344,352
< 				case 'blockCode': {
< 					return [h(MkCode, {
< 						key: Math.random(),
< 						code: token.props.code,
< 						lang: token.props.lang,
< 					})];
< 				}
---
>             case "blockCode": {
>               return [
>                 h(MkCode, {
>                   key: Math.random(),
>                   code: token.props.code,
>                   lang: token.props.lang,
>                 }),
>               ];
>             }
283,289c354,362
< 				case 'inlineCode': {
< 					return [h(MkCode, {
< 						key: Math.random(),
< 						code: token.props.code,
< 						inline: true,
< 					})];
< 				}
---
>             case "inlineCode": {
>               return [
>                 h(MkCode, {
>                   key: Math.random(),
>                   code: token.props.code,
>                   inline: true,
>                 }),
>               ];
>             }
291,301c364,386
< 				case 'quote': {
< 					if (!this.nowrap) {
< 						return [h('div', {
< 							style: QUOTE_STYLE,
< 						}, genEl(token.children))];
< 					} else {
< 						return [h('span', {
< 							style: QUOTE_STYLE,
< 						}, genEl(token.children))];
< 					}
< 				}
---
>             case "quote": {
>               if (!this.nowrap) {
>                 return [
>                   h(
>                     "div",
>                     {
>                       class: "quote",
>                     },
>                     genEl(token.children)
>                   ),
>                 ];
>               } else {
>                 return [
>                   h(
>                     "span",
>                     {
>                       class: "quote",
>                     },
>                     genEl(token.children)
>                   ),
>                 ];
>               }
>             }
303,311c388,397
< 				case 'emojiCode': {
< 					return [h(MkEmoji, {
< 						key: Math.random(),
< 						emoji: `:${token.props.name}:`,
< 						normal: this.plain,
< 						// eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
< 						host: this.author?.host,
< 					})];
< 				}
---
>             case "emojiCode": {
>               return [
>                 h(MkEmoji, {
>                   key: Math.random(),
>                   emoji: `:${token.props.name}:`,
>                   customEmojis: this.customEmojis,
>                   normal: this.plain,
>                 }),
>               ];
>             }
313,319c399,408
< 				case 'unicodeEmoji': {
< 					return [h(MkEmoji, {
< 						key: Math.random(),
< 						emoji: token.props.emoji,
< 						normal: this.plain,
< 					})];
< 				}
---
>             case "unicodeEmoji": {
>               return [
>                 h(MkEmoji, {
>                   key: Math.random(),
>                   emoji: token.props.emoji,
>                   customEmojis: this.customEmojis,
>                   normal: this.plain,
>                 }),
>               ];
>             }
321,323c410,418
< 				case 'mathInline': {
< 					return [h('code', token.props.formula)];
< 				}
---
>             case "mathInline": {
>               return [
>                 h(MkFormula, {
>                   key: Math.random(),
>                   formula: token.props.formula,
>                   block: false,
>                 }),
>               ];
>             }
325,327c420,428
< 				case 'mathBlock': {
< 					return [h('code', token.props.formula)];
< 				}
---
>             case "mathBlock": {
>               return [
>                 h(MkFormula, {
>                   key: Math.random(),
>                   formula: token.props.formula,
>                   block: true,
>                 }),
>               ];
>             }
329,334c430,437
< 				case 'search': {
< 					return [h(MkGoogle, {
< 						key: Math.random(),
< 						q: token.props.query,
< 					})];
< 				}
---
>             case "search": {
>               return [
>                 h(MkGoogle, {
>                   key: Math.random(),
>                   q: token.props.query,
>                 }),
>               ];
>             }
336,338c439,441
< 				case 'plain': {
< 					return [h('span', genEl(token.children))];
< 				}
---
>             case "plain": {
>               return [h("span", genEl(token.children))];
>             }
340,342c443,444
< 				default: {
< 					// eslint-disable-next-line @typescript-eslint/no-explicit-any
< 					console.error('unrecognized ast type:', (token as any).type);
---
>             default: {
>               console.error("unrecognized ast type:", token.type);
344,347c446,450
< 					return [];
< 				}
< 			}
< 		}).flat(Infinity) as (VNode | string)[];
---
>               return [];
>             }
>           }
>         })
>       );
349,351c452,454
< 		// Parse ast to DOM
< 		return h('span', genEl(ast));
< 	},
---
>     // Parse ast to DOM
>     return h("span", genEl(ast));
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.block.vue RiricaV13/components/page/page.block.vue
2c2,8
< <component :is="'x-' + block.type" :key="block.id" :block="block" :hpml="hpml" :h="h"/>
---
>   <component
>     :is="'x-' + block.type"
>     :key="block.id"
>     :block="block"
>     :hpml="hpml"
>     :h="h"
>   />
6,23c12,29
< import { defineComponent, PropType } from 'vue';
< import XText from './page.text.vue';
< import XSection from './page.section.vue';
< import XImage from './page.image.vue';
< import XButton from './page.button.vue';
< import XNumberInput from './page.number-input.vue';
< import XTextInput from './page.text-input.vue';
< import XTextareaInput from './page.textarea-input.vue';
< import XSwitch from './page.switch.vue';
< import XIf from './page.if.vue';
< import XTextarea from './page.textarea.vue';
< import XPost from './page.post.vue';
< import XCounter from './page.counter.vue';
< import XRadioButton from './page.radio-button.vue';
< import XCanvas from './page.canvas.vue';
< import XNote from './page.note.vue';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { Block } from '@/scripts/hpml/block';
---
> import { defineComponent, PropType } from "vue";
> import XText from "./page.text.vue";
> import XSection from "./page.section.vue";
> import XImage from "./page.image.vue";
> import XButton from "./page.button.vue";
> import XNumberInput from "./page.number-input.vue";
> import XTextInput from "./page.text-input.vue";
> import XTextareaInput from "./page.textarea-input.vue";
> import XSwitch from "./page.switch.vue";
> import XIf from "./page.if.vue";
> import XTextarea from "./page.textarea.vue";
> import XPost from "./page.post.vue";
> import XCounter from "./page.counter.vue";
> import XRadioButton from "./page.radio-button.vue";
> import XCanvas from "./page.canvas.vue";
> import XNote from "./page.note.vue";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { Block } from "@/scripts/hpml/block";
26,42c32,62
< 	components: {
< 		XText, XSection, XImage, XButton, XNumberInput, XTextInput, XTextareaInput, XTextarea, XPost, XSwitch, XIf, XCounter, XRadioButton, XCanvas, XNote,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<Block>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 		h: {
< 			type: Number,
< 			required: true,
< 		},
< 	},
---
>   components: {
>     XText,
>     XSection,
>     XImage,
>     XButton,
>     XNumberInput,
>     XTextInput,
>     XTextareaInput,
>     XTextarea,
>     XPost,
>     XSwitch,
>     XIf,
>     XCounter,
>     XRadioButton,
>     XCanvas,
>     XNote,
>   },
>   props: {
>     block: {
>       type: Object as PropType<Block>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>     h: {
>       type: Number,
>       required: true,
>     },
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.button.vue RiricaV13/components/page/page.button.vue
2,4c2,6
< <div>
< 	<MkButton class="kudkigyw" :primary="block.primary" @click="click()">{{ hpml.interpolate(block.text) }}</MkButton>
< </div>
---
>   <div>
>     <MkButton class="kudkigyw" :primary="block.primary" @click="click()">{{
>       hpml.interpolate(block.text)
>     }}</MkButton>
>   </div>
8,12c10,14
< import { defineComponent, PropType, unref } from 'vue';
< import MkButton from '../MkButton.vue';
< import * as os from '@/os';
< import { ButtonBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { defineComponent, PropType, unref } from "vue";
> import MkButton from "../MkButton.vue";
> import * as os from "@/os";
> import { ButtonBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
15,45c17,49
< 	components: {
< 		MkButton,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<ButtonBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	methods: {
< 		click() {
< 			if (this.block.action === 'dialog') {
< 				this.hpml.eval();
< 				os.alert({
< 					text: this.hpml.interpolate(this.block.content),
< 				});
< 			} else if (this.block.action === 'resetRandom') {
< 				this.hpml.updateRandomSeed(Math.random());
< 				this.hpml.eval();
< 			} else if (this.block.action === 'pushEvent') {
< 				os.api('page-push', {
< 					pageId: this.hpml.page.id,
< 					event: this.block.event,
< 					...(this.block.var ? {
< 						var: unref(this.hpml.vars)[this.block.var],
< 					} : {}),
< 				});
---
>   components: {
>     MkButton,
>   },
>   props: {
>     block: {
>       type: Object as PropType<ButtonBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   methods: {
>     click() {
>       if (this.block.action === "dialog") {
>         this.hpml.eval();
>         os.alert({
>           text: this.hpml.interpolate(this.block.content),
>         });
>       } else if (this.block.action === "resetRandom") {
>         this.hpml.updateRandomSeed(Math.random());
>         this.hpml.eval();
>       } else if (this.block.action === "pushEvent") {
>         os.api("page-push", {
>           pageId: this.hpml.page.id,
>           event: this.block.event,
>           ...(this.block.var
>             ? {
>                 var: unref(this.hpml.vars)[this.block.var],
>               }
>             : {}),
>         });
47,55c51,59
< 				os.alert({
< 					type: 'success',
< 					text: this.hpml.interpolate(this.block.message),
< 				});
< 			} else if (this.block.action === 'callAiScript') {
< 				this.hpml.callAiScript(this.block.fn);
< 			}
< 		},
< 	},
---
>         os.alert({
>           type: "success",
>           text: this.hpml.interpolate(this.block.message),
>         });
>       } else if (this.block.action === "callAiScript") {
>         this.hpml.callAiScript(this.block.fn);
>       }
>     },
>   },
61,64c65,68
< 	display: inline-block;
< 	min-width: 200px;
< 	max-width: 450px;
< 	margin: 8px 0;
---
>   display: inline-block;
>   min-width: 200px;
>   max-width: 450px;
>   margin: 8px 0;
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.canvas.vue RiricaV13/components/page/page.canvas.vue
2,4c2,4
< <div class="ysrxegms">
< 	<canvas ref="canvas" :width="block.width" :height="block.height"/>
< </div>
---
>   <div class="ysrxegms">
>     <canvas ref="canvas" :width="block.width" :height="block.height" />
>   </div>
8,11c8,11
< import { defineComponent, onMounted, PropType, Ref, ref } from 'vue';
< import * as os from '@/os';
< import { CanvasBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { defineComponent, onMounted, PropType, Ref, ref } from "vue";
> import * as os from "@/os";
> import { CanvasBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
14,25c14,25
< 	props: {
< 		block: {
< 			type: Object as PropType<CanvasBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const canvas: Ref<any> = ref(null);
---
>   props: {
>     block: {
>       type: Object as PropType<CanvasBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const canvas: Ref<any> = ref(null);
27,29c27,29
< 		onMounted(() => {
< 			props.hpml.registerCanvas(props.block.name, canvas.value);
< 		});
---
>     onMounted(() => {
>       props.hpml.registerCanvas(props.block.name, canvas.value);
>     });
31,34c31,34
< 		return {
< 			canvas,
< 		};
< 	},
---
>     return {
>       canvas,
>     };
>   },
40,43c40,43
< 	display: inline-block;
< 	vertical-align: bottom;
< 	overflow: auto;
< 	max-width: 100%;
---
>   display: inline-block;
>   vertical-align: bottom;
>   overflow: auto;
>   max-width: 100%;
45,47c45,47
< 	> canvas {
< 		display: block;
< 	}
---
>   > canvas {
>     display: block;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.counter.vue RiricaV13/components/page/page.counter.vue
2,4c2,6
< <div>
< 	<MkButton class="llumlmnx" @click="click()">{{ hpml.interpolate(block.text) }}</MkButton>
< </div>
---
>   <div>
>     <MkButton class="llumlmnx" @click="click()">{{
>       hpml.interpolate(block.text)
>     }}</MkButton>
>   </div>
8,12c10,14
< import { computed, defineComponent, PropType } from 'vue';
< import MkButton from '../MkButton.vue';
< import * as os from '@/os';
< import { CounterVarBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkButton from "../MkButton.vue";
> import * as os from "@/os";
> import { CounterVarBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
15,31c17,33
< 	components: {
< 		MkButton,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<CounterVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkButton,
>   },
>   props: {
>     block: {
>       type: Object as PropType<CounterVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
33,36c35,41
< 		function click() {
< 			props.hpml.updatePageVar(props.block.name, value.value + (props.block.inc || 1));
< 			props.hpml.eval();
< 		}
---
>     function click() {
>       props.hpml.updatePageVar(
>         props.block.name,
>         value.value + (props.block.inc || 1)
>       );
>       props.hpml.eval();
>     }
38,41c43,46
< 		return {
< 			click,
< 		};
< 	},
---
>     return {
>       click,
>     };
>   },
47,50c52,55
< 	display: inline-block;
< 	min-width: 300px;
< 	max-width: 450px;
< 	margin: 8px 0;
---
>   display: inline-block;
>   min-width: 300px;
>   max-width: 450px;
>   margin: 8px 0;
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.if.vue RiricaV13/components/page/page.if.vue
2,4c2,10
< <div v-show="hpml.vars.value[block.var]">
< 	<XBlock v-for="child in block.children" :key="child.id" :block="child" :hpml="hpml" :h="h"/>
< </div>
---
>   <div v-show="hpml.vars.value[block.var]">
>     <XBlock
>       v-for="child in block.children"
>       :key="child.id"
>       :block="child"
>       :hpml="hpml"
>       :h="h"
>     />
>   </div>
8,10c14,16
< import { IfBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { defineComponent, defineAsyncComponent, PropType } from 'vue';
---
> import { IfBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { defineComponent, defineAsyncComponent, PropType } from "vue";
13,29c19,35
< 	components: {
< 		XBlock: defineAsyncComponent(() => import('./page.block.vue')),
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<IfBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 		h: {
< 			type: Number,
< 			required: true,
< 		},
< 	},
---
>   components: {
>     XBlock: defineAsyncComponent(() => import("./page.block.vue")),
>   },
>   props: {
>     block: {
>       type: Object as PropType<IfBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>     h: {
>       type: Number,
>       required: true,
>     },
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.image.vue RiricaV13/components/page/page.image.vue
2,4c2,11
< <div class="lzyxtsnt">
< 	<ImgWithBlurhash v-if="image" :hash="image.blurhash" :src="image.url" :alt="image.comment" :title="image.comment" :cover="false"/>
< </div>
---
>   <div class="lzyxtsnt">
>     <ImgWithBlurhash
>       v-if="image"
>       :hash="image.blurhash"
>       :src="image.url"
>       :alt="image.comment"
>       :title="image.comment"
>       :cover="false"
>     />
>   </div>
8,12c15,19
< import { defineComponent, PropType } from 'vue';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
< import * as os from '@/os';
< import { ImageBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { defineComponent, PropType } from "vue";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
> import * as os from "@/os";
> import { ImageBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
15,16c22,23
< 	block: PropType<ImageBlock>,
< 	hpml: PropType<Hpml>,
---
>   block: PropType<ImageBlock>;
>   hpml: PropType<Hpml>;
19c26,28
< const image = props.hpml.page.attachedFiles.find(x => x.id === props.block.fileId);
---
> const image = props.hpml.page.attachedFiles.find(
>   (x) => x.id === props.block.fileId
> );
24,26c33,35
< 	> img {
< 		max-width: 100%;
< 	}
---
>   > img {
>     max-width: 100%;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.note.vue RiricaV13/components/page/page.note.vue
2,5c2,13
< <div class="voxdxuby">
< 	<XNote v-if="note && !block.detailed" :key="note.id + ':normal'" v-model:note="note"/>
< 	<XNoteDetailed v-if="note && block.detailed" :key="note.id + ':detail'" v-model:note="note"/>
< </div>
---
>   <div class="voxdxuby">
>     <XNote
>       v-if="note && !block.detailed"
>       :key="note.id + ':normal'"
>       v-model:note="note"
>     />
>     <XNoteDetailed
>       v-if="note && block.detailed"
>       :key="note.id + ':detail'"
>       v-model:note="note"
>     />
>   </div>
9,13c17,21
< import { defineComponent, onMounted, PropType, Ref, ref } from 'vue';
< import XNote from '@/components/MkNote.vue';
< import XNoteDetailed from '@/components/MkNoteDetailed.vue';
< import * as os from '@/os';
< import { NoteBlock } from '@/scripts/hpml/block';
---
> import { defineComponent, onMounted, PropType, Ref, ref } from "vue";
> import XNote from "@/components/MkNote.vue";
> import XNoteDetailed from "@/components/MkNoteDetailed.vue";
> import * as os from "@/os";
> import { NoteBlock } from "@/scripts/hpml/block";
16,27c24,35
< 	components: {
< 		XNote,
< 		XNoteDetailed,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<NoteBlock>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const note: Ref<Record<string, any> | null> = ref(null);
---
>   components: {
>     XNote,
>     XNoteDetailed,
>   },
>   props: {
>     block: {
>       type: Object as PropType<NoteBlock>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const note: Ref<Record<string, any> | null> = ref(null);
29,34c37,41
< 		onMounted(() => {
< 			os.api('notes/show', { noteId: props.block.note })
< 			.then(result => {
< 				note.value = result;
< 			});
< 		});
---
>     onMounted(() => {
>       os.api("notes/show", { noteId: props.block.note }).then((result) => {
>         note.value = result;
>       });
>     });
36,39c43,46
< 		return {
< 			note,
< 		};
< 	},
---
>     return {
>       note,
>     };
>   },
45c52
< 	margin: 1em 0;
---
>   margin: 1em 0;
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.number-input.vue RiricaV13/components/page/page.number-input.vue
2,6c2,11
< <div>
< 	<MkInput class="kudkigyw" :model-value="value" type="number" @update:model-value="updateValue($event)">
< 		<template #label>{{ hpml.interpolate(block.text) }}</template>
< 	</MkInput>
< </div>
---
>   <div>
>     <MkInput
>       class="kudkigyw"
>       :model-value="value"
>       type="number"
>       @update:modelValue="updateValue($event)"
>     >
>       <template #label>{{ hpml.interpolate(block.text) }}</template>
>     </MkInput>
>   </div>
10,14c15,19
< import { computed, defineComponent, PropType } from 'vue';
< import MkInput from '../MkInput.vue';
< import * as os from '@/os';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { NumberInputVarBlock } from '@/scripts/hpml/block';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkInput from "../form/input.vue";
> import * as os from "@/os";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { NumberInputVarBlock } from "@/scripts/hpml/block";
17,33c22,38
< 	components: {
< 		MkInput,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<NumberInputVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkInput,
>   },
>   props: {
>     block: {
>       type: Object as PropType<NumberInputVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
35,38c40,43
< 		function updateValue(newValue) {
< 			props.hpml.updatePageVar(props.block.name, newValue);
< 			props.hpml.eval();
< 		}
---
>     function updateValue(newValue) {
>       props.hpml.updatePageVar(props.block.name, newValue);
>       props.hpml.eval();
>     }
40,44c45,49
< 		return {
< 			value,
< 			updateValue,
< 		};
< 	},
---
>     return {
>       value,
>       updateValue,
>     };
>   },
50,53c55,58
< 	display: inline-block;
< 	min-width: 300px;
< 	max-width: 450px;
< 	margin: 8px 0;
---
>   display: inline-block;
>   min-width: 300px;
>   max-width: 450px;
>   margin: 8px 0;
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.post.vue RiricaV13/components/page/page.post.vue
2,8c2,13
< <div class="ngbfujlo">
< 	<MkTextarea :model-value="text" readonly style="margin: 0;"></MkTextarea>
< 	<MkButton class="button" primary :disabled="posting || posted" @click="post()">
< 		<i v-if="posted" class="ti ti-check"></i>
< 		<i v-else class="ti ti-send"></i>
< 	</MkButton>
< </div>
---
>   <div class="ngbfujlo">
>     <MkTextarea :model-value="text" readonly style="margin: 0"></MkTextarea>
>     <MkButton
>       class="button"
>       primary
>       :disabled="posting || posted"
>       @click="post()"
>     >
>       <i v-if="posted" class="fas fa-check"></i>
>       <i v-else class="fas fa-paper-plane"></i>
>     </MkButton>
>   </div>
12,18c17,23
< import { defineComponent, PropType } from 'vue';
< import MkTextarea from '../MkTextarea.vue';
< import MkButton from '../MkButton.vue';
< import { apiUrl } from '@/config';
< import * as os from '@/os';
< import { PostBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { defineComponent, PropType } from "vue";
> import MkTextarea from "../form/textarea.vue";
> import MkButton from "../MkButton.vue";
> import { apiUrl } from "@/config";
> import * as os from "@/os";
> import { PostBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
21,60c26,65
< 	components: {
< 		MkTextarea,
< 		MkButton,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<PostBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	data() {
< 		return {
< 			text: this.hpml.interpolate(this.block.text),
< 			posted: false,
< 			posting: false,
< 		};
< 	},
< 	watch: {
< 		'hpml.vars': {
< 			handler() {
< 				this.text = this.hpml.interpolate(this.block.text);
< 			},
< 			deep: true,
< 		},
< 	},
< 	methods: {
< 		upload() {
< 			const promise = new Promise((ok) => {
< 				const canvas = this.hpml.canvases[this.block.canvasId];
< 				canvas.toBlob(blob => {
< 					const formData = new FormData();
< 					formData.append('file', blob);
< 					formData.append('i', this.$i.token);
< 					if (this.$store.state.uploadFolder) {
< 						formData.append('folderId', this.$store.state.uploadFolder);
< 					}
---
>   components: {
>     MkTextarea,
>     MkButton,
>   },
>   props: {
>     block: {
>       type: Object as PropType<PostBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   data() {
>     return {
>       text: this.hpml.interpolate(this.block.text),
>       posted: false,
>       posting: false,
>     };
>   },
>   watch: {
>     "hpml.vars": {
>       handler() {
>         this.text = this.hpml.interpolate(this.block.text);
>       },
>       deep: true,
>     },
>   },
>   methods: {
>     upload() {
>       const promise = new Promise((ok) => {
>         const canvas = this.hpml.canvases[this.block.canvasId];
>         canvas.toBlob((blob) => {
>           const formData = new FormData();
>           formData.append("file", blob);
>           formData.append("i", this.$i.token);
>           if (this.$store.state.uploadFolder) {
>             formData.append("folderId", this.$store.state.uploadFolder);
>           }
62,85c67,91
< 					window.fetch(apiUrl + '/drive/files/create', {
< 						method: 'POST',
< 						body: formData,
< 					})
< 						.then(response => response.json())
< 						.then(f => {
< 							ok(f);
< 						});
< 				});
< 			});
< 			os.promiseDialog(promise);
< 			return promise;
< 		},
< 		async post() {
< 			this.posting = true;
< 			const file = this.block.attachCanvasImage ? await this.upload() : null;
< 			os.apiWithDialog('notes/create', {
< 				text: this.text === '' ? null : this.text,
< 				fileIds: file ? [file.id] : undefined,
< 			}).then(() => {
< 				this.posted = true;
< 			});
< 		},
< 	},
---
>           window
>             .fetch(apiUrl + "/drive/files/create", {
>               method: "POST",
>               body: formData,
>             })
>             .then((response) => response.json())
>             .then((f) => {
>               ok(f);
>             });
>         });
>       });
>       os.promiseDialog(promise);
>       return promise;
>     },
>     async post() {
>       this.posting = true;
>       const file = this.block.attachCanvasImage ? await this.upload() : null;
>       os.apiWithDialog("notes/create", {
>         text: this.text === "" ? null : this.text,
>         fileIds: file ? [file.id] : undefined,
>       }).then(() => {
>         this.posted = true;
>       });
>     },
>   },
91,95c97,101
< 	position: relative;
< 	padding: 32px;
< 	border-radius: 6px;
< 	box-shadow: 0 2px 8px var(--shadow);
< 	z-index: 1;
---
>   position: relative;
>   padding: 32px;
>   border-radius: 6px;
>   box-shadow: 0 2px 8px var(--shadow);
>   z-index: 1;
97,99c103,105
< 	> .button {
< 		margin-top: 32px;
< 	}
---
>   > .button {
>     margin-top: 32px;
>   }
101,102c107,108
< 	@media (max-width: 600px) {
< 		padding: 16px;
---
>   @media (max-width: 600px) {
>     padding: 16px;
104,107c110,113
< 		> .button {
< 			margin-top: 16px;
< 		}
< 	}
---
>     > .button {
>       margin-top: 16px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.radio-button.vue RiricaV13/components/page/page.radio-button.vue
2,5c2,12
< <div>
< 	<div>{{ hpml.interpolate(block.title) }}</div>
< 	<MkRadio v-for="item in block.values" :key="item" :modelValue="value" :value="item" @update:model-value="updateValue($event)">{{ item }}</MkRadio>
< </div>
---
>   <div>
>     <div>{{ hpml.interpolate(block.title) }}</div>
>     <MkRadio
>       v-for="item in block.values"
>       :key="item"
>       :modelValue="value"
>       :value="item"
>       @update:modelValue="updateValue($event)"
>       >{{ item }}</MkRadio
>     >
>   </div>
9,13c16,20
< import { computed, defineComponent, PropType } from 'vue';
< import MkRadio from '../MkRadio.vue';
< import * as os from '@/os';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { RadioButtonVarBlock } from '@/scripts/hpml/block';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkRadio from "../form/radio.vue";
> import * as os from "@/os";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { RadioButtonVarBlock } from "@/scripts/hpml/block";
16,32c23,39
< 	components: {
< 		MkRadio,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<RadioButtonVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkRadio,
>   },
>   props: {
>     block: {
>       type: Object as PropType<RadioButtonVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
34,37c41,44
< 		function updateValue(newValue: string) {
< 			props.hpml.updatePageVar(props.block.name, newValue);
< 			props.hpml.eval();
< 		}
---
>     function updateValue(newValue: string) {
>       props.hpml.updatePageVar(props.block.name, newValue);
>       props.hpml.eval();
>     }
39,43c46,50
< 		return {
< 			value,
< 			updateValue,
< 		};
< 	},
---
>     return {
>       value,
>       updateValue,
>     };
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.section.vue RiricaV13/components/page/page.section.vue
2,3c2,3
< <section class="sdgxphyu">
< 	<component :is="'h' + h">{{ block.title }}</component>
---
>   <section class="sdgxphyu">
>     <component :is="'h' + h">{{ block.title }}</component>
5,8c5,14
< 	<div class="children">
< 		<XBlock v-for="child in block.children" :key="child.id" :block="child" :hpml="hpml" :h="h + 1"/>
< 	</div>
< </section>
---
>     <div class="children">
>       <XBlock
>         v-for="child in block.children"
>         :key="child.id"
>         :block="child"
>         :hpml="hpml"
>         :h="h + 1"
>       />
>     </div>
>   </section>
12,15c18,21
< import { defineComponent, defineAsyncComponent, PropType } from 'vue';
< import * as os from '@/os';
< import { SectionBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
---
> import { defineComponent, defineAsyncComponent, PropType } from "vue";
> import * as os from "@/os";
> import { SectionBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
18,33c24,39
< 	components: {
< 		XBlock: defineAsyncComponent(() => import('./page.block.vue')),
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<SectionBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 		h: {
< 			required: true,
< 		},
< 	},
---
>   components: {
>     XBlock: defineAsyncComponent(() => import("./page.block.vue")),
>   },
>   props: {
>     block: {
>       type: Object as PropType<SectionBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>     h: {
>       required: true,
>     },
>   },
39c45
< 	margin: 1.5em 0;
---
>   margin: 1.5em 0;
41,44c47,50
< 	> h2 {
< 		font-size: 1.35em;
< 		margin: 0 0 0.5em 0;
< 	}
---
>   > h2 {
>     font-size: 1.35em;
>     margin: 0 0 0.5em 0;
>   }
46,49c52,55
< 	> h3 {
< 		font-size: 1em;
< 		margin: 0 0 0.5em 0;
< 	}
---
>   > h3 {
>     font-size: 1em;
>     margin: 0 0 0.5em 0;
>   }
51,54c57,60
< 	> h4 {
< 		font-size: 1em;
< 		margin: 0 0 0.5em 0;
< 	}
---
>   > h4 {
>     font-size: 1em;
>     margin: 0 0 0.5em 0;
>   }
56,58c62,64
< 	> .children {
< 		//padding 16px
< 	}
---
>   > .children {
>     //padding 16px
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.switch.vue RiricaV13/components/page/page.switch.vue
2,4c2,6
< <div class="hkcxmtwj">
< 	<MkSwitch :model-value="value" @update:model-value="updateValue($event)">{{ hpml.interpolate(block.text) }}</MkSwitch>
< </div>
---
>   <div class="hkcxmtwj">
>     <MkSwitch :model-value="value" @update:modelValue="updateValue($event)">{{
>       hpml.interpolate(block.text)
>     }}</MkSwitch>
>   </div>
8,12c10,14
< import { computed, defineComponent, PropType } from 'vue';
< import MkSwitch from '../MkSwitch.vue';
< import * as os from '@/os';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { SwitchVarBlock } from '@/scripts/hpml/block';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkSwitch from "../form/switch.vue";
> import * as os from "@/os";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { SwitchVarBlock } from "@/scripts/hpml/block";
15,31c17,33
< 	components: {
< 		MkSwitch,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<SwitchVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkSwitch,
>   },
>   props: {
>     block: {
>       type: Object as PropType<SwitchVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
33,36c35,38
< 		function updateValue(newValue: boolean) {
< 			props.hpml.updatePageVar(props.block.name, newValue);
< 			props.hpml.eval();
< 		}
---
>     function updateValue(newValue: boolean) {
>       props.hpml.updatePageVar(props.block.name, newValue);
>       props.hpml.eval();
>     }
38,42c40,44
< 		return {
< 			value,
< 			updateValue,
< 		};
< 	},
---
>     return {
>       value,
>       updateValue,
>     };
>   },
48,49c50,51
< 	display: inline-block;
< 	margin: 16px auto;
---
>   display: inline-block;
>   margin: 16px auto;
51,53c53,55
< 	& + .hkcxmtwj {
< 		margin-left: 16px;
< 	}
---
>   & + .hkcxmtwj {
>     margin-left: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.text-input.vue RiricaV13/components/page/page.text-input.vue
2,6c2,11
< <div>
< 	<MkInput class="kudkigyw" :model-value="value" type="text" @update:model-value="updateValue($event)">
< 		<template #label>{{ hpml.interpolate(block.text) }}</template>
< 	</MkInput>
< </div>
---
>   <div>
>     <MkInput
>       class="kudkigyw"
>       :model-value="value"
>       type="text"
>       @update:modelValue="updateValue($event)"
>     >
>       <template #label>{{ hpml.interpolate(block.text) }}</template>
>     </MkInput>
>   </div>
10,14c15,19
< import { computed, defineComponent, PropType } from 'vue';
< import MkInput from '../MkInput.vue';
< import * as os from '@/os';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { TextInputVarBlock } from '@/scripts/hpml/block';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkInput from "../form/input.vue";
> import * as os from "@/os";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { TextInputVarBlock } from "@/scripts/hpml/block";
17,33c22,38
< 	components: {
< 		MkInput,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<TextInputVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkInput,
>   },
>   props: {
>     block: {
>       type: Object as PropType<TextInputVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
35,38c40,43
< 		function updateValue(newValue) {
< 			props.hpml.updatePageVar(props.block.name, newValue);
< 			props.hpml.eval();
< 		}
---
>     function updateValue(newValue) {
>       props.hpml.updatePageVar(props.block.name, newValue);
>       props.hpml.eval();
>     }
40,44c45,49
< 		return {
< 			value,
< 			updateValue,
< 		};
< 	},
---
>     return {
>       value,
>       updateValue,
>     };
>   },
50,53c55,58
< 	display: inline-block;
< 	min-width: 300px;
< 	max-width: 450px;
< 	margin: 8px 0;
---
>   display: inline-block;
>   min-width: 300px;
>   max-width: 450px;
>   margin: 8px 0;
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.text.vue RiricaV13/components/page/page.text.vue
2,5c2,5
< <div class="mrdgzndn">
< 	<Mfm :key="text" :text="text" :is-note="false" :i="$i"/>
< 	<MkUrlPreview v-for="url in urls" :key="url" :url="url" class="url"/>
< </div>
---
>   <div class="mrdgzndn">
>     <Mfm :key="text" :text="text" :is-note="false" :i="$i" />
>     <MkUrlPreview v-for="url in urls" :key="url" :url="url" class="url" />
>   </div>
9,13c9,13
< import { TextBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { defineAsyncComponent, defineComponent, PropType } from 'vue';
< import * as mfm from 'mfm-js';
< import { extractUrlFromMfm } from '@/scripts/extract-url-from-mfm';
---
> import { TextBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { defineAsyncComponent, defineComponent, PropType } from "vue";
> import * as mfm from "mfm-js";
> import { extractUrlFromMfm } from "@/scripts/extract-url-from-mfm";
16,50c16,52
< 	components: {
< 		MkUrlPreview: defineAsyncComponent(() => import('@/components/MkUrlPreview.vue')),
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<TextBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	data() {
< 		return {
< 			text: this.hpml.interpolate(this.block.text),
< 		};
< 	},
< 	computed: {
< 		urls(): string[] {
< 			if (this.text) {
< 				return extractUrlFromMfm(mfm.parse(this.text));
< 			} else {
< 				return [];
< 			}
< 		},
< 	},
< 	watch: {
< 		'hpml.vars': {
< 			handler() {
< 				this.text = this.hpml.interpolate(this.block.text);
< 			},
< 			deep: true,
< 		},
< 	},
---
>   components: {
>     MkUrlPreview: defineAsyncComponent(
>       () => import("@/components/MkUrlPreview.vue")
>     ),
>   },
>   props: {
>     block: {
>       type: Object as PropType<TextBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   data() {
>     return {
>       text: this.hpml.interpolate(this.block.text),
>     };
>   },
>   computed: {
>     urls(): string[] {
>       if (this.text) {
>         return extractUrlFromMfm(mfm.parse(this.text));
>       } else {
>         return [];
>       }
>     },
>   },
>   watch: {
>     "hpml.vars": {
>       handler() {
>         this.text = this.hpml.interpolate(this.block.text);
>       },
>       deep: true,
>     },
>   },
56,58c58,60
< 	&:not(:first-child) {
< 		margin-top: 0.5em;
< 	}
---
>   &:not(:first-child) {
>     margin-top: 0.5em;
>   }
60,62c62,64
< 	&:not(:last-child) {
< 		margin-bottom: 0.5em;
< 	}
---
>   &:not(:last-child) {
>     margin-bottom: 0.5em;
>   }
64,66c66,68
< 	> .url {
< 		margin: 0.5em 0;
< 	}
---
>   > .url {
>     margin: 0.5em 0;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.textarea-input.vue RiricaV13/components/page/page.textarea-input.vue
2,6c2,6
< <div>
< 	<MkTextarea :model-value="value" @update:model-value="updateValue($event)">
< 		<template #label>{{ hpml.interpolate(block.text) }}</template>
< 	</MkTextarea>
< </div>
---
>   <div>
>     <MkTextarea :model-value="value" @update:modelValue="updateValue($event)">
>       <template #label>{{ hpml.interpolate(block.text) }}</template>
>     </MkTextarea>
>   </div>
10,15c10,15
< import { computed, defineComponent, PropType } from 'vue';
< import MkTextarea from '../MkTextarea.vue';
< import * as os from '@/os';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { HpmlTextInput } from '@/scripts/hpml';
< import { TextInputVarBlock } from '@/scripts/hpml/block';
---
> import { computed, defineComponent, PropType } from "vue";
> import MkTextarea from "../form/textarea.vue";
> import * as os from "@/os";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { HpmlTextInput } from "@/scripts/hpml";
> import { TextInputVarBlock } from "@/scripts/hpml/block";
18,34c18,34
< 	components: {
< 		MkTextarea,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<TextInputVarBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const value = computed(() => {
< 			return props.hpml.vars.value[props.block.name];
< 		});
---
>   components: {
>     MkTextarea,
>   },
>   props: {
>     block: {
>       type: Object as PropType<TextInputVarBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const value = computed(() => {
>       return props.hpml.vars.value[props.block.name];
>     });
36,39c36,39
< 		function updateValue(newValue) {
< 			props.hpml.updatePageVar(props.block.name, newValue);
< 			props.hpml.eval();
< 		}
---
>     function updateValue(newValue) {
>       props.hpml.updatePageVar(props.block.name, newValue);
>       props.hpml.eval();
>     }
41,45c41,45
< 		return {
< 			value,
< 			updateValue,
< 		};
< 	},
---
>     return {
>       value,
>       updateValue,
>     };
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.textarea.vue RiricaV13/components/page/page.textarea.vue
2c2
< <MkTextarea :model-value="text" readonly></MkTextarea>
---
>   <MkTextarea :model-value="text" readonly></MkTextarea>
6,9c6,9
< import { TextBlock } from '@/scripts/hpml/block';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { defineComponent, PropType } from 'vue';
< import MkTextarea from '../MkTextarea.vue';
---
> import { TextBlock } from "@/scripts/hpml/block";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { defineComponent, PropType } from "vue";
> import MkTextarea from "../form/textarea.vue";
12,37c12,37
< 	components: {
< 		MkTextarea,
< 	},
< 	props: {
< 		block: {
< 			type: Object as PropType<TextBlock>,
< 			required: true,
< 		},
< 		hpml: {
< 			type: Object as PropType<Hpml>,
< 			required: true,
< 		},
< 	},
< 	data() {
< 		return {
< 			text: this.hpml.interpolate(this.block.text),
< 		};
< 	},
< 	watch: {
< 		'hpml.vars': {
< 			handler() {
< 				this.text = this.hpml.interpolate(this.block.text);
< 			},
< 			deep: true,
< 		},
< 	},
---
>   components: {
>     MkTextarea,
>   },
>   props: {
>     block: {
>       type: Object as PropType<TextBlock>,
>       required: true,
>     },
>     hpml: {
>       type: Object as PropType<Hpml>,
>       required: true,
>     },
>   },
>   data() {
>     return {
>       text: this.hpml.interpolate(this.block.text),
>     };
>   },
>   watch: {
>     "hpml.vars": {
>       handler() {
>         this.text = this.hpml.interpolate(this.block.text);
>       },
>       deep: true,
>     },
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/components/page/page.vue RiricaV13/components/page/page.vue
2,4c2,14
< <div v-if="hpml" class="iroscrza" :class="{ center: page.alignCenter, serif: page.font === 'serif' }">
< 	<XBlock v-for="child in page.content" :key="child.id" :block="child" :hpml="hpml" :h="2"/>
< </div>
---
>   <div
>     v-if="hpml"
>     class="iroscrza"
>     :class="{ center: page.alignCenter, serif: page.font === 'serif' }"
>   >
>     <XBlock
>       v-for="child in page.content"
>       :key="child.id"
>       :block="child"
>       :hpml="hpml"
>       :h="2"
>     />
>   </div>
8,13c18,30
< import { defineComponent, onMounted, nextTick, onUnmounted, PropType } from 'vue';
< import XBlock from './page.block.vue';
< import { Hpml } from '@/scripts/hpml/evaluator';
< import { url } from '@/config';
< import { $i } from '@/account';
< import { defaultStore } from '@/store';
---
> import {
>   defineComponent,
>   onMounted,
>   nextTick,
>   onUnmounted,
>   PropType,
> } from "vue";
> import { parse } from "@syuilo/aiscript";
> import XBlock from "./page.block.vue";
> import { Hpml } from "@/scripts/hpml/evaluator";
> import { url } from "@/config";
> import { $i } from "@/account";
> import { defaultStore } from "@/store";
16,30c33,48
< 	components: {
< 		XBlock,
< 	},
< 	props: {
< 		page: {
< 			type: Object as PropType<Record<string, any>>,
< 			required: true,
< 		},
< 	},
< 	setup(props, ctx) {
< 		const hpml = new Hpml(props.page, {
< 			randomSeed: Math.random(),
< 			visitor: $i,
< 			url: url,
< 		});
---
>   components: {
>     XBlock,
>   },
>   props: {
>     page: {
>       type: Object as PropType<Record<string, any>>,
>       required: true,
>     },
>   },
>   setup(props, ctx) {
>     const hpml = new Hpml(props.page, {
>       randomSeed: Math.random(),
>       visitor: $i,
>       url: url,
>       enableAiScript: !defaultStore.state.disablePagesScript,
>     });
32,36c50,83
< 		onMounted(() => {
< 			nextTick(() => {
< 				hpml.eval();
< 			});
< 		});
---
>     onMounted(() => {
>       nextTick(() => {
>         if (props.page.script && hpml.aiscript) {
>           let ast;
>           try {
>             ast = parse(props.page.script);
>           } catch (err) {
>             console.error(err);
>             /*os.alert({
> 							type: 'error',
> 							text: 'Syntax error :('
> 						});*/
>             return;
>           }
>           hpml.aiscript
>             .exec(ast)
>             .then(() => {
>               hpml.eval();
>             })
>             .catch((err) => {
>               console.error(err);
>               /*os.alert({
> 							type: 'error',
> 							text: err
> 						});*/
>             });
>         } else {
>           hpml.eval();
>         }
>       });
>       onUnmounted(() => {
>         if (hpml.aiscript) hpml.aiscript.abort();
>       });
>     });
38,41c85,88
< 		return {
< 			hpml,
< 		};
< 	},
---
>     return {
>       hpml,
>     };
>   },
47,51c94,98
< 	&.serif {
< 		> div {
< 			font-family: serif;
< 		}
< 	}
---
>   &.serif {
>     > div {
>       font-family: serif;
>     }
>   }
53,55c100,102
< 	&.center {
< 		text-align: center;
< 	}
---
>   &.center {
>     text-align: center;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/config.ts RiricaV13/config.ts
1c1,2
< import { miLocalStorage } from "./local-storage";
---
> import { $i } from "@/account";
> import { langNames } from "@/i18n"
3,4c4,7
< const address = new URL(location.href);
< const siteName = (document.querySelector('meta[property="og:site_name"]') as HTMLMetaElement)?.content;
---
> const address = $i? new URL($i.instanceUrl) : null;
> const siteName = (
>   document.querySelector('meta[property="og:site_name"]') as HTMLMetaElement
> )?.content;
6,13c9,16
< export const host = address.host;
< export const hostname = address.hostname;
< export const url = address.origin;
< export const apiUrl = url + '/api';
< export const wsUrl = url.replace('http://', 'ws://').replace('https://', 'wss://') + '/streaming';
< export const lang = miLocalStorage.getItem('lang');
< export const langs = _LANGS_;
< export let locale = JSON.parse(miLocalStorage.getItem('locale'));
---
> export const host = address?.host;
> export const hostname = address?.hostname;
> export const url = $i?.instanceUrl;
> export const apiUrl = url + "/api";
> export const wsUrl =
>   url?.replace("http://", "ws://").replace("https://", "wss://") + "/streaming";
> export const lang = localStorage.getItem("lang")
> export const langs = langNames
15,21c18,20
< export const instanceName = siteName === 'Misskey' ? host : siteName;
< export const ui = miLocalStorage.getItem('ui');
< export const debug = miLocalStorage.getItem('debug') === 'true';
< 
< export function updateLocale(newLocale) {
< 	locale = newLocale;
< }
---
> export const instanceName = siteName === "Misskey" ? host : siteName;
> export const ui = localStorage.getItem("ui");
> export const debug = localStorage.getItem("debug") === "true";
diff --color=auto -r misskeyV13/packages/frontend/src/const.ts RiricaV13/const.ts
5,14c5,13
< 	// Images
< 	'image/png',
< 	'image/gif',
< 	'image/jpeg',
< 	'image/webp',
< 	'image/avif',
< 	'image/apng',
< 	'image/bmp',
< 	'image/tiff',
< 	'image/x-icon',
---
>   // Images
>   "image/png",
>   "image/gif",
>   "image/jpeg",
>   "image/webp",
>   "image/apng",
>   "image/bmp",
>   "image/tiff",
>   "image/x-icon",
16,20c15,19
< 	// OggS
< 	'audio/opus',
< 	'video/ogg',
< 	'audio/ogg',
< 	'application/ogg',
---
>   // OggS
>   "audio/opus",
>   "video/ogg",
>   "audio/ogg",
>   "application/ogg",
22,29c21,28
< 	// ISO/IEC base media file format
< 	'video/quicktime',
< 	'video/mp4',
< 	'audio/mp4',
< 	'video/x-m4v',
< 	'audio/x-m4a',
< 	'video/3gpp',
< 	'video/3gpp2',
---
>   // ISO/IEC base media file format
>   "video/quicktime",
>   "video/mp4",
>   "audio/mp4",
>   "video/x-m4v",
>   "audio/x-m4a",
>   "video/3gpp",
>   "video/3gpp2",
31,32c30,31
< 	'video/mpeg',
< 	'audio/mpeg',
---
>   "video/mpeg",
>   "audio/mpeg",
34,35c33,34
< 	'video/webm',
< 	'audio/webm',
---
>   "video/webm",
>   "audio/webm",
37,39c36,38
< 	'audio/aac',
< 	'audio/x-flac',
< 	'audio/vnd.wave',
---
>   "audio/aac",
>   "audio/x-flac",
>   "audio/vnd.wave",
Only in misskeyV13/packages/frontend/src: custom-emojis.ts
Only in misskeyV13/packages/frontend/src/directives: adaptive-bg.ts
diff --color=auto -r misskeyV13/packages/frontend/src/directives/adaptive-border.ts RiricaV13/directives/adaptive-border.ts
1c1
< import { Directive } from 'vue';
---
> import { Directive } from "vue";
4,14c4,17
< 	mounted(src, binding, vn) {
< 		const getBgColor = (el: HTMLElement) => {
< 			const style = window.getComputedStyle(el);
< 			if (style.backgroundColor && !['rgba(0, 0, 0, 0)', 'rgba(0,0,0,0)', 'transparent'].includes(style.backgroundColor)) {
< 				return style.backgroundColor;
< 			} else {
< 				return el.parentElement ? getBgColor(el.parentElement) : 'transparent';
< 			}
< 		};
< 	
< 		const parentBg = getBgColor(src.parentElement);
---
>   mounted(src, binding, vn) {
>     const getBgColor = (el: HTMLElement) => {
>       const style = window.getComputedStyle(el);
>       if (
>         style.backgroundColor &&
>         !["rgba(0, 0, 0, 0)", "rgba(0,0,0,0)", "transparent"].includes(
>           style.backgroundColor
>         )
>       ) {
>         return style.backgroundColor;
>       } else {
>         return el.parentElement ? getBgColor(el.parentElement) : "transparent";
>       }
>     };
16c19
< 		const myBg = window.getComputedStyle(src).backgroundColor;
---
>     const parentBg = getBgColor(src.parentElement);
18,23c21,28
< 		if (parentBg === myBg) {
< 			src.style.borderColor = 'var(--divider)';
< 		} else {
< 			src.style.borderColor = myBg;
< 		}
< 	},
---
>     const myBg = window.getComputedStyle(src).backgroundColor;
> 
>     if (parentBg === myBg) {
>       src.style.borderColor = "var(--divider)";
>     } else {
>       src.style.borderColor = myBg;
>     }
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/anim.ts RiricaV13/directives/anim.ts
1c1
< import { Directive } from 'vue';
---
> import { Directive } from "vue";
4,10c4,10
< 	beforeMount(src, binding, vn) {
< 		src.style.opacity = '0';
< 		src.style.transform = 'scale(0.9)';
< 		// ページネーションと相性が悪いので
< 		//if (typeof binding.value === 'number') src.style.transitionDelay = `${binding.value * 30}ms`;
< 		src.classList.add('_zoom');
< 	},
---
>   beforeMount(src, binding, vn) {
>     src.style.opacity = "0";
>     src.style.transform = "scale(0.9)";
>     // ページネーションと相性が悪いので
>     //if (typeof binding.value === 'number') src.style.transitionDelay = `${binding.value * 30}ms`;
>     src.classList.add("_zoom");
>   },
12,17c12,17
< 	mounted(src, binding, vn) {
< 		window.setTimeout(() => {
< 			src.style.opacity = '1';
< 			src.style.transform = 'none';
< 		}, 1);
< 	},
---
>   mounted(src, binding, vn) {
>     window.setTimeout(() => {
>       src.style.opacity = "1";
>       src.style.transform = "none";
>     }, 1);
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/appear.ts RiricaV13/directives/appear.ts
1c1
< import { Directive } from 'vue';
---
> import { Directive } from "vue";
4,6c4,6
< 	mounted(src, binding, vn) {
< 		const fn = binding.value;
< 		if (fn == null) return;
---
>   mounted(src, binding, vn) {
>     const fn = binding.value;
>     if (fn == null) return;
8,12c8,12
< 		const observer = new IntersectionObserver(entries => {
< 			if (entries.some(entry => entry.isIntersecting)) {
< 				fn();
< 			}
< 		});
---
>     const observer = new IntersectionObserver((entries) => {
>       if (entries.some((entry) => entry.isIntersecting)) {
>         fn();
>       }
>     });
14c14
< 		observer.observe(src);
---
>     observer.observe(src);
16,17c16,17
< 		src._observer_ = observer;
< 	},
---
>     src._observer_ = observer;
>   },
19,21c19,21
< 	unmounted(src, binding, vn) {
< 		if (src._observer_) src._observer_.disconnect();
< 	},
---
>   unmounted(src, binding, vn) {
>     if (src._observer_) src._observer_.disconnect();
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/click-anime.ts RiricaV13/directives/click-anime.ts
1,2c1,2
< import { Directive } from 'vue';
< import { defaultStore } from '@/store';
---
> import { Directive } from "vue";
> import { defaultStore } from "@/store";
5c5,6
< 	mounted(el: HTMLElement, binding, vn) {
---
>   mounted(el, binding, vn) {
>     /*
8c9
< 		const target = el.children[0];
---
> 		el.classList.add('_anime_bounce_standBy');
10,13d10
< 		if (target == null) return;
< 
< 		target.classList.add('_anime_bounce_standBy');
< 
15c12,13
< 			target.classList.remove('_anime_bounce');
---
> 			el.classList.add('_anime_bounce_standBy');
> 			el.classList.add('_anime_bounce_ready');
17,21c15,16
< 			target.classList.add('_anime_bounce_standBy');
< 			target.classList.add('_anime_bounce_ready');
< 
< 			target.addEventListener('mouseleave', () => {
< 				target.classList.remove('_anime_bounce_ready');
---
> 			el.addEventListener('mouseleave', () => {
> 				el.classList.remove('_anime_bounce_ready');
26,27c21
< 			target.classList.add('_anime_bounce');
< 			target.classList.remove('_anime_bounce_ready');
---
> 			el.classList.add('_anime_bounce');
31,32c25,27
< 			target.classList.remove('_anime_bounce');
< 			target.classList.add('_anime_bounce_standBy');
---
> 			el.classList.remove('_anime_bounce_ready');
> 			el.classList.remove('_anime_bounce');
> 			el.classList.add('_anime_bounce_standBy');
34c29,30
< 	},
---
> 		*/
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/follow-append.ts RiricaV13/directives/follow-append.ts
1,2c1,2
< import { Directive } from 'vue';
< import { getScrollContainer, getScrollPosition } from '@/scripts/scroll';
---
> import { Directive } from "vue";
> import { getScrollContainer, getScrollPosition } from "@/scripts/scroll";
5,6c5,6
< 	mounted(src, binding, vn) {
< 		if (binding.value === false) return;
---
>   mounted(src, binding, vn) {
>     if (binding.value === false) return;
8c8
< 		let isBottom = true;
---
>     let isBottom = true;
10,17c10,21
< 		const container = getScrollContainer(src)!;
< 		container.addEventListener('scroll', () => {
< 			const pos = getScrollPosition(container);
< 			const viewHeight = container.clientHeight;
< 			const height = container.scrollHeight;
< 			isBottom = (pos + viewHeight > height - 32);
< 		}, { passive: true });
< 		container.scrollTop = container.scrollHeight;
---
>     const container = getScrollContainer(src)!;
>     container.addEventListener(
>       "scroll",
>       () => {
>         const pos = getScrollPosition(container);
>         const viewHeight = container.clientHeight;
>         const height = container.scrollHeight;
>         isBottom = pos + viewHeight > height - 32;
>       },
>       { passive: true }
>     );
>     container.scrollTop = container.scrollHeight;
19,24c23,28
< 		const ro = new ResizeObserver((entries, observer) => {
< 			if (isBottom) {
< 				const height = container.scrollHeight;
< 				container.scrollTop = height;
< 			}
< 		});
---
>     const ro = new ResizeObserver((entries, observer) => {
>       if (isBottom) {
>         const height = container.scrollHeight;
>         container.scrollTop = height;
>       }
>     });
26c30
< 		ro.observe(src);
---
>     ro.observe(src);
28,30c32,34
< 		// TODO: 新たにプロパティを作るのをやめMapを使う
< 		src._ro_ = ro;
< 	},
---
>     // TODO: 新たにプロパティを作るのをやめMapを使う
>     src._ro_ = ro;
>   },
32,34c36,38
< 	unmounted(src, binding, vn) {
< 		if (src._ro_) src._ro_.unobserve(src);
< 	},
---
>   unmounted(src, binding, vn) {
>     if (src._ro_) src._ro_.unobserve(src);
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/get-size.ts RiricaV13/directives/get-size.ts
1c1
< import { Directive } from 'vue';
---
> import { Directive } from "vue";
3,7c3,10
< const mountings = new Map<Element, {
< 	resize: ResizeObserver;
< 	intersection?: IntersectionObserver;
< 	fn: (w: number, h: number) => void;
< }>();
---
> const mountings = new Map<
>   Element,
>   {
>     resize: ResizeObserver;
>     intersection?: IntersectionObserver;
>     fn: (w: number, h: number) => void;
>   }
> >();
10,12c13,15
< 	const info = mountings.get(src);
< 	const height = src.clientHeight;
< 	const width = src.clientWidth;
---
>   const info = mountings.get(src);
>   const height = src.clientHeight;
>   const width = src.clientWidth;
14c17
< 	if (!info) return;
---
>   if (!info) return;
16,30c19,33
< 	// アクティベート前などでsrcが描画されていない場合
< 	if (!height) {
< 		// IntersectionObserverで表示検出する
< 		if (!info.intersection) {
< 			info.intersection = new IntersectionObserver(entries => {
< 				if (entries.some(entry => entry.isIntersecting)) calc(src);
< 			});
< 		}
< 		info.intersection.observe(src);
< 		return;
< 	}
< 	if (info.intersection) {
< 		info.intersection.disconnect();
< 		delete info.intersection;
< 	}
---
>   // アクティベート前などでsrcが描画されていない場合
>   if (!height) {
>     // IntersectionObserverで表示検出する
>     if (!info.intersection) {
>       info.intersection = new IntersectionObserver((entries) => {
>         if (entries.some((entry) => entry.isIntersecting)) calc(src);
>       });
>     }
>     info.intersection.observe(src);
>     return;
>   }
>   if (info.intersection) {
>     info.intersection.disconnect();
>     delete info.intersection;
>   }
32c35
< 	info.fn(width, height);
---
>   info.fn(width, height);
36,40c39,43
< 	mounted(src, binding, vn) {
< 		const resize = new ResizeObserver((entries, observer) => {
< 			calc(src);
< 		});
< 		resize.observe(src);
---
>   mounted(src, binding, vn) {
>     const resize = new ResizeObserver((entries, observer) => {
>       calc(src);
>     });
>     resize.observe(src);
42,44c45,47
< 		mountings.set(src, { resize, fn: binding.value });
< 		calc(src);
< 	},
---
>     mountings.set(src, { resize, fn: binding.value });
>     calc(src);
>   },
46,53c49,56
< 	unmounted(src, binding, vn) {
< 		binding.value(0, 0);
< 		const info = mountings.get(src);
< 		if (!info) return;
< 		info.resize.disconnect();
< 		if (info.intersection) info.intersection.disconnect();
< 		mountings.delete(src);
< 	},
---
>   unmounted(src, binding, vn) {
>     binding.value(0, 0);
>     const info = mountings.get(src);
>     if (!info) return;
>     info.resize.disconnect();
>     if (info.intersection) info.intersection.disconnect();
>     mountings.delete(src);
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/hotkey.ts RiricaV13/directives/hotkey.ts
1,2c1,2
< import { Directive } from 'vue';
< import { makeHotkey } from '../scripts/hotkey';
---
> import { Directive } from "vue";
> import { makeHotkey } from "../scripts/hotkey";
5,6c5,6
< 	mounted(el, binding) {
< 		el._hotkey_global = binding.modifiers.global === true;
---
>   mounted(el, binding) {
>     el._hotkey_global = binding.modifiers.global === true;
8c8
< 		el._keyHandler = makeHotkey(binding.value);
---
>     el._keyHandler = makeHotkey(binding.value);
10,15c10,15
< 		if (el._hotkey_global) {
< 			document.addEventListener('keydown', el._keyHandler);
< 		} else {
< 			el.addEventListener('keydown', el._keyHandler);
< 		}
< 	},
---
>     if (el._hotkey_global) {
>       document.addEventListener("keydown", el._keyHandler);
>     } else {
>       el.addEventListener("keydown", el._keyHandler);
>     }
>   },
17,23c17,23
< 	unmounted(el) {
< 		if (el._hotkey_global) {
< 			document.removeEventListener('keydown', el._keyHandler);
< 		} else {
< 			el.removeEventListener('keydown', el._keyHandler);
< 		}
< 	},
---
>   unmounted(el) {
>     if (el._hotkey_global) {
>       document.removeEventListener("keydown", el._keyHandler);
>     } else {
>       el.removeEventListener("keydown", el._keyHandler);
>     }
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/index.ts RiricaV13/directives/index.ts
1c1
< import { App } from 'vue';
---
> import { App } from "vue";
3,13c3,13
< import userPreview from './user-preview';
< import getSize from './get-size';
< import ripple from './ripple';
< import tooltip from './tooltip';
< import hotkey from './hotkey';
< import appear from './appear';
< import anim from './anim';
< import clickAnime from './click-anime';
< import panel from './panel';
< import adaptiveBorder from './adaptive-border';
< import adaptiveBg from './adaptive-bg';
---
> import userPreview from "./user-preview";
> import size from "./size";
> import getSize from "./get-size";
> import ripple from "./ripple";
> import tooltip from "./tooltip";
> import hotkey from "./hotkey";
> import appear from "./appear";
> import anim from "./anim";
> import clickAnime from "./click-anime";
> import panel from "./panel";
> import adaptiveBorder from "./adaptive-border";
15,27c15,27
< export default function(app: App) {
< 	app.directive('userPreview', userPreview);
< 	app.directive('user-preview', userPreview);
< 	app.directive('get-size', getSize);
< 	app.directive('ripple', ripple);
< 	app.directive('tooltip', tooltip);
< 	app.directive('hotkey', hotkey);
< 	app.directive('appear', appear);
< 	app.directive('anim', anim);
< 	app.directive('click-anime', clickAnime);
< 	app.directive('panel', panel);
< 	app.directive('adaptive-border', adaptiveBorder);
< 	app.directive('adaptive-bg', adaptiveBg);
---
> export default function (app: App) {
>   app.directive("userPreview", userPreview);
>   app.directive("user-preview", userPreview);
>   app.directive("size", size);
>   app.directive("get-size", getSize);
>   app.directive("ripple", ripple);
>   app.directive("tooltip", tooltip);
>   app.directive("hotkey", hotkey);
>   app.directive("appear", appear);
>   app.directive("anim", anim);
>   app.directive("click-anime", clickAnime);
>   app.directive("panel", panel);
>   app.directive("adaptive-border", adaptiveBorder);
diff --color=auto -r misskeyV13/packages/frontend/src/directives/panel.ts RiricaV13/directives/panel.ts
1c1
< import { Directive } from 'vue';
---
> import { Directive } from "vue";
4,14c4,17
< 	mounted(src, binding, vn) {
< 		const getBgColor = (el: HTMLElement) => {
< 			const style = window.getComputedStyle(el);
< 			if (style.backgroundColor && !['rgba(0, 0, 0, 0)', 'rgba(0,0,0,0)', 'transparent'].includes(style.backgroundColor)) {
< 				return style.backgroundColor;
< 			} else {
< 				return el.parentElement ? getBgColor(el.parentElement) : 'transparent';
< 			}
< 		};
< 	
< 		const parentBg = getBgColor(src.parentElement);
---
>   mounted(src, binding, vn) {
>     const getBgColor = (el: HTMLElement) => {
>       const style = window.getComputedStyle(el);
>       if (
>         style.backgroundColor &&
>         !["rgba(0, 0, 0, 0)", "rgba(0,0,0,0)", "transparent"].includes(
>           style.backgroundColor
>         )
>       ) {
>         return style.backgroundColor;
>       } else {
>         return el.parentElement ? getBgColor(el.parentElement) : "transparent";
>       }
>     };
16c19
< 		const myBg = getComputedStyle(document.documentElement).getPropertyValue('--panel');
---
>     const parentBg = getBgColor(src.parentElement);
18,23c21,30
< 		if (parentBg === myBg) {
< 			src.style.backgroundColor = 'var(--bg)';
< 		} else {
< 			src.style.backgroundColor = 'var(--panel)';
< 		}
< 	},
---
>     const myBg = getComputedStyle(document.documentElement).getPropertyValue(
>       "--panel"
>     );
> 
>     if (parentBg === myBg) {
>       src.style.backgroundColor = "var(--bg)";
>     } else {
>       src.style.backgroundColor = "var(--panel)";
>     }
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/ripple.ts RiricaV13/directives/ripple.ts
1,2c1,2
< import MkRippleEffect from '@/components/MkRippleEffect.vue';
< import { popup } from '@/os';
---
> import Ripple from "@/components/MkRipple.vue";
> import { popup } from "@/os";
5,7c5,7
< 	mounted(el, binding, vn) {
< 		// 明示的に false であればバインドしない
< 		if (binding.value === false) return;
---
>   mounted(el, binding, vn) {
>     // 明示的に false であればバインドしない
>     if (binding.value === false) return;
9,10c9,10
< 		el.addEventListener('click', () => {
< 			const rect = el.getBoundingClientRect();
---
>     el.addEventListener("click", () => {
>       const rect = el.getBoundingClientRect();
12,13c12,13
< 			const x = rect.left + (el.offsetWidth / 2);
< 			const y = rect.top + (el.offsetHeight / 2);
---
>       const x = rect.left + el.offsetWidth / 2;
>       const y = rect.top + el.offsetHeight / 2;
15,17c15,17
< 			popup(MkRippleEffect, { x, y }, {}, 'end');
< 		});
< 	},
---
>       popup(Ripple, { x, y }, {}, "end");
>     });
>   },
Only in RiricaV13/directives: size.ts
diff --color=auto -r misskeyV13/packages/frontend/src/directives/tooltip.ts RiricaV13/directives/tooltip.ts
4,6c4,6
< import { defineAsyncComponent, Directive, ref } from 'vue';
< import { isTouchUsing } from '@/scripts/touch';
< import { popup, alert } from '@/os';
---
> import { defineAsyncComponent, Directive, ref } from "vue";
> import { isTouchUsing } from "@/scripts/touch";
> import { popup, alert } from "@/os";
8,9c8,9
< const start = isTouchUsing ? 'touchstart' : 'mouseover';
< const end = isTouchUsing ? 'touchend' : 'mouseleave';
---
> const start = isTouchUsing ? "touchstart" : "mouseover";
> const end = isTouchUsing ? "touchend" : "mouseleave";
12,13c12,13
< 	mounted(el: HTMLElement, binding, vn) {
< 		const delay = binding.modifiers.noDelay ? 0 : 100;
---
>   mounted(el: HTMLElement, binding, vn) {
>     const delay = binding.modifiers.noDelay ? 0 : 100;
15c15
< 		const self = (el as any)._tooltipDirective_ = {} as any;
---
>     const self = ((el as any)._tooltipDirective_ = {} as any);
17,21c17,21
< 		self.text = binding.value as string;
< 		self._close = null;
< 		self.showTimer = null;
< 		self.hideTimer = null;
< 		self.checkTimer = null;
---
>     self.text = binding.value as string;
>     self._close = null;
>     self.showTimer = null;
>     self.hideTimer = null;
>     self.checkTimer = null;
23,29c23,29
< 		self.close = () => {
< 			if (self._close) {
< 				window.clearInterval(self.checkTimer);
< 				self._close();
< 				self._close = null;
< 			}
< 		};
---
>     self.close = () => {
>       if (self._close) {
>         window.clearInterval(self.checkTimer);
>         self._close();
>         self._close = null;
>       }
>     };
31,41c31,41
< 		if (binding.arg === 'dialog') {
< 			el.addEventListener('click', (ev) => {
< 				ev.preventDefault();
< 				ev.stopPropagation();
< 				alert({
< 					type: 'info',
< 					text: binding.value,
< 				});
< 				return false;
< 			});
< 		}
---
>     if (binding.arg === "dialog") {
>       el.addEventListener("click", (ev) => {
>         ev.preventDefault();
>         ev.stopPropagation();
>         alert({
>           type: "info",
>           text: binding.value,
>         });
>         return false;
>       });
>     }
43,46c43,46
< 		self.show = () => {
< 			if (!document.body.contains(el)) return;
< 			if (self._close) return;
< 			if (self.text == null) return;
---
>     self.show = () => {
>       if (!document.body.contains(el)) return;
>       if (self._close) return;
>       if (self.text == null) return;
48,55c48,68
< 			const showing = ref(true);
< 			popup(defineAsyncComponent(() => import('@/components/MkTooltip.vue')), {
< 				showing,
< 				text: self.text,
< 				asMfm: binding.modifiers.mfm,
< 				direction: binding.modifiers.left ? 'left' : binding.modifiers.right ? 'right' : binding.modifiers.top ? 'top' : binding.modifiers.bottom ? 'bottom' : 'top',
< 				targetElement: el,
< 			}, {}, 'closed');
---
>       const showing = ref(true);
>       popup(
>         defineAsyncComponent(() => import("@/components/MkTooltip.vue")),
>         {
>           showing,
>           text: self.text,
>           asMfm: binding.modifiers.mfm,
>           direction: binding.modifiers.left
>             ? "left"
>             : binding.modifiers.right
>             ? "right"
>             : binding.modifiers.top
>             ? "top"
>             : binding.modifiers.bottom
>             ? "bottom"
>             : "top",
>           targetElement: el,
>         },
>         {},
>         "closed"
>       );
57,60c70,73
< 			self._close = () => {
< 				showing.value = false;
< 			};
< 		};
---
>       self._close = () => {
>         showing.value = false;
>       };
>     };
62,64c75,77
< 		el.addEventListener('selectstart', ev => {
< 			ev.preventDefault();
< 		});
---
>     el.addEventListener("selectstart", (ev) => {
>       ev.preventDefault();
>     });
66,70c79,87
< 		el.addEventListener(start, () => {
< 			window.clearTimeout(self.showTimer);
< 			window.clearTimeout(self.hideTimer);
< 			self.showTimer = window.setTimeout(self.show, delay);
< 		}, { passive: true });
---
>     el.addEventListener(
>       start,
>       () => {
>         window.clearTimeout(self.showTimer);
>         window.clearTimeout(self.hideTimer);
>         self.showTimer = window.setTimeout(self.show, delay);
>       },
>       { passive: true }
>     );
72,76c89,97
< 		el.addEventListener(end, () => {
< 			window.clearTimeout(self.showTimer);
< 			window.clearTimeout(self.hideTimer);
< 			self.hideTimer = window.setTimeout(self.close, delay);
< 		}, { passive: true });
---
>     el.addEventListener(
>       end,
>       () => {
>         window.clearTimeout(self.showTimer);
>         window.clearTimeout(self.hideTimer);
>         self.hideTimer = window.setTimeout(self.close, delay);
>       },
>       { passive: true }
>     );
78,82c99,103
< 		el.addEventListener('click', () => {
< 			window.clearTimeout(self.showTimer);
< 			self.close();
< 		});
< 	},
---
>     el.addEventListener("click", () => {
>       window.clearTimeout(self.showTimer);
>       self.close();
>     });
>   },
84,87c105,108
< 	updated(el, binding) {
< 		const self = el._tooltipDirective_;
< 		self.text = binding.value as string;
< 	},
---
>   updated(el, binding) {
>     const self = el._tooltipDirective_;
>     self.text = binding.value as string;
>   },
89,92c110,113
< 	unmounted(el, binding, vn) {
< 		const self = el._tooltipDirective_;
< 		window.clearInterval(self.checkTimer);
< 	},
---
>   unmounted(el, binding, vn) {
>     const self = el._tooltipDirective_;
>     window.clearInterval(self.checkTimer);
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/directives/user-preview.ts RiricaV13/directives/user-preview.ts
1,3c1,3
< import { defineAsyncComponent, Directive, ref } from 'vue';
< import autobind from 'autobind-decorator';
< import { popup } from '@/os';
---
> import { defineAsyncComponent, Directive, ref } from "vue";
> import autobind from "autobind-decorator";
> import { popup } from "@/os";
6,11c6,11
< 	private el;
< 	private user;
< 	private showTimer;
< 	private hideTimer;
< 	private checkTimer;
< 	private promise;
---
>   private el;
>   private user;
>   private showTimer;
>   private hideTimer;
>   private checkTimer;
>   private promise;
13,15c13,15
< 	constructor(el, user) {
< 		this.el = el;
< 		this.user = user;
---
>   constructor(el, user) {
>     this.el = el;
>     this.user = user;
17,18c17,18
< 		this.attach();
< 	}
---
>     this.attach();
>   }
20,23c20,23
< 	@autobind
< 	private show() {
< 		if (!document.body.contains(this.el)) return;
< 		if (this.promise) return;
---
>   @autobind
>   private show() {
>     if (!document.body.contains(this.el)) return;
>     if (this.promise) return;
25c25
< 		const showing = ref(true);
---
>     const showing = ref(true);
27,39c27,44
< 		popup(defineAsyncComponent(() => import('@/components/MkUserPreview.vue')), {
< 			showing,
< 			q: this.user,
< 			source: this.el,
< 		}, {
< 			mouseover: () => {
< 				window.clearTimeout(this.hideTimer);
< 			},
< 			mouseleave: () => {
< 				window.clearTimeout(this.showTimer);
< 				this.hideTimer = window.setTimeout(this.close, 500);
< 			},
< 		}, 'closed');
---
>     popup(
>       defineAsyncComponent(() => import("@/components/MkUserPreview.vue")),
>       {
>         showing,
>         q: this.user,
>         source: this.el,
>       },
>       {
>         mouseover: () => {
>           window.clearTimeout(this.hideTimer);
>         },
>         mouseleave: () => {
>           window.clearTimeout(this.showTimer);
>           this.hideTimer = window.setTimeout(this.close, 500);
>         },
>       },
>       "closed"
>     );
41,45c46,50
< 		this.promise = {
< 			cancel: () => {
< 				showing.value = false;
< 			},
< 		};
---
>     this.promise = {
>       cancel: () => {
>         showing.value = false;
>       },
>     };
47,54c52,59
< 		this.checkTimer = window.setInterval(() => {
< 			if (!document.body.contains(this.el)) {
< 				window.clearTimeout(this.showTimer);
< 				window.clearTimeout(this.hideTimer);
< 				this.close();
< 			}
< 		}, 1000);
< 	}
---
>     this.checkTimer = window.setInterval(() => {
>       if (!document.body.contains(this.el)) {
>         window.clearTimeout(this.showTimer);
>         window.clearTimeout(this.hideTimer);
>         this.close();
>       }
>     }, 1000);
>   }
56,63c61,68
< 	@autobind
< 	private close() {
< 		if (this.promise) {
< 			window.clearInterval(this.checkTimer);
< 			this.promise.cancel();
< 			this.promise = null;
< 		}
< 	}
---
>   @autobind
>   private close() {
>     if (this.promise) {
>       window.clearInterval(this.checkTimer);
>       this.promise.cancel();
>       this.promise = null;
>     }
>   }
65,70c70,75
< 	@autobind
< 	private onMouseover() {
< 		window.clearTimeout(this.showTimer);
< 		window.clearTimeout(this.hideTimer);
< 		this.showTimer = window.setTimeout(this.show, 500);
< 	}
---
>   @autobind
>   private onMouseover() {
>     window.clearTimeout(this.showTimer);
>     window.clearTimeout(this.hideTimer);
>     this.showTimer = window.setTimeout(this.show, 500);
>   }
72,77c77,82
< 	@autobind
< 	private onMouseleave() {
< 		window.clearTimeout(this.showTimer);
< 		window.clearTimeout(this.hideTimer);
< 		this.hideTimer = window.setTimeout(this.close, 500);
< 	}
---
>   @autobind
>   private onMouseleave() {
>     window.clearTimeout(this.showTimer);
>     window.clearTimeout(this.hideTimer);
>     this.hideTimer = window.setTimeout(this.close, 500);
>   }
79,83c84,88
< 	@autobind
< 	private onClick() {
< 		window.clearTimeout(this.showTimer);
< 		this.close();
< 	}
---
>   @autobind
>   private onClick() {
>     window.clearTimeout(this.showTimer);
>     this.close();
>   }
85,90c90,95
< 	@autobind
< 	public attach() {
< 		this.el.addEventListener('mouseover', this.onMouseover);
< 		this.el.addEventListener('mouseleave', this.onMouseleave);
< 		this.el.addEventListener('click', this.onClick);
< 	}
---
>   @autobind
>   public attach() {
>     this.el.addEventListener("mouseover", this.onMouseover);
>     this.el.addEventListener("mouseleave", this.onMouseleave);
>     this.el.addEventListener("click", this.onClick);
>   }
92,98c97,103
< 	@autobind
< 	public detach() {
< 		this.el.removeEventListener('mouseover', this.onMouseover);
< 		this.el.removeEventListener('mouseleave', this.onMouseleave);
< 		this.el.removeEventListener('click', this.onClick);
< 		window.clearInterval(this.checkTimer);
< 	}
---
>   @autobind
>   public detach() {
>     this.el.removeEventListener("mouseover", this.onMouseover);
>     this.el.removeEventListener("mouseleave", this.onMouseleave);
>     this.el.removeEventListener("click", this.onClick);
>     window.clearInterval(this.checkTimer);
>   }
102,103c107,108
< 	mounted(el: HTMLElement, binding, vn) {
< 		if (binding.value == null) return;
---
>   mounted(el: HTMLElement, binding, vn) {
>     if (binding.value == null) return;
105,107c110,112
< 		// TODO: 新たにプロパティを作るのをやめMapを使う
< 		// ただメモリ的には↓の方が省メモリかもしれないので検討中
< 		const self = (el as any)._userPreviewDirective_ = {} as any;
---
>     // TODO: 新たにプロパティを作るのをやめMapを使う
>     // ただメモリ的には↓の方が省メモリかもしれないので検討中
>     const self = ((el as any)._userPreviewDirective_ = {} as any);
109,110c114,115
< 		self.preview = new UserPreview(el, binding.value);
< 	},
---
>     self.preview = new UserPreview(el, binding.value);
>   },
112,113c117,118
< 	unmounted(el, binding, vn) {
< 		if (binding.value == null) return;
---
>   unmounted(el, binding, vn) {
>     if (binding.value == null) return;
115,117c120,122
< 		const self = el._userPreviewDirective_;
< 		self.preview.detach();
< 	},
---
>     const self = el._userPreviewDirective_;
>     self.preview.detach();
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/emojilist.json RiricaV13/emojilist.json
2,1783c2,11983
< 	{ "category": "face", "char": "😀", "name": "grinning", "keywords": ["face", "smile", "happy", "joy", ": D", "grin"] },
< 	{ "category": "face", "char": "😬", "name": "grimacing", "keywords": ["face", "grimace", "teeth"] },
< 	{ "category": "face", "char": "😁", "name": "grin", "keywords": ["face", "happy", "smile", "joy", "kawaii"] },
< 	{ "category": "face", "char": "😂", "name": "joy", "keywords": ["face", "cry", "tears", "weep", "happy", "happytears", "haha"] },
< 	{ "category": "face", "char": "🤣", "name": "rofl", "keywords": ["face", "rolling", "floor", "laughing", "lol", "haha"] },
< 	{ "category": "face", "char": "🥳", "name": "partying", "keywords": ["face", "celebration", "woohoo"] },
< 	{ "category": "face", "char": "😃", "name": "smiley", "keywords": ["face", "happy", "joy", "haha", ": D", ": )", "smile", "funny"] },
< 	{ "category": "face", "char": "😄", "name": "smile", "keywords": ["face", "happy", "joy", "funny", "haha", "laugh", "like", ": D", ": )"] },
< 	{ "category": "face", "char": "😅", "name": "sweat_smile", "keywords": ["face", "hot", "happy", "laugh", "sweat", "smile", "relief"] },
< 	{ "category": "face", "char": "🥲", "name": "smiling_face_with_tear", "keywords": ["face"] },
< 	{ "category": "face", "char": "😆", "name": "laughing", "keywords": ["happy", "joy", "lol", "satisfied", "haha", "face", "glad", "XD", "laugh"] },
< 	{ "category": "face", "char": "😇", "name": "innocent", "keywords": ["face", "angel", "heaven", "halo"] },
< 	{ "category": "face", "char": "😉", "name": "wink", "keywords": ["face", "happy", "mischievous", "secret", ";)", "smile", "eye"] },
< 	{ "category": "face", "char": "😊", "name": "blush", "keywords": ["face", "smile", "happy", "flushed", "crush", "embarrassed", "shy", "joy"] },
< 	{ "category": "face", "char": "🙂", "name": "slightly_smiling_face", "keywords": ["face", "smile"] },
< 	{ "category": "face", "char": "🙃", "name": "upside_down_face", "keywords": ["face", "flipped", "silly", "smile"] },
< 	{ "category": "face", "char": "☺️", "name": "relaxed", "keywords": ["face", "blush", "massage", "happiness"] },
< 	{ "category": "face", "char": "😋", "name": "yum", "keywords": ["happy", "joy", "tongue", "smile", "face", "silly", "yummy", "nom", "delicious", "savouring"] },
< 	{ "category": "face", "char": "😌", "name": "relieved", "keywords": ["face", "relaxed", "phew", "massage", "happiness"] },
< 	{ "category": "face", "char": "😍", "name": "heart_eyes", "keywords": ["face", "love", "like", "affection", "valentines", "infatuation", "crush", "heart"] },
< 	{ "category": "face", "char": "🥰", "name": "smiling_face_with_three_hearts", "keywords": ["face", "love", "like", "affection", "valentines", "infatuation", "crush", "hearts", "adore"] },
< 	{ "category": "face", "char": "😘", "name": "kissing_heart", "keywords": ["face", "love", "like", "affection", "valentines", "infatuation", "kiss"] },
< 	{ "category": "face", "char": "😗", "name": "kissing", "keywords": ["love", "like", "face", "3", "valentines", "infatuation", "kiss"] },
< 	{ "category": "face", "char": "😙", "name": "kissing_smiling_eyes", "keywords": ["face", "affection", "valentines", "infatuation", "kiss"] },
< 	{ "category": "face", "char": "😚", "name": "kissing_closed_eyes", "keywords": ["face", "love", "like", "affection", "valentines", "infatuation", "kiss"] },
< 	{ "category": "face", "char": "😜", "name": "stuck_out_tongue_winking_eye", "keywords": ["face", "prank", "childish", "playful", "mischievous", "smile", "wink", "tongue"] },
< 	{ "category": "face", "char": "🤪", "name": "zany", "keywords": ["face", "goofy", "crazy"] },
< 	{ "category": "face", "char": "🤨", "name": "raised_eyebrow", "keywords": ["face", "distrust", "scepticism", "disapproval", "disbelief", "surprise"] },
< 	{ "category": "face", "char": "🧐", "name": "monocle", "keywords": ["face", "stuffy", "wealthy"] },
< 	{ "category": "face", "char": "😝", "name": "stuck_out_tongue_closed_eyes", "keywords": ["face", "prank", "playful", "mischievous", "smile", "tongue"] },
< 	{ "category": "face", "char": "😛", "name": "stuck_out_tongue", "keywords": ["face", "prank", "childish", "playful", "mischievous", "smile", "tongue"] },
< 	{ "category": "face", "char": "🤑", "name": "money_mouth_face", "keywords": ["face", "rich", "dollar", "money"] },
< 	{ "category": "face", "char": "🤓", "name": "nerd_face", "keywords": ["face", "nerdy", "geek", "dork"] },
< 	{ "category": "face", "char": "🥸", "name": "disguised_face", "keywords": ["face", "nose", "glasses", "incognito"] },
< 	{ "category": "face", "char": "😎", "name": "sunglasses", "keywords": ["face", "cool", "smile", "summer", "beach", "sunglass"] },
< 	{ "category": "face", "char": "🤩", "name": "star_struck", "keywords": ["face", "smile", "starry", "eyes", "grinning"] },
< 	{ "category": "face", "char": "🤡", "name": "clown_face", "keywords": ["face"] },
< 	{ "category": "face", "char": "🤠", "name": "cowboy_hat_face", "keywords": ["face", "cowgirl", "hat"] },
< 	{ "category": "face", "char": "🤗", "name": "hugs", "keywords": ["face", "smile", "hug"] },
< 	{ "category": "face", "char": "😏", "name": "smirk", "keywords": ["face", "smile", "mean", "prank", "smug", "sarcasm"] },
< 	{ "category": "face", "char": "😶", "name": "no_mouth", "keywords": ["face", "hellokitty"] },
< 	{ "category": "face", "char": "😐", "name": "neutral_face", "keywords": ["indifference", "meh", ": |", "neutral"] },
< 	{ "category": "face", "char": "😑", "name": "expressionless", "keywords": ["face", "indifferent", "-_-", "meh", "deadpan"] },
< 	{ "category": "face", "char": "😒", "name": "unamused", "keywords": ["indifference", "bored", "straight face", "serious", "sarcasm", "unimpressed", "skeptical", "dubious", "side_eye"] },
< 	{ "category": "face", "char": "🙄", "name": "roll_eyes", "keywords": ["face", "eyeroll", "frustrated"] },
< 	{ "category": "face", "char": "🤔", "name": "thinking", "keywords": ["face", "hmmm", "think", "consider"] },
< 	{ "category": "face", "char": "🤥", "name": "lying_face", "keywords": ["face", "lie", "pinocchio"] },
< 	{ "category": "face", "char": "🤭", "name": "hand_over_mouth", "keywords": ["face", "whoops", "shock", "surprise"] },
< 	{ "category": "face", "char": "🤫", "name": "shushing", "keywords": ["face", "quiet", "shhh"] },
< 	{ "category": "face", "char": "🤬", "name": "symbols_over_mouth", "keywords": ["face", "swearing", "cursing", "cussing", "profanity", "expletive"] },
< 	{ "category": "face", "char": "🤯", "name": "exploding_head", "keywords": ["face", "shocked", "mind", "blown"] },
< 	{ "category": "face", "char": "😳", "name": "flushed", "keywords": ["face", "blush", "shy", "flattered"] },
< 	{ "category": "face", "char": "😞", "name": "disappointed", "keywords": ["face", "sad", "upset", "depressed", ": ("] },
< 	{ "category": "face", "char": "😟", "name": "worried", "keywords": ["face", "concern", "nervous", ": ("] },
< 	{ "category": "face", "char": "😠", "name": "angry", "keywords": ["mad", "face", "annoyed", "frustrated"] },
< 	{ "category": "face", "char": "😡", "name": "rage", "keywords": ["angry", "mad", "hate", "despise"] },
< 	{ "category": "face", "char": "😔", "name": "pensive", "keywords": ["face", "sad", "depressed", "upset"] },
< 	{ "category": "face", "char": "😕", "name": "confused", "keywords": ["face", "indifference", "huh", "weird", "hmmm", ": /"] },
< 	{ "category": "face", "char": "🙁", "name": "slightly_frowning_face", "keywords": ["face", "frowning", "disappointed", "sad", "upset"] },
< 	{ "category": "face", "char": "☹", "name": "frowning_face", "keywords": ["face", "sad", "upset", "frown"] },
< 	{ "category": "face", "char": "😣", "name": "persevere", "keywords": ["face", "sick", "no", "upset", "oops"] },
< 	{ "category": "face", "char": "😖", "name": "confounded", "keywords": ["face", "confused", "sick", "unwell", "oops", ": S"] },
< 	{ "category": "face", "char": "😫", "name": "tired_face", "keywords": ["sick", "whine", "upset", "frustrated"] },
< 	{ "category": "face", "char": "😩", "name": "weary", "keywords": ["face", "tired", "sleepy", "sad", "frustrated", "upset"] },
< 	{ "category": "face", "char": "🥺", "name": "pleading", "keywords": ["face", "begging", "mercy"] },
< 	{ "category": "face", "char": "😤", "name": "triumph", "keywords": ["face", "gas", "phew", "proud", "pride"] },
< 	{ "category": "face", "char": "😮", "name": "open_mouth", "keywords": ["face", "surprise", "impressed", "wow", "whoa", ": O"] },
< 	{ "category": "face", "char": "😱", "name": "scream", "keywords": ["face", "munch", "scared", "omg"] },
< 	{ "category": "face", "char": "😨", "name": "fearful", "keywords": ["face", "scared", "terrified", "nervous", "oops", "huh"] },
< 	{ "category": "face", "char": "😰", "name": "cold_sweat", "keywords": ["face", "nervous", "sweat"] },
< 	{ "category": "face", "char": "😯", "name": "hushed", "keywords": ["face", "woo", "shh"] },
< 	{ "category": "face", "char": "😦", "name": "frowning", "keywords": ["face", "aw", "what"] },
< 	{ "category": "face", "char": "😧", "name": "anguished", "keywords": ["face", "stunned", "nervous"] },
< 	{ "category": "face", "char": "😢", "name": "cry", "keywords": ["face", "tears", "sad", "depressed", "upset", ": '("] },
< 	{ "category": "face", "char": "😥", "name": "disappointed_relieved", "keywords": ["face", "phew", "sweat", "nervous"] },
< 	{ "category": "face", "char": "🤤", "name": "drooling_face", "keywords": ["face"] },
< 	{ "category": "face", "char": "😪", "name": "sleepy", "keywords": ["face", "tired", "rest", "nap"] },
< 	{ "category": "face", "char": "😓", "name": "sweat", "keywords": ["face", "hot", "sad", "tired", "exercise"] },
< 	{ "category": "face", "char": "🥵", "name": "hot", "keywords": ["face", "feverish", "heat", "red", "sweating"] },
< 	{ "category": "face", "char": "🥶", "name": "cold", "keywords": ["face", "blue", "freezing", "frozen", "frostbite", "icicles"] },
< 	{ "category": "face", "char": "😭", "name": "sob", "keywords": ["face", "cry", "tears", "sad", "upset", "depressed"] },
< 	{ "category": "face", "char": "😵", "name": "dizzy_face", "keywords": ["spent", "unconscious", "xox", "dizzy"] },
< 	{ "category": "face", "char": "😲", "name": "astonished", "keywords": ["face", "xox", "surprised", "poisoned"] },
< 	{ "category": "face", "char": "🤐", "name": "zipper_mouth_face", "keywords": ["face", "sealed", "zipper", "secret"] },
< 	{ "category": "face", "char": "🤢", "name": "nauseated_face", "keywords": ["face", "vomit", "gross", "green", "sick", "throw up", "ill"] },
< 	{ "category": "face", "char": "🤧", "name": "sneezing_face", "keywords": ["face", "gesundheit", "sneeze", "sick", "allergy"] },
< 	{ "category": "face", "char": "🤮", "name": "vomiting", "keywords": ["face", "sick"] },
< 	{ "category": "face", "char": "😷", "name": "mask", "keywords": ["face", "sick", "ill", "disease"] },
< 	{ "category": "face", "char": "🤒", "name": "face_with_thermometer", "keywords": ["sick", "temperature", "thermometer", "cold", "fever"] },
< 	{ "category": "face", "char": "🤕", "name": "face_with_head_bandage", "keywords": ["injured", "clumsy", "bandage", "hurt"] },
< 	{ "category": "face", "char": "🥴", "name": "woozy", "keywords": ["face", "dizzy", "intoxicated", "tipsy", "wavy"] },
< 	{ "category": "face", "char": "🥱", "name": "yawning", "keywords": ["face", "tired", "yawning"] },
< 	{ "category": "face", "char": "😴", "name": "sleeping", "keywords": ["face", "tired", "sleepy", "night", "zzz"] },
< 	{ "category": "face", "char": "💤", "name": "zzz", "keywords": ["sleepy", "tired", "dream"] },
< 	{ "category": "face", "char": "\uD83D\uDE36\u200D\uD83C\uDF2B\uFE0F", "name": "face_in_clouds", "keywords": [] },
< 	{ "category": "face", "char": "\uD83D\uDE2E\u200D\uD83D\uDCA8", "name": "face_exhaling", "keywords": [] },
< 	{ "category": "face", "char": "\uD83D\uDE35\u200D\uD83D\uDCAB", "name": "face_with_spiral_eyes", "keywords": [] },
< 	{ "category": "face", "char": "\uD83E\uDEE0", "name": "melting_face", "keywords": ["disappear", "dissolve", "liquid", "melt", "toketa"] },
< 	{ "category": "face", "char": "\uD83E\uDEE2", "name": "face_with_open_eyes_and_hand_over_mouth", "keywords": ["amazement", "awe", "disbelief", "embarrass", "scared", "surprise", "ohoho"] },
< 	{ "category": "face", "char": "\uD83E\uDEE3", "name": "face_with_peeking_eye", "keywords": ["captivated", "peep", "stare", "chunibyo"] },
< 	{ "category": "face", "char": "\uD83E\uDEE1", "name": "saluting_face", "keywords": ["ok", "salute", "sunny", "troops", "yes", "raja"] },
< 	{ "category": "face", "char": "\uD83E\uDEE5", "name": "dotted_line_face", "keywords": ["depressed", "disappear", "hide", "introvert", "invisible", "tensen"] },
< 	{ "category": "face", "char": "\uD83E\uDEE4", "name": "face_with_diagonal_mouth", "keywords": ["disappointed", "meh", "skeptical", "unsure"] },
< 	{ "category": "face", "char": "\uD83E\uDD79", "name": "face_holding_back_tears", "keywords": ["angry", "cry", "proud", "resist", "sad"] },
< 	{ "category": "face", "char": "💩", "name": "poop", "keywords": ["hankey", "shitface", "fail", "turd", "shit"] },
< 	{ "category": "face", "char": "😈", "name": "smiling_imp", "keywords": ["devil", "horns"] },
< 	{ "category": "face", "char": "👿", "name": "imp", "keywords": ["devil", "angry", "horns"] },
< 	{ "category": "face", "char": "👹", "name": "japanese_ogre", "keywords": ["monster", "red", "mask", "halloween", "scary", "creepy", "devil", "demon", "japanese", "ogre"] },
< 	{ "category": "face", "char": "👺", "name": "japanese_goblin", "keywords": ["red", "evil", "mask", "monster", "scary", "creepy", "japanese", "goblin"] },
< 	{ "category": "face", "char": "💀", "name": "skull", "keywords": ["dead", "skeleton", "creepy", "death"] },
< 	{ "category": "face", "char": "👻", "name": "ghost", "keywords": ["halloween", "spooky", "scary"] },
< 	{ "category": "face", "char": "👽", "name": "alien", "keywords": ["UFO", "paul", "weird", "outer_space"] },
< 	{ "category": "face", "char": "🤖", "name": "robot", "keywords": ["computer", "machine", "bot"] },
< 	{ "category": "face", "char": "😺", "name": "smiley_cat", "keywords": ["animal", "cats", "happy", "smile"] },
< 	{ "category": "face", "char": "😸", "name": "smile_cat", "keywords": ["animal", "cats", "smile"] },
< 	{ "category": "face", "char": "😹", "name": "joy_cat", "keywords": ["animal", "cats", "haha", "happy", "tears"] },
< 	{ "category": "face", "char": "😻", "name": "heart_eyes_cat", "keywords": ["animal", "love", "like", "affection", "cats", "valentines", "heart"] },
< 	{ "category": "face", "char": "😼", "name": "smirk_cat", "keywords": ["animal", "cats", "smirk"] },
< 	{ "category": "face", "char": "😽", "name": "kissing_cat", "keywords": ["animal", "cats", "kiss"] },
< 	{ "category": "face", "char": "🙀", "name": "scream_cat", "keywords": ["animal", "cats", "munch", "scared", "scream"] },
< 	{ "category": "face", "char": "😿", "name": "crying_cat_face", "keywords": ["animal", "tears", "weep", "sad", "cats", "upset", "cry"] },
< 	{ "category": "face", "char": "😾", "name": "pouting_cat", "keywords": ["animal", "cats"] },
< 	{ "category": "people", "char": "🤲", "name": "palms_up", "keywords": ["hands", "gesture", "cupped", "prayer"] },
< 	{ "category": "people", "char": "🙌", "name": "raised_hands", "keywords": ["gesture", "hooray", "yea", "celebration", "hands"] },
< 	{ "category": "people", "char": "👏", "name": "clap", "keywords": ["hands", "praise", "applause", "congrats", "yay"] },
< 	{ "category": "people", "char": "👋", "name": "wave", "keywords": ["hands", "gesture", "goodbye", "solong", "farewell", "hello", "hi", "palm"] },
< 	{ "category": "people", "char": "🤙", "name": "call_me_hand", "keywords": ["hands", "gesture"] },
< 	{ "category": "people", "char": "👍", "name": "+1", "keywords": ["thumbsup", "yes", "awesome", "good", "agree", "accept", "cool", "hand", "like"] },
< 	{ "category": "people", "char": "👎", "name": "-1", "keywords": ["thumbsdown", "no", "dislike", "hand"] },
< 	{ "category": "people", "char": "👊", "name": "facepunch", "keywords": ["angry", "violence", "fist", "hit", "attack", "hand"] },
< 	{ "category": "people", "char": "✊", "name": "fist", "keywords": ["fingers", "hand", "grasp"] },
< 	{ "category": "people", "char": "🤛", "name": "fist_left", "keywords": ["hand", "fistbump"] },
< 	{ "category": "people", "char": "🤜", "name": "fist_right", "keywords": ["hand", "fistbump"] },
< 	{ "category": "people", "char": "✌", "name": "v", "keywords": ["fingers", "ohyeah", "hand", "peace", "victory", "two"] },
< 	{ "category": "people", "char": "👌", "name": "ok_hand", "keywords": ["fingers", "limbs", "perfect", "ok", "okay"] },
< 	{ "category": "people", "char": "✋", "name": "raised_hand", "keywords": ["fingers", "stop", "highfive", "palm", "ban"] },
< 	{ "category": "people", "char": "🤚", "name": "raised_back_of_hand", "keywords": ["fingers", "raised", "backhand"] },
< 	{ "category": "people", "char": "👐", "name": "open_hands", "keywords": ["fingers", "butterfly", "hands", "open"] },
< 	{ "category": "people", "char": "💪", "name": "muscle", "keywords": ["arm", "flex", "hand", "summer", "strong", "biceps"] },
< 	{ "category": "people", "char": "🦾", "name": "mechanical_arm", "keywords": ["flex", "hand", "strong", "biceps"] },
< 	{ "category": "people", "char": "🙏", "name": "pray", "keywords": ["please", "hope", "wish", "namaste", "highfive"] },
< 	{ "category": "people", "char": "🦶", "name": "foot", "keywords": ["kick", "stomp"] },
< 	{ "category": "people", "char": "🦵", "name": "leg", "keywords": ["kick", "limb"] },
< 	{ "category": "people", "char": "🦿", "name": "mechanical_leg", "keywords": ["kick", "limb"] },
< 	{ "category": "people", "char": "🤝", "name": "handshake", "keywords": ["agreement", "shake"] },
< 	{ "category": "people", "char": "☝", "name": "point_up", "keywords": ["hand", "fingers", "direction", "up"] },
< 	{ "category": "people", "char": "👆", "name": "point_up_2", "keywords": ["fingers", "hand", "direction", "up"] },
< 	{ "category": "people", "char": "👇", "name": "point_down", "keywords": ["fingers", "hand", "direction", "down"] },
< 	{ "category": "people", "char": "👈", "name": "point_left", "keywords": ["direction", "fingers", "hand", "left"] },
< 	{ "category": "people", "char": "👉", "name": "point_right", "keywords": ["fingers", "hand", "direction", "right"] },
< 	{ "category": "people", "char": "🖕", "name": "fu", "keywords": ["hand", "fingers", "rude", "middle", "flipping"] },
< 	{ "category": "people", "char": "🖐", "name": "raised_hand_with_fingers_splayed", "keywords": ["hand", "fingers", "palm"] },
< 	{ "category": "people", "char": "🤟", "name": "love_you", "keywords": ["hand", "fingers", "gesture"] },
< 	{ "category": "people", "char": "🤘", "name": "metal", "keywords": ["hand", "fingers", "evil_eye", "sign_of_horns", "rock_on"] },
< 	{ "category": "people", "char": "🤞", "name": "crossed_fingers", "keywords": ["good", "lucky"] },
< 	{ "category": "people", "char": "🖖", "name": "vulcan_salute", "keywords": ["hand", "fingers", "spock", "star trek"] },
< 	{ "category": "people", "char": "✍", "name": "writing_hand", "keywords": ["lower_left_ballpoint_pen", "stationery", "write", "compose"] },
< 	{ "category": "people", "char": "\uD83E\uDEF0", "name": "hand_with_index_finger_and_thumb_crossed", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF1", "name": "rightwards_hand", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF2", "name": "leftwards_hand", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF3", "name": "palm_down_hand", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF4", "name": "palm_up_hand", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF5", "name": "index_pointing_at_the_viewer", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEF6", "name": "heart_hands", "keywords": ["moemoekyun"] },
< 	{ "category": "people", "char": "🤏", "name": "pinching_hand", "keywords": ["hand", "fingers"] },
< 	{ "category": "people", "char": "🤌", "name": "pinched_fingers", "keywords": ["hand", "fingers"] },
< 	{ "category": "people", "char": "🤳", "name": "selfie", "keywords": ["camera", "phone"] },
< 	{ "category": "people", "char": "💅", "name": "nail_care", "keywords": ["beauty", "manicure", "finger", "fashion", "nail"] },
< 	{ "category": "people", "char": "👄", "name": "lips", "keywords": ["mouth", "kiss"] },
< 	{ "category": "people", "char": "\uD83E\uDEE6", "name": "biting_lip", "keywords": [] },
< 	{ "category": "people", "char": "🦷", "name": "tooth", "keywords": ["teeth", "dentist"] },
< 	{ "category": "people", "char": "👅", "name": "tongue", "keywords": ["mouth", "playful"] },
< 	{ "category": "people", "char": "👂", "name": "ear", "keywords": ["face", "hear", "sound", "listen"] },
< 	{ "category": "people", "char": "🦻", "name": "ear_with_hearing_aid", "keywords": ["face", "hear", "sound", "listen"] },
< 	{ "category": "people", "char": "👃", "name": "nose", "keywords": ["smell", "sniff"] },
< 	{ "category": "people", "char": "👁", "name": "eye", "keywords": ["face", "look", "see", "watch", "stare"] },
< 	{ "category": "people", "char": "👀", "name": "eyes", "keywords": ["look", "watch", "stalk", "peek", "see"] },
< 	{ "category": "people", "char": "🧠", "name": "brain", "keywords": ["smart", "intelligent"] },
< 	{ "category": "people", "char": "🫀", "name": "anatomical_heart", "keywords": [] },
< 	{ "category": "people", "char": "🫁", "name": "lungs", "keywords": [] },
< 	{ "category": "people", "char": "👤", "name": "bust_in_silhouette", "keywords": ["user", "person", "human"] },
< 	{ "category": "people", "char": "👥", "name": "busts_in_silhouette", "keywords": ["user", "person", "human", "group", "team"] },
< 	{ "category": "people", "char": "🗣", "name": "speaking_head", "keywords": ["user", "person", "human", "sing", "say", "talk"] },
< 	{ "category": "people", "char": "👶", "name": "baby", "keywords": ["child", "boy", "girl", "toddler"] },
< 	{ "category": "people", "char": "🧒", "name": "child", "keywords": ["gender-neutral", "young"] },
< 	{ "category": "people", "char": "👦", "name": "boy", "keywords": ["man", "male", "guy", "teenager"] },
< 	{ "category": "people", "char": "👧", "name": "girl", "keywords": ["female", "woman", "teenager"] },
< 	{ "category": "people", "char": "🧑", "name": "adult", "keywords": ["gender-neutral", "person"] },
< 	{ "category": "people", "char": "👨", "name": "man", "keywords": ["mustache", "father", "dad", "guy", "classy", "sir", "moustache"] },
< 	{ "category": "people", "char": "👩", "name": "woman", "keywords": ["female", "girls", "lady"] },
< 	{ "category": "people", "char": "🧑‍🦱", "name": "curly_hair", "keywords": ["curly", "afro", "braids", "ringlets"] },
< 	{ "category": "people", "char": "👩‍🦱", "name": "curly_hair_woman", "keywords": ["woman", "female", "girl", "curly", "afro", "braids", "ringlets"] },
< 	{ "category": "people", "char": "👨‍🦱", "name": "curly_hair_man", "keywords": ["man", "male", "boy", "guy", "curly", "afro", "braids", "ringlets"] },
< 	{ "category": "people", "char": "🧑‍🦰", "name": "red_hair", "keywords": ["redhead"] },
< 	{ "category": "people", "char": "👩‍🦰", "name": "red_hair_woman", "keywords": ["woman", "female", "girl", "ginger", "redhead"] },
< 	{ "category": "people", "char": "👨‍🦰", "name": "red_hair_man", "keywords": ["man", "male", "boy", "guy", "ginger", "redhead"] },
< 	{ "category": "people", "char": "👱‍♀️", "name": "blonde_woman", "keywords": ["woman", "female", "girl", "blonde", "person"] },
< 	{ "category": "people", "char": "👱", "name": "blonde_man", "keywords": ["man", "male", "boy", "blonde", "guy", "person"] },
< 	{ "category": "people", "char": "🧑‍🦳", "name": "white_hair", "keywords": ["gray", "old", "white"] },
< 	{ "category": "people", "char": "👩‍🦳", "name": "white_hair_woman", "keywords": ["woman", "female", "girl", "gray", "old", "white"] },
< 	{ "category": "people", "char": "👨‍🦳", "name": "white_hair_man", "keywords": ["man", "male", "boy", "guy", "gray", "old", "white"] },
< 	{ "category": "people", "char": "🧑‍🦲", "name": "bald", "keywords": ["bald", "chemotherapy", "hairless", "shaven"] },
< 	{ "category": "people", "char": "👩‍🦲", "name": "bald_woman", "keywords": ["woman", "female", "girl", "bald", "chemotherapy", "hairless", "shaven"] },
< 	{ "category": "people", "char": "👨‍🦲", "name": "bald_man", "keywords": ["man", "male", "boy", "guy", "bald", "chemotherapy", "hairless", "shaven"] },
< 	{ "category": "people", "char": "🧔", "name": "bearded_person", "keywords": ["person", "bewhiskered"] },
< 	{ "category": "people", "char": "🧓", "name": "older_adult", "keywords": ["human", "elder", "senior", "gender-neutral"] },
< 	{ "category": "people", "char": "👴", "name": "older_man", "keywords": ["human", "male", "men", "old", "elder", "senior"] },
< 	{ "category": "people", "char": "👵", "name": "older_woman", "keywords": ["human", "female", "women", "lady", "old", "elder", "senior"] },
< 	{ "category": "people", "char": "👲", "name": "man_with_gua_pi_mao", "keywords": ["male", "boy", "chinese"] },
< 	{ "category": "people", "char": "🧕", "name": "woman_with_headscarf", "keywords": ["female", "hijab", "mantilla", "tichel"] },
< 	{ "category": "people", "char": "👳‍♀️", "name": "woman_with_turban", "keywords": ["female", "indian", "hinduism", "arabs", "woman"] },
< 	{ "category": "people", "char": "👳", "name": "man_with_turban", "keywords": ["male", "indian", "hinduism", "arabs"] },
< 	{ "category": "people", "char": "👮‍♀️", "name": "policewoman", "keywords": ["woman", "police", "law", "legal", "enforcement", "arrest", "911", "female"] },
< 	{ "category": "people", "char": "👮", "name": "policeman", "keywords": ["man", "police", "law", "legal", "enforcement", "arrest", "911"] },
< 	{ "category": "people", "char": "👷‍♀️", "name": "construction_worker_woman", "keywords": ["female", "human", "wip", "build", "construction", "worker", "labor", "woman"] },
< 	{ "category": "people", "char": "👷", "name": "construction_worker_man", "keywords": ["male", "human", "wip", "guy", "build", "construction", "worker", "labor"] },
< 	{ "category": "people", "char": "💂‍♀️", "name": "guardswoman", "keywords": ["uk", "gb", "british", "female", "royal", "woman"] },
< 	{ "category": "people", "char": "💂", "name": "guardsman", "keywords": ["uk", "gb", "british", "male", "guy", "royal"] },
< 	{ "category": "people", "char": "🕵️‍♀️", "name": "female_detective", "keywords": ["human", "spy", "detective", "female", "woman"] },
< 	{ "category": "people", "char": "🕵", "name": "male_detective", "keywords": ["human", "spy", "detective"] },
< 	{ "category": "people", "char": "🧑‍⚕️", "name": "health_worker", "keywords": ["doctor", "nurse", "therapist", "healthcare", "human"] },
< 	{ "category": "people", "char": "👩‍⚕️", "name": "woman_health_worker", "keywords": ["doctor", "nurse", "therapist", "healthcare", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍⚕️", "name": "man_health_worker", "keywords": ["doctor", "nurse", "therapist", "healthcare", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🌾", "name": "farmer", "keywords": ["rancher", "gardener", "human"] },
< 	{ "category": "people", "char": "👩‍🌾", "name": "woman_farmer", "keywords": ["rancher", "gardener", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🌾", "name": "man_farmer", "keywords": ["rancher", "gardener", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🍳", "name": "cook", "keywords": ["chef", "human"] },
< 	{ "category": "people", "char": "👩‍🍳", "name": "woman_cook", "keywords": ["chef", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🍳", "name": "man_cook", "keywords": ["chef", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🎓", "name": "student", "keywords": ["graduate", "human"] },
< 	{ "category": "people", "char": "👩‍🎓", "name": "woman_student", "keywords": ["graduate", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🎓", "name": "man_student", "keywords": ["graduate", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🎤", "name": "singer", "keywords": ["rockstar", "entertainer", "human"] },
< 	{ "category": "people", "char": "👩‍🎤", "name": "woman_singer", "keywords": ["rockstar", "entertainer", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🎤", "name": "man_singer", "keywords": ["rockstar", "entertainer", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🏫", "name": "teacher", "keywords": ["instructor", "professor", "human"] },
< 	{ "category": "people", "char": "👩‍🏫", "name": "woman_teacher", "keywords": ["instructor", "professor", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🏫", "name": "man_teacher", "keywords": ["instructor", "professor", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🏭", "name": "factory_worker", "keywords": ["assembly", "industrial", "human"] },
< 	{ "category": "people", "char": "👩‍🏭", "name": "woman_factory_worker", "keywords": ["assembly", "industrial", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🏭", "name": "man_factory_worker", "keywords": ["assembly", "industrial", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍💻", "name": "technologist", "keywords": ["coder", "developer", "engineer", "programmer", "software", "human", "laptop", "computer"] },
< 	{ "category": "people", "char": "👩‍💻", "name": "woman_technologist", "keywords": ["coder", "developer", "engineer", "programmer", "software", "woman", "human", "laptop", "computer"] },
< 	{ "category": "people", "char": "👨‍💻", "name": "man_technologist", "keywords": ["coder", "developer", "engineer", "programmer", "software", "man", "human", "laptop", "computer"] },
< 	{ "category": "people", "char": "🧑‍💼", "name": "office_worker", "keywords": ["business", "manager", "human"] },
< 	{ "category": "people", "char": "👩‍💼", "name": "woman_office_worker", "keywords": ["business", "manager", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍💼", "name": "man_office_worker", "keywords": ["business", "manager", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🔧", "name": "mechanic", "keywords": ["plumber", "human", "wrench"] },
< 	{ "category": "people", "char": "👩‍🔧", "name": "woman_mechanic", "keywords": ["plumber", "woman", "human", "wrench"] },
< 	{ "category": "people", "char": "👨‍🔧", "name": "man_mechanic", "keywords": ["plumber", "man", "human", "wrench"] },
< 	{ "category": "people", "char": "🧑‍🔬", "name": "scientist", "keywords": ["biologist", "chemist", "engineer", "physicist", "human"] },
< 	{ "category": "people", "char": "👩‍🔬", "name": "woman_scientist", "keywords": ["biologist", "chemist", "engineer", "physicist", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🔬", "name": "man_scientist", "keywords": ["biologist", "chemist", "engineer", "physicist", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🎨", "name": "artist", "keywords": ["painter", "human"] },
< 	{ "category": "people", "char": "👩‍🎨", "name": "woman_artist", "keywords": ["painter", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🎨", "name": "man_artist", "keywords": ["painter", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🚒", "name": "firefighter", "keywords": ["fireman", "human"] },
< 	{ "category": "people", "char": "👩‍🚒", "name": "woman_firefighter", "keywords": ["fireman", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🚒", "name": "man_firefighter", "keywords": ["fireman", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍✈️", "name": "pilot", "keywords": ["aviator", "plane", "human"] },
< 	{ "category": "people", "char": "👩‍✈️", "name": "woman_pilot", "keywords": ["aviator", "plane", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍✈️", "name": "man_pilot", "keywords": ["aviator", "plane", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍🚀", "name": "astronaut", "keywords": ["space", "rocket", "human"] },
< 	{ "category": "people", "char": "👩‍🚀", "name": "woman_astronaut", "keywords": ["space", "rocket", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍🚀", "name": "man_astronaut", "keywords": ["space", "rocket", "man", "human"] },
< 	{ "category": "people", "char": "🧑‍⚖️", "name": "judge", "keywords": ["justice", "court", "human"] },
< 	{ "category": "people", "char": "👩‍⚖️", "name": "woman_judge", "keywords": ["justice", "court", "woman", "human"] },
< 	{ "category": "people", "char": "👨‍⚖️", "name": "man_judge", "keywords": ["justice", "court", "man", "human"] },
< 	{ "category": "people", "char": "🦸‍♀️", "name": "woman_superhero", "keywords": ["woman", "female", "good", "heroine", "superpowers"] },
< 	{ "category": "people", "char": "🦸‍♂️", "name": "man_superhero", "keywords": ["man", "male", "good", "hero", "superpowers"] },
< 	{ "category": "people", "char": "🦹‍♀️", "name": "woman_supervillain", "keywords": ["woman", "female", "evil", "bad", "criminal", "heroine", "superpowers"] },
< 	{ "category": "people", "char": "🦹‍♂️", "name": "man_supervillain", "keywords": ["man", "male", "evil", "bad", "criminal", "hero", "superpowers"] },
< 	{ "category": "people", "char": "🤶", "name": "mrs_claus", "keywords": ["woman", "female", "xmas", "mother christmas"] },
< 	{ "category": "people", "char": "\uD83E\uDDD1\u200D\uD83C\uDF84", "name": "mx_claus", "keywords": ["xmas", "christmas"] },
< 	{ "category": "people", "char": "🎅", "name": "santa", "keywords": ["festival", "man", "male", "xmas", "father christmas"] },
< 	{ "category": "people", "char": "🥷", "name": "ninja", "keywords": [] },
< 	{ "category": "people", "char": "🧙‍♀️", "name": "sorceress", "keywords": ["woman", "female", "mage", "witch"] },
< 	{ "category": "people", "char": "🧙‍♂️", "name": "wizard", "keywords": ["man", "male", "mage", "sorcerer"] },
< 	{ "category": "people", "char": "🧝‍♀️", "name": "woman_elf", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧝‍♂️", "name": "man_elf", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "🧛‍♀️", "name": "woman_vampire", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧛‍♂️", "name": "man_vampire", "keywords": ["man", "male", "dracula"] },
< 	{ "category": "people", "char": "🧟‍♀️", "name": "woman_zombie", "keywords": ["woman", "female", "undead", "walking dead"] },
< 	{ "category": "people", "char": "🧟‍♂️", "name": "man_zombie", "keywords": ["man", "male", "dracula", "undead", "walking dead"] },
< 	{ "category": "people", "char": "🧞‍♀️", "name": "woman_genie", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧞‍♂️", "name": "man_genie", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "🧜‍♀️", "name": "mermaid", "keywords": ["woman", "female", "merwoman", "ariel"] },
< 	{ "category": "people", "char": "🧜‍♂️", "name": "merman", "keywords": ["man", "male", "triton"] },
< 	{ "category": "people", "char": "🧚‍♀️", "name": "woman_fairy", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧚‍♂️", "name": "man_fairy", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "👼", "name": "angel", "keywords": ["heaven", "wings", "halo"] },
< 	{ "category": "people", "char": "\uD83E\uDDCC", "name": "troll", "keywords": [] },
< 	{ "category": "people", "char": "🤰", "name": "pregnant_woman", "keywords": ["baby"] },
< 	{ "category": "people", "char": "\uD83E\uDEC3", "name": "pregnant_man", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEC4", "name": "pregnant_person", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDEC5", "name": "person_with_crown", "keywords": [] },
< 	{ "category": "people", "char": "🤱", "name": "breastfeeding", "keywords": ["nursing", "baby"] },
< 	{ "category": "people", "char": "\uD83D\uDC69\u200D\uD83C\uDF7C", "name": "woman_feeding_baby", "keywords": [] },
< 	{ "category": "people", "char": "\uD83D\uDC68\u200D\uD83C\uDF7C", "name": "man_feeding_baby", "keywords": [] },
< 	{ "category": "people", "char": "\uD83E\uDDD1\u200D\uD83C\uDF7C", "name": "person_feeding_baby", "keywords": [] },
< 	{ "category": "people", "char": "👸", "name": "princess", "keywords": ["girl", "woman", "female", "blond", "crown", "royal", "queen"] },
< 	{ "category": "people", "char": "🤴", "name": "prince", "keywords": ["boy", "man", "male", "crown", "royal", "king"] },
< 	{ "category": "people", "char": "👰", "name": "person_with_veil", "keywords": ["couple", "marriage", "wedding", "woman", "bride"] },
< 	{ "category": "people", "char": "👰", "name": "bride_with_veil", "keywords": ["couple", "marriage", "wedding", "woman", "bride"] },
< 	{ "category": "people", "char": "🤵", "name": "person_in_tuxedo", "keywords": ["couple", "marriage", "wedding", "groom"] },
< 	{ "category": "people", "char": "🤵", "name": "man_in_tuxedo", "keywords": ["couple", "marriage", "wedding", "groom"] },
< 	{ "category": "people", "char": "🏃‍♀️", "name": "running_woman", "keywords": ["woman", "walking", "exercise", "race", "running", "female"] },
< 	{ "category": "people", "char": "🏃", "name": "running_man", "keywords": ["man", "walking", "exercise", "race", "running"] },
< 	{ "category": "people", "char": "🚶‍♀️", "name": "walking_woman", "keywords": ["human", "feet", "steps", "woman", "female"] },
< 	{ "category": "people", "char": "🚶", "name": "walking_man", "keywords": ["human", "feet", "steps"] },
< 	{ "category": "people", "char": "💃", "name": "dancer", "keywords": ["female", "girl", "woman", "fun"] },
< 	{ "category": "people", "char": "🕺", "name": "man_dancing", "keywords": ["male", "boy", "fun", "dancer"] },
< 	{ "category": "people", "char": "👯", "name": "dancing_women", "keywords": ["female", "bunny", "women", "girls"] },
< 	{ "category": "people", "char": "👯‍♂️", "name": "dancing_men", "keywords": ["male", "bunny", "men", "boys"] },
< 	{ "category": "people", "char": "👫", "name": "couple", "keywords": ["pair", "people", "human", "love", "date", "dating", "like", "affection", "valentines", "marriage"] },
< 	{ "category": "people", "char": "\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1", "name": "people_holding_hands", "keywords": ["pair", "couple", "love", "like", "bromance", "friendship", "people", "human"] },
< 	{ "category": "people", "char": "👬", "name": "two_men_holding_hands", "keywords": ["pair", "couple", "love", "like", "bromance", "friendship", "people", "man", "human"] },
< 	{ "category": "people", "char": "👭", "name": "two_women_holding_hands", "keywords": ["pair", "couple", "love", "like", "bromance", "friendship", "people", "female", "human"] },
< 	{ "category": "people", "char": "🫂", "name": "people_hugging", "keywords": [] },
< 	{ "category": "people", "char": "🙇‍♀️", "name": "bowing_woman", "keywords": ["woman", "female", "girl"] },
< 	{ "category": "people", "char": "🙇", "name": "bowing_man", "keywords": ["man", "male", "boy"] },
< 	{ "category": "people", "char": "🤦‍♂️", "name": "man_facepalming", "keywords": ["man", "male", "boy", "disbelief"] },
< 	{ "category": "people", "char": "🤦‍♀️", "name": "woman_facepalming", "keywords": ["woman", "female", "girl", "disbelief"] },
< 	{ "category": "people", "char": "🤷", "name": "woman_shrugging", "keywords": ["woman", "female", "girl", "confused", "indifferent", "doubt"] },
< 	{ "category": "people", "char": "🤷‍♂️", "name": "man_shrugging", "keywords": ["man", "male", "boy", "confused", "indifferent", "doubt"] },
< 	{ "category": "people", "char": "💁", "name": "tipping_hand_woman", "keywords": ["female", "girl", "woman", "human", "information"] },
< 	{ "category": "people", "char": "💁‍♂️", "name": "tipping_hand_man", "keywords": ["male", "boy", "man", "human", "information"] },
< 	{ "category": "people", "char": "🙅", "name": "no_good_woman", "keywords": ["female", "girl", "woman", "nope"] },
< 	{ "category": "people", "char": "🙅‍♂️", "name": "no_good_man", "keywords": ["male", "boy", "man", "nope"] },
< 	{ "category": "people", "char": "🙆", "name": "ok_woman", "keywords": ["women", "girl", "female", "pink", "human", "woman"] },
< 	{ "category": "people", "char": "🙆‍♂️", "name": "ok_man", "keywords": ["men", "boy", "male", "blue", "human", "man"] },
< 	{ "category": "people", "char": "🙋", "name": "raising_hand_woman", "keywords": ["female", "girl", "woman"] },
< 	{ "category": "people", "char": "🙋‍♂️", "name": "raising_hand_man", "keywords": ["male", "boy", "man"] },
< 	{ "category": "people", "char": "🙎", "name": "pouting_woman", "keywords": ["female", "girl", "woman"] },
< 	{ "category": "people", "char": "🙎‍♂️", "name": "pouting_man", "keywords": ["male", "boy", "man"] },
< 	{ "category": "people", "char": "🙍", "name": "frowning_woman", "keywords": ["female", "girl", "woman", "sad", "depressed", "discouraged", "unhappy"] },
< 	{ "category": "people", "char": "🙍‍♂️", "name": "frowning_man", "keywords": ["male", "boy", "man", "sad", "depressed", "discouraged", "unhappy"] },
< 	{ "category": "people", "char": "💇", "name": "haircut_woman", "keywords": ["female", "girl", "woman"] },
< 	{ "category": "people", "char": "💇‍♂️", "name": "haircut_man", "keywords": ["male", "boy", "man"] },
< 	{ "category": "people", "char": "💆", "name": "massage_woman", "keywords": ["female", "girl", "woman", "head"] },
< 	{ "category": "people", "char": "💆‍♂️", "name": "massage_man", "keywords": ["male", "boy", "man", "head"] },
< 	{ "category": "people", "char": "🧖‍♀️", "name": "woman_in_steamy_room", "keywords": ["female", "woman", "spa", "steamroom", "sauna"] },
< 	{ "category": "people", "char": "🧖‍♂️", "name": "man_in_steamy_room", "keywords": ["male", "man", "spa", "steamroom", "sauna"] },
< 	{ "category": "people", "char": "🧏‍♀️", "name": "woman_deaf", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧏‍♂️", "name": "man_deaf", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "🧍‍♀️", "name": "woman_standing", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧍‍♂️", "name": "man_standing", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "🧎‍♀️", "name": "woman_kneeling", "keywords": ["woman", "female"] },
< 	{ "category": "people", "char": "🧎‍♂️", "name": "man_kneeling", "keywords": ["man", "male"] },
< 	{ "category": "people", "char": "🧑‍🦯", "name": "person_with_probing_cane", "keywords": ["accessibility", "blind"] },
< 	{ "category": "people", "char": "👩‍🦯", "name": "woman_with_probing_cane", "keywords": ["woman", "female", "accessibility", "blind"] },
< 	{ "category": "people", "char": "👨‍🦯", "name": "man_with_probing_cane", "keywords": ["man", "male", "accessibility", "blind"] },
< 	{ "category": "people", "char": "🧑‍🦼", "name": "person_in_motorized_wheelchair", "keywords": ["accessibility"] },
< 	{ "category": "people", "char": "👩‍🦼", "name": "woman_in_motorized_wheelchair", "keywords": ["woman", "female", "accessibility"] },
< 	{ "category": "people", "char": "👨‍🦼", "name": "man_in_motorized_wheelchair", "keywords": ["man", "male", "accessibility"] },
< 	{ "category": "people", "char": "🧑‍🦽", "name": "person_in_manual_wheelchair", "keywords": ["accessibility"] },
< 	{ "category": "people", "char": "👩‍🦽", "name": "woman_in_manual_wheelchair", "keywords": ["woman", "female", "accessibility"] },
< 	{ "category": "people", "char": "👨‍🦽", "name": "man_in_manual_wheelchair", "keywords": ["man", "male", "accessibility"] },
< 	{ "category": "people", "char": "💑", "name": "couple_with_heart_woman_man", "keywords": ["pair", "love", "like", "affection", "human", "dating", "valentines", "marriage"] },
< 	{ "category": "people", "char": "👩‍❤️‍👩", "name": "couple_with_heart_woman_woman", "keywords": ["pair", "love", "like", "affection", "human", "dating", "valentines", "marriage"] },
< 	{ "category": "people", "char": "👨‍❤️‍👨", "name": "couple_with_heart_man_man", "keywords": ["pair", "love", "like", "affection", "human", "dating", "valentines", "marriage"] },
< 	{ "category": "people", "char": "💏", "name": "couplekiss_man_woman", "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"] },
< 	{ "category": "people", "char": "👩‍❤️‍💋‍👩", "name": "couplekiss_woman_woman", "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"] },
< 	{ "category": "people", "char": "👨‍❤️‍💋‍👨", "name": "couplekiss_man_man", "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"] },
< 	{ "category": "people", "char": "👪", "name": "family_man_woman_boy", "keywords": ["home", "parents", "child", "mom", "dad", "father", "mother", "people", "human"] },
< 	{ "category": "people", "char": "👨‍👩‍👧", "name": "family_man_woman_girl", "keywords": ["home", "parents", "people", "human", "child"] },
< 	{ "category": "people", "char": "👨‍👩‍👧‍👦", "name": "family_man_woman_girl_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👩‍👦‍👦", "name": "family_man_woman_boy_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👩‍👧‍👧", "name": "family_man_woman_girl_girl", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👩‍👦", "name": "family_woman_woman_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👩‍👧", "name": "family_woman_woman_girl", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👩‍👧‍👦", "name": "family_woman_woman_girl_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👩‍👦‍👦", "name": "family_woman_woman_boy_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👩‍👧‍👧", "name": "family_woman_woman_girl_girl", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👨‍👦", "name": "family_man_man_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👨‍👧", "name": "family_man_man_girl", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👨‍👧‍👦", "name": "family_man_man_girl_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👨‍👦‍👦", "name": "family_man_man_boy_boy", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👨‍👧‍👧", "name": "family_man_man_girl_girl", "keywords": ["home", "parents", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👦", "name": "family_woman_boy", "keywords": ["home", "parent", "people", "human", "child"] },
< 	{ "category": "people", "char": "👩‍👧", "name": "family_woman_girl", "keywords": ["home", "parent", "people", "human", "child"] },
< 	{ "category": "people", "char": "👩‍👧‍👦", "name": "family_woman_girl_boy", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👦‍👦", "name": "family_woman_boy_boy", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "👩‍👧‍👧", "name": "family_woman_girl_girl", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👦", "name": "family_man_boy", "keywords": ["home", "parent", "people", "human", "child"] },
< 	{ "category": "people", "char": "👨‍👧", "name": "family_man_girl", "keywords": ["home", "parent", "people", "human", "child"] },
< 	{ "category": "people", "char": "👨‍👧‍👦", "name": "family_man_girl_boy", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👦‍👦", "name": "family_man_boy_boy", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "👨‍👧‍👧", "name": "family_man_girl_girl", "keywords": ["home", "parent", "people", "human", "children"] },
< 	{ "category": "people", "char": "🧶", "name": "yarn", "keywords": ["ball", "crochet", "knit"] },
< 	{ "category": "people", "char": "🧵", "name": "thread", "keywords": ["needle", "sewing", "spool", "string"] },
< 	{ "category": "people", "char": "🧥", "name": "coat", "keywords": ["jacket"] },
< 	{ "category": "people", "char": "🥼", "name": "labcoat", "keywords": ["doctor", "experiment", "scientist", "chemist"] },
< 	{ "category": "people", "char": "👚", "name": "womans_clothes", "keywords": ["fashion", "shopping_bags", "female"] },
< 	{ "category": "people", "char": "👕", "name": "tshirt", "keywords": ["fashion", "cloth", "casual", "shirt", "tee"] },
< 	{ "category": "people", "char": "👖", "name": "jeans", "keywords": ["fashion", "shopping"] },
< 	{ "category": "people", "char": "👔", "name": "necktie", "keywords": ["shirt", "suitup", "formal", "fashion", "cloth", "business"] },
< 	{ "category": "people", "char": "👗", "name": "dress", "keywords": ["clothes", "fashion", "shopping"] },
< 	{ "category": "people", "char": "👙", "name": "bikini", "keywords": ["swimming", "female", "woman", "girl", "fashion", "beach", "summer"] },
< 	{ "category": "people", "char": "🩱", "name": "one_piece_swimsuit", "keywords": ["swimming", "female", "woman", "girl", "fashion", "beach", "summer"] },
< 	{ "category": "people", "char": "👘", "name": "kimono", "keywords": ["dress", "fashion", "women", "female", "japanese"] },
< 	{ "category": "people", "char": "🥻", "name": "sari", "keywords": ["dress", "fashion", "women", "female"] },
< 	{ "category": "people", "char": "🩲", "name": "briefs", "keywords": ["dress", "fashion"] },
< 	{ "category": "people", "char": "🩳", "name": "shorts", "keywords": ["dress", "fashion"] },
< 	{ "category": "people", "char": "💄", "name": "lipstick", "keywords": ["female", "girl", "fashion", "woman"] },
< 	{ "category": "people", "char": "💋", "name": "kiss", "keywords": ["face", "lips", "love", "like", "affection", "valentines"] },
< 	{ "category": "people", "char": "👣", "name": "footprints", "keywords": ["feet", "tracking", "walking", "beach"] },
< 	{ "category": "people", "char": "🥿", "name": "flat_shoe", "keywords": ["ballet", "slip-on", "slipper"] },
< 	{ "category": "people", "char": "👠", "name": "high_heel", "keywords": ["fashion", "shoes", "female", "pumps", "stiletto"] },
< 	{ "category": "people", "char": "👡", "name": "sandal", "keywords": ["shoes", "fashion", "flip flops"] },
< 	{ "category": "people", "char": "👢", "name": "boot", "keywords": ["shoes", "fashion"] },
< 	{ "category": "people", "char": "👞", "name": "mans_shoe", "keywords": ["fashion", "male"] },
< 	{ "category": "people", "char": "👟", "name": "athletic_shoe", "keywords": ["shoes", "sports", "sneakers"] },
< 	{ "category": "people", "char": "🩴", "name": "thong_sandal", "keywords": [] },
< 	{ "category": "people", "char": "🩰", "name": "ballet_shoes", "keywords": ["shoes", "sports"] },
< 	{ "category": "people", "char": "🧦", "name": "socks", "keywords": ["stockings", "clothes"] },
< 	{ "category": "people", "char": "🧤", "name": "gloves", "keywords": ["hands", "winter", "clothes"] },
< 	{ "category": "people", "char": "🧣", "name": "scarf", "keywords": ["neck", "winter", "clothes"] },
< 	{ "category": "people", "char": "👒", "name": "womans_hat", "keywords": ["fashion", "accessories", "female", "lady", "spring"] },
< 	{ "category": "people", "char": "🎩", "name": "tophat", "keywords": ["magic", "gentleman", "classy", "circus"] },
< 	{ "category": "people", "char": "🧢", "name": "billed_hat", "keywords": ["cap", "baseball"] },
< 	{ "category": "people", "char": "⛑", "name": "rescue_worker_helmet", "keywords": ["construction", "build"] },
< 	{ "category": "people", "char": "🪖", "name": "military_helmet", "keywords": [] },
< 	{ "category": "people", "char": "🎓", "name": "mortar_board", "keywords": ["school", "college", "degree", "university", "graduation", "cap", "hat", "legal", "learn", "education"] },
< 	{ "category": "people", "char": "👑", "name": "crown", "keywords": ["king", "kod", "leader", "royalty", "lord"] },
< 	{ "category": "people", "char": "🎒", "name": "school_satchel", "keywords": ["student", "education", "bag", "backpack"] },
< 	{ "category": "people", "char": "🧳", "name": "luggage", "keywords": ["packing", "travel"] },
< 	{ "category": "people", "char": "👝", "name": "pouch", "keywords": ["bag", "accessories", "shopping"] },
< 	{ "category": "people", "char": "👛", "name": "purse", "keywords": ["fashion", "accessories", "money", "sales", "shopping"] },
< 	{ "category": "people", "char": "👜", "name": "handbag", "keywords": ["fashion", "accessory", "accessories", "shopping"] },
< 	{ "category": "people", "char": "💼", "name": "briefcase", "keywords": ["business", "documents", "work", "law", "legal", "job", "career"] },
< 	{ "category": "people", "char": "👓", "name": "eyeglasses", "keywords": ["fashion", "accessories", "eyesight", "nerdy", "dork", "geek"] },
< 	{ "category": "people", "char": "🕶", "name": "dark_sunglasses", "keywords": ["face", "cool", "accessories"] },
< 	{ "category": "people", "char": "🥽", "name": "goggles", "keywords": ["eyes", "protection", "safety"] },
< 	{ "category": "people", "char": "💍", "name": "ring", "keywords": ["wedding", "propose", "marriage", "valentines", "diamond", "fashion", "jewelry", "gem", "engagement"] },
< 	{ "category": "people", "char": "🌂", "name": "closed_umbrella", "keywords": ["weather", "rain", "drizzle"] },
< 	{ "category": "animals_and_nature", "char": "🐶", "name": "dog", "keywords": ["animal", "friend", "nature", "woof", "puppy", "pet", "faithful"] },
< 	{ "category": "animals_and_nature", "char": "🐱", "name": "cat", "keywords": ["animal", "meow", "nature", "pet", "kitten"] },
< 	{ "category": "animals_and_nature", "char": "🐈‍⬛", "name": "black_cat", "keywords": ["animal", "meow", "nature", "pet", "kitten"] },
< 	{ "category": "animals_and_nature", "char": "🐭", "name": "mouse", "keywords": ["animal", "nature", "cheese_wedge", "rodent"] },
< 	{ "category": "animals_and_nature", "char": "🐹", "name": "hamster", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐰", "name": "rabbit", "keywords": ["animal", "nature", "pet", "spring", "magic", "bunny"] },
< 	{ "category": "animals_and_nature", "char": "🦊", "name": "fox_face", "keywords": ["animal", "nature", "face"] },
< 	{ "category": "animals_and_nature", "char": "🐻", "name": "bear", "keywords": ["animal", "nature", "wild"] },
< 	{ "category": "animals_and_nature", "char": "🐼", "name": "panda_face", "keywords": ["animal", "nature", "panda"] },
< 	{ "category": "animals_and_nature", "char": "🐨", "name": "koala", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐯", "name": "tiger", "keywords": ["animal", "cat", "danger", "wild", "nature", "roar"] },
< 	{ "category": "animals_and_nature", "char": "🦁", "name": "lion", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐮", "name": "cow", "keywords": ["beef", "ox", "animal", "nature", "moo", "milk"] },
< 	{ "category": "animals_and_nature", "char": "🐷", "name": "pig", "keywords": ["animal", "oink", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐽", "name": "pig_nose", "keywords": ["animal", "oink"] },
< 	{ "category": "animals_and_nature", "char": "🐸", "name": "frog", "keywords": ["animal", "nature", "croak", "toad"] },
< 	{ "category": "animals_and_nature", "char": "🦑", "name": "squid", "keywords": ["animal", "nature", "ocean", "sea"] },
< 	{ "category": "animals_and_nature", "char": "🐙", "name": "octopus", "keywords": ["animal", "creature", "ocean", "sea", "nature", "beach"] },
< 	{ "category": "animals_and_nature", "char": "🦐", "name": "shrimp", "keywords": ["animal", "ocean", "nature", "seafood"] },
< 	{ "category": "animals_and_nature", "char": "🐵", "name": "monkey_face", "keywords": ["animal", "nature", "circus"] },
< 	{ "category": "animals_and_nature", "char": "🦍", "name": "gorilla", "keywords": ["animal", "nature", "circus"] },
< 	{ "category": "animals_and_nature", "char": "🙈", "name": "see_no_evil", "keywords": ["monkey", "animal", "nature", "haha"] },
< 	{ "category": "animals_and_nature", "char": "🙉", "name": "hear_no_evil", "keywords": ["animal", "monkey", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🙊", "name": "speak_no_evil", "keywords": ["monkey", "animal", "nature", "omg"] },
< 	{ "category": "animals_and_nature", "char": "🐒", "name": "monkey", "keywords": ["animal", "nature", "banana", "circus"] },
< 	{ "category": "animals_and_nature", "char": "🐔", "name": "chicken", "keywords": ["animal", "cluck", "nature", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🐧", "name": "penguin", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐦", "name": "bird", "keywords": ["animal", "nature", "fly", "tweet", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🐤", "name": "baby_chick", "keywords": ["animal", "chicken", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🐣", "name": "hatching_chick", "keywords": ["animal", "chicken", "egg", "born", "baby", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🐥", "name": "hatched_chick", "keywords": ["animal", "chicken", "baby", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🦆", "name": "duck", "keywords": ["animal", "nature", "bird", "mallard"] },
< 	{ "category": "animals_and_nature", "char": "🦅", "name": "eagle", "keywords": ["animal", "nature", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🦉", "name": "owl", "keywords": ["animal", "nature", "bird", "hoot"] },
< 	{ "category": "animals_and_nature", "char": "🦇", "name": "bat", "keywords": ["animal", "nature", "blind", "vampire"] },
< 	{ "category": "animals_and_nature", "char": "🐺", "name": "wolf", "keywords": ["animal", "nature", "wild"] },
< 	{ "category": "animals_and_nature", "char": "🐗", "name": "boar", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐴", "name": "horse", "keywords": ["animal", "brown", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦄", "name": "unicorn", "keywords": ["animal", "nature", "mystical"] },
< 	{ "category": "animals_and_nature", "char": "🐝", "name": "honeybee", "keywords": ["animal", "insect", "nature", "bug", "spring", "honey"] },
< 	{ "category": "animals_and_nature", "char": "🐛", "name": "bug", "keywords": ["animal", "insect", "nature", "worm"] },
< 	{ "category": "animals_and_nature", "char": "🦋", "name": "butterfly", "keywords": ["animal", "insect", "nature", "caterpillar"] },
< 	{ "category": "animals_and_nature", "char": "🐌", "name": "snail", "keywords": ["slow", "animal", "shell"] },
< 	{ "category": "animals_and_nature", "char": "🐞", "name": "lady_beetle", "keywords": ["animal", "insect", "nature", "ladybug"] },
< 	{ "category": "animals_and_nature", "char": "🐜", "name": "ant", "keywords": ["animal", "insect", "nature", "bug"] },
< 	{ "category": "animals_and_nature", "char": "🦗", "name": "grasshopper", "keywords": ["animal", "cricket", "chirp"] },
< 	{ "category": "animals_and_nature", "char": "🕷", "name": "spider", "keywords": ["animal", "arachnid"] },
< 	{ "category": "animals_and_nature", "char": "🪲", "name": "beetle", "keywords": ["animal"] },
< 	{ "category": "animals_and_nature", "char": "🪳", "name": "cockroach", "keywords": ["animal"] },
< 	{ "category": "animals_and_nature", "char": "🪰", "name": "fly", "keywords": ["animal"] },
< 	{ "category": "animals_and_nature", "char": "🪱", "name": "worm", "keywords": ["animal"] },
< 	{ "category": "animals_and_nature", "char": "🦂", "name": "scorpion", "keywords": ["animal", "arachnid"] },
< 	{ "category": "animals_and_nature", "char": "🦀", "name": "crab", "keywords": ["animal", "crustacean"] },
< 	{ "category": "animals_and_nature", "char": "🐍", "name": "snake", "keywords": ["animal", "evil", "nature", "hiss", "python"] },
< 	{ "category": "animals_and_nature", "char": "🦎", "name": "lizard", "keywords": ["animal", "nature", "reptile"] },
< 	{ "category": "animals_and_nature", "char": "🦖", "name": "t-rex", "keywords": ["animal", "nature", "dinosaur", "tyrannosaurus", "extinct"] },
< 	{ "category": "animals_and_nature", "char": "🦕", "name": "sauropod", "keywords": ["animal", "nature", "dinosaur", "brachiosaurus", "brontosaurus", "diplodocus", "extinct"] },
< 	{ "category": "animals_and_nature", "char": "🐢", "name": "turtle", "keywords": ["animal", "slow", "nature", "tortoise"] },
< 	{ "category": "animals_and_nature", "char": "🐠", "name": "tropical_fish", "keywords": ["animal", "swim", "ocean", "beach", "nemo"] },
< 	{ "category": "animals_and_nature", "char": "🐟", "name": "fish", "keywords": ["animal", "food", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐡", "name": "blowfish", "keywords": ["animal", "nature", "food", "sea", "ocean"] },
< 	{ "category": "animals_and_nature", "char": "🐬", "name": "dolphin", "keywords": ["animal", "nature", "fish", "sea", "ocean", "flipper", "fins", "beach"] },
< 	{ "category": "animals_and_nature", "char": "🦈", "name": "shark", "keywords": ["animal", "nature", "fish", "sea", "ocean", "jaws", "fins", "beach"] },
< 	{ "category": "animals_and_nature", "char": "🐳", "name": "whale", "keywords": ["animal", "nature", "sea", "ocean"] },
< 	{ "category": "animals_and_nature", "char": "🐋", "name": "whale2", "keywords": ["animal", "nature", "sea", "ocean"] },
< 	{ "category": "animals_and_nature", "char": "🐊", "name": "crocodile", "keywords": ["animal", "nature", "reptile", "lizard", "alligator"] },
< 	{ "category": "animals_and_nature", "char": "🐆", "name": "leopard", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦓", "name": "zebra", "keywords": ["animal", "nature", "stripes", "safari"] },
< 	{ "category": "animals_and_nature", "char": "🐅", "name": "tiger2", "keywords": ["animal", "nature", "roar"] },
< 	{ "category": "animals_and_nature", "char": "🐃", "name": "water_buffalo", "keywords": ["animal", "nature", "ox", "cow"] },
< 	{ "category": "animals_and_nature", "char": "🐂", "name": "ox", "keywords": ["animal", "cow", "beef"] },
< 	{ "category": "animals_and_nature", "char": "🐄", "name": "cow2", "keywords": ["beef", "ox", "animal", "nature", "moo", "milk"] },
< 	{ "category": "animals_and_nature", "char": "🦌", "name": "deer", "keywords": ["animal", "nature", "horns", "venison"] },
< 	{ "category": "animals_and_nature", "char": "🐪", "name": "dromedary_camel", "keywords": ["animal", "hot", "desert", "hump"] },
< 	{ "category": "animals_and_nature", "char": "🐫", "name": "camel", "keywords": ["animal", "nature", "hot", "desert", "hump"] },
< 	{ "category": "animals_and_nature", "char": "🦒", "name": "giraffe", "keywords": ["animal", "nature", "spots", "safari"] },
< 	{ "category": "animals_and_nature", "char": "🐘", "name": "elephant", "keywords": ["animal", "nature", "nose", "th", "circus"] },
< 	{ "category": "animals_and_nature", "char": "🦏", "name": "rhinoceros", "keywords": ["animal", "nature", "horn"] },
< 	{ "category": "animals_and_nature", "char": "🐐", "name": "goat", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐏", "name": "ram", "keywords": ["animal", "sheep", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐑", "name": "sheep", "keywords": ["animal", "nature", "wool", "shipit"] },
< 	{ "category": "animals_and_nature", "char": "🐎", "name": "racehorse", "keywords": ["animal", "gamble", "luck"] },
< 	{ "category": "animals_and_nature", "char": "🐖", "name": "pig2", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐀", "name": "rat", "keywords": ["animal", "mouse", "rodent"] },
< 	{ "category": "animals_and_nature", "char": "🐁", "name": "mouse2", "keywords": ["animal", "nature", "rodent"] },
< 	{ "category": "animals_and_nature", "char": "🐓", "name": "rooster", "keywords": ["animal", "nature", "chicken"] },
< 	{ "category": "animals_and_nature", "char": "🦃", "name": "turkey", "keywords": ["animal", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🕊", "name": "dove", "keywords": ["animal", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🐕", "name": "dog2", "keywords": ["animal", "nature", "friend", "doge", "pet", "faithful"] },
< 	{ "category": "animals_and_nature", "char": "🐩", "name": "poodle", "keywords": ["dog", "animal", "101", "nature", "pet"] },
< 	{ "category": "animals_and_nature", "char": "🐈", "name": "cat2", "keywords": ["animal", "meow", "pet", "cats"] },
< 	{ "category": "animals_and_nature", "char": "🐇", "name": "rabbit2", "keywords": ["animal", "nature", "pet", "magic", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🐿", "name": "chipmunk", "keywords": ["animal", "nature", "rodent", "squirrel"] },
< 	{ "category": "animals_and_nature", "char": "🦔", "name": "hedgehog", "keywords": ["animal", "nature", "spiny"] },
< 	{ "category": "animals_and_nature", "char": "🦝", "name": "raccoon", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦙", "name": "llama", "keywords": ["animal", "nature", "alpaca"] },
< 	{ "category": "animals_and_nature", "char": "🦛", "name": "hippopotamus", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦘", "name": "kangaroo", "keywords": ["animal", "nature", "australia", "joey", "hop", "marsupial"] },
< 	{ "category": "animals_and_nature", "char": "🦡", "name": "badger", "keywords": ["animal", "nature", "honey"] },
< 	{ "category": "animals_and_nature", "char": "🦢", "name": "swan", "keywords": ["animal", "nature", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🦚", "name": "peacock", "keywords": ["animal", "nature", "peahen", "bird"] },
< 	{ "category": "animals_and_nature", "char": "🦜", "name": "parrot", "keywords": ["animal", "nature", "bird", "pirate", "talk"] },
< 	{ "category": "animals_and_nature", "char": "🦞", "name": "lobster", "keywords": ["animal", "nature", "bisque", "claws", "seafood"] },
< 	{ "category": "animals_and_nature", "char": "🦠", "name": "microbe", "keywords": ["amoeba", "bacteria", "germs"] },
< 	{ "category": "animals_and_nature", "char": "🦟", "name": "mosquito", "keywords": ["animal", "nature", "insect", "malaria"] },
< 	{ "category": "animals_and_nature", "char": "🦬", "name": "bison", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦣", "name": "mammoth", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦫", "name": "beaver", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐻‍❄️", "name": "polar_bear", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦤", "name": "dodo", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🪶", "name": "feather", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦭", "name": "seal", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐾", "name": "paw_prints", "keywords": ["animal", "tracking", "footprints", "dog", "cat", "pet", "feet"] },
< 	{ "category": "animals_and_nature", "char": "🐉", "name": "dragon", "keywords": ["animal", "myth", "nature", "chinese", "green"] },
< 	{ "category": "animals_and_nature", "char": "🐲", "name": "dragon_face", "keywords": ["animal", "myth", "nature", "chinese", "green"] },
< 	{ "category": "animals_and_nature", "char": "🦧", "name": "orangutan", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦮", "name": "guide_dog", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🐕‍🦺", "name": "service_dog", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦥", "name": "sloth", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦦", "name": "otter", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦨", "name": "skunk", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🦩", "name": "flamingo", "keywords": ["animal", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🌵", "name": "cactus", "keywords": ["vegetable", "plant", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🎄", "name": "christmas_tree", "keywords": ["festival", "vacation", "december", "xmas", "celebration"] },
< 	{ "category": "animals_and_nature", "char": "🌲", "name": "evergreen_tree", "keywords": ["plant", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🌳", "name": "deciduous_tree", "keywords": ["plant", "nature"] },
< 	{ "category": "animals_and_nature", "char": "🌴", "name": "palm_tree", "keywords": ["plant", "vegetable", "nature", "summer", "beach", "mojito", "tropical"] },
< 	{ "category": "animals_and_nature", "char": "🌱", "name": "seedling", "keywords": ["plant", "nature", "grass", "lawn", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🌿", "name": "herb", "keywords": ["vegetable", "plant", "medicine", "weed", "grass", "lawn"] },
< 	{ "category": "animals_and_nature", "char": "☘", "name": "shamrock", "keywords": ["vegetable", "plant", "nature", "irish", "clover"] },
< 	{ "category": "animals_and_nature", "char": "🍀", "name": "four_leaf_clover", "keywords": ["vegetable", "plant", "nature", "lucky", "irish"] },
< 	{ "category": "animals_and_nature", "char": "🎍", "name": "bamboo", "keywords": ["plant", "nature", "vegetable", "panda", "pine_decoration"] },
< 	{ "category": "animals_and_nature", "char": "🎋", "name": "tanabata_tree", "keywords": ["plant", "nature", "branch", "summer"] },
< 	{ "category": "animals_and_nature", "char": "🍃", "name": "leaves", "keywords": ["nature", "plant", "tree", "vegetable", "grass", "lawn", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🍂", "name": "fallen_leaf", "keywords": ["nature", "plant", "vegetable", "leaves"] },
< 	{ "category": "animals_and_nature", "char": "🍁", "name": "maple_leaf", "keywords": ["nature", "plant", "vegetable", "ca", "fall"] },
< 	{ "category": "animals_and_nature", "char": "🌾", "name": "ear_of_rice", "keywords": ["nature", "plant"] },
< 	{ "category": "animals_and_nature", "char": "🌺", "name": "hibiscus", "keywords": ["plant", "vegetable", "flowers", "beach"] },
< 	{ "category": "animals_and_nature", "char": "🌻", "name": "sunflower", "keywords": ["nature", "plant", "fall"] },
< 	{ "category": "animals_and_nature", "char": "🌹", "name": "rose", "keywords": ["flowers", "valentines", "love", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🥀", "name": "wilted_flower", "keywords": ["plant", "nature", "flower"] },
< 	{ "category": "animals_and_nature", "char": "🌷", "name": "tulip", "keywords": ["flowers", "plant", "nature", "summer", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🌼", "name": "blossom", "keywords": ["nature", "flowers", "yellow"] },
< 	{ "category": "animals_and_nature", "char": "🌸", "name": "cherry_blossom", "keywords": ["nature", "plant", "spring", "flower"] },
< 	{ "category": "animals_and_nature", "char": "💐", "name": "bouquet", "keywords": ["flowers", "nature", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🍄", "name": "mushroom", "keywords": ["plant", "vegetable"] },
< 	{ "category": "animals_and_nature", "char": "🪴", "name": "potted_plant", "keywords": ["plant"] },
< 	{ "category": "animals_and_nature", "char": "🌰", "name": "chestnut", "keywords": ["food", "squirrel"] },
< 	{ "category": "animals_and_nature", "char": "🎃", "name": "jack_o_lantern", "keywords": ["halloween", "light", "pumpkin", "creepy", "fall"] },
< 	{ "category": "animals_and_nature", "char": "🐚", "name": "shell", "keywords": ["nature", "sea", "beach"] },
< 	{ "category": "animals_and_nature", "char": "🕸", "name": "spider_web", "keywords": ["animal", "insect", "arachnid", "silk"] },
< 	{ "category": "animals_and_nature", "char": "🌎", "name": "earth_americas", "keywords": ["globe", "world", "USA", "international"] },
< 	{ "category": "animals_and_nature", "char": "🌍", "name": "earth_africa", "keywords": ["globe", "world", "international"] },
< 	{ "category": "animals_and_nature", "char": "🌏", "name": "earth_asia", "keywords": ["globe", "world", "east", "international"] },
< 	{ "category": "animals_and_nature", "char": "🪐", "name": "ringed_planet", "keywords": ["saturn"] },
< 	{ "category": "animals_and_nature", "char": "🌕", "name": "full_moon", "keywords": ["nature", "yellow", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌖", "name": "waning_gibbous_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep", "waxing_gibbous_moon"] },
< 	{ "category": "animals_and_nature", "char": "🌗", "name": "last_quarter_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌘", "name": "waning_crescent_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌑", "name": "new_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌒", "name": "waxing_crescent_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌓", "name": "first_quarter_moon", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌔", "name": "waxing_gibbous_moon", "keywords": ["nature", "night", "sky", "gray", "twilight", "planet", "space", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌚", "name": "new_moon_with_face", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌝", "name": "full_moon_with_face", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌛", "name": "first_quarter_moon_with_face", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌜", "name": "last_quarter_moon_with_face", "keywords": ["nature", "twilight", "planet", "space", "night", "evening", "sleep"] },
< 	{ "category": "animals_and_nature", "char": "🌞", "name": "sun_with_face", "keywords": ["nature", "morning", "sky"] },
< 	{ "category": "animals_and_nature", "char": "🌙", "name": "crescent_moon", "keywords": ["night", "sleep", "sky", "evening", "magic"] },
< 	{ "category": "animals_and_nature", "char": "⭐", "name": "star", "keywords": ["night", "yellow"] },
< 	{ "category": "animals_and_nature", "char": "🌟", "name": "star2", "keywords": ["night", "sparkle", "awesome", "good", "magic"] },
< 	{ "category": "animals_and_nature", "char": "💫", "name": "dizzy", "keywords": ["star", "sparkle", "shoot", "magic"] },
< 	{ "category": "animals_and_nature", "char": "✨", "name": "sparkles", "keywords": ["stars", "shine", "shiny", "cool", "awesome", "good", "magic"] },
< 	{ "category": "animals_and_nature", "char": "☄", "name": "comet", "keywords": ["space"] },
< 	{ "category": "animals_and_nature", "char": "☀️", "name": "sunny", "keywords": ["weather", "nature", "brightness", "summer", "beach", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🌤", "name": "sun_behind_small_cloud", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "⛅", "name": "partly_sunny", "keywords": ["weather", "nature", "cloudy", "morning", "fall", "spring"] },
< 	{ "category": "animals_and_nature", "char": "🌥", "name": "sun_behind_large_cloud", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "🌦", "name": "sun_behind_rain_cloud", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "☁️", "name": "cloud", "keywords": ["weather", "sky"] },
< 	{ "category": "animals_and_nature", "char": "🌧", "name": "cloud_with_rain", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "⛈", "name": "cloud_with_lightning_and_rain", "keywords": ["weather", "lightning"] },
< 	{ "category": "animals_and_nature", "char": "🌩", "name": "cloud_with_lightning", "keywords": ["weather", "thunder"] },
< 	{ "category": "animals_and_nature", "char": "⚡", "name": "zap", "keywords": ["thunder", "weather", "lightning bolt", "fast"] },
< 	{ "category": "animals_and_nature", "char": "🔥", "name": "fire", "keywords": ["hot", "cook", "flame"] },
< 	{ "category": "animals_and_nature", "char": "💥", "name": "boom", "keywords": ["bomb", "explode", "explosion", "collision", "blown"] },
< 	{ "category": "animals_and_nature", "char": "❄️", "name": "snowflake", "keywords": ["winter", "season", "cold", "weather", "christmas", "xmas"] },
< 	{ "category": "animals_and_nature", "char": "🌨", "name": "cloud_with_snow", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "⛄", "name": "snowman", "keywords": ["winter", "season", "cold", "weather", "christmas", "xmas", "frozen", "without_snow"] },
< 	{ "category": "animals_and_nature", "char": "☃", "name": "snowman_with_snow", "keywords": ["winter", "season", "cold", "weather", "christmas", "xmas", "frozen"] },
< 	{ "category": "animals_and_nature", "char": "🌬", "name": "wind_face", "keywords": ["gust", "air"] },
< 	{ "category": "animals_and_nature", "char": "💨", "name": "dash", "keywords": ["wind", "air", "fast", "shoo", "fart", "smoke", "puff"] },
< 	{ "category": "animals_and_nature", "char": "🌪", "name": "tornado", "keywords": ["weather", "cyclone", "twister"] },
< 	{ "category": "animals_and_nature", "char": "🌫", "name": "fog", "keywords": ["weather"] },
< 	{ "category": "animals_and_nature", "char": "☂", "name": "open_umbrella", "keywords": ["weather", "spring"] },
< 	{ "category": "animals_and_nature", "char": "☔", "name": "umbrella", "keywords": ["rainy", "weather", "spring"] },
< 	{ "category": "animals_and_nature", "char": "💧", "name": "droplet", "keywords": ["water", "drip", "faucet", "spring"] },
< 	{ "category": "animals_and_nature", "char": "💦", "name": "sweat_drops", "keywords": ["water", "drip", "oops"] },
< 	{ "category": "animals_and_nature", "char": "🌊", "name": "ocean", "keywords": ["sea", "water", "wave", "nature", "tsunami", "disaster"] },
< 	{ "category": "animals_and_nature", "char": "\uD83E\uDEB7", "name": "lotus", "keywords": [] },
< 	{ "category": "animals_and_nature", "char": "\uD83E\uDEB8", "name": "coral", "keywords": [] },
< 	{ "category": "animals_and_nature", "char": "\uD83E\uDEB9", "name": "empty_nest", "keywords": [] },
< 	{ "category": "animals_and_nature", "char": "\uD83E\uDEBA", "name": "nest_with_eggs", "keywords": [] },
< 	{ "category": "food_and_drink", "char": "🍏", "name": "green_apple", "keywords": ["fruit", "nature"] },
< 	{ "category": "food_and_drink", "char": "🍎", "name": "apple", "keywords": ["fruit", "mac", "school"] },
< 	{ "category": "food_and_drink", "char": "🍐", "name": "pear", "keywords": ["fruit", "nature", "food"] },
< 	{ "category": "food_and_drink", "char": "🍊", "name": "tangerine", "keywords": ["food", "fruit", "nature", "orange"] },
< 	{ "category": "food_and_drink", "char": "🍋", "name": "lemon", "keywords": ["fruit", "nature"] },
< 	{ "category": "food_and_drink", "char": "🍌", "name": "banana", "keywords": ["fruit", "food", "monkey"] },
< 	{ "category": "food_and_drink", "char": "🍉", "name": "watermelon", "keywords": ["fruit", "food", "picnic", "summer"] },
< 	{ "category": "food_and_drink", "char": "🍇", "name": "grapes", "keywords": ["fruit", "food", "wine"] },
< 	{ "category": "food_and_drink", "char": "🍓", "name": "strawberry", "keywords": ["fruit", "food", "nature"] },
< 	{ "category": "food_and_drink", "char": "🍈", "name": "melon", "keywords": ["fruit", "nature", "food"] },
< 	{ "category": "food_and_drink", "char": "🍒", "name": "cherries", "keywords": ["food", "fruit"] },
< 	{ "category": "food_and_drink", "char": "🍑", "name": "peach", "keywords": ["fruit", "nature", "food"] },
< 	{ "category": "food_and_drink", "char": "🍍", "name": "pineapple", "keywords": ["fruit", "nature", "food"] },
< 	{ "category": "food_and_drink", "char": "🥥", "name": "coconut", "keywords": ["fruit", "nature", "food", "palm"] },
< 	{ "category": "food_and_drink", "char": "🥝", "name": "kiwi_fruit", "keywords": ["fruit", "food"] },
< 	{ "category": "food_and_drink", "char": "🥭", "name": "mango", "keywords": ["fruit", "food", "tropical"] },
< 	{ "category": "food_and_drink", "char": "🥑", "name": "avocado", "keywords": ["fruit", "food"] },
< 	{ "category": "food_and_drink", "char": "🥦", "name": "broccoli", "keywords": ["fruit", "food", "vegetable"] },
< 	{ "category": "food_and_drink", "char": "🍅", "name": "tomato", "keywords": ["fruit", "vegetable", "nature", "food"] },
< 	{ "category": "food_and_drink", "char": "🍆", "name": "eggplant", "keywords": ["vegetable", "nature", "food", "aubergine"] },
< 	{ "category": "food_and_drink", "char": "🥒", "name": "cucumber", "keywords": ["fruit", "food", "pickle"] },
< 	{ "category": "food_and_drink", "char": "🫐", "name": "blueberries", "keywords": ["fruit", "food"] },
< 	{ "category": "food_and_drink", "char": "🫒", "name": "olive", "keywords": ["fruit", "food"] },
< 	{ "category": "food_and_drink", "char": "🫑", "name": "bell_pepper", "keywords": ["fruit", "food"] },
< 	{ "category": "food_and_drink", "char": "🥕", "name": "carrot", "keywords": ["vegetable", "food", "orange"] },
< 	{ "category": "food_and_drink", "char": "🌶", "name": "hot_pepper", "keywords": ["food", "spicy", "chilli", "chili"] },
< 	{ "category": "food_and_drink", "char": "🥔", "name": "potato", "keywords": ["food", "tuber", "vegatable", "starch"] },
< 	{ "category": "food_and_drink", "char": "🌽", "name": "corn", "keywords": ["food", "vegetable", "plant"] },
< 	{ "category": "food_and_drink", "char": "🥬", "name": "leafy_greens", "keywords": ["food", "vegetable", "plant", "bok choy", "cabbage", "kale", "lettuce"] },
< 	{ "category": "food_and_drink", "char": "🍠", "name": "sweet_potato", "keywords": ["food", "nature"] },
< 	{ "category": "food_and_drink", "char": "🥜", "name": "peanuts", "keywords": ["food", "nut"] },
< 	{ "category": "food_and_drink", "char": "🧄", "name": "garlic", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🧅", "name": "onion", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🍯", "name": "honey_pot", "keywords": ["bees", "sweet", "kitchen"] },
< 	{ "category": "food_and_drink", "char": "🥐", "name": "croissant", "keywords": ["food", "bread", "french"] },
< 	{ "category": "food_and_drink", "char": "🍞", "name": "bread", "keywords": ["food", "wheat", "breakfast", "toast"] },
< 	{ "category": "food_and_drink", "char": "🥖", "name": "baguette_bread", "keywords": ["food", "bread", "french"] },
< 	{ "category": "food_and_drink", "char": "🥯", "name": "bagel", "keywords": ["food", "bread", "bakery", "schmear"] },
< 	{ "category": "food_and_drink", "char": "🥨", "name": "pretzel", "keywords": ["food", "bread", "twisted"] },
< 	{ "category": "food_and_drink", "char": "🧀", "name": "cheese", "keywords": ["food", "chadder"] },
< 	{ "category": "food_and_drink", "char": "🥚", "name": "egg", "keywords": ["food", "chicken", "breakfast"] },
< 	{ "category": "food_and_drink", "char": "🥓", "name": "bacon", "keywords": ["food", "breakfast", "pork", "pig", "meat"] },
< 	{ "category": "food_and_drink", "char": "🥩", "name": "steak", "keywords": ["food", "cow", "meat", "cut", "chop", "lambchop", "porkchop"] },
< 	{ "category": "food_and_drink", "char": "🥞", "name": "pancakes", "keywords": ["food", "breakfast", "flapjacks", "hotcakes"] },
< 	{ "category": "food_and_drink", "char": "🍗", "name": "poultry_leg", "keywords": ["food", "meat", "drumstick", "bird", "chicken", "turkey"] },
< 	{ "category": "food_and_drink", "char": "🍖", "name": "meat_on_bone", "keywords": ["good", "food", "drumstick"] },
< 	{ "category": "food_and_drink", "char": "🦴", "name": "bone", "keywords": ["skeleton"] },
< 	{ "category": "food_and_drink", "char": "🍤", "name": "fried_shrimp", "keywords": ["food", "animal", "appetizer", "summer"] },
< 	{ "category": "food_and_drink", "char": "🍳", "name": "fried_egg", "keywords": ["food", "breakfast", "kitchen", "egg"] },
< 	{ "category": "food_and_drink", "char": "🍔", "name": "hamburger", "keywords": ["meat", "fast food", "beef", "cheeseburger", "mcdonalds", "burger king"] },
< 	{ "category": "food_and_drink", "char": "🍟", "name": "fries", "keywords": ["chips", "snack", "fast food"] },
< 	{ "category": "food_and_drink", "char": "🥙", "name": "stuffed_flatbread", "keywords": ["food", "flatbread", "stuffed", "gyro"] },
< 	{ "category": "food_and_drink", "char": "🌭", "name": "hotdog", "keywords": ["food", "frankfurter"] },
< 	{ "category": "food_and_drink", "char": "🍕", "name": "pizza", "keywords": ["food", "party"] },
< 	{ "category": "food_and_drink", "char": "🥪", "name": "sandwich", "keywords": ["food", "lunch", "bread"] },
< 	{ "category": "food_and_drink", "char": "🥫", "name": "canned_food", "keywords": ["food", "soup"] },
< 	{ "category": "food_and_drink", "char": "🍝", "name": "spaghetti", "keywords": ["food", "italian", "noodle"] },
< 	{ "category": "food_and_drink", "char": "🌮", "name": "taco", "keywords": ["food", "mexican"] },
< 	{ "category": "food_and_drink", "char": "🌯", "name": "burrito", "keywords": ["food", "mexican"] },
< 	{ "category": "food_and_drink", "char": "🥗", "name": "green_salad", "keywords": ["food", "healthy", "lettuce"] },
< 	{ "category": "food_and_drink", "char": "🥘", "name": "shallow_pan_of_food", "keywords": ["food", "cooking", "casserole", "paella"] },
< 	{ "category": "food_and_drink", "char": "🍜", "name": "ramen", "keywords": ["food", "japanese", "noodle", "chopsticks"] },
< 	{ "category": "food_and_drink", "char": "🍲", "name": "stew", "keywords": ["food", "meat", "soup"] },
< 	{ "category": "food_and_drink", "char": "🍥", "name": "fish_cake", "keywords": ["food", "japan", "sea", "beach", "narutomaki", "pink", "swirl", "kamaboko", "surimi", "ramen"] },
< 	{ "category": "food_and_drink", "char": "🥠", "name": "fortune_cookie", "keywords": ["food", "prophecy"] },
< 	{ "category": "food_and_drink", "char": "🍣", "name": "sushi", "keywords": ["food", "fish", "japanese", "rice"] },
< 	{ "category": "food_and_drink", "char": "🍱", "name": "bento", "keywords": ["food", "japanese", "box"] },
< 	{ "category": "food_and_drink", "char": "🍛", "name": "curry", "keywords": ["food", "spicy", "hot", "indian"] },
< 	{ "category": "food_and_drink", "char": "🍙", "name": "rice_ball", "keywords": ["food", "japanese"] },
< 	{ "category": "food_and_drink", "char": "🍚", "name": "rice", "keywords": ["food", "china", "asian"] },
< 	{ "category": "food_and_drink", "char": "🍘", "name": "rice_cracker", "keywords": ["food", "japanese"] },
< 	{ "category": "food_and_drink", "char": "🍢", "name": "oden", "keywords": ["food", "japanese"] },
< 	{ "category": "food_and_drink", "char": "🍡", "name": "dango", "keywords": ["food", "dessert", "sweet", "japanese", "barbecue", "meat"] },
< 	{ "category": "food_and_drink", "char": "🍧", "name": "shaved_ice", "keywords": ["hot", "dessert", "summer"] },
< 	{ "category": "food_and_drink", "char": "🍨", "name": "ice_cream", "keywords": ["food", "hot", "dessert"] },
< 	{ "category": "food_and_drink", "char": "🍦", "name": "icecream", "keywords": ["food", "hot", "dessert", "summer"] },
< 	{ "category": "food_and_drink", "char": "🥧", "name": "pie", "keywords": ["food", "dessert", "pastry"] },
< 	{ "category": "food_and_drink", "char": "🍰", "name": "cake", "keywords": ["food", "dessert"] },
< 	{ "category": "food_and_drink", "char": "🧁", "name": "cupcake", "keywords": ["food", "dessert", "bakery", "sweet"] },
< 	{ "category": "food_and_drink", "char": "🥮", "name": "moon_cake", "keywords": ["food", "autumn"] },
< 	{ "category": "food_and_drink", "char": "🎂", "name": "birthday", "keywords": ["food", "dessert", "cake"] },
< 	{ "category": "food_and_drink", "char": "🍮", "name": "custard", "keywords": ["dessert", "food"] },
< 	{ "category": "food_and_drink", "char": "🍬", "name": "candy", "keywords": ["snack", "dessert", "sweet", "lolly"] },
< 	{ "category": "food_and_drink", "char": "🍭", "name": "lollipop", "keywords": ["food", "snack", "candy", "sweet"] },
< 	{ "category": "food_and_drink", "char": "🍫", "name": "chocolate_bar", "keywords": ["food", "snack", "dessert", "sweet"] },
< 	{ "category": "food_and_drink", "char": "🍿", "name": "popcorn", "keywords": ["food", "movie theater", "films", "snack"] },
< 	{ "category": "food_and_drink", "char": "🥟", "name": "dumpling", "keywords": ["food", "empanada", "pierogi", "potsticker"] },
< 	{ "category": "food_and_drink", "char": "🍩", "name": "doughnut", "keywords": ["food", "dessert", "snack", "sweet", "donut"] },
< 	{ "category": "food_and_drink", "char": "🍪", "name": "cookie", "keywords": ["food", "snack", "oreo", "chocolate", "sweet", "dessert"] },
< 	{ "category": "food_and_drink", "char": "🧇", "name": "waffle", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🧆", "name": "falafel", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🧈", "name": "butter", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🦪", "name": "oyster", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🫓", "name": "flatbread", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🫔", "name": "tamale", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🫕", "name": "fondue", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🥛", "name": "milk_glass", "keywords": ["beverage", "drink", "cow"] },
< 	{ "category": "food_and_drink", "char": "🍺", "name": "beer", "keywords": ["relax", "beverage", "drink", "drunk", "party", "pub", "summer", "alcohol", "booze"] },
< 	{ "category": "food_and_drink", "char": "🍻", "name": "beers", "keywords": ["relax", "beverage", "drink", "drunk", "party", "pub", "summer", "alcohol", "booze"] },
< 	{ "category": "food_and_drink", "char": "🥂", "name": "clinking_glasses", "keywords": ["beverage", "drink", "party", "alcohol", "celebrate", "cheers", "wine", "champagne", "toast"] },
< 	{ "category": "food_and_drink", "char": "🍷", "name": "wine_glass", "keywords": ["drink", "beverage", "drunk", "alcohol", "booze"] },
< 	{ "category": "food_and_drink", "char": "🥃", "name": "tumbler_glass", "keywords": ["drink", "beverage", "drunk", "alcohol", "liquor", "booze", "bourbon", "scotch", "whisky", "glass", "shot"] },
< 	{ "category": "food_and_drink", "char": "🍸", "name": "cocktail", "keywords": ["drink", "drunk", "alcohol", "beverage", "booze", "mojito"] },
< 	{ "category": "food_and_drink", "char": "🍹", "name": "tropical_drink", "keywords": ["beverage", "cocktail", "summer", "beach", "alcohol", "booze", "mojito"] },
< 	{ "category": "food_and_drink", "char": "🍾", "name": "champagne", "keywords": ["drink", "wine", "bottle", "celebration"] },
< 	{ "category": "food_and_drink", "char": "🍶", "name": "sake", "keywords": ["wine", "drink", "drunk", "beverage", "japanese", "alcohol", "booze"] },
< 	{ "category": "food_and_drink", "char": "🍵", "name": "tea", "keywords": ["drink", "bowl", "breakfast", "green", "british"] },
< 	{ "category": "food_and_drink", "char": "🥤", "name": "cup_with_straw", "keywords": ["drink", "soda"] },
< 	{ "category": "food_and_drink", "char": "☕", "name": "coffee", "keywords": ["beverage", "caffeine", "latte", "espresso"] },
< 	{ "category": "food_and_drink", "char": "🫖", "name": "teapot", "keywords": [] },
< 	{ "category": "food_and_drink", "char": "🧋", "name": "bubble_tea", "keywords": ["tapioca"] },
< 	{ "category": "food_and_drink", "char": "🍼", "name": "baby_bottle", "keywords": ["food", "container", "milk"] },
< 	{ "category": "food_and_drink", "char": "🧃", "name": "beverage_box", "keywords": ["food", "drink"] },
< 	{ "category": "food_and_drink", "char": "🧉", "name": "mate", "keywords": ["food", "drink"] },
< 	{ "category": "food_and_drink", "char": "🧊", "name": "ice_cube", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "🧂", "name": "salt", "keywords": ["condiment", "shaker"] },
< 	{ "category": "food_and_drink", "char": "🥄", "name": "spoon", "keywords": ["cutlery", "kitchen", "tableware"] },
< 	{ "category": "food_and_drink", "char": "🍴", "name": "fork_and_knife", "keywords": ["cutlery", "kitchen"] },
< 	{ "category": "food_and_drink", "char": "🍽", "name": "plate_with_cutlery", "keywords": ["food", "eat", "meal", "lunch", "dinner", "restaurant"] },
< 	{ "category": "food_and_drink", "char": "🥣", "name": "bowl_with_spoon", "keywords": ["food", "breakfast", "cereal", "oatmeal", "porridge"] },
< 	{ "category": "food_and_drink", "char": "🥡", "name": "takeout_box", "keywords": ["food", "leftovers"] },
< 	{ "category": "food_and_drink", "char": "🥢", "name": "chopsticks", "keywords": ["food"] },
< 	{ "category": "food_and_drink", "char": "\uD83E\uDED7", "name": "pouring_liquid", "keywords": [] },
< 	{ "category": "food_and_drink", "char": "\uD83E\uDED8", "name": "beans", "keywords": [] },
< 	{ "category": "food_and_drink", "char": "\uD83E\uDED9", "name": "jar", "keywords": [] },
< 	{ "category": "activity", "char": "⚽", "name": "soccer", "keywords": ["sports", "football"] },
< 	{ "category": "activity", "char": "🏀", "name": "basketball", "keywords": ["sports", "balls", "NBA"] },
< 	{ "category": "activity", "char": "🏈", "name": "football", "keywords": ["sports", "balls", "NFL"] },
< 	{ "category": "activity", "char": "⚾", "name": "baseball", "keywords": ["sports", "balls"] },
< 	{ "category": "activity", "char": "🥎", "name": "softball", "keywords": ["sports", "balls"] },
< 	{ "category": "activity", "char": "🎾", "name": "tennis", "keywords": ["sports", "balls", "green"] },
< 	{ "category": "activity", "char": "🏐", "name": "volleyball", "keywords": ["sports", "balls"] },
< 	{ "category": "activity", "char": "🏉", "name": "rugby_football", "keywords": ["sports", "team"] },
< 	{ "category": "activity", "char": "🥏", "name": "flying_disc", "keywords": ["sports", "frisbee", "ultimate"] },
< 	{ "category": "activity", "char": "🎱", "name": "8ball", "keywords": ["pool", "hobby", "game", "luck", "magic"] },
< 	{ "category": "activity", "char": "⛳", "name": "golf", "keywords": ["sports", "business", "flag", "hole", "summer"] },
< 	{ "category": "activity", "char": "🏌️‍♀️", "name": "golfing_woman", "keywords": ["sports", "business", "woman", "female"] },
< 	{ "category": "activity", "char": "🏌", "name": "golfing_man", "keywords": ["sports", "business"] },
< 	{ "category": "activity", "char": "🏓", "name": "ping_pong", "keywords": ["sports", "pingpong"] },
< 	{ "category": "activity", "char": "🏸", "name": "badminton", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🥅", "name": "goal_net", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🏒", "name": "ice_hockey", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🏑", "name": "field_hockey", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🥍", "name": "lacrosse", "keywords": ["sports", "ball", "stick"] },
< 	{ "category": "activity", "char": "🏏", "name": "cricket", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🎿", "name": "ski", "keywords": ["sports", "winter", "cold", "snow"] },
< 	{ "category": "activity", "char": "⛷", "name": "skier", "keywords": ["sports", "winter", "snow"] },
< 	{ "category": "activity", "char": "🏂", "name": "snowboarder", "keywords": ["sports", "winter"] },
< 	{ "category": "activity", "char": "🤺", "name": "person_fencing", "keywords": ["sports", "fencing", "sword"] },
< 	{ "category": "activity", "char": "🤼‍♀️", "name": "women_wrestling", "keywords": ["sports", "wrestlers"] },
< 	{ "category": "activity", "char": "🤼‍♂️", "name": "men_wrestling", "keywords": ["sports", "wrestlers"] },
< 	{ "category": "activity", "char": "🤸‍♀️", "name": "woman_cartwheeling", "keywords": ["gymnastics"] },
< 	{ "category": "activity", "char": "🤸‍♂️", "name": "man_cartwheeling", "keywords": ["gymnastics"] },
< 	{ "category": "activity", "char": "🤾‍♀️", "name": "woman_playing_handball", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🤾‍♂️", "name": "man_playing_handball", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "⛸", "name": "ice_skate", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🥌", "name": "curling_stone", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🛹", "name": "skateboard", "keywords": ["board"] },
< 	{ "category": "activity", "char": "🛷", "name": "sled", "keywords": ["sleigh", "luge", "toboggan"] },
< 	{ "category": "activity", "char": "🏹", "name": "bow_and_arrow", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🎣", "name": "fishing_pole_and_fish", "keywords": ["food", "hobby", "summer"] },
< 	{ "category": "activity", "char": "🥊", "name": "boxing_glove", "keywords": ["sports", "fighting"] },
< 	{ "category": "activity", "char": "🥋", "name": "martial_arts_uniform", "keywords": ["judo", "karate", "taekwondo"] },
< 	{ "category": "activity", "char": "🚣‍♀️", "name": "rowing_woman", "keywords": ["sports", "hobby", "water", "ship", "woman", "female"] },
< 	{ "category": "activity", "char": "🚣", "name": "rowing_man", "keywords": ["sports", "hobby", "water", "ship"] },
< 	{ "category": "activity", "char": "🧗‍♀️", "name": "climbing_woman", "keywords": ["sports", "hobby", "woman", "female", "rock"] },
< 	{ "category": "activity", "char": "🧗‍♂️", "name": "climbing_man", "keywords": ["sports", "hobby", "man", "male", "rock"] },
< 	{ "category": "activity", "char": "🏊‍♀️", "name": "swimming_woman", "keywords": ["sports", "exercise", "human", "athlete", "water", "summer", "woman", "female"] },
< 	{ "category": "activity", "char": "🏊", "name": "swimming_man", "keywords": ["sports", "exercise", "human", "athlete", "water", "summer"] },
< 	{ "category": "activity", "char": "🤽‍♀️", "name": "woman_playing_water_polo", "keywords": ["sports", "pool"] },
< 	{ "category": "activity", "char": "🤽‍♂️", "name": "man_playing_water_polo", "keywords": ["sports", "pool"] },
< 	{ "category": "activity", "char": "🧘‍♀️", "name": "woman_in_lotus_position", "keywords": ["woman", "female", "meditation", "yoga", "serenity", "zen", "mindfulness"] },
< 	{ "category": "activity", "char": "🧘‍♂️", "name": "man_in_lotus_position", "keywords": ["man", "male", "meditation", "yoga", "serenity", "zen", "mindfulness"] },
< 	{ "category": "activity", "char": "🏄‍♀️", "name": "surfing_woman", "keywords": ["sports", "ocean", "sea", "summer", "beach", "woman", "female"] },
< 	{ "category": "activity", "char": "🏄", "name": "surfing_man", "keywords": ["sports", "ocean", "sea", "summer", "beach"] },
< 	{ "category": "activity", "char": "🛀", "name": "bath", "keywords": ["clean", "shower", "bathroom"] },
< 	{ "category": "activity", "char": "⛹️‍♀️", "name": "basketball_woman", "keywords": ["sports", "human", "woman", "female"] },
< 	{ "category": "activity", "char": "⛹", "name": "basketball_man", "keywords": ["sports", "human"] },
< 	{ "category": "activity", "char": "🏋️‍♀️", "name": "weight_lifting_woman", "keywords": ["sports", "training", "exercise", "woman", "female"] },
< 	{ "category": "activity", "char": "🏋", "name": "weight_lifting_man", "keywords": ["sports", "training", "exercise"] },
< 	{ "category": "activity", "char": "🚴‍♀️", "name": "biking_woman", "keywords": ["sports", "bike", "exercise", "hipster", "woman", "female"] },
< 	{ "category": "activity", "char": "🚴", "name": "biking_man", "keywords": ["sports", "bike", "exercise", "hipster"] },
< 	{ "category": "activity", "char": "🚵‍♀️", "name": "mountain_biking_woman", "keywords": ["transportation", "sports", "human", "race", "bike", "woman", "female"] },
< 	{ "category": "activity", "char": "🚵", "name": "mountain_biking_man", "keywords": ["transportation", "sports", "human", "race", "bike"] },
< 	{ "category": "activity", "char": "🏇", "name": "horse_racing", "keywords": ["animal", "betting", "competition", "gambling", "luck"] },
< 	{ "category": "activity", "char": "🤿", "name": "diving_mask", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🪀", "name": "yo_yo", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🪁", "name": "kite", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🦺", "name": "safety_vest", "keywords": ["sports"] },
< 	{ "category": "activity", "char": "🪡", "name": "sewing_needle", "keywords": [] },
< 	{ "category": "activity", "char": "🪢", "name": "knot", "keywords": [] },
< 	{ "category": "activity", "char": "🕴", "name": "business_suit_levitating", "keywords": ["suit", "business", "levitate", "hover", "jump"] },
< 	{ "category": "activity", "char": "🏆", "name": "trophy", "keywords": ["win", "award", "contest", "place", "ftw", "ceremony"] },
< 	{ "category": "activity", "char": "🎽", "name": "running_shirt_with_sash", "keywords": ["play", "pageant"] },
< 	{ "category": "activity", "char": "🏅", "name": "medal_sports", "keywords": ["award", "winning"] },
< 	{ "category": "activity", "char": "🎖", "name": "medal_military", "keywords": ["award", "winning", "army"] },
< 	{ "category": "activity", "char": "🥇", "name": "1st_place_medal", "keywords": ["award", "winning", "first"] },
< 	{ "category": "activity", "char": "🥈", "name": "2nd_place_medal", "keywords": ["award", "second"] },
< 	{ "category": "activity", "char": "🥉", "name": "3rd_place_medal", "keywords": ["award", "third"] },
< 	{ "category": "activity", "char": "🎗", "name": "reminder_ribbon", "keywords": ["sports", "cause", "support", "awareness"] },
< 	{ "category": "activity", "char": "🏵", "name": "rosette", "keywords": ["flower", "decoration", "military"] },
< 	{ "category": "activity", "char": "🎫", "name": "ticket", "keywords": ["event", "concert", "pass"] },
< 	{ "category": "activity", "char": "🎟", "name": "tickets", "keywords": ["sports", "concert", "entrance"] },
< 	{ "category": "activity", "char": "🎭", "name": "performing_arts", "keywords": ["acting", "theater", "drama"] },
< 	{ "category": "activity", "char": "🎨", "name": "art", "keywords": ["design", "paint", "draw", "colors"] },
< 	{ "category": "activity", "char": "🎪", "name": "circus_tent", "keywords": ["festival", "carnival", "party"] },
< 	{ "category": "activity", "char": "🤹‍♀️", "name": "woman_juggling", "keywords": ["juggle", "balance", "skill", "multitask"] },
< 	{ "category": "activity", "char": "🤹‍♂️", "name": "man_juggling", "keywords": ["juggle", "balance", "skill", "multitask"] },
< 	{ "category": "activity", "char": "🎤", "name": "microphone", "keywords": ["sound", "music", "PA", "sing", "talkshow"] },
< 	{ "category": "activity", "char": "🎧", "name": "headphones", "keywords": ["music", "score", "gadgets"] },
< 	{ "category": "activity", "char": "🎼", "name": "musical_score", "keywords": ["treble", "clef", "compose"] },
< 	{ "category": "activity", "char": "🎹", "name": "musical_keyboard", "keywords": ["piano", "instrument", "compose"] },
< 	{ "category": "activity", "char": "🥁", "name": "drum", "keywords": ["music", "instrument", "drumsticks", "snare"] },
< 	{ "category": "activity", "char": "🎷", "name": "saxophone", "keywords": ["music", "instrument", "jazz", "blues"] },
< 	{ "category": "activity", "char": "🎺", "name": "trumpet", "keywords": ["music", "brass"] },
< 	{ "category": "activity", "char": "🎸", "name": "guitar", "keywords": ["music", "instrument"] },
< 	{ "category": "activity", "char": "🎻", "name": "violin", "keywords": ["music", "instrument", "orchestra", "symphony"] },
< 	{ "category": "activity", "char": "🪕", "name": "banjo", "keywords": ["music", "instrument"] },
< 	{ "category": "activity", "char": "🪗", "name": "accordion", "keywords": ["music", "instrument"] },
< 	{ "category": "activity", "char": "🪘", "name": "long_drum", "keywords": ["music", "instrument"] },
< 	{ "category": "activity", "char": "🎬", "name": "clapper", "keywords": ["movie", "film", "record"] },
< 	{ "category": "activity", "char": "🎮", "name": "video_game", "keywords": ["play", "console", "PS4", "controller"] },
< 	{ "category": "activity", "char": "👾", "name": "space_invader", "keywords": ["game", "arcade", "play"] },
< 	{ "category": "activity", "char": "🎯", "name": "dart", "keywords": ["game", "play", "bar", "target", "bullseye"] },
< 	{ "category": "activity", "char": "🎲", "name": "game_die", "keywords": ["dice", "random", "tabletop", "play", "luck"] },
< 	{ "category": "activity", "char": "♟️", "name": "chess_pawn", "keywords": ["expendable"] },
< 	{ "category": "activity", "char": "🎰", "name": "slot_machine", "keywords": ["bet", "gamble", "vegas", "fruit machine", "luck", "casino"] },
< 	{ "category": "activity", "char": "🧩", "name": "jigsaw", "keywords": ["interlocking", "puzzle", "piece"] },
< 	{ "category": "activity", "char": "🎳", "name": "bowling", "keywords": ["sports", "fun", "play"] },
< 	{ "category": "activity", "char": "🪄", "name": "magic_wand", "keywords": [] },
< 	{ "category": "activity", "char": "🪅", "name": "pinata", "keywords": [] },
< 	{ "category": "activity", "char": "🪆", "name": "nesting_dolls", "keywords": [] },
< 	{ "category": "activity", "char": "\uD83E\uDEAC", "name": "hamsa", "keywords": [] },
< 	{ "category": "activity", "char": "\uD83E\uDEA9", "name": "mirror_ball", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "🚗", "name": "red_car", "keywords": ["red", "transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚕", "name": "taxi", "keywords": ["uber", "vehicle", "cars", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚙", "name": "blue_car", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚌", "name": "bus", "keywords": ["car", "vehicle", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚎", "name": "trolleybus", "keywords": ["bart", "transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🏎", "name": "racing_car", "keywords": ["sports", "race", "fast", "formula", "f1"] },
< 	{ "category": "travel_and_places", "char": "🚓", "name": "police_car", "keywords": ["vehicle", "cars", "transportation", "law", "legal", "enforcement"] },
< 	{ "category": "travel_and_places", "char": "🚑", "name": "ambulance", "keywords": ["health", "911", "hospital"] },
< 	{ "category": "travel_and_places", "char": "🚒", "name": "fire_engine", "keywords": ["transportation", "cars", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚐", "name": "minibus", "keywords": ["vehicle", "car", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚚", "name": "truck", "keywords": ["cars", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚛", "name": "articulated_lorry", "keywords": ["vehicle", "cars", "transportation", "express"] },
< 	{ "category": "travel_and_places", "char": "🚜", "name": "tractor", "keywords": ["vehicle", "car", "farming", "agriculture"] },
< 	{ "category": "travel_and_places", "char": "🛴", "name": "kick_scooter", "keywords": ["vehicle", "kick", "razor"] },
< 	{ "category": "travel_and_places", "char": "🏍", "name": "motorcycle", "keywords": ["race", "sports", "fast"] },
< 	{ "category": "travel_and_places", "char": "🚲", "name": "bike", "keywords": ["sports", "bicycle", "exercise", "hipster"] },
< 	{ "category": "travel_and_places", "char": "🛵", "name": "motor_scooter", "keywords": ["vehicle", "vespa", "sasha"] },
< 	{ "category": "travel_and_places", "char": "🦽", "name": "manual_wheelchair", "keywords": ["vehicle"] },
< 	{ "category": "travel_and_places", "char": "🦼", "name": "motorized_wheelchair", "keywords": ["vehicle"] },
< 	{ "category": "travel_and_places", "char": "🛺", "name": "auto_rickshaw", "keywords": ["vehicle"] },
< 	{ "category": "travel_and_places", "char": "🪂", "name": "parachute", "keywords": ["vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚨", "name": "rotating_light", "keywords": ["police", "ambulance", "911", "emergency", "alert", "error", "pinged", "law", "legal"] },
< 	{ "category": "travel_and_places", "char": "🚔", "name": "oncoming_police_car", "keywords": ["vehicle", "law", "legal", "enforcement", "911"] },
< 	{ "category": "travel_and_places", "char": "🚍", "name": "oncoming_bus", "keywords": ["vehicle", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚘", "name": "oncoming_automobile", "keywords": ["car", "vehicle", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚖", "name": "oncoming_taxi", "keywords": ["vehicle", "cars", "uber"] },
< 	{ "category": "travel_and_places", "char": "🚡", "name": "aerial_tramway", "keywords": ["transportation", "vehicle", "ski"] },
< 	{ "category": "travel_and_places", "char": "🚠", "name": "mountain_cableway", "keywords": ["transportation", "vehicle", "ski"] },
< 	{ "category": "travel_and_places", "char": "🚟", "name": "suspension_railway", "keywords": ["vehicle", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🚃", "name": "railway_car", "keywords": ["transportation", "vehicle", "train"] },
< 	{ "category": "travel_and_places", "char": "🚋", "name": "train", "keywords": ["transportation", "vehicle", "carriage", "public", "travel"] },
< 	{ "category": "travel_and_places", "char": "🚝", "name": "monorail", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚄", "name": "bullettrain_side", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚅", "name": "bullettrain_front", "keywords": ["transportation", "vehicle", "speed", "fast", "public", "travel"] },
< 	{ "category": "travel_and_places", "char": "🚈", "name": "light_rail", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚞", "name": "mountain_railway", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚂", "name": "steam_locomotive", "keywords": ["transportation", "vehicle", "train"] },
< 	{ "category": "travel_and_places", "char": "🚆", "name": "train2", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚇", "name": "metro", "keywords": ["transportation", "blue-square", "mrt", "underground", "tube"] },
< 	{ "category": "travel_and_places", "char": "🚊", "name": "tram", "keywords": ["transportation", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "🚉", "name": "station", "keywords": ["transportation", "vehicle", "public"] },
< 	{ "category": "travel_and_places", "char": "🛸", "name": "flying_saucer", "keywords": ["transportation", "vehicle", "ufo"] },
< 	{ "category": "travel_and_places", "char": "🚁", "name": "helicopter", "keywords": ["transportation", "vehicle", "fly"] },
< 	{ "category": "travel_and_places", "char": "🛩", "name": "small_airplane", "keywords": ["flight", "transportation", "fly", "vehicle"] },
< 	{ "category": "travel_and_places", "char": "✈️", "name": "airplane", "keywords": ["vehicle", "transportation", "flight", "fly"] },
< 	{ "category": "travel_and_places", "char": "🛫", "name": "flight_departure", "keywords": ["airport", "flight", "landing"] },
< 	{ "category": "travel_and_places", "char": "🛬", "name": "flight_arrival", "keywords": ["airport", "flight", "boarding"] },
< 	{ "category": "travel_and_places", "char": "⛵", "name": "sailboat", "keywords": ["ship", "summer", "transportation", "water", "sailing"] },
< 	{ "category": "travel_and_places", "char": "🛥", "name": "motor_boat", "keywords": ["ship"] },
< 	{ "category": "travel_and_places", "char": "🚤", "name": "speedboat", "keywords": ["ship", "transportation", "vehicle", "summer"] },
< 	{ "category": "travel_and_places", "char": "⛴", "name": "ferry", "keywords": ["boat", "ship", "yacht"] },
< 	{ "category": "travel_and_places", "char": "🛳", "name": "passenger_ship", "keywords": ["yacht", "cruise", "ferry"] },
< 	{ "category": "travel_and_places", "char": "🚀", "name": "rocket", "keywords": ["launch", "ship", "staffmode", "NASA", "outer space", "outer_space", "fly"] },
< 	{ "category": "travel_and_places", "char": "🛰", "name": "artificial_satellite", "keywords": ["communication", "gps", "orbit", "spaceflight", "NASA", "ISS"] },
< 	{ "category": "travel_and_places", "char": "🛻", "name": "pickup_truck", "keywords": ["car"] },
< 	{ "category": "travel_and_places", "char": "🛼", "name": "roller_skate", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "💺", "name": "seat", "keywords": ["sit", "airplane", "transport", "bus", "flight", "fly"] },
< 	{ "category": "travel_and_places", "char": "🛶", "name": "canoe", "keywords": ["boat", "paddle", "water", "ship"] },
< 	{ "category": "travel_and_places", "char": "⚓", "name": "anchor", "keywords": ["ship", "ferry", "sea", "boat"] },
< 	{ "category": "travel_and_places", "char": "🚧", "name": "construction", "keywords": ["wip", "progress", "caution", "warning"] },
< 	{ "category": "travel_and_places", "char": "⛽", "name": "fuelpump", "keywords": ["gas station", "petroleum"] },
< 	{ "category": "travel_and_places", "char": "🚏", "name": "busstop", "keywords": ["transportation", "wait"] },
< 	{ "category": "travel_and_places", "char": "🚦", "name": "vertical_traffic_light", "keywords": ["transportation", "driving"] },
< 	{ "category": "travel_and_places", "char": "🚥", "name": "traffic_light", "keywords": ["transportation", "signal"] },
< 	{ "category": "travel_and_places", "char": "🏁", "name": "checkered_flag", "keywords": ["contest", "finishline", "race", "gokart"] },
< 	{ "category": "travel_and_places", "char": "🚢", "name": "ship", "keywords": ["transportation", "titanic", "deploy"] },
< 	{ "category": "travel_and_places", "char": "🎡", "name": "ferris_wheel", "keywords": ["photo", "carnival", "londoneye"] },
< 	{ "category": "travel_and_places", "char": "🎢", "name": "roller_coaster", "keywords": ["carnival", "playground", "photo", "fun"] },
< 	{ "category": "travel_and_places", "char": "🎠", "name": "carousel_horse", "keywords": ["photo", "carnival"] },
< 	{ "category": "travel_and_places", "char": "🏗", "name": "building_construction", "keywords": ["wip", "working", "progress"] },
< 	{ "category": "travel_and_places", "char": "🌁", "name": "foggy", "keywords": ["photo", "mountain"] },
< 	{ "category": "travel_and_places", "char": "🏭", "name": "factory", "keywords": ["building", "industry", "pollution", "smoke"] },
< 	{ "category": "travel_and_places", "char": "⛲", "name": "fountain", "keywords": ["photo", "summer", "water", "fresh"] },
< 	{ "category": "travel_and_places", "char": "🎑", "name": "rice_scene", "keywords": ["photo", "japan", "asia", "tsukimi"] },
< 	{ "category": "travel_and_places", "char": "⛰", "name": "mountain", "keywords": ["photo", "nature", "environment"] },
< 	{ "category": "travel_and_places", "char": "🏔", "name": "mountain_snow", "keywords": ["photo", "nature", "environment", "winter", "cold"] },
< 	{ "category": "travel_and_places", "char": "🗻", "name": "mount_fuji", "keywords": ["photo", "mountain", "nature", "japanese"] },
< 	{ "category": "travel_and_places", "char": "🌋", "name": "volcano", "keywords": ["photo", "nature", "disaster"] },
< 	{ "category": "travel_and_places", "char": "🗾", "name": "japan", "keywords": ["nation", "country", "japanese", "asia"] },
< 	{ "category": "travel_and_places", "char": "🏕", "name": "camping", "keywords": ["photo", "outdoors", "tent"] },
< 	{ "category": "travel_and_places", "char": "⛺", "name": "tent", "keywords": ["photo", "camping", "outdoors"] },
< 	{ "category": "travel_and_places", "char": "🏞", "name": "national_park", "keywords": ["photo", "environment", "nature"] },
< 	{ "category": "travel_and_places", "char": "🛣", "name": "motorway", "keywords": ["road", "cupertino", "interstate", "highway"] },
< 	{ "category": "travel_and_places", "char": "🛤", "name": "railway_track", "keywords": ["train", "transportation"] },
< 	{ "category": "travel_and_places", "char": "🌅", "name": "sunrise", "keywords": ["morning", "view", "vacation", "photo"] },
< 	{ "category": "travel_and_places", "char": "🌄", "name": "sunrise_over_mountains", "keywords": ["view", "vacation", "photo"] },
< 	{ "category": "travel_and_places", "char": "🏜", "name": "desert", "keywords": ["photo", "warm", "saharah"] },
< 	{ "category": "travel_and_places", "char": "🏖", "name": "beach_umbrella", "keywords": ["weather", "summer", "sunny", "sand", "mojito"] },
< 	{ "category": "travel_and_places", "char": "🏝", "name": "desert_island", "keywords": ["photo", "tropical", "mojito"] },
< 	{ "category": "travel_and_places", "char": "🌇", "name": "city_sunrise", "keywords": ["photo", "good morning", "dawn"] },
< 	{ "category": "travel_and_places", "char": "🌆", "name": "city_sunset", "keywords": ["photo", "evening", "sky", "buildings"] },
< 	{ "category": "travel_and_places", "char": "🏙", "name": "cityscape", "keywords": ["photo", "night life", "urban"] },
< 	{ "category": "travel_and_places", "char": "🌃", "name": "night_with_stars", "keywords": ["evening", "city", "downtown"] },
< 	{ "category": "travel_and_places", "char": "🌉", "name": "bridge_at_night", "keywords": ["photo", "sanfrancisco"] },
< 	{ "category": "travel_and_places", "char": "🌌", "name": "milky_way", "keywords": ["photo", "space", "stars"] },
< 	{ "category": "travel_and_places", "char": "🌠", "name": "stars", "keywords": ["night", "photo"] },
< 	{ "category": "travel_and_places", "char": "🎇", "name": "sparkler", "keywords": ["stars", "night", "shine"] },
< 	{ "category": "travel_and_places", "char": "🎆", "name": "fireworks", "keywords": ["photo", "festival", "carnival", "congratulations"] },
< 	{ "category": "travel_and_places", "char": "🌈", "name": "rainbow", "keywords": ["nature", "happy", "unicorn_face", "photo", "sky", "spring"] },
< 	{ "category": "travel_and_places", "char": "🏘", "name": "houses", "keywords": ["buildings", "photo"] },
< 	{ "category": "travel_and_places", "char": "🏰", "name": "european_castle", "keywords": ["building", "royalty", "history"] },
< 	{ "category": "travel_and_places", "char": "🏯", "name": "japanese_castle", "keywords": ["photo", "building"] },
< 	{ "category": "travel_and_places", "char": "🗼", "name": "tokyo_tower", "keywords": ["photo", "japanese"] },
< 	{ "category": "travel_and_places", "char": "", "name": "shibuya_109", "keywords": ["photo", "japanese"] },
< 	{ "category": "travel_and_places", "char": "🏟", "name": "stadium", "keywords": ["photo", "place", "sports", "concert", "venue"] },
< 	{ "category": "travel_and_places", "char": "🗽", "name": "statue_of_liberty", "keywords": ["american", "newyork"] },
< 	{ "category": "travel_and_places", "char": "🏠", "name": "house", "keywords": ["building", "home"] },
< 	{ "category": "travel_and_places", "char": "🏡", "name": "house_with_garden", "keywords": ["home", "plant", "nature"] },
< 	{ "category": "travel_and_places", "char": "🏚", "name": "derelict_house", "keywords": ["abandon", "evict", "broken", "building"] },
< 	{ "category": "travel_and_places", "char": "🏢", "name": "office", "keywords": ["building", "bureau", "work"] },
< 	{ "category": "travel_and_places", "char": "🏬", "name": "department_store", "keywords": ["building", "shopping", "mall"] },
< 	{ "category": "travel_and_places", "char": "🏣", "name": "post_office", "keywords": ["building", "envelope", "communication"] },
< 	{ "category": "travel_and_places", "char": "🏤", "name": "european_post_office", "keywords": ["building", "email"] },
< 	{ "category": "travel_and_places", "char": "🏥", "name": "hospital", "keywords": ["building", "health", "surgery", "doctor"] },
< 	{ "category": "travel_and_places", "char": "🏦", "name": "bank", "keywords": ["building", "money", "sales", "cash", "business", "enterprise"] },
< 	{ "category": "travel_and_places", "char": "🏨", "name": "hotel", "keywords": ["building", "accomodation", "checkin"] },
< 	{ "category": "travel_and_places", "char": "🏪", "name": "convenience_store", "keywords": ["building", "shopping", "groceries"] },
< 	{ "category": "travel_and_places", "char": "🏫", "name": "school", "keywords": ["building", "student", "education", "learn", "teach"] },
< 	{ "category": "travel_and_places", "char": "🏩", "name": "love_hotel", "keywords": ["like", "affection", "dating"] },
< 	{ "category": "travel_and_places", "char": "💒", "name": "wedding", "keywords": ["love", "like", "affection", "couple", "marriage", "bride", "groom"] },
< 	{ "category": "travel_and_places", "char": "🏛", "name": "classical_building", "keywords": ["art", "culture", "history"] },
< 	{ "category": "travel_and_places", "char": "⛪", "name": "church", "keywords": ["building", "religion", "christ"] },
< 	{ "category": "travel_and_places", "char": "🕌", "name": "mosque", "keywords": ["islam", "worship", "minaret"] },
< 	{ "category": "travel_and_places", "char": "🕍", "name": "synagogue", "keywords": ["judaism", "worship", "temple", "jewish"] },
< 	{ "category": "travel_and_places", "char": "🕋", "name": "kaaba", "keywords": ["mecca", "mosque", "islam"] },
< 	{ "category": "travel_and_places", "char": "⛩", "name": "shinto_shrine", "keywords": ["temple", "japan", "kyoto"] },
< 	{ "category": "travel_and_places", "char": "🛕", "name": "hindu_temple", "keywords": ["temple"] },
< 	{ "category": "travel_and_places", "char": "🪨", "name": "rock", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "🪵", "name": "wood", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "🛖", "name": "hut", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "\uD83D\uDEDD", "name": "playground_slide", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "\uD83D\uDEDE", "name": "wheel", "keywords": [] },
< 	{ "category": "travel_and_places", "char": "\uD83D\uDEDF", "name": "ring_buoy", "keywords": [] },
< 	{ "category": "objects", "char": "⌚", "name": "watch", "keywords": ["time", "accessories"] },
< 	{ "category": "objects", "char": "📱", "name": "iphone", "keywords": ["technology", "apple", "gadgets", "dial"] },
< 	{ "category": "objects", "char": "📲", "name": "calling", "keywords": ["iphone", "incoming"] },
< 	{ "category": "objects", "char": "💻", "name": "computer", "keywords": ["technology", "laptop", "screen", "display", "monitor"] },
< 	{ "category": "objects", "char": "⌨", "name": "keyboard", "keywords": ["technology", "computer", "type", "input", "text"] },
< 	{ "category": "objects", "char": "🖥", "name": "desktop_computer", "keywords": ["technology", "computing", "screen"] },
< 	{ "category": "objects", "char": "🖨", "name": "printer", "keywords": ["paper", "ink"] },
< 	{ "category": "objects", "char": "🖱", "name": "computer_mouse", "keywords": ["click"] },
< 	{ "category": "objects", "char": "🖲", "name": "trackball", "keywords": ["technology", "trackpad"] },
< 	{ "category": "objects", "char": "🕹", "name": "joystick", "keywords": ["game", "play"] },
< 	{ "category": "objects", "char": "🗜", "name": "clamp", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "💽", "name": "minidisc", "keywords": ["technology", "record", "data", "disk", "90s"] },
< 	{ "category": "objects", "char": "💾", "name": "floppy_disk", "keywords": ["oldschool", "technology", "save", "90s", "80s"] },
< 	{ "category": "objects", "char": "💿", "name": "cd", "keywords": ["technology", "dvd", "disk", "disc", "90s"] },
< 	{ "category": "objects", "char": "📀", "name": "dvd", "keywords": ["cd", "disk", "disc"] },
< 	{ "category": "objects", "char": "📼", "name": "vhs", "keywords": ["record", "video", "oldschool", "90s", "80s"] },
< 	{ "category": "objects", "char": "📷", "name": "camera", "keywords": ["gadgets", "photography"] },
< 	{ "category": "objects", "char": "📸", "name": "camera_flash", "keywords": ["photography", "gadgets"] },
< 	{ "category": "objects", "char": "📹", "name": "video_camera", "keywords": ["film", "record"] },
< 	{ "category": "objects", "char": "🎥", "name": "movie_camera", "keywords": ["film", "record"] },
< 	{ "category": "objects", "char": "📽", "name": "film_projector", "keywords": ["video", "tape", "record", "movie"] },
< 	{ "category": "objects", "char": "🎞", "name": "film_strip", "keywords": ["movie"] },
< 	{ "category": "objects", "char": "📞", "name": "telephone_receiver", "keywords": ["technology", "communication", "dial"] },
< 	{ "category": "objects", "char": "☎️", "name": "phone", "keywords": ["technology", "communication", "dial", "telephone"] },
< 	{ "category": "objects", "char": "📟", "name": "pager", "keywords": ["bbcall", "oldschool", "90s"] },
< 	{ "category": "objects", "char": "📠", "name": "fax", "keywords": ["communication", "technology"] },
< 	{ "category": "objects", "char": "📺", "name": "tv", "keywords": ["technology", "program", "oldschool", "show", "television"] },
< 	{ "category": "objects", "char": "📻", "name": "radio", "keywords": ["communication", "music", "podcast", "program"] },
< 	{ "category": "objects", "char": "🎙", "name": "studio_microphone", "keywords": ["sing", "recording", "artist", "talkshow"] },
< 	{ "category": "objects", "char": "🎚", "name": "level_slider", "keywords": ["scale"] },
< 	{ "category": "objects", "char": "🎛", "name": "control_knobs", "keywords": ["dial"] },
< 	{ "category": "objects", "char": "🧭", "name": "compass", "keywords": ["magnetic", "navigation", "orienteering"] },
< 	{ "category": "objects", "char": "⏱", "name": "stopwatch", "keywords": ["time", "deadline"] },
< 	{ "category": "objects", "char": "⏲", "name": "timer_clock", "keywords": ["alarm"] },
< 	{ "category": "objects", "char": "⏰", "name": "alarm_clock", "keywords": ["time", "wake"] },
< 	{ "category": "objects", "char": "🕰", "name": "mantelpiece_clock", "keywords": ["time"] },
< 	{ "category": "objects", "char": "⏳", "name": "hourglass_flowing_sand", "keywords": ["oldschool", "time", "countdown"] },
< 	{ "category": "objects", "char": "⌛", "name": "hourglass", "keywords": ["time", "clock", "oldschool", "limit", "exam", "quiz", "test"] },
< 	{ "category": "objects", "char": "📡", "name": "satellite", "keywords": ["communication", "future", "radio", "space"] },
< 	{ "category": "objects", "char": "🔋", "name": "battery", "keywords": ["power", "energy", "sustain"] },
< 	{ "category": "objects", "char": "\uD83E\uDEAB", "name": "battery", "keywords": [] },
< 	{ "category": "objects", "char": "🔌", "name": "electric_plug", "keywords": ["charger", "power"] },
< 	{ "category": "objects", "char": "💡", "name": "bulb", "keywords": ["light", "electricity", "idea"] },
< 	{ "category": "objects", "char": "🔦", "name": "flashlight", "keywords": ["dark", "camping", "sight", "night"] },
< 	{ "category": "objects", "char": "🕯", "name": "candle", "keywords": ["fire", "wax"] },
< 	{ "category": "objects", "char": "🧯", "name": "fire_extinguisher", "keywords": ["quench"] },
< 	{ "category": "objects", "char": "🗑", "name": "wastebasket", "keywords": ["bin", "trash", "rubbish", "garbage", "toss"] },
< 	{ "category": "objects", "char": "🛢", "name": "oil_drum", "keywords": ["barrell"] },
< 	{ "category": "objects", "char": "💸", "name": "money_with_wings", "keywords": ["dollar", "bills", "payment", "sale"] },
< 	{ "category": "objects", "char": "💵", "name": "dollar", "keywords": ["money", "sales", "bill", "currency"] },
< 	{ "category": "objects", "char": "💴", "name": "yen", "keywords": ["money", "sales", "japanese", "dollar", "currency"] },
< 	{ "category": "objects", "char": "💶", "name": "euro", "keywords": ["money", "sales", "dollar", "currency"] },
< 	{ "category": "objects", "char": "💷", "name": "pound", "keywords": ["british", "sterling", "money", "sales", "bills", "uk", "england", "currency"] },
< 	{ "category": "objects", "char": "💰", "name": "moneybag", "keywords": ["dollar", "payment", "coins", "sale"] },
< 	{ "category": "objects", "char": "🪙", "name": "coin", "keywords": ["dollar", "payment", "coins", "sale"] },
< 	{ "category": "objects", "char": "💳", "name": "credit_card", "keywords": ["money", "sales", "dollar", "bill", "payment", "shopping"] },
< 	{ "category": "objects", "char": "\uD83E\uDEAB", "name": "identification_card", "keywords": [] },
< 	{ "category": "objects", "char": "💎", "name": "gem", "keywords": ["blue", "ruby", "diamond", "jewelry"] },
< 	{ "category": "objects", "char": "⚖", "name": "balance_scale", "keywords": ["law", "fairness", "weight"] },
< 	{ "category": "objects", "char": "🧰", "name": "toolbox", "keywords": ["tools", "diy", "fix", "maintainer", "mechanic"] },
< 	{ "category": "objects", "char": "🔧", "name": "wrench", "keywords": ["tools", "diy", "ikea", "fix", "maintainer"] },
< 	{ "category": "objects", "char": "🔨", "name": "hammer", "keywords": ["tools", "build", "create"] },
< 	{ "category": "objects", "char": "⚒", "name": "hammer_and_pick", "keywords": ["tools", "build", "create"] },
< 	{ "category": "objects", "char": "🛠", "name": "hammer_and_wrench", "keywords": ["tools", "build", "create"] },
< 	{ "category": "objects", "char": "⛏", "name": "pick", "keywords": ["tools", "dig"] },
< 	{ "category": "objects", "char": "🪓", "name": "axe", "keywords": ["tools"] },
< 	{ "category": "objects", "char": "🦯", "name": "probing_cane", "keywords": ["tools"] },
< 	{ "category": "objects", "char": "🔩", "name": "nut_and_bolt", "keywords": ["handy", "tools", "fix"] },
< 	{ "category": "objects", "char": "⚙", "name": "gear", "keywords": ["cog"] },
< 	{ "category": "objects", "char": "🪃", "name": "boomerang", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "🪚", "name": "carpentry_saw", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "🪛", "name": "screwdriver", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "🪝", "name": "hook", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "🪜", "name": "ladder", "keywords": ["tool"] },
< 	{ "category": "objects", "char": "🧱", "name": "brick", "keywords": ["bricks"] },
< 	{ "category": "objects", "char": "⛓", "name": "chains", "keywords": ["lock", "arrest"] },
< 	{ "category": "objects", "char": "🧲", "name": "magnet", "keywords": ["attraction", "magnetic"] },
< 	{ "category": "objects", "char": "🔫", "name": "gun", "keywords": ["violence", "weapon", "pistol", "revolver"] },
< 	{ "category": "objects", "char": "💣", "name": "bomb", "keywords": ["boom", "explode", "explosion", "terrorism"] },
< 	{ "category": "objects", "char": "🧨", "name": "firecracker", "keywords": ["dynamite", "boom", "explode", "explosion", "explosive"] },
< 	{ "category": "objects", "char": "🔪", "name": "hocho", "keywords": ["knife", "blade", "cutlery", "kitchen", "weapon"] },
< 	{ "category": "objects", "char": "🗡", "name": "dagger", "keywords": ["weapon"] },
< 	{ "category": "objects", "char": "⚔", "name": "crossed_swords", "keywords": ["weapon"] },
< 	{ "category": "objects", "char": "🛡", "name": "shield", "keywords": ["protection", "security"] },
< 	{ "category": "objects", "char": "🚬", "name": "smoking", "keywords": ["kills", "tobacco", "cigarette", "joint", "smoke"] },
< 	{ "category": "objects", "char": "☠", "name": "skull_and_crossbones", "keywords": ["poison", "danger", "deadly", "scary", "death", "pirate", "evil"] },
< 	{ "category": "objects", "char": "⚰", "name": "coffin", "keywords": ["vampire", "dead", "die", "death", "rip", "graveyard", "cemetery", "casket", "funeral", "box"] },
< 	{ "category": "objects", "char": "⚱", "name": "funeral_urn", "keywords": ["dead", "die", "death", "rip", "ashes"] },
< 	{ "category": "objects", "char": "🏺", "name": "amphora", "keywords": ["vase", "jar"] },
< 	{ "category": "objects", "char": "🔮", "name": "crystal_ball", "keywords": ["disco", "party", "magic", "circus", "fortune_teller"] },
< 	{ "category": "objects", "char": "📿", "name": "prayer_beads", "keywords": ["dhikr", "religious"] },
< 	{ "category": "objects", "char": "🧿", "name": "nazar_amulet", "keywords": ["bead", "charm"] },
< 	{ "category": "objects", "char": "💈", "name": "barber", "keywords": ["hair", "salon", "style"] },
< 	{ "category": "objects", "char": "⚗", "name": "alembic", "keywords": ["distilling", "science", "experiment", "chemistry"] },
< 	{ "category": "objects", "char": "🔭", "name": "telescope", "keywords": ["stars", "space", "zoom", "science", "astronomy"] },
< 	{ "category": "objects", "char": "🔬", "name": "microscope", "keywords": ["laboratory", "experiment", "zoomin", "science", "study"] },
< 	{ "category": "objects", "char": "🕳", "name": "hole", "keywords": ["embarrassing"] },
< 	{ "category": "objects", "char": "💊", "name": "pill", "keywords": ["health", "medicine", "doctor", "pharmacy", "drug"] },
< 	{ "category": "objects", "char": "💉", "name": "syringe", "keywords": ["health", "hospital", "drugs", "blood", "medicine", "needle", "doctor", "nurse"] },
< 	{ "category": "objects", "char": "🩸", "name": "drop_of_blood", "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"] },
< 	{ "category": "objects", "char": "🩹", "name": "adhesive_bandage", "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"] },
< 	{ "category": "objects", "char": "🩺", "name": "stethoscope", "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"] },
< 	{ "category": "objects", "char": "🪒", "name": "razor", "keywords": ["health"] },
< 	{ "category": "objects", "char": "\uD83E\uDE7B", "name": "xray", "keywords": [] },
< 	{ "category": "objects", "char": "\uD83E\uDE7C", "name": "crutch", "keywords": [] },
< 	{ "category": "objects", "char": "🧬", "name": "dna", "keywords": ["biologist", "genetics", "life"] },
< 	{ "category": "objects", "char": "🧫", "name": "petri_dish", "keywords": ["bacteria", "biology", "culture", "lab"] },
< 	{ "category": "objects", "char": "🧪", "name": "test_tube", "keywords": ["chemistry", "experiment", "lab", "science"] },
< 	{ "category": "objects", "char": "🌡", "name": "thermometer", "keywords": ["weather", "temperature", "hot", "cold"] },
< 	{ "category": "objects", "char": "🧹", "name": "broom", "keywords": ["cleaning", "sweeping", "witch"] },
< 	{ "category": "objects", "char": "🧺", "name": "basket", "keywords": ["laundry"] },
< 	{ "category": "objects", "char": "🧻", "name": "toilet_paper", "keywords": ["roll"] },
< 	{ "category": "objects", "char": "🏷", "name": "label", "keywords": ["sale", "tag"] },
< 	{ "category": "objects", "char": "🔖", "name": "bookmark", "keywords": ["favorite", "label", "save"] },
< 	{ "category": "objects", "char": "🚽", "name": "toilet", "keywords": ["restroom", "wc", "washroom", "bathroom", "potty"] },
< 	{ "category": "objects", "char": "🚿", "name": "shower", "keywords": ["clean", "water", "bathroom"] },
< 	{ "category": "objects", "char": "🛁", "name": "bathtub", "keywords": ["clean", "shower", "bathroom"] },
< 	{ "category": "objects", "char": "🧼", "name": "soap", "keywords": ["bar", "bathing", "cleaning", "lather"] },
< 	{ "category": "objects", "char": "🧽", "name": "sponge", "keywords": ["absorbing", "cleaning", "porous"] },
< 	{ "category": "objects", "char": "🧴", "name": "lotion_bottle", "keywords": ["moisturizer", "sunscreen"] },
< 	{ "category": "objects", "char": "🔑", "name": "key", "keywords": ["lock", "door", "password"] },
< 	{ "category": "objects", "char": "🗝", "name": "old_key", "keywords": ["lock", "door", "password"] },
< 	{ "category": "objects", "char": "🛋", "name": "couch_and_lamp", "keywords": ["read", "chill"] },
< 	{ "category": "objects", "char": "🪔", "name": "diya_Lamp", "keywords": ["light", "oil"] },
< 	{ "category": "objects", "char": "🛌", "name": "sleeping_bed", "keywords": ["bed", "rest"] },
< 	{ "category": "objects", "char": "🛏", "name": "bed", "keywords": ["sleep", "rest"] },
< 	{ "category": "objects", "char": "🚪", "name": "door", "keywords": ["house", "entry", "exit"] },
< 	{ "category": "objects", "char": "🪑", "name": "chair", "keywords": ["house", "desk"] },
< 	{ "category": "objects", "char": "🛎", "name": "bellhop_bell", "keywords": ["service"] },
< 	{ "category": "objects", "char": "🧸", "name": "teddy_bear", "keywords": ["plush", "stuffed"] },
< 	{ "category": "objects", "char": "🖼", "name": "framed_picture", "keywords": ["photography"] },
< 	{ "category": "objects", "char": "🗺", "name": "world_map", "keywords": ["location", "direction"] },
< 	{ "category": "objects", "char": "🛗", "name": "elevator", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪞", "name": "mirror", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪟", "name": "window", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪠", "name": "plunger", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪤", "name": "mouse_trap", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪣", "name": "bucket", "keywords": ["household"] },
< 	{ "category": "objects", "char": "🪥", "name": "toothbrush", "keywords": ["household"] },
< 	{ "category": "objects", "char": "\uD83E\uDEE7", "name": "bubbles", "keywords": [] },
< 	{ "category": "objects", "char": "⛱", "name": "parasol_on_ground", "keywords": ["weather", "summer"] },
< 	{ "category": "objects", "char": "🗿", "name": "moyai", "keywords": ["rock", "easter island", "moai"] },
< 	{ "category": "objects", "char": "🛍", "name": "shopping", "keywords": ["mall", "buy", "purchase"] },
< 	{ "category": "objects", "char": "🛒", "name": "shopping_cart", "keywords": ["trolley"] },
< 	{ "category": "objects", "char": "🎈", "name": "balloon", "keywords": ["party", "celebration", "birthday", "circus"] },
< 	{ "category": "objects", "char": "🎏", "name": "flags", "keywords": ["fish", "japanese", "koinobori", "carp", "banner"] },
< 	{ "category": "objects", "char": "🎀", "name": "ribbon", "keywords": ["decoration", "pink", "girl", "bowtie"] },
< 	{ "category": "objects", "char": "🎁", "name": "gift", "keywords": ["present", "birthday", "christmas", "xmas"] },
< 	{ "category": "objects", "char": "🎊", "name": "confetti_ball", "keywords": ["festival", "party", "birthday", "circus"] },
< 	{ "category": "objects", "char": "🎉", "name": "tada", "keywords": ["party", "congratulations", "birthday", "magic", "circus", "celebration"] },
< 	{ "category": "objects", "char": "🎎", "name": "dolls", "keywords": ["japanese", "toy", "kimono"] },
< 	{ "category": "objects", "char": "🎐", "name": "wind_chime", "keywords": ["nature", "ding", "spring", "bell"] },
< 	{ "category": "objects", "char": "🎌", "name": "crossed_flags", "keywords": ["japanese", "nation", "country", "border"] },
< 	{ "category": "objects", "char": "🏮", "name": "izakaya_lantern", "keywords": ["light", "paper", "halloween", "spooky"] },
< 	{ "category": "objects", "char": "🧧", "name": "red_envelope", "keywords": ["gift"] },
< 	{ "category": "objects", "char": "✉️", "name": "email", "keywords": ["letter", "postal", "inbox", "communication"] },
< 	{ "category": "objects", "char": "📩", "name": "envelope_with_arrow", "keywords": ["email", "communication"] },
< 	{ "category": "objects", "char": "📨", "name": "incoming_envelope", "keywords": ["email", "inbox"] },
< 	{ "category": "objects", "char": "📧", "name": "e-mail", "keywords": ["communication", "inbox"] },
< 	{ "category": "objects", "char": "💌", "name": "love_letter", "keywords": ["email", "like", "affection", "envelope", "valentines"] },
< 	{ "category": "objects", "char": "📮", "name": "postbox", "keywords": ["email", "letter", "envelope"] },
< 	{ "category": "objects", "char": "📪", "name": "mailbox_closed", "keywords": ["email", "communication", "inbox"] },
< 	{ "category": "objects", "char": "📫", "name": "mailbox", "keywords": ["email", "inbox", "communication"] },
< 	{ "category": "objects", "char": "📬", "name": "mailbox_with_mail", "keywords": ["email", "inbox", "communication"] },
< 	{ "category": "objects", "char": "📭", "name": "mailbox_with_no_mail", "keywords": ["email", "inbox"] },
< 	{ "category": "objects", "char": "📦", "name": "package", "keywords": ["mail", "gift", "cardboard", "box", "moving"] },
< 	{ "category": "objects", "char": "📯", "name": "postal_horn", "keywords": ["instrument", "music"] },
< 	{ "category": "objects", "char": "📥", "name": "inbox_tray", "keywords": ["email", "documents"] },
< 	{ "category": "objects", "char": "📤", "name": "outbox_tray", "keywords": ["inbox", "email"] },
< 	{ "category": "objects", "char": "📜", "name": "scroll", "keywords": ["documents", "ancient", "history", "paper"] },
< 	{ "category": "objects", "char": "📃", "name": "page_with_curl", "keywords": ["documents", "office", "paper"] },
< 	{ "category": "objects", "char": "📑", "name": "bookmark_tabs", "keywords": ["favorite", "save", "order", "tidy"] },
< 	{ "category": "objects", "char": "🧾", "name": "receipt", "keywords": ["accounting", "expenses"] },
< 	{ "category": "objects", "char": "📊", "name": "bar_chart", "keywords": ["graph", "presentation", "stats"] },
< 	{ "category": "objects", "char": "📈", "name": "chart_with_upwards_trend", "keywords": ["graph", "presentation", "stats", "recovery", "business", "economics", "money", "sales", "good", "success"] },
< 	{ "category": "objects", "char": "📉", "name": "chart_with_downwards_trend", "keywords": ["graph", "presentation", "stats", "recession", "business", "economics", "money", "sales", "bad", "failure"] },
< 	{ "category": "objects", "char": "📄", "name": "page_facing_up", "keywords": ["documents", "office", "paper", "information"] },
< 	{ "category": "objects", "char": "📅", "name": "date", "keywords": ["calendar", "schedule"] },
< 	{ "category": "objects", "char": "📆", "name": "calendar", "keywords": ["schedule", "date", "planning"] },
< 	{ "category": "objects", "char": "🗓", "name": "spiral_calendar", "keywords": ["date", "schedule", "planning"] },
< 	{ "category": "objects", "char": "📇", "name": "card_index", "keywords": ["business", "stationery"] },
< 	{ "category": "objects", "char": "🗃", "name": "card_file_box", "keywords": ["business", "stationery"] },
< 	{ "category": "objects", "char": "🗳", "name": "ballot_box", "keywords": ["election", "vote"] },
< 	{ "category": "objects", "char": "🗄", "name": "file_cabinet", "keywords": ["filing", "organizing"] },
< 	{ "category": "objects", "char": "📋", "name": "clipboard", "keywords": ["stationery", "documents"] },
< 	{ "category": "objects", "char": "🗒", "name": "spiral_notepad", "keywords": ["memo", "stationery"] },
< 	{ "category": "objects", "char": "📁", "name": "file_folder", "keywords": ["documents", "business", "office"] },
< 	{ "category": "objects", "char": "📂", "name": "open_file_folder", "keywords": ["documents", "load"] },
< 	{ "category": "objects", "char": "🗂", "name": "card_index_dividers", "keywords": ["organizing", "business", "stationery"] },
< 	{ "category": "objects", "char": "🗞", "name": "newspaper_roll", "keywords": ["press", "headline"] },
< 	{ "category": "objects", "char": "📰", "name": "newspaper", "keywords": ["press", "headline"] },
< 	{ "category": "objects", "char": "📓", "name": "notebook", "keywords": ["stationery", "record", "notes", "paper", "study"] },
< 	{ "category": "objects", "char": "📕", "name": "closed_book", "keywords": ["read", "library", "knowledge", "textbook", "learn"] },
< 	{ "category": "objects", "char": "📗", "name": "green_book", "keywords": ["read", "library", "knowledge", "study"] },
< 	{ "category": "objects", "char": "📘", "name": "blue_book", "keywords": ["read", "library", "knowledge", "learn", "study"] },
< 	{ "category": "objects", "char": "📙", "name": "orange_book", "keywords": ["read", "library", "knowledge", "textbook", "study"] },
< 	{ "category": "objects", "char": "📔", "name": "notebook_with_decorative_cover", "keywords": ["classroom", "notes", "record", "paper", "study"] },
< 	{ "category": "objects", "char": "📒", "name": "ledger", "keywords": ["notes", "paper"] },
< 	{ "category": "objects", "char": "📚", "name": "books", "keywords": ["literature", "library", "study"] },
< 	{ "category": "objects", "char": "📖", "name": "open_book", "keywords": ["book", "read", "library", "knowledge", "literature", "learn", "study"] },
< 	{ "category": "objects", "char": "🧷", "name": "safety_pin", "keywords": ["diaper"] },
< 	{ "category": "objects", "char": "🔗", "name": "link", "keywords": ["rings", "url"] },
< 	{ "category": "objects", "char": "📎", "name": "paperclip", "keywords": ["documents", "stationery"] },
< 	{ "category": "objects", "char": "🖇", "name": "paperclips", "keywords": ["documents", "stationery"] },
< 	{ "category": "objects", "char": "✂️", "name": "scissors", "keywords": ["stationery", "cut"] },
< 	{ "category": "objects", "char": "📐", "name": "triangular_ruler", "keywords": ["stationery", "math", "architect", "sketch"] },
< 	{ "category": "objects", "char": "📏", "name": "straight_ruler", "keywords": ["stationery", "calculate", "length", "math", "school", "drawing", "architect", "sketch"] },
< 	{ "category": "objects", "char": "🧮", "name": "abacus", "keywords": ["calculation"] },
< 	{ "category": "objects", "char": "📌", "name": "pushpin", "keywords": ["stationery", "mark", "here"] },
< 	{ "category": "objects", "char": "📍", "name": "round_pushpin", "keywords": ["stationery", "location", "map", "here"] },
< 	{ "category": "objects", "char": "🚩", "name": "triangular_flag_on_post", "keywords": ["mark", "milestone", "place"] },
< 	{ "category": "objects", "char": "🏳", "name": "white_flag", "keywords": ["losing", "loser", "lost", "surrender", "give up", "fail"] },
< 	{ "category": "objects", "char": "🏴", "name": "black_flag", "keywords": ["pirate"] },
< 	{ "category": "objects", "char": "🏳️‍🌈", "name": "rainbow_flag", "keywords": ["flag", "rainbow", "pride", "gay", "lgbt", "glbt", "queer", "homosexual", "lesbian", "bisexual", "transgender"] },
< 	{ "category": "objects", "char": "🏳️‍⚧️", "name": "transgender_flag", "keywords": ["flag", "transgender"] },
< 	{ "category": "objects", "char": "🔐", "name": "closed_lock_with_key", "keywords": ["security", "privacy"] },
< 	{ "category": "objects", "char": "🔒", "name": "lock", "keywords": ["security", "password", "padlock"] },
< 	{ "category": "objects", "char": "🔓", "name": "unlock", "keywords": ["privacy", "security"] },
< 	{ "category": "objects", "char": "🔏", "name": "lock_with_ink_pen", "keywords": ["security", "secret"] },
< 	{ "category": "objects", "char": "🖊", "name": "pen", "keywords": ["stationery", "writing", "write"] },
< 	{ "category": "objects", "char": "🖋", "name": "fountain_pen", "keywords": ["stationery", "writing", "write"] },
< 	{ "category": "objects", "char": "✒️", "name": "black_nib", "keywords": ["pen", "stationery", "writing", "write"] },
< 	{ "category": "objects", "char": "📝", "name": "memo", "keywords": ["write", "documents", "stationery", "pencil", "paper", "writing", "legal", "exam", "quiz", "test", "study", "compose"] },
< 	{ "category": "objects", "char": "✏️", "name": "pencil2", "keywords": ["stationery", "write", "paper", "writing", "school", "study"] },
< 	{ "category": "objects", "char": "🖍", "name": "crayon", "keywords": ["drawing", "creativity"] },
< 	{ "category": "objects", "char": "🖌", "name": "paintbrush", "keywords": ["drawing", "creativity", "art"] },
< 	{ "category": "objects", "char": "🔍", "name": "mag", "keywords": ["search", "zoom", "find", "detective"] },
< 	{ "category": "objects", "char": "🔎", "name": "mag_right", "keywords": ["search", "zoom", "find", "detective"] },
< 	{ "category": "objects", "char": "🪦", "name": "headstone", "keywords": [] },
< 	{ "category": "objects", "char": "🪧", "name": "placard", "keywords": [] },
< 	{ "category": "symbols", "char": "💯", "name": "100", "keywords": ["score", "perfect", "numbers", "century", "exam", "quiz", "test", "pass", "hundred"] },
< 	{ "category": "symbols", "char": "🔢", "name": "1234", "keywords": ["numbers", "blue-square"] },
< 	{ "category": "symbols", "char": "❤️", "name": "heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "🧡", "name": "orange_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💛", "name": "yellow_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💚", "name": "green_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💙", "name": "blue_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💜", "name": "purple_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "🤎", "name": "brown_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "🖤", "name": "black_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "🤍", "name": "white_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💔", "name": "broken_heart", "keywords": ["sad", "sorry", "break", "heart", "heartbreak"] },
< 	{ "category": "symbols", "char": "❣", "name": "heavy_heart_exclamation", "keywords": ["decoration", "love"] },
< 	{ "category": "symbols", "char": "💕", "name": "two_hearts", "keywords": ["love", "like", "affection", "valentines", "heart"] },
< 	{ "category": "symbols", "char": "💞", "name": "revolving_hearts", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💓", "name": "heartbeat", "keywords": ["love", "like", "affection", "valentines", "pink", "heart"] },
< 	{ "category": "symbols", "char": "💗", "name": "heartpulse", "keywords": ["like", "love", "affection", "valentines", "pink"] },
< 	{ "category": "symbols", "char": "💖", "name": "sparkling_heart", "keywords": ["love", "like", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💘", "name": "cupid", "keywords": ["love", "like", "heart", "affection", "valentines"] },
< 	{ "category": "symbols", "char": "💝", "name": "gift_heart", "keywords": ["love", "valentines"] },
< 	{ "category": "symbols", "char": "💟", "name": "heart_decoration", "keywords": ["purple-square", "love", "like"] },
< 	{ "category": "symbols", "char": "\u2764\uFE0F\u200D\uD83D\uDD25", "name": "heart_on_fire", "keywords": [] },
< 	{ "category": "symbols", "char": "\u2764\uFE0F\u200D\uD83E\uDE79", "name": "mending_heart", "keywords": [] },
< 	{ "category": "symbols", "char": "☮", "name": "peace_symbol", "keywords": ["hippie"] },
< 	{ "category": "symbols", "char": "✝", "name": "latin_cross", "keywords": ["christianity"] },
< 	{ "category": "symbols", "char": "☪", "name": "star_and_crescent", "keywords": ["islam"] },
< 	{ "category": "symbols", "char": "🕉", "name": "om", "keywords": ["hinduism", "buddhism", "sikhism", "jainism"] },
< 	{ "category": "symbols", "char": "☸", "name": "wheel_of_dharma", "keywords": ["hinduism", "buddhism", "sikhism", "jainism"] },
< 	{ "category": "symbols", "char": "✡", "name": "star_of_david", "keywords": ["judaism"] },
< 	{ "category": "symbols", "char": "🔯", "name": "six_pointed_star", "keywords": ["purple-square", "religion", "jewish", "hexagram"] },
< 	{ "category": "symbols", "char": "🕎", "name": "menorah", "keywords": ["hanukkah", "candles", "jewish"] },
< 	{ "category": "symbols", "char": "☯", "name": "yin_yang", "keywords": ["balance"] },
< 	{ "category": "symbols", "char": "☦", "name": "orthodox_cross", "keywords": ["suppedaneum", "religion"] },
< 	{ "category": "symbols", "char": "🛐", "name": "place_of_worship", "keywords": ["religion", "church", "temple", "prayer"] },
< 	{ "category": "symbols", "char": "⛎", "name": "ophiuchus", "keywords": ["sign", "purple-square", "constellation", "astrology"] },
< 	{ "category": "symbols", "char": "♈", "name": "aries", "keywords": ["sign", "purple-square", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "♉", "name": "taurus", "keywords": ["purple-square", "sign", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "♊", "name": "gemini", "keywords": ["sign", "zodiac", "purple-square", "astrology"] },
< 	{ "category": "symbols", "char": "♋", "name": "cancer", "keywords": ["sign", "zodiac", "purple-square", "astrology"] },
< 	{ "category": "symbols", "char": "♌", "name": "leo", "keywords": ["sign", "purple-square", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "♍", "name": "virgo", "keywords": ["sign", "zodiac", "purple-square", "astrology"] },
< 	{ "category": "symbols", "char": "♎", "name": "libra", "keywords": ["sign", "purple-square", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "♏", "name": "scorpius", "keywords": ["sign", "zodiac", "purple-square", "astrology", "scorpio"] },
< 	{ "category": "symbols", "char": "♐", "name": "sagittarius", "keywords": ["sign", "zodiac", "purple-square", "astrology"] },
< 	{ "category": "symbols", "char": "♑", "name": "capricorn", "keywords": ["sign", "zodiac", "purple-square", "astrology"] },
< 	{ "category": "symbols", "char": "♒", "name": "aquarius", "keywords": ["sign", "purple-square", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "♓", "name": "pisces", "keywords": ["purple-square", "sign", "zodiac", "astrology"] },
< 	{ "category": "symbols", "char": "🆔", "name": "id", "keywords": ["purple-square", "words"] },
< 	{ "category": "symbols", "char": "⚛", "name": "atom_symbol", "keywords": ["science", "physics", "chemistry"] },
< 	{ "category": "symbols", "char": "⚧️", "name": "transgender_symbol", "keywords": ["purple-square", "woman", "female", "toilet", "loo", "restroom", "gender"] },
< 	{ "category": "symbols", "char": "🈳", "name": "u7a7a", "keywords": ["kanji", "japanese", "chinese", "empty", "sky", "blue-square", "aki"] },
< 	{ "category": "symbols", "char": "🈹", "name": "u5272", "keywords": ["cut", "divide", "chinese", "kanji", "pink-square", "waribiki"] },
< 	{ "category": "symbols", "char": "☢", "name": "radioactive", "keywords": ["nuclear", "danger"] },
< 	{ "category": "symbols", "char": "☣", "name": "biohazard", "keywords": ["danger"] },
< 	{ "category": "symbols", "char": "📴", "name": "mobile_phone_off", "keywords": ["mute", "orange-square", "silence", "quiet"] },
< 	{ "category": "symbols", "char": "📳", "name": "vibration_mode", "keywords": ["orange-square", "phone"] },
< 	{ "category": "symbols", "char": "🈶", "name": "u6709", "keywords": ["orange-square", "chinese", "have", "kanji", "ari"] },
< 	{ "category": "symbols", "char": "🈚", "name": "u7121", "keywords": ["nothing", "chinese", "kanji", "japanese", "orange-square", "nashi"] },
< 	{ "category": "symbols", "char": "🈸", "name": "u7533", "keywords": ["chinese", "japanese", "kanji", "orange-square", "moushikomi"] },
< 	{ "category": "symbols", "char": "🈺", "name": "u55b6", "keywords": ["japanese", "opening hours", "orange-square", "eigyo"] },
< 	{ "category": "symbols", "char": "🈷️", "name": "u6708", "keywords": ["chinese", "month", "moon", "japanese", "orange-square", "kanji", "tsuki", "tsukigime", "getsugaku"] },
< 	{ "category": "symbols", "char": "✴️", "name": "eight_pointed_black_star", "keywords": ["orange-square", "shape", "polygon"] },
< 	{ "category": "symbols", "char": "🆚", "name": "vs", "keywords": ["words", "orange-square"] },
< 	{ "category": "symbols", "char": "🉑", "name": "accept", "keywords": ["ok", "good", "chinese", "kanji", "agree", "yes", "orange-circle"] },
< 	{ "category": "symbols", "char": "💮", "name": "white_flower", "keywords": ["japanese", "spring"] },
< 	{ "category": "symbols", "char": "🉐", "name": "ideograph_advantage", "keywords": ["chinese", "kanji", "obtain", "get", "circle"] },
< 	{ "category": "symbols", "char": "㊙️", "name": "secret", "keywords": ["privacy", "chinese", "sshh", "kanji", "red-circle"] },
< 	{ "category": "symbols", "char": "㊗️", "name": "congratulations", "keywords": ["chinese", "kanji", "japanese", "red-circle"] },
< 	{ "category": "symbols", "char": "🈴", "name": "u5408", "keywords": ["japanese", "chinese", "join", "kanji", "red-square", "goukaku", "pass"] },
< 	{ "category": "symbols", "char": "🈵", "name": "u6e80", "keywords": ["full", "chinese", "japanese", "red-square", "kanji", "man"] },
< 	{ "category": "symbols", "char": "🈲", "name": "u7981", "keywords": ["kanji", "japanese", "chinese", "forbidden", "limit", "restricted", "red-square", "kinshi"] },
< 	{ "category": "symbols", "char": "🅰️", "name": "a", "keywords": ["red-square", "alphabet", "letter"] },
< 	{ "category": "symbols", "char": "🅱️", "name": "b", "keywords": ["red-square", "alphabet", "letter"] },
< 	{ "category": "symbols", "char": "🆎", "name": "ab", "keywords": ["red-square", "alphabet"] },
< 	{ "category": "symbols", "char": "🆑", "name": "cl", "keywords": ["alphabet", "words", "red-square"] },
< 	{ "category": "symbols", "char": "🅾️", "name": "o2", "keywords": ["alphabet", "red-square", "letter"] },
< 	{ "category": "symbols", "char": "🆘", "name": "sos", "keywords": ["help", "red-square", "words", "emergency", "911"] },
< 	{ "category": "symbols", "char": "⛔", "name": "no_entry", "keywords": ["limit", "security", "privacy", "bad", "denied", "stop", "circle"] },
< 	{ "category": "symbols", "char": "📛", "name": "name_badge", "keywords": ["fire", "forbid"] },
< 	{ "category": "symbols", "char": "🚫", "name": "no_entry_sign", "keywords": ["forbid", "stop", "limit", "denied", "disallow", "circle"] },
< 	{ "category": "symbols", "char": "❌", "name": "x", "keywords": ["no", "delete", "remove", "cancel", "red"] },
< 	{ "category": "symbols", "char": "⭕", "name": "o", "keywords": ["circle", "round"] },
< 	{ "category": "symbols", "char": "🛑", "name": "stop_sign", "keywords": ["stop"] },
< 	{ "category": "symbols", "char": "💢", "name": "anger", "keywords": ["angry", "mad"] },
< 	{ "category": "symbols", "char": "♨️", "name": "hotsprings", "keywords": ["bath", "warm", "relax"] },
< 	{ "category": "symbols", "char": "🚷", "name": "no_pedestrians", "keywords": ["rules", "crossing", "walking", "circle"] },
< 	{ "category": "symbols", "char": "🚯", "name": "do_not_litter", "keywords": ["trash", "bin", "garbage", "circle"] },
< 	{ "category": "symbols", "char": "🚳", "name": "no_bicycles", "keywords": ["cyclist", "prohibited", "circle"] },
< 	{ "category": "symbols", "char": "🚱", "name": "non-potable_water", "keywords": ["drink", "faucet", "tap", "circle"] },
< 	{ "category": "symbols", "char": "🔞", "name": "underage", "keywords": ["18", "drink", "pub", "night", "minor", "circle"] },
< 	{ "category": "symbols", "char": "📵", "name": "no_mobile_phones", "keywords": ["iphone", "mute", "circle"] },
< 	{ "category": "symbols", "char": "❗", "name": "exclamation", "keywords": ["heavy_exclamation_mark", "danger", "surprise", "punctuation", "wow", "warning"] },
< 	{ "category": "symbols", "char": "❕", "name": "grey_exclamation", "keywords": ["surprise", "punctuation", "gray", "wow", "warning"] },
< 	{ "category": "symbols", "char": "❓", "name": "question", "keywords": ["doubt", "confused"] },
< 	{ "category": "symbols", "char": "❔", "name": "grey_question", "keywords": ["doubts", "gray", "huh", "confused"] },
< 	{ "category": "symbols", "char": "‼️", "name": "bangbang", "keywords": ["exclamation", "surprise"] },
< 	{ "category": "symbols", "char": "⁉️", "name": "interrobang", "keywords": ["wat", "punctuation", "surprise"] },
< 	{ "category": "symbols", "char": "🔅", "name": "low_brightness", "keywords": ["sun", "afternoon", "warm", "summer"] },
< 	{ "category": "symbols", "char": "🔆", "name": "high_brightness", "keywords": ["sun", "light"] },
< 	{ "category": "symbols", "char": "🔱", "name": "trident", "keywords": ["weapon", "spear"] },
< 	{ "category": "symbols", "char": "⚜", "name": "fleur_de_lis", "keywords": ["decorative", "scout"] },
< 	{ "category": "symbols", "char": "〽️", "name": "part_alternation_mark", "keywords": ["graph", "presentation", "stats", "business", "economics", "bad"] },
< 	{ "category": "symbols", "char": "⚠️", "name": "warning", "keywords": ["exclamation", "wip", "alert", "error", "problem", "issue"] },
< 	{ "category": "symbols", "char": "🚸", "name": "children_crossing", "keywords": ["school", "warning", "danger", "sign", "driving", "yellow-diamond"] },
< 	{ "category": "symbols", "char": "🔰", "name": "beginner", "keywords": ["badge", "shield"] },
< 	{ "category": "symbols", "char": "♻️", "name": "recycle", "keywords": ["arrow", "environment", "garbage", "trash"] },
< 	{ "category": "symbols", "char": "🈯", "name": "u6307", "keywords": ["chinese", "point", "green-square", "kanji", "reserved", "shiteiseki"] },
< 	{ "category": "symbols", "char": "💹", "name": "chart", "keywords": ["green-square", "graph", "presentation", "stats"] },
< 	{ "category": "symbols", "char": "❇️", "name": "sparkle", "keywords": ["stars", "green-square", "awesome", "good", "fireworks"] },
< 	{ "category": "symbols", "char": "✳️", "name": "eight_spoked_asterisk", "keywords": ["star", "sparkle", "green-square"] },
< 	{ "category": "symbols", "char": "❎", "name": "negative_squared_cross_mark", "keywords": ["x", "green-square", "no", "deny"] },
< 	{ "category": "symbols", "char": "✅", "name": "white_check_mark", "keywords": ["green-square", "ok", "agree", "vote", "election", "answer", "tick"] },
< 	{ "category": "symbols", "char": "💠", "name": "diamond_shape_with_a_dot_inside", "keywords": ["jewel", "blue", "gem", "crystal", "fancy"] },
< 	{ "category": "symbols", "char": "🌀", "name": "cyclone", "keywords": ["weather", "swirl", "blue", "cloud", "vortex", "spiral", "whirlpool", "spin", "tornado", "hurricane", "typhoon"] },
< 	{ "category": "symbols", "char": "➿", "name": "loop", "keywords": ["tape", "cassette"] },
< 	{ "category": "symbols", "char": "🌐", "name": "globe_with_meridians", "keywords": ["earth", "international", "world", "internet", "interweb", "i18n"] },
< 	{ "category": "symbols", "char": "Ⓜ️", "name": "m", "keywords": ["alphabet", "blue-circle", "letter"] },
< 	{ "category": "symbols", "char": "🏧", "name": "atm", "keywords": ["money", "sales", "cash", "blue-square", "payment", "bank"] },
< 	{ "category": "symbols", "char": "🈂️", "name": "sa", "keywords": ["japanese", "blue-square", "katakana"] },
< 	{ "category": "symbols", "char": "🛂", "name": "passport_control", "keywords": ["custom", "blue-square"] },
< 	{ "category": "symbols", "char": "🛃", "name": "customs", "keywords": ["passport", "border", "blue-square"] },
< 	{ "category": "symbols", "char": "🛄", "name": "baggage_claim", "keywords": ["blue-square", "airport", "transport"] },
< 	{ "category": "symbols", "char": "🛅", "name": "left_luggage", "keywords": ["blue-square", "travel"] },
< 	{ "category": "symbols", "char": "♿", "name": "wheelchair", "keywords": ["blue-square", "disabled", "a11y", "accessibility"] },
< 	{ "category": "symbols", "char": "🚭", "name": "no_smoking", "keywords": ["cigarette", "blue-square", "smell", "smoke"] },
< 	{ "category": "symbols", "char": "🚾", "name": "wc", "keywords": ["toilet", "restroom", "blue-square"] },
< 	{ "category": "symbols", "char": "🅿️", "name": "parking", "keywords": ["cars", "blue-square", "alphabet", "letter"] },
< 	{ "category": "symbols", "char": "🚰", "name": "potable_water", "keywords": ["blue-square", "liquid", "restroom", "cleaning", "faucet"] },
< 	{ "category": "symbols", "char": "🚹", "name": "mens", "keywords": ["toilet", "restroom", "wc", "blue-square", "gender", "male"] },
< 	{ "category": "symbols", "char": "🚺", "name": "womens", "keywords": ["purple-square", "woman", "female", "toilet", "loo", "restroom", "gender"] },
< 	{ "category": "symbols", "char": "🚼", "name": "baby_symbol", "keywords": ["orange-square", "child"] },
< 	{ "category": "symbols", "char": "🚻", "name": "restroom", "keywords": ["blue-square", "toilet", "refresh", "wc", "gender"] },
< 	{ "category": "symbols", "char": "🚮", "name": "put_litter_in_its_place", "keywords": ["blue-square", "sign", "human", "info"] },
< 	{ "category": "symbols", "char": "🎦", "name": "cinema", "keywords": ["blue-square", "record", "film", "movie", "curtain", "stage", "theater"] },
< 	{ "category": "symbols", "char": "📶", "name": "signal_strength", "keywords": ["blue-square", "reception", "phone", "internet", "connection", "wifi", "bluetooth", "bars"] },
< 	{ "category": "symbols", "char": "🈁", "name": "koko", "keywords": ["blue-square", "here", "katakana", "japanese", "destination"] },
< 	{ "category": "symbols", "char": "🆖", "name": "ng", "keywords": ["blue-square", "words", "shape", "icon"] },
< 	{ "category": "symbols", "char": "🆗", "name": "ok", "keywords": ["good", "agree", "yes", "blue-square"] },
< 	{ "category": "symbols", "char": "🆙", "name": "up", "keywords": ["blue-square", "above", "high"] },
< 	{ "category": "symbols", "char": "🆒", "name": "cool", "keywords": ["words", "blue-square"] },
< 	{ "category": "symbols", "char": "🆕", "name": "new", "keywords": ["blue-square", "words", "start"] },
< 	{ "category": "symbols", "char": "🆓", "name": "free", "keywords": ["blue-square", "words"] },
< 	{ "category": "symbols", "char": "0️⃣", "name": "zero", "keywords": ["0", "numbers", "blue-square", "null"] },
< 	{ "category": "symbols", "char": "1️⃣", "name": "one", "keywords": ["blue-square", "numbers", "1"] },
< 	{ "category": "symbols", "char": "2️⃣", "name": "two", "keywords": ["numbers", "2", "prime", "blue-square"] },
< 	{ "category": "symbols", "char": "3️⃣", "name": "three", "keywords": ["3", "numbers", "prime", "blue-square"] },
< 	{ "category": "symbols", "char": "4️⃣", "name": "four", "keywords": ["4", "numbers", "blue-square"] },
< 	{ "category": "symbols", "char": "5️⃣", "name": "five", "keywords": ["5", "numbers", "blue-square", "prime"] },
< 	{ "category": "symbols", "char": "6️⃣", "name": "six", "keywords": ["6", "numbers", "blue-square"] },
< 	{ "category": "symbols", "char": "7️⃣", "name": "seven", "keywords": ["7", "numbers", "blue-square", "prime"] },
< 	{ "category": "symbols", "char": "8️⃣", "name": "eight", "keywords": ["8", "blue-square", "numbers"] },
< 	{ "category": "symbols", "char": "9️⃣", "name": "nine", "keywords": ["blue-square", "numbers", "9"] },
< 	{ "category": "symbols", "char": "🔟", "name": "keycap_ten", "keywords": ["numbers", "10", "blue-square"] },
< 	{ "category": "symbols", "char": "*⃣", "name": "asterisk", "keywords": ["star", "keycap"] },
< 	{ "category": "symbols", "char": "⏏️", "name": "eject_button", "keywords": ["blue-square"] },
< 	{ "category": "symbols", "char": "▶️", "name": "arrow_forward", "keywords": ["blue-square", "right", "direction", "play"] },
< 	{ "category": "symbols", "char": "⏸", "name": "pause_button", "keywords": ["pause", "blue-square"] },
< 	{ "category": "symbols", "char": "⏭", "name": "next_track_button", "keywords": ["forward", "next", "blue-square"] },
< 	{ "category": "symbols", "char": "⏹", "name": "stop_button", "keywords": ["blue-square"] },
< 	{ "category": "symbols", "char": "⏺", "name": "record_button", "keywords": ["blue-square"] },
< 	{ "category": "symbols", "char": "⏯", "name": "play_or_pause_button", "keywords": ["blue-square", "play", "pause"] },
< 	{ "category": "symbols", "char": "⏮", "name": "previous_track_button", "keywords": ["backward"] },
< 	{ "category": "symbols", "char": "⏩", "name": "fast_forward", "keywords": ["blue-square", "play", "speed", "continue"] },
< 	{ "category": "symbols", "char": "⏪", "name": "rewind", "keywords": ["play", "blue-square"] },
< 	{ "category": "symbols", "char": "🔀", "name": "twisted_rightwards_arrows", "keywords": ["blue-square", "shuffle", "music", "random"] },
< 	{ "category": "symbols", "char": "🔁", "name": "repeat", "keywords": ["loop", "record"] },
< 	{ "category": "symbols", "char": "🔂", "name": "repeat_one", "keywords": ["blue-square", "loop"] },
< 	{ "category": "symbols", "char": "◀️", "name": "arrow_backward", "keywords": ["blue-square", "left", "direction"] },
< 	{ "category": "symbols", "char": "🔼", "name": "arrow_up_small", "keywords": ["blue-square", "triangle", "direction", "point", "forward", "top"] },
< 	{ "category": "symbols", "char": "🔽", "name": "arrow_down_small", "keywords": ["blue-square", "direction", "bottom"] },
< 	{ "category": "symbols", "char": "⏫", "name": "arrow_double_up", "keywords": ["blue-square", "direction", "top"] },
< 	{ "category": "symbols", "char": "⏬", "name": "arrow_double_down", "keywords": ["blue-square", "direction", "bottom"] },
< 	{ "category": "symbols", "char": "➡️", "name": "arrow_right", "keywords": ["blue-square", "next"] },
< 	{ "category": "symbols", "char": "⬅️", "name": "arrow_left", "keywords": ["blue-square", "previous", "back"] },
< 	{ "category": "symbols", "char": "⬆️", "name": "arrow_up", "keywords": ["blue-square", "continue", "top", "direction"] },
< 	{ "category": "symbols", "char": "⬇️", "name": "arrow_down", "keywords": ["blue-square", "direction", "bottom"] },
< 	{ "category": "symbols", "char": "↗️", "name": "arrow_upper_right", "keywords": ["blue-square", "point", "direction", "diagonal", "northeast"] },
< 	{ "category": "symbols", "char": "↘️", "name": "arrow_lower_right", "keywords": ["blue-square", "direction", "diagonal", "southeast"] },
< 	{ "category": "symbols", "char": "↙️", "name": "arrow_lower_left", "keywords": ["blue-square", "direction", "diagonal", "southwest"] },
< 	{ "category": "symbols", "char": "↖️", "name": "arrow_upper_left", "keywords": ["blue-square", "point", "direction", "diagonal", "northwest"] },
< 	{ "category": "symbols", "char": "↕️", "name": "arrow_up_down", "keywords": ["blue-square", "direction", "way", "vertical"] },
< 	{ "category": "symbols", "char": "↔️", "name": "left_right_arrow", "keywords": ["shape", "direction", "horizontal", "sideways"] },
< 	{ "category": "symbols", "char": "🔄", "name": "arrows_counterclockwise", "keywords": ["blue-square", "sync", "cycle"] },
< 	{ "category": "symbols", "char": "↪️", "name": "arrow_right_hook", "keywords": ["blue-square", "return", "rotate", "direction"] },
< 	{ "category": "symbols", "char": "↩️", "name": "leftwards_arrow_with_hook", "keywords": ["back", "return", "blue-square", "undo", "enter"] },
< 	{ "category": "symbols", "char": "⤴️", "name": "arrow_heading_up", "keywords": ["blue-square", "direction", "top"] },
< 	{ "category": "symbols", "char": "⤵️", "name": "arrow_heading_down", "keywords": ["blue-square", "direction", "bottom"] },
< 	{ "category": "symbols", "char": "#️⃣", "name": "hash", "keywords": ["symbol", "blue-square", "twitter"] },
< 	{ "category": "symbols", "char": "ℹ️", "name": "information_source", "keywords": ["blue-square", "alphabet", "letter"] },
< 	{ "category": "symbols", "char": "🔤", "name": "abc", "keywords": ["blue-square", "alphabet"] },
< 	{ "category": "symbols", "char": "🔡", "name": "abcd", "keywords": ["blue-square", "alphabet"] },
< 	{ "category": "symbols", "char": "🔠", "name": "capital_abcd", "keywords": ["alphabet", "words", "blue-square"] },
< 	{ "category": "symbols", "char": "🔣", "name": "symbols", "keywords": ["blue-square", "music", "note", "ampersand", "percent", "glyphs", "characters"] },
< 	{ "category": "symbols", "char": "🎵", "name": "musical_note", "keywords": ["score", "tone", "sound"] },
< 	{ "category": "symbols", "char": "🎶", "name": "notes", "keywords": ["music", "score"] },
< 	{ "category": "symbols", "char": "〰️", "name": "wavy_dash", "keywords": ["draw", "line", "moustache", "mustache", "squiggle", "scribble"] },
< 	{ "category": "symbols", "char": "➰", "name": "curly_loop", "keywords": ["scribble", "draw", "shape", "squiggle"] },
< 	{ "category": "symbols", "char": "✔️", "name": "heavy_check_mark", "keywords": ["ok", "nike", "answer", "yes", "tick"] },
< 	{ "category": "symbols", "char": "🔃", "name": "arrows_clockwise", "keywords": ["sync", "cycle", "round", "repeat"] },
< 	{ "category": "symbols", "char": "➕", "name": "heavy_plus_sign", "keywords": ["math", "calculation", "addition", "more", "increase"] },
< 	{ "category": "symbols", "char": "➖", "name": "heavy_minus_sign", "keywords": ["math", "calculation", "subtract", "less"] },
< 	{ "category": "symbols", "char": "➗", "name": "heavy_division_sign", "keywords": ["divide", "math", "calculation"] },
< 	{ "category": "symbols", "char": "✖️", "name": "heavy_multiplication_x", "keywords": ["math", "calculation"] },
< 	{ "category": "symbols", "char": "\uD83D\uDFF0", "name": "heavy_equals_sign", "keywords": [] },
< 	{ "category": "symbols", "char": "♾", "name": "infinity", "keywords": ["forever"] },
< 	{ "category": "symbols", "char": "💲", "name": "heavy_dollar_sign", "keywords": ["money", "sales", "payment", "currency", "buck"] },
< 	{ "category": "symbols", "char": "💱", "name": "currency_exchange", "keywords": ["money", "sales", "dollar", "travel"] },
< 	{ "category": "symbols", "char": "©️", "name": "copyright", "keywords": ["ip", "license", "circle", "law", "legal"] },
< 	{ "category": "symbols", "char": "®️", "name": "registered", "keywords": ["alphabet", "circle"] },
< 	{ "category": "symbols", "char": "™️", "name": "tm", "keywords": ["trademark", "brand", "law", "legal"] },
< 	{ "category": "symbols", "char": "🔚", "name": "end", "keywords": ["words", "arrow"] },
< 	{ "category": "symbols", "char": "🔙", "name": "back", "keywords": ["arrow", "words", "return"] },
< 	{ "category": "symbols", "char": "🔛", "name": "on", "keywords": ["arrow", "words"] },
< 	{ "category": "symbols", "char": "🔝", "name": "top", "keywords": ["words", "blue-square"] },
< 	{ "category": "symbols", "char": "🔜", "name": "soon", "keywords": ["arrow", "words"] },
< 	{ "category": "symbols", "char": "☑️", "name": "ballot_box_with_check", "keywords": ["ok", "agree", "confirm", "black-square", "vote", "election", "yes", "tick"] },
< 	{ "category": "symbols", "char": "🔘", "name": "radio_button", "keywords": ["input", "old", "music", "circle"] },
< 	{ "category": "symbols", "char": "⚫", "name": "black_circle", "keywords": ["shape", "button", "round"] },
< 	{ "category": "symbols", "char": "⚪", "name": "white_circle", "keywords": ["shape", "round"] },
< 	{ "category": "symbols", "char": "🔴", "name": "red_circle", "keywords": ["shape", "error", "danger"] },
< 	{ "category": "symbols", "char": "🟠", "name": "orange_circle", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟡", "name": "yellow_circle", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟢", "name": "green_circle", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🔵", "name": "large_blue_circle", "keywords": ["shape", "icon", "button"] },
< 	{ "category": "symbols", "char": "🟣", "name": "purple_circle", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟤", "name": "brown_circle", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🔸", "name": "small_orange_diamond", "keywords": ["shape", "jewel", "gem"] },
< 	{ "category": "symbols", "char": "🔹", "name": "small_blue_diamond", "keywords": ["shape", "jewel", "gem"] },
< 	{ "category": "symbols", "char": "🔶", "name": "large_orange_diamond", "keywords": ["shape", "jewel", "gem"] },
< 	{ "category": "symbols", "char": "🔷", "name": "large_blue_diamond", "keywords": ["shape", "jewel", "gem"] },
< 	{ "category": "symbols", "char": "🔺", "name": "small_red_triangle", "keywords": ["shape", "direction", "up", "top"] },
< 	{ "category": "symbols", "char": "▪️", "name": "black_small_square", "keywords": ["shape", "icon"] },
< 	{ "category": "symbols", "char": "▫️", "name": "white_small_square", "keywords": ["shape", "icon"] },
< 	{ "category": "symbols", "char": "⬛", "name": "black_large_square", "keywords": ["shape", "icon", "button"] },
< 	{ "category": "symbols", "char": "⬜", "name": "white_large_square", "keywords": ["shape", "icon", "stone", "button"] },
< 	{ "category": "symbols", "char": "🟥", "name": "red_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟧", "name": "orange_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟨", "name": "yellow_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟩", "name": "green_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟦", "name": "blue_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟪", "name": "purple_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🟫", "name": "brown_square", "keywords": ["shape"] },
< 	{ "category": "symbols", "char": "🔻", "name": "small_red_triangle_down", "keywords": ["shape", "direction", "bottom"] },
< 	{ "category": "symbols", "char": "◼️", "name": "black_medium_square", "keywords": ["shape", "button", "icon"] },
< 	{ "category": "symbols", "char": "◻️", "name": "white_medium_square", "keywords": ["shape", "stone", "icon"] },
< 	{ "category": "symbols", "char": "◾", "name": "black_medium_small_square", "keywords": ["icon", "shape", "button"] },
< 	{ "category": "symbols", "char": "◽", "name": "white_medium_small_square", "keywords": ["shape", "stone", "icon", "button"] },
< 	{ "category": "symbols", "char": "🔲", "name": "black_square_button", "keywords": ["shape", "input", "frame"] },
< 	{ "category": "symbols", "char": "🔳", "name": "white_square_button", "keywords": ["shape", "input"] },
< 	{ "category": "symbols", "char": "🔈", "name": "speaker", "keywords": ["sound", "volume", "silence", "broadcast"] },
< 	{ "category": "symbols", "char": "🔉", "name": "sound", "keywords": ["volume", "speaker", "broadcast"] },
< 	{ "category": "symbols", "char": "🔊", "name": "loud_sound", "keywords": ["volume", "noise", "noisy", "speaker", "broadcast"] },
< 	{ "category": "symbols", "char": "🔇", "name": "mute", "keywords": ["sound", "volume", "silence", "quiet"] },
< 	{ "category": "symbols", "char": "📣", "name": "mega", "keywords": ["sound", "speaker", "volume"] },
< 	{ "category": "symbols", "char": "📢", "name": "loudspeaker", "keywords": ["volume", "sound"] },
< 	{ "category": "symbols", "char": "🔔", "name": "bell", "keywords": ["sound", "notification", "christmas", "xmas", "chime"] },
< 	{ "category": "symbols", "char": "🔕", "name": "no_bell", "keywords": ["sound", "volume", "mute", "quiet", "silent"] },
< 	{ "category": "symbols", "char": "🃏", "name": "black_joker", "keywords": ["poker", "cards", "game", "play", "magic"] },
< 	{ "category": "symbols", "char": "🀄", "name": "mahjong", "keywords": ["game", "play", "chinese", "kanji"] },
< 	{ "category": "symbols", "char": "♠️", "name": "spades", "keywords": ["poker", "cards", "suits", "magic"] },
< 	{ "category": "symbols", "char": "♣️", "name": "clubs", "keywords": ["poker", "cards", "magic", "suits"] },
< 	{ "category": "symbols", "char": "♥️", "name": "hearts", "keywords": ["poker", "cards", "magic", "suits"] },
< 	{ "category": "symbols", "char": "♦️", "name": "diamonds", "keywords": ["poker", "cards", "magic", "suits"] },
< 	{ "category": "symbols", "char": "🎴", "name": "flower_playing_cards", "keywords": ["game", "sunset", "red"] },
< 	{ "category": "symbols", "char": "💭", "name": "thought_balloon", "keywords": ["bubble", "cloud", "speech", "thinking", "dream"] },
< 	{ "category": "symbols", "char": "🗯", "name": "right_anger_bubble", "keywords": ["caption", "speech", "thinking", "mad"] },
< 	{ "category": "symbols", "char": "💬", "name": "speech_balloon", "keywords": ["bubble", "words", "message", "talk", "chatting"] },
< 	{ "category": "symbols", "char": "🗨", "name": "left_speech_bubble", "keywords": ["words", "message", "talk", "chatting"] },
< 	{ "category": "symbols", "char": "🕐", "name": "clock1", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕑", "name": "clock2", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕒", "name": "clock3", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕓", "name": "clock4", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕔", "name": "clock5", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕕", "name": "clock6", "keywords": ["time", "late", "early", "schedule", "dawn", "dusk"] },
< 	{ "category": "symbols", "char": "🕖", "name": "clock7", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕗", "name": "clock8", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕘", "name": "clock9", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕙", "name": "clock10", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕚", "name": "clock11", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕛", "name": "clock12", "keywords": ["time", "noon", "midnight", "midday", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕜", "name": "clock130", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕝", "name": "clock230", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕞", "name": "clock330", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕟", "name": "clock430", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕠", "name": "clock530", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕡", "name": "clock630", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕢", "name": "clock730", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕣", "name": "clock830", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕤", "name": "clock930", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕥", "name": "clock1030", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕦", "name": "clock1130", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "symbols", "char": "🕧", "name": "clock1230", "keywords": ["time", "late", "early", "schedule"] },
< 	{ "category": "flags", "char": "🇦🇫", "name": "afghanistan", "keywords": ["af", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇽", "name": "aland_islands", "keywords": ["Åland", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇱", "name": "albania", "keywords": ["al", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇿", "name": "algeria", "keywords": ["dz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇸", "name": "american_samoa", "keywords": ["american", "ws", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇩", "name": "andorra", "keywords": ["ad", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇴", "name": "angola", "keywords": ["ao", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇮", "name": "anguilla", "keywords": ["ai", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇶", "name": "antarctica", "keywords": ["aq", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇬", "name": "antigua_barbuda", "keywords": ["antigua", "barbuda", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇷", "name": "argentina", "keywords": ["ar", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇲", "name": "armenia", "keywords": ["am", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇼", "name": "aruba", "keywords": ["aw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇨", "name": "ascension_island", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇺", "name": "australia", "keywords": ["au", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇹", "name": "austria", "keywords": ["at", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇿", "name": "azerbaijan", "keywords": ["az", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇸", "name": "bahamas", "keywords": ["bs", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇭", "name": "bahrain", "keywords": ["bh", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇩", "name": "bangladesh", "keywords": ["bd", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇧", "name": "barbados", "keywords": ["bb", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇾", "name": "belarus", "keywords": ["by", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇪", "name": "belgium", "keywords": ["be", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇿", "name": "belize", "keywords": ["bz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇯", "name": "benin", "keywords": ["bj", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇲", "name": "bermuda", "keywords": ["bm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇹", "name": "bhutan", "keywords": ["bt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇴", "name": "bolivia", "keywords": ["bo", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇶", "name": "caribbean_netherlands", "keywords": ["bonaire", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇦", "name": "bosnia_herzegovina", "keywords": ["bosnia", "herzegovina", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇼", "name": "botswana", "keywords": ["bw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇷", "name": "brazil", "keywords": ["br", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇴", "name": "british_indian_ocean_territory", "keywords": ["british", "indian", "ocean", "territory", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇬", "name": "british_virgin_islands", "keywords": ["british", "virgin", "islands", "bvi", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇳", "name": "brunei", "keywords": ["bn", "darussalam", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇬", "name": "bulgaria", "keywords": ["bg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇫", "name": "burkina_faso", "keywords": ["burkina", "faso", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇮", "name": "burundi", "keywords": ["bi", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇻", "name": "cape_verde", "keywords": ["cabo", "verde", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇭", "name": "cambodia", "keywords": ["kh", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇲", "name": "cameroon", "keywords": ["cm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇦", "name": "canada", "keywords": ["ca", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇨", "name": "canary_islands", "keywords": ["canary", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇾", "name": "cayman_islands", "keywords": ["cayman", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇫", "name": "central_african_republic", "keywords": ["central", "african", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇩", "name": "chad", "keywords": ["td", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇱", "name": "chile", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇳", "name": "cn", "keywords": ["china", "chinese", "prc", "flag", "country", "nation", "banner"] },
< 	{ "category": "flags", "char": "🇨🇽", "name": "christmas_island", "keywords": ["christmas", "island", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇨", "name": "cocos_islands", "keywords": ["cocos", "keeling", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇴", "name": "colombia", "keywords": ["co", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇲", "name": "comoros", "keywords": ["km", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇬", "name": "congo_brazzaville", "keywords": ["congo", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇩", "name": "congo_kinshasa", "keywords": ["congo", "democratic", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇰", "name": "cook_islands", "keywords": ["cook", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇷", "name": "costa_rica", "keywords": ["costa", "rica", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇭🇷", "name": "croatia", "keywords": ["hr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇺", "name": "cuba", "keywords": ["cu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇼", "name": "curacao", "keywords": ["curaçao", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇾", "name": "cyprus", "keywords": ["cy", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇿", "name": "czech_republic", "keywords": ["cz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇰", "name": "denmark", "keywords": ["dk", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇯", "name": "djibouti", "keywords": ["dj", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇲", "name": "dominica", "keywords": ["dm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇴", "name": "dominican_republic", "keywords": ["dominican", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇨", "name": "ecuador", "keywords": ["ec", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇬", "name": "egypt", "keywords": ["eg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇻", "name": "el_salvador", "keywords": ["el", "salvador", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇶", "name": "equatorial_guinea", "keywords": ["equatorial", "gn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇷", "name": "eritrea", "keywords": ["er", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇪", "name": "estonia", "keywords": ["ee", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇹", "name": "ethiopia", "keywords": ["et", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇺", "name": "eu", "keywords": ["european", "union", "flag", "banner"] },
< 	{ "category": "flags", "char": "🇫🇰", "name": "falkland_islands", "keywords": ["falkland", "islands", "malvinas", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇫🇴", "name": "faroe_islands", "keywords": ["faroe", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇫🇯", "name": "fiji", "keywords": ["fj", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇫🇮", "name": "finland", "keywords": ["fi", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇫🇷", "name": "fr", "keywords": ["banner", "flag", "nation", "france", "french", "country"] },
< 	{ "category": "flags", "char": "🇬🇫", "name": "french_guiana", "keywords": ["french", "guiana", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇫", "name": "french_polynesia", "keywords": ["french", "polynesia", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇫", "name": "french_southern_territories", "keywords": ["french", "southern", "territories", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇦", "name": "gabon", "keywords": ["ga", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇲", "name": "gambia", "keywords": ["gm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇪", "name": "georgia", "keywords": ["ge", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇩🇪", "name": "de", "keywords": ["german", "nation", "flag", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇭", "name": "ghana", "keywords": ["gh", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇮", "name": "gibraltar", "keywords": ["gi", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇷", "name": "greece", "keywords": ["gr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇱", "name": "greenland", "keywords": ["gl", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇩", "name": "grenada", "keywords": ["gd", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇵", "name": "guadeloupe", "keywords": ["gp", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇺", "name": "guam", "keywords": ["gu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇹", "name": "guatemala", "keywords": ["gt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇬", "name": "guernsey", "keywords": ["gg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇳", "name": "guinea", "keywords": ["gn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇼", "name": "guinea_bissau", "keywords": ["gw", "bissau", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇾", "name": "guyana", "keywords": ["gy", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇭🇹", "name": "haiti", "keywords": ["ht", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇭🇳", "name": "honduras", "keywords": ["hn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇭🇰", "name": "hong_kong", "keywords": ["hong", "kong", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇭🇺", "name": "hungary", "keywords": ["hu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇸", "name": "iceland", "keywords": ["is", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇳", "name": "india", "keywords": ["in", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇩", "name": "indonesia", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇷", "name": "iran", "keywords": ["iran, ", "islamic", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇶", "name": "iraq", "keywords": ["iq", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇪", "name": "ireland", "keywords": ["ie", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇲", "name": "isle_of_man", "keywords": ["isle", "man", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇱", "name": "israel", "keywords": ["il", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇮🇹", "name": "it", "keywords": ["italy", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇮", "name": "cote_divoire", "keywords": ["ivory", "coast", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇯🇲", "name": "jamaica", "keywords": ["jm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇯🇵", "name": "jp", "keywords": ["japanese", "nation", "flag", "country", "banner"] },
< 	{ "category": "flags", "char": "🇯🇪", "name": "jersey", "keywords": ["je", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇯🇴", "name": "jordan", "keywords": ["jo", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇿", "name": "kazakhstan", "keywords": ["kz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇪", "name": "kenya", "keywords": ["ke", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇮", "name": "kiribati", "keywords": ["ki", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇽🇰", "name": "kosovo", "keywords": ["xk", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇼", "name": "kuwait", "keywords": ["kw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇬", "name": "kyrgyzstan", "keywords": ["kg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇦", "name": "laos", "keywords": ["lao", "democratic", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇻", "name": "latvia", "keywords": ["lv", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇧", "name": "lebanon", "keywords": ["lb", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇸", "name": "lesotho", "keywords": ["ls", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇷", "name": "liberia", "keywords": ["lr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇾", "name": "libya", "keywords": ["ly", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇮", "name": "liechtenstein", "keywords": ["li", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇹", "name": "lithuania", "keywords": ["lt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇺", "name": "luxembourg", "keywords": ["lu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇴", "name": "macau", "keywords": ["macao", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇰", "name": "macedonia", "keywords": ["macedonia, ", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇬", "name": "madagascar", "keywords": ["mg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇼", "name": "malawi", "keywords": ["mw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇾", "name": "malaysia", "keywords": ["my", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇻", "name": "maldives", "keywords": ["mv", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇱", "name": "mali", "keywords": ["ml", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇹", "name": "malta", "keywords": ["mt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇭", "name": "marshall_islands", "keywords": ["marshall", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇶", "name": "martinique", "keywords": ["mq", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇷", "name": "mauritania", "keywords": ["mr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇺", "name": "mauritius", "keywords": ["mu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇾🇹", "name": "mayotte", "keywords": ["yt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇽", "name": "mexico", "keywords": ["mx", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇫🇲", "name": "micronesia", "keywords": ["micronesia, ", "federated", "states", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇩", "name": "moldova", "keywords": ["moldova, ", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇨", "name": "monaco", "keywords": ["mc", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇳", "name": "mongolia", "keywords": ["mn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇪", "name": "montenegro", "keywords": ["me", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇸", "name": "montserrat", "keywords": ["ms", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇦", "name": "morocco", "keywords": ["ma", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇿", "name": "mozambique", "keywords": ["mz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇲", "name": "myanmar", "keywords": ["mm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇦", "name": "namibia", "keywords": ["na", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇷", "name": "nauru", "keywords": ["nr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇵", "name": "nepal", "keywords": ["np", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇱", "name": "netherlands", "keywords": ["nl", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇨", "name": "new_caledonia", "keywords": ["new", "caledonia", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇿", "name": "new_zealand", "keywords": ["new", "zealand", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇮", "name": "nicaragua", "keywords": ["ni", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇪", "name": "niger", "keywords": ["ne", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇬", "name": "nigeria", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇺", "name": "niue", "keywords": ["nu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇫", "name": "norfolk_island", "keywords": ["norfolk", "island", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇲🇵", "name": "northern_mariana_islands", "keywords": ["northern", "mariana", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇵", "name": "north_korea", "keywords": ["north", "korea", "nation", "flag", "country", "banner"] },
< 	{ "category": "flags", "char": "🇳🇴", "name": "norway", "keywords": ["no", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇴🇲", "name": "oman", "keywords": ["om_symbol", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇰", "name": "pakistan", "keywords": ["pk", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇼", "name": "palau", "keywords": ["pw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇸", "name": "palestinian_territories", "keywords": ["palestine", "palestinian", "territories", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇦", "name": "panama", "keywords": ["pa", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇬", "name": "papua_new_guinea", "keywords": ["papua", "new", "guinea", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇾", "name": "paraguay", "keywords": ["py", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇪", "name": "peru", "keywords": ["pe", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇭", "name": "philippines", "keywords": ["ph", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇳", "name": "pitcairn_islands", "keywords": ["pitcairn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇱", "name": "poland", "keywords": ["pl", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇹", "name": "portugal", "keywords": ["pt", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇷", "name": "puerto_rico", "keywords": ["puerto", "rico", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇶🇦", "name": "qatar", "keywords": ["qa", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇷🇪", "name": "reunion", "keywords": ["réunion", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇷🇴", "name": "romania", "keywords": ["ro", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇷🇺", "name": "ru", "keywords": ["russian", "federation", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇷🇼", "name": "rwanda", "keywords": ["rw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇧🇱", "name": "st_barthelemy", "keywords": ["saint", "barthélemy", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇭", "name": "st_helena", "keywords": ["saint", "helena", "ascension", "tristan", "cunha", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇳", "name": "st_kitts_nevis", "keywords": ["saint", "kitts", "nevis", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇨", "name": "st_lucia", "keywords": ["saint", "lucia", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇵🇲", "name": "st_pierre_miquelon", "keywords": ["saint", "pierre", "miquelon", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇨", "name": "st_vincent_grenadines", "keywords": ["saint", "vincent", "grenadines", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇼🇸", "name": "samoa", "keywords": ["ws", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇲", "name": "san_marino", "keywords": ["san", "marino", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇹", "name": "sao_tome_principe", "keywords": ["sao", "tome", "principe", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇦", "name": "saudi_arabia", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇳", "name": "senegal", "keywords": ["sn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇷🇸", "name": "serbia", "keywords": ["rs", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇨", "name": "seychelles", "keywords": ["sc", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇱", "name": "sierra_leone", "keywords": ["sierra", "leone", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇬", "name": "singapore", "keywords": ["sg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇽", "name": "sint_maarten", "keywords": ["sint", "maarten", "dutch", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇰", "name": "slovakia", "keywords": ["sk", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇮", "name": "slovenia", "keywords": ["si", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇧", "name": "solomon_islands", "keywords": ["solomon", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇴", "name": "somalia", "keywords": ["so", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇿🇦", "name": "south_africa", "keywords": ["south", "africa", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇸", "name": "south_georgia_south_sandwich_islands", "keywords": ["south", "georgia", "sandwich", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇰🇷", "name": "kr", "keywords": ["south", "korea", "nation", "flag", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇸", "name": "south_sudan", "keywords": ["south", "sd", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇸", "name": "es", "keywords": ["spain", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇱🇰", "name": "sri_lanka", "keywords": ["sri", "lanka", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇩", "name": "sudan", "keywords": ["sd", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇷", "name": "suriname", "keywords": ["sr", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇿", "name": "swaziland", "keywords": ["sz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇪", "name": "sweden", "keywords": ["se", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇨🇭", "name": "switzerland", "keywords": ["ch", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇸🇾", "name": "syria", "keywords": ["syrian", "arab", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇼", "name": "taiwan", "keywords": ["tw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇯", "name": "tajikistan", "keywords": ["tj", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇿", "name": "tanzania", "keywords": ["tanzania, ", "united", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇭", "name": "thailand", "keywords": ["th", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇱", "name": "timor_leste", "keywords": ["timor", "leste", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇬", "name": "togo", "keywords": ["tg", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇰", "name": "tokelau", "keywords": ["tk", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇴", "name": "tonga", "keywords": ["to", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇹", "name": "trinidad_tobago", "keywords": ["trinidad", "tobago", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇦", "name": "tristan_da_cunha", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇳", "name": "tunisia", "keywords": ["tn", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇷", "name": "tr", "keywords": ["turkey", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇲", "name": "turkmenistan", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇨", "name": "turks_caicos_islands", "keywords": ["turks", "caicos", "islands", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇹🇻", "name": "tuvalu", "keywords": ["flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇺🇬", "name": "uganda", "keywords": ["ug", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇺🇦", "name": "ukraine", "keywords": ["ua", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇦🇪", "name": "united_arab_emirates", "keywords": ["united", "arab", "emirates", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇬🇧", "name": "uk", "keywords": ["united", "kingdom", "great", "britain", "northern", "ireland", "flag", "nation", "country", "banner", "british", "UK", "english", "england", "union jack"] },
< 	{ "category": "flags", "char": "🏴󠁧󠁢󠁥󠁮󠁧󠁿", "name": "england", "keywords": ["flag", "english"] },
< 	{ "category": "flags", "char": "🏴󠁧󠁢󠁳󠁣󠁴󠁿", "name": "scotland", "keywords": ["flag", "scottish"] },
< 	{ "category": "flags", "char": "🏴󠁧󠁢󠁷󠁬󠁳󠁿", "name": "wales", "keywords": ["flag", "welsh"] },
< 	{ "category": "flags", "char": "🇺🇸", "name": "us", "keywords": ["united", "states", "america", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇮", "name": "us_virgin_islands", "keywords": ["virgin", "islands", "us", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇺🇾", "name": "uruguay", "keywords": ["uy", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇺🇿", "name": "uzbekistan", "keywords": ["uz", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇺", "name": "vanuatu", "keywords": ["vu", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇦", "name": "vatican_city", "keywords": ["vatican", "city", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇪", "name": "venezuela", "keywords": ["ve", "bolivarian", "republic", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇻🇳", "name": "vietnam", "keywords": ["viet", "nam", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇼🇫", "name": "wallis_futuna", "keywords": ["wallis", "futuna", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇪🇭", "name": "western_sahara", "keywords": ["western", "sahara", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇾🇪", "name": "yemen", "keywords": ["ye", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇿🇲", "name": "zambia", "keywords": ["zm", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇿🇼", "name": "zimbabwe", "keywords": ["zw", "flag", "nation", "country", "banner"] },
< 	{ "category": "flags", "char": "🇺🇳", "name": "united_nations", "keywords": ["un", "flag", "banner"] },
< 	{ "category": "flags", "char": "🏴‍☠️", "name": "pirate_flag", "keywords": ["skull", "crossbones", "flag", "banner"] }
---
>   {
>     "category": "face",
>     "char": "😀",
>     "name": "grinning",
>     "keywords": ["face", "smile", "happy", "joy", ": D", "grin"]
>   },
>   {
>     "category": "face",
>     "char": "😬",
>     "name": "grimacing",
>     "keywords": ["face", "grimace", "teeth"]
>   },
>   {
>     "category": "face",
>     "char": "😁",
>     "name": "grin",
>     "keywords": ["face", "happy", "smile", "joy", "kawaii"]
>   },
>   {
>     "category": "face",
>     "char": "😂",
>     "name": "joy",
>     "keywords": ["face", "cry", "tears", "weep", "happy", "happytears", "haha"]
>   },
>   {
>     "category": "face",
>     "char": "🤣",
>     "name": "rofl",
>     "keywords": ["face", "rolling", "floor", "laughing", "lol", "haha"]
>   },
>   {
>     "category": "face",
>     "char": "🥳",
>     "name": "partying",
>     "keywords": ["face", "celebration", "woohoo"]
>   },
>   {
>     "category": "face",
>     "char": "😃",
>     "name": "smiley",
>     "keywords": ["face", "happy", "joy", "haha", ": D", ": )", "smile", "funny"]
>   },
>   {
>     "category": "face",
>     "char": "😄",
>     "name": "smile",
>     "keywords": [
>       "face",
>       "happy",
>       "joy",
>       "funny",
>       "haha",
>       "laugh",
>       "like",
>       ": D",
>       ": )"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😅",
>     "name": "sweat_smile",
>     "keywords": ["face", "hot", "happy", "laugh", "sweat", "smile", "relief"]
>   },
>   {
>     "category": "face",
>     "char": "🥲",
>     "name": "smiling_face_with_tear",
>     "keywords": ["face"]
>   },
>   {
>     "category": "face",
>     "char": "😆",
>     "name": "laughing",
>     "keywords": [
>       "happy",
>       "joy",
>       "lol",
>       "satisfied",
>       "haha",
>       "face",
>       "glad",
>       "XD",
>       "laugh"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😇",
>     "name": "innocent",
>     "keywords": ["face", "angel", "heaven", "halo"]
>   },
>   {
>     "category": "face",
>     "char": "😉",
>     "name": "wink",
>     "keywords": ["face", "happy", "mischievous", "secret", ";)", "smile", "eye"]
>   },
>   {
>     "category": "face",
>     "char": "😊",
>     "name": "blush",
>     "keywords": [
>       "face",
>       "smile",
>       "happy",
>       "flushed",
>       "crush",
>       "embarrassed",
>       "shy",
>       "joy"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🙂",
>     "name": "slightly_smiling_face",
>     "keywords": ["face", "smile"]
>   },
>   {
>     "category": "face",
>     "char": "🙃",
>     "name": "upside_down_face",
>     "keywords": ["face", "flipped", "silly", "smile"]
>   },
>   {
>     "category": "face",
>     "char": "☺️",
>     "name": "relaxed",
>     "keywords": ["face", "blush", "massage", "happiness"]
>   },
>   {
>     "category": "face",
>     "char": "😋",
>     "name": "yum",
>     "keywords": [
>       "happy",
>       "joy",
>       "tongue",
>       "smile",
>       "face",
>       "silly",
>       "yummy",
>       "nom",
>       "delicious",
>       "savouring"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😌",
>     "name": "relieved",
>     "keywords": ["face", "relaxed", "phew", "massage", "happiness"]
>   },
>   {
>     "category": "face",
>     "char": "😍",
>     "name": "heart_eyes",
>     "keywords": [
>       "face",
>       "love",
>       "like",
>       "affection",
>       "valentines",
>       "infatuation",
>       "crush",
>       "heart"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🥰",
>     "name": "smiling_face_with_three_hearts",
>     "keywords": [
>       "face",
>       "love",
>       "like",
>       "affection",
>       "valentines",
>       "infatuation",
>       "crush",
>       "hearts",
>       "adore"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😘",
>     "name": "kissing_heart",
>     "keywords": [
>       "face",
>       "love",
>       "like",
>       "affection",
>       "valentines",
>       "infatuation",
>       "kiss"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😗",
>     "name": "kissing",
>     "keywords": [
>       "love",
>       "like",
>       "face",
>       "3",
>       "valentines",
>       "infatuation",
>       "kiss"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😙",
>     "name": "kissing_smiling_eyes",
>     "keywords": ["face", "affection", "valentines", "infatuation", "kiss"]
>   },
>   {
>     "category": "face",
>     "char": "😚",
>     "name": "kissing_closed_eyes",
>     "keywords": [
>       "face",
>       "love",
>       "like",
>       "affection",
>       "valentines",
>       "infatuation",
>       "kiss"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😜",
>     "name": "stuck_out_tongue_winking_eye",
>     "keywords": [
>       "face",
>       "prank",
>       "childish",
>       "playful",
>       "mischievous",
>       "smile",
>       "wink",
>       "tongue"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🤪",
>     "name": "zany",
>     "keywords": ["face", "goofy", "crazy"]
>   },
>   {
>     "category": "face",
>     "char": "🤨",
>     "name": "raised_eyebrow",
>     "keywords": [
>       "face",
>       "distrust",
>       "scepticism",
>       "disapproval",
>       "disbelief",
>       "surprise"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🧐",
>     "name": "monocle",
>     "keywords": ["face", "stuffy", "wealthy"]
>   },
>   {
>     "category": "face",
>     "char": "😝",
>     "name": "stuck_out_tongue_closed_eyes",
>     "keywords": ["face", "prank", "playful", "mischievous", "smile", "tongue"]
>   },
>   {
>     "category": "face",
>     "char": "😛",
>     "name": "stuck_out_tongue",
>     "keywords": [
>       "face",
>       "prank",
>       "childish",
>       "playful",
>       "mischievous",
>       "smile",
>       "tongue"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🤑",
>     "name": "money_mouth_face",
>     "keywords": ["face", "rich", "dollar", "money"]
>   },
>   {
>     "category": "face",
>     "char": "🤓",
>     "name": "nerd_face",
>     "keywords": ["face", "nerdy", "geek", "dork"]
>   },
>   {
>     "category": "face",
>     "char": "🥸",
>     "name": "disguised_face",
>     "keywords": ["face", "nose", "glasses", "incognito"]
>   },
>   {
>     "category": "face",
>     "char": "😎",
>     "name": "sunglasses",
>     "keywords": ["face", "cool", "smile", "summer", "beach", "sunglass"]
>   },
>   {
>     "category": "face",
>     "char": "🤩",
>     "name": "star_struck",
>     "keywords": ["face", "smile", "starry", "eyes", "grinning"]
>   },
>   {
>     "category": "face",
>     "char": "🤡",
>     "name": "clown_face",
>     "keywords": ["face"]
>   },
>   {
>     "category": "face",
>     "char": "🤠",
>     "name": "cowboy_hat_face",
>     "keywords": ["face", "cowgirl", "hat"]
>   },
>   {
>     "category": "face",
>     "char": "🤗",
>     "name": "hugs",
>     "keywords": ["face", "smile", "hug"]
>   },
>   {
>     "category": "face",
>     "char": "😏",
>     "name": "smirk",
>     "keywords": ["face", "smile", "mean", "prank", "smug", "sarcasm"]
>   },
>   {
>     "category": "face",
>     "char": "😶",
>     "name": "no_mouth",
>     "keywords": ["face", "hellokitty"]
>   },
>   {
>     "category": "face",
>     "char": "😐",
>     "name": "neutral_face",
>     "keywords": ["indifference", "meh", ": |", "neutral"]
>   },
>   {
>     "category": "face",
>     "char": "😑",
>     "name": "expressionless",
>     "keywords": ["face", "indifferent", "-_-", "meh", "deadpan"]
>   },
>   {
>     "category": "face",
>     "char": "😒",
>     "name": "unamused",
>     "keywords": [
>       "indifference",
>       "bored",
>       "straight face",
>       "serious",
>       "sarcasm",
>       "unimpressed",
>       "skeptical",
>       "dubious",
>       "side_eye"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🙄",
>     "name": "roll_eyes",
>     "keywords": ["face", "eyeroll", "frustrated"]
>   },
>   {
>     "category": "face",
>     "char": "🤔",
>     "name": "thinking",
>     "keywords": ["face", "hmmm", "think", "consider"]
>   },
>   {
>     "category": "face",
>     "char": "🤥",
>     "name": "lying_face",
>     "keywords": ["face", "lie", "pinocchio"]
>   },
>   {
>     "category": "face",
>     "char": "🤭",
>     "name": "hand_over_mouth",
>     "keywords": ["face", "whoops", "shock", "surprise"]
>   },
>   {
>     "category": "face",
>     "char": "🤫",
>     "name": "shushing",
>     "keywords": ["face", "quiet", "shhh"]
>   },
>   {
>     "category": "face",
>     "char": "🤬",
>     "name": "symbols_over_mouth",
>     "keywords": [
>       "face",
>       "swearing",
>       "cursing",
>       "cussing",
>       "profanity",
>       "expletive"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "🤯",
>     "name": "exploding_head",
>     "keywords": ["face", "shocked", "mind", "blown"]
>   },
>   {
>     "category": "face",
>     "char": "😳",
>     "name": "flushed",
>     "keywords": ["face", "blush", "shy", "flattered"]
>   },
>   {
>     "category": "face",
>     "char": "😞",
>     "name": "disappointed",
>     "keywords": ["face", "sad", "upset", "depressed", ": ("]
>   },
>   {
>     "category": "face",
>     "char": "😟",
>     "name": "worried",
>     "keywords": ["face", "concern", "nervous", ": ("]
>   },
>   {
>     "category": "face",
>     "char": "😠",
>     "name": "angry",
>     "keywords": ["mad", "face", "annoyed", "frustrated"]
>   },
>   {
>     "category": "face",
>     "char": "😡",
>     "name": "rage",
>     "keywords": ["angry", "mad", "hate", "despise"]
>   },
>   {
>     "category": "face",
>     "char": "😔",
>     "name": "pensive",
>     "keywords": ["face", "sad", "depressed", "upset"]
>   },
>   {
>     "category": "face",
>     "char": "😕",
>     "name": "confused",
>     "keywords": ["face", "indifference", "huh", "weird", "hmmm", ": /"]
>   },
>   {
>     "category": "face",
>     "char": "🙁",
>     "name": "slightly_frowning_face",
>     "keywords": ["face", "frowning", "disappointed", "sad", "upset"]
>   },
>   {
>     "category": "face",
>     "char": "☹",
>     "name": "frowning_face",
>     "keywords": ["face", "sad", "upset", "frown"]
>   },
>   {
>     "category": "face",
>     "char": "😣",
>     "name": "persevere",
>     "keywords": ["face", "sick", "no", "upset", "oops"]
>   },
>   {
>     "category": "face",
>     "char": "😖",
>     "name": "confounded",
>     "keywords": ["face", "confused", "sick", "unwell", "oops", ": S"]
>   },
>   {
>     "category": "face",
>     "char": "😫",
>     "name": "tired_face",
>     "keywords": ["sick", "whine", "upset", "frustrated"]
>   },
>   {
>     "category": "face",
>     "char": "😩",
>     "name": "weary",
>     "keywords": ["face", "tired", "sleepy", "sad", "frustrated", "upset"]
>   },
>   {
>     "category": "face",
>     "char": "🥺",
>     "name": "pleading",
>     "keywords": ["face", "begging", "mercy"]
>   },
>   {
>     "category": "face",
>     "char": "😤",
>     "name": "triumph",
>     "keywords": ["face", "gas", "phew", "proud", "pride"]
>   },
>   {
>     "category": "face",
>     "char": "😮",
>     "name": "open_mouth",
>     "keywords": ["face", "surprise", "impressed", "wow", "whoa", ": O"]
>   },
>   {
>     "category": "face",
>     "char": "😱",
>     "name": "scream",
>     "keywords": ["face", "munch", "scared", "omg"]
>   },
>   {
>     "category": "face",
>     "char": "😨",
>     "name": "fearful",
>     "keywords": ["face", "scared", "terrified", "nervous", "oops", "huh"]
>   },
>   {
>     "category": "face",
>     "char": "😰",
>     "name": "cold_sweat",
>     "keywords": ["face", "nervous", "sweat"]
>   },
>   {
>     "category": "face",
>     "char": "😯",
>     "name": "hushed",
>     "keywords": ["face", "woo", "shh"]
>   },
>   {
>     "category": "face",
>     "char": "😦",
>     "name": "frowning",
>     "keywords": ["face", "aw", "what"]
>   },
>   {
>     "category": "face",
>     "char": "😧",
>     "name": "anguished",
>     "keywords": ["face", "stunned", "nervous"]
>   },
>   {
>     "category": "face",
>     "char": "😢",
>     "name": "cry",
>     "keywords": ["face", "tears", "sad", "depressed", "upset", ": '("]
>   },
>   {
>     "category": "face",
>     "char": "😥",
>     "name": "disappointed_relieved",
>     "keywords": ["face", "phew", "sweat", "nervous"]
>   },
>   {
>     "category": "face",
>     "char": "🤤",
>     "name": "drooling_face",
>     "keywords": ["face"]
>   },
>   {
>     "category": "face",
>     "char": "😪",
>     "name": "sleepy",
>     "keywords": ["face", "tired", "rest", "nap"]
>   },
>   {
>     "category": "face",
>     "char": "😓",
>     "name": "sweat",
>     "keywords": ["face", "hot", "sad", "tired", "exercise"]
>   },
>   {
>     "category": "face",
>     "char": "🥵",
>     "name": "hot",
>     "keywords": ["face", "feverish", "heat", "red", "sweating"]
>   },
>   {
>     "category": "face",
>     "char": "🥶",
>     "name": "cold",
>     "keywords": ["face", "blue", "freezing", "frozen", "frostbite", "icicles"]
>   },
>   {
>     "category": "face",
>     "char": "😭",
>     "name": "sob",
>     "keywords": ["face", "cry", "tears", "sad", "upset", "depressed"]
>   },
>   {
>     "category": "face",
>     "char": "😵",
>     "name": "dizzy_face",
>     "keywords": ["spent", "unconscious", "xox", "dizzy"]
>   },
>   {
>     "category": "face",
>     "char": "😲",
>     "name": "astonished",
>     "keywords": ["face", "xox", "surprised", "poisoned"]
>   },
>   {
>     "category": "face",
>     "char": "🤐",
>     "name": "zipper_mouth_face",
>     "keywords": ["face", "sealed", "zipper", "secret"]
>   },
>   {
>     "category": "face",
>     "char": "🤢",
>     "name": "nauseated_face",
>     "keywords": ["face", "vomit", "gross", "green", "sick", "throw up", "ill"]
>   },
>   {
>     "category": "face",
>     "char": "🤧",
>     "name": "sneezing_face",
>     "keywords": ["face", "gesundheit", "sneeze", "sick", "allergy"]
>   },
>   {
>     "category": "face",
>     "char": "🤮",
>     "name": "vomiting",
>     "keywords": ["face", "sick"]
>   },
>   {
>     "category": "face",
>     "char": "😷",
>     "name": "mask",
>     "keywords": ["face", "sick", "ill", "disease"]
>   },
>   {
>     "category": "face",
>     "char": "🤒",
>     "name": "face_with_thermometer",
>     "keywords": ["sick", "temperature", "thermometer", "cold", "fever"]
>   },
>   {
>     "category": "face",
>     "char": "🤕",
>     "name": "face_with_head_bandage",
>     "keywords": ["injured", "clumsy", "bandage", "hurt"]
>   },
>   {
>     "category": "face",
>     "char": "🥴",
>     "name": "woozy",
>     "keywords": ["face", "dizzy", "intoxicated", "tipsy", "wavy"]
>   },
>   {
>     "category": "face",
>     "char": "🥱",
>     "name": "yawning",
>     "keywords": ["face", "tired", "yawning"]
>   },
>   {
>     "category": "face",
>     "char": "😴",
>     "name": "sleeping",
>     "keywords": ["face", "tired", "sleepy", "night", "zzz"]
>   },
>   {
>     "category": "face",
>     "char": "💤",
>     "name": "zzz",
>     "keywords": ["sleepy", "tired", "dream"]
>   },
>   {
>     "category": "face",
>     "char": "\uD83D\uDE36\u200D\uD83C\uDF2B\uFE0F",
>     "name": "face_in_clouds",
>     "keywords": []
>   },
>   {
>     "category": "face",
>     "char": "\uD83D\uDE2E\u200D\uD83D\uDCA8",
>     "name": "face_exhaling",
>     "keywords": []
>   },
>   {
>     "category": "face",
>     "char": "\uD83D\uDE35\u200D\uD83D\uDCAB",
>     "name": "face_with_spiral_eyes",
>     "keywords": []
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE0",
>     "name": "melting_face",
>     "keywords": ["disappear", "dissolve", "liquid", "melt", "toketa"]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE2",
>     "name": "face_with_open_eyes_and_hand_over_mouth",
>     "keywords": [
>       "amazement",
>       "awe",
>       "disbelief",
>       "embarrass",
>       "scared",
>       "surprise",
>       "ohoho"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE3",
>     "name": "face_with_peeking_eye",
>     "keywords": ["captivated", "peep", "stare", "chunibyo"]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE1",
>     "name": "saluting_face",
>     "keywords": ["ok", "salute", "sunny", "troops", "yes", "raja"]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE5",
>     "name": "dotted_line_face",
>     "keywords": [
>       "depressed",
>       "disappear",
>       "hide",
>       "introvert",
>       "invisible",
>       "tensen"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDEE4",
>     "name": "face_with_diagonal_mouth",
>     "keywords": ["disappointed", "meh", "skeptical", "unsure"]
>   },
>   {
>     "category": "face",
>     "char": "\uD83E\uDD79",
>     "name": "face_holding_back_tears",
>     "keywords": ["angry", "cry", "proud", "resist", "sad"]
>   },
>   {
>     "category": "face",
>     "char": "💩",
>     "name": "poop",
>     "keywords": ["hankey", "shitface", "fail", "turd", "shit"]
>   },
>   {
>     "category": "face",
>     "char": "😈",
>     "name": "smiling_imp",
>     "keywords": ["devil", "horns"]
>   },
>   {
>     "category": "face",
>     "char": "👿",
>     "name": "imp",
>     "keywords": ["devil", "angry", "horns"]
>   },
>   {
>     "category": "face",
>     "char": "👹",
>     "name": "japanese_ogre",
>     "keywords": [
>       "monster",
>       "red",
>       "mask",
>       "halloween",
>       "scary",
>       "creepy",
>       "devil",
>       "demon",
>       "japanese",
>       "ogre"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "👺",
>     "name": "japanese_goblin",
>     "keywords": [
>       "red",
>       "evil",
>       "mask",
>       "monster",
>       "scary",
>       "creepy",
>       "japanese",
>       "goblin"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "💀",
>     "name": "skull",
>     "keywords": ["dead", "skeleton", "creepy", "death"]
>   },
>   {
>     "category": "face",
>     "char": "👻",
>     "name": "ghost",
>     "keywords": ["halloween", "spooky", "scary"]
>   },
>   {
>     "category": "face",
>     "char": "👽",
>     "name": "alien",
>     "keywords": ["UFO", "paul", "weird", "outer_space"]
>   },
>   {
>     "category": "face",
>     "char": "🤖",
>     "name": "robot",
>     "keywords": ["computer", "machine", "bot"]
>   },
>   {
>     "category": "face",
>     "char": "😺",
>     "name": "smiley_cat",
>     "keywords": ["animal", "cats", "happy", "smile"]
>   },
>   {
>     "category": "face",
>     "char": "😸",
>     "name": "smile_cat",
>     "keywords": ["animal", "cats", "smile"]
>   },
>   {
>     "category": "face",
>     "char": "😹",
>     "name": "joy_cat",
>     "keywords": ["animal", "cats", "haha", "happy", "tears"]
>   },
>   {
>     "category": "face",
>     "char": "😻",
>     "name": "heart_eyes_cat",
>     "keywords": [
>       "animal",
>       "love",
>       "like",
>       "affection",
>       "cats",
>       "valentines",
>       "heart"
>     ]
>   },
>   {
>     "category": "face",
>     "char": "😼",
>     "name": "smirk_cat",
>     "keywords": ["animal", "cats", "smirk"]
>   },
>   {
>     "category": "face",
>     "char": "😽",
>     "name": "kissing_cat",
>     "keywords": ["animal", "cats", "kiss"]
>   },
>   {
>     "category": "face",
>     "char": "🙀",
>     "name": "scream_cat",
>     "keywords": ["animal", "cats", "munch", "scared", "scream"]
>   },
>   {
>     "category": "face",
>     "char": "😿",
>     "name": "crying_cat_face",
>     "keywords": ["animal", "tears", "weep", "sad", "cats", "upset", "cry"]
>   },
>   {
>     "category": "face",
>     "char": "😾",
>     "name": "pouting_cat",
>     "keywords": ["animal", "cats"]
>   },
>   {
>     "category": "people",
>     "char": "🤲",
>     "name": "palms_up",
>     "keywords": ["hands", "gesture", "cupped", "prayer"]
>   },
>   {
>     "category": "people",
>     "char": "🙌",
>     "name": "raised_hands",
>     "keywords": ["gesture", "hooray", "yea", "celebration", "hands"]
>   },
>   {
>     "category": "people",
>     "char": "👏",
>     "name": "clap",
>     "keywords": ["hands", "praise", "applause", "congrats", "yay"]
>   },
>   {
>     "category": "people",
>     "char": "👋",
>     "name": "wave",
>     "keywords": [
>       "hands",
>       "gesture",
>       "goodbye",
>       "solong",
>       "farewell",
>       "hello",
>       "hi",
>       "palm"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🤙",
>     "name": "call_me_hand",
>     "keywords": ["hands", "gesture"]
>   },
>   {
>     "category": "people",
>     "char": "👍",
>     "name": "+1",
>     "keywords": [
>       "thumbsup",
>       "yes",
>       "awesome",
>       "good",
>       "agree",
>       "accept",
>       "cool",
>       "hand",
>       "like"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👎",
>     "name": "-1",
>     "keywords": ["thumbsdown", "no", "dislike", "hand"]
>   },
>   {
>     "category": "people",
>     "char": "👊",
>     "name": "facepunch",
>     "keywords": ["angry", "violence", "fist", "hit", "attack", "hand"]
>   },
>   {
>     "category": "people",
>     "char": "✊",
>     "name": "fist",
>     "keywords": ["fingers", "hand", "grasp"]
>   },
>   {
>     "category": "people",
>     "char": "🤛",
>     "name": "fist_left",
>     "keywords": ["hand", "fistbump"]
>   },
>   {
>     "category": "people",
>     "char": "🤜",
>     "name": "fist_right",
>     "keywords": ["hand", "fistbump"]
>   },
>   {
>     "category": "people",
>     "char": "✌",
>     "name": "v",
>     "keywords": ["fingers", "ohyeah", "hand", "peace", "victory", "two"]
>   },
>   {
>     "category": "people",
>     "char": "👌",
>     "name": "ok_hand",
>     "keywords": ["fingers", "limbs", "perfect", "ok", "okay"]
>   },
>   {
>     "category": "people",
>     "char": "✋",
>     "name": "raised_hand",
>     "keywords": ["fingers", "stop", "highfive", "palm", "ban"]
>   },
>   {
>     "category": "people",
>     "char": "🤚",
>     "name": "raised_back_of_hand",
>     "keywords": ["fingers", "raised", "backhand"]
>   },
>   {
>     "category": "people",
>     "char": "👐",
>     "name": "open_hands",
>     "keywords": ["fingers", "butterfly", "hands", "open"]
>   },
>   {
>     "category": "people",
>     "char": "💪",
>     "name": "muscle",
>     "keywords": ["arm", "flex", "hand", "summer", "strong", "biceps"]
>   },
>   {
>     "category": "people",
>     "char": "🦾",
>     "name": "mechanical_arm",
>     "keywords": ["flex", "hand", "strong", "biceps"]
>   },
>   {
>     "category": "people",
>     "char": "🙏",
>     "name": "pray",
>     "keywords": ["please", "hope", "wish", "namaste", "highfive"]
>   },
>   {
>     "category": "people",
>     "char": "🦶",
>     "name": "foot",
>     "keywords": ["kick", "stomp"]
>   },
>   {
>     "category": "people",
>     "char": "🦵",
>     "name": "leg",
>     "keywords": ["kick", "limb"]
>   },
>   {
>     "category": "people",
>     "char": "🦿",
>     "name": "mechanical_leg",
>     "keywords": ["kick", "limb"]
>   },
>   {
>     "category": "people",
>     "char": "🤝",
>     "name": "handshake",
>     "keywords": ["agreement", "shake"]
>   },
>   {
>     "category": "people",
>     "char": "☝",
>     "name": "point_up",
>     "keywords": ["hand", "fingers", "direction", "up"]
>   },
>   {
>     "category": "people",
>     "char": "👆",
>     "name": "point_up_2",
>     "keywords": ["fingers", "hand", "direction", "up"]
>   },
>   {
>     "category": "people",
>     "char": "👇",
>     "name": "point_down",
>     "keywords": ["fingers", "hand", "direction", "down"]
>   },
>   {
>     "category": "people",
>     "char": "👈",
>     "name": "point_left",
>     "keywords": ["direction", "fingers", "hand", "left"]
>   },
>   {
>     "category": "people",
>     "char": "👉",
>     "name": "point_right",
>     "keywords": ["fingers", "hand", "direction", "right"]
>   },
>   {
>     "category": "people",
>     "char": "🖕",
>     "name": "fu",
>     "keywords": ["hand", "fingers", "rude", "middle", "flipping"]
>   },
>   {
>     "category": "people",
>     "char": "🖐",
>     "name": "raised_hand_with_fingers_splayed",
>     "keywords": ["hand", "fingers", "palm"]
>   },
>   {
>     "category": "people",
>     "char": "🤟",
>     "name": "love_you",
>     "keywords": ["hand", "fingers", "gesture"]
>   },
>   {
>     "category": "people",
>     "char": "🤘",
>     "name": "metal",
>     "keywords": ["hand", "fingers", "evil_eye", "sign_of_horns", "rock_on"]
>   },
>   {
>     "category": "people",
>     "char": "🤞",
>     "name": "crossed_fingers",
>     "keywords": ["good", "lucky"]
>   },
>   {
>     "category": "people",
>     "char": "🖖",
>     "name": "vulcan_salute",
>     "keywords": ["hand", "fingers", "spock", "star trek"]
>   },
>   {
>     "category": "people",
>     "char": "✍",
>     "name": "writing_hand",
>     "keywords": ["lower_left_ballpoint_pen", "stationery", "write", "compose"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF0",
>     "name": "hand_with_index_finger_and_thumb_crossed",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF1",
>     "name": "rightwards_hand",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF2",
>     "name": "leftwards_hand",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF3",
>     "name": "palm_down_hand",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF4",
>     "name": "palm_up_hand",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF5",
>     "name": "index_pointing_at_the_viewer",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEF6",
>     "name": "heart_hands",
>     "keywords": ["moemoekyun"]
>   },
>   {
>     "category": "people",
>     "char": "🤏",
>     "name": "pinching_hand",
>     "keywords": ["hand", "fingers"]
>   },
>   {
>     "category": "people",
>     "char": "🤌",
>     "name": "pinched_fingers",
>     "keywords": ["hand", "fingers"]
>   },
>   {
>     "category": "people",
>     "char": "🤳",
>     "name": "selfie",
>     "keywords": ["camera", "phone"]
>   },
>   {
>     "category": "people",
>     "char": "💅",
>     "name": "nail_care",
>     "keywords": ["beauty", "manicure", "finger", "fashion", "nail"]
>   },
>   {
>     "category": "people",
>     "char": "👄",
>     "name": "lips",
>     "keywords": ["mouth", "kiss"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEE6",
>     "name": "biting_lip",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🦷",
>     "name": "tooth",
>     "keywords": ["teeth", "dentist"]
>   },
>   {
>     "category": "people",
>     "char": "👅",
>     "name": "tongue",
>     "keywords": ["mouth", "playful"]
>   },
>   {
>     "category": "people",
>     "char": "👂",
>     "name": "ear",
>     "keywords": ["face", "hear", "sound", "listen"]
>   },
>   {
>     "category": "people",
>     "char": "🦻",
>     "name": "ear_with_hearing_aid",
>     "keywords": ["face", "hear", "sound", "listen"]
>   },
>   {
>     "category": "people",
>     "char": "👃",
>     "name": "nose",
>     "keywords": ["smell", "sniff"]
>   },
>   {
>     "category": "people",
>     "char": "👁",
>     "name": "eye",
>     "keywords": ["face", "look", "see", "watch", "stare"]
>   },
>   {
>     "category": "people",
>     "char": "👀",
>     "name": "eyes",
>     "keywords": ["look", "watch", "stalk", "peek", "see"]
>   },
>   {
>     "category": "people",
>     "char": "🧠",
>     "name": "brain",
>     "keywords": ["smart", "intelligent"]
>   },
>   {
>     "category": "people",
>     "char": "🫀",
>     "name": "anatomical_heart",
>     "keywords": []
>   },
>   { "category": "people", "char": "🫁", "name": "lungs", "keywords": [] },
>   {
>     "category": "people",
>     "char": "👤",
>     "name": "bust_in_silhouette",
>     "keywords": ["user", "person", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👥",
>     "name": "busts_in_silhouette",
>     "keywords": ["user", "person", "human", "group", "team"]
>   },
>   {
>     "category": "people",
>     "char": "🗣",
>     "name": "speaking_head",
>     "keywords": ["user", "person", "human", "sing", "say", "talk"]
>   },
>   {
>     "category": "people",
>     "char": "👶",
>     "name": "baby",
>     "keywords": ["child", "boy", "girl", "toddler"]
>   },
>   {
>     "category": "people",
>     "char": "🧒",
>     "name": "child",
>     "keywords": ["gender-neutral", "young"]
>   },
>   {
>     "category": "people",
>     "char": "👦",
>     "name": "boy",
>     "keywords": ["man", "male", "guy", "teenager"]
>   },
>   {
>     "category": "people",
>     "char": "👧",
>     "name": "girl",
>     "keywords": ["female", "woman", "teenager"]
>   },
>   {
>     "category": "people",
>     "char": "🧑",
>     "name": "adult",
>     "keywords": ["gender-neutral", "person"]
>   },
>   {
>     "category": "people",
>     "char": "👨",
>     "name": "man",
>     "keywords": [
>       "mustache",
>       "father",
>       "dad",
>       "guy",
>       "classy",
>       "sir",
>       "moustache"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👩",
>     "name": "woman",
>     "keywords": ["female", "girls", "lady"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦱",
>     "name": "curly_hair",
>     "keywords": ["curly", "afro", "braids", "ringlets"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦱",
>     "name": "curly_hair_woman",
>     "keywords": [
>       "woman",
>       "female",
>       "girl",
>       "curly",
>       "afro",
>       "braids",
>       "ringlets"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦱",
>     "name": "curly_hair_man",
>     "keywords": [
>       "man",
>       "male",
>       "boy",
>       "guy",
>       "curly",
>       "afro",
>       "braids",
>       "ringlets"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦰",
>     "name": "red_hair",
>     "keywords": ["redhead"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦰",
>     "name": "red_hair_woman",
>     "keywords": ["woman", "female", "girl", "ginger", "redhead"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦰",
>     "name": "red_hair_man",
>     "keywords": ["man", "male", "boy", "guy", "ginger", "redhead"]
>   },
>   {
>     "category": "people",
>     "char": "👱‍♀️",
>     "name": "blonde_woman",
>     "keywords": ["woman", "female", "girl", "blonde", "person"]
>   },
>   {
>     "category": "people",
>     "char": "👱",
>     "name": "blonde_man",
>     "keywords": ["man", "male", "boy", "blonde", "guy", "person"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦳",
>     "name": "white_hair",
>     "keywords": ["gray", "old", "white"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦳",
>     "name": "white_hair_woman",
>     "keywords": ["woman", "female", "girl", "gray", "old", "white"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦳",
>     "name": "white_hair_man",
>     "keywords": ["man", "male", "boy", "guy", "gray", "old", "white"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦲",
>     "name": "bald",
>     "keywords": ["bald", "chemotherapy", "hairless", "shaven"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦲",
>     "name": "bald_woman",
>     "keywords": [
>       "woman",
>       "female",
>       "girl",
>       "bald",
>       "chemotherapy",
>       "hairless",
>       "shaven"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦲",
>     "name": "bald_man",
>     "keywords": [
>       "man",
>       "male",
>       "boy",
>       "guy",
>       "bald",
>       "chemotherapy",
>       "hairless",
>       "shaven"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🧔",
>     "name": "bearded_person",
>     "keywords": ["person", "bewhiskered"]
>   },
>   {
>     "category": "people",
>     "char": "🧓",
>     "name": "older_adult",
>     "keywords": ["human", "elder", "senior", "gender-neutral"]
>   },
>   {
>     "category": "people",
>     "char": "👴",
>     "name": "older_man",
>     "keywords": ["human", "male", "men", "old", "elder", "senior"]
>   },
>   {
>     "category": "people",
>     "char": "👵",
>     "name": "older_woman",
>     "keywords": ["human", "female", "women", "lady", "old", "elder", "senior"]
>   },
>   {
>     "category": "people",
>     "char": "👲",
>     "name": "man_with_gua_pi_mao",
>     "keywords": ["male", "boy", "chinese"]
>   },
>   {
>     "category": "people",
>     "char": "🧕",
>     "name": "woman_with_headscarf",
>     "keywords": ["female", "hijab", "mantilla", "tichel"]
>   },
>   {
>     "category": "people",
>     "char": "👳‍♀️",
>     "name": "woman_with_turban",
>     "keywords": ["female", "indian", "hinduism", "arabs", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "👳",
>     "name": "man_with_turban",
>     "keywords": ["male", "indian", "hinduism", "arabs"]
>   },
>   {
>     "category": "people",
>     "char": "👮‍♀️",
>     "name": "policewoman",
>     "keywords": [
>       "woman",
>       "police",
>       "law",
>       "legal",
>       "enforcement",
>       "arrest",
>       "911",
>       "female"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👮",
>     "name": "policeman",
>     "keywords": [
>       "man",
>       "police",
>       "law",
>       "legal",
>       "enforcement",
>       "arrest",
>       "911"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👷‍♀️",
>     "name": "construction_worker_woman",
>     "keywords": [
>       "female",
>       "human",
>       "wip",
>       "build",
>       "construction",
>       "worker",
>       "labor",
>       "woman"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👷",
>     "name": "construction_worker_man",
>     "keywords": [
>       "male",
>       "human",
>       "wip",
>       "guy",
>       "build",
>       "construction",
>       "worker",
>       "labor"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "💂‍♀️",
>     "name": "guardswoman",
>     "keywords": ["uk", "gb", "british", "female", "royal", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "💂",
>     "name": "guardsman",
>     "keywords": ["uk", "gb", "british", "male", "guy", "royal"]
>   },
>   {
>     "category": "people",
>     "char": "🕵️‍♀️",
>     "name": "female_detective",
>     "keywords": ["human", "spy", "detective", "female", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "🕵",
>     "name": "male_detective",
>     "keywords": ["human", "spy", "detective"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍⚕️",
>     "name": "health_worker",
>     "keywords": ["doctor", "nurse", "therapist", "healthcare", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍⚕️",
>     "name": "woman_health_worker",
>     "keywords": ["doctor", "nurse", "therapist", "healthcare", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍⚕️",
>     "name": "man_health_worker",
>     "keywords": ["doctor", "nurse", "therapist", "healthcare", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🌾",
>     "name": "farmer",
>     "keywords": ["rancher", "gardener", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🌾",
>     "name": "woman_farmer",
>     "keywords": ["rancher", "gardener", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🌾",
>     "name": "man_farmer",
>     "keywords": ["rancher", "gardener", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🍳",
>     "name": "cook",
>     "keywords": ["chef", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🍳",
>     "name": "woman_cook",
>     "keywords": ["chef", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🍳",
>     "name": "man_cook",
>     "keywords": ["chef", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🎓",
>     "name": "student",
>     "keywords": ["graduate", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🎓",
>     "name": "woman_student",
>     "keywords": ["graduate", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🎓",
>     "name": "man_student",
>     "keywords": ["graduate", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🎤",
>     "name": "singer",
>     "keywords": ["rockstar", "entertainer", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🎤",
>     "name": "woman_singer",
>     "keywords": ["rockstar", "entertainer", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🎤",
>     "name": "man_singer",
>     "keywords": ["rockstar", "entertainer", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🏫",
>     "name": "teacher",
>     "keywords": ["instructor", "professor", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🏫",
>     "name": "woman_teacher",
>     "keywords": ["instructor", "professor", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🏫",
>     "name": "man_teacher",
>     "keywords": ["instructor", "professor", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🏭",
>     "name": "factory_worker",
>     "keywords": ["assembly", "industrial", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🏭",
>     "name": "woman_factory_worker",
>     "keywords": ["assembly", "industrial", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🏭",
>     "name": "man_factory_worker",
>     "keywords": ["assembly", "industrial", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍💻",
>     "name": "technologist",
>     "keywords": [
>       "coder",
>       "developer",
>       "engineer",
>       "programmer",
>       "software",
>       "human",
>       "laptop",
>       "computer"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👩‍💻",
>     "name": "woman_technologist",
>     "keywords": [
>       "coder",
>       "developer",
>       "engineer",
>       "programmer",
>       "software",
>       "woman",
>       "human",
>       "laptop",
>       "computer"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍💻",
>     "name": "man_technologist",
>     "keywords": [
>       "coder",
>       "developer",
>       "engineer",
>       "programmer",
>       "software",
>       "man",
>       "human",
>       "laptop",
>       "computer"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍💼",
>     "name": "office_worker",
>     "keywords": ["business", "manager", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍💼",
>     "name": "woman_office_worker",
>     "keywords": ["business", "manager", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍💼",
>     "name": "man_office_worker",
>     "keywords": ["business", "manager", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🔧",
>     "name": "mechanic",
>     "keywords": ["plumber", "human", "wrench"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🔧",
>     "name": "woman_mechanic",
>     "keywords": ["plumber", "woman", "human", "wrench"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🔧",
>     "name": "man_mechanic",
>     "keywords": ["plumber", "man", "human", "wrench"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🔬",
>     "name": "scientist",
>     "keywords": ["biologist", "chemist", "engineer", "physicist", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🔬",
>     "name": "woman_scientist",
>     "keywords": [
>       "biologist",
>       "chemist",
>       "engineer",
>       "physicist",
>       "woman",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🔬",
>     "name": "man_scientist",
>     "keywords": [
>       "biologist",
>       "chemist",
>       "engineer",
>       "physicist",
>       "man",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🎨",
>     "name": "artist",
>     "keywords": ["painter", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🎨",
>     "name": "woman_artist",
>     "keywords": ["painter", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🎨",
>     "name": "man_artist",
>     "keywords": ["painter", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🚒",
>     "name": "firefighter",
>     "keywords": ["fireman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🚒",
>     "name": "woman_firefighter",
>     "keywords": ["fireman", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🚒",
>     "name": "man_firefighter",
>     "keywords": ["fireman", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍✈️",
>     "name": "pilot",
>     "keywords": ["aviator", "plane", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍✈️",
>     "name": "woman_pilot",
>     "keywords": ["aviator", "plane", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍✈️",
>     "name": "man_pilot",
>     "keywords": ["aviator", "plane", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🚀",
>     "name": "astronaut",
>     "keywords": ["space", "rocket", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🚀",
>     "name": "woman_astronaut",
>     "keywords": ["space", "rocket", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🚀",
>     "name": "man_astronaut",
>     "keywords": ["space", "rocket", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍⚖️",
>     "name": "judge",
>     "keywords": ["justice", "court", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍⚖️",
>     "name": "woman_judge",
>     "keywords": ["justice", "court", "woman", "human"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍⚖️",
>     "name": "man_judge",
>     "keywords": ["justice", "court", "man", "human"]
>   },
>   {
>     "category": "people",
>     "char": "🦸‍♀️",
>     "name": "woman_superhero",
>     "keywords": ["woman", "female", "good", "heroine", "superpowers"]
>   },
>   {
>     "category": "people",
>     "char": "🦸‍♂️",
>     "name": "man_superhero",
>     "keywords": ["man", "male", "good", "hero", "superpowers"]
>   },
>   {
>     "category": "people",
>     "char": "🦹‍♀️",
>     "name": "woman_supervillain",
>     "keywords": [
>       "woman",
>       "female",
>       "evil",
>       "bad",
>       "criminal",
>       "heroine",
>       "superpowers"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🦹‍♂️",
>     "name": "man_supervillain",
>     "keywords": [
>       "man",
>       "male",
>       "evil",
>       "bad",
>       "criminal",
>       "hero",
>       "superpowers"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🤶",
>     "name": "mrs_claus",
>     "keywords": ["woman", "female", "xmas", "mother christmas"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDDD1\u200D\uD83C\uDF84",
>     "name": "mx_claus",
>     "keywords": ["xmas", "christmas"]
>   },
>   {
>     "category": "people",
>     "char": "🎅",
>     "name": "santa",
>     "keywords": ["festival", "man", "male", "xmas", "father christmas"]
>   },
>   { "category": "people", "char": "🥷", "name": "ninja", "keywords": [] },
>   {
>     "category": "people",
>     "char": "🧙‍♀️",
>     "name": "sorceress",
>     "keywords": ["woman", "female", "mage", "witch"]
>   },
>   {
>     "category": "people",
>     "char": "🧙‍♂️",
>     "name": "wizard",
>     "keywords": ["man", "male", "mage", "sorcerer"]
>   },
>   {
>     "category": "people",
>     "char": "🧝‍♀️",
>     "name": "woman_elf",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧝‍♂️",
>     "name": "man_elf",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "🧛‍♀️",
>     "name": "woman_vampire",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧛‍♂️",
>     "name": "man_vampire",
>     "keywords": ["man", "male", "dracula"]
>   },
>   {
>     "category": "people",
>     "char": "🧟‍♀️",
>     "name": "woman_zombie",
>     "keywords": ["woman", "female", "undead", "walking dead"]
>   },
>   {
>     "category": "people",
>     "char": "🧟‍♂️",
>     "name": "man_zombie",
>     "keywords": ["man", "male", "dracula", "undead", "walking dead"]
>   },
>   {
>     "category": "people",
>     "char": "🧞‍♀️",
>     "name": "woman_genie",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧞‍♂️",
>     "name": "man_genie",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "🧜‍♀️",
>     "name": "mermaid",
>     "keywords": ["woman", "female", "merwoman", "ariel"]
>   },
>   {
>     "category": "people",
>     "char": "🧜‍♂️",
>     "name": "merman",
>     "keywords": ["man", "male", "triton"]
>   },
>   {
>     "category": "people",
>     "char": "🧚‍♀️",
>     "name": "woman_fairy",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧚‍♂️",
>     "name": "man_fairy",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "👼",
>     "name": "angel",
>     "keywords": ["heaven", "wings", "halo"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDDCC",
>     "name": "troll",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🤰",
>     "name": "pregnant_woman",
>     "keywords": ["baby"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEC3",
>     "name": "pregnant_man",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEC4",
>     "name": "pregnant_person",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDEC5",
>     "name": "person_with_crown",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🤱",
>     "name": "breastfeeding",
>     "keywords": ["nursing", "baby"]
>   },
>   {
>     "category": "people",
>     "char": "\uD83D\uDC69\u200D\uD83C\uDF7C",
>     "name": "woman_feeding_baby",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83D\uDC68\u200D\uD83C\uDF7C",
>     "name": "man_feeding_baby",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDDD1\u200D\uD83C\uDF7C",
>     "name": "person_feeding_baby",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "👸",
>     "name": "princess",
>     "keywords": ["girl", "woman", "female", "blond", "crown", "royal", "queen"]
>   },
>   {
>     "category": "people",
>     "char": "🤴",
>     "name": "prince",
>     "keywords": ["boy", "man", "male", "crown", "royal", "king"]
>   },
>   {
>     "category": "people",
>     "char": "👰",
>     "name": "person_with_veil",
>     "keywords": ["couple", "marriage", "wedding", "woman", "bride"]
>   },
>   {
>     "category": "people",
>     "char": "👰",
>     "name": "bride_with_veil",
>     "keywords": ["couple", "marriage", "wedding", "woman", "bride"]
>   },
>   {
>     "category": "people",
>     "char": "🤵",
>     "name": "person_in_tuxedo",
>     "keywords": ["couple", "marriage", "wedding", "groom"]
>   },
>   {
>     "category": "people",
>     "char": "🤵",
>     "name": "man_in_tuxedo",
>     "keywords": ["couple", "marriage", "wedding", "groom"]
>   },
>   {
>     "category": "people",
>     "char": "🏃‍♀️",
>     "name": "running_woman",
>     "keywords": ["woman", "walking", "exercise", "race", "running", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🏃",
>     "name": "running_man",
>     "keywords": ["man", "walking", "exercise", "race", "running"]
>   },
>   {
>     "category": "people",
>     "char": "🚶‍♀️",
>     "name": "walking_woman",
>     "keywords": ["human", "feet", "steps", "woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🚶",
>     "name": "walking_man",
>     "keywords": ["human", "feet", "steps"]
>   },
>   {
>     "category": "people",
>     "char": "💃",
>     "name": "dancer",
>     "keywords": ["female", "girl", "woman", "fun"]
>   },
>   {
>     "category": "people",
>     "char": "🕺",
>     "name": "man_dancing",
>     "keywords": ["male", "boy", "fun", "dancer"]
>   },
>   {
>     "category": "people",
>     "char": "👯",
>     "name": "dancing_women",
>     "keywords": ["female", "bunny", "women", "girls"]
>   },
>   {
>     "category": "people",
>     "char": "👯‍♂️",
>     "name": "dancing_men",
>     "keywords": ["male", "bunny", "men", "boys"]
>   },
>   {
>     "category": "people",
>     "char": "👫",
>     "name": "couple",
>     "keywords": [
>       "pair",
>       "people",
>       "human",
>       "love",
>       "date",
>       "dating",
>       "like",
>       "affection",
>       "valentines",
>       "marriage"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1",
>     "name": "people_holding_hands",
>     "keywords": [
>       "pair",
>       "couple",
>       "love",
>       "like",
>       "bromance",
>       "friendship",
>       "people",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👬",
>     "name": "two_men_holding_hands",
>     "keywords": [
>       "pair",
>       "couple",
>       "love",
>       "like",
>       "bromance",
>       "friendship",
>       "people",
>       "man",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👭",
>     "name": "two_women_holding_hands",
>     "keywords": [
>       "pair",
>       "couple",
>       "love",
>       "like",
>       "bromance",
>       "friendship",
>       "people",
>       "female",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🫂",
>     "name": "people_hugging",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🙇‍♀️",
>     "name": "bowing_woman",
>     "keywords": ["woman", "female", "girl"]
>   },
>   {
>     "category": "people",
>     "char": "🙇",
>     "name": "bowing_man",
>     "keywords": ["man", "male", "boy"]
>   },
>   {
>     "category": "people",
>     "char": "🤦‍♂️",
>     "name": "man_facepalming",
>     "keywords": ["man", "male", "boy", "disbelief"]
>   },
>   {
>     "category": "people",
>     "char": "🤦‍♀️",
>     "name": "woman_facepalming",
>     "keywords": ["woman", "female", "girl", "disbelief"]
>   },
>   {
>     "category": "people",
>     "char": "🤷",
>     "name": "woman_shrugging",
>     "keywords": ["woman", "female", "girl", "confused", "indifferent", "doubt"]
>   },
>   {
>     "category": "people",
>     "char": "🤷‍♂️",
>     "name": "man_shrugging",
>     "keywords": ["man", "male", "boy", "confused", "indifferent", "doubt"]
>   },
>   {
>     "category": "people",
>     "char": "💁",
>     "name": "tipping_hand_woman",
>     "keywords": ["female", "girl", "woman", "human", "information"]
>   },
>   {
>     "category": "people",
>     "char": "💁‍♂️",
>     "name": "tipping_hand_man",
>     "keywords": ["male", "boy", "man", "human", "information"]
>   },
>   {
>     "category": "people",
>     "char": "🙅",
>     "name": "no_good_woman",
>     "keywords": ["female", "girl", "woman", "nope"]
>   },
>   {
>     "category": "people",
>     "char": "🙅‍♂️",
>     "name": "no_good_man",
>     "keywords": ["male", "boy", "man", "nope"]
>   },
>   {
>     "category": "people",
>     "char": "🙆",
>     "name": "ok_woman",
>     "keywords": ["women", "girl", "female", "pink", "human", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "🙆‍♂️",
>     "name": "ok_man",
>     "keywords": ["men", "boy", "male", "blue", "human", "man"]
>   },
>   {
>     "category": "people",
>     "char": "🙋",
>     "name": "raising_hand_woman",
>     "keywords": ["female", "girl", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "🙋‍♂️",
>     "name": "raising_hand_man",
>     "keywords": ["male", "boy", "man"]
>   },
>   {
>     "category": "people",
>     "char": "🙎",
>     "name": "pouting_woman",
>     "keywords": ["female", "girl", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "🙎‍♂️",
>     "name": "pouting_man",
>     "keywords": ["male", "boy", "man"]
>   },
>   {
>     "category": "people",
>     "char": "🙍",
>     "name": "frowning_woman",
>     "keywords": [
>       "female",
>       "girl",
>       "woman",
>       "sad",
>       "depressed",
>       "discouraged",
>       "unhappy"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🙍‍♂️",
>     "name": "frowning_man",
>     "keywords": [
>       "male",
>       "boy",
>       "man",
>       "sad",
>       "depressed",
>       "discouraged",
>       "unhappy"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "💇",
>     "name": "haircut_woman",
>     "keywords": ["female", "girl", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "💇‍♂️",
>     "name": "haircut_man",
>     "keywords": ["male", "boy", "man"]
>   },
>   {
>     "category": "people",
>     "char": "💆",
>     "name": "massage_woman",
>     "keywords": ["female", "girl", "woman", "head"]
>   },
>   {
>     "category": "people",
>     "char": "💆‍♂️",
>     "name": "massage_man",
>     "keywords": ["male", "boy", "man", "head"]
>   },
>   {
>     "category": "people",
>     "char": "🧖‍♀️",
>     "name": "woman_in_steamy_room",
>     "keywords": ["female", "woman", "spa", "steamroom", "sauna"]
>   },
>   {
>     "category": "people",
>     "char": "🧖‍♂️",
>     "name": "man_in_steamy_room",
>     "keywords": ["male", "man", "spa", "steamroom", "sauna"]
>   },
>   {
>     "category": "people",
>     "char": "🧏‍♀️",
>     "name": "woman_deaf",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧏‍♂️",
>     "name": "man_deaf",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "🧍‍♀️",
>     "name": "woman_standing",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧍‍♂️",
>     "name": "man_standing",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "🧎‍♀️",
>     "name": "woman_kneeling",
>     "keywords": ["woman", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🧎‍♂️",
>     "name": "man_kneeling",
>     "keywords": ["man", "male"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦯",
>     "name": "person_with_probing_cane",
>     "keywords": ["accessibility", "blind"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦯",
>     "name": "woman_with_probing_cane",
>     "keywords": ["woman", "female", "accessibility", "blind"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦯",
>     "name": "man_with_probing_cane",
>     "keywords": ["man", "male", "accessibility", "blind"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦼",
>     "name": "person_in_motorized_wheelchair",
>     "keywords": ["accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦼",
>     "name": "woman_in_motorized_wheelchair",
>     "keywords": ["woman", "female", "accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦼",
>     "name": "man_in_motorized_wheelchair",
>     "keywords": ["man", "male", "accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "🧑‍🦽",
>     "name": "person_in_manual_wheelchair",
>     "keywords": ["accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍🦽",
>     "name": "woman_in_manual_wheelchair",
>     "keywords": ["woman", "female", "accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍🦽",
>     "name": "man_in_manual_wheelchair",
>     "keywords": ["man", "male", "accessibility"]
>   },
>   {
>     "category": "people",
>     "char": "💑",
>     "name": "couple_with_heart_woman_man",
>     "keywords": [
>       "pair",
>       "love",
>       "like",
>       "affection",
>       "human",
>       "dating",
>       "valentines",
>       "marriage"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👩‍❤️‍👩",
>     "name": "couple_with_heart_woman_woman",
>     "keywords": [
>       "pair",
>       "love",
>       "like",
>       "affection",
>       "human",
>       "dating",
>       "valentines",
>       "marriage"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍❤️‍👨",
>     "name": "couple_with_heart_man_man",
>     "keywords": [
>       "pair",
>       "love",
>       "like",
>       "affection",
>       "human",
>       "dating",
>       "valentines",
>       "marriage"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "💏",
>     "name": "couplekiss_man_woman",
>     "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍❤️‍💋‍👩",
>     "name": "couplekiss_woman_woman",
>     "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍❤️‍💋‍👨",
>     "name": "couplekiss_man_man",
>     "keywords": ["pair", "valentines", "love", "like", "dating", "marriage"]
>   },
>   {
>     "category": "people",
>     "char": "👪",
>     "name": "family_man_woman_boy",
>     "keywords": [
>       "home",
>       "parents",
>       "child",
>       "mom",
>       "dad",
>       "father",
>       "mother",
>       "people",
>       "human"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👩‍👧",
>     "name": "family_man_woman_girl",
>     "keywords": ["home", "parents", "people", "human", "child"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👩‍👧‍👦",
>     "name": "family_man_woman_girl_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👩‍👦‍👦",
>     "name": "family_man_woman_boy_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👩‍👧‍👧",
>     "name": "family_man_woman_girl_girl",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👩‍👦",
>     "name": "family_woman_woman_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👩‍👧",
>     "name": "family_woman_woman_girl",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👩‍👧‍👦",
>     "name": "family_woman_woman_girl_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👩‍👦‍👦",
>     "name": "family_woman_woman_boy_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👩‍👧‍👧",
>     "name": "family_woman_woman_girl_girl",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👨‍👦",
>     "name": "family_man_man_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👨‍👧",
>     "name": "family_man_man_girl",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👨‍👧‍👦",
>     "name": "family_man_man_girl_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👨‍👦‍👦",
>     "name": "family_man_man_boy_boy",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👨‍👧‍👧",
>     "name": "family_man_man_girl_girl",
>     "keywords": ["home", "parents", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👦",
>     "name": "family_woman_boy",
>     "keywords": ["home", "parent", "people", "human", "child"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👧",
>     "name": "family_woman_girl",
>     "keywords": ["home", "parent", "people", "human", "child"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👧‍👦",
>     "name": "family_woman_girl_boy",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👦‍👦",
>     "name": "family_woman_boy_boy",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👩‍👧‍👧",
>     "name": "family_woman_girl_girl",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👦",
>     "name": "family_man_boy",
>     "keywords": ["home", "parent", "people", "human", "child"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👧",
>     "name": "family_man_girl",
>     "keywords": ["home", "parent", "people", "human", "child"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👧‍👦",
>     "name": "family_man_girl_boy",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👦‍👦",
>     "name": "family_man_boy_boy",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "👨‍👧‍👧",
>     "name": "family_man_girl_girl",
>     "keywords": ["home", "parent", "people", "human", "children"]
>   },
>   {
>     "category": "people",
>     "char": "🧶",
>     "name": "yarn",
>     "keywords": ["ball", "crochet", "knit"]
>   },
>   {
>     "category": "people",
>     "char": "🧵",
>     "name": "thread",
>     "keywords": ["needle", "sewing", "spool", "string"]
>   },
>   {
>     "category": "people",
>     "char": "🧥",
>     "name": "coat",
>     "keywords": ["jacket"]
>   },
>   {
>     "category": "people",
>     "char": "🥼",
>     "name": "labcoat",
>     "keywords": ["doctor", "experiment", "scientist", "chemist"]
>   },
>   {
>     "category": "people",
>     "char": "👚",
>     "name": "womans_clothes",
>     "keywords": ["fashion", "shopping_bags", "female"]
>   },
>   {
>     "category": "people",
>     "char": "👕",
>     "name": "tshirt",
>     "keywords": ["fashion", "cloth", "casual", "shirt", "tee"]
>   },
>   {
>     "category": "people",
>     "char": "👖",
>     "name": "jeans",
>     "keywords": ["fashion", "shopping"]
>   },
>   {
>     "category": "people",
>     "char": "👔",
>     "name": "necktie",
>     "keywords": ["shirt", "suitup", "formal", "fashion", "cloth", "business"]
>   },
>   {
>     "category": "people",
>     "char": "👗",
>     "name": "dress",
>     "keywords": ["clothes", "fashion", "shopping"]
>   },
>   {
>     "category": "people",
>     "char": "👙",
>     "name": "bikini",
>     "keywords": [
>       "swimming",
>       "female",
>       "woman",
>       "girl",
>       "fashion",
>       "beach",
>       "summer"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🩱",
>     "name": "one_piece_swimsuit",
>     "keywords": [
>       "swimming",
>       "female",
>       "woman",
>       "girl",
>       "fashion",
>       "beach",
>       "summer"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👘",
>     "name": "kimono",
>     "keywords": ["dress", "fashion", "women", "female", "japanese"]
>   },
>   {
>     "category": "people",
>     "char": "🥻",
>     "name": "sari",
>     "keywords": ["dress", "fashion", "women", "female"]
>   },
>   {
>     "category": "people",
>     "char": "🩲",
>     "name": "briefs",
>     "keywords": ["dress", "fashion"]
>   },
>   {
>     "category": "people",
>     "char": "🩳",
>     "name": "shorts",
>     "keywords": ["dress", "fashion"]
>   },
>   {
>     "category": "people",
>     "char": "💄",
>     "name": "lipstick",
>     "keywords": ["female", "girl", "fashion", "woman"]
>   },
>   {
>     "category": "people",
>     "char": "💋",
>     "name": "kiss",
>     "keywords": ["face", "lips", "love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "people",
>     "char": "👣",
>     "name": "footprints",
>     "keywords": ["feet", "tracking", "walking", "beach"]
>   },
>   {
>     "category": "people",
>     "char": "🥿",
>     "name": "flat_shoe",
>     "keywords": ["ballet", "slip-on", "slipper"]
>   },
>   {
>     "category": "people",
>     "char": "👠",
>     "name": "high_heel",
>     "keywords": ["fashion", "shoes", "female", "pumps", "stiletto"]
>   },
>   {
>     "category": "people",
>     "char": "👡",
>     "name": "sandal",
>     "keywords": ["shoes", "fashion", "flip flops"]
>   },
>   {
>     "category": "people",
>     "char": "👢",
>     "name": "boot",
>     "keywords": ["shoes", "fashion"]
>   },
>   {
>     "category": "people",
>     "char": "👞",
>     "name": "mans_shoe",
>     "keywords": ["fashion", "male"]
>   },
>   {
>     "category": "people",
>     "char": "👟",
>     "name": "athletic_shoe",
>     "keywords": ["shoes", "sports", "sneakers"]
>   },
>   {
>     "category": "people",
>     "char": "🩴",
>     "name": "thong_sandal",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🩰",
>     "name": "ballet_shoes",
>     "keywords": ["shoes", "sports"]
>   },
>   {
>     "category": "people",
>     "char": "🧦",
>     "name": "socks",
>     "keywords": ["stockings", "clothes"]
>   },
>   {
>     "category": "people",
>     "char": "🧤",
>     "name": "gloves",
>     "keywords": ["hands", "winter", "clothes"]
>   },
>   {
>     "category": "people",
>     "char": "🧣",
>     "name": "scarf",
>     "keywords": ["neck", "winter", "clothes"]
>   },
>   {
>     "category": "people",
>     "char": "👒",
>     "name": "womans_hat",
>     "keywords": ["fashion", "accessories", "female", "lady", "spring"]
>   },
>   {
>     "category": "people",
>     "char": "🎩",
>     "name": "tophat",
>     "keywords": ["magic", "gentleman", "classy", "circus"]
>   },
>   {
>     "category": "people",
>     "char": "🧢",
>     "name": "billed_hat",
>     "keywords": ["cap", "baseball"]
>   },
>   {
>     "category": "people",
>     "char": "⛑",
>     "name": "rescue_worker_helmet",
>     "keywords": ["construction", "build"]
>   },
>   {
>     "category": "people",
>     "char": "🪖",
>     "name": "military_helmet",
>     "keywords": []
>   },
>   {
>     "category": "people",
>     "char": "🎓",
>     "name": "mortar_board",
>     "keywords": [
>       "school",
>       "college",
>       "degree",
>       "university",
>       "graduation",
>       "cap",
>       "hat",
>       "legal",
>       "learn",
>       "education"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👑",
>     "name": "crown",
>     "keywords": ["king", "kod", "leader", "royalty", "lord"]
>   },
>   {
>     "category": "people",
>     "char": "🎒",
>     "name": "school_satchel",
>     "keywords": ["student", "education", "bag", "backpack"]
>   },
>   {
>     "category": "people",
>     "char": "🧳",
>     "name": "luggage",
>     "keywords": ["packing", "travel"]
>   },
>   {
>     "category": "people",
>     "char": "👝",
>     "name": "pouch",
>     "keywords": ["bag", "accessories", "shopping"]
>   },
>   {
>     "category": "people",
>     "char": "👛",
>     "name": "purse",
>     "keywords": ["fashion", "accessories", "money", "sales", "shopping"]
>   },
>   {
>     "category": "people",
>     "char": "👜",
>     "name": "handbag",
>     "keywords": ["fashion", "accessory", "accessories", "shopping"]
>   },
>   {
>     "category": "people",
>     "char": "💼",
>     "name": "briefcase",
>     "keywords": [
>       "business",
>       "documents",
>       "work",
>       "law",
>       "legal",
>       "job",
>       "career"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "👓",
>     "name": "eyeglasses",
>     "keywords": ["fashion", "accessories", "eyesight", "nerdy", "dork", "geek"]
>   },
>   {
>     "category": "people",
>     "char": "🕶",
>     "name": "dark_sunglasses",
>     "keywords": ["face", "cool", "accessories"]
>   },
>   {
>     "category": "people",
>     "char": "🥽",
>     "name": "goggles",
>     "keywords": ["eyes", "protection", "safety"]
>   },
>   {
>     "category": "people",
>     "char": "💍",
>     "name": "ring",
>     "keywords": [
>       "wedding",
>       "propose",
>       "marriage",
>       "valentines",
>       "diamond",
>       "fashion",
>       "jewelry",
>       "gem",
>       "engagement"
>     ]
>   },
>   {
>     "category": "people",
>     "char": "🌂",
>     "name": "closed_umbrella",
>     "keywords": ["weather", "rain", "drizzle"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐶",
>     "name": "dog",
>     "keywords": [
>       "animal",
>       "friend",
>       "nature",
>       "woof",
>       "puppy",
>       "pet",
>       "faithful"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐱",
>     "name": "cat",
>     "keywords": ["animal", "meow", "nature", "pet", "kitten"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐈‍⬛",
>     "name": "black_cat",
>     "keywords": ["animal", "meow", "nature", "pet", "kitten"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐭",
>     "name": "mouse",
>     "keywords": ["animal", "nature", "cheese_wedge", "rodent"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐹",
>     "name": "hamster",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐰",
>     "name": "rabbit",
>     "keywords": ["animal", "nature", "pet", "spring", "magic", "bunny"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦊",
>     "name": "fox_face",
>     "keywords": ["animal", "nature", "face"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐻",
>     "name": "bear",
>     "keywords": ["animal", "nature", "wild"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐼",
>     "name": "panda_face",
>     "keywords": ["animal", "nature", "panda"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐨",
>     "name": "koala",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐯",
>     "name": "tiger",
>     "keywords": ["animal", "cat", "danger", "wild", "nature", "roar"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦁",
>     "name": "lion",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐮",
>     "name": "cow",
>     "keywords": ["beef", "ox", "animal", "nature", "moo", "milk"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐷",
>     "name": "pig",
>     "keywords": ["animal", "oink", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐽",
>     "name": "pig_nose",
>     "keywords": ["animal", "oink"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐸",
>     "name": "frog",
>     "keywords": ["animal", "nature", "croak", "toad"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦑",
>     "name": "squid",
>     "keywords": ["animal", "nature", "ocean", "sea"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐙",
>     "name": "octopus",
>     "keywords": ["animal", "creature", "ocean", "sea", "nature", "beach"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦐",
>     "name": "shrimp",
>     "keywords": ["animal", "ocean", "nature", "seafood"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐵",
>     "name": "monkey_face",
>     "keywords": ["animal", "nature", "circus"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦍",
>     "name": "gorilla",
>     "keywords": ["animal", "nature", "circus"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🙈",
>     "name": "see_no_evil",
>     "keywords": ["monkey", "animal", "nature", "haha"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🙉",
>     "name": "hear_no_evil",
>     "keywords": ["animal", "monkey", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🙊",
>     "name": "speak_no_evil",
>     "keywords": ["monkey", "animal", "nature", "omg"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐒",
>     "name": "monkey",
>     "keywords": ["animal", "nature", "banana", "circus"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐔",
>     "name": "chicken",
>     "keywords": ["animal", "cluck", "nature", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐧",
>     "name": "penguin",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐦",
>     "name": "bird",
>     "keywords": ["animal", "nature", "fly", "tweet", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐤",
>     "name": "baby_chick",
>     "keywords": ["animal", "chicken", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐣",
>     "name": "hatching_chick",
>     "keywords": ["animal", "chicken", "egg", "born", "baby", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐥",
>     "name": "hatched_chick",
>     "keywords": ["animal", "chicken", "baby", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦆",
>     "name": "duck",
>     "keywords": ["animal", "nature", "bird", "mallard"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦅",
>     "name": "eagle",
>     "keywords": ["animal", "nature", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦉",
>     "name": "owl",
>     "keywords": ["animal", "nature", "bird", "hoot"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦇",
>     "name": "bat",
>     "keywords": ["animal", "nature", "blind", "vampire"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐺",
>     "name": "wolf",
>     "keywords": ["animal", "nature", "wild"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐗",
>     "name": "boar",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐴",
>     "name": "horse",
>     "keywords": ["animal", "brown", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦄",
>     "name": "unicorn",
>     "keywords": ["animal", "nature", "mystical"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐝",
>     "name": "honeybee",
>     "keywords": ["animal", "insect", "nature", "bug", "spring", "honey"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐛",
>     "name": "bug",
>     "keywords": ["animal", "insect", "nature", "worm"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦋",
>     "name": "butterfly",
>     "keywords": ["animal", "insect", "nature", "caterpillar"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐌",
>     "name": "snail",
>     "keywords": ["slow", "animal", "shell"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐞",
>     "name": "lady_beetle",
>     "keywords": ["animal", "insect", "nature", "ladybug"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐜",
>     "name": "ant",
>     "keywords": ["animal", "insect", "nature", "bug"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦗",
>     "name": "grasshopper",
>     "keywords": ["animal", "cricket", "chirp"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🕷",
>     "name": "spider",
>     "keywords": ["animal", "arachnid"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪲",
>     "name": "beetle",
>     "keywords": ["animal"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪳",
>     "name": "cockroach",
>     "keywords": ["animal"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪰",
>     "name": "fly",
>     "keywords": ["animal"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪱",
>     "name": "worm",
>     "keywords": ["animal"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦂",
>     "name": "scorpion",
>     "keywords": ["animal", "arachnid"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦀",
>     "name": "crab",
>     "keywords": ["animal", "crustacean"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐍",
>     "name": "snake",
>     "keywords": ["animal", "evil", "nature", "hiss", "python"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦎",
>     "name": "lizard",
>     "keywords": ["animal", "nature", "reptile"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦖",
>     "name": "t-rex",
>     "keywords": ["animal", "nature", "dinosaur", "tyrannosaurus", "extinct"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦕",
>     "name": "sauropod",
>     "keywords": [
>       "animal",
>       "nature",
>       "dinosaur",
>       "brachiosaurus",
>       "brontosaurus",
>       "diplodocus",
>       "extinct"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐢",
>     "name": "turtle",
>     "keywords": ["animal", "slow", "nature", "tortoise"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐠",
>     "name": "tropical_fish",
>     "keywords": ["animal", "swim", "ocean", "beach", "nemo"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐟",
>     "name": "fish",
>     "keywords": ["animal", "food", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐡",
>     "name": "blowfish",
>     "keywords": ["animal", "nature", "food", "sea", "ocean"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐬",
>     "name": "dolphin",
>     "keywords": [
>       "animal",
>       "nature",
>       "fish",
>       "sea",
>       "ocean",
>       "flipper",
>       "fins",
>       "beach"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦈",
>     "name": "shark",
>     "keywords": [
>       "animal",
>       "nature",
>       "fish",
>       "sea",
>       "ocean",
>       "jaws",
>       "fins",
>       "beach"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐳",
>     "name": "whale",
>     "keywords": ["animal", "nature", "sea", "ocean"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐋",
>     "name": "whale2",
>     "keywords": ["animal", "nature", "sea", "ocean"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐊",
>     "name": "crocodile",
>     "keywords": ["animal", "nature", "reptile", "lizard", "alligator"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐆",
>     "name": "leopard",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦓",
>     "name": "zebra",
>     "keywords": ["animal", "nature", "stripes", "safari"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐅",
>     "name": "tiger2",
>     "keywords": ["animal", "nature", "roar"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐃",
>     "name": "water_buffalo",
>     "keywords": ["animal", "nature", "ox", "cow"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐂",
>     "name": "ox",
>     "keywords": ["animal", "cow", "beef"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐄",
>     "name": "cow2",
>     "keywords": ["beef", "ox", "animal", "nature", "moo", "milk"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦌",
>     "name": "deer",
>     "keywords": ["animal", "nature", "horns", "venison"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐪",
>     "name": "dromedary_camel",
>     "keywords": ["animal", "hot", "desert", "hump"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐫",
>     "name": "camel",
>     "keywords": ["animal", "nature", "hot", "desert", "hump"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦒",
>     "name": "giraffe",
>     "keywords": ["animal", "nature", "spots", "safari"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐘",
>     "name": "elephant",
>     "keywords": ["animal", "nature", "nose", "th", "circus"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦏",
>     "name": "rhinoceros",
>     "keywords": ["animal", "nature", "horn"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐐",
>     "name": "goat",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐏",
>     "name": "ram",
>     "keywords": ["animal", "sheep", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐑",
>     "name": "sheep",
>     "keywords": ["animal", "nature", "wool", "shipit"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐎",
>     "name": "racehorse",
>     "keywords": ["animal", "gamble", "luck"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐖",
>     "name": "pig2",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐀",
>     "name": "rat",
>     "keywords": ["animal", "mouse", "rodent"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐁",
>     "name": "mouse2",
>     "keywords": ["animal", "nature", "rodent"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐓",
>     "name": "rooster",
>     "keywords": ["animal", "nature", "chicken"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦃",
>     "name": "turkey",
>     "keywords": ["animal", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🕊",
>     "name": "dove",
>     "keywords": ["animal", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐕",
>     "name": "dog2",
>     "keywords": ["animal", "nature", "friend", "doge", "pet", "faithful"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐩",
>     "name": "poodle",
>     "keywords": ["dog", "animal", "101", "nature", "pet"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐈",
>     "name": "cat2",
>     "keywords": ["animal", "meow", "pet", "cats"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐇",
>     "name": "rabbit2",
>     "keywords": ["animal", "nature", "pet", "magic", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐿",
>     "name": "chipmunk",
>     "keywords": ["animal", "nature", "rodent", "squirrel"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦔",
>     "name": "hedgehog",
>     "keywords": ["animal", "nature", "spiny"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦝",
>     "name": "raccoon",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦙",
>     "name": "llama",
>     "keywords": ["animal", "nature", "alpaca"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦛",
>     "name": "hippopotamus",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦘",
>     "name": "kangaroo",
>     "keywords": ["animal", "nature", "australia", "joey", "hop", "marsupial"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦡",
>     "name": "badger",
>     "keywords": ["animal", "nature", "honey"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦢",
>     "name": "swan",
>     "keywords": ["animal", "nature", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦚",
>     "name": "peacock",
>     "keywords": ["animal", "nature", "peahen", "bird"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦜",
>     "name": "parrot",
>     "keywords": ["animal", "nature", "bird", "pirate", "talk"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦞",
>     "name": "lobster",
>     "keywords": ["animal", "nature", "bisque", "claws", "seafood"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦠",
>     "name": "microbe",
>     "keywords": ["amoeba", "bacteria", "germs"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦟",
>     "name": "mosquito",
>     "keywords": ["animal", "nature", "insect", "malaria"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦬",
>     "name": "bison",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦣",
>     "name": "mammoth",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦫",
>     "name": "beaver",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐻‍❄️",
>     "name": "polar_bear",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦤",
>     "name": "dodo",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪶",
>     "name": "feather",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦭",
>     "name": "seal",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐾",
>     "name": "paw_prints",
>     "keywords": [
>       "animal",
>       "tracking",
>       "footprints",
>       "dog",
>       "cat",
>       "pet",
>       "feet"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐉",
>     "name": "dragon",
>     "keywords": ["animal", "myth", "nature", "chinese", "green"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐲",
>     "name": "dragon_face",
>     "keywords": ["animal", "myth", "nature", "chinese", "green"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦧",
>     "name": "orangutan",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦮",
>     "name": "guide_dog",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐕‍🦺",
>     "name": "service_dog",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦥",
>     "name": "sloth",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦦",
>     "name": "otter",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦨",
>     "name": "skunk",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🦩",
>     "name": "flamingo",
>     "keywords": ["animal", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌵",
>     "name": "cactus",
>     "keywords": ["vegetable", "plant", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🎄",
>     "name": "christmas_tree",
>     "keywords": ["festival", "vacation", "december", "xmas", "celebration"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌲",
>     "name": "evergreen_tree",
>     "keywords": ["plant", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌳",
>     "name": "deciduous_tree",
>     "keywords": ["plant", "nature"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌴",
>     "name": "palm_tree",
>     "keywords": [
>       "plant",
>       "vegetable",
>       "nature",
>       "summer",
>       "beach",
>       "mojito",
>       "tropical"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌱",
>     "name": "seedling",
>     "keywords": ["plant", "nature", "grass", "lawn", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌿",
>     "name": "herb",
>     "keywords": ["vegetable", "plant", "medicine", "weed", "grass", "lawn"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☘",
>     "name": "shamrock",
>     "keywords": ["vegetable", "plant", "nature", "irish", "clover"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🍀",
>     "name": "four_leaf_clover",
>     "keywords": ["vegetable", "plant", "nature", "lucky", "irish"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🎍",
>     "name": "bamboo",
>     "keywords": ["plant", "nature", "vegetable", "panda", "pine_decoration"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🎋",
>     "name": "tanabata_tree",
>     "keywords": ["plant", "nature", "branch", "summer"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🍃",
>     "name": "leaves",
>     "keywords": [
>       "nature",
>       "plant",
>       "tree",
>       "vegetable",
>       "grass",
>       "lawn",
>       "spring"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🍂",
>     "name": "fallen_leaf",
>     "keywords": ["nature", "plant", "vegetable", "leaves"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🍁",
>     "name": "maple_leaf",
>     "keywords": ["nature", "plant", "vegetable", "ca", "fall"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌾",
>     "name": "ear_of_rice",
>     "keywords": ["nature", "plant"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌺",
>     "name": "hibiscus",
>     "keywords": ["plant", "vegetable", "flowers", "beach"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌻",
>     "name": "sunflower",
>     "keywords": ["nature", "plant", "fall"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌹",
>     "name": "rose",
>     "keywords": ["flowers", "valentines", "love", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🥀",
>     "name": "wilted_flower",
>     "keywords": ["plant", "nature", "flower"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌷",
>     "name": "tulip",
>     "keywords": ["flowers", "plant", "nature", "summer", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌼",
>     "name": "blossom",
>     "keywords": ["nature", "flowers", "yellow"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌸",
>     "name": "cherry_blossom",
>     "keywords": ["nature", "plant", "spring", "flower"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💐",
>     "name": "bouquet",
>     "keywords": ["flowers", "nature", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🍄",
>     "name": "mushroom",
>     "keywords": ["plant", "vegetable"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪴",
>     "name": "potted_plant",
>     "keywords": ["plant"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌰",
>     "name": "chestnut",
>     "keywords": ["food", "squirrel"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🎃",
>     "name": "jack_o_lantern",
>     "keywords": ["halloween", "light", "pumpkin", "creepy", "fall"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🐚",
>     "name": "shell",
>     "keywords": ["nature", "sea", "beach"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🕸",
>     "name": "spider_web",
>     "keywords": ["animal", "insect", "arachnid", "silk"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌎",
>     "name": "earth_americas",
>     "keywords": ["globe", "world", "USA", "international"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌍",
>     "name": "earth_africa",
>     "keywords": ["globe", "world", "international"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌏",
>     "name": "earth_asia",
>     "keywords": ["globe", "world", "east", "international"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🪐",
>     "name": "ringed_planet",
>     "keywords": ["saturn"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌕",
>     "name": "full_moon",
>     "keywords": [
>       "nature",
>       "yellow",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌖",
>     "name": "waning_gibbous_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep",
>       "waxing_gibbous_moon"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌗",
>     "name": "last_quarter_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌘",
>     "name": "waning_crescent_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌑",
>     "name": "new_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌒",
>     "name": "waxing_crescent_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌓",
>     "name": "first_quarter_moon",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌔",
>     "name": "waxing_gibbous_moon",
>     "keywords": [
>       "nature",
>       "night",
>       "sky",
>       "gray",
>       "twilight",
>       "planet",
>       "space",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌚",
>     "name": "new_moon_with_face",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌝",
>     "name": "full_moon_with_face",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌛",
>     "name": "first_quarter_moon_with_face",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌜",
>     "name": "last_quarter_moon_with_face",
>     "keywords": [
>       "nature",
>       "twilight",
>       "planet",
>       "space",
>       "night",
>       "evening",
>       "sleep"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌞",
>     "name": "sun_with_face",
>     "keywords": ["nature", "morning", "sky"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌙",
>     "name": "crescent_moon",
>     "keywords": ["night", "sleep", "sky", "evening", "magic"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "⭐",
>     "name": "star",
>     "keywords": ["night", "yellow"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌟",
>     "name": "star2",
>     "keywords": ["night", "sparkle", "awesome", "good", "magic"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💫",
>     "name": "dizzy",
>     "keywords": ["star", "sparkle", "shoot", "magic"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "✨",
>     "name": "sparkles",
>     "keywords": ["stars", "shine", "shiny", "cool", "awesome", "good", "magic"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☄",
>     "name": "comet",
>     "keywords": ["space"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☀️",
>     "name": "sunny",
>     "keywords": ["weather", "nature", "brightness", "summer", "beach", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌤",
>     "name": "sun_behind_small_cloud",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "⛅",
>     "name": "partly_sunny",
>     "keywords": ["weather", "nature", "cloudy", "morning", "fall", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌥",
>     "name": "sun_behind_large_cloud",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌦",
>     "name": "sun_behind_rain_cloud",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☁️",
>     "name": "cloud",
>     "keywords": ["weather", "sky"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌧",
>     "name": "cloud_with_rain",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "⛈",
>     "name": "cloud_with_lightning_and_rain",
>     "keywords": ["weather", "lightning"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌩",
>     "name": "cloud_with_lightning",
>     "keywords": ["weather", "thunder"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "⚡",
>     "name": "zap",
>     "keywords": ["thunder", "weather", "lightning bolt", "fast"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🔥",
>     "name": "fire",
>     "keywords": ["hot", "cook", "flame"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💥",
>     "name": "boom",
>     "keywords": ["bomb", "explode", "explosion", "collision", "blown"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "❄️",
>     "name": "snowflake",
>     "keywords": ["winter", "season", "cold", "weather", "christmas", "xmas"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌨",
>     "name": "cloud_with_snow",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "⛄",
>     "name": "snowman",
>     "keywords": [
>       "winter",
>       "season",
>       "cold",
>       "weather",
>       "christmas",
>       "xmas",
>       "frozen",
>       "without_snow"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☃",
>     "name": "snowman_with_snow",
>     "keywords": [
>       "winter",
>       "season",
>       "cold",
>       "weather",
>       "christmas",
>       "xmas",
>       "frozen"
>     ]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌬",
>     "name": "wind_face",
>     "keywords": ["gust", "air"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💨",
>     "name": "dash",
>     "keywords": ["wind", "air", "fast", "shoo", "fart", "smoke", "puff"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌪",
>     "name": "tornado",
>     "keywords": ["weather", "cyclone", "twister"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌫",
>     "name": "fog",
>     "keywords": ["weather"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☂",
>     "name": "open_umbrella",
>     "keywords": ["weather", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "☔",
>     "name": "umbrella",
>     "keywords": ["rainy", "weather", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💧",
>     "name": "droplet",
>     "keywords": ["water", "drip", "faucet", "spring"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "💦",
>     "name": "sweat_drops",
>     "keywords": ["water", "drip", "oops"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "🌊",
>     "name": "ocean",
>     "keywords": ["sea", "water", "wave", "nature", "tsunami", "disaster"]
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "\uD83E\uDEB7",
>     "name": "lotus",
>     "keywords": []
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "\uD83E\uDEB8",
>     "name": "coral",
>     "keywords": []
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "\uD83E\uDEB9",
>     "name": "empty_nest",
>     "keywords": []
>   },
>   {
>     "category": "animals_and_nature",
>     "char": "\uD83E\uDEBA",
>     "name": "nest_with_eggs",
>     "keywords": []
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍏",
>     "name": "green_apple",
>     "keywords": ["fruit", "nature"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍎",
>     "name": "apple",
>     "keywords": ["fruit", "mac", "school"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍐",
>     "name": "pear",
>     "keywords": ["fruit", "nature", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍊",
>     "name": "tangerine",
>     "keywords": ["food", "fruit", "nature", "orange"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍋",
>     "name": "lemon",
>     "keywords": ["fruit", "nature"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍌",
>     "name": "banana",
>     "keywords": ["fruit", "food", "monkey"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍉",
>     "name": "watermelon",
>     "keywords": ["fruit", "food", "picnic", "summer"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍇",
>     "name": "grapes",
>     "keywords": ["fruit", "food", "wine"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍓",
>     "name": "strawberry",
>     "keywords": ["fruit", "food", "nature"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍈",
>     "name": "melon",
>     "keywords": ["fruit", "nature", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍒",
>     "name": "cherries",
>     "keywords": ["food", "fruit"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍑",
>     "name": "peach",
>     "keywords": ["fruit", "nature", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍍",
>     "name": "pineapple",
>     "keywords": ["fruit", "nature", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥥",
>     "name": "coconut",
>     "keywords": ["fruit", "nature", "food", "palm"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥝",
>     "name": "kiwi_fruit",
>     "keywords": ["fruit", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥭",
>     "name": "mango",
>     "keywords": ["fruit", "food", "tropical"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥑",
>     "name": "avocado",
>     "keywords": ["fruit", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥦",
>     "name": "broccoli",
>     "keywords": ["fruit", "food", "vegetable"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍅",
>     "name": "tomato",
>     "keywords": ["fruit", "vegetable", "nature", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍆",
>     "name": "eggplant",
>     "keywords": ["vegetable", "nature", "food", "aubergine"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥒",
>     "name": "cucumber",
>     "keywords": ["fruit", "food", "pickle"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫐",
>     "name": "blueberries",
>     "keywords": ["fruit", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫒",
>     "name": "olive",
>     "keywords": ["fruit", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫑",
>     "name": "bell_pepper",
>     "keywords": ["fruit", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥕",
>     "name": "carrot",
>     "keywords": ["vegetable", "food", "orange"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🌶",
>     "name": "hot_pepper",
>     "keywords": ["food", "spicy", "chilli", "chili"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥔",
>     "name": "potato",
>     "keywords": ["food", "tuber", "vegatable", "starch"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🌽",
>     "name": "corn",
>     "keywords": ["food", "vegetable", "plant"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥬",
>     "name": "leafy_greens",
>     "keywords": [
>       "food",
>       "vegetable",
>       "plant",
>       "bok choy",
>       "cabbage",
>       "kale",
>       "lettuce"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍠",
>     "name": "sweet_potato",
>     "keywords": ["food", "nature"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥜",
>     "name": "peanuts",
>     "keywords": ["food", "nut"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧄",
>     "name": "garlic",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧅",
>     "name": "onion",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍯",
>     "name": "honey_pot",
>     "keywords": ["bees", "sweet", "kitchen"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥐",
>     "name": "croissant",
>     "keywords": ["food", "bread", "french"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍞",
>     "name": "bread",
>     "keywords": ["food", "wheat", "breakfast", "toast"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥖",
>     "name": "baguette_bread",
>     "keywords": ["food", "bread", "french"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥯",
>     "name": "bagel",
>     "keywords": ["food", "bread", "bakery", "schmear"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥨",
>     "name": "pretzel",
>     "keywords": ["food", "bread", "twisted"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧀",
>     "name": "cheese",
>     "keywords": ["food", "chadder"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥚",
>     "name": "egg",
>     "keywords": ["food", "chicken", "breakfast"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥓",
>     "name": "bacon",
>     "keywords": ["food", "breakfast", "pork", "pig", "meat"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥩",
>     "name": "steak",
>     "keywords": ["food", "cow", "meat", "cut", "chop", "lambchop", "porkchop"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥞",
>     "name": "pancakes",
>     "keywords": ["food", "breakfast", "flapjacks", "hotcakes"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍗",
>     "name": "poultry_leg",
>     "keywords": ["food", "meat", "drumstick", "bird", "chicken", "turkey"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍖",
>     "name": "meat_on_bone",
>     "keywords": ["good", "food", "drumstick"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🦴",
>     "name": "bone",
>     "keywords": ["skeleton"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍤",
>     "name": "fried_shrimp",
>     "keywords": ["food", "animal", "appetizer", "summer"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍳",
>     "name": "fried_egg",
>     "keywords": ["food", "breakfast", "kitchen", "egg"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍔",
>     "name": "hamburger",
>     "keywords": [
>       "meat",
>       "fast food",
>       "beef",
>       "cheeseburger",
>       "mcdonalds",
>       "burger king"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍟",
>     "name": "fries",
>     "keywords": ["chips", "snack", "fast food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥙",
>     "name": "stuffed_flatbread",
>     "keywords": ["food", "flatbread", "stuffed", "gyro"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🌭",
>     "name": "hotdog",
>     "keywords": ["food", "frankfurter"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍕",
>     "name": "pizza",
>     "keywords": ["food", "party"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥪",
>     "name": "sandwich",
>     "keywords": ["food", "lunch", "bread"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥫",
>     "name": "canned_food",
>     "keywords": ["food", "soup"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍝",
>     "name": "spaghetti",
>     "keywords": ["food", "italian", "noodle"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🌮",
>     "name": "taco",
>     "keywords": ["food", "mexican"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🌯",
>     "name": "burrito",
>     "keywords": ["food", "mexican"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥗",
>     "name": "green_salad",
>     "keywords": ["food", "healthy", "lettuce"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥘",
>     "name": "shallow_pan_of_food",
>     "keywords": ["food", "cooking", "casserole", "paella"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍜",
>     "name": "ramen",
>     "keywords": ["food", "japanese", "noodle", "chopsticks"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍲",
>     "name": "stew",
>     "keywords": ["food", "meat", "soup"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍥",
>     "name": "fish_cake",
>     "keywords": [
>       "food",
>       "japan",
>       "sea",
>       "beach",
>       "narutomaki",
>       "pink",
>       "swirl",
>       "kamaboko",
>       "surimi",
>       "ramen"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥠",
>     "name": "fortune_cookie",
>     "keywords": ["food", "prophecy"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍣",
>     "name": "sushi",
>     "keywords": ["food", "fish", "japanese", "rice"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍱",
>     "name": "bento",
>     "keywords": ["food", "japanese", "box"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍛",
>     "name": "curry",
>     "keywords": ["food", "spicy", "hot", "indian"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍙",
>     "name": "rice_ball",
>     "keywords": ["food", "japanese"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍚",
>     "name": "rice",
>     "keywords": ["food", "china", "asian"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍘",
>     "name": "rice_cracker",
>     "keywords": ["food", "japanese"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍢",
>     "name": "oden",
>     "keywords": ["food", "japanese"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍡",
>     "name": "dango",
>     "keywords": ["food", "dessert", "sweet", "japanese", "barbecue", "meat"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍧",
>     "name": "shaved_ice",
>     "keywords": ["hot", "dessert", "summer"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍨",
>     "name": "ice_cream",
>     "keywords": ["food", "hot", "dessert"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍦",
>     "name": "icecream",
>     "keywords": ["food", "hot", "dessert", "summer"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥧",
>     "name": "pie",
>     "keywords": ["food", "dessert", "pastry"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍰",
>     "name": "cake",
>     "keywords": ["food", "dessert"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧁",
>     "name": "cupcake",
>     "keywords": ["food", "dessert", "bakery", "sweet"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥮",
>     "name": "moon_cake",
>     "keywords": ["food", "autumn"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🎂",
>     "name": "birthday",
>     "keywords": ["food", "dessert", "cake"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍮",
>     "name": "custard",
>     "keywords": ["dessert", "food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍬",
>     "name": "candy",
>     "keywords": ["snack", "dessert", "sweet", "lolly"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍭",
>     "name": "lollipop",
>     "keywords": ["food", "snack", "candy", "sweet"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍫",
>     "name": "chocolate_bar",
>     "keywords": ["food", "snack", "dessert", "sweet"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍿",
>     "name": "popcorn",
>     "keywords": ["food", "movie theater", "films", "snack"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥟",
>     "name": "dumpling",
>     "keywords": ["food", "empanada", "pierogi", "potsticker"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍩",
>     "name": "doughnut",
>     "keywords": ["food", "dessert", "snack", "sweet", "donut"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍪",
>     "name": "cookie",
>     "keywords": ["food", "snack", "oreo", "chocolate", "sweet", "dessert"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧇",
>     "name": "waffle",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧆",
>     "name": "falafel",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧈",
>     "name": "butter",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🦪",
>     "name": "oyster",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫓",
>     "name": "flatbread",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫔",
>     "name": "tamale",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫕",
>     "name": "fondue",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥛",
>     "name": "milk_glass",
>     "keywords": ["beverage", "drink", "cow"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍺",
>     "name": "beer",
>     "keywords": [
>       "relax",
>       "beverage",
>       "drink",
>       "drunk",
>       "party",
>       "pub",
>       "summer",
>       "alcohol",
>       "booze"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍻",
>     "name": "beers",
>     "keywords": [
>       "relax",
>       "beverage",
>       "drink",
>       "drunk",
>       "party",
>       "pub",
>       "summer",
>       "alcohol",
>       "booze"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥂",
>     "name": "clinking_glasses",
>     "keywords": [
>       "beverage",
>       "drink",
>       "party",
>       "alcohol",
>       "celebrate",
>       "cheers",
>       "wine",
>       "champagne",
>       "toast"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍷",
>     "name": "wine_glass",
>     "keywords": ["drink", "beverage", "drunk", "alcohol", "booze"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥃",
>     "name": "tumbler_glass",
>     "keywords": [
>       "drink",
>       "beverage",
>       "drunk",
>       "alcohol",
>       "liquor",
>       "booze",
>       "bourbon",
>       "scotch",
>       "whisky",
>       "glass",
>       "shot"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍸",
>     "name": "cocktail",
>     "keywords": ["drink", "drunk", "alcohol", "beverage", "booze", "mojito"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍹",
>     "name": "tropical_drink",
>     "keywords": [
>       "beverage",
>       "cocktail",
>       "summer",
>       "beach",
>       "alcohol",
>       "booze",
>       "mojito"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍾",
>     "name": "champagne",
>     "keywords": ["drink", "wine", "bottle", "celebration"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍶",
>     "name": "sake",
>     "keywords": [
>       "wine",
>       "drink",
>       "drunk",
>       "beverage",
>       "japanese",
>       "alcohol",
>       "booze"
>     ]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍵",
>     "name": "tea",
>     "keywords": ["drink", "bowl", "breakfast", "green", "british"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥤",
>     "name": "cup_with_straw",
>     "keywords": ["drink", "soda"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "☕",
>     "name": "coffee",
>     "keywords": ["beverage", "caffeine", "latte", "espresso"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🫖",
>     "name": "teapot",
>     "keywords": []
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧋",
>     "name": "bubble_tea",
>     "keywords": ["tapioca"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍼",
>     "name": "baby_bottle",
>     "keywords": ["food", "container", "milk"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧃",
>     "name": "beverage_box",
>     "keywords": ["food", "drink"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧉",
>     "name": "mate",
>     "keywords": ["food", "drink"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧊",
>     "name": "ice_cube",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🧂",
>     "name": "salt",
>     "keywords": ["condiment", "shaker"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥄",
>     "name": "spoon",
>     "keywords": ["cutlery", "kitchen", "tableware"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍴",
>     "name": "fork_and_knife",
>     "keywords": ["cutlery", "kitchen"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🍽",
>     "name": "plate_with_cutlery",
>     "keywords": ["food", "eat", "meal", "lunch", "dinner", "restaurant"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥣",
>     "name": "bowl_with_spoon",
>     "keywords": ["food", "breakfast", "cereal", "oatmeal", "porridge"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥡",
>     "name": "takeout_box",
>     "keywords": ["food", "leftovers"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "🥢",
>     "name": "chopsticks",
>     "keywords": ["food"]
>   },
>   {
>     "category": "food_and_drink",
>     "char": "\uD83E\uDED7",
>     "name": "pouring_liquid",
>     "keywords": []
>   },
>   {
>     "category": "food_and_drink",
>     "char": "\uD83E\uDED8",
>     "name": "beans",
>     "keywords": []
>   },
>   {
>     "category": "food_and_drink",
>     "char": "\uD83E\uDED9",
>     "name": "jar",
>     "keywords": []
>   },
>   {
>     "category": "activity",
>     "char": "⚽",
>     "name": "soccer",
>     "keywords": ["sports", "football"]
>   },
>   {
>     "category": "activity",
>     "char": "🏀",
>     "name": "basketball",
>     "keywords": ["sports", "balls", "NBA"]
>   },
>   {
>     "category": "activity",
>     "char": "🏈",
>     "name": "football",
>     "keywords": ["sports", "balls", "NFL"]
>   },
>   {
>     "category": "activity",
>     "char": "⚾",
>     "name": "baseball",
>     "keywords": ["sports", "balls"]
>   },
>   {
>     "category": "activity",
>     "char": "🥎",
>     "name": "softball",
>     "keywords": ["sports", "balls"]
>   },
>   {
>     "category": "activity",
>     "char": "🎾",
>     "name": "tennis",
>     "keywords": ["sports", "balls", "green"]
>   },
>   {
>     "category": "activity",
>     "char": "🏐",
>     "name": "volleyball",
>     "keywords": ["sports", "balls"]
>   },
>   {
>     "category": "activity",
>     "char": "🏉",
>     "name": "rugby_football",
>     "keywords": ["sports", "team"]
>   },
>   {
>     "category": "activity",
>     "char": "🥏",
>     "name": "flying_disc",
>     "keywords": ["sports", "frisbee", "ultimate"]
>   },
>   {
>     "category": "activity",
>     "char": "🎱",
>     "name": "8ball",
>     "keywords": ["pool", "hobby", "game", "luck", "magic"]
>   },
>   {
>     "category": "activity",
>     "char": "⛳",
>     "name": "golf",
>     "keywords": ["sports", "business", "flag", "hole", "summer"]
>   },
>   {
>     "category": "activity",
>     "char": "🏌️‍♀️",
>     "name": "golfing_woman",
>     "keywords": ["sports", "business", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "🏌",
>     "name": "golfing_man",
>     "keywords": ["sports", "business"]
>   },
>   {
>     "category": "activity",
>     "char": "🏓",
>     "name": "ping_pong",
>     "keywords": ["sports", "pingpong"]
>   },
>   {
>     "category": "activity",
>     "char": "🏸",
>     "name": "badminton",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🥅",
>     "name": "goal_net",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🏒",
>     "name": "ice_hockey",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🏑",
>     "name": "field_hockey",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🥍",
>     "name": "lacrosse",
>     "keywords": ["sports", "ball", "stick"]
>   },
>   {
>     "category": "activity",
>     "char": "🏏",
>     "name": "cricket",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🎿",
>     "name": "ski",
>     "keywords": ["sports", "winter", "cold", "snow"]
>   },
>   {
>     "category": "activity",
>     "char": "⛷",
>     "name": "skier",
>     "keywords": ["sports", "winter", "snow"]
>   },
>   {
>     "category": "activity",
>     "char": "🏂",
>     "name": "snowboarder",
>     "keywords": ["sports", "winter"]
>   },
>   {
>     "category": "activity",
>     "char": "🤺",
>     "name": "person_fencing",
>     "keywords": ["sports", "fencing", "sword"]
>   },
>   {
>     "category": "activity",
>     "char": "🤼‍♀️",
>     "name": "women_wrestling",
>     "keywords": ["sports", "wrestlers"]
>   },
>   {
>     "category": "activity",
>     "char": "🤼‍♂️",
>     "name": "men_wrestling",
>     "keywords": ["sports", "wrestlers"]
>   },
>   {
>     "category": "activity",
>     "char": "🤸‍♀️",
>     "name": "woman_cartwheeling",
>     "keywords": ["gymnastics"]
>   },
>   {
>     "category": "activity",
>     "char": "🤸‍♂️",
>     "name": "man_cartwheeling",
>     "keywords": ["gymnastics"]
>   },
>   {
>     "category": "activity",
>     "char": "🤾‍♀️",
>     "name": "woman_playing_handball",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🤾‍♂️",
>     "name": "man_playing_handball",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "⛸",
>     "name": "ice_skate",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🥌",
>     "name": "curling_stone",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🛹",
>     "name": "skateboard",
>     "keywords": ["board"]
>   },
>   {
>     "category": "activity",
>     "char": "🛷",
>     "name": "sled",
>     "keywords": ["sleigh", "luge", "toboggan"]
>   },
>   {
>     "category": "activity",
>     "char": "🏹",
>     "name": "bow_and_arrow",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🎣",
>     "name": "fishing_pole_and_fish",
>     "keywords": ["food", "hobby", "summer"]
>   },
>   {
>     "category": "activity",
>     "char": "🥊",
>     "name": "boxing_glove",
>     "keywords": ["sports", "fighting"]
>   },
>   {
>     "category": "activity",
>     "char": "🥋",
>     "name": "martial_arts_uniform",
>     "keywords": ["judo", "karate", "taekwondo"]
>   },
>   {
>     "category": "activity",
>     "char": "🚣‍♀️",
>     "name": "rowing_woman",
>     "keywords": ["sports", "hobby", "water", "ship", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "🚣",
>     "name": "rowing_man",
>     "keywords": ["sports", "hobby", "water", "ship"]
>   },
>   {
>     "category": "activity",
>     "char": "🧗‍♀️",
>     "name": "climbing_woman",
>     "keywords": ["sports", "hobby", "woman", "female", "rock"]
>   },
>   {
>     "category": "activity",
>     "char": "🧗‍♂️",
>     "name": "climbing_man",
>     "keywords": ["sports", "hobby", "man", "male", "rock"]
>   },
>   {
>     "category": "activity",
>     "char": "🏊‍♀️",
>     "name": "swimming_woman",
>     "keywords": [
>       "sports",
>       "exercise",
>       "human",
>       "athlete",
>       "water",
>       "summer",
>       "woman",
>       "female"
>     ]
>   },
>   {
>     "category": "activity",
>     "char": "🏊",
>     "name": "swimming_man",
>     "keywords": ["sports", "exercise", "human", "athlete", "water", "summer"]
>   },
>   {
>     "category": "activity",
>     "char": "🤽‍♀️",
>     "name": "woman_playing_water_polo",
>     "keywords": ["sports", "pool"]
>   },
>   {
>     "category": "activity",
>     "char": "🤽‍♂️",
>     "name": "man_playing_water_polo",
>     "keywords": ["sports", "pool"]
>   },
>   {
>     "category": "activity",
>     "char": "🧘‍♀️",
>     "name": "woman_in_lotus_position",
>     "keywords": [
>       "woman",
>       "female",
>       "meditation",
>       "yoga",
>       "serenity",
>       "zen",
>       "mindfulness"
>     ]
>   },
>   {
>     "category": "activity",
>     "char": "🧘‍♂️",
>     "name": "man_in_lotus_position",
>     "keywords": [
>       "man",
>       "male",
>       "meditation",
>       "yoga",
>       "serenity",
>       "zen",
>       "mindfulness"
>     ]
>   },
>   {
>     "category": "activity",
>     "char": "🏄‍♀️",
>     "name": "surfing_woman",
>     "keywords": ["sports", "ocean", "sea", "summer", "beach", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "🏄",
>     "name": "surfing_man",
>     "keywords": ["sports", "ocean", "sea", "summer", "beach"]
>   },
>   {
>     "category": "activity",
>     "char": "🛀",
>     "name": "bath",
>     "keywords": ["clean", "shower", "bathroom"]
>   },
>   {
>     "category": "activity",
>     "char": "⛹️‍♀️",
>     "name": "basketball_woman",
>     "keywords": ["sports", "human", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "⛹",
>     "name": "basketball_man",
>     "keywords": ["sports", "human"]
>   },
>   {
>     "category": "activity",
>     "char": "🏋️‍♀️",
>     "name": "weight_lifting_woman",
>     "keywords": ["sports", "training", "exercise", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "🏋",
>     "name": "weight_lifting_man",
>     "keywords": ["sports", "training", "exercise"]
>   },
>   {
>     "category": "activity",
>     "char": "🚴‍♀️",
>     "name": "biking_woman",
>     "keywords": ["sports", "bike", "exercise", "hipster", "woman", "female"]
>   },
>   {
>     "category": "activity",
>     "char": "🚴",
>     "name": "biking_man",
>     "keywords": ["sports", "bike", "exercise", "hipster"]
>   },
>   {
>     "category": "activity",
>     "char": "🚵‍♀️",
>     "name": "mountain_biking_woman",
>     "keywords": [
>       "transportation",
>       "sports",
>       "human",
>       "race",
>       "bike",
>       "woman",
>       "female"
>     ]
>   },
>   {
>     "category": "activity",
>     "char": "🚵",
>     "name": "mountain_biking_man",
>     "keywords": ["transportation", "sports", "human", "race", "bike"]
>   },
>   {
>     "category": "activity",
>     "char": "🏇",
>     "name": "horse_racing",
>     "keywords": ["animal", "betting", "competition", "gambling", "luck"]
>   },
>   {
>     "category": "activity",
>     "char": "🤿",
>     "name": "diving_mask",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🪀",
>     "name": "yo_yo",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🪁",
>     "name": "kite",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🦺",
>     "name": "safety_vest",
>     "keywords": ["sports"]
>   },
>   {
>     "category": "activity",
>     "char": "🪡",
>     "name": "sewing_needle",
>     "keywords": []
>   },
>   { "category": "activity", "char": "🪢", "name": "knot", "keywords": [] },
>   {
>     "category": "activity",
>     "char": "🕴",
>     "name": "business_suit_levitating",
>     "keywords": ["suit", "business", "levitate", "hover", "jump"]
>   },
>   {
>     "category": "activity",
>     "char": "🏆",
>     "name": "trophy",
>     "keywords": ["win", "award", "contest", "place", "ftw", "ceremony"]
>   },
>   {
>     "category": "activity",
>     "char": "🎽",
>     "name": "running_shirt_with_sash",
>     "keywords": ["play", "pageant"]
>   },
>   {
>     "category": "activity",
>     "char": "🏅",
>     "name": "medal_sports",
>     "keywords": ["award", "winning"]
>   },
>   {
>     "category": "activity",
>     "char": "🎖",
>     "name": "medal_military",
>     "keywords": ["award", "winning", "army"]
>   },
>   {
>     "category": "activity",
>     "char": "🥇",
>     "name": "1st_place_medal",
>     "keywords": ["award", "winning", "first"]
>   },
>   {
>     "category": "activity",
>     "char": "🥈",
>     "name": "2nd_place_medal",
>     "keywords": ["award", "second"]
>   },
>   {
>     "category": "activity",
>     "char": "🥉",
>     "name": "3rd_place_medal",
>     "keywords": ["award", "third"]
>   },
>   {
>     "category": "activity",
>     "char": "🎗",
>     "name": "reminder_ribbon",
>     "keywords": ["sports", "cause", "support", "awareness"]
>   },
>   {
>     "category": "activity",
>     "char": "🏵",
>     "name": "rosette",
>     "keywords": ["flower", "decoration", "military"]
>   },
>   {
>     "category": "activity",
>     "char": "🎫",
>     "name": "ticket",
>     "keywords": ["event", "concert", "pass"]
>   },
>   {
>     "category": "activity",
>     "char": "🎟",
>     "name": "tickets",
>     "keywords": ["sports", "concert", "entrance"]
>   },
>   {
>     "category": "activity",
>     "char": "🎭",
>     "name": "performing_arts",
>     "keywords": ["acting", "theater", "drama"]
>   },
>   {
>     "category": "activity",
>     "char": "🎨",
>     "name": "art",
>     "keywords": ["design", "paint", "draw", "colors"]
>   },
>   {
>     "category": "activity",
>     "char": "🎪",
>     "name": "circus_tent",
>     "keywords": ["festival", "carnival", "party"]
>   },
>   {
>     "category": "activity",
>     "char": "🤹‍♀️",
>     "name": "woman_juggling",
>     "keywords": ["juggle", "balance", "skill", "multitask"]
>   },
>   {
>     "category": "activity",
>     "char": "🤹‍♂️",
>     "name": "man_juggling",
>     "keywords": ["juggle", "balance", "skill", "multitask"]
>   },
>   {
>     "category": "activity",
>     "char": "🎤",
>     "name": "microphone",
>     "keywords": ["sound", "music", "PA", "sing", "talkshow"]
>   },
>   {
>     "category": "activity",
>     "char": "🎧",
>     "name": "headphones",
>     "keywords": ["music", "score", "gadgets"]
>   },
>   {
>     "category": "activity",
>     "char": "🎼",
>     "name": "musical_score",
>     "keywords": ["treble", "clef", "compose"]
>   },
>   {
>     "category": "activity",
>     "char": "🎹",
>     "name": "musical_keyboard",
>     "keywords": ["piano", "instrument", "compose"]
>   },
>   {
>     "category": "activity",
>     "char": "🥁",
>     "name": "drum",
>     "keywords": ["music", "instrument", "drumsticks", "snare"]
>   },
>   {
>     "category": "activity",
>     "char": "🎷",
>     "name": "saxophone",
>     "keywords": ["music", "instrument", "jazz", "blues"]
>   },
>   {
>     "category": "activity",
>     "char": "🎺",
>     "name": "trumpet",
>     "keywords": ["music", "brass"]
>   },
>   {
>     "category": "activity",
>     "char": "🎸",
>     "name": "guitar",
>     "keywords": ["music", "instrument"]
>   },
>   {
>     "category": "activity",
>     "char": "🎻",
>     "name": "violin",
>     "keywords": ["music", "instrument", "orchestra", "symphony"]
>   },
>   {
>     "category": "activity",
>     "char": "🪕",
>     "name": "banjo",
>     "keywords": ["music", "instrument"]
>   },
>   {
>     "category": "activity",
>     "char": "🪗",
>     "name": "accordion",
>     "keywords": ["music", "instrument"]
>   },
>   {
>     "category": "activity",
>     "char": "🪘",
>     "name": "long_drum",
>     "keywords": ["music", "instrument"]
>   },
>   {
>     "category": "activity",
>     "char": "🎬",
>     "name": "clapper",
>     "keywords": ["movie", "film", "record"]
>   },
>   {
>     "category": "activity",
>     "char": "🎮",
>     "name": "video_game",
>     "keywords": ["play", "console", "PS4", "controller"]
>   },
>   {
>     "category": "activity",
>     "char": "👾",
>     "name": "space_invader",
>     "keywords": ["game", "arcade", "play"]
>   },
>   {
>     "category": "activity",
>     "char": "🎯",
>     "name": "dart",
>     "keywords": ["game", "play", "bar", "target", "bullseye"]
>   },
>   {
>     "category": "activity",
>     "char": "🎲",
>     "name": "game_die",
>     "keywords": ["dice", "random", "tabletop", "play", "luck"]
>   },
>   {
>     "category": "activity",
>     "char": "♟️",
>     "name": "chess_pawn",
>     "keywords": ["expendable"]
>   },
>   {
>     "category": "activity",
>     "char": "🎰",
>     "name": "slot_machine",
>     "keywords": ["bet", "gamble", "vegas", "fruit machine", "luck", "casino"]
>   },
>   {
>     "category": "activity",
>     "char": "🧩",
>     "name": "jigsaw",
>     "keywords": ["interlocking", "puzzle", "piece"]
>   },
>   {
>     "category": "activity",
>     "char": "🎳",
>     "name": "bowling",
>     "keywords": ["sports", "fun", "play"]
>   },
>   {
>     "category": "activity",
>     "char": "🪄",
>     "name": "magic_wand",
>     "keywords": []
>   },
>   { "category": "activity", "char": "🪅", "name": "pinata", "keywords": [] },
>   {
>     "category": "activity",
>     "char": "🪆",
>     "name": "nesting_dolls",
>     "keywords": []
>   },
>   {
>     "category": "activity",
>     "char": "\uD83E\uDEAC",
>     "name": "hamsa",
>     "keywords": []
>   },
>   {
>     "category": "activity",
>     "char": "\uD83E\uDEA9",
>     "name": "mirror_ball",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚗",
>     "name": "red_car",
>     "keywords": ["red", "transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚕",
>     "name": "taxi",
>     "keywords": ["uber", "vehicle", "cars", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚙",
>     "name": "blue_car",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚌",
>     "name": "bus",
>     "keywords": ["car", "vehicle", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚎",
>     "name": "trolleybus",
>     "keywords": ["bart", "transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏎",
>     "name": "racing_car",
>     "keywords": ["sports", "race", "fast", "formula", "f1"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚓",
>     "name": "police_car",
>     "keywords": [
>       "vehicle",
>       "cars",
>       "transportation",
>       "law",
>       "legal",
>       "enforcement"
>     ]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚑",
>     "name": "ambulance",
>     "keywords": ["health", "911", "hospital"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚒",
>     "name": "fire_engine",
>     "keywords": ["transportation", "cars", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚐",
>     "name": "minibus",
>     "keywords": ["vehicle", "car", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚚",
>     "name": "truck",
>     "keywords": ["cars", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚛",
>     "name": "articulated_lorry",
>     "keywords": ["vehicle", "cars", "transportation", "express"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚜",
>     "name": "tractor",
>     "keywords": ["vehicle", "car", "farming", "agriculture"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛴",
>     "name": "kick_scooter",
>     "keywords": ["vehicle", "kick", "razor"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏍",
>     "name": "motorcycle",
>     "keywords": ["race", "sports", "fast"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚲",
>     "name": "bike",
>     "keywords": ["sports", "bicycle", "exercise", "hipster"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛵",
>     "name": "motor_scooter",
>     "keywords": ["vehicle", "vespa", "sasha"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🦽",
>     "name": "manual_wheelchair",
>     "keywords": ["vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🦼",
>     "name": "motorized_wheelchair",
>     "keywords": ["vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛺",
>     "name": "auto_rickshaw",
>     "keywords": ["vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🪂",
>     "name": "parachute",
>     "keywords": ["vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚨",
>     "name": "rotating_light",
>     "keywords": [
>       "police",
>       "ambulance",
>       "911",
>       "emergency",
>       "alert",
>       "error",
>       "pinged",
>       "law",
>       "legal"
>     ]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚔",
>     "name": "oncoming_police_car",
>     "keywords": ["vehicle", "law", "legal", "enforcement", "911"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚍",
>     "name": "oncoming_bus",
>     "keywords": ["vehicle", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚘",
>     "name": "oncoming_automobile",
>     "keywords": ["car", "vehicle", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚖",
>     "name": "oncoming_taxi",
>     "keywords": ["vehicle", "cars", "uber"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚡",
>     "name": "aerial_tramway",
>     "keywords": ["transportation", "vehicle", "ski"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚠",
>     "name": "mountain_cableway",
>     "keywords": ["transportation", "vehicle", "ski"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚟",
>     "name": "suspension_railway",
>     "keywords": ["vehicle", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚃",
>     "name": "railway_car",
>     "keywords": ["transportation", "vehicle", "train"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚋",
>     "name": "train",
>     "keywords": ["transportation", "vehicle", "carriage", "public", "travel"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚝",
>     "name": "monorail",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚄",
>     "name": "bullettrain_side",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚅",
>     "name": "bullettrain_front",
>     "keywords": [
>       "transportation",
>       "vehicle",
>       "speed",
>       "fast",
>       "public",
>       "travel"
>     ]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚈",
>     "name": "light_rail",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚞",
>     "name": "mountain_railway",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚂",
>     "name": "steam_locomotive",
>     "keywords": ["transportation", "vehicle", "train"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚆",
>     "name": "train2",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚇",
>     "name": "metro",
>     "keywords": ["transportation", "blue-square", "mrt", "underground", "tube"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚊",
>     "name": "tram",
>     "keywords": ["transportation", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚉",
>     "name": "station",
>     "keywords": ["transportation", "vehicle", "public"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛸",
>     "name": "flying_saucer",
>     "keywords": ["transportation", "vehicle", "ufo"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚁",
>     "name": "helicopter",
>     "keywords": ["transportation", "vehicle", "fly"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛩",
>     "name": "small_airplane",
>     "keywords": ["flight", "transportation", "fly", "vehicle"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "✈️",
>     "name": "airplane",
>     "keywords": ["vehicle", "transportation", "flight", "fly"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛫",
>     "name": "flight_departure",
>     "keywords": ["airport", "flight", "landing"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛬",
>     "name": "flight_arrival",
>     "keywords": ["airport", "flight", "boarding"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛵",
>     "name": "sailboat",
>     "keywords": ["ship", "summer", "transportation", "water", "sailing"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛥",
>     "name": "motor_boat",
>     "keywords": ["ship"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚤",
>     "name": "speedboat",
>     "keywords": ["ship", "transportation", "vehicle", "summer"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛴",
>     "name": "ferry",
>     "keywords": ["boat", "ship", "yacht"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛳",
>     "name": "passenger_ship",
>     "keywords": ["yacht", "cruise", "ferry"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚀",
>     "name": "rocket",
>     "keywords": [
>       "launch",
>       "ship",
>       "staffmode",
>       "NASA",
>       "outer space",
>       "outer_space",
>       "fly"
>     ]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛰",
>     "name": "artificial_satellite",
>     "keywords": ["communication", "gps", "orbit", "spaceflight", "NASA", "ISS"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛻",
>     "name": "pickup_truck",
>     "keywords": ["car"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛼",
>     "name": "roller_skate",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "💺",
>     "name": "seat",
>     "keywords": ["sit", "airplane", "transport", "bus", "flight", "fly"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛶",
>     "name": "canoe",
>     "keywords": ["boat", "paddle", "water", "ship"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⚓",
>     "name": "anchor",
>     "keywords": ["ship", "ferry", "sea", "boat"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚧",
>     "name": "construction",
>     "keywords": ["wip", "progress", "caution", "warning"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛽",
>     "name": "fuelpump",
>     "keywords": ["gas station", "petroleum"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚏",
>     "name": "busstop",
>     "keywords": ["transportation", "wait"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚦",
>     "name": "vertical_traffic_light",
>     "keywords": ["transportation", "driving"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚥",
>     "name": "traffic_light",
>     "keywords": ["transportation", "signal"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏁",
>     "name": "checkered_flag",
>     "keywords": ["contest", "finishline", "race", "gokart"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🚢",
>     "name": "ship",
>     "keywords": ["transportation", "titanic", "deploy"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎡",
>     "name": "ferris_wheel",
>     "keywords": ["photo", "carnival", "londoneye"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎢",
>     "name": "roller_coaster",
>     "keywords": ["carnival", "playground", "photo", "fun"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎠",
>     "name": "carousel_horse",
>     "keywords": ["photo", "carnival"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏗",
>     "name": "building_construction",
>     "keywords": ["wip", "working", "progress"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌁",
>     "name": "foggy",
>     "keywords": ["photo", "mountain"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏭",
>     "name": "factory",
>     "keywords": ["building", "industry", "pollution", "smoke"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛲",
>     "name": "fountain",
>     "keywords": ["photo", "summer", "water", "fresh"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎑",
>     "name": "rice_scene",
>     "keywords": ["photo", "japan", "asia", "tsukimi"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛰",
>     "name": "mountain",
>     "keywords": ["photo", "nature", "environment"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏔",
>     "name": "mountain_snow",
>     "keywords": ["photo", "nature", "environment", "winter", "cold"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🗻",
>     "name": "mount_fuji",
>     "keywords": ["photo", "mountain", "nature", "japanese"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌋",
>     "name": "volcano",
>     "keywords": ["photo", "nature", "disaster"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🗾",
>     "name": "japan",
>     "keywords": ["nation", "country", "japanese", "asia"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏕",
>     "name": "camping",
>     "keywords": ["photo", "outdoors", "tent"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛺",
>     "name": "tent",
>     "keywords": ["photo", "camping", "outdoors"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏞",
>     "name": "national_park",
>     "keywords": ["photo", "environment", "nature"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛣",
>     "name": "motorway",
>     "keywords": ["road", "cupertino", "interstate", "highway"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛤",
>     "name": "railway_track",
>     "keywords": ["train", "transportation"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌅",
>     "name": "sunrise",
>     "keywords": ["morning", "view", "vacation", "photo"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌄",
>     "name": "sunrise_over_mountains",
>     "keywords": ["view", "vacation", "photo"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏜",
>     "name": "desert",
>     "keywords": ["photo", "warm", "saharah"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏖",
>     "name": "beach_umbrella",
>     "keywords": ["weather", "summer", "sunny", "sand", "mojito"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏝",
>     "name": "desert_island",
>     "keywords": ["photo", "tropical", "mojito"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌇",
>     "name": "city_sunrise",
>     "keywords": ["photo", "good morning", "dawn"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌆",
>     "name": "city_sunset",
>     "keywords": ["photo", "evening", "sky", "buildings"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏙",
>     "name": "cityscape",
>     "keywords": ["photo", "night life", "urban"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌃",
>     "name": "night_with_stars",
>     "keywords": ["evening", "city", "downtown"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌉",
>     "name": "bridge_at_night",
>     "keywords": ["photo", "sanfrancisco"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌌",
>     "name": "milky_way",
>     "keywords": ["photo", "space", "stars"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌠",
>     "name": "stars",
>     "keywords": ["night", "photo"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎇",
>     "name": "sparkler",
>     "keywords": ["stars", "night", "shine"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🎆",
>     "name": "fireworks",
>     "keywords": ["photo", "festival", "carnival", "congratulations"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🌈",
>     "name": "rainbow",
>     "keywords": ["nature", "happy", "unicorn_face", "photo", "sky", "spring"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏘",
>     "name": "houses",
>     "keywords": ["buildings", "photo"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏰",
>     "name": "european_castle",
>     "keywords": ["building", "royalty", "history"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏯",
>     "name": "japanese_castle",
>     "keywords": ["photo", "building"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🗼",
>     "name": "tokyo_tower",
>     "keywords": ["photo", "japanese"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "",
>     "name": "shibuya_109",
>     "keywords": ["photo", "japanese"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏟",
>     "name": "stadium",
>     "keywords": ["photo", "place", "sports", "concert", "venue"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🗽",
>     "name": "statue_of_liberty",
>     "keywords": ["american", "newyork"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏠",
>     "name": "house",
>     "keywords": ["building", "home"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏡",
>     "name": "house_with_garden",
>     "keywords": ["home", "plant", "nature"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏚",
>     "name": "derelict_house",
>     "keywords": ["abandon", "evict", "broken", "building"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏢",
>     "name": "office",
>     "keywords": ["building", "bureau", "work"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏬",
>     "name": "department_store",
>     "keywords": ["building", "shopping", "mall"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏣",
>     "name": "post_office",
>     "keywords": ["building", "envelope", "communication"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏤",
>     "name": "european_post_office",
>     "keywords": ["building", "email"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏥",
>     "name": "hospital",
>     "keywords": ["building", "health", "surgery", "doctor"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏦",
>     "name": "bank",
>     "keywords": ["building", "money", "sales", "cash", "business", "enterprise"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏨",
>     "name": "hotel",
>     "keywords": ["building", "accomodation", "checkin"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏪",
>     "name": "convenience_store",
>     "keywords": ["building", "shopping", "groceries"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏫",
>     "name": "school",
>     "keywords": ["building", "student", "education", "learn", "teach"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏩",
>     "name": "love_hotel",
>     "keywords": ["like", "affection", "dating"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "💒",
>     "name": "wedding",
>     "keywords": [
>       "love",
>       "like",
>       "affection",
>       "couple",
>       "marriage",
>       "bride",
>       "groom"
>     ]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🏛",
>     "name": "classical_building",
>     "keywords": ["art", "culture", "history"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛪",
>     "name": "church",
>     "keywords": ["building", "religion", "christ"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🕌",
>     "name": "mosque",
>     "keywords": ["islam", "worship", "minaret"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🕍",
>     "name": "synagogue",
>     "keywords": ["judaism", "worship", "temple", "jewish"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🕋",
>     "name": "kaaba",
>     "keywords": ["mecca", "mosque", "islam"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "⛩",
>     "name": "shinto_shrine",
>     "keywords": ["temple", "japan", "kyoto"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛕",
>     "name": "hindu_temple",
>     "keywords": ["temple"]
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🪨",
>     "name": "rock",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🪵",
>     "name": "wood",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "🛖",
>     "name": "hut",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "\uD83D\uDEDD",
>     "name": "playground_slide",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "\uD83D\uDEDE",
>     "name": "wheel",
>     "keywords": []
>   },
>   {
>     "category": "travel_and_places",
>     "char": "\uD83D\uDEDF",
>     "name": "ring_buoy",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "⌚",
>     "name": "watch",
>     "keywords": ["time", "accessories"]
>   },
>   {
>     "category": "objects",
>     "char": "📱",
>     "name": "iphone",
>     "keywords": ["technology", "apple", "gadgets", "dial"]
>   },
>   {
>     "category": "objects",
>     "char": "📲",
>     "name": "calling",
>     "keywords": ["iphone", "incoming"]
>   },
>   {
>     "category": "objects",
>     "char": "💻",
>     "name": "computer",
>     "keywords": ["technology", "laptop", "screen", "display", "monitor"]
>   },
>   {
>     "category": "objects",
>     "char": "⌨",
>     "name": "keyboard",
>     "keywords": ["technology", "computer", "type", "input", "text"]
>   },
>   {
>     "category": "objects",
>     "char": "🖥",
>     "name": "desktop_computer",
>     "keywords": ["technology", "computing", "screen"]
>   },
>   {
>     "category": "objects",
>     "char": "🖨",
>     "name": "printer",
>     "keywords": ["paper", "ink"]
>   },
>   {
>     "category": "objects",
>     "char": "🖱",
>     "name": "computer_mouse",
>     "keywords": ["click"]
>   },
>   {
>     "category": "objects",
>     "char": "🖲",
>     "name": "trackball",
>     "keywords": ["technology", "trackpad"]
>   },
>   {
>     "category": "objects",
>     "char": "🕹",
>     "name": "joystick",
>     "keywords": ["game", "play"]
>   },
>   { "category": "objects", "char": "🗜", "name": "clamp", "keywords": ["tool"] },
>   {
>     "category": "objects",
>     "char": "💽",
>     "name": "minidisc",
>     "keywords": ["technology", "record", "data", "disk", "90s"]
>   },
>   {
>     "category": "objects",
>     "char": "💾",
>     "name": "floppy_disk",
>     "keywords": ["oldschool", "technology", "save", "90s", "80s"]
>   },
>   {
>     "category": "objects",
>     "char": "💿",
>     "name": "cd",
>     "keywords": ["technology", "dvd", "disk", "disc", "90s"]
>   },
>   {
>     "category": "objects",
>     "char": "📀",
>     "name": "dvd",
>     "keywords": ["cd", "disk", "disc"]
>   },
>   {
>     "category": "objects",
>     "char": "📼",
>     "name": "vhs",
>     "keywords": ["record", "video", "oldschool", "90s", "80s"]
>   },
>   {
>     "category": "objects",
>     "char": "📷",
>     "name": "camera",
>     "keywords": ["gadgets", "photography"]
>   },
>   {
>     "category": "objects",
>     "char": "📸",
>     "name": "camera_flash",
>     "keywords": ["photography", "gadgets"]
>   },
>   {
>     "category": "objects",
>     "char": "📹",
>     "name": "video_camera",
>     "keywords": ["film", "record"]
>   },
>   {
>     "category": "objects",
>     "char": "🎥",
>     "name": "movie_camera",
>     "keywords": ["film", "record"]
>   },
>   {
>     "category": "objects",
>     "char": "📽",
>     "name": "film_projector",
>     "keywords": ["video", "tape", "record", "movie"]
>   },
>   {
>     "category": "objects",
>     "char": "🎞",
>     "name": "film_strip",
>     "keywords": ["movie"]
>   },
>   {
>     "category": "objects",
>     "char": "📞",
>     "name": "telephone_receiver",
>     "keywords": ["technology", "communication", "dial"]
>   },
>   {
>     "category": "objects",
>     "char": "☎️",
>     "name": "phone",
>     "keywords": ["technology", "communication", "dial", "telephone"]
>   },
>   {
>     "category": "objects",
>     "char": "📟",
>     "name": "pager",
>     "keywords": ["bbcall", "oldschool", "90s"]
>   },
>   {
>     "category": "objects",
>     "char": "📠",
>     "name": "fax",
>     "keywords": ["communication", "technology"]
>   },
>   {
>     "category": "objects",
>     "char": "📺",
>     "name": "tv",
>     "keywords": ["technology", "program", "oldschool", "show", "television"]
>   },
>   {
>     "category": "objects",
>     "char": "📻",
>     "name": "radio",
>     "keywords": ["communication", "music", "podcast", "program"]
>   },
>   {
>     "category": "objects",
>     "char": "🎙",
>     "name": "studio_microphone",
>     "keywords": ["sing", "recording", "artist", "talkshow"]
>   },
>   {
>     "category": "objects",
>     "char": "🎚",
>     "name": "level_slider",
>     "keywords": ["scale"]
>   },
>   {
>     "category": "objects",
>     "char": "🎛",
>     "name": "control_knobs",
>     "keywords": ["dial"]
>   },
>   {
>     "category": "objects",
>     "char": "🧭",
>     "name": "compass",
>     "keywords": ["magnetic", "navigation", "orienteering"]
>   },
>   {
>     "category": "objects",
>     "char": "⏱",
>     "name": "stopwatch",
>     "keywords": ["time", "deadline"]
>   },
>   {
>     "category": "objects",
>     "char": "⏲",
>     "name": "timer_clock",
>     "keywords": ["alarm"]
>   },
>   {
>     "category": "objects",
>     "char": "⏰",
>     "name": "alarm_clock",
>     "keywords": ["time", "wake"]
>   },
>   {
>     "category": "objects",
>     "char": "🕰",
>     "name": "mantelpiece_clock",
>     "keywords": ["time"]
>   },
>   {
>     "category": "objects",
>     "char": "⏳",
>     "name": "hourglass_flowing_sand",
>     "keywords": ["oldschool", "time", "countdown"]
>   },
>   {
>     "category": "objects",
>     "char": "⌛",
>     "name": "hourglass",
>     "keywords": ["time", "clock", "oldschool", "limit", "exam", "quiz", "test"]
>   },
>   {
>     "category": "objects",
>     "char": "📡",
>     "name": "satellite",
>     "keywords": ["communication", "future", "radio", "space"]
>   },
>   {
>     "category": "objects",
>     "char": "🔋",
>     "name": "battery",
>     "keywords": ["power", "energy", "sustain"]
>   },
>   {
>     "category": "objects",
>     "char": "\uD83E\uDEAB",
>     "name": "battery",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "🔌",
>     "name": "electric_plug",
>     "keywords": ["charger", "power"]
>   },
>   {
>     "category": "objects",
>     "char": "💡",
>     "name": "bulb",
>     "keywords": ["light", "electricity", "idea"]
>   },
>   {
>     "category": "objects",
>     "char": "🔦",
>     "name": "flashlight",
>     "keywords": ["dark", "camping", "sight", "night"]
>   },
>   {
>     "category": "objects",
>     "char": "🕯",
>     "name": "candle",
>     "keywords": ["fire", "wax"]
>   },
>   {
>     "category": "objects",
>     "char": "🧯",
>     "name": "fire_extinguisher",
>     "keywords": ["quench"]
>   },
>   {
>     "category": "objects",
>     "char": "🗑",
>     "name": "wastebasket",
>     "keywords": ["bin", "trash", "rubbish", "garbage", "toss"]
>   },
>   {
>     "category": "objects",
>     "char": "🛢",
>     "name": "oil_drum",
>     "keywords": ["barrell"]
>   },
>   {
>     "category": "objects",
>     "char": "💸",
>     "name": "money_with_wings",
>     "keywords": ["dollar", "bills", "payment", "sale"]
>   },
>   {
>     "category": "objects",
>     "char": "💵",
>     "name": "dollar",
>     "keywords": ["money", "sales", "bill", "currency"]
>   },
>   {
>     "category": "objects",
>     "char": "💴",
>     "name": "yen",
>     "keywords": ["money", "sales", "japanese", "dollar", "currency"]
>   },
>   {
>     "category": "objects",
>     "char": "💶",
>     "name": "euro",
>     "keywords": ["money", "sales", "dollar", "currency"]
>   },
>   {
>     "category": "objects",
>     "char": "💷",
>     "name": "pound",
>     "keywords": [
>       "british",
>       "sterling",
>       "money",
>       "sales",
>       "bills",
>       "uk",
>       "england",
>       "currency"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "💰",
>     "name": "moneybag",
>     "keywords": ["dollar", "payment", "coins", "sale"]
>   },
>   {
>     "category": "objects",
>     "char": "🪙",
>     "name": "coin",
>     "keywords": ["dollar", "payment", "coins", "sale"]
>   },
>   {
>     "category": "objects",
>     "char": "💳",
>     "name": "credit_card",
>     "keywords": ["money", "sales", "dollar", "bill", "payment", "shopping"]
>   },
>   {
>     "category": "objects",
>     "char": "\uD83E\uDEAB",
>     "name": "identification_card",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "💎",
>     "name": "gem",
>     "keywords": ["blue", "ruby", "diamond", "jewelry"]
>   },
>   {
>     "category": "objects",
>     "char": "⚖",
>     "name": "balance_scale",
>     "keywords": ["law", "fairness", "weight"]
>   },
>   {
>     "category": "objects",
>     "char": "🧰",
>     "name": "toolbox",
>     "keywords": ["tools", "diy", "fix", "maintainer", "mechanic"]
>   },
>   {
>     "category": "objects",
>     "char": "🔧",
>     "name": "wrench",
>     "keywords": ["tools", "diy", "ikea", "fix", "maintainer"]
>   },
>   {
>     "category": "objects",
>     "char": "🔨",
>     "name": "hammer",
>     "keywords": ["tools", "build", "create"]
>   },
>   {
>     "category": "objects",
>     "char": "⚒",
>     "name": "hammer_and_pick",
>     "keywords": ["tools", "build", "create"]
>   },
>   {
>     "category": "objects",
>     "char": "🛠",
>     "name": "hammer_and_wrench",
>     "keywords": ["tools", "build", "create"]
>   },
>   {
>     "category": "objects",
>     "char": "⛏",
>     "name": "pick",
>     "keywords": ["tools", "dig"]
>   },
>   { "category": "objects", "char": "🪓", "name": "axe", "keywords": ["tools"] },
>   {
>     "category": "objects",
>     "char": "🦯",
>     "name": "probing_cane",
>     "keywords": ["tools"]
>   },
>   {
>     "category": "objects",
>     "char": "🔩",
>     "name": "nut_and_bolt",
>     "keywords": ["handy", "tools", "fix"]
>   },
>   { "category": "objects", "char": "⚙", "name": "gear", "keywords": ["cog"] },
>   {
>     "category": "objects",
>     "char": "🪃",
>     "name": "boomerang",
>     "keywords": ["tool"]
>   },
>   {
>     "category": "objects",
>     "char": "🪚",
>     "name": "carpentry_saw",
>     "keywords": ["tool"]
>   },
>   {
>     "category": "objects",
>     "char": "🪛",
>     "name": "screwdriver",
>     "keywords": ["tool"]
>   },
>   { "category": "objects", "char": "🪝", "name": "hook", "keywords": ["tool"] },
>   {
>     "category": "objects",
>     "char": "🪜",
>     "name": "ladder",
>     "keywords": ["tool"]
>   },
>   {
>     "category": "objects",
>     "char": "🧱",
>     "name": "brick",
>     "keywords": ["bricks"]
>   },
>   {
>     "category": "objects",
>     "char": "⛓",
>     "name": "chains",
>     "keywords": ["lock", "arrest"]
>   },
>   {
>     "category": "objects",
>     "char": "🧲",
>     "name": "magnet",
>     "keywords": ["attraction", "magnetic"]
>   },
>   {
>     "category": "objects",
>     "char": "🔫",
>     "name": "gun",
>     "keywords": ["violence", "weapon", "pistol", "revolver"]
>   },
>   {
>     "category": "objects",
>     "char": "💣",
>     "name": "bomb",
>     "keywords": ["boom", "explode", "explosion", "terrorism"]
>   },
>   {
>     "category": "objects",
>     "char": "🧨",
>     "name": "firecracker",
>     "keywords": ["dynamite", "boom", "explode", "explosion", "explosive"]
>   },
>   {
>     "category": "objects",
>     "char": "🔪",
>     "name": "hocho",
>     "keywords": ["knife", "blade", "cutlery", "kitchen", "weapon"]
>   },
>   {
>     "category": "objects",
>     "char": "🗡",
>     "name": "dagger",
>     "keywords": ["weapon"]
>   },
>   {
>     "category": "objects",
>     "char": "⚔",
>     "name": "crossed_swords",
>     "keywords": ["weapon"]
>   },
>   {
>     "category": "objects",
>     "char": "🛡",
>     "name": "shield",
>     "keywords": ["protection", "security"]
>   },
>   {
>     "category": "objects",
>     "char": "🚬",
>     "name": "smoking",
>     "keywords": ["kills", "tobacco", "cigarette", "joint", "smoke"]
>   },
>   {
>     "category": "objects",
>     "char": "☠",
>     "name": "skull_and_crossbones",
>     "keywords": [
>       "poison",
>       "danger",
>       "deadly",
>       "scary",
>       "death",
>       "pirate",
>       "evil"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "⚰",
>     "name": "coffin",
>     "keywords": [
>       "vampire",
>       "dead",
>       "die",
>       "death",
>       "rip",
>       "graveyard",
>       "cemetery",
>       "casket",
>       "funeral",
>       "box"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "⚱",
>     "name": "funeral_urn",
>     "keywords": ["dead", "die", "death", "rip", "ashes"]
>   },
>   {
>     "category": "objects",
>     "char": "🏺",
>     "name": "amphora",
>     "keywords": ["vase", "jar"]
>   },
>   {
>     "category": "objects",
>     "char": "🔮",
>     "name": "crystal_ball",
>     "keywords": ["disco", "party", "magic", "circus", "fortune_teller"]
>   },
>   {
>     "category": "objects",
>     "char": "📿",
>     "name": "prayer_beads",
>     "keywords": ["dhikr", "religious"]
>   },
>   {
>     "category": "objects",
>     "char": "🧿",
>     "name": "nazar_amulet",
>     "keywords": ["bead", "charm"]
>   },
>   {
>     "category": "objects",
>     "char": "💈",
>     "name": "barber",
>     "keywords": ["hair", "salon", "style"]
>   },
>   {
>     "category": "objects",
>     "char": "⚗",
>     "name": "alembic",
>     "keywords": ["distilling", "science", "experiment", "chemistry"]
>   },
>   {
>     "category": "objects",
>     "char": "🔭",
>     "name": "telescope",
>     "keywords": ["stars", "space", "zoom", "science", "astronomy"]
>   },
>   {
>     "category": "objects",
>     "char": "🔬",
>     "name": "microscope",
>     "keywords": ["laboratory", "experiment", "zoomin", "science", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "🕳",
>     "name": "hole",
>     "keywords": ["embarrassing"]
>   },
>   {
>     "category": "objects",
>     "char": "💊",
>     "name": "pill",
>     "keywords": ["health", "medicine", "doctor", "pharmacy", "drug"]
>   },
>   {
>     "category": "objects",
>     "char": "💉",
>     "name": "syringe",
>     "keywords": [
>       "health",
>       "hospital",
>       "drugs",
>       "blood",
>       "medicine",
>       "needle",
>       "doctor",
>       "nurse"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "🩸",
>     "name": "drop_of_blood",
>     "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"]
>   },
>   {
>     "category": "objects",
>     "char": "🩹",
>     "name": "adhesive_bandage",
>     "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"]
>   },
>   {
>     "category": "objects",
>     "char": "🩺",
>     "name": "stethoscope",
>     "keywords": ["health", "hospital", "medicine", "needle", "doctor", "nurse"]
>   },
>   {
>     "category": "objects",
>     "char": "🪒",
>     "name": "razor",
>     "keywords": ["health"]
>   },
>   {
>     "category": "objects",
>     "char": "\uD83E\uDE7B",
>     "name": "xray",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "\uD83E\uDE7C",
>     "name": "crutch",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "🧬",
>     "name": "dna",
>     "keywords": ["biologist", "genetics", "life"]
>   },
>   {
>     "category": "objects",
>     "char": "🧫",
>     "name": "petri_dish",
>     "keywords": ["bacteria", "biology", "culture", "lab"]
>   },
>   {
>     "category": "objects",
>     "char": "🧪",
>     "name": "test_tube",
>     "keywords": ["chemistry", "experiment", "lab", "science"]
>   },
>   {
>     "category": "objects",
>     "char": "🌡",
>     "name": "thermometer",
>     "keywords": ["weather", "temperature", "hot", "cold"]
>   },
>   {
>     "category": "objects",
>     "char": "🧹",
>     "name": "broom",
>     "keywords": ["cleaning", "sweeping", "witch"]
>   },
>   {
>     "category": "objects",
>     "char": "🧺",
>     "name": "basket",
>     "keywords": ["laundry"]
>   },
>   {
>     "category": "objects",
>     "char": "🧻",
>     "name": "toilet_paper",
>     "keywords": ["roll"]
>   },
>   {
>     "category": "objects",
>     "char": "🏷",
>     "name": "label",
>     "keywords": ["sale", "tag"]
>   },
>   {
>     "category": "objects",
>     "char": "🔖",
>     "name": "bookmark",
>     "keywords": ["favorite", "label", "save"]
>   },
>   {
>     "category": "objects",
>     "char": "🚽",
>     "name": "toilet",
>     "keywords": ["restroom", "wc", "washroom", "bathroom", "potty"]
>   },
>   {
>     "category": "objects",
>     "char": "🚿",
>     "name": "shower",
>     "keywords": ["clean", "water", "bathroom"]
>   },
>   {
>     "category": "objects",
>     "char": "🛁",
>     "name": "bathtub",
>     "keywords": ["clean", "shower", "bathroom"]
>   },
>   {
>     "category": "objects",
>     "char": "🧼",
>     "name": "soap",
>     "keywords": ["bar", "bathing", "cleaning", "lather"]
>   },
>   {
>     "category": "objects",
>     "char": "🧽",
>     "name": "sponge",
>     "keywords": ["absorbing", "cleaning", "porous"]
>   },
>   {
>     "category": "objects",
>     "char": "🧴",
>     "name": "lotion_bottle",
>     "keywords": ["moisturizer", "sunscreen"]
>   },
>   {
>     "category": "objects",
>     "char": "🔑",
>     "name": "key",
>     "keywords": ["lock", "door", "password"]
>   },
>   {
>     "category": "objects",
>     "char": "🗝",
>     "name": "old_key",
>     "keywords": ["lock", "door", "password"]
>   },
>   {
>     "category": "objects",
>     "char": "🛋",
>     "name": "couch_and_lamp",
>     "keywords": ["read", "chill"]
>   },
>   {
>     "category": "objects",
>     "char": "🪔",
>     "name": "diya_Lamp",
>     "keywords": ["light", "oil"]
>   },
>   {
>     "category": "objects",
>     "char": "🛌",
>     "name": "sleeping_bed",
>     "keywords": ["bed", "rest"]
>   },
>   {
>     "category": "objects",
>     "char": "🛏",
>     "name": "bed",
>     "keywords": ["sleep", "rest"]
>   },
>   {
>     "category": "objects",
>     "char": "🚪",
>     "name": "door",
>     "keywords": ["house", "entry", "exit"]
>   },
>   {
>     "category": "objects",
>     "char": "🪑",
>     "name": "chair",
>     "keywords": ["house", "desk"]
>   },
>   {
>     "category": "objects",
>     "char": "🛎",
>     "name": "bellhop_bell",
>     "keywords": ["service"]
>   },
>   {
>     "category": "objects",
>     "char": "🧸",
>     "name": "teddy_bear",
>     "keywords": ["plush", "stuffed"]
>   },
>   {
>     "category": "objects",
>     "char": "🖼",
>     "name": "framed_picture",
>     "keywords": ["photography"]
>   },
>   {
>     "category": "objects",
>     "char": "🗺",
>     "name": "world_map",
>     "keywords": ["location", "direction"]
>   },
>   {
>     "category": "objects",
>     "char": "🛗",
>     "name": "elevator",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪞",
>     "name": "mirror",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪟",
>     "name": "window",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪠",
>     "name": "plunger",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪤",
>     "name": "mouse_trap",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪣",
>     "name": "bucket",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "🪥",
>     "name": "toothbrush",
>     "keywords": ["household"]
>   },
>   {
>     "category": "objects",
>     "char": "\uD83E\uDEE7",
>     "name": "bubbles",
>     "keywords": []
>   },
>   {
>     "category": "objects",
>     "char": "⛱",
>     "name": "parasol_on_ground",
>     "keywords": ["weather", "summer"]
>   },
>   {
>     "category": "objects",
>     "char": "🗿",
>     "name": "moyai",
>     "keywords": ["rock", "easter island", "moai"]
>   },
>   {
>     "category": "objects",
>     "char": "🛍",
>     "name": "shopping",
>     "keywords": ["mall", "buy", "purchase"]
>   },
>   {
>     "category": "objects",
>     "char": "🛒",
>     "name": "shopping_cart",
>     "keywords": ["trolley"]
>   },
>   {
>     "category": "objects",
>     "char": "🎈",
>     "name": "balloon",
>     "keywords": ["party", "celebration", "birthday", "circus"]
>   },
>   {
>     "category": "objects",
>     "char": "🎏",
>     "name": "flags",
>     "keywords": ["fish", "japanese", "koinobori", "carp", "banner"]
>   },
>   {
>     "category": "objects",
>     "char": "🎀",
>     "name": "ribbon",
>     "keywords": ["decoration", "pink", "girl", "bowtie"]
>   },
>   {
>     "category": "objects",
>     "char": "🎁",
>     "name": "gift",
>     "keywords": ["present", "birthday", "christmas", "xmas"]
>   },
>   {
>     "category": "objects",
>     "char": "🎊",
>     "name": "confetti_ball",
>     "keywords": ["festival", "party", "birthday", "circus"]
>   },
>   {
>     "category": "objects",
>     "char": "🎉",
>     "name": "tada",
>     "keywords": [
>       "party",
>       "congratulations",
>       "birthday",
>       "magic",
>       "circus",
>       "celebration"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "🎎",
>     "name": "dolls",
>     "keywords": ["japanese", "toy", "kimono"]
>   },
>   {
>     "category": "objects",
>     "char": "🎐",
>     "name": "wind_chime",
>     "keywords": ["nature", "ding", "spring", "bell"]
>   },
>   {
>     "category": "objects",
>     "char": "🎌",
>     "name": "crossed_flags",
>     "keywords": ["japanese", "nation", "country", "border"]
>   },
>   {
>     "category": "objects",
>     "char": "🏮",
>     "name": "izakaya_lantern",
>     "keywords": ["light", "paper", "halloween", "spooky"]
>   },
>   {
>     "category": "objects",
>     "char": "🧧",
>     "name": "red_envelope",
>     "keywords": ["gift"]
>   },
>   {
>     "category": "objects",
>     "char": "✉️",
>     "name": "email",
>     "keywords": ["letter", "postal", "inbox", "communication"]
>   },
>   {
>     "category": "objects",
>     "char": "📩",
>     "name": "envelope_with_arrow",
>     "keywords": ["email", "communication"]
>   },
>   {
>     "category": "objects",
>     "char": "📨",
>     "name": "incoming_envelope",
>     "keywords": ["email", "inbox"]
>   },
>   {
>     "category": "objects",
>     "char": "📧",
>     "name": "e-mail",
>     "keywords": ["communication", "inbox"]
>   },
>   {
>     "category": "objects",
>     "char": "💌",
>     "name": "love_letter",
>     "keywords": ["email", "like", "affection", "envelope", "valentines"]
>   },
>   {
>     "category": "objects",
>     "char": "📮",
>     "name": "postbox",
>     "keywords": ["email", "letter", "envelope"]
>   },
>   {
>     "category": "objects",
>     "char": "📪",
>     "name": "mailbox_closed",
>     "keywords": ["email", "communication", "inbox"]
>   },
>   {
>     "category": "objects",
>     "char": "📫",
>     "name": "mailbox",
>     "keywords": ["email", "inbox", "communication"]
>   },
>   {
>     "category": "objects",
>     "char": "📬",
>     "name": "mailbox_with_mail",
>     "keywords": ["email", "inbox", "communication"]
>   },
>   {
>     "category": "objects",
>     "char": "📭",
>     "name": "mailbox_with_no_mail",
>     "keywords": ["email", "inbox"]
>   },
>   {
>     "category": "objects",
>     "char": "📦",
>     "name": "package",
>     "keywords": ["mail", "gift", "cardboard", "box", "moving"]
>   },
>   {
>     "category": "objects",
>     "char": "📯",
>     "name": "postal_horn",
>     "keywords": ["instrument", "music"]
>   },
>   {
>     "category": "objects",
>     "char": "📥",
>     "name": "inbox_tray",
>     "keywords": ["email", "documents"]
>   },
>   {
>     "category": "objects",
>     "char": "📤",
>     "name": "outbox_tray",
>     "keywords": ["inbox", "email"]
>   },
>   {
>     "category": "objects",
>     "char": "📜",
>     "name": "scroll",
>     "keywords": ["documents", "ancient", "history", "paper"]
>   },
>   {
>     "category": "objects",
>     "char": "📃",
>     "name": "page_with_curl",
>     "keywords": ["documents", "office", "paper"]
>   },
>   {
>     "category": "objects",
>     "char": "📑",
>     "name": "bookmark_tabs",
>     "keywords": ["favorite", "save", "order", "tidy"]
>   },
>   {
>     "category": "objects",
>     "char": "🧾",
>     "name": "receipt",
>     "keywords": ["accounting", "expenses"]
>   },
>   {
>     "category": "objects",
>     "char": "📊",
>     "name": "bar_chart",
>     "keywords": ["graph", "presentation", "stats"]
>   },
>   {
>     "category": "objects",
>     "char": "📈",
>     "name": "chart_with_upwards_trend",
>     "keywords": [
>       "graph",
>       "presentation",
>       "stats",
>       "recovery",
>       "business",
>       "economics",
>       "money",
>       "sales",
>       "good",
>       "success"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "📉",
>     "name": "chart_with_downwards_trend",
>     "keywords": [
>       "graph",
>       "presentation",
>       "stats",
>       "recession",
>       "business",
>       "economics",
>       "money",
>       "sales",
>       "bad",
>       "failure"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "📄",
>     "name": "page_facing_up",
>     "keywords": ["documents", "office", "paper", "information"]
>   },
>   {
>     "category": "objects",
>     "char": "📅",
>     "name": "date",
>     "keywords": ["calendar", "schedule"]
>   },
>   {
>     "category": "objects",
>     "char": "📆",
>     "name": "calendar",
>     "keywords": ["schedule", "date", "planning"]
>   },
>   {
>     "category": "objects",
>     "char": "🗓",
>     "name": "spiral_calendar",
>     "keywords": ["date", "schedule", "planning"]
>   },
>   {
>     "category": "objects",
>     "char": "📇",
>     "name": "card_index",
>     "keywords": ["business", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "🗃",
>     "name": "card_file_box",
>     "keywords": ["business", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "🗳",
>     "name": "ballot_box",
>     "keywords": ["election", "vote"]
>   },
>   {
>     "category": "objects",
>     "char": "🗄",
>     "name": "file_cabinet",
>     "keywords": ["filing", "organizing"]
>   },
>   {
>     "category": "objects",
>     "char": "📋",
>     "name": "clipboard",
>     "keywords": ["stationery", "documents"]
>   },
>   {
>     "category": "objects",
>     "char": "🗒",
>     "name": "spiral_notepad",
>     "keywords": ["memo", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "📁",
>     "name": "file_folder",
>     "keywords": ["documents", "business", "office"]
>   },
>   {
>     "category": "objects",
>     "char": "📂",
>     "name": "open_file_folder",
>     "keywords": ["documents", "load"]
>   },
>   {
>     "category": "objects",
>     "char": "🗂",
>     "name": "card_index_dividers",
>     "keywords": ["organizing", "business", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "🗞",
>     "name": "newspaper_roll",
>     "keywords": ["press", "headline"]
>   },
>   {
>     "category": "objects",
>     "char": "📰",
>     "name": "newspaper",
>     "keywords": ["press", "headline"]
>   },
>   {
>     "category": "objects",
>     "char": "📓",
>     "name": "notebook",
>     "keywords": ["stationery", "record", "notes", "paper", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📕",
>     "name": "closed_book",
>     "keywords": ["read", "library", "knowledge", "textbook", "learn"]
>   },
>   {
>     "category": "objects",
>     "char": "📗",
>     "name": "green_book",
>     "keywords": ["read", "library", "knowledge", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📘",
>     "name": "blue_book",
>     "keywords": ["read", "library", "knowledge", "learn", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📙",
>     "name": "orange_book",
>     "keywords": ["read", "library", "knowledge", "textbook", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📔",
>     "name": "notebook_with_decorative_cover",
>     "keywords": ["classroom", "notes", "record", "paper", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📒",
>     "name": "ledger",
>     "keywords": ["notes", "paper"]
>   },
>   {
>     "category": "objects",
>     "char": "📚",
>     "name": "books",
>     "keywords": ["literature", "library", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "📖",
>     "name": "open_book",
>     "keywords": [
>       "book",
>       "read",
>       "library",
>       "knowledge",
>       "literature",
>       "learn",
>       "study"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "🧷",
>     "name": "safety_pin",
>     "keywords": ["diaper"]
>   },
>   {
>     "category": "objects",
>     "char": "🔗",
>     "name": "link",
>     "keywords": ["rings", "url"]
>   },
>   {
>     "category": "objects",
>     "char": "📎",
>     "name": "paperclip",
>     "keywords": ["documents", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "🖇",
>     "name": "paperclips",
>     "keywords": ["documents", "stationery"]
>   },
>   {
>     "category": "objects",
>     "char": "✂️",
>     "name": "scissors",
>     "keywords": ["stationery", "cut"]
>   },
>   {
>     "category": "objects",
>     "char": "📐",
>     "name": "triangular_ruler",
>     "keywords": ["stationery", "math", "architect", "sketch"]
>   },
>   {
>     "category": "objects",
>     "char": "📏",
>     "name": "straight_ruler",
>     "keywords": [
>       "stationery",
>       "calculate",
>       "length",
>       "math",
>       "school",
>       "drawing",
>       "architect",
>       "sketch"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "🧮",
>     "name": "abacus",
>     "keywords": ["calculation"]
>   },
>   {
>     "category": "objects",
>     "char": "📌",
>     "name": "pushpin",
>     "keywords": ["stationery", "mark", "here"]
>   },
>   {
>     "category": "objects",
>     "char": "📍",
>     "name": "round_pushpin",
>     "keywords": ["stationery", "location", "map", "here"]
>   },
>   {
>     "category": "objects",
>     "char": "🚩",
>     "name": "triangular_flag_on_post",
>     "keywords": ["mark", "milestone", "place"]
>   },
>   {
>     "category": "objects",
>     "char": "🏳",
>     "name": "white_flag",
>     "keywords": ["losing", "loser", "lost", "surrender", "give up", "fail"]
>   },
>   {
>     "category": "objects",
>     "char": "🏴",
>     "name": "black_flag",
>     "keywords": ["pirate"]
>   },
>   {
>     "category": "objects",
>     "char": "🏳️‍🌈",
>     "name": "rainbow_flag",
>     "keywords": [
>       "flag",
>       "rainbow",
>       "pride",
>       "gay",
>       "lgbt",
>       "glbt",
>       "queer",
>       "homosexual",
>       "lesbian",
>       "bisexual",
>       "transgender"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "🏳️‍⚧️",
>     "name": "transgender_flag",
>     "keywords": ["flag", "transgender"]
>   },
>   {
>     "category": "objects",
>     "char": "🔐",
>     "name": "closed_lock_with_key",
>     "keywords": ["security", "privacy"]
>   },
>   {
>     "category": "objects",
>     "char": "🔒",
>     "name": "lock",
>     "keywords": ["security", "password", "padlock"]
>   },
>   {
>     "category": "objects",
>     "char": "🔓",
>     "name": "unlock",
>     "keywords": ["privacy", "security"]
>   },
>   {
>     "category": "objects",
>     "char": "🔏",
>     "name": "lock_with_ink_pen",
>     "keywords": ["security", "secret"]
>   },
>   {
>     "category": "objects",
>     "char": "🖊",
>     "name": "pen",
>     "keywords": ["stationery", "writing", "write"]
>   },
>   {
>     "category": "objects",
>     "char": "🖋",
>     "name": "fountain_pen",
>     "keywords": ["stationery", "writing", "write"]
>   },
>   {
>     "category": "objects",
>     "char": "✒️",
>     "name": "black_nib",
>     "keywords": ["pen", "stationery", "writing", "write"]
>   },
>   {
>     "category": "objects",
>     "char": "📝",
>     "name": "memo",
>     "keywords": [
>       "write",
>       "documents",
>       "stationery",
>       "pencil",
>       "paper",
>       "writing",
>       "legal",
>       "exam",
>       "quiz",
>       "test",
>       "study",
>       "compose"
>     ]
>   },
>   {
>     "category": "objects",
>     "char": "✏️",
>     "name": "pencil2",
>     "keywords": ["stationery", "write", "paper", "writing", "school", "study"]
>   },
>   {
>     "category": "objects",
>     "char": "🖍",
>     "name": "crayon",
>     "keywords": ["drawing", "creativity"]
>   },
>   {
>     "category": "objects",
>     "char": "🖌",
>     "name": "paintbrush",
>     "keywords": ["drawing", "creativity", "art"]
>   },
>   {
>     "category": "objects",
>     "char": "🔍",
>     "name": "mag",
>     "keywords": ["search", "zoom", "find", "detective"]
>   },
>   {
>     "category": "objects",
>     "char": "🔎",
>     "name": "mag_right",
>     "keywords": ["search", "zoom", "find", "detective"]
>   },
>   { "category": "objects", "char": "🪦", "name": "headstone", "keywords": [] },
>   { "category": "objects", "char": "🪧", "name": "placard", "keywords": [] },
>   {
>     "category": "symbols",
>     "char": "💯",
>     "name": "100",
>     "keywords": [
>       "score",
>       "perfect",
>       "numbers",
>       "century",
>       "exam",
>       "quiz",
>       "test",
>       "pass",
>       "hundred"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🔢",
>     "name": "1234",
>     "keywords": ["numbers", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "❤️",
>     "name": "heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "🧡",
>     "name": "orange_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💛",
>     "name": "yellow_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💚",
>     "name": "green_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💙",
>     "name": "blue_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💜",
>     "name": "purple_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "🤎",
>     "name": "brown_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "🖤",
>     "name": "black_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "🤍",
>     "name": "white_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💔",
>     "name": "broken_heart",
>     "keywords": ["sad", "sorry", "break", "heart", "heartbreak"]
>   },
>   {
>     "category": "symbols",
>     "char": "❣",
>     "name": "heavy_heart_exclamation",
>     "keywords": ["decoration", "love"]
>   },
>   {
>     "category": "symbols",
>     "char": "💕",
>     "name": "two_hearts",
>     "keywords": ["love", "like", "affection", "valentines", "heart"]
>   },
>   {
>     "category": "symbols",
>     "char": "💞",
>     "name": "revolving_hearts",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💓",
>     "name": "heartbeat",
>     "keywords": ["love", "like", "affection", "valentines", "pink", "heart"]
>   },
>   {
>     "category": "symbols",
>     "char": "💗",
>     "name": "heartpulse",
>     "keywords": ["like", "love", "affection", "valentines", "pink"]
>   },
>   {
>     "category": "symbols",
>     "char": "💖",
>     "name": "sparkling_heart",
>     "keywords": ["love", "like", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💘",
>     "name": "cupid",
>     "keywords": ["love", "like", "heart", "affection", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💝",
>     "name": "gift_heart",
>     "keywords": ["love", "valentines"]
>   },
>   {
>     "category": "symbols",
>     "char": "💟",
>     "name": "heart_decoration",
>     "keywords": ["purple-square", "love", "like"]
>   },
>   {
>     "category": "symbols",
>     "char": "\u2764\uFE0F\u200D\uD83D\uDD25",
>     "name": "heart_on_fire",
>     "keywords": []
>   },
>   {
>     "category": "symbols",
>     "char": "\u2764\uFE0F\u200D\uD83E\uDE79",
>     "name": "mending_heart",
>     "keywords": []
>   },
>   {
>     "category": "symbols",
>     "char": "☮",
>     "name": "peace_symbol",
>     "keywords": ["hippie"]
>   },
>   {
>     "category": "symbols",
>     "char": "✝",
>     "name": "latin_cross",
>     "keywords": ["christianity"]
>   },
>   {
>     "category": "symbols",
>     "char": "☪",
>     "name": "star_and_crescent",
>     "keywords": ["islam"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕉",
>     "name": "om",
>     "keywords": ["hinduism", "buddhism", "sikhism", "jainism"]
>   },
>   {
>     "category": "symbols",
>     "char": "☸",
>     "name": "wheel_of_dharma",
>     "keywords": ["hinduism", "buddhism", "sikhism", "jainism"]
>   },
>   {
>     "category": "symbols",
>     "char": "✡",
>     "name": "star_of_david",
>     "keywords": ["judaism"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔯",
>     "name": "six_pointed_star",
>     "keywords": ["purple-square", "religion", "jewish", "hexagram"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕎",
>     "name": "menorah",
>     "keywords": ["hanukkah", "candles", "jewish"]
>   },
>   {
>     "category": "symbols",
>     "char": "☯",
>     "name": "yin_yang",
>     "keywords": ["balance"]
>   },
>   {
>     "category": "symbols",
>     "char": "☦",
>     "name": "orthodox_cross",
>     "keywords": ["suppedaneum", "religion"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛐",
>     "name": "place_of_worship",
>     "keywords": ["religion", "church", "temple", "prayer"]
>   },
>   {
>     "category": "symbols",
>     "char": "⛎",
>     "name": "ophiuchus",
>     "keywords": ["sign", "purple-square", "constellation", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♈",
>     "name": "aries",
>     "keywords": ["sign", "purple-square", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♉",
>     "name": "taurus",
>     "keywords": ["purple-square", "sign", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♊",
>     "name": "gemini",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♋",
>     "name": "cancer",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♌",
>     "name": "leo",
>     "keywords": ["sign", "purple-square", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♍",
>     "name": "virgo",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♎",
>     "name": "libra",
>     "keywords": ["sign", "purple-square", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♏",
>     "name": "scorpius",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology", "scorpio"]
>   },
>   {
>     "category": "symbols",
>     "char": "♐",
>     "name": "sagittarius",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♑",
>     "name": "capricorn",
>     "keywords": ["sign", "zodiac", "purple-square", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♒",
>     "name": "aquarius",
>     "keywords": ["sign", "purple-square", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "♓",
>     "name": "pisces",
>     "keywords": ["purple-square", "sign", "zodiac", "astrology"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆔",
>     "name": "id",
>     "keywords": ["purple-square", "words"]
>   },
>   {
>     "category": "symbols",
>     "char": "⚛",
>     "name": "atom_symbol",
>     "keywords": ["science", "physics", "chemistry"]
>   },
>   {
>     "category": "symbols",
>     "char": "⚧️",
>     "name": "transgender_symbol",
>     "keywords": [
>       "purple-square",
>       "woman",
>       "female",
>       "toilet",
>       "loo",
>       "restroom",
>       "gender"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🈳",
>     "name": "u7a7a",
>     "keywords": [
>       "kanji",
>       "japanese",
>       "chinese",
>       "empty",
>       "sky",
>       "blue-square",
>       "aki"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🈹",
>     "name": "u5272",
>     "keywords": ["cut", "divide", "chinese", "kanji", "pink-square", "waribiki"]
>   },
>   {
>     "category": "symbols",
>     "char": "☢",
>     "name": "radioactive",
>     "keywords": ["nuclear", "danger"]
>   },
>   {
>     "category": "symbols",
>     "char": "☣",
>     "name": "biohazard",
>     "keywords": ["danger"]
>   },
>   {
>     "category": "symbols",
>     "char": "📴",
>     "name": "mobile_phone_off",
>     "keywords": ["mute", "orange-square", "silence", "quiet"]
>   },
>   {
>     "category": "symbols",
>     "char": "📳",
>     "name": "vibration_mode",
>     "keywords": ["orange-square", "phone"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈶",
>     "name": "u6709",
>     "keywords": ["orange-square", "chinese", "have", "kanji", "ari"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈚",
>     "name": "u7121",
>     "keywords": [
>       "nothing",
>       "chinese",
>       "kanji",
>       "japanese",
>       "orange-square",
>       "nashi"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🈸",
>     "name": "u7533",
>     "keywords": ["chinese", "japanese", "kanji", "orange-square", "moushikomi"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈺",
>     "name": "u55b6",
>     "keywords": ["japanese", "opening hours", "orange-square", "eigyo"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈷️",
>     "name": "u6708",
>     "keywords": [
>       "chinese",
>       "month",
>       "moon",
>       "japanese",
>       "orange-square",
>       "kanji",
>       "tsuki",
>       "tsukigime",
>       "getsugaku"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "✴️",
>     "name": "eight_pointed_black_star",
>     "keywords": ["orange-square", "shape", "polygon"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆚",
>     "name": "vs",
>     "keywords": ["words", "orange-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🉑",
>     "name": "accept",
>     "keywords": [
>       "ok",
>       "good",
>       "chinese",
>       "kanji",
>       "agree",
>       "yes",
>       "orange-circle"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "💮",
>     "name": "white_flower",
>     "keywords": ["japanese", "spring"]
>   },
>   {
>     "category": "symbols",
>     "char": "🉐",
>     "name": "ideograph_advantage",
>     "keywords": ["chinese", "kanji", "obtain", "get", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "㊙️",
>     "name": "secret",
>     "keywords": ["privacy", "chinese", "sshh", "kanji", "red-circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "㊗️",
>     "name": "congratulations",
>     "keywords": ["chinese", "kanji", "japanese", "red-circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈴",
>     "name": "u5408",
>     "keywords": [
>       "japanese",
>       "chinese",
>       "join",
>       "kanji",
>       "red-square",
>       "goukaku",
>       "pass"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🈵",
>     "name": "u6e80",
>     "keywords": ["full", "chinese", "japanese", "red-square", "kanji", "man"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈲",
>     "name": "u7981",
>     "keywords": [
>       "kanji",
>       "japanese",
>       "chinese",
>       "forbidden",
>       "limit",
>       "restricted",
>       "red-square",
>       "kinshi"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🅰️",
>     "name": "a",
>     "keywords": ["red-square", "alphabet", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🅱️",
>     "name": "b",
>     "keywords": ["red-square", "alphabet", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆎",
>     "name": "ab",
>     "keywords": ["red-square", "alphabet"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆑",
>     "name": "cl",
>     "keywords": ["alphabet", "words", "red-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🅾️",
>     "name": "o2",
>     "keywords": ["alphabet", "red-square", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆘",
>     "name": "sos",
>     "keywords": ["help", "red-square", "words", "emergency", "911"]
>   },
>   {
>     "category": "symbols",
>     "char": "⛔",
>     "name": "no_entry",
>     "keywords": [
>       "limit",
>       "security",
>       "privacy",
>       "bad",
>       "denied",
>       "stop",
>       "circle"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "📛",
>     "name": "name_badge",
>     "keywords": ["fire", "forbid"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚫",
>     "name": "no_entry_sign",
>     "keywords": ["forbid", "stop", "limit", "denied", "disallow", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "❌",
>     "name": "x",
>     "keywords": ["no", "delete", "remove", "cancel", "red"]
>   },
>   {
>     "category": "symbols",
>     "char": "⭕",
>     "name": "o",
>     "keywords": ["circle", "round"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛑",
>     "name": "stop_sign",
>     "keywords": ["stop"]
>   },
>   {
>     "category": "symbols",
>     "char": "💢",
>     "name": "anger",
>     "keywords": ["angry", "mad"]
>   },
>   {
>     "category": "symbols",
>     "char": "♨️",
>     "name": "hotsprings",
>     "keywords": ["bath", "warm", "relax"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚷",
>     "name": "no_pedestrians",
>     "keywords": ["rules", "crossing", "walking", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚯",
>     "name": "do_not_litter",
>     "keywords": ["trash", "bin", "garbage", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚳",
>     "name": "no_bicycles",
>     "keywords": ["cyclist", "prohibited", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚱",
>     "name": "non-potable_water",
>     "keywords": ["drink", "faucet", "tap", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔞",
>     "name": "underage",
>     "keywords": ["18", "drink", "pub", "night", "minor", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "📵",
>     "name": "no_mobile_phones",
>     "keywords": ["iphone", "mute", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "❗",
>     "name": "exclamation",
>     "keywords": [
>       "heavy_exclamation_mark",
>       "danger",
>       "surprise",
>       "punctuation",
>       "wow",
>       "warning"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "❕",
>     "name": "grey_exclamation",
>     "keywords": ["surprise", "punctuation", "gray", "wow", "warning"]
>   },
>   {
>     "category": "symbols",
>     "char": "❓",
>     "name": "question",
>     "keywords": ["doubt", "confused"]
>   },
>   {
>     "category": "symbols",
>     "char": "❔",
>     "name": "grey_question",
>     "keywords": ["doubts", "gray", "huh", "confused"]
>   },
>   {
>     "category": "symbols",
>     "char": "‼️",
>     "name": "bangbang",
>     "keywords": ["exclamation", "surprise"]
>   },
>   {
>     "category": "symbols",
>     "char": "⁉️",
>     "name": "interrobang",
>     "keywords": ["wat", "punctuation", "surprise"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔅",
>     "name": "low_brightness",
>     "keywords": ["sun", "afternoon", "warm", "summer"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔆",
>     "name": "high_brightness",
>     "keywords": ["sun", "light"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔱",
>     "name": "trident",
>     "keywords": ["weapon", "spear"]
>   },
>   {
>     "category": "symbols",
>     "char": "⚜",
>     "name": "fleur_de_lis",
>     "keywords": ["decorative", "scout"]
>   },
>   {
>     "category": "symbols",
>     "char": "〽️",
>     "name": "part_alternation_mark",
>     "keywords": [
>       "graph",
>       "presentation",
>       "stats",
>       "business",
>       "economics",
>       "bad"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "⚠️",
>     "name": "warning",
>     "keywords": ["exclamation", "wip", "alert", "error", "problem", "issue"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚸",
>     "name": "children_crossing",
>     "keywords": [
>       "school",
>       "warning",
>       "danger",
>       "sign",
>       "driving",
>       "yellow-diamond"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🔰",
>     "name": "beginner",
>     "keywords": ["badge", "shield"]
>   },
>   {
>     "category": "symbols",
>     "char": "♻️",
>     "name": "recycle",
>     "keywords": ["arrow", "environment", "garbage", "trash"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈯",
>     "name": "u6307",
>     "keywords": [
>       "chinese",
>       "point",
>       "green-square",
>       "kanji",
>       "reserved",
>       "shiteiseki"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "💹",
>     "name": "chart",
>     "keywords": ["green-square", "graph", "presentation", "stats"]
>   },
>   {
>     "category": "symbols",
>     "char": "❇️",
>     "name": "sparkle",
>     "keywords": ["stars", "green-square", "awesome", "good", "fireworks"]
>   },
>   {
>     "category": "symbols",
>     "char": "✳️",
>     "name": "eight_spoked_asterisk",
>     "keywords": ["star", "sparkle", "green-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "❎",
>     "name": "negative_squared_cross_mark",
>     "keywords": ["x", "green-square", "no", "deny"]
>   },
>   {
>     "category": "symbols",
>     "char": "✅",
>     "name": "white_check_mark",
>     "keywords": [
>       "green-square",
>       "ok",
>       "agree",
>       "vote",
>       "election",
>       "answer",
>       "tick"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "💠",
>     "name": "diamond_shape_with_a_dot_inside",
>     "keywords": ["jewel", "blue", "gem", "crystal", "fancy"]
>   },
>   {
>     "category": "symbols",
>     "char": "🌀",
>     "name": "cyclone",
>     "keywords": [
>       "weather",
>       "swirl",
>       "blue",
>       "cloud",
>       "vortex",
>       "spiral",
>       "whirlpool",
>       "spin",
>       "tornado",
>       "hurricane",
>       "typhoon"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "➿",
>     "name": "loop",
>     "keywords": ["tape", "cassette"]
>   },
>   {
>     "category": "symbols",
>     "char": "🌐",
>     "name": "globe_with_meridians",
>     "keywords": [
>       "earth",
>       "international",
>       "world",
>       "internet",
>       "interweb",
>       "i18n"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "Ⓜ️",
>     "name": "m",
>     "keywords": ["alphabet", "blue-circle", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🏧",
>     "name": "atm",
>     "keywords": ["money", "sales", "cash", "blue-square", "payment", "bank"]
>   },
>   {
>     "category": "symbols",
>     "char": "🈂️",
>     "name": "sa",
>     "keywords": ["japanese", "blue-square", "katakana"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛂",
>     "name": "passport_control",
>     "keywords": ["custom", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛃",
>     "name": "customs",
>     "keywords": ["passport", "border", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛄",
>     "name": "baggage_claim",
>     "keywords": ["blue-square", "airport", "transport"]
>   },
>   {
>     "category": "symbols",
>     "char": "🛅",
>     "name": "left_luggage",
>     "keywords": ["blue-square", "travel"]
>   },
>   {
>     "category": "symbols",
>     "char": "♿",
>     "name": "wheelchair",
>     "keywords": ["blue-square", "disabled", "a11y", "accessibility"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚭",
>     "name": "no_smoking",
>     "keywords": ["cigarette", "blue-square", "smell", "smoke"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚾",
>     "name": "wc",
>     "keywords": ["toilet", "restroom", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🅿️",
>     "name": "parking",
>     "keywords": ["cars", "blue-square", "alphabet", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚰",
>     "name": "potable_water",
>     "keywords": ["blue-square", "liquid", "restroom", "cleaning", "faucet"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚹",
>     "name": "mens",
>     "keywords": ["toilet", "restroom", "wc", "blue-square", "gender", "male"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚺",
>     "name": "womens",
>     "keywords": [
>       "purple-square",
>       "woman",
>       "female",
>       "toilet",
>       "loo",
>       "restroom",
>       "gender"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🚼",
>     "name": "baby_symbol",
>     "keywords": ["orange-square", "child"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚻",
>     "name": "restroom",
>     "keywords": ["blue-square", "toilet", "refresh", "wc", "gender"]
>   },
>   {
>     "category": "symbols",
>     "char": "🚮",
>     "name": "put_litter_in_its_place",
>     "keywords": ["blue-square", "sign", "human", "info"]
>   },
>   {
>     "category": "symbols",
>     "char": "🎦",
>     "name": "cinema",
>     "keywords": [
>       "blue-square",
>       "record",
>       "film",
>       "movie",
>       "curtain",
>       "stage",
>       "theater"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "📶",
>     "name": "signal_strength",
>     "keywords": [
>       "blue-square",
>       "reception",
>       "phone",
>       "internet",
>       "connection",
>       "wifi",
>       "bluetooth",
>       "bars"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🈁",
>     "name": "koko",
>     "keywords": ["blue-square", "here", "katakana", "japanese", "destination"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆖",
>     "name": "ng",
>     "keywords": ["blue-square", "words", "shape", "icon"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆗",
>     "name": "ok",
>     "keywords": ["good", "agree", "yes", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆙",
>     "name": "up",
>     "keywords": ["blue-square", "above", "high"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆒",
>     "name": "cool",
>     "keywords": ["words", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆕",
>     "name": "new",
>     "keywords": ["blue-square", "words", "start"]
>   },
>   {
>     "category": "symbols",
>     "char": "🆓",
>     "name": "free",
>     "keywords": ["blue-square", "words"]
>   },
>   {
>     "category": "symbols",
>     "char": "0️⃣",
>     "name": "zero",
>     "keywords": ["0", "numbers", "blue-square", "null"]
>   },
>   {
>     "category": "symbols",
>     "char": "1️⃣",
>     "name": "one",
>     "keywords": ["blue-square", "numbers", "1"]
>   },
>   {
>     "category": "symbols",
>     "char": "2️⃣",
>     "name": "two",
>     "keywords": ["numbers", "2", "prime", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "3️⃣",
>     "name": "three",
>     "keywords": ["3", "numbers", "prime", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "4️⃣",
>     "name": "four",
>     "keywords": ["4", "numbers", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "5️⃣",
>     "name": "five",
>     "keywords": ["5", "numbers", "blue-square", "prime"]
>   },
>   {
>     "category": "symbols",
>     "char": "6️⃣",
>     "name": "six",
>     "keywords": ["6", "numbers", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "7️⃣",
>     "name": "seven",
>     "keywords": ["7", "numbers", "blue-square", "prime"]
>   },
>   {
>     "category": "symbols",
>     "char": "8️⃣",
>     "name": "eight",
>     "keywords": ["8", "blue-square", "numbers"]
>   },
>   {
>     "category": "symbols",
>     "char": "9️⃣",
>     "name": "nine",
>     "keywords": ["blue-square", "numbers", "9"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔟",
>     "name": "keycap_ten",
>     "keywords": ["numbers", "10", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "*⃣",
>     "name": "asterisk",
>     "keywords": ["star", "keycap"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏏️",
>     "name": "eject_button",
>     "keywords": ["blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "▶️",
>     "name": "arrow_forward",
>     "keywords": ["blue-square", "right", "direction", "play"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏸",
>     "name": "pause_button",
>     "keywords": ["pause", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏭",
>     "name": "next_track_button",
>     "keywords": ["forward", "next", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏹",
>     "name": "stop_button",
>     "keywords": ["blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏺",
>     "name": "record_button",
>     "keywords": ["blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏯",
>     "name": "play_or_pause_button",
>     "keywords": ["blue-square", "play", "pause"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏮",
>     "name": "previous_track_button",
>     "keywords": ["backward"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏩",
>     "name": "fast_forward",
>     "keywords": ["blue-square", "play", "speed", "continue"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏪",
>     "name": "rewind",
>     "keywords": ["play", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔀",
>     "name": "twisted_rightwards_arrows",
>     "keywords": ["blue-square", "shuffle", "music", "random"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔁",
>     "name": "repeat",
>     "keywords": ["loop", "record"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔂",
>     "name": "repeat_one",
>     "keywords": ["blue-square", "loop"]
>   },
>   {
>     "category": "symbols",
>     "char": "◀️",
>     "name": "arrow_backward",
>     "keywords": ["blue-square", "left", "direction"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔼",
>     "name": "arrow_up_small",
>     "keywords": [
>       "blue-square",
>       "triangle",
>       "direction",
>       "point",
>       "forward",
>       "top"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🔽",
>     "name": "arrow_down_small",
>     "keywords": ["blue-square", "direction", "bottom"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏫",
>     "name": "arrow_double_up",
>     "keywords": ["blue-square", "direction", "top"]
>   },
>   {
>     "category": "symbols",
>     "char": "⏬",
>     "name": "arrow_double_down",
>     "keywords": ["blue-square", "direction", "bottom"]
>   },
>   {
>     "category": "symbols",
>     "char": "➡️",
>     "name": "arrow_right",
>     "keywords": ["blue-square", "next"]
>   },
>   {
>     "category": "symbols",
>     "char": "⬅️",
>     "name": "arrow_left",
>     "keywords": ["blue-square", "previous", "back"]
>   },
>   {
>     "category": "symbols",
>     "char": "⬆️",
>     "name": "arrow_up",
>     "keywords": ["blue-square", "continue", "top", "direction"]
>   },
>   {
>     "category": "symbols",
>     "char": "⬇️",
>     "name": "arrow_down",
>     "keywords": ["blue-square", "direction", "bottom"]
>   },
>   {
>     "category": "symbols",
>     "char": "↗️",
>     "name": "arrow_upper_right",
>     "keywords": ["blue-square", "point", "direction", "diagonal", "northeast"]
>   },
>   {
>     "category": "symbols",
>     "char": "↘️",
>     "name": "arrow_lower_right",
>     "keywords": ["blue-square", "direction", "diagonal", "southeast"]
>   },
>   {
>     "category": "symbols",
>     "char": "↙️",
>     "name": "arrow_lower_left",
>     "keywords": ["blue-square", "direction", "diagonal", "southwest"]
>   },
>   {
>     "category": "symbols",
>     "char": "↖️",
>     "name": "arrow_upper_left",
>     "keywords": ["blue-square", "point", "direction", "diagonal", "northwest"]
>   },
>   {
>     "category": "symbols",
>     "char": "↕️",
>     "name": "arrow_up_down",
>     "keywords": ["blue-square", "direction", "way", "vertical"]
>   },
>   {
>     "category": "symbols",
>     "char": "↔️",
>     "name": "left_right_arrow",
>     "keywords": ["shape", "direction", "horizontal", "sideways"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔄",
>     "name": "arrows_counterclockwise",
>     "keywords": ["blue-square", "sync", "cycle"]
>   },
>   {
>     "category": "symbols",
>     "char": "↪️",
>     "name": "arrow_right_hook",
>     "keywords": ["blue-square", "return", "rotate", "direction"]
>   },
>   {
>     "category": "symbols",
>     "char": "↩️",
>     "name": "leftwards_arrow_with_hook",
>     "keywords": ["back", "return", "blue-square", "undo", "enter"]
>   },
>   {
>     "category": "symbols",
>     "char": "⤴️",
>     "name": "arrow_heading_up",
>     "keywords": ["blue-square", "direction", "top"]
>   },
>   {
>     "category": "symbols",
>     "char": "⤵️",
>     "name": "arrow_heading_down",
>     "keywords": ["blue-square", "direction", "bottom"]
>   },
>   {
>     "category": "symbols",
>     "char": "#️⃣",
>     "name": "hash",
>     "keywords": ["symbol", "blue-square", "twitter"]
>   },
>   {
>     "category": "symbols",
>     "char": "ℹ️",
>     "name": "information_source",
>     "keywords": ["blue-square", "alphabet", "letter"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔤",
>     "name": "abc",
>     "keywords": ["blue-square", "alphabet"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔡",
>     "name": "abcd",
>     "keywords": ["blue-square", "alphabet"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔠",
>     "name": "capital_abcd",
>     "keywords": ["alphabet", "words", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔣",
>     "name": "symbols",
>     "keywords": [
>       "blue-square",
>       "music",
>       "note",
>       "ampersand",
>       "percent",
>       "glyphs",
>       "characters"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🎵",
>     "name": "musical_note",
>     "keywords": ["score", "tone", "sound"]
>   },
>   {
>     "category": "symbols",
>     "char": "🎶",
>     "name": "notes",
>     "keywords": ["music", "score"]
>   },
>   {
>     "category": "symbols",
>     "char": "〰️",
>     "name": "wavy_dash",
>     "keywords": [
>       "draw",
>       "line",
>       "moustache",
>       "mustache",
>       "squiggle",
>       "scribble"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "➰",
>     "name": "curly_loop",
>     "keywords": ["scribble", "draw", "shape", "squiggle"]
>   },
>   {
>     "category": "symbols",
>     "char": "✔️",
>     "name": "heavy_check_mark",
>     "keywords": ["ok", "nike", "answer", "yes", "tick"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔃",
>     "name": "arrows_clockwise",
>     "keywords": ["sync", "cycle", "round", "repeat"]
>   },
>   {
>     "category": "symbols",
>     "char": "➕",
>     "name": "heavy_plus_sign",
>     "keywords": ["math", "calculation", "addition", "more", "increase"]
>   },
>   {
>     "category": "symbols",
>     "char": "➖",
>     "name": "heavy_minus_sign",
>     "keywords": ["math", "calculation", "subtract", "less"]
>   },
>   {
>     "category": "symbols",
>     "char": "➗",
>     "name": "heavy_division_sign",
>     "keywords": ["divide", "math", "calculation"]
>   },
>   {
>     "category": "symbols",
>     "char": "✖️",
>     "name": "heavy_multiplication_x",
>     "keywords": ["math", "calculation"]
>   },
>   {
>     "category": "symbols",
>     "char": "\uD83D\uDFF0",
>     "name": "heavy_equals_sign",
>     "keywords": []
>   },
>   {
>     "category": "symbols",
>     "char": "♾",
>     "name": "infinity",
>     "keywords": ["forever"]
>   },
>   {
>     "category": "symbols",
>     "char": "💲",
>     "name": "heavy_dollar_sign",
>     "keywords": ["money", "sales", "payment", "currency", "buck"]
>   },
>   {
>     "category": "symbols",
>     "char": "💱",
>     "name": "currency_exchange",
>     "keywords": ["money", "sales", "dollar", "travel"]
>   },
>   {
>     "category": "symbols",
>     "char": "©️",
>     "name": "copyright",
>     "keywords": ["ip", "license", "circle", "law", "legal"]
>   },
>   {
>     "category": "symbols",
>     "char": "®️",
>     "name": "registered",
>     "keywords": ["alphabet", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "™️",
>     "name": "tm",
>     "keywords": ["trademark", "brand", "law", "legal"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔚",
>     "name": "end",
>     "keywords": ["words", "arrow"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔙",
>     "name": "back",
>     "keywords": ["arrow", "words", "return"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔛",
>     "name": "on",
>     "keywords": ["arrow", "words"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔝",
>     "name": "top",
>     "keywords": ["words", "blue-square"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔜",
>     "name": "soon",
>     "keywords": ["arrow", "words"]
>   },
>   {
>     "category": "symbols",
>     "char": "☑️",
>     "name": "ballot_box_with_check",
>     "keywords": [
>       "ok",
>       "agree",
>       "confirm",
>       "black-square",
>       "vote",
>       "election",
>       "yes",
>       "tick"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🔘",
>     "name": "radio_button",
>     "keywords": ["input", "old", "music", "circle"]
>   },
>   {
>     "category": "symbols",
>     "char": "⚫",
>     "name": "black_circle",
>     "keywords": ["shape", "button", "round"]
>   },
>   {
>     "category": "symbols",
>     "char": "⚪",
>     "name": "white_circle",
>     "keywords": ["shape", "round"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔴",
>     "name": "red_circle",
>     "keywords": ["shape", "error", "danger"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟠",
>     "name": "orange_circle",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟡",
>     "name": "yellow_circle",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟢",
>     "name": "green_circle",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔵",
>     "name": "large_blue_circle",
>     "keywords": ["shape", "icon", "button"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟣",
>     "name": "purple_circle",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟤",
>     "name": "brown_circle",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔸",
>     "name": "small_orange_diamond",
>     "keywords": ["shape", "jewel", "gem"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔹",
>     "name": "small_blue_diamond",
>     "keywords": ["shape", "jewel", "gem"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔶",
>     "name": "large_orange_diamond",
>     "keywords": ["shape", "jewel", "gem"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔷",
>     "name": "large_blue_diamond",
>     "keywords": ["shape", "jewel", "gem"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔺",
>     "name": "small_red_triangle",
>     "keywords": ["shape", "direction", "up", "top"]
>   },
>   {
>     "category": "symbols",
>     "char": "▪️",
>     "name": "black_small_square",
>     "keywords": ["shape", "icon"]
>   },
>   {
>     "category": "symbols",
>     "char": "▫️",
>     "name": "white_small_square",
>     "keywords": ["shape", "icon"]
>   },
>   {
>     "category": "symbols",
>     "char": "⬛",
>     "name": "black_large_square",
>     "keywords": ["shape", "icon", "button"]
>   },
>   {
>     "category": "symbols",
>     "char": "⬜",
>     "name": "white_large_square",
>     "keywords": ["shape", "icon", "stone", "button"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟥",
>     "name": "red_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟧",
>     "name": "orange_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟨",
>     "name": "yellow_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟩",
>     "name": "green_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟦",
>     "name": "blue_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟪",
>     "name": "purple_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🟫",
>     "name": "brown_square",
>     "keywords": ["shape"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔻",
>     "name": "small_red_triangle_down",
>     "keywords": ["shape", "direction", "bottom"]
>   },
>   {
>     "category": "symbols",
>     "char": "◼️",
>     "name": "black_medium_square",
>     "keywords": ["shape", "button", "icon"]
>   },
>   {
>     "category": "symbols",
>     "char": "◻️",
>     "name": "white_medium_square",
>     "keywords": ["shape", "stone", "icon"]
>   },
>   {
>     "category": "symbols",
>     "char": "◾",
>     "name": "black_medium_small_square",
>     "keywords": ["icon", "shape", "button"]
>   },
>   {
>     "category": "symbols",
>     "char": "◽",
>     "name": "white_medium_small_square",
>     "keywords": ["shape", "stone", "icon", "button"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔲",
>     "name": "black_square_button",
>     "keywords": ["shape", "input", "frame"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔳",
>     "name": "white_square_button",
>     "keywords": ["shape", "input"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔈",
>     "name": "speaker",
>     "keywords": ["sound", "volume", "silence", "broadcast"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔉",
>     "name": "sound",
>     "keywords": ["volume", "speaker", "broadcast"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔊",
>     "name": "loud_sound",
>     "keywords": ["volume", "noise", "noisy", "speaker", "broadcast"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔇",
>     "name": "mute",
>     "keywords": ["sound", "volume", "silence", "quiet"]
>   },
>   {
>     "category": "symbols",
>     "char": "📣",
>     "name": "mega",
>     "keywords": ["sound", "speaker", "volume"]
>   },
>   {
>     "category": "symbols",
>     "char": "📢",
>     "name": "loudspeaker",
>     "keywords": ["volume", "sound"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔔",
>     "name": "bell",
>     "keywords": ["sound", "notification", "christmas", "xmas", "chime"]
>   },
>   {
>     "category": "symbols",
>     "char": "🔕",
>     "name": "no_bell",
>     "keywords": ["sound", "volume", "mute", "quiet", "silent"]
>   },
>   {
>     "category": "symbols",
>     "char": "🃏",
>     "name": "black_joker",
>     "keywords": ["poker", "cards", "game", "play", "magic"]
>   },
>   {
>     "category": "symbols",
>     "char": "🀄",
>     "name": "mahjong",
>     "keywords": ["game", "play", "chinese", "kanji"]
>   },
>   {
>     "category": "symbols",
>     "char": "♠️",
>     "name": "spades",
>     "keywords": ["poker", "cards", "suits", "magic"]
>   },
>   {
>     "category": "symbols",
>     "char": "♣️",
>     "name": "clubs",
>     "keywords": ["poker", "cards", "magic", "suits"]
>   },
>   {
>     "category": "symbols",
>     "char": "♥️",
>     "name": "hearts",
>     "keywords": ["poker", "cards", "magic", "suits"]
>   },
>   {
>     "category": "symbols",
>     "char": "♦️",
>     "name": "diamonds",
>     "keywords": ["poker", "cards", "magic", "suits"]
>   },
>   {
>     "category": "symbols",
>     "char": "🎴",
>     "name": "flower_playing_cards",
>     "keywords": ["game", "sunset", "red"]
>   },
>   {
>     "category": "symbols",
>     "char": "💭",
>     "name": "thought_balloon",
>     "keywords": ["bubble", "cloud", "speech", "thinking", "dream"]
>   },
>   {
>     "category": "symbols",
>     "char": "🗯",
>     "name": "right_anger_bubble",
>     "keywords": ["caption", "speech", "thinking", "mad"]
>   },
>   {
>     "category": "symbols",
>     "char": "💬",
>     "name": "speech_balloon",
>     "keywords": ["bubble", "words", "message", "talk", "chatting"]
>   },
>   {
>     "category": "symbols",
>     "char": "🗨",
>     "name": "left_speech_bubble",
>     "keywords": ["words", "message", "talk", "chatting"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕐",
>     "name": "clock1",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕑",
>     "name": "clock2",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕒",
>     "name": "clock3",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕓",
>     "name": "clock4",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕔",
>     "name": "clock5",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕕",
>     "name": "clock6",
>     "keywords": ["time", "late", "early", "schedule", "dawn", "dusk"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕖",
>     "name": "clock7",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕗",
>     "name": "clock8",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕘",
>     "name": "clock9",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕙",
>     "name": "clock10",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕚",
>     "name": "clock11",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕛",
>     "name": "clock12",
>     "keywords": [
>       "time",
>       "noon",
>       "midnight",
>       "midday",
>       "late",
>       "early",
>       "schedule"
>     ]
>   },
>   {
>     "category": "symbols",
>     "char": "🕜",
>     "name": "clock130",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕝",
>     "name": "clock230",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕞",
>     "name": "clock330",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕟",
>     "name": "clock430",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕠",
>     "name": "clock530",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕡",
>     "name": "clock630",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕢",
>     "name": "clock730",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕣",
>     "name": "clock830",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕤",
>     "name": "clock930",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕥",
>     "name": "clock1030",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕦",
>     "name": "clock1130",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "symbols",
>     "char": "🕧",
>     "name": "clock1230",
>     "keywords": ["time", "late", "early", "schedule"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇫",
>     "name": "afghanistan",
>     "keywords": ["af", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇽",
>     "name": "aland_islands",
>     "keywords": ["Åland", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇱",
>     "name": "albania",
>     "keywords": ["al", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇿",
>     "name": "algeria",
>     "keywords": ["dz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇸",
>     "name": "american_samoa",
>     "keywords": ["american", "ws", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇩",
>     "name": "andorra",
>     "keywords": ["ad", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇴",
>     "name": "angola",
>     "keywords": ["ao", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇮",
>     "name": "anguilla",
>     "keywords": ["ai", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇶",
>     "name": "antarctica",
>     "keywords": ["aq", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇬",
>     "name": "antigua_barbuda",
>     "keywords": ["antigua", "barbuda", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇷",
>     "name": "argentina",
>     "keywords": ["ar", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇲",
>     "name": "armenia",
>     "keywords": ["am", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇼",
>     "name": "aruba",
>     "keywords": ["aw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇨",
>     "name": "ascension_island",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇺",
>     "name": "australia",
>     "keywords": ["au", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇹",
>     "name": "austria",
>     "keywords": ["at", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇿",
>     "name": "azerbaijan",
>     "keywords": ["az", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇸",
>     "name": "bahamas",
>     "keywords": ["bs", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇭",
>     "name": "bahrain",
>     "keywords": ["bh", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇩",
>     "name": "bangladesh",
>     "keywords": ["bd", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇧",
>     "name": "barbados",
>     "keywords": ["bb", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇾",
>     "name": "belarus",
>     "keywords": ["by", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇪",
>     "name": "belgium",
>     "keywords": ["be", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇿",
>     "name": "belize",
>     "keywords": ["bz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇯",
>     "name": "benin",
>     "keywords": ["bj", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇲",
>     "name": "bermuda",
>     "keywords": ["bm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇹",
>     "name": "bhutan",
>     "keywords": ["bt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇴",
>     "name": "bolivia",
>     "keywords": ["bo", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇶",
>     "name": "caribbean_netherlands",
>     "keywords": ["bonaire", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇦",
>     "name": "bosnia_herzegovina",
>     "keywords": ["bosnia", "herzegovina", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇼",
>     "name": "botswana",
>     "keywords": ["bw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇷",
>     "name": "brazil",
>     "keywords": ["br", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇴",
>     "name": "british_indian_ocean_territory",
>     "keywords": [
>       "british",
>       "indian",
>       "ocean",
>       "territory",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇬",
>     "name": "british_virgin_islands",
>     "keywords": [
>       "british",
>       "virgin",
>       "islands",
>       "bvi",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇳",
>     "name": "brunei",
>     "keywords": ["bn", "darussalam", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇬",
>     "name": "bulgaria",
>     "keywords": ["bg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇫",
>     "name": "burkina_faso",
>     "keywords": ["burkina", "faso", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇮",
>     "name": "burundi",
>     "keywords": ["bi", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇻",
>     "name": "cape_verde",
>     "keywords": ["cabo", "verde", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇭",
>     "name": "cambodia",
>     "keywords": ["kh", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇲",
>     "name": "cameroon",
>     "keywords": ["cm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇦",
>     "name": "canada",
>     "keywords": ["ca", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇨",
>     "name": "canary_islands",
>     "keywords": ["canary", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇾",
>     "name": "cayman_islands",
>     "keywords": ["cayman", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇫",
>     "name": "central_african_republic",
>     "keywords": [
>       "central",
>       "african",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇩",
>     "name": "chad",
>     "keywords": ["td", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇱",
>     "name": "chile",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇳",
>     "name": "cn",
>     "keywords": [
>       "china",
>       "chinese",
>       "prc",
>       "flag",
>       "country",
>       "nation",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇽",
>     "name": "christmas_island",
>     "keywords": ["christmas", "island", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇨",
>     "name": "cocos_islands",
>     "keywords": [
>       "cocos",
>       "keeling",
>       "islands",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇴",
>     "name": "colombia",
>     "keywords": ["co", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇲",
>     "name": "comoros",
>     "keywords": ["km", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇬",
>     "name": "congo_brazzaville",
>     "keywords": ["congo", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇩",
>     "name": "congo_kinshasa",
>     "keywords": [
>       "congo",
>       "democratic",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇰",
>     "name": "cook_islands",
>     "keywords": ["cook", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇷",
>     "name": "costa_rica",
>     "keywords": ["costa", "rica", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇭🇷",
>     "name": "croatia",
>     "keywords": ["hr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇺",
>     "name": "cuba",
>     "keywords": ["cu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇼",
>     "name": "curacao",
>     "keywords": ["curaçao", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇾",
>     "name": "cyprus",
>     "keywords": ["cy", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇿",
>     "name": "czech_republic",
>     "keywords": ["cz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇰",
>     "name": "denmark",
>     "keywords": ["dk", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇯",
>     "name": "djibouti",
>     "keywords": ["dj", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇲",
>     "name": "dominica",
>     "keywords": ["dm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇴",
>     "name": "dominican_republic",
>     "keywords": ["dominican", "republic", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇨",
>     "name": "ecuador",
>     "keywords": ["ec", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇬",
>     "name": "egypt",
>     "keywords": ["eg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇻",
>     "name": "el_salvador",
>     "keywords": ["el", "salvador", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇶",
>     "name": "equatorial_guinea",
>     "keywords": ["equatorial", "gn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇷",
>     "name": "eritrea",
>     "keywords": ["er", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇪",
>     "name": "estonia",
>     "keywords": ["ee", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇹",
>     "name": "ethiopia",
>     "keywords": ["et", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇺",
>     "name": "eu",
>     "keywords": ["european", "union", "flag", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇰",
>     "name": "falkland_islands",
>     "keywords": [
>       "falkland",
>       "islands",
>       "malvinas",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇴",
>     "name": "faroe_islands",
>     "keywords": ["faroe", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇯",
>     "name": "fiji",
>     "keywords": ["fj", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇮",
>     "name": "finland",
>     "keywords": ["fi", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇷",
>     "name": "fr",
>     "keywords": ["banner", "flag", "nation", "france", "french", "country"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇫",
>     "name": "french_guiana",
>     "keywords": ["french", "guiana", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇫",
>     "name": "french_polynesia",
>     "keywords": ["french", "polynesia", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇫",
>     "name": "french_southern_territories",
>     "keywords": [
>       "french",
>       "southern",
>       "territories",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇦",
>     "name": "gabon",
>     "keywords": ["ga", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇲",
>     "name": "gambia",
>     "keywords": ["gm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇪",
>     "name": "georgia",
>     "keywords": ["ge", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇩🇪",
>     "name": "de",
>     "keywords": ["german", "nation", "flag", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇭",
>     "name": "ghana",
>     "keywords": ["gh", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇮",
>     "name": "gibraltar",
>     "keywords": ["gi", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇷",
>     "name": "greece",
>     "keywords": ["gr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇱",
>     "name": "greenland",
>     "keywords": ["gl", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇩",
>     "name": "grenada",
>     "keywords": ["gd", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇵",
>     "name": "guadeloupe",
>     "keywords": ["gp", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇺",
>     "name": "guam",
>     "keywords": ["gu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇹",
>     "name": "guatemala",
>     "keywords": ["gt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇬",
>     "name": "guernsey",
>     "keywords": ["gg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇳",
>     "name": "guinea",
>     "keywords": ["gn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇼",
>     "name": "guinea_bissau",
>     "keywords": ["gw", "bissau", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇾",
>     "name": "guyana",
>     "keywords": ["gy", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇭🇹",
>     "name": "haiti",
>     "keywords": ["ht", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇭🇳",
>     "name": "honduras",
>     "keywords": ["hn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇭🇰",
>     "name": "hong_kong",
>     "keywords": ["hong", "kong", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇭🇺",
>     "name": "hungary",
>     "keywords": ["hu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇸",
>     "name": "iceland",
>     "keywords": ["is", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇳",
>     "name": "india",
>     "keywords": ["in", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇩",
>     "name": "indonesia",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇷",
>     "name": "iran",
>     "keywords": [
>       "iran, ",
>       "islamic",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇶",
>     "name": "iraq",
>     "keywords": ["iq", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇪",
>     "name": "ireland",
>     "keywords": ["ie", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇲",
>     "name": "isle_of_man",
>     "keywords": ["isle", "man", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇱",
>     "name": "israel",
>     "keywords": ["il", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇮🇹",
>     "name": "it",
>     "keywords": ["italy", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇮",
>     "name": "cote_divoire",
>     "keywords": ["ivory", "coast", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇯🇲",
>     "name": "jamaica",
>     "keywords": ["jm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇯🇵",
>     "name": "jp",
>     "keywords": ["japanese", "nation", "flag", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇯🇪",
>     "name": "jersey",
>     "keywords": ["je", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇯🇴",
>     "name": "jordan",
>     "keywords": ["jo", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇿",
>     "name": "kazakhstan",
>     "keywords": ["kz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇪",
>     "name": "kenya",
>     "keywords": ["ke", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇮",
>     "name": "kiribati",
>     "keywords": ["ki", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇽🇰",
>     "name": "kosovo",
>     "keywords": ["xk", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇼",
>     "name": "kuwait",
>     "keywords": ["kw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇬",
>     "name": "kyrgyzstan",
>     "keywords": ["kg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇦",
>     "name": "laos",
>     "keywords": [
>       "lao",
>       "democratic",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇻",
>     "name": "latvia",
>     "keywords": ["lv", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇧",
>     "name": "lebanon",
>     "keywords": ["lb", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇸",
>     "name": "lesotho",
>     "keywords": ["ls", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇷",
>     "name": "liberia",
>     "keywords": ["lr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇾",
>     "name": "libya",
>     "keywords": ["ly", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇮",
>     "name": "liechtenstein",
>     "keywords": ["li", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇹",
>     "name": "lithuania",
>     "keywords": ["lt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇺",
>     "name": "luxembourg",
>     "keywords": ["lu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇴",
>     "name": "macau",
>     "keywords": ["macao", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇰",
>     "name": "macedonia",
>     "keywords": ["macedonia, ", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇬",
>     "name": "madagascar",
>     "keywords": ["mg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇼",
>     "name": "malawi",
>     "keywords": ["mw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇾",
>     "name": "malaysia",
>     "keywords": ["my", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇻",
>     "name": "maldives",
>     "keywords": ["mv", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇱",
>     "name": "mali",
>     "keywords": ["ml", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇹",
>     "name": "malta",
>     "keywords": ["mt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇭",
>     "name": "marshall_islands",
>     "keywords": ["marshall", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇶",
>     "name": "martinique",
>     "keywords": ["mq", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇷",
>     "name": "mauritania",
>     "keywords": ["mr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇺",
>     "name": "mauritius",
>     "keywords": ["mu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇾🇹",
>     "name": "mayotte",
>     "keywords": ["yt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇽",
>     "name": "mexico",
>     "keywords": ["mx", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇫🇲",
>     "name": "micronesia",
>     "keywords": [
>       "micronesia, ",
>       "federated",
>       "states",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇩",
>     "name": "moldova",
>     "keywords": ["moldova, ", "republic", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇨",
>     "name": "monaco",
>     "keywords": ["mc", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇳",
>     "name": "mongolia",
>     "keywords": ["mn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇪",
>     "name": "montenegro",
>     "keywords": ["me", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇸",
>     "name": "montserrat",
>     "keywords": ["ms", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇦",
>     "name": "morocco",
>     "keywords": ["ma", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇿",
>     "name": "mozambique",
>     "keywords": ["mz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇲",
>     "name": "myanmar",
>     "keywords": ["mm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇦",
>     "name": "namibia",
>     "keywords": ["na", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇷",
>     "name": "nauru",
>     "keywords": ["nr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇵",
>     "name": "nepal",
>     "keywords": ["np", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇱",
>     "name": "netherlands",
>     "keywords": ["nl", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇨",
>     "name": "new_caledonia",
>     "keywords": ["new", "caledonia", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇿",
>     "name": "new_zealand",
>     "keywords": ["new", "zealand", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇮",
>     "name": "nicaragua",
>     "keywords": ["ni", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇪",
>     "name": "niger",
>     "keywords": ["ne", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇬",
>     "name": "nigeria",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇺",
>     "name": "niue",
>     "keywords": ["nu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇫",
>     "name": "norfolk_island",
>     "keywords": ["norfolk", "island", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇲🇵",
>     "name": "northern_mariana_islands",
>     "keywords": [
>       "northern",
>       "mariana",
>       "islands",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇵",
>     "name": "north_korea",
>     "keywords": ["north", "korea", "nation", "flag", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇳🇴",
>     "name": "norway",
>     "keywords": ["no", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇴🇲",
>     "name": "oman",
>     "keywords": ["om_symbol", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇰",
>     "name": "pakistan",
>     "keywords": ["pk", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇼",
>     "name": "palau",
>     "keywords": ["pw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇸",
>     "name": "palestinian_territories",
>     "keywords": [
>       "palestine",
>       "palestinian",
>       "territories",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇦",
>     "name": "panama",
>     "keywords": ["pa", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇬",
>     "name": "papua_new_guinea",
>     "keywords": [
>       "papua",
>       "new",
>       "guinea",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇾",
>     "name": "paraguay",
>     "keywords": ["py", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇪",
>     "name": "peru",
>     "keywords": ["pe", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇭",
>     "name": "philippines",
>     "keywords": ["ph", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇳",
>     "name": "pitcairn_islands",
>     "keywords": ["pitcairn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇱",
>     "name": "poland",
>     "keywords": ["pl", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇹",
>     "name": "portugal",
>     "keywords": ["pt", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇷",
>     "name": "puerto_rico",
>     "keywords": ["puerto", "rico", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇶🇦",
>     "name": "qatar",
>     "keywords": ["qa", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇷🇪",
>     "name": "reunion",
>     "keywords": ["réunion", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇷🇴",
>     "name": "romania",
>     "keywords": ["ro", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇷🇺",
>     "name": "ru",
>     "keywords": ["russian", "federation", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇷🇼",
>     "name": "rwanda",
>     "keywords": ["rw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇧🇱",
>     "name": "st_barthelemy",
>     "keywords": ["saint", "barthélemy", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇭",
>     "name": "st_helena",
>     "keywords": [
>       "saint",
>       "helena",
>       "ascension",
>       "tristan",
>       "cunha",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇳",
>     "name": "st_kitts_nevis",
>     "keywords": [
>       "saint",
>       "kitts",
>       "nevis",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇨",
>     "name": "st_lucia",
>     "keywords": ["saint", "lucia", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇵🇲",
>     "name": "st_pierre_miquelon",
>     "keywords": [
>       "saint",
>       "pierre",
>       "miquelon",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇨",
>     "name": "st_vincent_grenadines",
>     "keywords": [
>       "saint",
>       "vincent",
>       "grenadines",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇼🇸",
>     "name": "samoa",
>     "keywords": ["ws", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇲",
>     "name": "san_marino",
>     "keywords": ["san", "marino", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇹",
>     "name": "sao_tome_principe",
>     "keywords": [
>       "sao",
>       "tome",
>       "principe",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇦",
>     "name": "saudi_arabia",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇳",
>     "name": "senegal",
>     "keywords": ["sn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇷🇸",
>     "name": "serbia",
>     "keywords": ["rs", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇨",
>     "name": "seychelles",
>     "keywords": ["sc", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇱",
>     "name": "sierra_leone",
>     "keywords": ["sierra", "leone", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇬",
>     "name": "singapore",
>     "keywords": ["sg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇽",
>     "name": "sint_maarten",
>     "keywords": [
>       "sint",
>       "maarten",
>       "dutch",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇰",
>     "name": "slovakia",
>     "keywords": ["sk", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇮",
>     "name": "slovenia",
>     "keywords": ["si", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇧",
>     "name": "solomon_islands",
>     "keywords": ["solomon", "islands", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇴",
>     "name": "somalia",
>     "keywords": ["so", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇿🇦",
>     "name": "south_africa",
>     "keywords": ["south", "africa", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇸",
>     "name": "south_georgia_south_sandwich_islands",
>     "keywords": [
>       "south",
>       "georgia",
>       "sandwich",
>       "islands",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇰🇷",
>     "name": "kr",
>     "keywords": ["south", "korea", "nation", "flag", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇸",
>     "name": "south_sudan",
>     "keywords": ["south", "sd", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇸",
>     "name": "es",
>     "keywords": ["spain", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇱🇰",
>     "name": "sri_lanka",
>     "keywords": ["sri", "lanka", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇩",
>     "name": "sudan",
>     "keywords": ["sd", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇷",
>     "name": "suriname",
>     "keywords": ["sr", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇿",
>     "name": "swaziland",
>     "keywords": ["sz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇪",
>     "name": "sweden",
>     "keywords": ["se", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇨🇭",
>     "name": "switzerland",
>     "keywords": ["ch", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇸🇾",
>     "name": "syria",
>     "keywords": [
>       "syrian",
>       "arab",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇼",
>     "name": "taiwan",
>     "keywords": ["tw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇯",
>     "name": "tajikistan",
>     "keywords": ["tj", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇿",
>     "name": "tanzania",
>     "keywords": [
>       "tanzania, ",
>       "united",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇭",
>     "name": "thailand",
>     "keywords": ["th", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇱",
>     "name": "timor_leste",
>     "keywords": ["timor", "leste", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇬",
>     "name": "togo",
>     "keywords": ["tg", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇰",
>     "name": "tokelau",
>     "keywords": ["tk", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇴",
>     "name": "tonga",
>     "keywords": ["to", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇹",
>     "name": "trinidad_tobago",
>     "keywords": ["trinidad", "tobago", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇦",
>     "name": "tristan_da_cunha",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇳",
>     "name": "tunisia",
>     "keywords": ["tn", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇷",
>     "name": "tr",
>     "keywords": ["turkey", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇲",
>     "name": "turkmenistan",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇨",
>     "name": "turks_caicos_islands",
>     "keywords": [
>       "turks",
>       "caicos",
>       "islands",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇹🇻",
>     "name": "tuvalu",
>     "keywords": ["flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇬",
>     "name": "uganda",
>     "keywords": ["ug", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇦",
>     "name": "ukraine",
>     "keywords": ["ua", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇦🇪",
>     "name": "united_arab_emirates",
>     "keywords": [
>       "united",
>       "arab",
>       "emirates",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇬🇧",
>     "name": "uk",
>     "keywords": [
>       "united",
>       "kingdom",
>       "great",
>       "britain",
>       "northern",
>       "ireland",
>       "flag",
>       "nation",
>       "country",
>       "banner",
>       "british",
>       "UK",
>       "english",
>       "england",
>       "union jack"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🏴󠁧󠁢󠁥󠁮󠁧󠁿",
>     "name": "england",
>     "keywords": ["flag", "english"]
>   },
>   {
>     "category": "flags",
>     "char": "🏴󠁧󠁢󠁳󠁣󠁴󠁿",
>     "name": "scotland",
>     "keywords": ["flag", "scottish"]
>   },
>   {
>     "category": "flags",
>     "char": "🏴󠁧󠁢󠁷󠁬󠁳󠁿",
>     "name": "wales",
>     "keywords": ["flag", "welsh"]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇸",
>     "name": "us",
>     "keywords": [
>       "united",
>       "states",
>       "america",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇮",
>     "name": "us_virgin_islands",
>     "keywords": [
>       "virgin",
>       "islands",
>       "us",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇾",
>     "name": "uruguay",
>     "keywords": ["uy", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇿",
>     "name": "uzbekistan",
>     "keywords": ["uz", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇺",
>     "name": "vanuatu",
>     "keywords": ["vu", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇦",
>     "name": "vatican_city",
>     "keywords": ["vatican", "city", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇪",
>     "name": "venezuela",
>     "keywords": [
>       "ve",
>       "bolivarian",
>       "republic",
>       "flag",
>       "nation",
>       "country",
>       "banner"
>     ]
>   },
>   {
>     "category": "flags",
>     "char": "🇻🇳",
>     "name": "vietnam",
>     "keywords": ["viet", "nam", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇼🇫",
>     "name": "wallis_futuna",
>     "keywords": ["wallis", "futuna", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇪🇭",
>     "name": "western_sahara",
>     "keywords": ["western", "sahara", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇾🇪",
>     "name": "yemen",
>     "keywords": ["ye", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇿🇲",
>     "name": "zambia",
>     "keywords": ["zm", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇿🇼",
>     "name": "zimbabwe",
>     "keywords": ["zw", "flag", "nation", "country", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🇺🇳",
>     "name": "united_nations",
>     "keywords": ["un", "flag", "banner"]
>   },
>   {
>     "category": "flags",
>     "char": "🏴‍☠️",
>     "name": "pirate_flag",
>     "keywords": ["skull", "crossbones", "flag", "banner"]
>   }
1785d11984
< 
diff --color=auto -r misskeyV13/packages/frontend/src/events.ts RiricaV13/events.ts
1c1
< import { EventEmitter } from 'eventemitter3';
---
> import { EventEmitter } from "eventemitter3";
diff --color=auto -r misskeyV13/packages/frontend/src/filters/bytes.ts RiricaV13/filters/bytes.ts
2,8c2,12
< 	if (v == null) return '?';
< 	const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
< 	if (v === 0) return '0';
< 	const isMinus = v < 0;
< 	if (isMinus) v = -v;
< 	const i = Math.floor(Math.log(v) / Math.log(1024));
< 	return (isMinus ? '-' : '') + (v / Math.pow(1024, i)).toFixed(digits).replace(/\.0+$/, '') + sizes[i];
---
>   if (v == null) return "?";
>   const sizes = ["B", "KB", "MB", "GB", "TB"];
>   if (v === 0) return "0";
>   const isMinus = v < 0;
>   if (isMinus) v = -v;
>   const i = Math.floor(Math.log(v) / Math.log(1024));
>   return (
>     (isMinus ? "-" : "") +
>     (v / Math.pow(1024, i)).toFixed(digits).replace(/\.0+$/, "") +
>     sizes[i]
>   );
Only in misskeyV13/packages/frontend/src/filters: date.ts
diff --color=auto -r misskeyV13/packages/frontend/src/filters/note.ts RiricaV13/filters/note.ts
1,2c1,2
< export const notePage = note => {
< 	return `/notes/${note.id}`;
---
> export const notePage = (note) => {
>   return `/notes/${note.id}`;
diff --color=auto -r misskeyV13/packages/frontend/src/filters/number.ts RiricaV13/filters/number.ts
1,3c1
< import { numberFormat } from '@/scripts/intl-const';
< 
< export default n => n == null ? 'N/A' : numberFormat.format(n);
---
> export default (n) => (n == null ? "N/A" : n.toLocaleString());
diff --color=auto -r misskeyV13/packages/frontend/src/filters/user.ts RiricaV13/filters/user.ts
1,3c1,3
< import * as misskey from 'misskey-js';
< import * as Acct from 'misskey-js/built/acct';
< import { url } from '@/config';
---
> import * as misskey from "misskey-js";
> import * as Acct from "misskey-js/built/acct";
> import { url } from "@/config";
6c6
< 	return Acct.toString(user);
---
>   return Acct.toString(user);
10c10
< 	return user.name || user.username;
---
>   return user.name || user.username;
14c14
< 	return `${absolute ? url : ''}/@${acct(user)}${(path ? `/${path}` : '')}`;
---
>   return `${absolute ? url : ""}/@${acct(user)}${path ? `/${path}` : ""}`;
diff --color=auto -r misskeyV13/packages/frontend/src/i18n.ts RiricaV13/i18n.ts
1,3c1,26
< import { markRaw } from 'vue';
< import { locale } from '@/config';
< import { I18n } from '@/scripts/i18n';
---
> import { I18n } from "@/scripts/i18n";
> import arSA from "@/locales/ar-SA.json";
> import csCZ from "@/locales/cs-CZ.json";
> import daDK from "@/locales/da-DK.json";
> import deDE from "@/locales/de-DE.json";
> import enUS from "@/locales/en-US.json";
> import esES from "@/locales/es-ES.json";
> import frFR from "@/locales/fr-FR.json";
> import idID from "@/locales/id-ID.json";
> import itIT from "@/locales/it-IT.json";
> import jaJP from "@/locales/ja-JP.json";
> import jaKS from "@/locales/ja-KS.json";
> import kabKAB from "@/locales/kab-KAB.json";
> import knIN from "@/locales/kn-IN.json";
> import koKR from "@/locales/ko-KR.json";
> import nlNL from "@/locales/nl-NL.json";
> import noNO from "@/locales/no-NO.json";
> import plPL from "@/locales/pl-PL.json";
> import ptPT from "@/locales/pt-PT.json";
> import ruRU from "@/locales/ru-RU.json";
> import skSK from "@/locales/sk-SK.json";
> import ugCN from "@/locales/ug-CN.json";
> import ukUA from "@/locales/uk-UA.json";
> import viVN from "@/locales/vi-VN.json";
> import zhCN from "@/locales/zh-CN.json";
> import zhTW from "@/locales/zh-TW.json";
5c28
< export const i18n = markRaw(new I18n(locale));
---
> import Fuse from "fuse.js";
7,8c30,69
< export function updateI18n(newLocale) {
< 	i18n.ts = newLocale;
---
> const languages = {
>   "ar-SA": arSA,
>   "cs-CZ": csCZ,
>   "da-DK": daDK,
>   "de-DE": deDE,
>   "en-US": enUS,
>   "es-ES": esES,
>   "fr-FR": frFR,
>   "id-ID": idID,
>   "it-IT": itIT,
>   "ja-JP": jaJP,
>   "ja-KS": jaKS,
>   "kab-KAB": kabKAB,
>   "kn-IN": knIN,
>   "ko-KR": koKR,
>   "nl-NL": nlNL,
>   "no-NO": noNO,
>   "pl-PL": plPL,
>   "pt-PT": ptPT,
>   "ru-RU": ruRU,
>   "sk-SK": skSK,
>   "ug-CN": ugCN,
>   "uk-UA": ukUA,
>   "vi-VN": viVN,
>   "zh-CN": zhCN,
>   "zh-TW": zhTW,
> } as const;
> 
> export let langNames =  Object.keys(languages).map(l => {
>   return [l,  languages[l]._lang_]
> })
> 
> export function setLanguage(lang: keyof typeof languages) {
>   if (Object.keys(languages).includes(lang)) {
>     i18n = new I18n(languages[lang]);
>   } else {
>     const fuse = new Fuse(Object.keys(languages));
>     const results = fuse.search(lang);
>     i18n = new I18n(languages[results[0].item]);
>   }
9a71
> export let i18n = new I18n(languages["ja-JP"]);
Only in misskeyV13/packages/frontend/src: init.ts
diff --color=auto -r misskeyV13/packages/frontend/src/instance.ts RiricaV13/instance.ts
1,4c1,3
< import { computed, reactive } from 'vue';
< import * as Misskey from 'misskey-js';
< import { api } from './os';
< import { miLocalStorage } from './local-storage';
---
> import { computed, reactive } from "vue";
> import * as Misskey from "misskey-js";
> import { api, noCredentialApi } from "./os";
8c7
< const cached = miLocalStorage.getItem('instance');
---
> const instanceData = localStorage.getItem("instance");
12,14c11,17
< export const instance: Misskey.entities.InstanceMetadata = reactive(cached ? JSON.parse(cached) : {
< 	// TODO: set default values
< });
---
> export const instance: Misskey.entities.InstanceMetadata = reactive(
>   instanceData
>     ? JSON.parse(instanceData)
>     : {
>         // TODO: set default values
>       }
> );
17,19c20,22
< 	const meta = await api('meta', {
< 		detail: false,
< 	});
---
>   const meta = await noCredentialApi.request("meta", {
>     detail: false,
>   });
21,23c24,26
< 	for (const [k, v] of Object.entries(meta)) {
< 		instance[k] = v;
< 	}
---
>   for (const [k, v] of Object.entries(meta)) {
>     instance[k] = v;
>   }
25c28,55
< 	miLocalStorage.setItem('instance', JSON.stringify(instance));
---
>   localStorage.setItem("instance", JSON.stringify(instance));
> }
> 
> export const emojiCategories = computed(() => {
>   if (instance.emojis == null) return [];
>   const categories = new Set();
>   for (const emoji of instance.emojis) {
>     categories.add(emoji.category);
>   }
>   return Array.from(categories);
> });
> 
> export const emojiTags = computed(() => {
>   if (instance.emojis == null) return [];
>   const tags = new Set();
>   for (const emoji of instance.emojis) {
>     for (const tag of emoji.aliases) {
>       tags.add(tag);
>     }
>   }
>   return Array.from(tags);
> });
> 
> // このファイルに書きたくないけどここに書かないと何故かVeturが認識しない
> declare module "@vue/runtime-core" {
>   interface ComponentCustomProperties {
>     $instance: typeof instance;
>   }
Only in misskeyV13/packages/frontend/src: local-storage.ts
Only in RiricaV13: locales
Only in RiricaV13: main.ts
diff --color=auto -r misskeyV13/packages/frontend/src/navbar.ts RiricaV13/navbar.ts
1,8c1,7
< import { computed, ref, reactive } from 'vue';
< import { $i } from './account';
< import { miLocalStorage } from './local-storage';
< import { search } from '@/scripts/search';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { ui } from '@/config';
< import { unisonReload } from '@/scripts/unison-reload';
---
> import { computed, ref, reactive } from "vue";
> import { $i } from "./account";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { ui } from "@/config";
> import { unisonReload } from "@/scripts/unison-reload";
11,60c10,59
< 	notifications: {
< 		title: i18n.ts.notifications,
< 		icon: 'ti ti-bell',
< 		show: computed(() => $i != null),
< 		indicated: computed(() => $i != null && $i.hasUnreadNotification),
< 		to: '/my/notifications',
< 	},
< 	messaging: {
< 		title: i18n.ts.messaging,
< 		icon: 'ti ti-messages',
< 		show: computed(() => $i != null),
< 		indicated: computed(() => $i != null && $i.hasUnreadMessagingMessage),
< 		to: '/my/messaging',
< 	},
< 	drive: {
< 		title: i18n.ts.drive,
< 		icon: 'ti ti-cloud',
< 		show: computed(() => $i != null),
< 		to: '/my/drive',
< 	},
< 	followRequests: {
< 		title: i18n.ts.followRequests,
< 		icon: 'ti ti-user-plus',
< 		show: computed(() => $i != null && $i.isLocked),
< 		indicated: computed(() => $i != null && $i.hasPendingReceivedFollowRequest),
< 		to: '/my/follow-requests',
< 	},
< 	explore: {
< 		title: i18n.ts.explore,
< 		icon: 'ti ti-hash',
< 		to: '/explore',
< 	},
< 	announcements: {
< 		title: i18n.ts.announcements,
< 		icon: 'ti ti-speakerphone',
< 		indicated: computed(() => $i != null && $i.hasUnreadAnnouncement),
< 		to: '/announcements',
< 	},
< 	search: {
< 		title: i18n.ts.search,
< 		icon: 'ti ti-search',
< 		action: () => search(),
< 	},
< 	lists: {
< 		title: i18n.ts.lists,
< 		icon: 'ti ti-list',
< 		show: computed(() => $i != null),
< 		to: '/my/lists',
< 	},
< 	/*
---
>   notifications: {
>     title: "notifications",
>     icon: "fas fa-bell",
>     show: computed(() => $i != null),
>     indicated: computed(() => $i != null && $i.hasUnreadNotification),
>     to: "/my/notifications",
>   },
>   messaging: {
>     title: "messaging",
>     icon: "fas fa-comments",
>     show: computed(() => $i != null),
>     indicated: computed(() => $i != null && $i.hasUnreadMessagingMessage),
>     to: "/my/messaging",
>   },
>   drive: {
>     title: "drive",
>     icon: "fas fa-cloud",
>     show: computed(() => $i != null),
>     to: "/my/drive",
>   },
>   followRequests: {
>     title: "followRequests",
>     icon: "fas fa-user-clock",
>     show: computed(() => $i != null && $i.isLocked),
>     indicated: computed(() => $i != null && $i.hasPendingReceivedFollowRequest),
>     to: "/my/follow-requests",
>   },
>   explore: {
>     title: "explore",
>     icon: "fas fa-hashtag",
>     to: "/explore",
>   },
>   announcements: {
>     title: "announcements",
>     icon: "fas fa-broadcast-tower",
>     indicated: computed(() => $i != null && $i.hasUnreadAnnouncement),
>     to: "/announcements",
>   },
>   search: {
>     title: "search",
>     icon: "fas fa-search",
>     action: () => search(),
>   },
>   lists: {
>     title: "lists",
>     icon: "fas fa-list-ul",
>     show: computed(() => $i != null),
>     to: "/my/lists",
>   },
>   /*
62,63c61,62
< 		title: i18n.ts.groups,
< 		icon: 'ti ti-users',
---
> 		title: 'groups',
> 		icon: 'fas fa-users',
68,146c67,141
< 	antennas: {
< 		title: i18n.ts.antennas,
< 		icon: 'ti ti-antenna',
< 		show: computed(() => $i != null),
< 		to: '/my/antennas',
< 	},
< 	favorites: {
< 		title: i18n.ts.favorites,
< 		icon: 'ti ti-star',
< 		show: computed(() => $i != null),
< 		to: '/my/favorites',
< 	},
< 	pages: {
< 		title: i18n.ts.pages,
< 		icon: 'ti ti-news',
< 		to: '/pages',
< 	},
< 	play: {
< 		title: 'Play',
< 		icon: 'ti ti-player-play',
< 		to: '/play',
< 	},
< 	gallery: {
< 		title: i18n.ts.gallery,
< 		icon: 'ti ti-icons',
< 		to: '/gallery',
< 	},
< 	clips: {
< 		title: i18n.ts.clip,
< 		icon: 'ti ti-paperclip',
< 		show: computed(() => $i != null),
< 		to: '/my/clips',
< 	},
< 	channels: {
< 		title: i18n.ts.channel,
< 		icon: 'ti ti-device-tv',
< 		to: '/channels',
< 	},
< 	achievements: {
< 		title: i18n.ts.achievements,
< 		icon: 'ti ti-medal',
< 		show: computed(() => $i != null),
< 		to: '/my/achievements',
< 	},
< 	ui: {
< 		title: i18n.ts.switchUi,
< 		icon: 'ti ti-devices',
< 		action: (ev) => {
< 			os.popupMenu([{
< 				text: i18n.ts.default,
< 				active: ui === 'default' || ui === null,
< 				action: () => {
< 					miLocalStorage.setItem('ui', 'default');
< 					unisonReload();
< 				},
< 			}, {
< 				text: i18n.ts.deck,
< 				active: ui === 'deck',
< 				action: () => {
< 					miLocalStorage.setItem('ui', 'deck');
< 					unisonReload();
< 				},
< 			}, {
< 				text: i18n.ts.classic,
< 				active: ui === 'classic',
< 				action: () => {
< 					miLocalStorage.setItem('ui', 'classic');
< 					unisonReload();
< 				},
< 			}], ev.currentTarget ?? ev.target);
< 		},
< 	},
< 	reload: {
< 		title: i18n.ts.reload,
< 		icon: 'ti ti-refresh',
< 		action: (ev) => {
< 			location.reload();
< 		},
< 	},
---
>   antennas: {
>     title: "antennas",
>     icon: "fas fa-satellite",
>     show: computed(() => $i != null),
>     to: "/my/antennas",
>   },
>   favorites: {
>     title: "favorites",
>     icon: "fas fa-star",
>     show: computed(() => $i != null),
>     to: "/my/favorites",
>   },
>   pages: {
>     title: "pages",
>     icon: "fas fa-file-alt",
>     to: "/pages",
>   },
>   gallery: {
>     title: "gallery",
>     icon: "fas fa-icons",
>     to: "/gallery",
>   },
>   clips: {
>     title: "clip",
>     icon: "fas fa-paperclip",
>     show: computed(() => $i != null),
>     to: "/my/clips",
>   },
>   channels: {
>     title: "channel",
>     icon: "fas fa-satellite-dish",
>     to: "/channels",
>   },
>   ui: {
>     title: "switchUi",
>     icon: "fas fa-columns",
>     action: (ev) => {
>       os.popupMenu(
>         [
>           {
>             text: i18n.ts.default,
>             active: ui === "default" || ui === null,
>             action: () => {
>               localStorage.setItem("ui", "default");
>               unisonReload();
>             },
>           },
>           {
>             text: i18n.ts.deck,
>             active: ui === "deck",
>             action: () => {
>               localStorage.setItem("ui", "deck");
>               unisonReload();
>             },
>           },
>           {
>             text: i18n.ts.classic,
>             active: ui === "classic",
>             action: () => {
>               localStorage.setItem("ui", "classic");
>               unisonReload();
>             },
>           },
>         ],
>         ev.currentTarget ?? ev.target
>       );
>     },
>   },
>   reload: {
>     title: "reload",
>     icon: "fas fa-refresh",
>     action: (ev) => {
>       location.reload();
>     },
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/nirax.ts RiricaV13/nirax.ts
3,6c3,6
< import { EventEmitter } from 'eventemitter3';
< import { Ref, Component, ref, shallowRef, ShallowRef } from 'vue';
< import { pleaseLogin } from '@/scripts/please-login';
< import { safeURIDecode } from '@/scripts/safe-uri-decode';
---
> import { EventEmitter } from "eventemitter3";
> import { Ref, Component, ref, shallowRef, ShallowRef } from "vue";
> import { pleaseLogin } from "@/scripts/please-login";
> import { safeURIDecode } from "@/scripts/safe-uri-decode";
9,16c9,16
< 	path: string;
< 	component: Component;
< 	query?: Record<string, string>;
< 	loginRequired?: boolean;
< 	name?: string;
< 	hash?: string;
< 	globalCacheKey?: string;
< 	children?: RouteDef[];
---
>   path: string;
>   component: Component;
>   query?: Record<string, string>;
>   loginRequired?: boolean;
>   name?: string;
>   hash?: string;
>   globalCacheKey?: string;
>   children?: RouteDef[];
19,24c19,27
< type ParsedPath = (string | {
< 	name: string;
< 	startsWith?: string;
< 	wildcard?: boolean;
< 	optional?: boolean;
< })[];
---
> type ParsedPath = (
>   | string
>   | {
>       name: string;
>       startsWith?: string;
>       wildcard?: boolean;
>       optional?: boolean;
>     }
> )[];
26c29,33
< export type Resolved = { route: RouteDef; props: Map<string, string>; child?: Resolved; };
---
> export type Resolved = {
>   route: RouteDef;
>   props: Map<string, string>;
>   child?: Resolved;
> };
29c36
< 	const res = [] as ParsedPath;
---
>   const res = [] as ParsedPath;
31c38
< 	path = path.substring(1);
---
>   path = path.substring(1);
33,48c40,55
< 	for (const part of path.split('/')) {
< 		if (part.includes(':')) {
< 			const prefix = part.substring(0, part.indexOf(':'));
< 			const placeholder = part.substring(part.indexOf(':') + 1);
< 			const wildcard = placeholder.includes('(*)');
< 			const optional = placeholder.endsWith('?');
< 			res.push({
< 				name: placeholder.replace('(*)', '').replace('?', ''),
< 				startsWith: prefix !== '' ? prefix : undefined,
< 				wildcard,
< 				optional,
< 			});
< 		} else if (part.length !== 0) {
< 			res.push(part);
< 		}
< 	}
---
>   for (const part of path.split("/")) {
>     if (part.includes(":")) {
>       const prefix = part.substring(0, part.indexOf(":"));
>       const placeholder = part.substring(part.indexOf(":") + 1);
>       const wildcard = placeholder.includes("(*)");
>       const optional = placeholder.endsWith("?");
>       res.push({
>         name: placeholder.replace("(*)", "").replace("?", ""),
>         startsWith: prefix !== "" ? prefix : undefined,
>         wildcard,
>         optional,
>       });
>     } else if (part.length !== 0) {
>       res.push(part);
>     }
>   }
50c57
< 	return res;
---
>   return res;
54,71c61,75
< 	change: (ctx: {
< 		beforePath: string;
< 		path: string;
< 		resolved: Resolved;
< 		key: string;
< 	}) => void;
< 	replace: (ctx: {
< 		path: string;
< 		key: string;
< 	}) => void;
< 	push: (ctx: {
< 		beforePath: string;
< 		path: string;
< 		route: RouteDef | null;
< 		props: Map<string, string> | null;
< 		key: string;
< 	}) => void;
< 	same: () => void;
---
>   change: (ctx: {
>     beforePath: string;
>     path: string;
>     resolved: Resolved;
>     key: string;
>   }) => void;
>   replace: (ctx: { path: string; key: string }) => void;
>   push: (ctx: {
>     beforePath: string;
>     path: string;
>     route: RouteDef | null;
>     props: Map<string, string> | null;
>     key: string;
>   }) => void;
>   same: () => void;
73,78c77,82
< 	private routes: RouteDef[];
< 	public current: Resolved;
< 	public currentRef: ShallowRef<Resolved> = shallowRef();
< 	public currentRoute: ShallowRef<RouteDef> = shallowRef();
< 	private currentPath: string;
< 	private currentKey = Date.now().toString();
---
>   private routes: RouteDef[];
>   public current: Resolved;
>   public currentRef: ShallowRef<Resolved> = shallowRef();
>   public currentRoute: ShallowRef<RouteDef> = shallowRef();
>   private currentPath: string;
>   private currentKey = Date.now().toString();
80c84
< 	public navHook: ((path: string, flag?: any) => boolean) | null = null;
---
>   public navHook: ((path: string, flag?: any) => boolean) | null = null;
82,83c86,87
< 	constructor(routes: Router['routes'], currentPath: Router['currentPath']) {
< 		super();
---
>   constructor(routes: Router["routes"], currentPath: Router["currentPath"]) {
>     super();
85,88c89,92
< 		this.routes = routes;
< 		this.currentPath = currentPath;
< 		this.navigate(currentPath, null, false);
< 	}
---
>     this.routes = routes;
>     this.currentPath = currentPath;
>     this.navigate(currentPath, null, false);
>   }
90,101c94,105
< 	public resolve(path: string): Resolved | null {
< 		let queryString: string | null = null;
< 		let hash: string | null = null;
< 		if (path[0] === '/') path = path.substring(1);
< 		if (path.includes('#')) {
< 			hash = path.substring(path.indexOf('#') + 1);
< 			path = path.substring(0, path.indexOf('#'));
< 		}
< 		if (path.includes('?')) {
< 			queryString = path.substring(path.indexOf('?') + 1);
< 			path = path.substring(0, path.indexOf('?'));
< 		}
---
>   public resolve(path: string): Resolved | null {
>     let queryString: string | null = null;
>     let hash: string | null = null;
>     if (path[0] === "/") path = path.substring(1);
>     if (path.includes("#")) {
>       hash = path.substring(path.indexOf("#") + 1);
>       path = path.substring(0, path.indexOf("#"));
>     }
>     if (path.includes("?")) {
>       queryString = path.substring(path.indexOf("?") + 1);
>       path = path.substring(0, path.indexOf("?"));
>     }
103c107
< 		if (_DEV_) console.log('Routing: ', path, queryString);
---
>     if (_DEV_) console.log("Routing: ", path, queryString);
105,109c109,112
< 		function check(routes: RouteDef[], _parts: string[]): Resolved | null {
< 			forEachRouteLoop:
< 			for (const route of routes) {
< 				let parts = [..._parts];
< 				const props = new Map<string, string>();
---
>     function check(routes: RouteDef[], _parts: string[]): Resolved | null {
>       forEachRouteLoop: for (const route of routes) {
>         let parts = [..._parts];
>         const props = new Map<string, string>();
111,131c114,134
< 				pathMatchLoop:
< 				for (const p of parsePath(route.path)) {
< 					if (typeof p === 'string') {
< 						if (p === parts[0]) {
< 							parts.shift();
< 						} else {
< 							continue forEachRouteLoop;
< 						}
< 					} else {
< 						if (parts[0] == null && !p.optional) {
< 							continue forEachRouteLoop;
< 						}
< 						if (p.wildcard) {
< 							if (parts.length !== 0) {
< 								props.set(p.name, safeURIDecode(parts.join('/')));
< 								parts = [];
< 							}
< 							break pathMatchLoop;
< 						} else {
< 							if (p.startsWith) {
< 								if (parts[0] == null || !parts[0].startsWith(p.startsWith)) continue forEachRouteLoop;
---
>         pathMatchLoop: for (const p of parsePath(route.path)) {
>           if (typeof p === "string") {
>             if (p === parts[0]) {
>               parts.shift();
>             } else {
>               continue forEachRouteLoop;
>             }
>           } else {
>             if (parts[0] == null && !p.optional) {
>               continue forEachRouteLoop;
>             }
>             if (p.wildcard) {
>               if (parts.length !== 0) {
>                 props.set(p.name, safeURIDecode(parts.join("/")));
>                 parts = [];
>               }
>               break pathMatchLoop;
>             } else {
>               if (p.startsWith) {
>                 if (parts[0] == null || !parts[0].startsWith(p.startsWith))
>                   continue forEachRouteLoop;
133,143c136,149
< 								props.set(p.name, safeURIDecode(parts[0].substring(p.startsWith.length)));
< 								parts.shift();
< 							} else {
< 								if (parts[0]) {
< 									props.set(p.name, safeURIDecode(parts[0]));
< 								}
< 								parts.shift();
< 							}
< 						}
< 					}
< 				}
---
>                 props.set(
>                   p.name,
>                   safeURIDecode(parts[0].substring(p.startsWith.length))
>                 );
>                 parts.shift();
>               } else {
>                 if (parts[0]) {
>                   props.set(p.name, safeURIDecode(parts[0]));
>                 }
>                 parts.shift();
>               }
>             }
>           }
>         }
145,157c151,163
< 				if (parts.length === 0) {
< 					if (route.children) {
< 						const child = check(route.children, []);
< 						if (child) {
< 							return {
< 								route,
< 								props,
< 								child,
< 							};
< 						} else {
< 							continue forEachRouteLoop;
< 						}
< 					}
---
>         if (parts.length === 0) {
>           if (route.children) {
>             const child = check(route.children, []);
>             if (child) {
>               return {
>                 route,
>                 props,
>                 child,
>               };
>             } else {
>               continue forEachRouteLoop;
>             }
>           }
159,195c165,167
< 					if (route.hash != null && hash != null) {
< 						props.set(route.hash, safeURIDecode(hash));
< 					}
< 	
< 					if (route.query != null && queryString != null) {
< 						const queryObject = [...new URLSearchParams(queryString).entries()]
< 							.reduce((obj, entry) => ({ ...obj, [entry[0]]: entry[1] }), {});
< 	
< 						for (const q in route.query) {
< 							const as = route.query[q];
< 							if (queryObject[q]) {
< 								props.set(as, safeURIDecode(queryObject[q]));
< 							}
< 						}
< 					}
< 	
< 					return {
< 						route,
< 						props,
< 					};
< 				} else {
< 					if (route.children) {
< 						const child = check(route.children, parts);
< 						if (child) {
< 							return {
< 								route,
< 								props,
< 								child,
< 							};
< 						} else {
< 							continue forEachRouteLoop;
< 						}
< 					} else {
< 						continue forEachRouteLoop;
< 					}
< 				}
< 			}
---
>           if (route.hash != null && hash != null) {
>             props.set(route.hash, safeURIDecode(hash));
>           }
197,198c169,172
< 			return null;
< 		}
---
>           if (route.query != null && queryString != null) {
>             const queryObject = [
>               ...new URLSearchParams(queryString).entries(),
>             ].reduce((obj, entry) => ({ ...obj, [entry[0]]: entry[1] }), {});
200c174,180
< 		const _parts = path.split('/').filter(part => part.length !== 0);
---
>             for (const q in route.query) {
>               const as = route.query[q];
>               if (queryObject[q]) {
>                 props.set(as, safeURIDecode(queryObject[q]));
>               }
>             }
>           }
202,203c182,202
< 		return check(this.routes, _parts);
< 	}
---
>           return {
>             route,
>             props,
>           };
>         } else {
>           if (route.children) {
>             const child = check(route.children, parts);
>             if (child) {
>               return {
>                 route,
>                 props,
>                 child,
>               };
>             } else {
>               continue forEachRouteLoop;
>             }
>           } else {
>             continue forEachRouteLoop;
>           }
>         }
>       }
205,207c204,205
< 	private navigate(path: string, key: string | null | undefined, emitChange = true) {
< 		const beforePath = this.currentPath;
< 		this.currentPath = path;
---
>       return null;
>     }
209c207
< 		const res = this.resolve(this.currentPath);
---
>     const _parts = path.split("/").filter((part) => part.length !== 0);
211,213c209,210
< 		if (res == null) {
< 			throw new Error('no route found for: ' + path);
< 		}
---
>     return check(this.routes, _parts);
>   }
215,217c212,218
< 		if (res.route.loginRequired) {
< 			pleaseLogin('/');
< 		}
---
>   private navigate(
>     path: string,
>     key: string | null | undefined,
>     emitChange = true
>   ) {
>     const beforePath = this.currentPath;
>     this.currentPath = path;
219,224c220
< 		const isSamePath = beforePath === path;
< 		if (isSamePath && key == null) key = this.currentKey;
< 		this.current = res;
< 		this.currentRef.value = res;
< 		this.currentRoute.value = res.route;
< 		this.currentKey = res.route.globalCacheKey ?? key ?? path;
---
>     const res = this.resolve(this.currentPath);
226,233c222,224
< 		if (emitChange) {
< 			this.emit('change', {
< 				beforePath,
< 				path,
< 				resolved: res,
< 				key: this.currentKey,
< 			});
< 		}
---
>     if (res == null) {
>       throw new Error("no route found for: " + path);
>     }
235,236c226,228
< 		return res;
< 	}
---
>     if (res.route.loginRequired) {
>       pleaseLogin("/");
>     }
238,240c230,235
< 	public getCurrentPath() {
< 		return this.currentPath;
< 	}
---
>     const isSamePath = beforePath === path;
>     if (isSamePath && key == null) key = this.currentKey;
>     this.current = res;
>     this.currentRef.value = res;
>     this.currentRoute.value = res.route;
>     this.currentKey = res.route.globalCacheKey ?? key ?? path;
242,244c237,244
< 	public getCurrentKey() {
< 		return this.currentKey;
< 	}
---
>     if (emitChange) {
>       this.emit("change", {
>         beforePath,
>         path,
>         resolved: res,
>         key: this.currentKey,
>       });
>     }
246,264c246,247
< 	public push(path: string, flag?: any) {
< 		const beforePath = this.currentPath;
< 		if (path === beforePath) {
< 			this.emit('same');
< 			return;
< 		}
< 		if (this.navHook) {
< 			const cancel = this.navHook(path, flag);
< 			if (cancel) return;
< 		}
< 		const res = this.navigate(path, null);
< 		this.emit('push', {
< 			beforePath,
< 			path,
< 			route: res.route,
< 			props: res.props,
< 			key: this.currentKey,
< 		});
< 	}
---
>     return res;
>   }
266,274c249,285
< 	public replace(path: string, key?: string | null, emitEvent = true) {
< 		this.navigate(path, key);
< 		if (emitEvent) {
< 			this.emit('replace', {
< 				path,
< 				key: this.currentKey,
< 			});
< 		}
< 	}
---
>   public getCurrentPath() {
>     return this.currentPath;
>   }
> 
>   public getCurrentKey() {
>     return this.currentKey;
>   }
> 
>   public push(path: string, flag?: any) {
>     const beforePath = this.currentPath;
>     if (path === beforePath) {
>       this.emit("same");
>       return;
>     }
>     if (this.navHook) {
>       const cancel = this.navHook(path, flag);
>       if (cancel) return;
>     }
>     const res = this.navigate(path, null);
>     this.emit("push", {
>       beforePath,
>       path,
>       route: res.route,
>       props: res.props,
>       key: this.currentKey,
>     });
>   }
> 
>   public replace(path: string, key?: string | null, emitEvent = true) {
>     this.navigate(path, key);
>     if (emitEvent) {
>       this.emit("replace", {
>         path,
>         key: this.currentKey,
>       });
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/os.ts RiricaV13/os.ts
3,19c3,12
< import { pendingApiRequestsCount, api, apiGet } from '@/scripts/api';
< export { pendingApiRequestsCount, api, apiGet };
< import { Component, markRaw, Ref, ref, defineAsyncComponent } from 'vue';
< import { EventEmitter } from 'eventemitter3';
< import insertTextAtCursor from 'insert-text-at-cursor';
< import * as Misskey from 'misskey-js';
< import { i18n } from './i18n';
< import MkPostFormDialog from '@/components/MkPostFormDialog.vue';
< import MkWaitingDialog from '@/components/MkWaitingDialog.vue';
< import MkPageWindow from '@/components/MkPageWindow.vue';
< import MkToast from '@/components/MkToast.vue';
< import MkDialog from '@/components/MkDialog.vue';
< import MkEmojiPickerDialog from '@/components/MkEmojiPickerDialog.vue';
< import MkEmojiPickerWindow from '@/components/MkEmojiPickerWindow.vue';
< import MkPopupMenu from '@/components/MkPopupMenu.vue';
< import MkContextMenu from '@/components/MkContextMenu.vue';
< import { MenuItem } from '@/types/menu';
---
> import { Component, markRaw, Ref, ref, defineAsyncComponent } from "vue";
> import { EventEmitter } from "eventemitter3";
> import insertTextAtCursor from "insert-text-at-cursor";
> import * as Misskey from "misskey-js";
> import MkPostFormDialog from "@/components/MkPostFormDialog.vue";
> import MkWaitingDialog from "@/components/MkWaitingDialog.vue";
> import { MenuItem } from "@/types/menu";
> import { $i } from "@/account";
> import { Endpoints } from "misskey-js";
> import { get } from "@/scripts/idb-proxy";
21c14
< export const openingWindowsCount = ref(0);
---
> export const pendingApiRequestsCount = ref(0);
22a16,60
> const apiClient = new Misskey.api.APIClient({
>   origin: $i?.instanceUrl,
>   credential: $i?.token,
> });
> 
> 
> export const noCredentialApi = new Misskey.api.APIClient({
>   origin: $i?.instanceUrl || window.location.origin,
> });
> 
> export const api = ((
>   endpoint: keyof Endpoints,
>   data: Record<string, any> = {}
> ) => {
>   return apiClient.request(endpoint, data);
> }) as typeof apiClient.request;
> 
> export const apiGet = ((
>   endpoint: keyof Endpoints,
>   data: Record<string, any> = {}
> ) => {
>   pendingApiRequestsCount.value++;
> 
>   const onFinally = () => {
>     pendingApiRequestsCount.value--;
>   };
> 
>   const query = new URLSearchParams(data);
> 
>   const promise = new Promise((resolve, reject) => {
>     // Send request
>     apiClient
>       .request(endpoint, { ...data })
>       .then(async (res) => {
>         resolve(res);
> 
>       })
>       .catch(reject);
>   });
> 
>   promise.then(onFinally, onFinally);
> 
>   return promise;
> }) as typeof apiClient.request;
> 
24,26c62,64
< 	endpoint: string,
< 	data: Record<string, any> = {},
< 	token?: string | null | undefined,
---
>   endpoint: keyof Endpoints,
>   data: Record<string, any> = {},
>   token?: string | null | undefined
28,44c66,72
< 	const promise = api(endpoint, data, token);
< 	promiseDialog(promise, null, (err) => {
< 		let title = null;
< 		let text = err.message + '\n' + (err as any).id;
< 		if (err.code === 'RATE_LIMIT_EXCEEDED') {
< 			title = i18n.ts.cannotPerformTemporary;
< 			text = i18n.ts.cannotPerformTemporaryDescription;
< 		} else if (err.code.startsWith('TOO_MANY')) {
< 			title = i18n.ts.youCannotCreateAnymore;
< 			text = `${i18n.ts.error}: ${err.id}`;
< 		}
< 		alert({
< 			type: 'error',
< 			title,
< 			text,
< 		});
< 	});
---
>   const promise = api(endpoint, data, token);
>   promiseDialog(promise, null, (err) => {
>     alert({
>       type: "error",
>       text: err.message + "\n" + (err as any).id,
>     });
>   });
46c74
< 	return promise;
---
>   return promise;
50,53c78,81
< 	promise: T,
< 	onSuccess?: ((res: any) => void) | null,
< 	onFailure?: ((err: Error) => void) | null,
< 	text?: string,
---
>   promise: T,
>   onSuccess?: ((res: any) => void) | null,
>   onFailure?: ((err: Error) => void) | null,
>   text?: string
55,56c83,84
< 	const showing = ref(true);
< 	const success = ref(false);
---
>   const showing = ref(true);
>   const success = ref(false);
58,78c86,108
< 	promise.then(res => {
< 		if (onSuccess) {
< 			showing.value = false;
< 			onSuccess(res);
< 		} else {
< 			success.value = true;
< 			window.setTimeout(() => {
< 				showing.value = false;
< 			}, 1000);
< 		}
< 	}).catch(err => {
< 		showing.value = false;
< 		if (onFailure) {
< 			onFailure(err);
< 		} else {
< 			alert({
< 				type: 'error',
< 				text: err,
< 			});
< 		}
< 	});
---
>   promise
>     .then((res) => {
>       if (onSuccess) {
>         showing.value = false;
>         onSuccess(res);
>       } else {
>         success.value = true;
>         window.setTimeout(() => {
>           showing.value = false;
>         }, 1000);
>       }
>     })
>     .catch((err) => {
>       showing.value = false;
>       if (onFailure) {
>         onFailure(err);
>       } else {
>         alert({
>           type: "error",
>           text: err,
>         });
>       }
>     });
80,85c110,120
< 	// NOTE: dynamic importすると挙動がおかしくなる(showingの変更が伝播しない)
< 	popup(MkWaitingDialog, {
< 		success: success,
< 		showing: showing,
< 		text: text,
< 	}, {}, 'closed');
---
>   // NOTE: dynamic importすると挙動がおかしくなる(showingの変更が伝播しない)
>   popup(
>     MkWaitingDialog,
>     {
>       success: success,
>       showing: showing,
>       text: text,
>     },
>     {},
>     "closed"
>   );
87c122
< 	return promise;
---
>   return promise;
91,95c126,132
< export const popups = ref([]) as Ref<{
< 	id: any;
< 	component: any;
< 	props: Record<string, any>;
< }[]>;
---
> export const popups = ref([]) as Ref<
>   {
>     id: any;
>     component: any;
>     props: Record<string, any>;
>   }[]
> >;
98,101c135,137
< 	veryLow: 500000,
< 	low: 1000000,
< 	middle: 2000000,
< 	high: 3000000,
---
>   low: 1000000,
>   middle: 2000000,
>   high: 3000000,
103,105c139,143
< export function claimZIndex(priority: keyof typeof zIndexes = 'low'): number {
< 	zIndexes[priority] += 100;
< 	return zIndexes[priority];
---
> export function claimZIndex(
>   priority: "low" | "middle" | "high" = "low"
> ): number {
>   zIndexes[priority] += 100;
>   return zIndexes[priority];
108,109c146,152
< export async function popup(component: Component, props: Record<string, any>, events = {}, disposeEvent?: string) {
< 	markRaw(component);
---
> export async function popup(
>   component: Component,
>   props: Record<string, any>,
>   events = {},
>   disposeEvent?: string
> ) {
>   markRaw(component);
111,126c154,171
< 	const id = ++popupIdCount;
< 	const dispose = () => {
< 		// このsetTimeoutが無いと挙動がおかしくなる(autocompleteが閉じなくなる)。Vueのバグ？
< 		window.setTimeout(() => {
< 			popups.value = popups.value.filter(popup => popup.id !== id);
< 		}, 0);
< 	};
< 	const state = {
< 		component,
< 		props,
< 		events: disposeEvent ? {
< 			...events,
< 			[disposeEvent]: dispose,
< 		} : events,
< 		id,
< 	};
---
>   const id = ++popupIdCount;
>   const dispose = () => {
>     // このsetTimeoutが無いと挙動がおかしくなる(autocompleteが閉じなくなる)。Vueのバグ？
>     window.setTimeout(() => {
>       popups.value = popups.value.filter((popup) => popup.id !== id);
>     }, 0);
>   };
>   const state = {
>     component,
>     props,
>     events: disposeEvent
>       ? {
>           ...events,
>           [disposeEvent]: dispose,
>         }
>       : events,
>     id,
>   };
128c173
< 	popups.value.push(state);
---
>   popups.value.push(state);
130,132c175,177
< 	return {
< 		dispose,
< 	};
---
>   return {
>     dispose,
>   };
136,138c181,188
< 	popup(MkPageWindow, {
< 		initialPath: path,
< 	}, {}, 'closed');
---
>   popup(
>     defineAsyncComponent(() => import("@/components/MkPageWindow.vue")),
>     {
>       initialPath: path,
>     },
>     {},
>     "closed"
>   );
142,144c192,199
< 	popup(defineAsyncComponent(() => import('@/components/MkModalPageWindow.vue')), {
< 		initialPath: path,
< 	}, {}, 'closed');
---
>   popup(
>     defineAsyncComponent(() => import("@/components/MkModalPageWindow.vue")),
>     {
>       initialPath: path,
>     },
>     {},
>     "closed"
>   );
148,150c203,210
< 	popup(MkToast, {
< 		message,
< 	}, {}, 'closed');
---
>   popup(
>     defineAsyncComponent(() => import("@/components/MkToast.vue")),
>     {
>       message,
>     },
>     {},
>     "closed"
>   );
154,156c214,216
< 	type?: 'error' | 'info' | 'success' | 'warning' | 'waiting' | 'question';
< 	title?: string | null;
< 	text?: string | null;
---
>   type?: "error" | "info" | "success" | "warning" | "waiting" | "question";
>   title?: string | null;
>   text?: string | null;
158,164c218,229
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, props, {
< 			done: result => {
< 				resolve();
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       props,
>       {
>         done: (result) => {
>           resolve();
>         },
>       },
>       "closed"
>     );
>   });
168,170c233,235
< 	type: 'error' | 'info' | 'success' | 'warning' | 'waiting' | 'question';
< 	title?: string | null;
< 	text?: string | null;
---
>   type: "error" | "info" | "success" | "warning" | "waiting" | "question";
>   title?: string | null;
>   text?: string | null;
172,181c237,251
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, {
< 			...props,
< 			showCancelButton: true,
< 		}, {
< 			done: result => {
< 				resolve(result ? result : { canceled: true });
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       {
>         ...props,
>         showCancelButton: true,
>       },
>       {
>         done: (result) => {
>           resolve(result ? result : { canceled: true });
>         },
>       },
>       "closed"
>     );
>   });
185,207c255,286
< 	type?: 'text' | 'email' | 'password' | 'url';
< 	title?: string | null;
< 	text?: string | null;
< 	placeholder?: string | null;
< 	default?: string | null;
< }): Promise<{ canceled: true; result: undefined; } | {
< 	canceled: false; result: string;
< }> {
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, {
< 			title: props.title,
< 			text: props.text,
< 			input: {
< 				type: props.type,
< 				placeholder: props.placeholder,
< 				default: props.default,
< 			},
< 		}, {
< 			done: result => {
< 				resolve(result ? result : { canceled: true });
< 			},
< 		}, 'closed');
< 	});
---
>   type?: "text" | "email" | "password" | "url";
>   title?: string | null;
>   text?: string | null;
>   placeholder?: string | null;
>   default?: string | null;
> }): Promise<
>   | { canceled: true; result: undefined }
>   | {
>       canceled: false;
>       result: string;
>     }
> > {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       {
>         title: props.title,
>         text: props.text,
>         input: {
>           type: props.type,
>           placeholder: props.placeholder,
>           default: props.default,
>         },
>       },
>       {
>         done: (result) => {
>           resolve(result ? result : { canceled: true });
>         },
>       },
>       "closed"
>     );
>   });
211,232c290,320
< 	title?: string | null;
< 	text?: string | null;
< 	placeholder?: string | null;
< 	default?: number | null;
< }): Promise<{ canceled: true; result: undefined; } | {
< 	canceled: false; result: number;
< }> {
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, {
< 			title: props.title,
< 			text: props.text,
< 			input: {
< 				type: 'number',
< 				placeholder: props.placeholder,
< 				default: props.default,
< 			},
< 		}, {
< 			done: result => {
< 				resolve(result ? result : { canceled: true });
< 			},
< 		}, 'closed');
< 	});
---
>   title?: string | null;
>   text?: string | null;
>   placeholder?: string | null;
>   default?: number | null;
> }): Promise<
>   | { canceled: true; result: undefined }
>   | {
>       canceled: false;
>       result: number;
>     }
> > {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       {
>         title: props.title,
>         text: props.text,
>         input: {
>           type: "number",
>           placeholder: props.placeholder,
>           default: props.default,
>         },
>       },
>       {
>         done: (result) => {
>           resolve(result ? result : { canceled: true });
>         },
>       },
>       "closed"
>     );
>   });
236,257c324,358
< 	title?: string | null;
< 	text?: string | null;
< 	placeholder?: string | null;
< 	default?: Date | null;
< }): Promise<{ canceled: true; result: undefined; } | {
< 	canceled: false; result: Date;
< }> {
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, {
< 			title: props.title,
< 			text: props.text,
< 			input: {
< 				type: 'date',
< 				placeholder: props.placeholder,
< 				default: props.default,
< 			},
< 		}, {
< 			done: result => {
< 				resolve(result ? { result: new Date(result.result), canceled: false } : { canceled: true });
< 			},
< 		}, 'closed');
< 	});
---
>   title?: string | null;
>   text?: string | null;
>   placeholder?: string | null;
>   default?: Date | null;
> }): Promise<
>   | { canceled: true; result: undefined }
>   | {
>       canceled: false;
>       result: Date;
>     }
> > {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       {
>         title: props.title,
>         text: props.text,
>         input: {
>           type: "date",
>           placeholder: props.placeholder,
>           default: props.default,
>         },
>       },
>       {
>         done: (result) => {
>           resolve(
>             result
>               ? { result: new Date(result.result), canceled: false }
>               : { canceled: true }
>           );
>         },
>       },
>       "closed"
>     );
>   });
260,294c361,409
< export function select<C = any>(props: {
< 	title?: string | null;
< 	text?: string | null;
< 	default?: string | null;
< } & ({
< 	items: {
< 		value: C;
< 		text: string;
< 	}[];
< } | {
< 	groupedItems: {
< 		label: string;
< 		items: {
< 			value: C;
< 			text: string;
< 		}[];
< 	}[];
< })): Promise<{ canceled: true; result: undefined; } | {
< 	canceled: false; result: C;
< }> {
< 	return new Promise((resolve, reject) => {
< 		popup(MkDialog, {
< 			title: props.title,
< 			text: props.text,
< 			select: {
< 				items: props.items,
< 				groupedItems: props.groupedItems,
< 				default: props.default,
< 			},
< 		}, {
< 			done: result => {
< 				resolve(result ? result : { canceled: true });
< 			},
< 		}, 'closed');
< 	});
---
> export function select<C = any>(
>   props: {
>     title?: string | null;
>     text?: string | null;
>     default?: string | null;
>   } & (
>     | {
>         items: {
>           value: C;
>           text: string;
>         }[];
>       }
>     | {
>         groupedItems: {
>           label: string;
>           items: {
>             value: C;
>             text: string;
>           }[];
>         }[];
>       }
>   )
> ): Promise<
>   | { canceled: true; result: undefined }
>   | {
>       canceled: false;
>       result: C;
>     }
> > {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkDialog.vue")),
>       {
>         title: props.title,
>         text: props.text,
>         select: {
>           items: props.items,
>           groupedItems: props.groupedItems,
>           default: props.default,
>         },
>       },
>       {
>         done: (result) => {
>           resolve(result ? result : { canceled: true });
>         },
>       },
>       "closed"
>     );
>   });
298,309c413,429
< 	return new Promise((resolve, reject) => {
< 		const showing = ref(true);
< 		window.setTimeout(() => {
< 			showing.value = false;
< 		}, 1000);
< 		popup(MkWaitingDialog, {
< 			success: true,
< 			showing: showing,
< 		}, {
< 			done: () => resolve(),
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     const showing = ref(true);
>     window.setTimeout(() => {
>       showing.value = false;
>     }, 1000);
>     popup(
>       defineAsyncComponent(() => import("@/components/MkWaitingDialog.vue")),
>       {
>         success: true,
>         showing: showing,
>       },
>       {
>         done: () => resolve(),
>       },
>       "closed"
>     );
>   });
313,321c433,446
< 	return new Promise((resolve, reject) => {
< 		const showing = ref(true);
< 		popup(MkWaitingDialog, {
< 			success: false,
< 			showing: showing,
< 		}, {
< 			done: () => resolve(),
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     const showing = ref(true);
>     popup(
>       defineAsyncComponent(() => import("@/components/MkWaitingDialog.vue")),
>       {
>         success: false,
>         showing: showing,
>       },
>       {
>         done: () => resolve(),
>       },
>       "closed"
>     );
>   });
325,331c450,461
< 	return new Promise((resolve, reject) => {
< 		popup(defineAsyncComponent(() => import('@/components/MkFormDialog.vue')), { title, form }, {
< 			done: result => {
< 				resolve(result);
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkFormDialog.vue")),
>       { title, form },
>       {
>         done: (result) => {
>           resolve(result);
>         },
>       },
>       "closed"
>     );
>   });
334,343c464,476
< export async function selectUser(opts: { includeSelf?: boolean } = {}) {
< 	return new Promise((resolve, reject) => {
< 		popup(defineAsyncComponent(() => import('@/components/MkUserSelectDialog.vue')), {
< 			includeSelf: opts.includeSelf,
< 		}, {
< 			ok: user => {
< 				resolve(user);
< 			},
< 		}, 'closed');
< 	});
---
> export async function selectUser() {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkUserSelectDialog.vue")),
>       {},
>       {
>         ok: (user) => {
>           resolve(user);
>         },
>       },
>       "closed"
>     );
>   });
347,358c480,498
< 	return new Promise((resolve, reject) => {
< 		popup(defineAsyncComponent(() => import('@/components/MkDriveSelectDialog.vue')), {
< 			type: 'file',
< 			multiple,
< 		}, {
< 			done: files => {
< 				if (files) {
< 					resolve(multiple ? files : files[0]);
< 				}
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(
>         () => import("@/components/MkDriveSelectDialog.vue")
>       ),
>       {
>         type: "file",
>         multiple,
>       },
>       {
>         done: (files) => {
>           if (files) {
>             resolve(multiple ? files : files[0]);
>           }
>         },
>       },
>       "closed"
>     );
>   });
362,373c502,520
< 	return new Promise((resolve, reject) => {
< 		popup(defineAsyncComponent(() => import('@/components/MkDriveSelectDialog.vue')), {
< 			type: 'folder',
< 			multiple,
< 		}, {
< 			done: folders => {
< 				if (folders) {
< 					resolve(multiple ? folders : folders[0]);
< 				}
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(
>         () => import("@/components/MkDriveSelectDialog.vue")
>       ),
>       {
>         type: "folder",
>         multiple,
>       },
>       {
>         done: (folders) => {
>           if (folders) {
>             resolve(multiple ? folders : folders[0]);
>           }
>         },
>       },
>       "closed"
>     );
>   });
377,386c524,540
< 	return new Promise((resolve, reject) => {
< 		popup(MkEmojiPickerDialog, {
< 			src,
< 			...opts,
< 		}, {
< 			done: emoji => {
< 				resolve(emoji);
< 			},
< 		}, 'closed');
< 	});
---
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(
>         () => import("@/components/MkEmojiPickerDialog.vue")
>       ),
>       {
>         src,
>         ...opts,
>       },
>       {
>         done: (emoji) => {
>           resolve(emoji);
>         },
>       },
>       "closed"
>     );
>   });
389,401c543,563
< export async function cropImage(image: Misskey.entities.DriveFile, options: {
< 	aspectRatio: number;
< }): Promise<Misskey.entities.DriveFile> {
< 	return new Promise((resolve, reject) => {
< 		popup(defineAsyncComponent(() => import('@/components/MkCropperDialog.vue')), {
< 			file: image,
< 			aspectRatio: options.aspectRatio,
< 		}, {
< 			ok: x => {
< 				resolve(x);
< 			},
< 		}, 'closed');
< 	});
---
> export async function cropImage(
>   image: Misskey.entities.DriveFile,
>   options: {
>     aspectRatio: number;
>   }
> ): Promise<Misskey.entities.DriveFile> {
>   return new Promise((resolve, reject) => {
>     popup(
>       defineAsyncComponent(() => import("@/components/MkCropperDialog.vue")),
>       {
>         file: image,
>         aspectRatio: options.aspectRatio,
>       },
>       {
>         ok: (x) => {
>           resolve(x);
>         },
>       },
>       "closed"
>     );
>   });
404,407c566,570
< type AwaitType<T> =
< 	T extends Promise<infer U> ? U :
< 	T extends (...args: any[]) => Promise<infer V> ? V :
< 	T;
---
> type AwaitType<T> = T extends Promise<infer U>
>   ? U
>   : T extends (...args: any[]) => Promise<infer V>
>   ? V
>   : T;
410,411c573,578
< export async function openEmojiPicker(src?: HTMLElement, opts, initialTextarea: typeof activeTextarea) {
< 	if (openingEmojiPicker) return;
---
> export async function openEmojiPicker(
>   src?: HTMLElement,
>   opts,
>   initialTextarea: typeof activeTextarea
> ) {
>   if (openingEmojiPicker) return;
413c580
< 	activeTextarea = initialTextarea;
---
>   activeTextarea = initialTextarea;
415,420c582,587
< 	const textareas = document.querySelectorAll('textarea, input');
< 	for (const textarea of Array.from(textareas)) {
< 		textarea.addEventListener('focus', () => {
< 			activeTextarea = textarea;
< 		});
< 	}
---
>   const textareas = document.querySelectorAll("textarea, input");
>   for (const textarea of Array.from(textareas)) {
>     textarea.addEventListener("focus", () => {
>       activeTextarea = textarea;
>     });
>   }
422,434c589,607
< 	const observer = new MutationObserver(records => {
< 		for (const record of records) {
< 			for (const node of Array.from(record.addedNodes).filter(node => node instanceof HTMLElement) as HTMLElement[]) {
< 				const textareas = node.querySelectorAll('textarea, input') as NodeListOf<NonNullable<typeof activeTextarea>>;
< 				for (const textarea of Array.from(textareas).filter(textarea => textarea.dataset.preventEmojiInsert == null)) {
< 					if (document.activeElement === textarea) activeTextarea = textarea;
< 					textarea.addEventListener('focus', () => {
< 						activeTextarea = textarea;
< 					});
< 				}
< 			}
< 		}
< 	});
---
>   const observer = new MutationObserver((records) => {
>     for (const record of records) {
>       for (const node of Array.from(record.addedNodes).filter(
>         (node) => node instanceof HTMLElement
>       ) as HTMLElement[]) {
>         const textareas = node.querySelectorAll(
>           "textarea, input"
>         ) as NodeListOf<NonNullable<typeof activeTextarea>>;
>         for (const textarea of Array.from(textareas).filter(
>           (textarea) => textarea.dataset.preventEmojiInsert == null
>         )) {
>           if (document.activeElement === textarea) activeTextarea = textarea;
>           textarea.addEventListener("focus", () => {
>             activeTextarea = textarea;
>           });
>         }
>       }
>     }
>   });
436,441c609,614
< 	observer.observe(document.body, {
< 		childList: true,
< 		subtree: true,
< 		attributes: false,
< 		characterData: false,
< 	});
---
>   observer.observe(document.body, {
>     childList: true,
>     subtree: true,
>     attributes: false,
>     characterData: false,
>   });
443,455c616,632
< 	openingEmojiPicker = await popup(MkEmojiPickerWindow, {
< 		src,
< 		...opts,
< 	}, {
< 		chosen: emoji => {
< 			insertTextAtCursor(activeTextarea, emoji);
< 		},
< 		closed: () => {
< 			openingEmojiPicker!.dispose();
< 			openingEmojiPicker = null;
< 			observer.disconnect();
< 		},
< 	});
---
>   openingEmojiPicker = await popup(
>     defineAsyncComponent(() => import("@/components/MkEmojiPickerWindow.vue")),
>     {
>       src,
>       ...opts,
>     },
>     {
>       chosen: (emoji) => {
>         insertTextAtCursor(activeTextarea, emoji);
>       },
>       closed: () => {
>         openingEmojiPicker!.dispose();
>         openingEmojiPicker = null;
>         observer.disconnect();
>       },
>     }
>   );
458,483c635,664
< export function popupMenu(items: MenuItem[] | Ref<MenuItem[]>, src?: HTMLElement, options?: {
< 	align?: string;
< 	width?: number;
< 	viaKeyboard?: boolean;
< 	onClosing?: () => void;
< }) {
< 	return new Promise((resolve, reject) => {
< 		let dispose;
< 		popup(MkPopupMenu, {
< 			items,
< 			src,
< 			width: options?.width,
< 			align: options?.align,
< 			viaKeyboard: options?.viaKeyboard,
< 		}, {
< 			closed: () => {
< 				resolve();
< 				dispose();
< 			},
< 			closing: () => {
< 				if (options?.onClosing) options.onClosing();
< 			},
< 		}).then(res => {
< 			dispose = res.dispose;
< 		});
< 	});
---
> export function popupMenu(
>   items: MenuItem[] | Ref<MenuItem[]>,
>   src?: HTMLElement,
>   options?: {
>     align?: string;
>     width?: number;
>     viaKeyboard?: boolean;
>   }
> ) {
>   return new Promise((resolve, reject) => {
>     let dispose;
>     popup(
>       defineAsyncComponent(() => import("@/components/MkPopupMenu.vue")),
>       {
>         items,
>         src,
>         width: options?.width,
>         align: options?.align,
>         viaKeyboard: options?.viaKeyboard,
>       },
>       {
>         closed: () => {
>           resolve();
>           dispose();
>         },
>       }
>     ).then((res) => {
>       dispose = res.dispose;
>     });
>   });
486,501c667,689
< export function contextMenu(items: MenuItem[] | Ref<MenuItem[]>, ev: MouseEvent) {
< 	ev.preventDefault();
< 	return new Promise((resolve, reject) => {
< 		let dispose;
< 		popup(MkContextMenu, {
< 			items,
< 			ev,
< 		}, {
< 			closed: () => {
< 				resolve();
< 				dispose();
< 			},
< 		}).then(res => {
< 			dispose = res.dispose;
< 		});
< 	});
---
> export function contextMenu(
>   items: MenuItem[] | Ref<MenuItem[]>,
>   ev: MouseEvent
> ) {
>   ev.preventDefault();
>   return new Promise((resolve, reject) => {
>     let dispose;
>     popup(
>       defineAsyncComponent(() => import("@/components/MkContextMenu.vue")),
>       {
>         items,
>         ev,
>       },
>       {
>         closed: () => {
>           resolve();
>           dispose();
>         },
>       }
>     ).then((res) => {
>       dispose = res.dispose;
>     });
>   });
505,520c693,708
< 	return new Promise((resolve, reject) => {
< 		// NOTE: MkPostFormDialogをdynamic importするとiOSでテキストエリアに自動フォーカスできない
< 		// NOTE: ただ、dynamic importしない場合、MkPostFormDialogインスタンスが使いまわされ、
< 		//       Vueが渡されたコンポーネントに内部的に__propsというプロパティを生やす影響で、
< 		//       複数のpost formを開いたときに場合によってはエラーになる
< 		//       もちろん複数のpost formを開けること自体Misskeyサイドのバグなのだが
< 		let dispose;
< 		popup(MkPostFormDialog, props, {
< 			closed: () => {
< 				resolve();
< 				dispose();
< 			},
< 		}).then(res => {
< 			dispose = res.dispose;
< 		});
< 	});
---
>   return new Promise((resolve, reject) => {
>     // NOTE: MkPostFormDialogをdynamic importするとiOSでテキストエリアに自動フォーカスできない
>     // NOTE: ただ、dynamic importしない場合、MkPostFormDialogインスタンスが使いまわされ、
>     //       Vueが渡されたコンポーネントに内部的に__propsというプロパティを生やす影響で、
>     //       複数のpost formを開いたときに場合によってはエラーになる
>     //       もちろん複数のpost formを開けること自体Misskeyサイドのバグなのだが
>     let dispose;
>     popup(MkPostFormDialog, props, {
>       closed: () => {
>         resolve();
>         dispose();
>       },
>     }).then((res) => {
>       dispose = res.dispose;
>     });
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/_empty_.vue RiricaV13/pages/_empty_.vue
2c2
< <div></div>
---
>   <div></div>
6c6
< import { } from 'vue';
---
> import {} from "vue";
diff --color=auto -r misskeyV13/packages/frontend/src/pages/_error_.vue RiricaV13/pages/_error_.vue
2,17c2,30
< <MkLoading v-if="!loaded"/>
< <Transition :name="$store.state.animation ? '_transition_zoom' : ''" appear>
< 	<div v-show="loaded" class="mjndxjch">
< 		<img src="https://xn--931a.moe/assets/error.jpg" class="_ghost"/>
< 		<p><b><i class="ti ti-alert-triangle"></i> {{ i18n.ts.pageLoadError }}</b></p>
< 		<p v-if="meta && (version === meta.version)">{{ i18n.ts.pageLoadErrorDescription }}</p>
< 		<p v-else-if="serverIsDead">{{ i18n.ts.serverIsDead }}</p>
< 		<template v-else>
< 			<p>{{ i18n.ts.newVersionOfClientAvailable }}</p>
< 			<p>{{ i18n.ts.youShouldUpgradeClient }}</p>
< 			<MkButton class="button primary" @click="reload">{{ i18n.ts.reload }}</MkButton>
< 		</template>
< 		<p><MkA to="/docs/general/troubleshooting" class="_link">{{ i18n.ts.troubleshooting }}</MkA></p>
< 		<p v-if="error" class="error">ERROR: {{ error }}</p>
< 	</div>
< </Transition>
---
>   <MkLoading v-if="!loaded" />
>   <transition :name="$store.state.animation ? 'zoom' : ''" appear>
>     <div v-show="loaded" class="mjndxjch">
>       <img src="https://xn--931a.moe/assets/error.jpg" class="_ghost" />
>       <p>
>         <b
>           ><i class="fas fa-exclamation-triangle"></i>
>           {{ i18n.ts.pageLoadError }}</b
>         >
>       </p>
>       <p v-if="meta && version === meta.version">
>         {{ i18n.ts.pageLoadErrorDescription }}
>       </p>
>       <p v-else-if="serverIsDead">{{ i18n.ts.serverIsDead }}</p>
>       <template v-else>
>         <p>{{ i18n.ts.newVersionOfClientAvailable }}</p>
>         <p>{{ i18n.ts.youShouldUpgradeClient }}</p>
>         <MkButton class="button primary" @click="reload">{{
>           i18n.ts.reload
>         }}</MkButton>
>       </template>
>       <p>
>         <MkA to="/docs/general/troubleshooting" class="_link">{{
>           i18n.ts.troubleshooting
>         }}</MkA>
>       </p>
>       <p v-if="error" class="error">ERROR: {{ error }}</p>
>     </div>
>   </transition>
21,29c34,41
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkButton from '@/components/MkButton.vue';
< import { version } from '@/config';
< import * as os from '@/os';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { miLocalStorage } from '@/local-storage';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import MkButton from "@/components/MkButton.vue";
> import { version } from "@/config";
> import * as os from "@/os";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
31,34c43,48
< const props = withDefaults(defineProps<{
< 	error?: Error;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     error?: Error;
>   }>(),
>   {}
> );
40,50c54,67
< os.api('meta', {
< 	detail: false,
< }).then(res => {
< 	loaded = true;
< 	serverIsDead = false;
< 	meta = res;
< 	miLocalStorage.setItem('v', res.version);
< }, () => {
< 	loaded = true;
< 	serverIsDead = true;
< });
---
> os.api("meta", {
>   detail: false,
> }).then(
>   (res) => {
>     loaded = true;
>     serverIsDead = false;
>     meta = res;
>     localStorage.setItem("v", res.version);
>   },
>   () => {
>     loaded = true;
>     serverIsDead = true;
>   }
> );
53c70
< 	unisonReload();
---
>   unisonReload();
61,62c78,79
< 	title: i18n.ts.error,
< 	icon: 'ti ti-alert-triangle',
---
>   title: i18n.ts.error,
>   icon: "fas fa-exclamation-triangle",
68,69c85,86
< 	padding: 32px;
< 	text-align: center;
---
>   padding: 32px;
>   text-align: center;
71,73c88,90
< 	> p {
< 		margin: 0 0 12px 0;
< 	}
---
>   > p {
>     margin: 0 0 12px 0;
>   }
75,77c92,94
< 	> .button {
< 		margin: 8px auto;
< 	}
---
>   > .button {
>     margin: 8px auto;
>   }
79,84c96,101
< 	> img {
< 		vertical-align: bottom;
< 		height: 128px;
< 		margin-bottom: 24px;
< 		border-radius: 16px;
< 	}
---
>   > img {
>     vertical-align: bottom;
>     height: 128px;
>     margin-bottom: 24px;
>     border-radius: 16px;
>   }
86,88c103,105
< 	> .error {
< 		opacity: 0.7;
< 	}
---
>   > .error {
>     opacity: 0.7;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/_loading_.vue RiricaV13/pages/_loading_.vue
2c2
< <MkLoading/>
---
>   <MkLoading />
5,6c5
< <script lang="ts" setup>
< </script>
---
> <script lang="ts" setup></script>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/about-misskey.vue RiricaV13/pages/about-misskey.vue
2,81c2,125
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<div style="overflow: clip;">
< 		<MkSpacer :content-max="600" :margin-min="20">
< 			<div class="_gaps_m znqjceqz">
< 				<div v-panel class="about">
< 					<div ref="containerEl" class="container" :class="{ playing: easterEggEngine != null }">
< 						<img src="/client-assets/about-icon.png" alt="" class="icon" draggable="false" @load="iconLoaded" @click="gravity"/>
< 						<div class="misskey">Misskey</div>
< 						<div class="version">v{{ version }}</div>
< 						<span v-for="emoji in easterEggEmojis" :key="emoji.id" class="emoji" :data-physics-x="emoji.left" :data-physics-y="emoji.top" :class="{ _physics_circle_: !emoji.emoji.startsWith(':') }"><MkEmoji class="emoji" :emoji="emoji.emoji" :is-reaction="false" :normal="true" :no-style="true"/></span>
< 					</div>
< 					<button v-if="thereIsTreasure" class="_button treasure" @click="getTreasure"><img src="/fluent-emoji/1f3c6.png" class="treasureImg"></button>
< 				</div>
< 				<div style="text-align: center;">
< 					{{ i18n.ts._aboutMisskey.about }}<br><a href="https://misskey-hub.net/docs/misskey.html" target="_blank" class="_link">{{ i18n.ts.learnMore }}</a>
< 				</div>
< 				<div style="text-align: center;">
< 					<MkButton primary rounded inline @click="iLoveMisskey">I <Mfm text="$[jelly ❤]"/> #Misskey</MkButton>
< 				</div>
< 				<FormSection>
< 					<div class="_formLinks">
< 						<FormLink to="https://github.com/misskey-dev/misskey" external>
< 							<template #icon><i class="ti ti-code"></i></template>
< 							{{ i18n.ts._aboutMisskey.source }}
< 							<template #suffix>GitHub</template>
< 						</FormLink>
< 						<FormLink to="https://crowdin.com/project/misskey" external>
< 							<template #icon><i class="ti ti-language-hiragana"></i></template>
< 							{{ i18n.ts._aboutMisskey.translation }}
< 							<template #suffix>Crowdin</template>
< 						</FormLink>
< 						<FormLink to="https://www.patreon.com/syuilo" external>
< 							<template #icon><i class="ti ti-pig-money"></i></template>
< 							{{ i18n.ts._aboutMisskey.donate }}
< 							<template #suffix>Patreon</template>
< 						</FormLink>
< 					</div>
< 				</FormSection>
< 				<FormSection>
< 					<template #label>{{ i18n.ts._aboutMisskey.contributors }}</template>
< 					<div :class="$style.contributors">
< 						<a href="https://github.com/syuilo" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/4439005?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@syuilo</span>
< 						</a>
< 						<a href="https://github.com/tamaina" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/7973572?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@tamaina</span>
< 						</a>
< 						<a href="https://github.com/acid-chicken" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/20679825?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@acid-chicken</span>
< 						</a>
< 						<a href="https://github.com/rinsuki" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/6533808?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@rinsuki</span>
< 						</a>
< 						<a href="https://github.com/mei23" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/30769358?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@mei23</span>
< 						</a>
< 						<a href="https://github.com/robflop" target="_blank" :class="$style.contributor">
< 							<img src="https://avatars.githubusercontent.com/u/8159402?v=4" :class="$style.contributorAvatar">
< 							<span :class="$style.contributorUsername">@robflop</span>
< 						</a>
< 					</div>
< 					<template #caption><MkLink url="https://github.com/misskey-dev/misskey/graphs/contributors">{{ i18n.ts._aboutMisskey.allContributors }}</MkLink></template>
< 				</FormSection>
< 				<FormSection>
< 					<template #label><Mfm text="$[jelly ❤]"/> {{ i18n.ts._aboutMisskey.patrons }}</template>
< 					<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); grid-gap: 12px;">
< 						<div v-for="patron in patrons" :key="patron">{{ patron }}</div>
< 					</div>
< 					<p>{{ i18n.ts._aboutMisskey.morePatrons }}</p>
< 				</FormSection>
< 			</div>
< 		</MkSpacer>
< 	</div>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <div style="overflow: clip">
>       <MkSpacer :content-max="600" :margin-min="20">
>         <div class="_formRoot znqjceqz">
>           <div id="debug"></div>
>           <div
>             ref="containerEl"
>             v-panel
>             class="_formBlock about"
>             :class="{ playing: easterEggEngine != null }"
>           >
>             <img
>               src="/client-assets/about-icon.png"
>               alt=""
>               class="icon"
>               draggable="false"
>               @load="iconLoaded"
>               @click="gravity"
>             />
>             <div class="misskey">Misskey</div>
>             <div class="version">v{{ version }}</div>
>             <span
>               v-for="emoji in easterEggEmojis"
>               :key="emoji.id"
>               class="emoji"
>               :data-physics-x="emoji.left"
>               :data-physics-y="emoji.top"
>               :class="{ _physics_circle_: !emoji.emoji.startsWith(':') }"
>               ><MkEmoji
>                 class="emoji"
>                 :emoji="emoji.emoji"
>                 :custom-emojis="$instance.emojis"
>                 :is-reaction="false"
>                 :normal="true"
>                 :no-style="true"
>             /></span>
>           </div>
>           <div class="_formBlock" style="text-align: center">
>             {{ i18n.ts._aboutMisskey.about }}<br /><a
>               href="https://misskey-hub.net/docs/misskey.html"
>               target="_blank"
>               class="_link"
>               >{{ i18n.ts.learnMore }}</a
>             >
>           </div>
>           <div class="_formBlock" style="text-align: center">
>             <MkButton primary rounded inline @click="iLoveMisskey"
>               >I <Mfm text="$[jelly ❤]" /> #Misskey</MkButton
>             >
>           </div>
>           <FormSection>
>             <div class="_formLinks">
>               <FormLink to="https://github.com/misskey-dev/misskey" external>
>                 <template #icon><i class="fas fa-code"></i></template>
>                 {{ i18n.ts._aboutMisskey.source }}
>                 <template #suffix>GitHub</template>
>               </FormLink>
>               <FormLink to="https://crowdin.com/project/misskey" external>
>                 <template #icon><i class="fas fa-language"></i></template>
>                 {{ i18n.ts._aboutMisskey.translation }}
>                 <template #suffix>Crowdin</template>
>               </FormLink>
>               <FormLink to="https://www.patreon.com/syuilo" external>
>                 <template #icon
>                   ><i class="fas fa-hand-holding-medical"></i
>                 ></template>
>                 {{ i18n.ts._aboutMisskey.donate }}
>                 <template #suffix>Patreon</template>
>               </FormLink>
>             </div>
>           </FormSection>
>           <FormSection>
>             <template #label>{{ i18n.ts._aboutMisskey.contributors }}</template>
>             <div class="_formLinks">
>               <FormLink to="https://github.com/syuilo" external
>                 >@syuilo</FormLink
>               >
>               <FormLink to="https://github.com/AyaMorisawa" external
>                 >@AyaMorisawa</FormLink
>               >
>               <FormLink to="https://github.com/mei23" external>@mei23</FormLink>
>               <FormLink to="https://github.com/acid-chicken" external
>                 >@acid-chicken</FormLink
>               >
>               <FormLink to="https://github.com/tamaina" external
>                 >@tamaina</FormLink
>               >
>               <FormLink to="https://github.com/rinsuki" external
>                 >@rinsuki</FormLink
>               >
>               <FormLink to="https://github.com/Xeltica" external
>                 >@Xeltica</FormLink
>               >
>               <FormLink to="https://github.com/u1-liquid" external
>                 >@u1-liquid</FormLink
>               >
>               <FormLink to="https://github.com/marihachi" external
>                 >@marihachi</FormLink
>               >
>             </div>
>             <template #caption
>               ><MkLink
>                 url="https://github.com/misskey-dev/misskey/graphs/contributors"
>                 >{{ i18n.ts._aboutMisskey.allContributors }}</MkLink
>               ></template
>             >
>           </FormSection>
>           <FormSection>
>             <template #label
>               ><Mfm text="$[jelly ❤]" />
>               {{ i18n.ts._aboutMisskey.patrons }}</template
>             >
>             <div v-for="patron in patrons" :key="patron">{{ patron }}</div>
>             <template #caption>{{
>               i18n.ts._aboutMisskey.morePatrons
>             }}</template>
>           </FormSection>
>         </div>
>       </MkSpacer>
>     </div>
>   </MkStickyContainer>
85,97c129,139
< import { nextTick, onBeforeUnmount } from 'vue';
< import { version } from '@/config';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkLink from '@/components/MkLink.vue';
< import { physics } from '@/scripts/physics';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { claimAchievement, claimedAchievements } from '@/scripts/achievements';
< import { $i } from '@/account';
---
> import { nextTick, onBeforeUnmount } from "vue";
> import { version } from "@/config";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkLink from "@/components/MkLink.vue";
> import { physics } from "@/scripts/physics";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
100,177c142,219
< 	'まっちゃとーにゅ',
< 	'mametsuko',
< 	'noellabo',
< 	'AureoleArk',
< 	'Gargron',
< 	'Nokotaro Takeda',
< 	'Suji Yan',
< 	'oi_yekssim',
< 	'regtan',
< 	'Hekovic',
< 	'nenohi',
< 	'Gitmo Life Services',
< 	'naga_rus',
< 	'Efertone',
< 	'Melilot',
< 	'motcha',
< 	'nanami kan',
< 	'sevvie Rose',
< 	'Hayato Ishikawa',
< 	'Puniko',
< 	'skehmatics',
< 	'Quinton Macejkovic',
< 	'YUKIMOCHI',
< 	'dansup',
< 	'mewl hayabusa',
< 	'Emilis',
< 	'Fristi',
< 	'makokunsan',
< 	'chidori ninokura',
< 	'Peter G.',
< 	'見当かなみ',
< 	'natalie',
< 	'Maronu',
< 	'Steffen K9',
< 	'takimura',
< 	'sikyosyounin',
< 	'Nesakko',
< 	'YuzuRyo61',
< 	'blackskye',
< 	'sheeta.s',
< 	'osapon',
< 	'public_yusuke',
< 	'CG',
< 	'吴浥',
< 	't_w',
< 	'Jerry',
< 	'nafuchoco',
< 	'Takumi Sugita',
< 	'GLaTAN',
< 	'mkatze',
< 	'kabo2468y',
< 	'mydarkstar',
< 	'Roujo',
< 	'DignifiedSilence',
< 	'uroco @99',
< 	'totokoro',
< 	'うし',
< 	'kiritan',
< 	'weepjp',
< 	'Liaizon Wakest',
< 	'Duponin',
< 	'Blue',
< 	'Naoki Hirayama',
< 	'wara',
< 	'Wataru Manji (manji0)',
< 	'みなしま',
< 	'kanoy',
< 	'xianon',
< 	'Denshi',
< 	'Osushimaru',
< 	'にょんへら',
< 	'おのだい',
< 	'Leni',
< 	'oss',
< 	'Weeble',
< 	'蝉暮せせせ',
< 	'ThatOneCalculator',
< 	'pixeldesu',
---
>   "まっちゃとーにゅ",
>   "mametsuko",
>   "noellabo",
>   "AureoleArk",
>   "Gargron",
>   "Nokotaro Takeda",
>   "Suji Yan",
>   "oi_yekssim",
>   "regtan",
>   "Hekovic",
>   "nenohi",
>   "Gitmo Life Services",
>   "naga_rus",
>   "Efertone",
>   "Melilot",
>   "motcha",
>   "nanami kan",
>   "sevvie Rose",
>   "Hayato Ishikawa",
>   "Puniko",
>   "skehmatics",
>   "Quinton Macejkovic",
>   "YUKIMOCHI",
>   "dansup",
>   "mewl hayabusa",
>   "Emilis",
>   "Fristi",
>   "makokunsan",
>   "chidori ninokura",
>   "Peter G.",
>   "見当かなみ",
>   "natalie",
>   "Maronu",
>   "Steffen K9",
>   "takimura",
>   "sikyosyounin",
>   "Nesakko",
>   "YuzuRyo61",
>   "blackskye",
>   "sheeta.s",
>   "osapon",
>   "public_yusuke",
>   "CG",
>   "吴浥",
>   "t_w",
>   "Jerry",
>   "nafuchoco",
>   "Takumi Sugita",
>   "GLaTAN",
>   "mkatze",
>   "kabo2468y",
>   "mydarkstar",
>   "Roujo",
>   "DignifiedSilence",
>   "uroco @99",
>   "totokoro",
>   "うし",
>   "kiritan",
>   "weepjp",
>   "Liaizon Wakest",
>   "Duponin",
>   "Blue",
>   "Naoki Hirayama",
>   "wara",
>   "Wataru Manji (manji0)",
>   "みなしま",
>   "kanoy",
>   "xianon",
>   "Denshi",
>   "Osushimaru",
>   "にょんへら",
>   "おのだい",
>   "Leni",
>   "oss",
>   "Weeble",
>   "蝉暮せせせ",
>   "ThatOneCalculator",
>   "pixeldesu",
180,181d221
< let thereIsTreasure = $ref($i && !claimedAchievements.includes('foundTreasure'));
< 
185c225
< const containerEl = $shallowRef<HTMLElement>();
---
> const containerEl = $ref<HTMLElement>();
188,197c228,237
< 	const emojis = defaultStore.state.reactions;
< 	const containerWidth = containerEl.offsetWidth;
< 	for (let i = 0; i < 32; i++) {
< 		easterEggEmojis.push({
< 			id: i.toString(),
< 			top: -(128 + (Math.random() * 256)),
< 			left: (Math.random() * containerWidth),
< 			emoji: emojis[Math.floor(Math.random() * emojis.length)],
< 		});
< 	}
---
>   const emojis = defaultStore.state.reactions;
>   const containerWidth = containerEl.offsetWidth;
>   for (let i = 0; i < 32; i++) {
>     easterEggEmojis.push({
>       id: i.toString(),
>       top: -(128 + Math.random() * 256),
>       left: Math.random() * containerWidth,
>       emoji: emojis[Math.floor(Math.random() * emojis.length)],
>     });
>   }
199,201c239,241
< 	nextTick(() => {
< 		easterEggReady = true;
< 	});
---
>   nextTick(() => {
>     easterEggReady = true;
>   });
205,207c245,247
< 	if (!easterEggReady) return;
< 	easterEggReady = false;
< 	easterEggEngine = physics(containerEl);
---
>   if (!easterEggReady) return;
>   easterEggReady = false;
>   easterEggEngine = physics(containerEl);
211,214c251,254
< 	os.post({
< 		initialText: 'I $[jelly ❤] #Misskey',
< 		instant: true,
< 	});
---
>   os.post({
>     initialText: "I $[jelly ❤] #Misskey",
>     instant: true,
>   });
217,221d256
< function getTreasure() {
< 	thereIsTreasure = false;
< 	claimAchievement('foundTreasure');
< }
< 
223,225c258,260
< 	if (easterEggEngine) {
< 		easterEggEngine.stop();
< 	}
---
>   if (easterEggEngine) {
>     easterEggEngine.stop();
>   }
233,234c268,269
< 	title: i18n.ts.aboutMisskey,
< 	icon: null,
---
>   title: i18n.ts.aboutMisskey,
>   icon: null,
240,242c275,279
< 	> .about {
< 		position: relative;
< 		border-radius: var(--radius);
---
>   > .about {
>     position: relative;
>     text-align: center;
>     padding: 16px;
>     border-radius: var(--radius);
244,250c281,285
< 		> .treasure {
< 			position: absolute;
< 			top: 60px;
< 			left: 0;
< 			right: 0;
< 			margin: 0 auto;
< 			width: min-content;
---
>     &.playing {
>       &,
>       * {
>         user-select: none;
>       }
252,256c287,289
< 			> .treasureImg {
< 				width: 25px;
< 				vertical-align: bottom;
< 			}
< 		}
---
>       * {
>         will-change: transform;
>       }
258,261c291,294
< 		> .container {
< 			position: relative;
< 			text-align: center;
< 			padding: 16px;
---
>       > .emoji {
>         visibility: visible;
>       }
>     }
263,266c296,301
< 			&.playing {
< 				&, * {
< 					user-select: none;
< 				}
---
>     > .icon {
>       display: block;
>       width: 100px;
>       margin: 0 auto;
>       border-radius: 16px;
>     }
268,270c303,306
< 				* {
< 					will-change: transform;
< 				}
---
>     > .misskey {
>       margin: 0.75em auto 0 auto;
>       width: max-content;
>     }
272,275c308,312
< 				> .emoji {
< 					visibility: visible;
< 				}
< 			}
---
>     > .version {
>       margin: 0 auto;
>       width: max-content;
>       opacity: 0.5;
>     }
277,284c314,318
< 			> .icon {
< 				display: block;
< 				width: 80px;
< 				margin: 0 auto;
< 				border-radius: 16px;
< 				position: relative;
< 				z-index: 1;
< 			}
---
>     > .emoji {
>       position: absolute;
>       top: 0;
>       left: 0;
>       visibility: hidden;
286,350c320,326
< 			> .misskey {
< 				margin: 0.75em auto 0 auto;
< 				width: max-content;
< 				position: relative;
< 				z-index: 1;
< 			}
< 
< 			> .version {
< 				margin: 0 auto;
< 				width: max-content;
< 				opacity: 0.5;
< 				position: relative;
< 				z-index: 1;
< 			}
< 
< 			> .emoji {
< 				position: absolute;
< 				z-index: 1;
< 				top: 0;
< 				left: 0;
< 				visibility: hidden;
< 
< 				> .emoji {
< 					pointer-events: none;
< 					font-size: 24px;
< 					width: 24px;
< 				}
< 			}
< 		}
< 	}
< }
< </style>
< 
< <style lang="scss" module>
< .contributors {
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
< 	grid-gap: 12px;
< }
< 
< .contributor {
< 	display: flex;
< 	align-items: center;
< 	padding: 12px;
< 	background: var(--buttonBg);
< 	border-radius: 6px;
< 
< 	&:hover {
< 		text-decoration: none;
< 		background: var(--buttonHoverBg);
< 	}
< 
< 	&.active {
< 		color: var(--accent);
< 		background: var(--buttonHoverBg);
< 	}
< }
< 
< .contributorAvatar {
< 	width: 30px;
< 	border-radius: 100%;
< }
< 
< .contributorUsername {
< 	margin-left: 12px;
---
>       > .emoji {
>         pointer-events: none;
>         font-size: 24px;
>         width: 24px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/about.emojis.vue RiricaV13/pages/about.emojis.vue
2,3c2,6
< <div class="driuhtrh _gaps">
< 	<MkButton v-if="$i && ($i.isModerator || $i.policies.canManageCustomEmojis)" primary link to="/custom-emojis-manager">{{ i18n.ts.manageCustomEmojis }}</MkButton>
---
>   <div class="driuhtrh">
>     <div class="query">
>       <MkInput v-model="q" class="" :placeholder="$ts.search">
>         <template #prefix><i class="fas fa-search"></i></template>
>       </MkInput>
5,10c8
< 	<div class="query">
< 		<MkInput v-model="q" class="" :placeholder="$ts.search">
< 			<template #prefix><i class="ti ti-search"></i></template>
< 		</MkInput>
< 
< 		<!-- たくさんあると邪魔
---
>       <!-- たくさんあると邪魔
12c10
< 			<span class="tag _button" v-for="tag in customEmojiTags" :class="{ active: selectedTags.has(tag) }" @click="toggleTag(tag)">{{ tag }}</span>
---
> 			<span class="tag _button" v-for="tag in tags" :class="{ active: selectedTags.has(tag) }" @click="toggleTag(tag)">{{ tag }}</span>
15c13
< 	</div>
---
>     </div>
17,30c15,42
< 	<MkFoldableSection v-if="searchEmojis" class="emojis">
< 		<template #header>{{ $ts.searchResult }}</template>
< 		<div class="zuvgdzyt">
< 			<XEmoji v-for="emoji in searchEmojis" :key="emoji.name" class="emoji" :emoji="emoji"/>
< 		</div>
< 	</MkFoldableSection>
< 	
< 	<MkFoldableSection v-for="category in customEmojiCategories" v-once :key="category" class="emojis">
< 		<template #header>{{ category || $ts.other }}</template>
< 		<div class="zuvgdzyt">
< 			<XEmoji v-for="emoji in customEmojis.filter(e => e.category === category)" :key="emoji.name" class="emoji" :emoji="emoji"/>
< 		</div>
< 	</MkFoldableSection>
< </div>
---
>     <MkFolder v-if="searchEmojis" class="emojis">
>       <template #header>{{ $ts.searchResult }}</template>
>       <div class="zuvgdzyt">
>         <XEmoji
>           v-for="emoji in searchEmojis"
>           :key="emoji.name"
>           class="emoji"
>           :emoji="emoji"
>         />
>       </div>
>     </MkFolder>
> 
>     <MkFolder
>       v-for="category in customEmojiCategories"
>       :key="category"
>       class="emojis"
>     >
>       <template #header>{{ category || $ts.other }}</template>
>       <div class="zuvgdzyt">
>         <XEmoji
>           v-for="emoji in customEmojis.filter((e) => e.category === category)"
>           :key="emoji.name"
>           class="emoji"
>           :emoji="emoji"
>         />
>       </div>
>     </MkFolder>
>   </div>
33,44c45,54
< <script lang="ts" setup>
< import { defineComponent, computed, watch } from 'vue';
< import XEmoji from './emojis.emoji.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkTab from '@/components/MkTab.vue';
< import * as os from '@/os';
< import { customEmojis, customEmojiCategories, getCustomEmojiTags } from '@/custom-emojis';
< import { i18n } from '@/i18n';
< import * as Misskey from 'misskey-js';
---
> <script lang="ts">
> import { defineComponent, computed } from "vue";
> import XEmoji from "./emojis.emoji.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkFolder from "@/components/MkFolder.vue";
> import MkTab from "@/components/MkTab.vue";
> import * as os from "@/os";
> import { emojiCategories, emojiTags } from "@/instance";
46,49c56,64
< const customEmojiTags = getCustomEmojiTags();
< let q = $ref('');
< let searchEmojis = $ref<Misskey.entities.CustomEmoji[]>(null);
< let selectedTags = $ref(new Set());
---
> export default defineComponent({
>   components: {
>     MkButton,
>     MkInput,
>     MkSelect,
>     MkFolder,
>     MkTab,
>     XEmoji,
>   },
51,55c66,75
< function search() {
< 	if ((q === '' || q == null) && selectedTags.size === 0) {
< 		searchEmojis = null;
< 		return;
< 	}
---
>   data() {
>     return {
>       q: "",
>       customEmojiCategories: emojiCategories,
>       customEmojis: this.$instance.emojis,
>       tags: emojiTags,
>       selectedTags: new Set(),
>       searchEmojis: null,
>     };
>   },
57,62c77,87
< 	if (selectedTags.size === 0) {
< 		searchEmojis = customEmojis.value.filter(emoji => emoji.name.includes(q) || emoji.aliases.includes(q));
< 	} else {
< 		searchEmojis = customEmojis.value.filter(emoji => (emoji.name.includes(q) || emoji.aliases.includes(q)) && [...selectedTags].every(t => emoji.aliases.includes(t)));
< 	}
< }
---
>   watch: {
>     q() {
>       this.search();
>     },
>     selectedTags: {
>       handler() {
>         this.search();
>       },
>       deep: true,
>     },
>   },
64,70c89,94
< function toggleTag(tag) {
< 	if (selectedTags.has(tag)) {
< 		selectedTags.delete(tag);
< 	} else {
< 		selectedTags.add(tag);
< 	}
< }
---
>   methods: {
>     search() {
>       if ((this.q === "" || this.q == null) && this.selectedTags.size === 0) {
>         this.searchEmojis = null;
>         return;
>       }
72,74c96,108
< watch($$(q), () => {
< 	search();
< });
---
>       if (this.selectedTags.size === 0) {
>         this.searchEmojis = this.customEmojis.filter(
>           (emoji) =>
>             emoji.name.includes(this.q) || emoji.aliases.includes(this.q)
>         );
>       } else {
>         this.searchEmojis = this.customEmojis.filter(
>           (emoji) =>
>             (emoji.name.includes(this.q) || emoji.aliases.includes(this.q)) &&
>             [...this.selectedTags].every((t) => emoji.aliases.includes(t))
>         );
>       }
>     },
76,78c110,118
< watch($$(selectedTags), () => {
< 	search();
< }, { deep: true });
---
>     toggleTag(tag) {
>       if (this.selectedTags.has(tag)) {
>         this.selectedTags.delete(tag);
>       } else {
>         this.selectedTags.add(tag);
>       }
>     },
>   },
> });
83c123
< 	background: var(--bg);
---
>   background: var(--bg);
85,86c125,127
< 	> .query {
< 		background: var(--bg);
---
>   > .query {
>     background: var(--bg);
>     padding: 16px;
88,95c129,136
< 		> .tags {
< 			> .tag {
< 				display: inline-block;
< 				margin: 8px 8px 0 0;
< 				padding: 4px 8px;
< 				font-size: 0.9em;
< 				background: var(--accentedBg);
< 				border-radius: 5px;
---
>     > .tags {
>       > .tag {
>         display: inline-block;
>         margin: 8px 8px 0 0;
>         padding: 4px 8px;
>         font-size: 0.9em;
>         background: var(--accentedBg);
>         border-radius: 5px;
97,103c138,144
< 				&.active {
< 					background: var(--accent);
< 					color: var(--fgOnAccent);
< 				}
< 			}
< 		}
< 	}
---
>         &.active {
>           background: var(--accent);
>           color: var(--fgOnAccent);
>         }
>       }
>     }
>   }
105,111c146,155
< 	> .emojis {
< 		.zuvgdzyt {
< 			display: grid;
< 			grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
< 			grid-gap: 12px;
< 		}
< 	}
---
>   > .emojis {
>     --x-padding: 0 16px;
> 
>     .zuvgdzyt {
>       display: grid;
>       grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
>       grid-gap: 12px;
>       margin: 0 var(--margin) var(--margin) var(--margin);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/about.federation.vue RiricaV13/pages/about.federation.vue
2,35c2,65
< <div class="taeiyria">
< 	<div class="query">
< 		<MkInput v-model="host" :debounce="true" class="">
< 			<template #prefix><i class="ti ti-search"></i></template>
< 			<template #label>{{ i18n.ts.host }}</template>
< 		</MkInput>
< 		<FormSplit style="margin-top: var(--margin);">
< 			<MkSelect v-model="state">
< 				<template #label>{{ i18n.ts.state }}</template>
< 				<option value="all">{{ i18n.ts.all }}</option>
< 				<option value="federating">{{ i18n.ts.federating }}</option>
< 				<option value="subscribing">{{ i18n.ts.subscribing }}</option>
< 				<option value="publishing">{{ i18n.ts.publishing }}</option>
< 				<option value="suspended">{{ i18n.ts.suspended }}</option>
< 				<option value="blocked">{{ i18n.ts.blocked }}</option>
< 				<option value="notResponding">{{ i18n.ts.notResponding }}</option>
< 			</MkSelect>
< 			<MkSelect v-model="sort">
< 				<template #label>{{ i18n.ts.sort }}</template>
< 				<option value="+pubSub">{{ i18n.ts.pubSub }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-pubSub">{{ i18n.ts.pubSub }} ({{ i18n.ts.ascendingOrder }})</option>
< 				<option value="+notes">{{ i18n.ts.notes }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-notes">{{ i18n.ts.notes }} ({{ i18n.ts.ascendingOrder }})</option>
< 				<option value="+users">{{ i18n.ts.users }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-users">{{ i18n.ts.users }} ({{ i18n.ts.ascendingOrder }})</option>
< 				<option value="+following">{{ i18n.ts.following }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-following">{{ i18n.ts.following }} ({{ i18n.ts.ascendingOrder }})</option>
< 				<option value="+followers">{{ i18n.ts.followers }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-followers">{{ i18n.ts.followers }} ({{ i18n.ts.ascendingOrder }})</option>
< 				<option value="+firstRetrievedAt">{{ i18n.ts.registeredAt }} ({{ i18n.ts.descendingOrder }})</option>
< 				<option value="-firstRetrievedAt">{{ i18n.ts.registeredAt }} ({{ i18n.ts.ascendingOrder }})</option>
< 			</MkSelect>
< 		</FormSplit>
< 	</div>
---
>   <div class="taeiyria">
>     <div class="query">
>       <MkInput v-model="host" :debounce="true" class="">
>         <template #prefix><i class="fas fa-search"></i></template>
>         <template #label>{{ i18n.ts.host }}</template>
>       </MkInput>
>       <FormSplit style="margin-top: var(--margin)">
>         <MkSelect v-model="state">
>           <template #label>{{ i18n.ts.state }}</template>
>           <option value="all">{{ i18n.ts.all }}</option>
>           <option value="federating">{{ i18n.ts.federating }}</option>
>           <option value="subscribing">{{ i18n.ts.subscribing }}</option>
>           <option value="publishing">{{ i18n.ts.publishing }}</option>
>           <option value="suspended">{{ i18n.ts.suspended }}</option>
>           <option value="blocked">{{ i18n.ts.blocked }}</option>
>           <option value="notResponding">{{ i18n.ts.notResponding }}</option>
>         </MkSelect>
>         <MkSelect v-model="sort">
>           <template #label>{{ i18n.ts.sort }}</template>
>           <option value="+pubSub">
>             {{ i18n.ts.pubSub }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-pubSub">
>             {{ i18n.ts.pubSub }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+notes">
>             {{ i18n.ts.notes }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-notes">
>             {{ i18n.ts.notes }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+users">
>             {{ i18n.ts.users }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-users">
>             {{ i18n.ts.users }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+following">
>             {{ i18n.ts.following }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-following">
>             {{ i18n.ts.following }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+followers">
>             {{ i18n.ts.followers }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-followers">
>             {{ i18n.ts.followers }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+caughtAt">
>             {{ i18n.ts.registeredAt }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-caughtAt">
>             {{ i18n.ts.registeredAt }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>           <option value="+lastCommunicatedAt">
>             {{ i18n.ts.lastCommunication }} ({{ i18n.ts.descendingOrder }})
>           </option>
>           <option value="-lastCommunicatedAt">
>             {{ i18n.ts.lastCommunication }} ({{ i18n.ts.ascendingOrder }})
>           </option>
>         </MkSelect>
>       </FormSplit>
>     </div>
37,44c67,89
< 	<MkPagination v-slot="{items}" ref="instances" :key="host + state" :pagination="pagination">
< 		<div class="dqokceoi">
< 			<MkA v-for="instance in items" :key="instance.id" v-tooltip.mfm="`Status: ${getStatus(instance)}`" class="instance" :to="`/instance-info/${instance.host}`">
< 				<MkInstanceCardMini :instance="instance"/>
< 			</MkA>
< 		</div>
< 	</MkPagination>
< </div>
---
>     <MkPagination
>       v-slot="{ items }"
>       ref="instances"
>       :key="host + state"
>       :pagination="pagination"
>     >
>       <div class="dqokceoi">
>         <MkA
>           v-for="instance in items"
>           :key="instance.id"
>           v-tooltip.mfm="
>             `Last communicated: ${new Date(
>               instance.lastCommunicatedAt
>             ).toLocaleString()}\nStatus: ${getStatus(instance)}`
>           "
>           class="instance"
>           :to="`/instance-info/${instance.host}`"
>         >
>           <MkInstanceCardMini :instance="instance" />
>         </MkA>
>       </div>
>     </MkPagination>
>   </div>
48,57c93,101
< import { computed } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkInstanceCardMini from '@/components/MkInstanceCardMini.vue';
< import FormSplit from '@/components/form/split.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { dateString } from '@/filters/date';
---
> import { computed } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkInstanceCardMini from "@/components/MkInstanceCardMini.vue";
> import FormSplit from "@/components/form/split.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
59,61c103,105
< let host = $ref('');
< let state = $ref('federating');
< let sort = $ref('+pubSub');
---
> let host = $ref("");
> let state = $ref("federating");
> let sort = $ref("+pubSub");
63,77c107,126
< 	endpoint: 'federation/instances' as const,
< 	limit: 10,
< 	offsetMode: true,
< 	params: computed(() => ({
< 		sort: sort,
< 		host: host !== '' ? host : null,
< 		...(
< 			state === 'federating' ? { federating: true } :
< 			state === 'subscribing' ? { subscribing: true } :
< 			state === 'publishing' ? { publishing: true } :
< 			state === 'suspended' ? { suspended: true } :
< 			state === 'blocked' ? { blocked: true } :
< 			state === 'notResponding' ? { notResponding: true } :
< 			{}),
< 	})),
---
>   endpoint: "federation/instances" as const,
>   limit: 10,
>   offsetMode: true,
>   params: computed(() => ({
>     sort: sort,
>     host: host !== "" ? host : null,
>     ...(state === "federating"
>       ? { federating: true }
>       : state === "subscribing"
>       ? { subscribing: true }
>       : state === "publishing"
>       ? { publishing: true }
>       : state === "suspended"
>       ? { suspended: true }
>       : state === "blocked"
>       ? { blocked: true }
>       : state === "notResponding"
>       ? { notResponding: true }
>       : {}),
>   })),
81,84c130,133
< 	if (instance.isSuspended) return 'Suspended';
< 	if (instance.isBlocked) return 'Blocked';
< 	if (instance.isNotResponding) return 'Error';
< 	return 'Alive';
---
>   if (instance.isSuspended) return "Suspended";
>   if (instance.isBlocked) return "Blocked";
>   if (instance.isNotResponding) return "Error";
>   return "Alive";
90,93c139,142
< 	> .query {
< 		background: var(--bg);
< 		margin-bottom: 16px;
< 	}
---
>   > .query {
>     background: var(--bg);
>     margin-bottom: 16px;
>   }
97,99c146,148
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
< 	grid-gap: 12px;
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
>   grid-gap: 12px;
101,103c150,152
< 	> .instance:hover {
< 		text-decoration: none;
< 	}
---
>   > .instance:hover {
>     text-decoration: none;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/about.vue RiricaV13/pages/about.vue
2,13c2,25
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer v-if="tab === 'overview'" :content-max="600" :margin-min="20">
< 		<div class="_gaps_m">
< 			<div class="fwhjspax" :style="{ backgroundImage: `url(${ $instance.bannerUrl })` }">
< 				<div class="content">
< 					<img :src="$instance.iconUrl ?? $instance.faviconUrl ?? '/favicon.ico'" alt="" class="icon"/>
< 					<div class="name">
< 						<b>{{ $instance.name ?? host }}</b>
< 					</div>
< 				</div>
< 			</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer v-if="tab === 'overview'" :content-max="600" :margin-min="20">
>       <div class="_formRoot">
>         <div
>           class="_formBlock fwhjspax"
>           :style="{ backgroundImage: `url(${$instance.bannerUrl})` }"
>         >
>           <div class="content">
>             <img
>               :src="$instance.iconUrl ?? $instance.faviconUrl ?? '/favicon.ico'"
>               alt=""
>               class="icon"
>             />
>             <div class="name">
>               <b>{{ $instance.name ?? host }}</b>
>             </div>
>           </div>
>         </div>
15,18c27,30
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.description }}</template>
< 				<template #value><div v-html="$instance.description"></div></template>
< 			</MkKeyValue>
---
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.description }}</template>
>           <template #value><div v-html="$instance.description"></div></template>
>         </MkKeyValue>
20,30c32,46
< 			<FormSection>
< 				<div class="_gaps_m">
< 					<MkKeyValue :copy="version">
< 						<template #key>Misskey</template>
< 						<template #value>{{ version }}</template>
< 					</MkKeyValue>
< 					<div v-html="i18n.t('poweredByMisskeyDescription', { name: $instance.name ?? host })">
< 					</div>
< 					<FormLink to="/about-misskey">{{ i18n.ts.aboutMisskey }}</FormLink>
< 				</div>
< 			</FormSection>
---
>         <FormSection>
>           <MkKeyValue class="_formBlock" :copy="version">
>             <template #key>Misskey</template>
>             <template #value>{{ version }}</template>
>           </MkKeyValue>
>           <div
>             class="_formBlock"
>             v-html="
>               i18n.t('poweredByMisskeyDescription', {
>                 name: $instance.name ?? host,
>               })
>             "
>           ></div>
>           <FormLink to="/about-misskey">{{ i18n.ts.aboutMisskey }}</FormLink>
>         </FormSection>
32,46c48,66
< 			<FormSection>
< 				<div class="_gaps_m">
< 					<FormSplit>
< 						<MkKeyValue>
< 							<template #key>{{ i18n.ts.administrator }}</template>
< 							<template #value>{{ $instance.maintainerName }}</template>
< 						</MkKeyValue>
< 						<MkKeyValue>
< 							<template #key>{{ i18n.ts.contact }}</template>
< 							<template #value>{{ $instance.maintainerEmail }}</template>
< 						</MkKeyValue>
< 					</FormSplit>
< 					<FormLink v-if="$instance.tosUrl" :to="$instance.tosUrl" external>{{ i18n.ts.tos }}</FormLink>
< 				</div>
< 			</FormSection>
---
>         <FormSection>
>           <FormSplit>
>             <MkKeyValue class="_formBlock">
>               <template #key>{{ i18n.ts.administrator }}</template>
>               <template #value>{{ $instance.maintainerName }}</template>
>             </MkKeyValue>
>             <MkKeyValue class="_formBlock">
>               <template #key>{{ i18n.ts.contact }}</template>
>               <template #value>{{ $instance.maintainerEmail }}</template>
>             </MkKeyValue>
>           </FormSplit>
>           <FormLink
>             v-if="$instance.tosUrl"
>             :to="$instance.tosUrl"
>             class="_formBlock"
>             external
>             >{{ i18n.ts.tos }}</FormLink
>           >
>         </FormSection>
48,62c68,86
< 			<FormSuspense :p="initStats">
< 				<FormSection>
< 					<template #label>{{ i18n.ts.statistics }}</template>
< 					<FormSplit>
< 						<MkKeyValue>
< 							<template #key>{{ i18n.ts.users }}</template>
< 							<template #value>{{ number(stats.originalUsersCount) }}</template>
< 						</MkKeyValue>
< 						<MkKeyValue>
< 							<template #key>{{ i18n.ts.notes }}</template>
< 							<template #value>{{ number(stats.originalNotesCount) }}</template>
< 						</MkKeyValue>
< 					</FormSplit>
< 				</FormSection>
< 			</FormSuspense>
---
>         <FormSuspense :p="initStats">
>           <FormSection>
>             <template #label>{{ i18n.ts.statistics }}</template>
>             <FormSplit>
>               <MkKeyValue class="_formBlock">
>                 <template #key>{{ i18n.ts.users }}</template>
>                 <template #value>{{
>                   number(stats.originalUsersCount)
>                 }}</template>
>               </MkKeyValue>
>               <MkKeyValue class="_formBlock">
>                 <template #key>{{ i18n.ts.notes }}</template>
>                 <template #value>{{
>                   number(stats.originalNotesCount)
>                 }}</template>
>               </MkKeyValue>
>             </FormSplit>
>           </FormSection>
>         </FormSuspense>
64,85c88,117
< 			<FormSection>
< 				<template #label>Well-known resources</template>
< 				<div class="_formLinks">
< 					<FormLink :to="`/.well-known/host-meta`" external>host-meta</FormLink>
< 					<FormLink :to="`/.well-known/host-meta.json`" external>host-meta.json</FormLink>
< 					<FormLink :to="`/.well-known/nodeinfo`" external>nodeinfo</FormLink>
< 					<FormLink :to="`/robots.txt`" external>robots.txt</FormLink>
< 					<FormLink :to="`/manifest.json`" external>manifest.json</FormLink>
< 				</div>
< 			</FormSection>
< 		</div>
< 	</MkSpacer>
< 	<MkSpacer v-else-if="tab === 'emojis'" :content-max="1000" :margin-min="20">
< 		<XEmojis/>
< 	</MkSpacer>
< 	<MkSpacer v-else-if="tab === 'federation'" :content-max="1000" :margin-min="20">
< 		<XFederation/>
< 	</MkSpacer>
< 	<MkSpacer v-else-if="tab === 'charts'" :content-max="1000" :margin-min="20">
< 		<MkInstanceStats/>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <FormSection>
>           <template #label>Well-known resources</template>
>           <div class="_formLinks">
>             <FormLink :to="`/.well-known/host-meta`" external
>               >host-meta</FormLink
>             >
>             <FormLink :to="`/.well-known/host-meta.json`" external
>               >host-meta.json</FormLink
>             >
>             <FormLink :to="`/.well-known/nodeinfo`" external>nodeinfo</FormLink>
>             <FormLink :to="`/robots.txt`" external>robots.txt</FormLink>
>             <FormLink :to="`/manifest.json`" external>manifest.json</FormLink>
>           </div>
>         </FormSection>
>       </div>
>     </MkSpacer>
>     <MkSpacer v-else-if="tab === 'emojis'" :content-max="1000" :margin-min="20">
>       <XEmojis />
>     </MkSpacer>
>     <MkSpacer
>       v-else-if="tab === 'federation'"
>       :content-max="1000"
>       :margin-min="20"
>     >
>       <XFederation />
>     </MkSpacer>
>     <MkSpacer v-else-if="tab === 'charts'" :content-max="1000" :margin-min="20">
>       <MkInstanceStats :chart-limit="500" :detailed="true" />
>     </MkSpacer>
>   </MkStickyContainer>
89,103c121,134
< import { ref, computed, watch } from 'vue';
< import XEmojis from './about.emojis.vue';
< import XFederation from './about.federation.vue';
< import { version, instanceName, host } from '@/config';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import FormSplit from '@/components/form/split.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkInstanceStats from '@/components/MkInstanceStats.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { ref, computed } from "vue";
> import XEmojis from "./about.emojis.vue";
> import XFederation from "./about.federation.vue";
> import { version, instanceName, host } from "@/config";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormSplit from "@/components/form/split.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import MkInstanceStats from "@/components/MkInstanceStats.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
105,109c136,143
< const props = withDefaults(defineProps<{
< 	initialTab?: string;
< }>(), {
< 	initialTab: 'overview',
< });
---
> const props = withDefaults(
>   defineProps<{
>     initialTab?: string;
>   }>(),
>   {
>     initialTab: "overview",
>   }
> );
114,118c148,151
< watch($$(tab), () => {
< 	if (tab === 'charts') {
< 		claimAchievement('viewInstanceChart');
< 	}
< });
---
> const initStats = () =>
>   os.api("stats", {}).then((res) => {
>     stats = res;
>   });
120,124d152
< const initStats = () => os.api('stats', {
< }).then((res) => {
< 	stats = res;
< });
< 
127,142c155,175
< const headerTabs = $computed(() => [{
< 	key: 'overview',
< 	title: i18n.ts.overview,
< }, {
< 	key: 'emojis',
< 	title: i18n.ts.customEmojis,
< 	icon: 'ti ti-icons',
< }, {
< 	key: 'federation',
< 	title: i18n.ts.federation,
< 	icon: 'ti ti-whirl',
< }, {
< 	key: 'charts',
< 	title: i18n.ts.charts,
< 	icon: 'ti ti-chart-line',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "overview",
>     title: i18n.ts.overview,
>   },
>   {
>     key: "emojis",
>     title: i18n.ts.customEmojis,
>     icon: "fas fa-laugh",
>   },
>   {
>     key: "federation",
>     title: i18n.ts.federation,
>     icon: "fas fa-globe",
>   },
>   {
>     key: "charts",
>     title: i18n.ts.charts,
>     icon: "fas fa-chart-simple",
>   },
> ]);
144,147c177,182
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.instanceInfo,
< 	icon: 'ti ti-info-circle',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.instanceInfo,
>     icon: "fas fa-info-circle",
>   }))
> );
152,156c187,191
< 	text-align: center;
< 	border-radius: 10px;
< 	overflow: clip;
< 	background-size: cover;
< 	background-position: center center;
---
>   text-align: center;
>   border-radius: 10px;
>   overflow: clip;
>   background-size: cover;
>   background-position: center center;
158,159c193,194
< 	> .content {
< 		overflow: hidden;
---
>   > .content {
>     overflow: hidden;
161,166c196,201
< 		> .icon {
< 			display: block;
< 			margin: 16px auto 0 auto;
< 			height: 64px;
< 			border-radius: 8px;
< 		}
---
>     > .icon {
>       display: block;
>       margin: 16px auto 0 auto;
>       height: 64px;
>       border-radius: 8px;
>     }
168,175c203,210
< 		> .name {
< 			display: block;
< 			padding: 16px;
< 			color: #fff;
< 			text-shadow: 0 0 8px #000;
< 			background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
< 		}
< 	}
---
>     > .name {
>       display: block;
>       padding: 16px;
>       color: #fff;
>       text-shadow: 0 0 8px #000;
>       background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
>     }
>   }
Only in misskeyV13/packages/frontend/src/pages: achievements.vue
Only in misskeyV13/packages/frontend/src/pages/admin: RolesEditorFormula.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/_header_.vue RiricaV13/pages/admin/_header_.vue
2,5c2,5
< <div ref="el" class="fdidabkc" :style="{ background: bg }" @click="onClick">
< 	<template v-if="metadata">
< 		<div class="titleContainer" @click="showTabsPopup">
< 			<i v-if="metadata.icon" class="icon" :class="metadata.icon"></i>
---
>   <div ref="el" class="fdidabkc" :style="{ background: bg }" @click="onClick">
>     <template v-if="metadata">
>       <div class="titleContainer" @click="showTabsPopup">
>         <i v-if="metadata.icon" class="icon" :class="metadata.icon"></i>
7,27c7,51
< 			<div class="title">
< 				<div class="title">{{ metadata.title }}</div>
< 			</div>
< 		</div>
< 		<div class="tabs">
< 			<button v-for="tab in tabs" :ref="(el) => tabRefs[tab.key] = el" v-tooltip.noDelay="tab.title" class="tab _button" :class="{ active: tab.key != null && tab.key === props.tab }" @mousedown="(ev) => onTabMousedown(tab, ev)" @click="(ev) => onTabClick(tab, ev)">
< 				<i v-if="tab.icon" class="icon" :class="tab.icon"></i>
< 				<span v-if="!tab.iconOnly" class="title">{{ tab.title }}</span>
< 			</button>
< 			<div ref="tabHighlightEl" class="highlight"></div>
< 		</div>
< 	</template>
< 	<div class="buttons right">
< 		<template v-if="actions">
< 			<template v-for="action in actions">
< 				<MkButton v-if="action.asFullButton" class="fullButton" primary @click.stop="action.handler"><i :class="action.icon" style="margin-right: 6px;"></i>{{ action.text }}</MkButton>
< 				<button v-else v-tooltip.noDelay="action.text" class="_button button" :class="{ highlighted: action.highlighted }" @click.stop="action.handler" @touchstart="preventDrag"><i :class="action.icon"></i></button>
< 			</template>
< 		</template>
< 	</div>
< </div>
---
>         <div class="title">
>           <div class="title">{{ metadata.title }}</div>
>         </div>
>       </div>
>       <div class="tabs">
>         <button
>           v-for="tab in tabs"
>           :ref="(el) => (tabRefs[tab.key] = el)"
>           v-tooltip.noDelay="tab.title"
>           class="tab _button"
>           :class="{ active: tab.key != null && tab.key === props.tab }"
>           @mousedown="(ev) => onTabMousedown(tab, ev)"
>           @click="(ev) => onTabClick(tab, ev)"
>         >
>           <i v-if="tab.icon" class="icon" :class="tab.icon"></i>
>           <span v-if="!tab.iconOnly" class="title">{{ tab.title }}</span>
>         </button>
>         <div ref="tabHighlightEl" class="highlight"></div>
>       </div>
>     </template>
>     <div class="buttons right">
>       <template v-if="actions">
>         <template v-for="action in actions">
>           <MkButton
>             v-if="action.asFullButton"
>             class="fullButton"
>             primary
>             @click.stop="action.handler"
>             ><i :class="action.icon" style="margin-right: 6px"></i
>             >{{ action.text }}</MkButton
>           >
>           <button
>             v-else
>             v-tooltip.noDelay="action.text"
>             class="_button button"
>             :class="{ highlighted: action.highlighted }"
>             @click.stop="action.handler"
>             @touchstart="preventDrag"
>           >
>             <i :class="action.icon"></i>
>           </button>
>         </template>
>       </template>
>     </div>
>   </div>
31,39c55,71
< import { computed, onMounted, onUnmounted, ref, shallowRef, inject, watch, nextTick } from 'vue';
< import tinycolor from 'tinycolor2';
< import { popupMenu } from '@/os';
< import { url } from '@/config';
< import { scrollToTop } from '@/scripts/scroll';
< import MkButton from '@/components/MkButton.vue';
< import { i18n } from '@/i18n';
< import { globalEvents } from '@/events';
< import { injectPageMetadata } from '@/scripts/page-metadata';
---
> import {
>   computed,
>   onMounted,
>   onUnmounted,
>   ref,
>   inject,
>   watch,
>   nextTick,
> } from "vue";
> import tinycolor from "tinycolor2";
> import { popupMenu } from "@/os";
> import { url } from "@/config";
> import { scrollToTop } from "@/scripts/scroll";
> import MkButton from "@/components/MkButton.vue";
> import { i18n } from "@/i18n";
> import { globalEvents } from "@/events";
> import { injectPageMetadata } from "@/scripts/page-metadata";
42,46c74,78
< 	key?: string | null;
< 	title: string;
< 	icon?: string;
< 	iconOnly?: boolean;
< 	onClick?: (ev: MouseEvent) => void;
---
>   key?: string | null;
>   title: string;
>   icon?: string;
>   iconOnly?: boolean;
>   onClick?: (ev: MouseEvent) => void;
50,58c82,90
< 	tabs?: Tab[];
< 	tab?: string;
< 	actions?: {
< 		text: string;
< 		icon: string;
< 		asFullButton?: boolean;
< 		handler: (ev: MouseEvent) => void;
< 	}[];
< 	thin?: boolean;
---
>   tabs?: Tab[];
>   tab?: string;
>   actions?: {
>     text: string;
>     icon: string;
>     asFullButton?: boolean;
>     handler: (ev: MouseEvent) => void;
>   }[];
>   thin?: boolean;
62c94
< 	(ev: 'update:tab', key: string);
---
>   (ev: "update:tab", key: string);
67c99
< const el = shallowRef<HTMLElement>(null);
---
> const el = ref<HTMLElement>(null);
69c101
< const tabHighlightEl = $shallowRef<HTMLElement | null>(null);
---
> const tabHighlightEl = $ref<HTMLElement | null>(null);
73c105
< 	return props.tabs && props.tabs.length > 0;
---
>   return props.tabs && props.tabs.length > 0;
77,88c109,120
< 	if (!hasTabs.value) return;
< 	ev.preventDefault();
< 	ev.stopPropagation();
< 	const menu = props.tabs.map(tab => ({
< 		text: tab.title,
< 		icon: tab.icon,
< 		active: tab.key != null && tab.key === props.tab,
< 		action: (ev) => {
< 			onTabClick(tab, ev);
< 		},
< 	}));
< 	popupMenu(menu, ev.currentTarget ?? ev.target);
---
>   if (!hasTabs.value) return;
>   ev.preventDefault();
>   ev.stopPropagation();
>   const menu = props.tabs.map((tab) => ({
>     text: tab.title,
>     icon: tab.icon,
>     active: tab.key != null && tab.key === props.tab,
>     action: (ev) => {
>       onTabClick(tab, ev);
>     },
>   }));
>   popupMenu(menu, ev.currentTarget ?? ev.target);
92c124
< 	ev.stopPropagation();
---
>   ev.stopPropagation();
96c128
< 	scrollToTop(el.value, { behavior: 'smooth' });
---
>   scrollToTop(el.value, { behavior: "smooth" });
100,103c132,135
< 	// ユーザビリティの観点からmousedown時にはonClickは呼ばない
< 	if (tab.key) {
< 		emit('update:tab', tab.key);
< 	}
---
>   // ユーザビリティの観点からmousedown時にはonClickは呼ばない
>   if (tab.key) {
>     emit("update:tab", tab.key);
>   }
107,114c139,146
< 	if (tab.onClick) {
< 		ev.preventDefault();
< 		ev.stopPropagation();
< 		tab.onClick(ev);
< 	}
< 	if (tab.key) {
< 		emit('update:tab', tab.key);
< 	}
---
>   if (tab.onClick) {
>     ev.preventDefault();
>     ev.stopPropagation();
>     tab.onClick(ev);
>   }
>   if (tab.key) {
>     emit("update:tab", tab.key);
>   }
118,121c150,159
< 	const rawBg = metadata?.bg || 'var(--bg)';
< 	const tinyBg = tinycolor(rawBg.startsWith('var(') ? getComputedStyle(document.documentElement).getPropertyValue(rawBg.slice(4, -1)) : rawBg);
< 	tinyBg.setAlpha(0.85);
< 	bg.value = tinyBg.toRgbString();
---
>   const rawBg = metadata?.bg || "var(--bg)";
>   const tinyBg = tinycolor(
>     rawBg.startsWith("var(")
>       ? getComputedStyle(document.documentElement).getPropertyValue(
>           rawBg.slice(4, -1)
>         )
>       : rawBg
>   );
>   tinyBg.setAlpha(0.85);
>   bg.value = tinyBg.toRgbString();
125,126c163,164
< 	calcBg();
< 	globalEvents.on('themeChanged', calcBg);
---
>   calcBg();
>   globalEvents.on("themeChanged", calcBg);
128,142c166,184
< 	watch(() => [props.tab, props.tabs], () => {
< 		nextTick(() => {
< 			const tabEl = tabRefs[props.tab];
< 			if (tabEl && tabHighlightEl) {
< 				// offsetWidth や offsetLeft は少数を丸めてしまうため getBoundingClientRect を使う必要がある
< 				// https://developer.mozilla.org/ja/docs/Web/API/HTMLElement/offsetWidth#%E5%80%A4
< 				const parentRect = tabEl.parentElement.getBoundingClientRect();
< 				const rect = tabEl.getBoundingClientRect();
< 				tabHighlightEl.style.width = rect.width + 'px';
< 				tabHighlightEl.style.left = (rect.left - parentRect.left) + 'px';
< 			}
< 		});
< 	}, {
< 		immediate: true,
< 	});
---
>   watch(
>     () => [props.tab, props.tabs],
>     () => {
>       nextTick(() => {
>         const tabEl = tabRefs[props.tab];
>         if (tabEl && tabHighlightEl) {
>           // offsetWidth や offsetLeft は少数を丸めてしまうため getBoundingClientRect を使う必要がある
>           // https://developer.mozilla.org/ja/docs/Web/API/HTMLElement/offsetWidth#%E5%80%A4
>           const parentRect = tabEl.parentElement.getBoundingClientRect();
>           const rect = tabEl.getBoundingClientRect();
>           tabHighlightEl.style.width = rect.width + "px";
>           tabHighlightEl.style.left = rect.left - parentRect.left + "px";
>         }
>       });
>     },
>     {
>       immediate: true,
>     }
>   );
146c188
< 	globalEvents.off('themeChanged', calcBg);
---
>   globalEvents.off("themeChanged", calcBg);
152,156c194,198
< 	--height: 60px;
< 	display: flex;
< 	width: 100%;
< 	-webkit-backdrop-filter: var(--blur, blur(15px));
< 	backdrop-filter: var(--blur, blur(15px));
---
>   --height: 60px;
>   display: flex;
>   width: 100%;
>   -webkit-backdrop-filter: var(--blur, blur(15px));
>   backdrop-filter: var(--blur, blur(15px));
158,160c200,202
< 	> .buttons {
< 		--margin: 8px;
< 		display: flex;
---
>   > .buttons {
>     --margin: 8px;
>     display: flex;
162,163c204,205
< 		height: var(--height);
< 		margin: 0 var(--margin);
---
>     height: var(--height);
>     margin: 0 var(--margin);
165,167c207,209
< 		&.right {
< 			margin-left: auto;
< 		}
---
>     &.right {
>       margin-left: auto;
>     }
169,171c211,213
< 		&:empty {
< 			width: var(--height);
< 		}
---
>     &:empty {
>       width: var(--height);
>     }
173,181c215,223
< 		> .button {
< 			display: flex;
< 			align-items: center;
< 			justify-content: center;
< 			height: calc(var(--height) - (var(--margin) * 2));
< 			width: calc(var(--height) - (var(--margin) * 2));
< 			box-sizing: border-box;
< 			position: relative;
< 			border-radius: 5px;
---
>     > .button {
>       display: flex;
>       align-items: center;
>       justify-content: center;
>       height: calc(var(--height) - (var(--margin) * 2));
>       width: calc(var(--height) - (var(--margin) * 2));
>       box-sizing: border-box;
>       position: relative;
>       border-radius: 5px;
183,185c225,227
< 			&:hover {
< 				background: rgba(0, 0, 0, 0.05);
< 			}
---
>       &:hover {
>         background: rgba(0, 0, 0, 0.05);
>       }
187,190c229,232
< 			&.highlighted {
< 				color: var(--accent);
< 			}
< 		}
---
>       &.highlighted {
>         color: var(--accent);
>       }
>     }
192,197c234,239
< 		> .fullButton {
< 			& + .fullButton {
< 				margin-left: 12px;
< 			}
< 		}
< 	}
---
>     > .fullButton {
>       & + .fullButton {
>         margin-left: 12px;
>       }
>     }
>   }
199,208c241,250
< 	> .titleContainer {
< 		display: flex;
< 		align-items: center;
< 		max-width: 400px;
< 		overflow: auto;
< 		white-space: nowrap;
< 		text-align: left;
< 		font-weight: bold;
< 		flex-shrink: 0;
< 		margin-left: 24px;
---
>   > .titleContainer {
>     display: flex;
>     align-items: center;
>     max-width: 400px;
>     overflow: auto;
>     white-space: nowrap;
>     text-align: left;
>     font-weight: bold;
>     flex-shrink: 0;
>     margin-left: 24px;
210,218c252,260
< 		> .avatar {
< 			$size: 32px;
< 			display: inline-block;
< 			width: $size;
< 			height: $size;
< 			vertical-align: bottom;
< 			margin: 0 8px;
< 			pointer-events: none;
< 		}
---
>     > .avatar {
>       $size: 32px;
>       display: inline-block;
>       width: $size;
>       height: $size;
>       vertical-align: bottom;
>       margin: 0 8px;
>       pointer-events: none;
>     }
220,224c262,266
< 		> .icon {
< 			margin-right: 8px;
< 			width: 16px;
< 			text-align: center;
< 		}
---
>     > .icon {
>       margin-right: 8px;
>       width: 16px;
>       text-align: center;
>     }
226,231c268,273
< 		> .title {
< 			min-width: 0;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			white-space: nowrap;
< 			line-height: 1.1;
---
>     > .title {
>       min-width: 0;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       white-space: nowrap;
>       line-height: 1.1;
233,239c275,281
< 			> .subtitle {
< 				opacity: 0.6;
< 				font-size: 0.8em;
< 				font-weight: normal;
< 				white-space: nowrap;
< 				overflow: hidden;
< 				text-overflow: ellipsis;
---
>       > .subtitle {
>         opacity: 0.6;
>         font-size: 0.8em;
>         font-weight: normal;
>         white-space: nowrap;
>         overflow: hidden;
>         text-overflow: ellipsis;
241,242c283,284
< 				&.activeTab {
< 					text-align: center;
---
>         &.activeTab {
>           text-align: center;
244,251c286,293
< 					> .chevron {
< 						display: inline-block;
< 						margin-left: 6px;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > .chevron {
>             display: inline-block;
>             margin-left: 6px;
>           }
>         }
>       }
>     }
>   }
253,258c295,300
< 	> .tabs {
< 		position: relative;
< 		margin-left: 16px;
< 		font-size: 0.8em;
< 		overflow: auto;
< 		white-space: nowrap;
---
>   > .tabs {
>     position: relative;
>     margin-left: 16px;
>     font-size: 0.8em;
>     overflow: auto;
>     white-space: nowrap;
260,266c302,308
< 		> .tab {
< 			display: inline-block;
< 			position: relative;
< 			padding: 0 10px;
< 			height: 100%;
< 			font-weight: normal;
< 			opacity: 0.7;
---
>     > .tab {
>       display: inline-block;
>       position: relative;
>       padding: 0 10px;
>       height: 100%;
>       font-weight: normal;
>       opacity: 0.7;
268,270c310,312
< 			&:hover {
< 				opacity: 1;
< 			}
---
>       &:hover {
>         opacity: 1;
>       }
272,274c314,316
< 			&.active {
< 				opacity: 1;
< 			}
---
>       &.active {
>         opacity: 1;
>       }
276,279c318,321
< 			> .icon + .title {
< 				margin-left: 8px;
< 			}
< 		}
---
>       > .icon + .title {
>         margin-left: 8px;
>       }
>     }
281,290c323,332
< 		> .highlight {
< 			position: absolute;
< 			bottom: 0;
< 			height: 3px;
< 			background: var(--accent);
< 			border-radius: 999px;
< 			transition: all 0.2s ease;
< 			pointer-events: none;
< 		}
< 	}
---
>     > .highlight {
>       position: absolute;
>       bottom: 0;
>       height: 3px;
>       background: var(--accent);
>       border-radius: 999px;
>       transition: all 0.2s ease;
>       pointer-events: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/abuses.vue RiricaV13/pages/admin/abuses.vue
2,28c2,30
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="900">
< 		<div class="lcixvhis">
< 			<div class="reports">
< 				<div class="">
< 					<div class="inputs" style="display: flex;">
< 						<MkSelect v-model="state" style="margin: 0; flex: 1;">
< 							<template #label>{{ i18n.ts.state }}</template>
< 							<option value="all">{{ i18n.ts.all }}</option>
< 							<option value="unresolved">{{ i18n.ts.unresolved }}</option>
< 							<option value="resolved">{{ i18n.ts.resolved }}</option>
< 						</MkSelect>
< 						<MkSelect v-model="targetUserOrigin" style="margin: 0; flex: 1;">
< 							<template #label>{{ i18n.ts.reporteeOrigin }}</template>
< 							<option value="combined">{{ i18n.ts.all }}</option>
< 							<option value="local">{{ i18n.ts.local }}</option>
< 							<option value="remote">{{ i18n.ts.remote }}</option>
< 						</MkSelect>
< 						<MkSelect v-model="reporterOrigin" style="margin: 0; flex: 1;">
< 							<template #label>{{ i18n.ts.reporterOrigin }}</template>
< 							<option value="combined">{{ i18n.ts.all }}</option>
< 							<option value="local">{{ i18n.ts.local }}</option>
< 							<option value="remote">{{ i18n.ts.remote }}</option>
< 						</MkSelect>
< 					</div>
< 					<!-- TODO
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="900">
>       <div class="lcixvhis">
>         <div class="_section reports">
>           <div class="_content">
>             <div class="inputs" style="display: flex">
>               <MkSelect v-model="state" style="margin: 0; flex: 1">
>                 <template #label>{{ i18n.ts.state }}</template>
>                 <option value="all">{{ i18n.ts.all }}</option>
>                 <option value="unresolved">{{ i18n.ts.unresolved }}</option>
>                 <option value="resolved">{{ i18n.ts.resolved }}</option>
>               </MkSelect>
>               <MkSelect v-model="targetUserOrigin" style="margin: 0; flex: 1">
>                 <template #label>{{ i18n.ts.reporteeOrigin }}</template>
>                 <option value="combined">{{ i18n.ts.all }}</option>
>                 <option value="local">{{ i18n.ts.local }}</option>
>                 <option value="remote">{{ i18n.ts.remote }}</option>
>               </MkSelect>
>               <MkSelect v-model="reporterOrigin" style="margin: 0; flex: 1">
>                 <template #label>{{ i18n.ts.reporterOrigin }}</template>
>                 <option value="combined">{{ i18n.ts.all }}</option>
>                 <option value="local">{{ i18n.ts.local }}</option>
>                 <option value="remote">{{ i18n.ts.remote }}</option>
>               </MkSelect>
>             </div>
>             <!-- TODO
39,46c41,58
< 					<MkPagination v-slot="{items}" ref="reports" :pagination="pagination" style="margin-top: var(--margin);">
< 						<XAbuseReport v-for="report in items" :key="report.id" :report="report" @resolved="resolved"/>
< 					</MkPagination>
< 				</div>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>             <MkPagination
>               v-slot="{ items }"
>               ref="reports"
>               :pagination="pagination"
>               style="margin-top: var(--margin)"
>             >
>               <XAbuseReport
>                 v-for="report in items"
>                 :key="report.id"
>                 :report="report"
>                 @resolved="resolved"
>               />
>             </MkPagination>
>           </div>
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
50c62
< import { computed } from 'vue';
---
> import { computed } from "vue";
52,59c64,71
< import XHeader from './_header_.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import XAbuseReport from '@/components/MkAbuseReport.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import XHeader from "./_header_.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import XAbuseReport from "@/components/MkAbuseReport.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
61c73
< let reports = $shallowRef<InstanceType<typeof MkPagination>>();
---
> let reports = $ref<InstanceType<typeof MkPagination>>();
63,67c75,79
< let state = $ref('unresolved');
< let reporterOrigin = $ref('combined');
< let targetUserOrigin = $ref('combined');
< let searchUsername = $ref('');
< let searchHost = $ref('');
---
> let state = $ref("unresolved");
> let reporterOrigin = $ref("combined");
> let targetUserOrigin = $ref("combined");
> let searchUsername = $ref("");
> let searchHost = $ref("");
70,76c82,88
< 	endpoint: 'admin/abuse-user-reports' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		state,
< 		reporterOrigin,
< 		targetUserOrigin,
< 	})),
---
>   endpoint: "admin/abuse-user-reports" as const,
>   limit: 10,
>   params: computed(() => ({
>     state,
>     reporterOrigin,
>     targetUserOrigin,
>   })),
80c92
< 	reports.removeItem(item => item.id === reportId);
---
>   reports.removeItem((item) => item.id === reportId);
88,89c100,101
< 	title: i18n.ts.abuseReports,
< 	icon: 'ti ti-exclamation-circle',
---
>   title: i18n.ts.abuseReports,
>   icon: "fas fa-exclamation-circle",
95c107
< 	margin: var(--margin);
---
>   margin: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/ads.vue RiricaV13/pages/admin/ads.vue
2,20c2,22
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="900">
< 		<div class="uqshojas">
< 			<div v-for="ad in ads" class="_panel _gaps_m ad">
< 				<MkAd v-if="ad.url" :specify="ad"/>
< 				<MkInput v-model="ad.url" type="url">
< 					<template #label>URL</template>
< 				</MkInput>
< 				<MkInput v-model="ad.imageUrl">
< 					<template #label>{{ i18n.ts.imageUrl }}</template>
< 				</MkInput>
< 				<MkRadios v-model="ad.place">
< 					<template #label>Form</template>
< 					<option value="square">square</option>
< 					<option value="horizontal">horizontal</option>
< 					<option value="horizontal-big">horizontal-big</option>
< 				</MkRadios>
< 				<!--
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="900">
>       <div class="uqshojas">
>         <div v-for="ad in ads" class="_panel _formRoot ad">
>           <MkAd v-if="ad.url" :specify="ad" />
>           <MkInput v-model="ad.url" type="url" class="_formBlock">
>             <template #label>URL</template>
>           </MkInput>
>           <MkInput v-model="ad.imageUrl" class="_formBlock">
>             <template #label>{{ i18n.ts.imageUrl }}</template>
>           </MkInput>
>           <FormRadios v-model="ad.place" class="_formBlock">
>             <template #label>Form</template>
>             <option value="square">square</option>
>             <option value="horizontal">horizontal</option>
>             <option value="horizontal-big">horizontal-big</option>
>           </FormRadios>
>           <!--
28,46c30,57
< 				<FormSplit>
< 					<MkInput v-model="ad.ratio" type="number">
< 						<template #label>{{ i18n.ts.ratio }}</template>
< 					</MkInput>
< 					<MkInput v-model="ad.expiresAt" type="date">
< 						<template #label>{{ i18n.ts.expiration }}</template>
< 					</MkInput>
< 				</FormSplit>
< 				<MkTextarea v-model="ad.memo">
< 					<template #label>{{ i18n.ts.memo }}</template>
< 				</MkTextarea>
< 				<div class="buttons">
< 					<MkButton class="button" inline primary style="margin-right: 12px;" @click="save(ad)"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 					<MkButton class="button" inline danger @click="remove(ad)"><i class="ti ti-trash"></i> {{ i18n.ts.remove }}</MkButton>
< 				</div>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>           <FormSplit>
>             <MkInput v-model="ad.ratio" type="number">
>               <template #label>{{ i18n.ts.ratio }}</template>
>             </MkInput>
>             <MkInput v-model="ad.expiresAt" type="date">
>               <template #label>{{ i18n.ts.expiration }}</template>
>             </MkInput>
>           </FormSplit>
>           <MkTextarea v-model="ad.memo" class="_formBlock">
>             <template #label>{{ i18n.ts.memo }}</template>
>           </MkTextarea>
>           <div class="buttons _formBlock">
>             <MkButton
>               class="button"
>               inline
>               primary
>               style="margin-right: 12px"
>               @click="save(ad)"
>               ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>             >
>             <MkButton class="button" inline danger @click="remove(ad)"
>               ><i class="fas fa-trash-alt"></i> {{ i18n.ts.remove }}</MkButton
>             >
>           </div>
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
50,59c61,70
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import FormSplit from '@/components/form/split.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormSplit from "@/components/form/split.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
63,64c74,75
< os.api('admin/ad/list').then(adsResponse => {
< 	ads = adsResponse;
---
> os.api("admin/ad/list").then((adsResponse) => {
>   ads = adsResponse;
68,77c79,88
< 	ads.unshift({
< 		id: null,
< 		memo: '',
< 		place: 'square',
< 		priority: 'middle',
< 		ratio: 1,
< 		url: '',
< 		imageUrl: null,
< 		expiresAt: null,
< 	});
---
>   ads.unshift({
>     id: null,
>     memo: "",
>     place: "square",
>     priority: "middle",
>     ratio: 1,
>     url: "",
>     imageUrl: null,
>     expiresAt: null,
>   });
81,90c92,101
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: ad.url }),
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
< 		ads = ads.filter(x => x !== ad);
< 		os.apiWithDialog('admin/ad/delete', {
< 			id: ad.id,
< 		});
< 	});
---
>   os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: ad.url }),
>   }).then(({ canceled }) => {
>     if (canceled) return;
>     ads = ads.filter((x) => x !== ad);
>     os.apiWithDialog("admin/ad/delete", {
>       id: ad.id,
>     });
>   });
94,104c105,115
< 	if (ad.id == null) {
< 		os.apiWithDialog('admin/ad/create', {
< 			...ad,
< 			expiresAt: new Date(ad.expiresAt).getTime(),
< 		});
< 	} else {
< 		os.apiWithDialog('admin/ad/update', {
< 			...ad,
< 			expiresAt: new Date(ad.expiresAt).getTime(),
< 		});
< 	}
---
>   if (ad.id == null) {
>     os.apiWithDialog("admin/ad/create", {
>       ...ad,
>       expiresAt: new Date(ad.expiresAt).getTime(),
>     });
>   } else {
>     os.apiWithDialog("admin/ad/update", {
>       ...ad,
>       expiresAt: new Date(ad.expiresAt).getTime(),
>     });
>   }
107,112c118,125
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.add,
< 	handler: add,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-plus",
>     text: i18n.ts.add,
>     handler: add,
>   },
> ]);
117,118c130,131
< 	title: i18n.ts.ads,
< 	icon: 'ti ti-ad',
---
>   title: i18n.ts.ads,
>   icon: "fas fa-audio-description",
124,125c137,138
< 	> .ad {
< 		padding: 32px;
---
>   > .ad {
>     padding: 32px;
127,130c140,143
< 		&:not(:last-child) {
< 			margin-bottom: var(--margin);
< 		}
< 	}
---
>     &:not(:last-child) {
>       margin-bottom: var(--margin);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/announcements.vue RiricaV13/pages/admin/announcements.vue
2,26c2,41
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="900">
< 		<div class="ztgjmzrw _gaps_m">
< 			<section v-for="announcement in announcements" class="">
< 				<div class="_panel _gaps_m" style="padding: 24px;">
< 					<MkInput v-model="announcement.title">
< 						<template #label>{{ i18n.ts.title }}</template>
< 					</MkInput>
< 					<MkTextarea v-model="announcement.text">
< 						<template #label>{{ i18n.ts.text }}</template>
< 					</MkTextarea>
< 					<MkInput v-model="announcement.imageUrl">
< 						<template #label>{{ i18n.ts.imageUrl }}</template>
< 					</MkInput>
< 					<p v-if="announcement.reads">{{ i18n.t('nUsersRead', { n: announcement.reads }) }}</p>
< 					<div class="buttons _buttons">
< 						<MkButton class="button" inline primary @click="save(announcement)"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 						<MkButton class="button" inline danger @click="remove(announcement)"><i class="ti ti-trash"></i> {{ i18n.ts.remove }}</MkButton>
< 					</div>
< 				</div>
< 			</section>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="900">
>       <div class="ztgjmzrw">
>         <section
>           v-for="announcement in announcements"
>           class="_card _gap announcements"
>         >
>           <div class="_content announcement">
>             <MkInput v-model="announcement.title">
>               <template #label>{{ i18n.ts.title }}</template>
>             </MkInput>
>             <MkTextarea v-model="announcement.text">
>               <template #label>{{ i18n.ts.text }}</template>
>             </MkTextarea>
>             <MkInput v-model="announcement.imageUrl">
>               <template #label>{{ i18n.ts.imageUrl }}</template>
>             </MkInput>
>             <p v-if="announcement.reads">
>               {{ i18n.t("nUsersRead", { n: announcement.reads }) }}
>             </p>
>             <div class="buttons">
>               <MkButton
>                 class="button"
>                 inline
>                 primary
>                 @click="save(announcement)"
>                 ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>               >
>               <MkButton class="button" inline @click="remove(announcement)"
>                 ><i class="fas fa-trash-alt"></i> {{ i18n.ts.remove }}</MkButton
>               >
>             </div>
>           </div>
>         </section>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
30,37c45,52
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
41,42c56,57
< os.api('admin/announcements/list').then(announcementResponse => {
< 	announcements = announcementResponse;
---
> os.api("admin/announcements/list").then((announcementResponse) => {
>   announcements = announcementResponse;
46,51c61,66
< 	announcements.unshift({
< 		id: null,
< 		title: '',
< 		text: '',
< 		imageUrl: null,
< 	});
---
>   announcements.unshift({
>     id: null,
>     title: "",
>     text: "",
>     imageUrl: null,
>   });
55,62c70,77
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: announcement.title }),
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
< 		announcements = announcements.filter(x => x !== announcement);
< 		os.api('admin/announcements/delete', announcement);
< 	});
---
>   os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: announcement.title }),
>   }).then(({ canceled }) => {
>     if (canceled) return;
>     announcements = announcements.filter((x) => x !== announcement);
>     os.api("admin/announcements/delete", announcement);
>   });
66,90c81,109
< 	if (announcement.id == null) {
< 		os.api('admin/announcements/create', announcement).then(() => {
< 			os.alert({
< 				type: 'success',
< 				text: i18n.ts.saved,
< 			});
< 		}).catch(err => {
< 			os.alert({
< 				type: 'error',
< 				text: err,
< 			});
< 		});
< 	} else {
< 		os.api('admin/announcements/update', announcement).then(() => {
< 			os.alert({
< 				type: 'success',
< 				text: i18n.ts.saved,
< 			});
< 		}).catch(err => {
< 			os.alert({
< 				type: 'error',
< 				text: err,
< 			});
< 		});
< 	}
---
>   if (announcement.id == null) {
>     os.api("admin/announcements/create", announcement)
>       .then(() => {
>         os.alert({
>           type: "success",
>           text: i18n.ts.saved,
>         });
>       })
>       .catch((err) => {
>         os.alert({
>           type: "error",
>           text: err,
>         });
>       });
>   } else {
>     os.api("admin/announcements/update", announcement)
>       .then(() => {
>         os.alert({
>           type: "success",
>           text: i18n.ts.saved,
>         });
>       })
>       .catch((err) => {
>         os.alert({
>           type: "error",
>           text: err,
>         });
>       });
>   }
93,98c112,119
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.add,
< 	handler: add,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-plus",
>     text: i18n.ts.add,
>     handler: add,
>   },
> ]);
103,104c124,125
< 	title: i18n.ts.announcements,
< 	icon: 'ti ti-speakerphone',
---
>   title: i18n.ts.announcements,
>   icon: "fas fa-broadcast-tower",
110c131
< 	margin: var(--margin);
---
>   margin: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/bot-protection.vue RiricaV13/pages/admin/bot-protection.vue
2,10c2,12
< <div>
< 	<FormSuspense :p="init">
< 		<div class="_gaps_m">
< 			<MkRadios v-model="provider">
< 				<option :value="null">{{ i18n.ts.none }} ({{ i18n.ts.notRecommended }})</option>
< 				<option value="hcaptcha">hCaptcha</option>
< 				<option value="recaptcha">reCAPTCHA</option>
< 				<option value="turnstile">Turnstile</option>
< 			</MkRadios>
---
>   <div>
>     <FormSuspense :p="init">
>       <div class="_formRoot">
>         <FormRadios v-model="provider" class="_formBlock">
>           <option :value="null">
>             {{ i18n.ts.none }} ({{ i18n.ts.notRecommended }})
>           </option>
>           <option value="hcaptcha">hCaptcha</option>
>           <option value="recaptcha">reCAPTCHA</option>
>           <option value="turnstile">Turnstile</option>
>         </FormRadios>
12,53c14,63
< 			<template v-if="provider === 'hcaptcha'">
< 				<MkInput v-model="hcaptchaSiteKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.hcaptchaSiteKey }}</template>
< 				</MkInput>
< 				<MkInput v-model="hcaptchaSecretKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.hcaptchaSecretKey }}</template>
< 				</MkInput>
< 				<FormSlot>
< 					<template #label>{{ i18n.ts.preview }}</template>
< 					<MkCaptcha provider="hcaptcha" :sitekey="hcaptchaSiteKey || '10000000-ffff-ffff-ffff-000000000001'"/>
< 				</FormSlot>
< 			</template>
< 			<template v-else-if="provider === 'recaptcha'">
< 				<MkInput v-model="recaptchaSiteKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.recaptchaSiteKey }}</template>
< 				</MkInput>
< 				<MkInput v-model="recaptchaSecretKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.recaptchaSecretKey }}</template>
< 				</MkInput>
< 				<FormSlot v-if="recaptchaSiteKey">
< 					<template #label>{{ i18n.ts.preview }}</template>
< 					<MkCaptcha provider="recaptcha" :sitekey="recaptchaSiteKey"/>
< 				</FormSlot>
< 			</template>
< 			<template v-else-if="provider === 'turnstile'">
< 				<MkInput v-model="turnstileSiteKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.turnstileSiteKey }}</template>
< 				</MkInput>
< 				<MkInput v-model="turnstileSecretKey">
< 					<template #prefix><i class="ti ti-key"></i></template>
< 					<template #label>{{ i18n.ts.turnstileSecretKey }}</template>
< 				</MkInput>
< 				<FormSlot>
< 					<template #label>{{ i18n.ts.preview }}</template>
< 					<MkCaptcha provider="turnstile" :sitekey="turnstileSiteKey || '1x00000000000000000000AA'"/>
< 				</FormSlot>
< 			</template>
---
>         <template v-if="provider === 'hcaptcha'">
>           <FormInput v-model="hcaptchaSiteKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.hcaptchaSiteKey }}</template>
>           </FormInput>
>           <FormInput v-model="hcaptchaSecretKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.hcaptchaSecretKey }}</template>
>           </FormInput>
>           <FormSlot class="_formBlock">
>             <template #label>{{ i18n.ts.preview }}</template>
>             <MkCaptcha
>               provider="hcaptcha"
>               :sitekey="
>                 hcaptchaSiteKey || '10000000-ffff-ffff-ffff-000000000001'
>               "
>             />
>           </FormSlot>
>         </template>
>         <template v-else-if="provider === 'recaptcha'">
>           <FormInput v-model="recaptchaSiteKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.recaptchaSiteKey }}</template>
>           </FormInput>
>           <FormInput v-model="recaptchaSecretKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.recaptchaSecretKey }}</template>
>           </FormInput>
>           <FormSlot v-if="recaptchaSiteKey" class="_formBlock">
>             <template #label>{{ i18n.ts.preview }}</template>
>             <MkCaptcha provider="recaptcha" :sitekey="recaptchaSiteKey" />
>           </FormSlot>
>         </template>
>         <template v-else-if="provider === 'turnstile'">
>           <FormInput v-model="turnstileSiteKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.turnstileSiteKey }}</template>
>           </FormInput>
>           <FormInput v-model="turnstileSecretKey" class="_formBlock">
>             <template #prefix><i class="fas fa-key"></i></template>
>             <template #label>{{ i18n.ts.turnstileSecretKey }}</template>
>           </FormInput>
>           <FormSlot class="_formBlock">
>             <template #label>{{ i18n.ts.preview }}</template>
>             <MkCaptcha
>               provider="turnstile"
>               :sitekey="turnstileSiteKey || '1x00000000000000000000AA'"
>             />
>           </FormSlot>
>         </template>
55,58c65,70
< 			<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 		</div>
< 	</FormSuspense>
< </div>
---
>         <FormButton primary @click="save"
>           ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>         >
>       </div>
>     </FormSuspense>
>   </div>
62,70c74,82
< import { defineAsyncComponent } from 'vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import FormSlot from '@/components/form/slot.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import { defineAsyncComponent } from "vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormSlot from "@/components/form/slot.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
72c84,86
< const MkCaptcha = defineAsyncComponent(() => import('@/components/MkCaptcha.vue'));
---
> const MkCaptcha = defineAsyncComponent(
>   () => import("@/components/MkCaptcha.vue")
> );
83,89c97,103
< 	const meta = await os.api('admin/meta');
< 	hcaptchaSiteKey = meta.hcaptchaSiteKey;
< 	hcaptchaSecretKey = meta.hcaptchaSecretKey;
< 	recaptchaSiteKey = meta.recaptchaSiteKey;
< 	recaptchaSecretKey = meta.recaptchaSecretKey;
< 	turnstileSiteKey = meta.turnstileSiteKey;
< 	turnstileSecretKey = meta.turnstileSecretKey;
---
>   const meta = await os.api("admin/meta");
>   hcaptchaSiteKey = meta.hcaptchaSiteKey;
>   hcaptchaSecretKey = meta.hcaptchaSecretKey;
>   recaptchaSiteKey = meta.recaptchaSiteKey;
>   recaptchaSecretKey = meta.recaptchaSecretKey;
>   turnstileSiteKey = meta.turnstileSiteKey;
>   turnstileSecretKey = meta.turnstileSecretKey;
91c105,111
< 	provider = meta.enableHcaptcha ? 'hcaptcha' : meta.enableRecaptcha ? 'recaptcha' : meta.enableTurnstile ? 'turnstile' : null;
---
>   provider = meta.enableHcaptcha
>     ? "hcaptcha"
>     : meta.enableRecaptcha
>     ? "recaptcha"
>     : meta.enableTurnstile
>     ? "turnstile"
>     : null;
95,107c115,127
< 	os.apiWithDialog('admin/update-meta', {
< 		enableHcaptcha: provider === 'hcaptcha',
< 		hcaptchaSiteKey,
< 		hcaptchaSecretKey,
< 		enableRecaptcha: provider === 'recaptcha',
< 		recaptchaSiteKey,
< 		recaptchaSecretKey,
< 		enableTurnstile: provider === 'turnstile',
< 		turnstileSiteKey,
< 		turnstileSecretKey,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     enableHcaptcha: provider === "hcaptcha",
>     hcaptchaSiteKey,
>     hcaptchaSecretKey,
>     enableRecaptcha: provider === "recaptcha",
>     recaptchaSiteKey,
>     recaptchaSecretKey,
>     enableTurnstile: provider === "turnstile",
>     turnstileSiteKey,
>     turnstileSecretKey,
>   }).then(() => {
>     fetchInstance();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/database.vue RiricaV13/pages/admin/database.vue
2,12c2,24
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
< 		<FormSuspense v-slot="{ result: database }" :p="databasePromiseFactory">
< 			<MkKeyValue v-for="table in database" :key="table[0]" oneline style="margin: 1em 0;">
< 				<template #key>{{ table[0] }}</template>
< 				<template #value>{{ bytes(table[1].size) }} ({{ number(table[1].count) }} recs)</template>
< 			</MkKeyValue>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
>       <FormSuspense v-slot="{ result: database }" :p="databasePromiseFactory">
>         <MkKeyValue
>           v-for="table in database"
>           :key="table[0]"
>           oneline
>           style="margin: 1em 0"
>         >
>           <template #key>{{ table[0] }}</template>
>           <template #value
>             >{{ bytes(table[1].size) }} ({{
>               number(table[1].count)
>             }}
>             recs)</template
>           >
>         </MkKeyValue>
>       </FormSuspense>
>     </MkSpacer></MkStickyContainer
>   >
16,23c28,35
< import { } from 'vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import * as os from '@/os';
< import bytes from '@/filters/bytes';
< import number from '@/filters/number';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import * as os from "@/os";
> import bytes from "@/filters/bytes";
> import number from "@/filters/number";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
25c37,40
< const databasePromiseFactory = () => os.api('admin/get-table-stats').then(res => Object.entries(res).sort((a, b) => b[1].size - a[1].size));
---
> const databasePromiseFactory = () =>
>   os
>     .api("admin/get-table-stats")
>     .then((res) => Object.entries(res).sort((a, b) => b[1].size - a[1].size));
32,33c47,48
< 	title: i18n.ts.database,
< 	icon: 'ti ti-database',
---
>   title: i18n.ts.database,
>   icon: "fas fa-database",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/email-settings.vue RiricaV13/pages/admin/email-settings.vue
2,10c2,14
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<div class="_gaps_m">
< 				<MkSwitch v-model="enableEmail">
< 					<template #label>{{ i18n.ts.enableEmail }} ({{ i18n.ts.recommended }})</template>
< 					<template #caption>{{ i18n.ts.emailConfigInfo }}</template>
< 				</MkSwitch>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <div class="_formRoot">
>           <FormSwitch v-model="enableEmail" class="_formBlock">
>             <template #label
>               >{{ i18n.ts.enableEmail }} ({{ i18n.ts.recommended }})</template
>             >
>             <template #caption>{{ i18n.ts.emailConfigInfo }}</template>
>           </FormSwitch>
12,15c16,19
< 				<template v-if="enableEmail">
< 					<MkInput v-model="email" type="email">
< 						<template #label>{{ i18n.ts.emailAddress }}</template>
< 					</MkInput>
---
>           <template v-if="enableEmail">
>             <FormInput v-model="email" type="email" class="_formBlock">
>               <template #label>{{ i18n.ts.emailAddress }}</template>
>             </FormInput>
17,48c21,55
< 					<FormSection>
< 						<template #label>{{ i18n.ts.smtpConfig }}</template>
< 
< 						<div class="_gaps_m">
< 							<FormSplit :min-width="280">
< 								<MkInput v-model="smtpHost">
< 									<template #label>{{ i18n.ts.smtpHost }}</template>
< 								</MkInput>
< 								<MkInput v-model="smtpPort" type="number">
< 									<template #label>{{ i18n.ts.smtpPort }}</template>
< 								</MkInput>
< 							</FormSplit>
< 							<FormSplit :min-width="280">
< 								<MkInput v-model="smtpUser">
< 									<template #label>{{ i18n.ts.smtpUser }}</template>
< 								</MkInput>
< 								<MkInput v-model="smtpPass" type="password">
< 									<template #label>{{ i18n.ts.smtpPass }}</template>
< 								</MkInput>
< 							</FormSplit>
< 							<FormInfo>{{ i18n.ts.emptyToDisableSmtpAuth }}</FormInfo>
< 							<MkSwitch v-model="smtpSecure">
< 								<template #label>{{ i18n.ts.smtpSecure }}</template>
< 								<template #caption>{{ i18n.ts.smtpSecureInfo }}</template>
< 							</MkSwitch>
< 						</div>
< 					</FormSection>
< 				</template>
< 			</div>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>             <FormSection>
>               <template #label>{{ i18n.ts.smtpConfig }}</template>
>               <FormSplit :min-width="280">
>                 <FormInput v-model="smtpHost" class="_formBlock">
>                   <template #label>{{ i18n.ts.smtpHost }}</template>
>                 </FormInput>
>                 <FormInput v-model="smtpPort" type="number" class="_formBlock">
>                   <template #label>{{ i18n.ts.smtpPort }}</template>
>                 </FormInput>
>               </FormSplit>
>               <FormSplit :min-width="280">
>                 <FormInput v-model="smtpUser" class="_formBlock">
>                   <template #label>{{ i18n.ts.smtpUser }}</template>
>                 </FormInput>
>                 <FormInput
>                   v-model="smtpPass"
>                   type="password"
>                   class="_formBlock"
>                 >
>                   <template #label>{{ i18n.ts.smtpPass }}</template>
>                 </FormInput>
>               </FormSplit>
>               <FormInfo class="_formBlock">{{
>                 i18n.ts.emptyToDisableSmtpAuth
>               }}</FormInfo>
>               <FormSwitch v-model="smtpSecure" class="_formBlock">
>                 <template #label>{{ i18n.ts.smtpSecure }}</template>
>                 <template #caption>{{ i18n.ts.smtpSecureInfo }}</template>
>               </FormSwitch>
>             </FormSection>
>           </template>
>         </div>
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
52,63c59,70
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import FormSplit from '@/components/form/split.vue';
< import FormSection from '@/components/form/section.vue';
< import * as os from '@/os';
< import { fetchInstance, instance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormSection from "@/components/form/section.vue";
> import * as os from "@/os";
> import { fetchInstance, instance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
68c75
< let smtpHost: string = $ref('');
---
> let smtpHost: string = $ref("");
70,71c77,78
< let smtpUser: string = $ref('');
< let smtpPass: string = $ref('');
---
> let smtpUser: string = $ref("");
> let smtpPass: string = $ref("");
74,81c81,88
< 	const meta = await os.api('admin/meta');
< 	enableEmail = meta.enableEmail;
< 	email = meta.email;
< 	smtpSecure = meta.smtpSecure;
< 	smtpHost = meta.smtpHost;
< 	smtpPort = meta.smtpPort;
< 	smtpUser = meta.smtpUser;
< 	smtpPass = meta.smtpPass;
---
>   const meta = await os.api("admin/meta");
>   enableEmail = meta.enableEmail;
>   email = meta.email;
>   smtpSecure = meta.smtpSecure;
>   smtpHost = meta.smtpHost;
>   smtpPort = meta.smtpPort;
>   smtpUser = meta.smtpUser;
>   smtpPass = meta.smtpPass;
85,95c92,102
< 	const { canceled, result: destination } = await os.inputText({
< 		title: i18n.ts.destination,
< 		type: 'email',
< 		placeholder: instance.maintainerEmail,
< 	});
< 	if (canceled) return;
< 	os.apiWithDialog('admin/send-email', {
< 		to: destination,
< 		subject: 'Test email',
< 		text: 'Yo',
< 	});
---
>   const { canceled, result: destination } = await os.inputText({
>     title: i18n.ts.destination,
>     type: "email",
>     placeholder: instance.maintainerEmail,
>   });
>   if (canceled) return;
>   os.apiWithDialog("admin/send-email", {
>     to: destination,
>     subject: "Test email",
>     text: "Yo",
>   });
99,109c106,116
< 	os.apiWithDialog('admin/update-meta', {
< 		enableEmail,
< 		email,
< 		smtpSecure,
< 		smtpHost,
< 		smtpPort,
< 		smtpUser,
< 		smtpPass,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     enableEmail,
>     email,
>     smtpSecure,
>     smtpHost,
>     smtpPort,
>     smtpUser,
>     smtpPass,
>   }).then(() => {
>     fetchInstance();
>   });
112,121c119,131
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	text: i18n.ts.testEmail,
< 	handler: testEmail,
< }, {
< 	asFullButton: true,
< 	icon: 'ti ti-check',
< 	text: i18n.ts.save,
< 	handler: save,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     text: i18n.ts.testEmail,
>     handler: testEmail,
>   },
>   {
>     asFullButton: true,
>     icon: "fas fa-check",
>     text: i18n.ts.save,
>     handler: save,
>   },
> ]);
126,127c136,137
< 	title: i18n.ts.emailServer,
< 	icon: 'ti ti-mail',
---
>   title: i18n.ts.emailServer,
>   icon: "fas fa-envelope",
Only in RiricaV13/pages/admin: emoji-edit-dialog.vue
Only in RiricaV13/pages/admin: emojis.vue
Only in misskeyV13/packages/frontend/src/pages/admin: federation.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/files.vue RiricaV13/pages/admin/files.vue
2,32c2,62
< <div>
< 	<MkStickyContainer>
< 		<template #header><XHeader :actions="headerActions"/></template>
< 		<MkSpacer :content-max="900">
< 			<div class="xrmjdkdw">
< 				<div>
< 					<div class="inputs" style="display: flex; gap: var(--margin); flex-wrap: wrap;">
< 						<MkSelect v-model="origin" style="margin: 0; flex: 1;">
< 							<template #label>{{ i18n.ts.instance }}</template>
< 							<option value="combined">{{ i18n.ts.all }}</option>
< 							<option value="local">{{ i18n.ts.local }}</option>
< 							<option value="remote">{{ i18n.ts.remote }}</option>
< 						</MkSelect>
< 						<MkInput v-model="searchHost" :debounce="true" type="search" style="margin: 0; flex: 1;" :disabled="pagination.params.origin === 'local'">
< 							<template #label>{{ i18n.ts.host }}</template>
< 						</MkInput>
< 					</div>
< 					<div class="inputs" style="display: flex; gap: var(--margin); flex-wrap: wrap; padding-top: 1.2em;">
< 						<MkInput v-model="userId" :debounce="true" type="search" style="margin: 0; flex: 1;">
< 							<template #label>User ID</template>
< 						</MkInput>
< 						<MkInput v-model="type" :debounce="true" type="search" style="margin: 0; flex: 1;">
< 							<template #label>MIME type</template>
< 						</MkInput>
< 					</div>
< 					<MkFileListForAdmin :pagination="pagination" :view-mode="viewMode"/>
< 				</div>
< 			</div>
< 		</MkSpacer>
< 	</MkStickyContainer>
< </div>
---
>   <div>
>     <MkStickyContainer>
>       <template #header><XHeader :actions="headerActions" /></template>
>       <MkSpacer :content-max="900">
>         <div class="xrmjdkdw">
>           <div>
>             <div
>               class="inputs"
>               style="display: flex; gap: var(--margin); flex-wrap: wrap"
>             >
>               <MkSelect v-model="origin" style="margin: 0; flex: 1">
>                 <template #label>{{ i18n.ts.instance }}</template>
>                 <option value="combined">{{ i18n.ts.all }}</option>
>                 <option value="local">{{ i18n.ts.local }}</option>
>                 <option value="remote">{{ i18n.ts.remote }}</option>
>               </MkSelect>
>               <MkInput
>                 v-model="searchHost"
>                 :debounce="true"
>                 type="search"
>                 style="margin: 0; flex: 1"
>                 :disabled="pagination.params.origin === 'local'"
>               >
>                 <template #label>{{ i18n.ts.host }}</template>
>               </MkInput>
>             </div>
>             <div
>               class="inputs"
>               style="
>                 display: flex;
>                 gap: var(--margin);
>                 flex-wrap: wrap;
>                 padding-top: 1.2em;
>               "
>             >
>               <MkInput
>                 v-model="userId"
>                 :debounce="true"
>                 type="search"
>                 style="margin: 0; flex: 1"
>               >
>                 <template #label>User ID</template>
>               </MkInput>
>               <MkInput
>                 v-model="type"
>                 :debounce="true"
>                 type="search"
>                 style="margin: 0; flex: 1"
>               >
>                 <template #label>MIME type</template>
>               </MkInput>
>             </div>
>             <MkFileListForAdmin
>               :pagination="pagination"
>               :view-mode="viewMode"
>             />
>           </div>
>         </div>
>       </MkSpacer>
>     </MkStickyContainer>
>   </div>
36,46c66,76
< import { computed, defineAsyncComponent } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkFileListForAdmin from '@/components/MkFileListForAdmin.vue';
< import bytes from '@/filters/bytes';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, defineAsyncComponent } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import XHeader from "./_header_.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkFileListForAdmin from "@/components/MkFileListForAdmin.vue";
> import bytes from "@/filters/bytes";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
48c78
< let origin = $ref('local');
---
> let origin = $ref("local");
50,52c80,82
< let searchHost = $ref('');
< let userId = $ref('');
< let viewMode = $ref('grid');
---
> let searchHost = $ref("");
> let userId = $ref("");
> let viewMode = $ref("grid");
54,61c84,91
< 	endpoint: 'admin/drive/files' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		type: (type && type !== '') ? type : null,
< 		userId: (userId && userId !== '') ? userId : null,
< 		origin: origin,
< 		hostname: (searchHost && searchHost !== '') ? searchHost : null,
< 	})),
---
>   endpoint: "admin/drive/files" as const,
>   limit: 10,
>   params: computed(() => ({
>     type: type && type !== "" ? type : null,
>     userId: userId && userId !== "" ? userId : null,
>     origin: origin,
>     hostname: searchHost && searchHost !== "" ? searchHost : null,
>   })),
65,69c95,99
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.clearCachedFilesConfirm,
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
---
>   os.confirm({
>     type: "warning",
>     text: i18n.ts.clearCachedFilesConfirm,
>   }).then(({ canceled }) => {
>     if (canceled) return;
71,72c101,102
< 		os.apiWithDialog('admin/drive/clean-remote-files', {});
< 	});
---
>     os.apiWithDialog("admin/drive/clean-remote-files", {});
>   });
76c106
< 	os.pageWindow(`/admin/file/${file.id}`);
---
>   os.pageWindow(`/admin/file/${file.id}`);
80,84c110,114
< 	const { canceled, result: q } = await os.inputText({
< 		title: i18n.ts.fileIdOrUrl,
< 		allowEmpty: false,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: q } = await os.inputText({
>     title: i18n.ts.fileIdOrUrl,
>     allowEmpty: false,
>   });
>   if (canceled) return;
86,95c116,132
< 	os.api('admin/drive/show-file', q.startsWith('http://') || q.startsWith('https://') ? { url: q.trim() } : { fileId: q.trim() }).then(file => {
< 		show(file);
< 	}).catch(err => {
< 		if (err.code === 'NO_SUCH_FILE') {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts.notFound,
< 			});
< 		}
< 	});
---
>   os.api(
>     "admin/drive/show-file",
>     q.startsWith("http://") || q.startsWith("https://")
>       ? { url: q.trim() }
>       : { fileId: q.trim() }
>   )
>     .then((file) => {
>       show(file);
>     })
>     .catch((err) => {
>       if (err.code === "NO_SUCH_FILE") {
>         os.alert({
>           type: "error",
>           text: i18n.ts.notFound,
>         });
>       }
>     });
98,106c135,146
< const headerActions = $computed(() => [{
< 	text: i18n.ts.lookup,
< 	icon: 'ti ti-search',
< 	handler: find,
< }, {
< 	text: i18n.ts.clearCachedFiles,
< 	icon: 'ti ti-trash',
< 	handler: clear,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     text: i18n.ts.lookup,
>     icon: "fas fa-search",
>     handler: find,
>   },
>   {
>     text: i18n.ts.clearCachedFiles,
>     icon: "fas fa-trash-alt",
>     handler: clear,
>   },
> ]);
110,113c150,155
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.files,
< 	icon: 'ti ti-cloud',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.files,
>     icon: "fas fa-cloud",
>   }))
> );
118c160
< 	margin: var(--margin);
---
>   margin: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/index.vue RiricaV13/pages/admin/index.vue
2,8c2,12
< <div ref="el" class="hiyeyicy" :class="{ wide: !narrow }">
< 	<div v-if="!narrow || currentPage?.route.name == null" class="nav">	
< 		<MkSpacer :content-max="700" :margin-min="16">
< 			<div class="lxpfedzu">
< 				<div class="banner">
< 					<img :src="$instance.iconUrl || '/favicon.ico'" alt="" class="icon"/>
< 				</div>
---
>   <div ref="el" class="hiyeyicy" :class="{ wide: !narrow }">
>     <div v-if="!narrow || currentPage?.route.name == null" class="nav">
>       <MkSpacer :content-max="700" :margin-min="16">
>         <div class="lxpfedzu">
>           <div class="banner">
>             <img
>               :src="$instance.iconUrl || '/favicon.ico'"
>               alt=""
>               class="icon"
>             />
>           </div>
10,13c14,37
< 				<MkInfo v-if="thereIsUnresolvedAbuseReport" warn class="info">{{ i18n.ts.thereIsUnresolvedAbuseReportWarning }} <MkA to="/admin/abuses" class="_link">{{ i18n.ts.check }}</MkA></MkInfo>
< 				<MkInfo v-if="noMaintainerInformation" warn class="info">{{ i18n.ts.noMaintainerInformationWarning }} <MkA to="/admin/settings" class="_link">{{ i18n.ts.configure }}</MkA></MkInfo>
< 				<MkInfo v-if="noBotProtection" warn class="info">{{ i18n.ts.noBotProtectionWarning }} <MkA to="/admin/security" class="_link">{{ i18n.ts.configure }}</MkA></MkInfo>
< 				<MkInfo v-if="noEmailServer" warn class="info">{{ i18n.ts.noEmailServerWarning }} <MkA to="/admin/email-settings" class="_link">{{ i18n.ts.configure }}</MkA></MkInfo>
---
>           <MkInfo v-if="thereIsUnresolvedAbuseReport" warn class="info"
>             >{{ i18n.ts.thereIsUnresolvedAbuseReportWarning }}
>             <MkA to="/admin/abuses" class="_link">{{
>               i18n.ts.check
>             }}</MkA></MkInfo
>           >
>           <MkInfo v-if="noMaintainerInformation" warn class="info"
>             >{{ i18n.ts.noMaintainerInformationWarning }}
>             <MkA to="/admin/settings" class="_link">{{
>               i18n.ts.configure
>             }}</MkA></MkInfo
>           >
>           <MkInfo v-if="noBotProtection" warn class="info"
>             >{{ i18n.ts.noBotProtectionWarning }}
>             <MkA to="/admin/security" class="_link">{{
>               i18n.ts.configure
>             }}</MkA></MkInfo
>           >
>           <MkInfo v-if="noEmailServer" warn class="info"
>             >{{ i18n.ts.noEmailServerWarning }}
>             <MkA to="/admin/email-settings" class="_link">{{
>               i18n.ts.configure
>             }}</MkA></MkInfo
>           >
15,22c39,49
< 				<MkSuperMenu :def="menuDef" :grid="currentPage?.route.name == null"></MkSuperMenu>
< 			</div>
< 		</MkSpacer>
< 	</div>
< 	<div v-if="!(narrow && currentPage?.route.name == null)" class="main">
< 		<RouterView/>
< 	</div>
< </div>
---
>           <MkSuperMenu
>             :def="menuDef"
>             :grid="currentPage?.route.name == null"
>           ></MkSuperMenu>
>         </div>
>       </MkSpacer>
>     </div>
>     <div v-if="!(narrow && currentPage?.route.name == null)" class="main">
>       <RouterView />
>     </div>
>   </div>
26,35c53,74
< import { defineAsyncComponent, inject, nextTick, onMounted, onUnmounted, provide, watch } from 'vue';
< import { i18n } from '@/i18n';
< import MkSuperMenu from '@/components/MkSuperMenu.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import { scroll } from '@/scripts/scroll';
< import { instance } from '@/instance';
< import * as os from '@/os';
< import { lookupUser } from '@/scripts/lookup-user';
< import { useRouter } from '@/router';
< import { definePageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
---
> import {
>   defineAsyncComponent,
>   inject,
>   nextTick,
>   onMounted,
>   onUnmounted,
>   provide,
>   watch,
> } from "vue";
> import { i18n } from "@/i18n";
> import MkSuperMenu from "@/components/MkSuperMenu.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import { scroll } from "@/scripts/scroll";
> import { instance } from "@/instance";
> import * as os from "@/os";
> import { lookupUser } from "@/scripts/lookup-user";
> import { useRouter } from "@/router";
> import {
>   definePageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
37c76
< const isEmpty = (x: string | null) => x == null || x === '';
---
> const isEmpty = (x: string | null) => x == null || x === "";
42,44c81,83
< 	title: i18n.ts.controlPanel,
< 	icon: 'ti ti-settings',
< 	hideHeader: true,
---
>   title: i18n.ts.controlPanel,
>   icon: "fas fa-cog",
>   hideHeader: true,
47c86
< provide('shouldOmitHeaderTitle', false);
---
> provide("shouldOmitHeaderTitle", false);
55,56c94,100
< let noMaintainerInformation = isEmpty(instance.maintainerName) || isEmpty(instance.maintainerEmail);
< let noBotProtection = !instance.disableRegistration && !instance.enableHcaptcha && !instance.enableRecaptcha && !instance.enableTurnstile;
---
> let noMaintainerInformation =
>   isEmpty(instance.maintainerName) || isEmpty(instance.maintainerEmail);
> let noBotProtection =
>   !instance.disableRegistration &&
>   !instance.enableHcaptcha &&
>   !instance.enableRecaptcha &&
>   !instance.enableTurnstile;
61,65c105,109
< os.api('admin/abuse-user-reports', {
< 	state: 'unresolved',
< 	limit: 1,
< }).then(reports => {
< 	if (reports.length > 0) thereIsUnresolvedAbuseReport = true;
---
> os.api("admin/abuse-user-reports", {
>   state: "unresolved",
>   limit: 1,
> }).then((reports) => {
>   if (reports.length > 0) thereIsUnresolvedAbuseReport = true;
70,71c114,115
< 	if (entries.length === 0) return;
< 	narrow = entries[0].borderBoxSize[0].inlineSize < NARROW_THRESHOLD;
---
>   if (entries.length === 0) return;
>   narrow = entries[0].borderBoxSize[0].inlineSize < NARROW_THRESHOLD;
74,196c118,269
< const menuDef = $computed(() => [{
< 	title: i18n.ts.quickAction,
< 	items: [{
< 		type: 'button',
< 		icon: 'ti ti-search',
< 		text: i18n.ts.lookup,
< 		action: lookup,
< 	}, ...(instance.disableRegistration ? [{
< 		type: 'button',
< 		icon: 'ti ti-user-plus',
< 		text: i18n.ts.invite,
< 		action: invite,
< 	}] : [])],
< }, {
< 	title: i18n.ts.administration,
< 	items: [{
< 		icon: 'ti ti-dashboard',
< 		text: i18n.ts.dashboard,
< 		to: '/admin/overview',
< 		active: currentPage?.route.name === 'overview',
< 	}, {
< 		icon: 'ti ti-users',
< 		text: i18n.ts.users,
< 		to: '/admin/users',
< 		active: currentPage?.route.name === 'users',
< 	}, {
< 		icon: 'ti ti-badges',
< 		text: i18n.ts.roles,
< 		to: '/admin/roles',
< 		active: currentPage?.route.name === 'roles',
< 	}, {
< 		icon: 'ti ti-icons',
< 		text: i18n.ts.customEmojis,
< 		to: '/admin/emojis',
< 		active: currentPage?.route.name === 'emojis',
< 	}, {
< 		icon: 'ti ti-whirl',
< 		text: i18n.ts.federation,
< 		to: '/admin/federation',
< 		active: currentPage?.route.name === 'federation',
< 	}, {
< 		icon: 'ti ti-clock-play',
< 		text: i18n.ts.jobQueue,
< 		to: '/admin/queue',
< 		active: currentPage?.route.name === 'queue',
< 	}, {
< 		icon: 'ti ti-cloud',
< 		text: i18n.ts.files,
< 		to: '/admin/files',
< 		active: currentPage?.route.name === 'files',
< 	}, {
< 		icon: 'ti ti-speakerphone',
< 		text: i18n.ts.announcements,
< 		to: '/admin/announcements',
< 		active: currentPage?.route.name === 'announcements',
< 	}, {
< 		icon: 'ti ti-ad',
< 		text: i18n.ts.ads,
< 		to: '/admin/ads',
< 		active: currentPage?.route.name === 'ads',
< 	}, {
< 		icon: 'ti ti-exclamation-circle',
< 		text: i18n.ts.abuseReports,
< 		to: '/admin/abuses',
< 		active: currentPage?.route.name === 'abuses',
< 	}],
< }, {
< 	title: i18n.ts.settings,
< 	items: [{
< 		icon: 'ti ti-settings',
< 		text: i18n.ts.general,
< 		to: '/admin/settings',
< 		active: currentPage?.route.name === 'settings',
< 	}, {
< 		icon: 'ti ti-mail',
< 		text: i18n.ts.emailServer,
< 		to: '/admin/email-settings',
< 		active: currentPage?.route.name === 'email-settings',
< 	}, {
< 		icon: 'ti ti-cloud',
< 		text: i18n.ts.objectStorage,
< 		to: '/admin/object-storage',
< 		active: currentPage?.route.name === 'object-storage',
< 	}, {
< 		icon: 'ti ti-lock',
< 		text: i18n.ts.security,
< 		to: '/admin/security',
< 		active: currentPage?.route.name === 'security',
< 	}, {
< 		icon: 'ti ti-planet',
< 		text: i18n.ts.relays,
< 		to: '/admin/relays',
< 		active: currentPage?.route.name === 'relays',
< 	}, {
< 		icon: 'ti ti-share',
< 		text: i18n.ts.integration,
< 		to: '/admin/integrations',
< 		active: currentPage?.route.name === 'integrations',
< 	}, {
< 		icon: 'ti ti-ban',
< 		text: i18n.ts.instanceBlocking,
< 		to: '/admin/instance-block',
< 		active: currentPage?.route.name === 'instance-block',
< 	}, {
< 		icon: 'ti ti-ghost',
< 		text: i18n.ts.proxyAccount,
< 		to: '/admin/proxy-account',
< 		active: currentPage?.route.name === 'proxy-account',
< 	}, {
< 		icon: 'ti ti-adjustments',
< 		text: i18n.ts.other,
< 		to: '/admin/other-settings',
< 		active: currentPage?.route.name === 'other-settings',
< 	}],
< }, {
< 	title: i18n.ts.info,
< 	items: [{
< 		icon: 'ti ti-database',
< 		text: i18n.ts.database,
< 		to: '/admin/database',
< 		active: currentPage?.route.name === 'database',
< 	}],
< }]);
---
> const menuDef = $computed(() => [
>   {
>     title: i18n.ts.quickAction,
>     items: [
>       {
>         type: "button",
>         icon: "fas fa-search",
>         text: i18n.ts.lookup,
>         action: lookup,
>       },
>       ...(instance.disableRegistration
>         ? [
>             {
>               type: "button",
>               icon: "fas fa-user",
>               text: i18n.ts.invite,
>               action: invite,
>             },
>           ]
>         : []),
>     ],
>   },
>   {
>     title: i18n.ts.administration,
>     items: [
>       {
>         icon: "fas fa-tachometer-alt",
>         text: i18n.ts.dashboard,
>         to: "/admin/overview",
>         active: currentPage?.route.name === "overview",
>       },
>       {
>         icon: "fas fa-users",
>         text: i18n.ts.users,
>         to: "/admin/users",
>         active: currentPage?.route.name === "users",
>       },
>       {
>         icon: "fas fa-laugh",
>         text: i18n.ts.customEmojis,
>         to: "/admin/emojis",
>         active: currentPage?.route.name === "emojis",
>       },
>       {
>         icon: "fas fa-globe",
>         text: i18n.ts.federation,
>         to: "/about#federation",
>         active: currentPage?.route.name === "federation",
>       },
>       {
>         icon: "fas fa-clipboard-list",
>         text: i18n.ts.jobQueue,
>         to: "/admin/queue",
>         active: currentPage?.route.name === "queue",
>       },
>       {
>         icon: "fas fa-cloud",
>         text: i18n.ts.files,
>         to: "/admin/files",
>         active: currentPage?.route.name === "files",
>       },
>       {
>         icon: "fas fa-broadcast-tower",
>         text: i18n.ts.announcements,
>         to: "/admin/announcements",
>         active: currentPage?.route.name === "announcements",
>       },
>       {
>         icon: "fas fa-audio-description",
>         text: i18n.ts.ads,
>         to: "/admin/ads",
>         active: currentPage?.route.name === "ads",
>       },
>       {
>         icon: "fas fa-exclamation-circle",
>         text: i18n.ts.abuseReports,
>         to: "/admin/abuses",
>         active: currentPage?.route.name === "abuses",
>       },
>     ],
>   },
>   {
>     title: i18n.ts.settings,
>     items: [
>       {
>         icon: "fas fa-cog",
>         text: i18n.ts.general,
>         to: "/admin/settings",
>         active: currentPage?.route.name === "settings",
>       },
>       {
>         icon: "fas fa-envelope",
>         text: i18n.ts.emailServer,
>         to: "/admin/email-settings",
>         active: currentPage?.route.name === "email-settings",
>       },
>       {
>         icon: "fas fa-cloud",
>         text: i18n.ts.objectStorage,
>         to: "/admin/object-storage",
>         active: currentPage?.route.name === "object-storage",
>       },
>       {
>         icon: "fas fa-lock",
>         text: i18n.ts.security,
>         to: "/admin/security",
>         active: currentPage?.route.name === "security",
>       },
>       {
>         icon: "fas fa-globe",
>         text: i18n.ts.relays,
>         to: "/admin/relays",
>         active: currentPage?.route.name === "relays",
>       },
>       {
>         icon: "fas fa-share-alt",
>         text: i18n.ts.integration,
>         to: "/admin/integrations",
>         active: currentPage?.route.name === "integrations",
>       },
>       {
>         icon: "fas fa-ban",
>         text: i18n.ts.instanceBlocking,
>         to: "/admin/instance-block",
>         active: currentPage?.route.name === "instance-block",
>       },
>       {
>         icon: "fas fa-ghost",
>         text: i18n.ts.proxyAccount,
>         to: "/admin/proxy-account",
>         active: currentPage?.route.name === "proxy-account",
>       },
>       {
>         icon: "fas fa-cogs",
>         text: i18n.ts.other,
>         to: "/admin/other-settings",
>         active: currentPage?.route.name === "other-settings",
>       },
>     ],
>   },
>   {
>     title: i18n.ts.info,
>     items: [
>       {
>         icon: "fas fa-database",
>         text: i18n.ts.database,
>         to: "/admin/database",
>         active: currentPage?.route.name === "database",
>       },
>     ],
>   },
> ]);
199,201c272,274
< 	if (currentPage?.route.name == null && !narrow) {
< 		router.push('/admin/overview');
< 	}
---
>   if (currentPage?.route.name == null && !narrow) {
>     router.push("/admin/overview");
>   }
205c278
< 	ro.observe(el);
---
>   ro.observe(el);
207,210c280,283
< 	narrow = el.offsetWidth < NARROW_THRESHOLD;
< 	if (currentPage?.route.name == null && !narrow) {
< 		router.push('/admin/overview');
< 	}
---
>   narrow = el.offsetWidth < NARROW_THRESHOLD;
>   if (currentPage?.route.name == null && !narrow) {
>     router.push("/admin/overview");
>   }
214c287
< 	ro.disconnect();
---
>   ro.disconnect();
218,222c291,295
< 	if (info == null) {
< 		childInfo = null;
< 	} else {
< 		childInfo = info;
< 	}
---
>   if (info == null) {
>     childInfo = null;
>   } else {
>     childInfo = info;
>   }
226,236c299,311
< 	os.api('invite').then(x => {
< 		os.alert({
< 			type: 'info',
< 			text: x.code,
< 		});
< 	}).catch(err => {
< 		os.alert({
< 			type: 'error',
< 			text: err,
< 		});
< 	});
---
>   os.api("admin/invite")
>     .then((x) => {
>       os.alert({
>         type: "info",
>         text: x.code,
>       });
>     })
>     .catch((err) => {
>       os.alert({
>         type: "error",
>         text: err,
>       });
>     });
240,264c315,347
< 	os.popupMenu([{
< 		text: i18n.ts.user,
< 		icon: 'ti ti-user',
< 		action: () => {
< 			lookupUser();
< 		},
< 	}, {
< 		text: i18n.ts.note,
< 		icon: 'ti ti-pencil',
< 		action: () => {
< 			alert('TODO');
< 		},
< 	}, {
< 		text: i18n.ts.file,
< 		icon: 'ti ti-cloud',
< 		action: () => {
< 			alert('TODO');
< 		},
< 	}, {
< 		text: i18n.ts.instance,
< 		icon: 'ti ti-planet',
< 		action: () => {
< 			alert('TODO');
< 		},
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.user,
>         icon: "fas fa-user",
>         action: () => {
>           lookupUser();
>         },
>       },
>       {
>         text: i18n.ts.note,
>         icon: "fas fa-pencil-alt",
>         action: () => {
>           alert("TODO");
>         },
>       },
>       {
>         text: i18n.ts.file,
>         icon: "fas fa-cloud",
>         action: () => {
>           alert("TODO");
>         },
>       },
>       {
>         text: i18n.ts.instance,
>         icon: "fas fa-globe",
>         action: () => {
>           alert("TODO");
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
274,276c357,359
< 	header: {
< 		title: i18n.ts.controlPanel,
< 	},
---
>   header: {
>     title: i18n.ts.controlPanel,
>   },
282,285c365,368
< 	&.wide {
< 		display: flex;
< 		margin: 0 auto;
< 		height: 100%;
---
>   &.wide {
>     display: flex;
>     margin: 0 auto;
>     height: 100%;
287,294c370,377
< 		> .nav {
< 			width: 32%;
< 			max-width: 280px;
< 			box-sizing: border-box;
< 			border-right: solid 0.5px var(--divider);
< 			overflow: auto;
< 			height: 100%;
< 		}
---
>     > .nav {
>       width: 32%;
>       max-width: 280px;
>       box-sizing: border-box;
>       border-right: solid 0.5px var(--divider);
>       overflow: auto;
>       height: 100%;
>     }
296,300c379,383
< 		> .main {
< 			flex: 1;
< 			min-width: 0;
< 		}
< 	}
---
>     > .main {
>       flex: 1;
>       min-width: 0;
>     }
>   }
302,306c385,389
< 	> .nav {
< 		.lxpfedzu {
< 			> .info {
< 				margin: 16px 0;
< 			}
---
>   > .nav {
>     .lxpfedzu {
>       > .info {
>         margin: 16px 0;
>       }
308,309c391,392
< 			> .banner {
< 				margin: 16px;
---
>       > .banner {
>         margin: 16px;
311,319c394,402
< 				> .icon {
< 					display: block;
< 					margin: auto;
< 					height: 42px;
< 					border-radius: 8px;
< 				}
< 			}
< 		}
< 	}
---
>         > .icon {
>           display: block;
>           margin: auto;
>           height: 42px;
>           border-radius: 8px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/instance-block.vue RiricaV13/pages/admin/instance-block.vue
2,9c2,13
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<MkTextarea v-model="blockedHosts">
< 				<span>{{ i18n.ts.blockedInstances }}</span>
< 				<template #caption>{{ i18n.ts.blockedInstancesDescription }}</template>
< 			</MkTextarea>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <FormTextarea v-model="blockedHosts" class="_formBlock">
>           <span>{{ i18n.ts.blockedInstances }}</span>
>           <template #caption>{{
>             i18n.ts.blockedInstancesDescription
>           }}</template>
>         </FormTextarea>
11,14c15,20
< 			<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <FormButton primary class="_formBlock" @click="save"
>           ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>         >
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
18,26c24,32
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
28c34
< let blockedHosts: string = $ref('');
---
> let blockedHosts: string = $ref("");
31,32c37,38
< 	const meta = await os.api('admin/meta');
< 	blockedHosts = meta.blockedHosts.join('\n');
---
>   const meta = await os.api("admin/meta");
>   blockedHosts = meta.blockedHosts.join("\n");
36,40c42,46
< 	os.apiWithDialog('admin/update-meta', {
< 		blockedHosts: blockedHosts.split('\n') || [],
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     blockedHosts: blockedHosts.split("\n") || [],
>   }).then(() => {
>     fetchInstance();
>   });
48,49c54,55
< 	title: i18n.ts.instanceBlocking,
< 	icon: 'ti ti-ban',
---
>   title: i18n.ts.instanceBlocking,
>   icon: "fas fa-ban",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/integrations.discord.vue RiricaV13/pages/admin/integrations.discord.vue
2,6c2,6
< <FormSuspense :p="init">
< 	<div class="_gaps_m">
< 		<MkSwitch v-model="enableDiscordIntegration">
< 			<template #label>{{ i18n.ts.enable }}</template>
< 		</MkSwitch>
---
>   <FormSuspense :p="init">
>     <div class="_formRoot">
>       <FormSwitch v-model="enableDiscordIntegration" class="_formBlock">
>         <template #label>{{ i18n.ts.enable }}</template>
>       </FormSwitch>
8,14c8,11
< 		<template v-if="enableDiscordIntegration">
< 			<FormInfo>Callback URL: {{ `${uri}/api/dc/cb` }}</FormInfo>
< 		
< 			<MkInput v-model="discordClientId">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Client ID</template>
< 			</MkInput>
---
>       <template v-if="enableDiscordIntegration">
>         <FormInfo class="_formBlock"
>           >Callback URL: {{ `${uri}/api/dc/cb` }}</FormInfo
>         >
16,20c13,16
< 			<MkInput v-model="discordClientSecret">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Client Secret</template>
< 			</MkInput>
< 		</template>
---
>         <FormInput v-model="discordClientId" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Client ID</template>
>         </FormInput>
22,24c18,28
< 		<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 	</div>
< </FormSuspense>
---
>         <FormInput v-model="discordClientSecret" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Client Secret</template>
>         </FormInput>
>       </template>
> 
>       <FormButton primary class="_formBlock" @click="save"
>         ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>       >
>     </div>
>   </FormSuspense>
28,36c32,40
< import { } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
38c42
< let uri: string = $ref('');
---
> let uri: string = $ref("");
44,48c48,52
< 	const meta = await os.api('admin/meta');
< 	uri = meta.uri;
< 	enableDiscordIntegration = meta.enableDiscordIntegration;
< 	discordClientId = meta.discordClientId;
< 	discordClientSecret = meta.discordClientSecret;
---
>   const meta = await os.api("admin/meta");
>   uri = meta.uri;
>   enableDiscordIntegration = meta.enableDiscordIntegration;
>   discordClientId = meta.discordClientId;
>   discordClientSecret = meta.discordClientSecret;
52,58c56,62
< 	os.apiWithDialog('admin/update-meta', {
< 		enableDiscordIntegration,
< 		discordClientId,
< 		discordClientSecret,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     enableDiscordIntegration,
>     discordClientId,
>     discordClientSecret,
>   }).then(() => {
>     fetchInstance();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/integrations.github.vue RiricaV13/pages/admin/integrations.github.vue
2,6c2,6
< <FormSuspense :p="init">
< 	<div class="_gaps_m">
< 		<MkSwitch v-model="enableGithubIntegration">
< 			<template #label>{{ i18n.ts.enable }}</template>
< 		</MkSwitch>
---
>   <FormSuspense :p="init">
>     <div class="_formRoot">
>       <FormSwitch v-model="enableGithubIntegration" class="_formBlock">
>         <template #label>{{ i18n.ts.enable }}</template>
>       </FormSwitch>
8,14c8,11
< 		<template v-if="enableGithubIntegration">
< 			<FormInfo>Callback URL: {{ `${uri}/api/gh/cb` }}</FormInfo>
< 		
< 			<MkInput v-model="githubClientId">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Client ID</template>
< 			</MkInput>
---
>       <template v-if="enableGithubIntegration">
>         <FormInfo class="_formBlock"
>           >Callback URL: {{ `${uri}/api/gh/cb` }}</FormInfo
>         >
16,20c13,16
< 			<MkInput v-model="githubClientSecret">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Client Secret</template>
< 			</MkInput>
< 		</template>
---
>         <FormInput v-model="githubClientId" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Client ID</template>
>         </FormInput>
22,24c18,28
< 		<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 	</div>
< </FormSuspense>
---
>         <FormInput v-model="githubClientSecret" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Client Secret</template>
>         </FormInput>
>       </template>
> 
>       <FormButton primary class="_formBlock" @click="save"
>         ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>       >
>     </div>
>   </FormSuspense>
28,36c32,40
< import { } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
38c42
< let uri: string = $ref('');
---
> let uri: string = $ref("");
44,48c48,52
< 	const meta = await os.api('admin/meta');
< 	uri = meta.uri;
< 	enableGithubIntegration = meta.enableGithubIntegration;
< 	githubClientId = meta.githubClientId;
< 	githubClientSecret = meta.githubClientSecret;
---
>   const meta = await os.api("admin/meta");
>   uri = meta.uri;
>   enableGithubIntegration = meta.enableGithubIntegration;
>   githubClientId = meta.githubClientId;
>   githubClientSecret = meta.githubClientSecret;
52,58c56,62
< 	os.apiWithDialog('admin/update-meta', {
< 		enableGithubIntegration,
< 		githubClientId,
< 		githubClientSecret,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     enableGithubIntegration,
>     githubClientId,
>     githubClientSecret,
>   }).then(() => {
>     fetchInstance();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/integrations.twitter.vue RiricaV13/pages/admin/integrations.twitter.vue
2,6c2,6
< <FormSuspense :p="init">
< 	<div class="_gaps_m">
< 		<MkSwitch v-model="enableTwitterIntegration">
< 			<template #label>{{ i18n.ts.enable }}</template>
< 		</MkSwitch>
---
>   <FormSuspense :p="init">
>     <div class="_formRoot">
>       <FormSwitch v-model="enableTwitterIntegration" class="_formBlock">
>         <template #label>{{ i18n.ts.enable }}</template>
>       </FormSwitch>
8,14c8,11
< 		<template v-if="enableTwitterIntegration">
< 			<FormInfo>Callback URL: {{ `${uri}/api/tw/cb` }}</FormInfo>
< 		
< 			<MkInput v-model="twitterConsumerKey">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Consumer Key</template>
< 			</MkInput>
---
>       <template v-if="enableTwitterIntegration">
>         <FormInfo class="_formBlock"
>           >Callback URL: {{ `${uri}/api/tw/cb` }}</FormInfo
>         >
16,20c13,16
< 			<MkInput v-model="twitterConsumerSecret">
< 				<template #prefix><i class="ti ti-key"></i></template>
< 				<template #label>Consumer Secret</template>
< 			</MkInput>
< 		</template>
---
>         <FormInput v-model="twitterConsumerKey" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Consumer Key</template>
>         </FormInput>
22,24c18,28
< 		<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 	</div>
< </FormSuspense>
---
>         <FormInput v-model="twitterConsumerSecret" class="_formBlock">
>           <template #prefix><i class="fas fa-key"></i></template>
>           <template #label>Consumer Secret</template>
>         </FormInput>
>       </template>
> 
>       <FormButton primary class="_formBlock" @click="save"
>         ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>       >
>     </div>
>   </FormSuspense>
28,36c32,40
< import { defineComponent } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import { defineComponent } from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
38c42
< let uri: string = $ref('');
---
> let uri: string = $ref("");
44,48c48,52
< 	const meta = await os.api('admin/meta');
< 	uri = meta.uri;
< 	enableTwitterIntegration = meta.enableTwitterIntegration;
< 	twitterConsumerKey = meta.twitterConsumerKey;
< 	twitterConsumerSecret = meta.twitterConsumerSecret;
---
>   const meta = await os.api("admin/meta");
>   uri = meta.uri;
>   enableTwitterIntegration = meta.enableTwitterIntegration;
>   twitterConsumerKey = meta.twitterConsumerKey;
>   twitterConsumerSecret = meta.twitterConsumerSecret;
52,58c56,62
< 	os.apiWithDialog('admin/update-meta', {
< 		enableTwitterIntegration,
< 		twitterConsumerKey,
< 		twitterConsumerSecret,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     enableTwitterIntegration,
>     twitterConsumerKey,
>     twitterConsumerSecret,
>   }).then(() => {
>     fetchInstance();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/integrations.vue RiricaV13/pages/admin/integrations.vue
2,28c2,33
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<div class="_gaps_m">
< 				<MkFolder>
< 					<template #icon><i class="ti ti-brand-twitter"></i></template>
< 					<template #label>Twitter</template>
< 					<template #suffix>{{ enableTwitterIntegration ? i18n.ts.enabled : i18n.ts.disabled }}</template>
< 					<XTwitter/>
< 				</MkFolder>
< 				<MkFolder>
< 					<template #icon><i class="ti ti-brand-github"></i></template>
< 					<template #label>GitHub</template>
< 					<template #suffix>{{ enableGithubIntegration ? i18n.ts.enabled : i18n.ts.disabled }}</template>
< 					<XGithub/>
< 				</MkFolder>
< 				<MkFolder>
< 					<template #icon><i class="ti ti-brand-discord"></i></template>
< 					<template #label>Discord</template>
< 					<template #suffix>{{ enableDiscordIntegration ? i18n.ts.enabled : i18n.ts.disabled }}</template>
< 					<XDiscord/>
< 				</MkFolder>
< 			</div>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <FormFolder class="_formBlock">
>           <template #icon><i class="fab fa-twitter"></i></template>
>           <template #label>Twitter</template>
>           <template #suffix>{{
>             enableTwitterIntegration ? i18n.ts.enabled : i18n.ts.disabled
>           }}</template>
>           <XTwitter />
>         </FormFolder>
>         <FormFolder class="_formBlock">
>           <template #icon><i class="fab fa-github"></i></template>
>           <template #label>GitHub</template>
>           <template #suffix>{{
>             enableGithubIntegration ? i18n.ts.enabled : i18n.ts.disabled
>           }}</template>
>           <XGithub />
>         </FormFolder>
>         <FormFolder class="_formBlock">
>           <template #icon><i class="fab fa-discord"></i></template>
>           <template #label>Discord</template>
>           <template #suffix>{{
>             enableDiscordIntegration ? i18n.ts.enabled : i18n.ts.disabled
>           }}</template>
>           <XDiscord />
>         </FormFolder>
>       </FormSuspense> </MkSpacer
>   ></MkStickyContainer>
32,40c37,45
< import { } from 'vue';
< import XTwitter from './integrations.twitter.vue';
< import XGithub from './integrations.github.vue';
< import XDiscord from './integrations.discord.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XTwitter from "./integrations.twitter.vue";
> import XGithub from "./integrations.github.vue";
> import XDiscord from "./integrations.discord.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormFolder from "@/components/form/folder.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
47,50c52,55
< 	const meta = await os.api('admin/meta');
< 	enableTwitterIntegration = meta.enableTwitterIntegration;
< 	enableGithubIntegration = meta.enableGithubIntegration;
< 	enableDiscordIntegration = meta.enableDiscordIntegration;
---
>   const meta = await os.api("admin/meta");
>   enableTwitterIntegration = meta.enableTwitterIntegration;
>   enableGithubIntegration = meta.enableGithubIntegration;
>   enableDiscordIntegration = meta.enableDiscordIntegration;
58,59c63,64
< 	title: i18n.ts.integration,
< 	icon: 'ti ti-share',
---
>   title: i18n.ts.integration,
>   icon: "fas fa-share-alt",
Only in RiricaV13/pages/admin: metrics.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/object-storage.vue RiricaV13/pages/admin/object-storage.vue
2,7c2,11
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<div class="_gaps_m">
< 				<MkSwitch v-model="useObjectStorage">{{ i18n.ts.useObjectStorage }}</MkSwitch>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <div class="_formRoot">
>           <FormSwitch v-model="useObjectStorage" class="_formBlock">{{
>             i18n.ts.useObjectStorage
>           }}</FormSwitch>
9,13c13,19
< 				<template v-if="useObjectStorage">
< 					<MkInput v-model="objectStorageBaseUrl">
< 						<template #label>{{ i18n.ts.objectStorageBaseUrl }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageBaseUrlDesc }}</template>
< 					</MkInput>
---
>           <template v-if="useObjectStorage">
>             <FormInput v-model="objectStorageBaseUrl" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageBaseUrl }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageBaseUrlDesc
>               }}</template>
>             </FormInput>
15,18c21,26
< 					<MkInput v-model="objectStorageBucket">
< 						<template #label>{{ i18n.ts.objectStorageBucket }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageBucketDesc }}</template>
< 					</MkInput>
---
>             <FormInput v-model="objectStorageBucket" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageBucket }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageBucketDesc
>               }}</template>
>             </FormInput>
20,23c28,33
< 					<MkInput v-model="objectStoragePrefix">
< 						<template #label>{{ i18n.ts.objectStoragePrefix }}</template>
< 						<template #caption>{{ i18n.ts.objectStoragePrefixDesc }}</template>
< 					</MkInput>
---
>             <FormInput v-model="objectStoragePrefix" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStoragePrefix }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStoragePrefixDesc
>               }}</template>
>             </FormInput>
25,28c35,40
< 					<MkInput v-model="objectStorageEndpoint">
< 						<template #label>{{ i18n.ts.objectStorageEndpoint }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageEndpointDesc }}</template>
< 					</MkInput>
---
>             <FormInput v-model="objectStorageEndpoint" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageEndpoint }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageEndpointDesc
>               }}</template>
>             </FormInput>
30,33c42,47
< 					<MkInput v-model="objectStorageRegion">
< 						<template #label>{{ i18n.ts.objectStorageRegion }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageRegionDesc }}</template>
< 					</MkInput>
---
>             <FormInput v-model="objectStorageRegion" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageRegion }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageRegionDesc
>               }}</template>
>             </FormInput>
35,39c49,53
< 					<FormSplit :min-width="280">
< 						<MkInput v-model="objectStorageAccessKey">
< 							<template #prefix><i class="ti ti-key"></i></template>
< 							<template #label>Access key</template>
< 						</MkInput>
---
>             <FormSplit :min-width="280">
>               <FormInput v-model="objectStorageAccessKey" class="_formBlock">
>                 <template #prefix><i class="fas fa-key"></i></template>
>                 <template #label>Access key</template>
>               </FormInput>
41,45c55,59
< 						<MkInput v-model="objectStorageSecretKey" type="password">
< 							<template #prefix><i class="ti ti-key"></i></template>
< 							<template #label>Secret key</template>
< 						</MkInput>
< 					</FormSplit>
---
>               <FormInput v-model="objectStorageSecretKey" class="_formBlock">
>                 <template #prefix><i class="fas fa-key"></i></template>
>                 <template #label>Secret key</template>
>               </FormInput>
>             </FormSplit>
47,50c61,66
< 					<MkSwitch v-model="objectStorageUseSSL">
< 						<template #label>{{ i18n.ts.objectStorageUseSSL }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageUseSSLDesc }}</template>
< 					</MkSwitch>
---
>             <FormSwitch v-model="objectStorageUseSSL" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageUseSSL }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageUseSSLDesc
>               }}</template>
>             </FormSwitch>
52,55c68,73
< 					<MkSwitch v-model="objectStorageUseProxy">
< 						<template #label>{{ i18n.ts.objectStorageUseProxy }}</template>
< 						<template #caption>{{ i18n.ts.objectStorageUseProxyDesc }}</template>
< 					</MkSwitch>
---
>             <FormSwitch v-model="objectStorageUseProxy" class="_formBlock">
>               <template #label>{{ i18n.ts.objectStorageUseProxy }}</template>
>               <template #caption>{{
>                 i18n.ts.objectStorageUseProxyDesc
>               }}</template>
>             </FormSwitch>
57,59c75,79
< 					<MkSwitch v-model="objectStorageSetPublicRead">
< 						<template #label>{{ i18n.ts.objectStorageSetPublicRead }}</template>
< 					</MkSwitch>
---
>             <FormSwitch v-model="objectStorageSetPublicRead" class="_formBlock">
>               <template #label>{{
>                 i18n.ts.objectStorageSetPublicRead
>               }}</template>
>             </FormSwitch>
61,68c81,91
< 					<MkSwitch v-model="objectStorageS3ForcePathStyle">
< 						<template #label>s3ForcePathStyle</template>
< 					</MkSwitch>
< 				</template>
< 			</div>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>             <FormSwitch
>               v-model="objectStorageS3ForcePathStyle"
>               class="_formBlock"
>             >
>               <template #label>s3ForcePathStyle</template>
>             </FormSwitch>
>           </template>
>         </div>
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
72,82c95,105
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import FormSplit from '@/components/form/split.vue';
< import FormSection from '@/components/form/section.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormSection from "@/components/form/section.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
99,112c122,135
< 	const meta = await os.api('admin/meta');
< 	useObjectStorage = meta.useObjectStorage;
< 	objectStorageBaseUrl = meta.objectStorageBaseUrl;
< 	objectStorageBucket = meta.objectStorageBucket;
< 	objectStoragePrefix = meta.objectStoragePrefix;
< 	objectStorageEndpoint = meta.objectStorageEndpoint;
< 	objectStorageRegion = meta.objectStorageRegion;
< 	objectStoragePort = meta.objectStoragePort;
< 	objectStorageAccessKey = meta.objectStorageAccessKey;
< 	objectStorageSecretKey = meta.objectStorageSecretKey;
< 	objectStorageUseSSL = meta.objectStorageUseSSL;
< 	objectStorageUseProxy = meta.objectStorageUseProxy;
< 	objectStorageSetPublicRead = meta.objectStorageSetPublicRead;
< 	objectStorageS3ForcePathStyle = meta.objectStorageS3ForcePathStyle;
---
>   const meta = await os.api("admin/meta");
>   useObjectStorage = meta.useObjectStorage;
>   objectStorageBaseUrl = meta.objectStorageBaseUrl;
>   objectStorageBucket = meta.objectStorageBucket;
>   objectStoragePrefix = meta.objectStoragePrefix;
>   objectStorageEndpoint = meta.objectStorageEndpoint;
>   objectStorageRegion = meta.objectStorageRegion;
>   objectStoragePort = meta.objectStoragePort;
>   objectStorageAccessKey = meta.objectStorageAccessKey;
>   objectStorageSecretKey = meta.objectStorageSecretKey;
>   objectStorageUseSSL = meta.objectStorageUseSSL;
>   objectStorageUseProxy = meta.objectStorageUseProxy;
>   objectStorageSetPublicRead = meta.objectStorageSetPublicRead;
>   objectStorageS3ForcePathStyle = meta.objectStorageS3ForcePathStyle;
116,132c139,155
< 	os.apiWithDialog('admin/update-meta', {
< 		useObjectStorage,
< 		objectStorageBaseUrl,
< 		objectStorageBucket,
< 		objectStoragePrefix,
< 		objectStorageEndpoint,
< 		objectStorageRegion,
< 		objectStoragePort,
< 		objectStorageAccessKey,
< 		objectStorageSecretKey,
< 		objectStorageUseSSL,
< 		objectStorageUseProxy,
< 		objectStorageSetPublicRead,
< 		objectStorageS3ForcePathStyle,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     useObjectStorage,
>     objectStorageBaseUrl,
>     objectStorageBucket,
>     objectStoragePrefix,
>     objectStorageEndpoint,
>     objectStorageRegion,
>     objectStoragePort,
>     objectStorageAccessKey,
>     objectStorageSecretKey,
>     objectStorageUseSSL,
>     objectStorageUseProxy,
>     objectStorageSetPublicRead,
>     objectStorageS3ForcePathStyle,
>   }).then(() => {
>     fetchInstance();
>   });
135,140c158,165
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-check',
< 	text: i18n.ts.save,
< 	handler: save,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-check",
>     text: i18n.ts.save,
>     handler: save,
>   },
> ]);
145,146c170,171
< 	title: i18n.ts.objectStorage,
< 	icon: 'ti ti-cloud',
---
>   title: i18n.ts.objectStorage,
>   icon: "fas fa-cloud",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/other-settings.vue RiricaV13/pages/admin/other-settings.vue
2,9c2,9
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			none
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init"> none </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
13,19c13,19
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
22c22
< 	await os.api('admin/meta');
---
>   await os.api("admin/meta");
26,28c26,28
< 	os.apiWithDialog('admin/update-meta').then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta").then(() => {
>     fetchInstance();
>   });
31,36c31,38
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-check',
< 	text: i18n.ts.save,
< 	handler: save,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-check",
>     text: i18n.ts.save,
>     handler: save,
>   },
> ]);
41,42c43,44
< 	title: i18n.ts.other,
< 	icon: 'ti ti-adjustments',
---
>   title: i18n.ts.other,
>   icon: "fas fa-cogs",
Only in misskeyV13/packages/frontend/src/pages/admin: overview.active-users.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.ap-requests.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/overview.federation.vue RiricaV13/pages/admin/overview.federation.vue
2,40c2,24
< <div>
< 	<MkLoading v-if="fetching"/>
< 	<div v-show="!fetching" :class="$style.root">
< 		<div v-if="topSubInstancesForPie && topPubInstancesForPie" class="pies">
< 			<div class="pie deliver _panel">
< 				<div class="title">Sub</div>
< 				<XPie :data="topSubInstancesForPie" class="chart"/>
< 				<div class="subTitle">Top 10</div>
< 			</div>
< 			<div class="pie inbox _panel">
< 				<div class="title">Pub</div>
< 				<XPie :data="topPubInstancesForPie" class="chart"/>
< 				<div class="subTitle">Top 10</div>
< 			</div>
< 		</div>
< 		<div v-if="!fetching" class="items">
< 			<div class="item _panel sub">
< 				<div class="icon"><i class="ti ti-world-download"></i></div>
< 				<div class="body">
< 					<div class="value">
< 						{{ number(federationSubActive) }}
< 						<MkNumberDiff v-tooltip="i18n.ts.dayOverDayChanges" class="diff" :value="federationSubActiveDiff"></MkNumberDiff>
< 					</div>
< 					<div class="label">Sub</div>
< 				</div>
< 			</div>
< 			<div class="item _panel pub">
< 				<div class="icon"><i class="ti ti-world-upload"></i></div>
< 				<div class="body">
< 					<div class="value">
< 						{{ number(federationPubActive) }}
< 						<MkNumberDiff v-tooltip="i18n.ts.dayOverDayChanges" class="diff" :value="federationPubActiveDiff"></MkNumberDiff>
< 					</div>
< 					<div class="label">Pub</div>
< 				</div>
< 			</div>
< 		</div>
< 	</div>
< </div>
---
>   <div class="wbrkwale">
>     <MkLoading v-if="fetching" />
>     <transition-group
>       v-else
>       tag="div"
>       :name="$store.state.animation ? 'chart' : ''"
>       class="instances"
>     >
>       <MkA
>         v-for="(instance, i) in instances"
>         :key="instance.id"
>         :to="`/instance-info/${instance.host}`"
>         class="instance"
>       >
>         <img v-if="instance.iconUrl" :src="instance.iconUrl" alt="" />
>         <div class="body">
>           <div class="name">{{ instance.name ?? instance.host }}</div>
>           <div class="host">{{ instance.host }}</div>
>         </div>
>         <MkMiniChart class="chart" :src="charts[i].requests.received" />
>       </MkA>
>     </transition-group>
>   </div>
44,51c28,31
< import { onMounted, onUnmounted, ref } from 'vue';
< import XPie from './overview.pie.vue';
< import MkMiniChart from '@/components/MkMiniChart.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import MkNumberDiff from '@/components/MkNumberDiff.vue';
< import { i18n } from '@/i18n';
< import { useChartTooltip } from '@/scripts/use-chart-tooltip';
---
> import { onMounted, onUnmounted, ref } from "vue";
> import MkMiniChart from "@/components/MkMiniChart.vue";
> import * as os from "@/os";
> import { useInterval } from "@/scripts/use-interval";
53,59c33,35
< let topSubInstancesForPie: any = $ref(null);
< let topPubInstancesForPie: any = $ref(null);
< let federationPubActive = $ref<number | null>(null);
< let federationPubActiveDiff = $ref<number | null>(null);
< let federationSubActive = $ref<number | null>(null);
< let federationSubActiveDiff = $ref<number | null>(null);
< let fetching = $ref(true);
---
> const instances = ref([]);
> const charts = ref([]);
> const fetching = ref(true);
61,68c37,50
< const { handler: externalTooltipHandler } = useChartTooltip();
< 	
< onMounted(async () => {
< 	const chart = await os.apiGet('charts/federation', { limit: 2, span: 'day' });
< 	federationPubActive = chart.pubActive[0];
< 	federationPubActiveDiff = chart.pubActive[0] - chart.pubActive[1];
< 	federationSubActive = chart.subActive[0];
< 	federationSubActiveDiff = chart.subActive[0] - chart.subActive[1];
---
> const fetch = async () => {
>   const fetchedInstances = await os.api("federation/instances", {
>     sort: "+lastCommunicatedAt",
>     limit: 5,
>   });
>   const fetchedCharts = await Promise.all(
>     fetchedInstances.map((i) =>
>       os.apiGet("charts/instance", { host: i.host, limit: 16, span: "hour" })
>     )
>   );
>   instances.value = fetchedInstances;
>   charts.value = fetchedCharts;
>   fetching.value = false;
> };
70,89c52,54
< 	os.apiGet('federation/stats', { limit: 10 }).then(res => {
< 		topSubInstancesForPie = res.topSubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followersCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: res.otherFollowersCount }]);
< 		topPubInstancesForPie = res.topPubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followingCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: res.otherFollowingCount }]);
< 	});
< 
< 	fetching = false;
---
> useInterval(fetch, 1000 * 60, {
>   immediate: true,
>   afterMounted: true,
93,94c58,63
< <style lang="scss" module>
< .root {
---
> <style lang="scss" scoped>
> .wbrkwale {
>   > .instances {
>     .chart-move {
>       transition: transform 1s ease;
>     }
96,101c65,68
< 	&:global {
< 		> .pies {
< 			display: grid;
< 			grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
< 			grid-gap: 12px;
< 			margin-bottom: 12px;
---
>     > .instance {
>       display: flex;
>       align-items: center;
>       padding: 16px 20px;
103,105c70,72
< 			> .pie {
< 				position: relative;
< 				padding: 12px;
---
>       &:not(:last-child) {
>         border-bottom: solid 0.5px var(--divider);
>       }
107,112c74,81
< 				> .title {
< 					position: absolute;
< 					top: 20px;
< 					left: 20px;
< 					font-size: 90%;
< 				}
---
>       > img {
>         display: block;
>         width: 34px;
>         height: 34px;
>         object-fit: cover;
>         border-radius: 4px;
>         margin-right: 12px;
>       }
114,116c83,88
< 				> .chart {
< 					max-height: 150px;
< 				}
---
>       > .body {
>         flex: 1;
>         overflow: hidden;
>         font-size: 0.9em;
>         color: var(--fg);
>         padding-right: 8px;
118,125c90,96
< 				> .subTitle {
< 					position: absolute;
< 					bottom: 20px;
< 					right: 20px;
< 					font-size: 85%;
< 				}
< 			}
< 		}
---
>         > .name {
>           display: block;
>           width: 100%;
>           white-space: nowrap;
>           overflow: hidden;
>           text-overflow: ellipsis;
>         }
127,130c98,106
< 		> .items {
< 			display: grid;
< 			grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
< 			grid-gap: 12px;
---
>         > .host {
>           margin: 0;
>           font-size: 75%;
>           opacity: 0.7;
>           white-space: nowrap;
>           overflow: hidden;
>           text-overflow: ellipsis;
>         }
>       }
132,182c108,112
< 			> .item {
< 				display: flex;
< 				box-sizing: border-box;
< 				padding: 12px;
< 
< 				> .icon {
< 					display: grid;
< 					place-items: center;
< 					height: 100%;
< 					aspect-ratio: 1;
< 					margin-right: 12px;
< 					background: var(--accentedBg);
< 					color: var(--accent);
< 					border-radius: 10px;
< 				}
< 
< 				&.sub {
< 					> .icon {
< 						background: #d5ba0026;
< 						color: #dfc300;
< 					}
< 				}
< 
< 				&.pub {
< 					> .icon {
< 						background: #00cf2326;
< 						color: #00cd5b;
< 					}
< 				}
< 
< 				> .body {
< 					padding: 2px 0;
< 
< 					> .value {
< 						font-size: 1.2em;
< 						font-weight: bold;
< 
< 						> .diff {
< 							font-size: 0.65em;
< 							font-weight: normal;
< 						}
< 					}
< 
< 					> .label {
< 						font-size: 0.8em;
< 						opacity: 0.5;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>       > .chart {
>         height: 30px;
>       }
>     }
>   }
185d114
< 
Only in misskeyV13/packages/frontend/src/pages/admin: overview.heatmap.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.instances.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.moderators.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/overview.pie.vue RiricaV13/pages/admin/overview.pie.vue
2c2
< <canvas ref="chartEl"></canvas>
---
>   <canvas ref="chartEl"></canvas>
6,11c6,27
< import { onMounted, onUnmounted, ref, shallowRef } from 'vue';
< import { Chart } from 'chart.js';
< import number from '@/filters/number';
< import { defaultStore } from '@/store';
< import { useChartTooltip } from '@/scripts/use-chart-tooltip';
< import { initChart } from '@/scripts/init-chart';
---
> import { onMounted, onUnmounted, ref } from "vue";
> import {
>   Chart,
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
>   DoughnutController,
> } from "chart.js";
> import number from "@/filters/number";
> import { defaultStore } from "@/store";
> import { useChartTooltip } from "@/scripts/use-chart-tooltip";
13c29,45
< initChart();
---
> Chart.register(
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   DoughnutController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler
> );
16c48
< 	data: { name: string; value: number; color: string; onClick?: () => void }[];
---
>   data: { name: string; value: number; color: string; onClick?: () => void }[];
19c51
< const chartEl = shallowRef<HTMLCanvasElement>(null);
---
> const chartEl = ref<HTMLCanvasElement>(null);
21,23c53,56
< const { handler: externalTooltipHandler } = useChartTooltip({
< 	position: 'middle',
< });
---
> // フォントカラー
> Chart.defaults.color = getComputedStyle(
>   document.documentElement
> ).getPropertyValue("--fg");
24a58,59
> const { handler: externalTooltipHandler } = useChartTooltip();
> 
28,69c63,113
< 	chartInstance = new Chart(chartEl.value, {
< 		type: 'doughnut',
< 		data: {
< 			labels: props.data.map(x => x.name),
< 			datasets: [{
< 				backgroundColor: props.data.map(x => x.color),
< 				borderColor: getComputedStyle(document.documentElement).getPropertyValue('--panel'),
< 				borderWidth: 2,
< 				hoverOffset: 0,
< 				data: props.data.map(x => x.value),
< 			}],
< 		},
< 		options: {
< 			layout: {
< 				padding: {
< 					left: 16,
< 					right: 16,
< 					top: 16,
< 					bottom: 16,
< 				},
< 			},
< 			onClick: (ev) => {
< 				const hit = chartInstance.getElementsAtEventForMode(ev, 'nearest', { intersect: true }, false)[0];
< 				if (hit && props.data[hit.index].onClick) {
< 					props.data[hit.index].onClick();
< 				}
< 			},
< 			plugins: {
< 				legend: {
< 					display: false,
< 				},
< 				tooltip: {
< 					enabled: false,
< 					mode: 'index',
< 					animation: {
< 						duration: 0,
< 					},
< 					external: externalTooltipHandler,
< 				},
< 			},
< 		},
< 	});
---
>   chartInstance = new Chart(chartEl.value, {
>     type: "doughnut",
>     data: {
>       labels: props.data.map((x) => x.name),
>       datasets: [
>         {
>           backgroundColor: props.data.map((x) => x.color),
>           borderColor: getComputedStyle(
>             document.documentElement
>           ).getPropertyValue("--panel"),
>           borderWidth: 2,
>           hoverOffset: 0,
>           data: props.data.map((x) => x.value),
>         },
>       ],
>     },
>     options: {
>       layout: {
>         padding: {
>           left: 16,
>           right: 16,
>           top: 16,
>           bottom: 16,
>         },
>       },
>       onClick: (ev) => {
>         const hit = chartInstance.getElementsAtEventForMode(
>           ev,
>           "nearest",
>           { intersect: true },
>           false
>         )[0];
>         if (hit && props.data[hit.index].onClick) {
>           props.data[hit.index].onClick();
>         }
>       },
>       plugins: {
>         legend: {
>           display: false,
>         },
>         tooltip: {
>           enabled: false,
>           mode: "index",
>           animation: {
>             duration: 0,
>           },
>           external: externalTooltipHandler,
>         },
>       },
>     },
>   });
73,75c117
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
Only in RiricaV13/pages/admin: overview.queue-chart.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.queue.chart.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.queue.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.retention.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.stats.vue
Only in RiricaV13/pages/admin: overview.user.vue
Only in misskeyV13/packages/frontend/src/pages/admin: overview.users.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/overview.vue RiricaV13/pages/admin/overview.vue
2,7c2,37
< <MkSpacer :content-max="1000">
< 	<div ref="rootEl" class="edbbcaef">
< 		<MkFoldableSection class="item">
< 			<template #header>Stats</template>
< 			<XStats/>
< 		</MkFoldableSection>
---
>   <MkSpacer :content-max="900">
>     <div ref="rootEl" v-size="{ max: [740] }" class="edbbcaef">
>       <div class="left">
>         <div v-if="stats" class="container stats">
>           <div class="title">Stats</div>
>           <div class="body">
>             <div class="number _panel">
>               <div class="label">Users</div>
>               <div class="value _monospace">
>                 {{ number(stats.originalUsersCount) }}
>                 <MkNumberDiff
>                   v-if="usersComparedToThePrevDay != null"
>                   v-tooltip="i18n.ts.dayOverDayChanges"
>                   class="diff"
>                   :value="usersComparedToThePrevDay"
>                   ><template #before>(</template
>                   ><template #after>)</template></MkNumberDiff
>                 >
>               </div>
>             </div>
>             <div class="number _panel">
>               <div class="label">Notes</div>
>               <div class="value _monospace">
>                 {{ number(stats.originalNotesCount) }}
>                 <MkNumberDiff
>                   v-if="notesComparedToThePrevDay != null"
>                   v-tooltip="i18n.ts.dayOverDayChanges"
>                   class="diff"
>                   :value="notesComparedToThePrevDay"
>                   ><template #before>(</template
>                   ><template #after>)</template></MkNumberDiff
>                 >
>               </div>
>             </div>
>           </div>
>         </div>
9,12c39,54
< 		<MkFoldableSection class="item">
< 			<template #header>Active users</template>
< 			<XActiveUsers/>
< 		</MkFoldableSection>
---
>         <div class="container queue">
>           <div class="title">Job queue</div>
>           <div class="body">
>             <div class="chart deliver">
>               <div class="title">Deliver</div>
>               <XQueueChart
>                 :connection="queueStatsConnection"
>                 domain="deliver"
>               />
>             </div>
>             <div class="chart inbox">
>               <div class="title">Inbox</div>
>               <XQueueChart :connection="queueStatsConnection" domain="inbox" />
>             </div>
>           </div>
>         </div>
14,17c56,66
< 		<MkFoldableSection class="item">
< 			<template #header>Heatmap</template>
< 			<XHeatmap/>
< 		</MkFoldableSection>
---
>         <div class="container users">
>           <div class="title">New users</div>
>           <div v-if="newUsers" class="body">
>             <XUser
>               v-for="user in newUsers"
>               :key="user.id"
>               class="user"
>               :user="user"
>             />
>           </div>
>         </div>
19,22c68,76
< 		<MkFoldableSection class="item">
< 			<template #header>Retention rate</template>
< 			<XRetention/>
< 		</MkFoldableSection>
---
>         <div class="container files">
>           <div class="title">Recent files</div>
>           <div class="body">
>             <MkFileListForAdmin
>               :pagination="filesPagination"
>               view-mode="grid"
>             />
>           </div>
>         </div>
24,59c78,178
< 		<MkFoldableSection class="item">
< 			<template #header>Moderators</template>
< 			<XModerators/>
< 		</MkFoldableSection>
< 
< 		<MkFoldableSection class="item">
< 			<template #header>Federation</template>
< 			<XFederation/>
< 		</MkFoldableSection>
< 		
< 		<MkFoldableSection class="item">
< 			<template #header>Instances</template>
< 			<XInstances/>
< 		</MkFoldableSection>
< 
< 		<MkFoldableSection class="item">
< 			<template #header>Ap requests</template>
< 			<XApRequests/>
< 		</MkFoldableSection>
< 
< 		<MkFoldableSection class="item">
< 			<template #header>New users</template>
< 			<XUsers/>
< 		</MkFoldableSection>
< 
< 		<MkFoldableSection class="item">
< 			<template #header>Deliver queue</template>
< 			<XQueue domain="deliver"/>
< 		</MkFoldableSection>
< 
< 		<MkFoldableSection class="item">
< 			<template #header>Inbox queue</template>
< 			<XQueue domain="inbox"/>
< 		</MkFoldableSection>
< 	</div>
< </MkSpacer>
---
>         <div class="container env">
>           <div class="title">Enviroment</div>
>           <div class="body">
>             <div class="number _panel">
>               <div class="label">Misskey</div>
>               <div class="value _monospace">{{ version }}</div>
>             </div>
>             <div v-if="serverInfo" class="number _panel">
>               <div class="label">Node.js</div>
>               <div class="value _monospace">{{ serverInfo.node }}</div>
>             </div>
>             <div v-if="serverInfo" class="number _panel">
>               <div class="label">PostgreSQL</div>
>               <div class="value _monospace">{{ serverInfo.psql }}</div>
>             </div>
>             <div v-if="serverInfo" class="number _panel">
>               <div class="label">Redis</div>
>               <div class="value _monospace">{{ serverInfo.redis }}</div>
>             </div>
>             <div class="number _panel">
>               <div class="label">Vue</div>
>               <div class="value _monospace">{{ vueVersion }}</div>
>             </div>
>           </div>
>         </div>
>       </div>
>       <div class="right">
>         <div class="container charts">
>           <div class="title">Active users</div>
>           <div class="body">
>             <canvas ref="chartEl"></canvas>
>           </div>
>         </div>
>         <div class="container federation">
>           <div class="title">Active instances</div>
>           <div class="body">
>             <XFederation />
>           </div>
>         </div>
>         <div v-if="stats" class="container federationStats">
>           <div class="title">Federation</div>
>           <div class="body">
>             <div class="number _panel">
>               <div class="label">Sub</div>
>               <div class="value _monospace">
>                 {{ number(federationSubActive) }}
>                 <MkNumberDiff
>                   v-tooltip="i18n.ts.dayOverDayChanges"
>                   class="diff"
>                   :value="federationSubActiveDiff"
>                   ><template #before>(</template
>                   ><template #after>)</template></MkNumberDiff
>                 >
>               </div>
>             </div>
>             <div class="number _panel">
>               <div class="label">Pub</div>
>               <div class="value _monospace">
>                 {{ number(federationPubActive) }}
>                 <MkNumberDiff
>                   v-tooltip="i18n.ts.dayOverDayChanges"
>                   class="diff"
>                   :value="federationPubActiveDiff"
>                   ><template #before>(</template
>                   ><template #after>)</template></MkNumberDiff
>                 >
>               </div>
>             </div>
>           </div>
>         </div>
>         <div class="container tagCloud">
>           <div class="body">
>             <MkTagCloud v-if="activeInstances">
>               <li v-for="instance in activeInstances">
>                 <a @click.prevent="onInstanceClick(instance)">
>                   <img style="width: 32px" :src="instance.iconUrl" />
>                 </a>
>               </li>
>             </MkTagCloud>
>           </div>
>         </div>
>         <div
>           v-if="topSubInstancesForPie && topPubInstancesForPie"
>           class="container federationPies"
>         >
>           <div class="body">
>             <div class="chart deliver">
>               <div class="title">Sub</div>
>               <XPie :data="topSubInstancesForPie" />
>               <div class="subTitle">Top 10</div>
>             </div>
>             <div class="chart inbox">
>               <div class="title">Pub</div>
>               <XPie :data="topPubInstancesForPie" />
>               <div class="subTitle">Top 10</div>
>             </div>
>           </div>
>         </div>
>       </div>
>     </div>
>   </MkSpacer>
63,82c182,225
< import { markRaw, version as vueVersion, onMounted, onBeforeUnmount, nextTick } from 'vue';
< import XFederation from './overview.federation.vue';
< import XInstances from './overview.instances.vue';
< import XQueue from './overview.queue.vue';
< import XApRequests from './overview.ap-requests.vue';
< import XUsers from './overview.users.vue';
< import XActiveUsers from './overview.active-users.vue';
< import XStats from './overview.stats.vue';
< import XRetention from './overview.retention.vue';
< import XModerators from './overview.moderators.vue';
< import XHeatmap from './overview.heatmap.vue';
< import MkTagCloud from '@/components/MkTagCloud.vue';
< import { version, url } from '@/config';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { defaultStore } from '@/store';
< import MkFileListForAdmin from '@/components/MkFileListForAdmin.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
---
> import {
>   markRaw,
>   version as vueVersion,
>   onMounted,
>   onBeforeUnmount,
>   nextTick,
> } from "vue";
> import {
>   Chart,
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
> } from "chart.js";
> import { enUS } from "date-fns/locale";
> import tinycolor from "tinycolor2";
> import MagicGrid from "magic-grid";
> import XMetrics from "./metrics.vue";
> import XFederation from "./overview.federation.vue";
> import XQueueChart from "./overview.queue-chart.vue";
> import XUser from "./overview.user.vue";
> import XPie from "./overview.pie.vue";
> import MkNumberDiff from "@/components/MkNumberDiff.vue";
> import MkTagCloud from "@/components/MkTagCloud.vue";
> import { version, url } from "@/config";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import "chartjs-adapter-date-fns";
> import { defaultStore } from "@/store";
> import { useChartTooltip } from "@/scripts/use-chart-tooltip";
> import MkFileListForAdmin from "@/components/MkFileListForAdmin.vue";
84c227,247
< const rootEl = $shallowRef<HTMLElement>();
---
> Chart.register(
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler
>   //gradient,
> );
> 
> const rootEl = $ref<HTMLElement>();
> const chartEl = $ref<HTMLCanvasElement>(null);
> let stats: any = $ref(null);
87a251,252
> let usersComparedToThePrevDay: any = $ref(null);
> let notesComparedToThePrevDay: any = $ref(null);
94c259
< const queueStatsConnection = markRaw(stream.useChannel('queueStats'));
---
> const queueStatsConnection = markRaw(stream.useChannel("queueStats"));
95a261,262
> let chartInstance: Chart = null;
> const chartLimit = 30;
97,99c264,266
< 	endpoint: 'admin/drive/files' as const,
< 	limit: 9,
< 	noPaging: true,
---
>   endpoint: "admin/drive/files" as const,
>   limit: 9,
>   noPaging: true,
101a269,439
> const { handler: externalTooltipHandler } = useChartTooltip();
> 
> async function renderChart() {
>   if (chartInstance) {
>     chartInstance.destroy();
>   }
> 
>   const getDate = (ago: number) => {
>     const y = now.getFullYear();
>     const m = now.getMonth();
>     const d = now.getDate();
> 
>     return new Date(y, m, d - ago);
>   };
> 
>   const format = (arr) => {
>     return arr.map((v, i) => ({
>       x: getDate(i).getTime(),
>       y: v,
>     }));
>   };
> 
>   const raw = await os.api("charts/active-users", {
>     limit: chartLimit,
>     span: "day",
>   });
> 
>   const gridColor = defaultStore.state.darkMode
>     ? "rgba(255, 255, 255, 0.1)"
>     : "rgba(0, 0, 0, 0.1)";
>   const vLineColor = defaultStore.state.darkMode
>     ? "rgba(255, 255, 255, 0.2)"
>     : "rgba(0, 0, 0, 0.2)";
> 
>   // フォントカラー
>   Chart.defaults.color = getComputedStyle(
>     document.documentElement
>   ).getPropertyValue("--fg");
> 
>   const color = tinycolor(
>     getComputedStyle(document.documentElement).getPropertyValue("--accent")
>   );
> 
>   chartInstance = new Chart(chartEl, {
>     type: "bar",
>     data: {
>       //labels: new Array(props.limit).fill(0).map((_, i) => getDate(i).toLocaleString()).slice().reverse(),
>       datasets: [
>         {
>           parsing: false,
>           label: "a",
>           data: format(raw.readWrite).slice().reverse(),
>           tension: 0.3,
>           pointRadius: 0,
>           borderWidth: 0,
>           borderJoinStyle: "round",
>           borderRadius: 3,
>           backgroundColor: color,
>           /*gradient: props.bar ? undefined : {
> 					backgroundColor: {
> 						axis: 'y',
> 						colors: {
> 							0: alpha(x.color ? x.color : getColor(i), 0),
> 							[maxes[i]]: alpha(x.color ? x.color : getColor(i), 0.2),
> 						},
> 					},
> 				},*/
>           barPercentage: 0.9,
>           categoryPercentage: 0.9,
>           clip: 8,
>         },
>       ],
>     },
>     options: {
>       aspectRatio: 2.5,
>       layout: {
>         padding: {
>           left: 0,
>           right: 0,
>           top: 0,
>           bottom: 0,
>         },
>       },
>       scales: {
>         x: {
>           type: "time",
>           display: false,
>           stacked: true,
>           offset: false,
>           time: {
>             stepSize: 1,
>             unit: "month",
>           },
>           grid: {
>             display: false,
>           },
>           ticks: {
>             display: false,
>           },
>           adapters: {
>             date: {
>               locale: enUS,
>             },
>           },
>           min: getDate(chartLimit).getTime(),
>         },
>         y: {
>           display: false,
>           position: "left",
>           stacked: true,
>           grid: {
>             display: false,
>           },
>           ticks: {
>             display: false,
>             //mirror: true,
>           },
>         },
>       },
>       interaction: {
>         intersect: false,
>         mode: "index",
>       },
>       elements: {
>         point: {
>           hoverRadius: 5,
>           hoverBorderWidth: 2,
>         },
>       },
>       animation: false,
>       plugins: {
>         legend: {
>           display: false,
>         },
>         tooltip: {
>           enabled: false,
>           mode: "index",
>           animation: {
>             duration: 0,
>           },
>           external: externalTooltipHandler,
>         },
>         //gradient,
>       },
>     },
>     plugins: [
>       {
>         id: "vLine",
>         beforeDraw(chart, args, options) {
>           if (chart.tooltip?._active?.length) {
>             const activePoint = chart.tooltip._active[0];
>             const ctx = chart.ctx;
>             const x = activePoint.element.x;
>             const topY = chart.scales.y.top;
>             const bottomY = chart.scales.y.bottom;
> 
>             ctx.save();
>             ctx.beginPath();
>             ctx.moveTo(x, bottomY);
>             ctx.lineTo(x, topY);
>             ctx.lineWidth = 1;
>             ctx.strokeStyle = vLineColor;
>             ctx.stroke();
>             ctx.restore();
>           }
>         },
>       },
>     ],
>   });
> }
> 
103c441
< 	os.pageWindow(`/instance-info/${i.host}`);
---
>   os.pageWindow(`/instance-info/${i.host}`);
107c445
< 	/*
---
>   /*
117,122c455
< 	os.apiGet('charts/federation', { limit: 2, span: 'day' }).then(chart => {
< 		federationPubActive = chart.pubActive[0];
< 		federationPubActiveDiff = chart.pubActive[0] - chart.pubActive[1];
< 		federationSubActive = chart.subActive[0];
< 		federationSubActiveDiff = chart.subActive[0] - chart.subActive[1];
< 	});
---
>   renderChart();
124,141c457,458
< 	os.apiGet('federation/stats', { limit: 10 }).then(res => {
< 		topSubInstancesForPie = res.topSubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followersCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: res.otherFollowersCount }]);
< 		topPubInstancesForPie = res.topPubInstances.map(x => ({
< 			name: x.host,
< 			color: x.themeColor,
< 			value: x.followingCount,
< 			onClick: () => {
< 				os.pageWindow(`/instance-info/${x.host}`);
< 			},
< 		})).concat([{ name: '(other)', color: '#80808080', value: res.otherFollowingCount }]);
< 	});
---
>   os.api("stats", {}).then((statsResponse) => {
>     stats = statsResponse;
143,145c460,463
< 	os.api('admin/server-info').then(serverInfoResponse => {
< 		serverInfo = serverInfoResponse;
< 	});
---
>     os.apiGet("charts/users", { limit: 2, span: "day" }).then((chart) => {
>       usersComparedToThePrevDay =
>         stats.originalUsersCount - chart.local.total[1];
>     });
147,152c465,469
< 	os.api('admin/show-users', {
< 		limit: 5,
< 		sort: '+createdAt',
< 	}).then(res => {
< 		newUsers = res;
< 	});
---
>     os.apiGet("charts/notes", { limit: 2, span: "day" }).then((chart) => {
>       notesComparedToThePrevDay =
>         stats.originalNotesCount - chart.local.total[1];
>     });
>   });
154,159c471,476
< 	os.api('federation/instances', {
< 		sort: '+latestRequestReceivedAt',
< 		limit: 25,
< 	}).then(res => {
< 		activeInstances = res;
< 	});
---
>   os.apiGet("charts/federation", { limit: 2, span: "day" }).then((chart) => {
>     federationPubActive = chart.pubActive[0];
>     federationPubActiveDiff = chart.pubActive[0] - chart.pubActive[1];
>     federationSubActive = chart.subActive[0];
>     federationSubActiveDiff = chart.subActive[0] - chart.subActive[1];
>   });
161,166c478,528
< 	nextTick(() => {
< 		queueStatsConnection.send('requestLog', {
< 			id: Math.random().toString().substr(2, 8),
< 			length: 100,
< 		});
< 	});
---
>   os.apiGet("federation/stats", { limit: 10 }).then((res) => {
>     topSubInstancesForPie = res.topSubInstances
>       .map((x) => ({
>         name: x.host,
>         color: x.themeColor,
>         value: x.followersCount,
>         onClick: () => {
>           os.pageWindow(`/instance-info/${x.host}`);
>         },
>       }))
>       .concat([
>         { name: "(other)", color: "#80808080", value: res.otherFollowersCount },
>       ]);
>     topPubInstancesForPie = res.topPubInstances
>       .map((x) => ({
>         name: x.host,
>         color: x.themeColor,
>         value: x.followingCount,
>         onClick: () => {
>           os.pageWindow(`/instance-info/${x.host}`);
>         },
>       }))
>       .concat([
>         { name: "(other)", color: "#80808080", value: res.otherFollowingCount },
>       ]);
>   });
> 
>   os.api("admin/server-info").then((serverInfoResponse) => {
>     serverInfo = serverInfoResponse;
>   });
> 
>   os.api("admin/show-users", {
>     limit: 5,
>     sort: "+createdAt",
>   }).then((res) => {
>     newUsers = res;
>   });
> 
>   os.api("federation/instances", {
>     sort: "+lastCommunicatedAt",
>     limit: 25,
>   }).then((res) => {
>     activeInstances = res;
>   });
> 
>   nextTick(() => {
>     queueStatsConnection.send("requestLog", {
>       id: Math.random().toString().substr(2, 8),
>       length: 100,
>     });
>   });
170c532
< 	queueStatsConnection.dispose();
---
>   queueStatsConnection.dispose();
178,179c540,541
< 	title: i18n.ts.dashboard,
< 	icon: 'ti ti-dashboard',
---
>   title: i18n.ts.dashboard,
>   icon: "fas fa-tachometer-alt",
185,187c547,708
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
< 	grid-gap: 16px;
---
>   display: flex;
> 
>   > .left,
>   > .right {
>     box-sizing: border-box;
>     width: 50%;
> 
>     > .container {
>       margin: 32px 0;
> 
>       > .title {
>         font-weight: bold;
>         margin-bottom: 16px;
>       }
> 
>       &.stats,
>       &.federationStats {
>         > .body {
>           display: grid;
>           grid-gap: 16px;
>           grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
> 
>           > .number {
>             padding: 14px 20px;
> 
>             > .label {
>               opacity: 0.7;
>               font-size: 0.8em;
>             }
> 
>             > .value {
>               font-weight: bold;
>               font-size: 1.5em;
> 
>               > .diff {
>                 font-size: 0.7em;
>               }
>             }
>           }
>         }
>       }
> 
>       &.env {
>         > .body {
>           display: grid;
>           grid-gap: 16px;
>           grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
> 
>           > .number {
>             padding: 14px 20px;
> 
>             > .label {
>               opacity: 0.7;
>               font-size: 0.8em;
>             }
> 
>             > .value {
>               font-size: 1.1em;
>             }
>           }
>         }
>       }
> 
>       &.charts {
>         > .body {
>           padding: 32px;
>           background: var(--panel);
>           border-radius: var(--radius);
>         }
>       }
> 
>       &.users {
>         > .body {
>           background: var(--panel);
>           border-radius: var(--radius);
> 
>           > .user {
>             padding: 16px 20px;
> 
>             &:not(:last-child) {
>               border-bottom: solid 0.5px var(--divider);
>             }
>           }
>         }
>       }
> 
>       &.federation {
>         > .body {
>           background: var(--panel);
>           border-radius: var(--radius);
>           overflow: clip;
>         }
>       }
> 
>       &.queue {
>         > .body {
>           display: grid;
>           grid-gap: 16px;
>           grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
> 
>           > .chart {
>             position: relative;
>             padding: 20px;
>             background: var(--panel);
>             border-radius: var(--radius);
> 
>             > .title {
>               position: absolute;
>               top: 20px;
>               left: 20px;
>               font-size: 90%;
>             }
>           }
>         }
>       }
> 
>       &.federationPies {
>         > .body {
>           display: grid;
>           grid-gap: 16px;
>           grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
> 
>           > .chart {
>             position: relative;
>             padding: 20px;
>             background: var(--panel);
>             border-radius: var(--radius);
> 
>             > .title {
>               position: absolute;
>               top: 20px;
>               left: 20px;
>               font-size: 90%;
>             }
> 
>             > .subTitle {
>               position: absolute;
>               bottom: 20px;
>               right: 20px;
>               font-size: 85%;
>             }
>           }
>         }
>       }
> 
>       &.tagCloud {
>         > .body {
>           background: var(--panel);
>           border-radius: var(--radius);
>           overflow: clip;
>         }
>       }
>     }
>   }
> 
>   > .left {
>     padding-right: 16px;
>   }
> 
>   > .right {
>     padding-left: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/proxy-account.vue RiricaV13/pages/admin/proxy-account.vue
2,10c2,16
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<MkInfo>{{ i18n.ts.proxyAccountDescription }}</MkInfo>
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.proxyAccount }}</template>
< 				<template #value>{{ proxyAccount ? `@${proxyAccount.username}` : i18n.ts.none }}</template>
< 			</MkKeyValue>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <MkInfo class="_formBlock">{{
>           i18n.ts.proxyAccountDescription
>         }}</MkInfo>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.proxyAccount }}</template>
>           <template #value>{{
>             proxyAccount ? `@${proxyAccount.username}` : i18n.ts.none
>           }}</template>
>         </MkKeyValue>
12,15c18,23
< 			<MkButton primary @click="chooseProxyAccount">{{ i18n.ts.selectAccount }}</MkButton>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <FormButton primary class="_formBlock" @click="chooseProxyAccount">{{
>           i18n.ts.selectAccount
>         }}</FormButton>
>       </FormSuspense>
>     </MkSpacer></MkStickyContainer
>   >
19,27c27,35
< import { } from 'vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import FormButton from "@/components/MkButton.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
33,37c41,45
< 	const meta = await os.api('admin/meta');
< 	proxyAccountId = meta.proxyAccountId;
< 	if (proxyAccountId) {
< 		proxyAccount = await os.api('users/show', { userId: proxyAccountId });
< 	}
---
>   const meta = await os.api("admin/meta");
>   proxyAccountId = meta.proxyAccountId;
>   if (proxyAccountId) {
>     proxyAccount = await os.api("users/show", { userId: proxyAccountId });
>   }
41,45c49,53
< 	os.selectUser().then(user => {
< 		proxyAccount = user;
< 		proxyAccountId = user.id;
< 		save();
< 	});
---
>   os.selectUser().then((user) => {
>     proxyAccount = user;
>     proxyAccountId = user.id;
>     save();
>   });
49,53c57,61
< 	os.apiWithDialog('admin/update-meta', {
< 		proxyAccountId: proxyAccountId,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     proxyAccountId: proxyAccountId,
>   }).then(() => {
>     fetchInstance();
>   });
61,62c69,70
< 	title: i18n.ts.proxyAccount,
< 	icon: 'ti ti-ghost',
---
>   title: i18n.ts.proxyAccount,
>   icon: "fas fa-ghost",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/queue.chart.chart.vue RiricaV13/pages/admin/queue.chart.chart.vue
2c2
< <canvas ref="chartEl"></canvas>
---
>   <canvas ref="chartEl"></canvas>
6,14c6,27
< import { watch, onMounted, onUnmounted, ref, shallowRef } from 'vue';
< import { Chart } from 'chart.js';
< import number from '@/filters/number';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { useChartTooltip } from '@/scripts/use-chart-tooltip';
< import { chartVLine } from '@/scripts/chart-vline';
< import { alpha } from '@/scripts/color';
< import { initChart } from '@/scripts/init-chart';
---
> import { watch, onMounted, onUnmounted, ref } from "vue";
> import {
>   Chart,
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler,
> } from "chart.js";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { useChartTooltip } from "@/scripts/use-chart-tooltip";
16c29,44
< initChart();
---
> Chart.register(
>   ArcElement,
>   LineElement,
>   BarElement,
>   PointElement,
>   BarController,
>   LineController,
>   CategoryScale,
>   LinearScale,
>   TimeScale,
>   Legend,
>   Title,
>   Tooltip,
>   SubTitle,
>   Filler
> );
19c47
< 	type: string;
---
>   type: string;
22c50,56
< const chartEl = shallowRef<HTMLCanvasElement>(null);
---
> const alpha = (hex, a) => {
>   const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)!;
>   const r = parseInt(result[1], 16);
>   const g = parseInt(result[2], 16);
>   const b = parseInt(result[3], 16);
>   return `rgba(${r}, ${g}, ${b}, ${a})`;
> };
23a58,68
> const chartEl = ref<HTMLCanvasElement>(null);
> 
> const gridColor = defaultStore.state.darkMode
>   ? "rgba(255, 255, 255, 0.1)"
>   : "rgba(0, 0, 0, 0.1)";
> 
> // フォントカラー
> Chart.defaults.color = getComputedStyle(
>   document.documentElement
> ).getPropertyValue("--fg");
> 
29,38c74,83
< 	if (chartInstance == null) return;
< 	for (const value of values) {
< 		chartInstance.data.labels.push('');
< 		chartInstance.data.datasets[0].data.push(value);
< 		if (chartInstance.data.datasets[0].data.length > 200) {
< 			chartInstance.data.labels.shift();
< 			chartInstance.data.datasets[0].data.shift();
< 		}
< 	}
< 	chartInstance.update();
---
>   if (chartInstance == null) return;
>   for (const value of values) {
>     chartInstance.data.labels.push("");
>     chartInstance.data.datasets[0].data.push(value);
>     if (chartInstance.data.datasets[0].data.length > 200) {
>       chartInstance.data.labels.shift();
>       chartInstance.data.datasets[0].data.shift();
>     }
>   }
>   chartInstance.update();
42,49c87,94
< 	if (chartInstance == null) return;
< 	chartInstance.data.labels.push('');
< 	chartInstance.data.datasets[0].data.push(value);
< 	if (chartInstance.data.datasets[0].data.length > 200) {
< 		chartInstance.data.labels.shift();
< 		chartInstance.data.datasets[0].data.shift();
< 	}
< 	chartInstance.update();
---
>   if (chartInstance == null) return;
>   chartInstance.data.labels.push("");
>   chartInstance.data.datasets[0].data.push(value);
>   if (chartInstance.data.datasets[0].data.length > 200) {
>     chartInstance.data.labels.shift();
>     chartInstance.data.datasets[0].data.shift();
>   }
>   chartInstance.update();
53,57c98,106
< 	props.type === 'process' ? 'Process' :
< 	props.type === 'active' ? 'Active' :
< 	props.type === 'delayed' ? 'Delayed' :
< 	props.type === 'waiting' ? 'Waiting' :
< 	'?' as never;
---
>   props.type === "process"
>     ? "Process"
>     : props.type === "active"
>     ? "Active"
>     : props.type === "delayed"
>     ? "Delayed"
>     : props.type === "waiting"
>     ? "Waiting"
>     : ("?" as never);
60,64c109,117
< 	props.type === 'process' ? '#00E396' :
< 	props.type === 'active' ? '#00BCD4' :
< 	props.type === 'delayed' ? '#E53935' :
< 	props.type === 'waiting' ? '#FFB300' :
< 	'?' as never;
---
>   props.type === "process"
>     ? "#00E396"
>     : props.type === "active"
>     ? "#00BCD4"
>     : props.type === "delayed"
>     ? "#E53935"
>     : props.type === "waiting"
>     ? "#FFB300"
>     : ("?" as never);
67,129c120,184
< 	const vLineColor = defaultStore.state.darkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)';
< 
< 	chartInstance = new Chart(chartEl.value, {
< 		type: 'line',
< 		data: {
< 			labels: [],
< 			datasets: [{
< 				label: label,
< 				pointRadius: 0,
< 				tension: 0.3,
< 				borderWidth: 2,
< 				borderJoinStyle: 'round',
< 				borderColor: color,
< 				backgroundColor: alpha(color, 0.2),
< 				fill: true,
< 				data: [],
< 			}],
< 		},
< 		options: {
< 			aspectRatio: 2.5,
< 			layout: {
< 				padding: {
< 					left: 0,
< 					right: 0,
< 					top: 0,
< 					bottom: 0,
< 				},
< 			},
< 			scales: {
< 				x: {
< 					grid: {
< 						display: true,
< 					},
< 					ticks: {
< 						display: false,
< 						maxTicksLimit: 10,
< 					},
< 				},
< 				y: {
< 					min: 0,
< 					grid: {
< 					},
< 				},
< 			},
< 			interaction: {
< 				intersect: false,
< 			},
< 			plugins: {
< 				legend: {
< 					display: false,
< 				},
< 				tooltip: {
< 					enabled: false,
< 					mode: 'index',
< 					animation: {
< 						duration: 0,
< 					},
< 					external: externalTooltipHandler,
< 				},
< 			},
< 		},
< 		plugins: [chartVLine(vLineColor)],
< 	});
---
>   chartInstance = new Chart(chartEl.value, {
>     type: "line",
>     data: {
>       labels: [],
>       datasets: [
>         {
>           label: label,
>           pointRadius: 0,
>           tension: 0.3,
>           borderWidth: 2,
>           borderJoinStyle: "round",
>           borderColor: color,
>           backgroundColor: alpha(color, 0.1),
>           data: [],
>         },
>       ],
>     },
>     options: {
>       aspectRatio: 2.5,
>       layout: {
>         padding: {
>           left: 0,
>           right: 0,
>           top: 0,
>           bottom: 0,
>         },
>       },
>       scales: {
>         x: {
>           grid: {
>             display: true,
>             color: gridColor,
>             borderColor: "rgb(0, 0, 0, 0)",
>           },
>           ticks: {
>             display: false,
>             maxTicksLimit: 10,
>           },
>         },
>         y: {
>           min: 0,
>           grid: {
>             color: gridColor,
>             borderColor: "rgb(0, 0, 0, 0)",
>           },
>         },
>       },
>       interaction: {
>         intersect: false,
>       },
>       plugins: {
>         legend: {
>           display: false,
>         },
>         tooltip: {
>           enabled: false,
>           mode: "index",
>           animation: {
>             duration: 0,
>           },
>           external: externalTooltipHandler,
>         },
>       },
>     },
>   });
133,134c188,189
< 	setData,
< 	pushData,
---
>   setData,
>   pushData,
138,140c193
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/queue.chart.vue RiricaV13/pages/admin/queue.chart.vue
2,42c2,52
< <div class="pumxzjhg _gaps">
< 	<div :class="$style.status">
< 		<div class="item _panel"><div class="label">Process</div>{{ number(activeSincePrevTick) }}</div>
< 		<div class="item _panel"><div class="label">Active</div>{{ number(active) }}</div>
< 		<div class="item _panel"><div class="label">Waiting</div>{{ number(waiting) }}</div>
< 		<div class="item _panel"><div class="label">Delayed</div>{{ number(delayed) }}</div>
< 	</div>
< 	<div class="charts">
< 		<div class="chart">
< 			<div class="title">Process</div>
< 			<XChart ref="chartProcess" type="process"/>
< 		</div>
< 		<div class="chart">
< 			<div class="title">Active</div>
< 			<XChart ref="chartActive" type="active"/>
< 		</div>
< 		<div class="chart">
< 			<div class="title">Delayed</div>
< 			<XChart ref="chartDelayed" type="delayed"/>
< 		</div>
< 		<div class="chart">
< 			<div class="title">Waiting</div>
< 			<XChart ref="chartWaiting" type="waiting"/>
< 		</div>
< 	</div>
< 	<MkFolder :default-open="true" :max-height="250">
< 		<template #icon><i class="ti ti-alert-triangle"></i></template>
< 		<template #label>Errored instances</template>
< 		<template #suffix>({{ number(jobs.reduce((a, b) => a + b[1], 0)) }} jobs)</template>
< 		
< 		<div :class="$style.jobs">
< 			<div v-if="jobs.length > 0">
< 				<div v-for="job in jobs" :key="job[0]">
< 					<MkA :to="`/instance-info/${job[0]}`" behavior="window">{{ job[0] }}</MkA>
< 					<span style="margin-left: 8px; opacity: 0.7;">({{ number(job[1]) }} jobs)</span>
< 				</div>
< 			</div>
< 			<span v-else style="opacity: 0.5;">{{ i18n.ts.noJobs }}</span>
< 		</div>
< 	</MkFolder>
< </div>
---
>   <div class="pumxzjhg">
>     <div class="_table status">
>       <div class="_row">
>         <div class="_cell">
>           <div class="_label">Process</div>
>           {{ number(activeSincePrevTick) }}
>         </div>
>         <div class="_cell">
>           <div class="_label">Active</div>
>           {{ number(active) }}
>         </div>
>         <div class="_cell">
>           <div class="_label">Waiting</div>
>           {{ number(waiting) }}
>         </div>
>         <div class="_cell">
>           <div class="_label">Delayed</div>
>           {{ number(delayed) }}
>         </div>
>       </div>
>     </div>
>     <div class="charts">
>       <div class="chart">
>         <div class="title">Process</div>
>         <XChart ref="chartProcess" type="process" />
>       </div>
>       <div class="chart">
>         <div class="title">Active</div>
>         <XChart ref="chartActive" type="active" />
>       </div>
>       <div class="chart">
>         <div class="title">Delayed</div>
>         <XChart ref="chartDelayed" type="delayed" />
>       </div>
>       <div class="chart">
>         <div class="title">Waiting</div>
>         <XChart ref="chartWaiting" type="waiting" />
>       </div>
>     </div>
>     <div class="jobs">
>       <div v-if="jobs.length > 0">
>         <div v-for="job in jobs" :key="job[0]">
>           <span>{{ job[0] }}</span>
>           <span style="margin-left: 8px; opacity: 0.7"
>             >({{ number(job[1]) }} jobs)</span
>           >
>         </div>
>       </div>
>       <span v-else style="opacity: 0.5">{{ i18n.ts.noJobs }}</span>
>     </div>
>   </div>
46,52c56,61
< import { markRaw, onMounted, onUnmounted, ref } from 'vue';
< import XChart from './queue.chart.chart.vue';
< import number from '@/filters/number';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
< import MkFolder from '@/components/MkFolder.vue';
---
> import { markRaw, onMounted, onUnmounted, ref } from "vue";
> import XChart from "./queue.chart.chart.vue";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
54c63
< const connection = markRaw(stream.useChannel('queueStats'));
---
> const connection = markRaw(stream.useChannel("queueStats"));
61,64c70,73
< let chartProcess = $shallowRef<InstanceType<typeof XChart>>();
< let chartActive = $shallowRef<InstanceType<typeof XChart>>();
< let chartDelayed = $shallowRef<InstanceType<typeof XChart>>();
< let chartWaiting = $shallowRef<InstanceType<typeof XChart>>();
---
> let chartProcess = $ref<InstanceType<typeof XChart>>();
> let chartActive = $ref<InstanceType<typeof XChart>>();
> let chartDelayed = $ref<InstanceType<typeof XChart>>();
> let chartWaiting = $ref<InstanceType<typeof XChart>>();
67c76
< 	domain: string;
---
>   domain: string;
71,74c80,83
< 	activeSincePrevTick.value = stats[props.domain].activeSincePrevTick;
< 	active.value = stats[props.domain].active;
< 	delayed.value = stats[props.domain].delayed;
< 	waiting.value = stats[props.domain].waiting;
---
>   activeSincePrevTick.value = stats[props.domain].activeSincePrevTick;
>   active.value = stats[props.domain].active;
>   delayed.value = stats[props.domain].delayed;
>   waiting.value = stats[props.domain].waiting;
76,79c85,88
< 	chartProcess.pushData(stats[props.domain].activeSincePrevTick);
< 	chartActive.pushData(stats[props.domain].active);
< 	chartDelayed.pushData(stats[props.domain].delayed);
< 	chartWaiting.pushData(stats[props.domain].waiting);
---
>   chartProcess.pushData(stats[props.domain].activeSincePrevTick);
>   chartActive.pushData(stats[props.domain].active);
>   chartDelayed.pushData(stats[props.domain].delayed);
>   chartWaiting.pushData(stats[props.domain].waiting);
83,86c92,95
< 	const dataProcess = [];
< 	const dataActive = [];
< 	const dataDelayed = [];
< 	const dataWaiting = [];
---
>   const dataProcess = [];
>   const dataActive = [];
>   const dataDelayed = [];
>   const dataWaiting = [];
88,93c97,102
< 	for (const stats of [...statsLog].reverse()) {
< 		dataProcess.push(stats[props.domain].activeSincePrevTick);
< 		dataActive.push(stats[props.domain].active);
< 		dataDelayed.push(stats[props.domain].delayed);
< 		dataWaiting.push(stats[props.domain].waiting);
< 	}
---
>   for (const stats of [...statsLog].reverse()) {
>     dataProcess.push(stats[props.domain].activeSincePrevTick);
>     dataActive.push(stats[props.domain].active);
>     dataDelayed.push(stats[props.domain].delayed);
>     dataWaiting.push(stats[props.domain].waiting);
>   }
95,98c104,107
< 	chartProcess.setData(dataProcess);
< 	chartActive.setData(dataActive);
< 	chartDelayed.setData(dataDelayed);
< 	chartWaiting.setData(dataWaiting);
---
>   chartProcess.setData(dataProcess);
>   chartActive.setData(dataActive);
>   chartDelayed.setData(dataDelayed);
>   chartWaiting.setData(dataWaiting);
102,104c111,120
< 	os.api(props.domain === 'inbox' ? 'admin/queue/inbox-delayed' : props.domain === 'deliver' ? 'admin/queue/deliver-delayed' : null, {}).then(result => {
< 		jobs.value = result;
< 	});
---
>   os.api(
>     props.domain === "inbox"
>       ? "admin/queue/inbox-delayed"
>       : props.domain === "deliver"
>       ? "admin/queue/deliver-delayed"
>       : null,
>     {}
>   ).then((result) => {
>     jobs.value = result;
>   });
106,111c122,127
< 	connection.on('stats', onStats);
< 	connection.on('statsLog', onStatsLog);
< 	connection.send('requestLog', {
< 		id: Math.random().toString().substr(2, 8),
< 		length: 200,
< 	});
---
>   connection.on("stats", onStats);
>   connection.on("statsLog", onStatsLog);
>   connection.send("requestLog", {
>     id: Math.random().toString().substr(2, 8),
>     length: 200,
>   });
115,117c131,133
< 	connection.off('stats', onStats);
< 	connection.off('statsLog', onStatsLog);
< 	connection.dispose();
---
>   connection.off("stats", onStats);
>   connection.off("statsLog", onStatsLog);
>   connection.dispose();
123,126c139,141
< 	> .charts {
< 		display: grid;
< 		grid-template-columns: 1fr 1fr;
< 		gap: 10px;
---
>   > .status {
>     padding: 16px;
>   }
128,132c143,146
< 		> .chart {
< 			min-width: 0;
< 			padding: 16px;
< 			background: var(--panel);
< 			border-radius: var(--radius);
---
>   > .charts {
>     display: grid;
>     grid-template-columns: 1fr 1fr;
>     gap: 16px;
134,140c148,152
< 			> .title {
< 				margin-bottom: 8px;
< 			}
< 		}
< 	}
< }
< </style>
---
>     > .chart {
>       min-width: 0;
>       padding: 16px;
>       background: var(--panel);
>       border-radius: var(--radius);
142,146c154,158
< <style lang="scss" module>
< .status {
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
< 	grid-gap: 10px;
---
>       > .title {
>         margin-bottom: 8px;
>       }
>     }
>   }
148,160c160,167
< 	&:global {
< 		> .item {
< 			padding: 12px 16px;
< 
< 			> .label {
< 				font-size: 80%;
< 				opacity: 0.6;
< 			}
< 		}
< 	}
< }
< 
< .jobs {
---
>   > .jobs {
>     margin-top: 16px;
>     padding: 16px;
>     max-height: 180px;
>     overflow: auto;
>     background: var(--panel);
>     border-radius: var(--radius);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/queue.vue RiricaV13/pages/admin/queue.vue
2,8c2,10
< <MkStickyContainer>
< 	<template #header><XHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<XQueue v-if="tab === 'deliver'" domain="deliver"/>
< 		<XQueue v-else-if="tab === 'inbox'" domain="inbox"/>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <XQueue v-if="tab === 'deliver'" domain="deliver" />
>       <XQueue v-else-if="tab === 'inbox'" domain="inbox" />
>     </MkSpacer>
>   </MkStickyContainer>
12,19c14,21
< import { markRaw, onMounted, onBeforeUnmount, nextTick } from 'vue';
< import XQueue from './queue.chart.vue';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import * as config from '@/config';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { markRaw, onMounted, onBeforeUnmount, nextTick } from "vue";
> import XQueue from "./queue.chart.vue";
> import XHeader from "./_header_.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import * as config from "@/config";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
21c23
< let tab = $ref('deliver');
---
> let tab = $ref("deliver");
24,29c26,31
< 	os.confirm({
< 		type: 'warning',
< 		title: i18n.ts.clearQueueConfirmTitle,
< 		text: i18n.ts.clearQueueConfirmText,
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
---
>   os.confirm({
>     type: "warning",
>     title: i18n.ts.clearQueueConfirmTitle,
>     text: i18n.ts.clearQueueConfirmText,
>   }).then(({ canceled }) => {
>     if (canceled) return;
31,32c33,34
< 		os.apiWithDialog('admin/queue/clear');
< 	});
---
>     os.apiWithDialog("admin/queue/clear");
>   });
35,42c37,46
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-external-link',
< 	text: i18n.ts.dashboard,
< 	handler: () => {
< 		window.open(config.url + '/queue', '_blank');
< 	},
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-up-right-from-square",
>     text: i18n.ts.dashboard,
>     handler: () => {
>       window.open(config.url + "/queue", "_blank");
>     },
>   },
> ]);
44,50c48,57
< const headerTabs = $computed(() => [{
< 	key: 'deliver',
< 	title: 'Deliver',
< }, {
< 	key: 'inbox',
< 	title: 'Inbox',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "deliver",
>     title: "Deliver",
>   },
>   {
>     key: "inbox",
>     title: "Inbox",
>   },
> ]);
53,54c60,61
< 	title: i18n.ts.jobQueue,
< 	icon: 'ti ti-clock-play',
---
>   title: i18n.ts.jobQueue,
>   icon: "fas fa-clipboard-list",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/relays.vue RiricaV13/pages/admin/relays.vue
2,18c2,31
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<div class="_gaps">
< 			<div v-for="relay in relays" :key="relay.inbox" class="relaycxt _panel" style="padding: 16px;">
< 				<div>{{ relay.inbox }}</div>
< 				<div class="status">
< 					<i v-if="relay.status === 'accepted'" class="ti ti-check icon accepted"></i>
< 					<i v-else-if="relay.status === 'rejected'" class="ti ti-ban icon rejected"></i>
< 					<i v-else class="ti ti-clock icon requesting"></i>
< 					<span>{{ $t(`_relayStatus.${relay.status}`) }}</span>
< 				</div>
< 				<MkButton class="button" inline danger @click="remove(relay.inbox)"><i class="ti ti-trash"></i> {{ i18n.ts.remove }}</MkButton>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <div
>         v-for="relay in relays"
>         :key="relay.inbox"
>         class="relaycxt _panel _block"
>         style="padding: 16px"
>       >
>         <div>{{ relay.inbox }}</div>
>         <div class="status">
>           <i
>             v-if="relay.status === 'accepted'"
>             class="fas fa-check icon accepted"
>           ></i>
>           <i
>             v-else-if="relay.status === 'rejected'"
>             class="fas fa-ban icon rejected"
>           ></i>
>           <i v-else class="fas fa-clock icon requesting"></i>
>           <span>{{ $t(`_relayStatus.${relay.status}`) }}</span>
>         </div>
>         <MkButton class="button" inline danger @click="remove(relay.inbox)"
>           ><i class="fas fa-trash-alt"></i> {{ i18n.ts.remove }}</MkButton
>         >
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
22,27c35,40
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
32,47c45,62
< 	const { canceled, result: inbox } = await os.inputText({
< 		title: i18n.ts.addRelay,
< 		type: 'url',
< 		placeholder: i18n.ts.inboxUrl,
< 	});
< 	if (canceled) return;
< 	os.api('admin/relays/add', {
< 		inbox,
< 	}).then((relay: any) => {
< 		refresh();
< 	}).catch((err: any) => {
< 		os.alert({
< 			type: 'error',
< 			text: err.message || err,
< 		});
< 	});
---
>   const { canceled, result: inbox } = await os.inputText({
>     title: i18n.ts.addRelay,
>     type: "url",
>     placeholder: i18n.ts.inboxUrl,
>   });
>   if (canceled) return;
>   os.api("admin/relays/add", {
>     inbox,
>   })
>     .then((relay: any) => {
>       refresh();
>     })
>     .catch((err: any) => {
>       os.alert({
>         type: "error",
>         text: err.message || err,
>       });
>     });
51,60c66,77
< 	os.api('admin/relays/remove', {
< 		inbox,
< 	}).then(() => {
< 		refresh();
< 	}).catch((err: any) => {
< 		os.alert({
< 			type: 'error',
< 			text: err.message || err,
< 		});
< 	});
---
>   os.api("admin/relays/remove", {
>     inbox,
>   })
>     .then(() => {
>       refresh();
>     })
>     .catch((err: any) => {
>       os.alert({
>         type: "error",
>         text: err.message || err,
>       });
>     });
64,66c81,83
< 	os.api('admin/relays/list').then((relayList: any) => {
< 		relays = relayList;
< 	});
---
>   os.api("admin/relays/list").then((relayList: any) => {
>     relays = relayList;
>   });
71,76c88,95
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.addRelay,
< 	handler: addRelay,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-plus",
>     text: i18n.ts.addRelay,
>     handler: addRelay,
>   },
> ]);
81,82c100,101
< 	title: i18n.ts.relays,
< 	icon: 'ti ti-planet',
---
>   title: i18n.ts.relays,
>   icon: "fas fa-globe",
88,89c107,108
< 	> .status {
< 		margin: 8px 0;
---
>   > .status {
>     margin: 8px 0;
91,93c110,112
< 		> .icon {
< 			width: 1em;
< 			margin-right: 0.75em;
---
>     > .icon {
>       width: 1em;
>       margin-right: 0.75em;
95,97c114,116
< 			&.accepted {
< 				color: var(--success);
< 			}
---
>       &.accepted {
>         color: var(--success);
>       }
99,103c118,122
< 			&.rejected {
< 				color: var(--error);
< 			}
< 		}
< 	}
---
>       &.rejected {
>         color: var(--error);
>       }
>     }
>   }
Only in misskeyV13/packages/frontend/src/pages/admin: roles.edit.vue
Only in misskeyV13/packages/frontend/src/pages/admin: roles.editor.vue
Only in misskeyV13/packages/frontend/src/pages/admin: roles.role.vue
Only in misskeyV13/packages/frontend/src/pages/admin: roles.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/security.vue RiricaV13/pages/admin/security.vue
2,13c2,17
< <MkStickyContainer>
< 	<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<div class="_gaps_m">
< 				<MkFolder>
< 					<template #icon><i class="ti ti-shield"></i></template>
< 					<template #label>{{ i18n.ts.botProtection }}</template>
< 					<template v-if="enableHcaptcha" #suffix>hCaptcha</template>
< 					<template v-else-if="enableRecaptcha" #suffix>reCAPTCHA</template>
< 					<template v-else-if="enableTurnstile" #suffix>Turnstile</template>
< 					<template v-else #suffix>{{ i18n.ts.none }} ({{ i18n.ts.notRecommended }})</template>
---
>   <MkStickyContainer>
>     <template #header
>       ><XHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <div class="_formRoot">
>           <FormFolder class="_formBlock">
>             <template #icon><i class="fas fa-shield-alt"></i></template>
>             <template #label>{{ i18n.ts.botProtection }}</template>
>             <template v-if="enableHcaptcha" #suffix>hCaptcha</template>
>             <template v-else-if="enableRecaptcha" #suffix>reCAPTCHA</template>
>             <template v-else-if="enableTurnstile" #suffix>Turnstile</template>
>             <template v-else #suffix
>               >{{ i18n.ts.none }} ({{ i18n.ts.notRecommended }})</template
>             >
15,16c19,20
< 					<XBotProtection/>
< 				</MkFolder>
---
>             <XBotProtection />
>           </FormFolder>
18,24c22,36
< 				<MkFolder>
< 					<template #icon><i class="ti ti-eye-off"></i></template>
< 					<template #label>{{ i18n.ts.sensitiveMediaDetection }}</template>
< 					<template v-if="sensitiveMediaDetection === 'all'" #suffix>{{ i18n.ts.all }}</template>
< 					<template v-else-if="sensitiveMediaDetection === 'local'" #suffix>{{ i18n.ts.localOnly }}</template>
< 					<template v-else-if="sensitiveMediaDetection === 'remote'" #suffix>{{ i18n.ts.remoteOnly }}</template>
< 					<template v-else #suffix>{{ i18n.ts.none }}</template>
---
>           <FormFolder class="_formBlock">
>             <template #icon><i class="fas fa-eye-slash"></i></template>
>             <template #label>{{ i18n.ts.sensitiveMediaDetection }}</template>
>             <template v-if="sensitiveMediaDetection === 'all'" #suffix>{{
>               i18n.ts.all
>             }}</template>
>             <template v-else-if="sensitiveMediaDetection === 'local'" #suffix>{{
>               i18n.ts.localOnly
>             }}</template>
>             <template
>               v-else-if="sensitiveMediaDetection === 'remote'"
>               #suffix
>               >{{ i18n.ts.remoteOnly }}</template
>             >
>             <template v-else #suffix>{{ i18n.ts.none }}</template>
26,27c38,41
< 					<div class="_gaps_m">
< 						<span>{{ i18n.ts._sensitiveMediaDetection.description }}</span>
---
>             <div class="_formRoot">
>               <span class="_formBlock">{{
>                 i18n.ts._sensitiveMediaDetection.description
>               }}</span>
29,34c43,48
< 						<MkRadios v-model="sensitiveMediaDetection">
< 							<option value="none">{{ i18n.ts.none }}</option>
< 							<option value="all">{{ i18n.ts.all }}</option>
< 							<option value="local">{{ i18n.ts.localOnly }}</option>
< 							<option value="remote">{{ i18n.ts.remoteOnly }}</option>
< 						</MkRadios>
---
>               <FormRadios v-model="sensitiveMediaDetection" class="_formBlock">
>                 <option value="none">{{ i18n.ts.none }}</option>
>                 <option value="all">{{ i18n.ts.all }}</option>
>                 <option value="local">{{ i18n.ts.localOnly }}</option>
>                 <option value="remote">{{ i18n.ts.remoteOnly }}</option>
>               </FormRadios>
36,39c50,64
< 						<MkRange v-model="sensitiveMediaDetectionSensitivity" :min="0" :max="4" :step="1" :text-converter="(v) => `${v + 1}`">
< 							<template #label>{{ i18n.ts._sensitiveMediaDetection.sensitivity }}</template>
< 							<template #caption>{{ i18n.ts._sensitiveMediaDetection.sensitivityDescription }}</template>
< 						</MkRange>
---
>               <FormRange
>                 v-model="sensitiveMediaDetectionSensitivity"
>                 :min="0"
>                 :max="4"
>                 :step="1"
>                 :text-converter="(v) => `${v + 1}`"
>                 class="_formBlock"
>               >
>                 <template #label>{{
>                   i18n.ts._sensitiveMediaDetection.sensitivity
>                 }}</template>
>                 <template #caption>{{
>                   i18n.ts._sensitiveMediaDetection.sensitivityDescription
>                 }}</template>
>               </FormRange>
41,44c66,77
< 						<MkSwitch v-model="enableSensitiveMediaDetectionForVideos">
< 							<template #label>{{ i18n.ts._sensitiveMediaDetection.analyzeVideos }}<span class="_beta">{{ i18n.ts.beta }}</span></template>
< 							<template #caption>{{ i18n.ts._sensitiveMediaDetection.analyzeVideosDescription }}</template>
< 						</MkSwitch>
---
>               <FormSwitch
>                 v-model="enableSensitiveMediaDetectionForVideos"
>                 class="_formBlock"
>               >
>                 <template #label
>                   >{{ i18n.ts._sensitiveMediaDetection.analyzeVideos
>                   }}<span class="_beta">{{ i18n.ts.beta }}</span></template
>                 >
>                 <template #caption>{{
>                   i18n.ts._sensitiveMediaDetection.analyzeVideosDescription
>                 }}</template>
>               </FormSwitch>
46,49c79,94
< 						<MkSwitch v-model="setSensitiveFlagAutomatically">
< 							<template #label>{{ i18n.ts._sensitiveMediaDetection.setSensitiveFlagAutomatically }} ({{ i18n.ts.notRecommended }})</template>
< 							<template #caption>{{ i18n.ts._sensitiveMediaDetection.setSensitiveFlagAutomaticallyDescription }}</template>
< 						</MkSwitch>
---
>               <FormSwitch
>                 v-model="setSensitiveFlagAutomatically"
>                 class="_formBlock"
>               >
>                 <template #label
>                   >{{
>                     i18n.ts._sensitiveMediaDetection
>                       .setSensitiveFlagAutomatically
>                   }}
>                   ({{ i18n.ts.notRecommended }})</template
>                 >
>                 <template #caption>{{
>                   i18n.ts._sensitiveMediaDetection
>                     .setSensitiveFlagAutomaticallyDescription
>                 }}</template>
>               </FormSwitch>
51,52c96,97
< 						<!-- 現状 false positive が多すぎて実用に耐えない
< 						<MkSwitch v-model="disallowUploadWhenPredictedAsPorn">
---
>               <!-- 現状 false positive が多すぎて実用に耐えない
> 						<FormSwitch v-model="disallowUploadWhenPredictedAsPorn" class="_formBlock">
54c99
< 						</MkSwitch>
---
> 						</FormSwitch>
57,59c102,106
< 						<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 					</div>
< 				</MkFolder>
---
>               <FormButton primary class="_formBlock" @click="save"
>                 ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>               >
>             </div>
>           </FormFolder>
61,64c108,113
< 				<MkFolder>
< 					<template #label>Active Email Validation</template>
< 					<template v-if="enableActiveEmailValidation" #suffix>Enabled</template>
< 					<template v-else #suffix>Disabled</template>
---
>           <FormFolder class="_formBlock">
>             <template #label>Active Email Validation</template>
>             <template v-if="enableActiveEmailValidation" #suffix
>               >Enabled</template
>             >
>             <template v-else #suffix>Disabled</template>
66,72c115,127
< 					<div class="_gaps_m">
< 						<span>{{ i18n.ts.activeEmailValidationDescription }}</span>
< 						<MkSwitch v-model="enableActiveEmailValidation" @update:model-value="save">
< 							<template #label>Enable</template>
< 						</MkSwitch>
< 					</div>
< 				</MkFolder>
---
>             <div class="_formRoot">
>               <span class="_formBlock">{{
>                 i18n.ts.activeEmailValidationDescription
>               }}</span>
>               <FormSwitch
>                 v-model="enableActiveEmailValidation"
>                 class="_formBlock"
>                 @update:modelValue="save"
>               >
>                 <template #label>Enable</template>
>               </FormSwitch>
>             </div>
>           </FormFolder>
74,77c129,132
< 				<MkFolder>
< 					<template #label>Log IP address</template>
< 					<template v-if="enableIpLogging" #suffix>Enabled</template>
< 					<template v-else #suffix>Disabled</template>
---
>           <FormFolder class="_formBlock">
>             <template #label>Log IP address</template>
>             <template v-if="enableIpLogging" #suffix>Enabled</template>
>             <template v-else #suffix>Disabled</template>
79,84c134,143
< 					<div class="_gaps_m">
< 						<MkSwitch v-model="enableIpLogging" @update:model-value="save">
< 							<template #label>Enable</template>
< 						</MkSwitch>
< 					</div>
< 				</MkFolder>
---
>             <div class="_formRoot">
>               <FormSwitch
>                 v-model="enableIpLogging"
>                 class="_formBlock"
>                 @update:modelValue="save"
>               >
>                 <template #label>Enable</template>
>               </FormSwitch>
>             </div>
>           </FormFolder>
86,87c145,146
< 				<MkFolder>
< 					<template #label>Summaly Proxy</template>
---
>           <FormFolder class="_formBlock">
>             <template #label>Summaly Proxy</template>
89,93c148,152
< 					<div class="_gaps_m">
< 						<MkInput v-model="summalyProxy">
< 							<template #prefix><i class="ti ti-link"></i></template>
< 							<template #label>Summaly Proxy URL</template>
< 						</MkInput>
---
>             <div class="_formRoot">
>               <FormInput v-model="summalyProxy" class="_formBlock">
>                 <template #prefix><i class="fas fa-link"></i></template>
>                 <template #label>Summaly Proxy URL</template>
>               </FormInput>
95,101c154,162
< 						<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 					</div>
< 				</MkFolder>
< 			</div>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>               <FormButton primary class="_formBlock" @click="save"
>                 ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>               >
>             </div>
>           </FormFolder>
>         </div>
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
105,119c166,180
< import { } from 'vue';
< import XBotProtection from './bot-protection.vue';
< import XHeader from './_header_.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import MkRange from '@/components/MkRange.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XBotProtection from "./bot-protection.vue";
> import XHeader from "./_header_.vue";
> import FormFolder from "@/components/form/folder.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormRange from "@/components/form/range.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
121c182
< let summalyProxy: string = $ref('');
---
> let summalyProxy: string = $ref("");
125c186
< let sensitiveMediaDetection: string = $ref('none');
---
> let sensitiveMediaDetection: string = $ref("none");
133,148c194,216
< 	const meta = await os.api('admin/meta');
< 	summalyProxy = meta.summalyProxy;
< 	enableHcaptcha = meta.enableHcaptcha;
< 	enableRecaptcha = meta.enableRecaptcha;
< 	enableTurnstile = meta.enableTurnstile;
< 	sensitiveMediaDetection = meta.sensitiveMediaDetection;
< 	sensitiveMediaDetectionSensitivity =
< 		meta.sensitiveMediaDetectionSensitivity === 'veryLow' ? 0 :
< 		meta.sensitiveMediaDetectionSensitivity === 'low' ? 1 :
< 		meta.sensitiveMediaDetectionSensitivity === 'medium' ? 2 :
< 		meta.sensitiveMediaDetectionSensitivity === 'high' ? 3 :
< 		meta.sensitiveMediaDetectionSensitivity === 'veryHigh' ? 4 : 0;
< 	setSensitiveFlagAutomatically = meta.setSensitiveFlagAutomatically;
< 	enableSensitiveMediaDetectionForVideos = meta.enableSensitiveMediaDetectionForVideos;
< 	enableIpLogging = meta.enableIpLogging;
< 	enableActiveEmailValidation = meta.enableActiveEmailValidation;
---
>   const meta = await os.api("admin/meta");
>   summalyProxy = meta.summalyProxy;
>   enableHcaptcha = meta.enableHcaptcha;
>   enableRecaptcha = meta.enableRecaptcha;
>   enableTurnstile = meta.enableTurnstile;
>   sensitiveMediaDetection = meta.sensitiveMediaDetection;
>   sensitiveMediaDetectionSensitivity =
>     meta.sensitiveMediaDetectionSensitivity === "veryLow"
>       ? 0
>       : meta.sensitiveMediaDetectionSensitivity === "low"
>       ? 1
>       : meta.sensitiveMediaDetectionSensitivity === "medium"
>       ? 2
>       : meta.sensitiveMediaDetectionSensitivity === "high"
>       ? 3
>       : meta.sensitiveMediaDetectionSensitivity === "veryHigh"
>       ? 4
>       : 0;
>   setSensitiveFlagAutomatically = meta.setSensitiveFlagAutomatically;
>   enableSensitiveMediaDetectionForVideos =
>     meta.enableSensitiveMediaDetectionForVideos;
>   enableIpLogging = meta.enableIpLogging;
>   enableActiveEmailValidation = meta.enableActiveEmailValidation;
152,168c220,241
< 	os.apiWithDialog('admin/update-meta', {
< 		summalyProxy,
< 		sensitiveMediaDetection,
< 		sensitiveMediaDetectionSensitivity:
< 			sensitiveMediaDetectionSensitivity === 0 ? 'veryLow' :
< 			sensitiveMediaDetectionSensitivity === 1 ? 'low' :
< 			sensitiveMediaDetectionSensitivity === 2 ? 'medium' :
< 			sensitiveMediaDetectionSensitivity === 3 ? 'high' :
< 			sensitiveMediaDetectionSensitivity === 4 ? 'veryHigh' :
< 			0,
< 		setSensitiveFlagAutomatically,
< 		enableSensitiveMediaDetectionForVideos,
< 		enableIpLogging,
< 		enableActiveEmailValidation,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     summalyProxy,
>     sensitiveMediaDetection,
>     sensitiveMediaDetectionSensitivity:
>       sensitiveMediaDetectionSensitivity === 0
>         ? "veryLow"
>         : sensitiveMediaDetectionSensitivity === 1
>         ? "low"
>         : sensitiveMediaDetectionSensitivity === 2
>         ? "medium"
>         : sensitiveMediaDetectionSensitivity === 3
>         ? "high"
>         : sensitiveMediaDetectionSensitivity === 4
>         ? "veryHigh"
>         : 0,
>     setSensitiveFlagAutomatically,
>     enableSensitiveMediaDetectionForVideos,
>     enableIpLogging,
>     enableActiveEmailValidation,
>   }).then(() => {
>     fetchInstance();
>   });
176,177c249,250
< 	title: i18n.ts.security,
< 	icon: 'ti ti-lock',
---
>   title: i18n.ts.security,
>   icon: "fas fa-lock",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/settings.vue RiricaV13/pages/admin/settings.vue
2,10c2,12
< <div>
< 	<MkStickyContainer>
< 		<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 		<MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
< 			<FormSuspense :p="init">
< 				<div class="_gaps_m">
< 					<MkInput v-model="name">
< 						<template #label>{{ i18n.ts.instanceName }}</template>
< 					</MkInput>
---
>   <div>
>     <MkStickyContainer>
>       <template #header
>         ><XHeader :actions="headerActions" :tabs="headerTabs"
>       /></template>
>       <MkSpacer :content-max="700" :margin-min="16" :margin-max="32">
>         <FormSuspense :p="init">
>           <div class="_formRoot">
>             <FormInput v-model="name" class="_formBlock">
>               <template #label>{{ i18n.ts.instanceName }}</template>
>             </FormInput>
12,14c14,16
< 					<MkTextarea v-model="description">
< 						<template #label>{{ i18n.ts.instanceDescription }}</template>
< 					</MkTextarea>
---
>             <FormTextarea v-model="description" class="_formBlock">
>               <template #label>{{ i18n.ts.instanceDescription }}</template>
>             </FormTextarea>
16,19c18,21
< 					<MkInput v-model="tosUrl">
< 						<template #prefix><i class="ti ti-link"></i></template>
< 						<template #label>{{ i18n.ts.tosUrl }}</template>
< 					</MkInput>
---
>             <FormInput v-model="tosUrl" class="_formBlock">
>               <template #prefix><i class="fas fa-link"></i></template>
>               <template #label>{{ i18n.ts.tosUrl }}</template>
>             </FormInput>
21,24c23,26
< 					<FormSplit :min-width="300">
< 						<MkInput v-model="maintainerName">
< 							<template #label>{{ i18n.ts.maintainerName }}</template>
< 						</MkInput>
---
>             <FormSplit :min-width="300">
>               <FormInput v-model="maintainerName" class="_formBlock">
>                 <template #label>{{ i18n.ts.maintainerName }}</template>
>               </FormInput>
26,30c28,36
< 						<MkInput v-model="maintainerEmail" type="email">
< 							<template #prefix><i class="ti ti-mail"></i></template>
< 							<template #label>{{ i18n.ts.maintainerEmail }}</template>
< 						</MkInput>
< 					</FormSplit>
---
>               <FormInput
>                 v-model="maintainerEmail"
>                 type="email"
>                 class="_formBlock"
>               >
>                 <template #prefix><i class="fas fa-envelope"></i></template>
>                 <template #label>{{ i18n.ts.maintainerEmail }}</template>
>               </FormInput>
>             </FormSplit>
32,35c38,41
< 					<MkTextarea v-model="pinnedUsers">
< 						<template #label>{{ i18n.ts.pinnedUsers }}</template>
< 						<template #caption>{{ i18n.ts.pinnedUsersDescription }}</template>
< 					</MkTextarea>
---
>             <FormTextarea v-model="pinnedUsers" class="_formBlock">
>               <template #label>{{ i18n.ts.pinnedUsers }}</template>
>               <template #caption>{{ i18n.ts.pinnedUsersDescription }}</template>
>             </FormTextarea>
37,41c43,46
< 					<FormSection>
< 						<div class="_gaps_s">
< 							<MkSwitch v-model="enableRegistration">
< 								<template #label>{{ i18n.ts.enableRegistration }}</template>
< 							</MkSwitch>
---
>             <FormSection>
>               <FormSwitch v-model="enableRegistration" class="_formBlock">
>                 <template #label>{{ i18n.ts.enableRegistration }}</template>
>               </FormSwitch>
43,47c48,51
< 							<MkSwitch v-model="emailRequiredForSignup">
< 								<template #label>{{ i18n.ts.emailRequiredForSignup }}</template>
< 							</MkSwitch>
< 						</div>
< 					</FormSection>
---
>               <FormSwitch v-model="emailRequiredForSignup" class="_formBlock">
>                 <template #label>{{ i18n.ts.emailRequiredForSignup }}</template>
>               </FormSwitch>
>             </FormSection>
49,50c53,63
< 					<FormSection>
< 						<template #label>{{ i18n.ts.theme }}</template>
---
>             <FormSection>
>               <FormSwitch v-model="enableLocalTimeline" class="_formBlock">{{
>                 i18n.ts.enableLocalTimeline
>               }}</FormSwitch>
>               <FormSwitch v-model="enableGlobalTimeline" class="_formBlock">{{
>                 i18n.ts.enableGlobalTimeline
>               }}</FormSwitch>
>               <FormInfo class="_formBlock">{{
>                 i18n.ts.disablingTimelinesInfo
>               }}</FormInfo>
>             </FormSection>
52,56c65,66
< 						<div class="_gaps_m">
< 							<MkInput v-model="iconUrl">
< 								<template #prefix><i class="ti ti-link"></i></template>
< 								<template #label>{{ i18n.ts.iconUrl }}</template>
< 							</MkInput>
---
>             <FormSection>
>               <template #label>{{ i18n.ts.theme }}</template>
58,61c68,71
< 							<MkInput v-model="bannerUrl">
< 								<template #prefix><i class="ti ti-link"></i></template>
< 								<template #label>{{ i18n.ts.bannerUrl }}</template>
< 							</MkInput>
---
>               <FormInput v-model="iconUrl" class="_formBlock">
>                 <template #prefix><i class="fas fa-link"></i></template>
>                 <template #label>{{ i18n.ts.iconUrl }}</template>
>               </FormInput>
63,66c73,76
< 							<MkInput v-model="backgroundImageUrl">
< 								<template #prefix><i class="ti ti-link"></i></template>
< 								<template #label>{{ i18n.ts.backgroundImageUrl }}</template>
< 							</MkInput>
---
>               <FormInput v-model="bannerUrl" class="_formBlock">
>                 <template #prefix><i class="fas fa-link"></i></template>
>                 <template #label>{{ i18n.ts.bannerUrl }}</template>
>               </FormInput>
68,72c78,81
< 							<MkInput v-model="themeColor">
< 								<template #prefix><i class="ti ti-palette"></i></template>
< 								<template #label>{{ i18n.ts.themeColor }}</template>
< 								<template #caption>#RRGGBB</template>
< 							</MkInput>
---
>               <FormInput v-model="backgroundImageUrl" class="_formBlock">
>                 <template #prefix><i class="fas fa-link"></i></template>
>                 <template #label>{{ i18n.ts.backgroundImageUrl }}</template>
>               </FormInput>
74,77c83,87
< 							<MkTextarea v-model="defaultLightTheme">
< 								<template #label>{{ i18n.ts.instanceDefaultLightTheme }}</template>
< 								<template #caption>{{ i18n.ts.instanceDefaultThemeDescription }}</template>
< 							</MkTextarea>
---
>               <FormInput v-model="themeColor" class="_formBlock">
>                 <template #prefix><i class="fas fa-palette"></i></template>
>                 <template #label>{{ i18n.ts.themeColor }}</template>
>                 <template #caption>#RRGGBB</template>
>               </FormInput>
79,84c89,96
< 							<MkTextarea v-model="defaultDarkTheme">
< 								<template #label>{{ i18n.ts.instanceDefaultDarkTheme }}</template>
< 								<template #caption>{{ i18n.ts.instanceDefaultThemeDescription }}</template>
< 							</MkTextarea>
< 						</div>
< 					</FormSection>
---
>               <FormTextarea v-model="defaultLightTheme" class="_formBlock">
>                 <template #label>{{
>                   i18n.ts.instanceDefaultLightTheme
>                 }}</template>
>                 <template #caption>{{
>                   i18n.ts.instanceDefaultThemeDescription
>                 }}</template>
>               </FormTextarea>
86,87c98,106
< 					<FormSection>
< 						<template #label>{{ i18n.ts.files }}</template>
---
>               <FormTextarea v-model="defaultDarkTheme" class="_formBlock">
>                 <template #label>{{
>                   i18n.ts.instanceDefaultDarkTheme
>                 }}</template>
>                 <template #caption>{{
>                   i18n.ts.instanceDefaultThemeDescription
>                 }}</template>
>               </FormTextarea>
>             </FormSection>
89,95c108,109
< 						<div class="_gaps_m">
< 							<MkSwitch v-model="cacheRemoteFiles">
< 								<template #label>{{ i18n.ts.cacheRemoteFiles }}</template>
< 								<template #caption>{{ i18n.ts.cacheRemoteFilesDescription }}</template>
< 							</MkSwitch>
< 						</div>
< 					</FormSection>
---
>             <FormSection>
>               <template #label>{{ i18n.ts.files }}</template>
97,98c111,116
< 					<FormSection>
< 						<template #label>ServiceWorker</template>
---
>               <FormSwitch v-model="cacheRemoteFiles" class="_formBlock">
>                 <template #label>{{ i18n.ts.cacheRemoteFiles }}</template>
>                 <template #caption>{{
>                   i18n.ts.cacheRemoteFilesDescription
>                 }}</template>
>               </FormSwitch>
100,104c118,129
< 						<div class="_gaps_m">
< 							<MkSwitch v-model="enableServiceWorker">
< 								<template #label>{{ i18n.ts.enableServiceworker }}</template>
< 								<template #caption>{{ i18n.ts.serviceworkerInfo }}</template>
< 							</MkSwitch>
---
>               <FormSplit :min-width="280">
>                 <FormInput
>                   v-model="localDriveCapacityMb"
>                   type="number"
>                   class="_formBlock"
>                 >
>                   <template #label>{{
>                     i18n.ts.driveCapacityPerLocalAccount
>                   }}</template>
>                   <template #suffix>MB</template>
>                   <template #caption>{{ i18n.ts.inMb }}</template>
>                 </FormInput>
106,110c131,144
< 							<template v-if="enableServiceWorker">
< 								<MkInput v-model="swPublicKey">
< 									<template #prefix><i class="ti ti-key"></i></template>
< 									<template #label>Public key</template>
< 								</MkInput>
---
>                 <FormInput
>                   v-model="remoteDriveCapacityMb"
>                   type="number"
>                   :disabled="!cacheRemoteFiles"
>                   class="_formBlock"
>                 >
>                   <template #label>{{
>                     i18n.ts.driveCapacityPerRemoteAccount
>                   }}</template>
>                   <template #suffix>MB</template>
>                   <template #caption>{{ i18n.ts.inMb }}</template>
>                 </FormInput>
>               </FormSplit>
>             </FormSection>
112,118c146,147
< 								<MkInput v-model="swPrivateKey">
< 									<template #prefix><i class="ti ti-key"></i></template>
< 									<template #label>Private key</template>
< 								</MkInput>
< 							</template>
< 						</div>
< 					</FormSection>
---
>             <FormSection>
>               <template #label>ServiceWorker</template>
120,121c149,152
< 					<FormSection>
< 						<template #label>DeepL Translation</template>
---
>               <FormSwitch v-model="enableServiceWorker" class="_formBlock">
>                 <template #label>{{ i18n.ts.enableServiceworker }}</template>
>                 <template #caption>{{ i18n.ts.serviceworkerInfo }}</template>
>               </FormSwitch>
123,137c154,182
< 						<div class="_gaps_m">
< 							<MkInput v-model="deeplAuthKey">
< 								<template #prefix><i class="ti ti-key"></i></template>
< 								<template #label>DeepL Auth Key</template>
< 							</MkInput>
< 							<MkSwitch v-model="deeplIsPro">
< 								<template #label>Pro account</template>
< 							</MkSwitch>
< 						</div>
< 					</FormSection>
< 				</div>
< 			</FormSuspense>
< 		</MkSpacer>
< 	</MkStickyContainer>
< </div>
---
>               <template v-if="enableServiceWorker">
>                 <FormInput v-model="swPublicKey" class="_formBlock">
>                   <template #prefix><i class="fas fa-key"></i></template>
>                   <template #label>Public key</template>
>                 </FormInput>
> 
>                 <FormInput v-model="swPrivateKey" class="_formBlock">
>                   <template #prefix><i class="fas fa-key"></i></template>
>                   <template #label>Private key</template>
>                 </FormInput>
>               </template>
>             </FormSection>
> 
>             <FormSection>
>               <template #label>DeepL Translation</template>
> 
>               <FormInput v-model="deeplAuthKey" class="_formBlock">
>                 <template #prefix><i class="fas fa-key"></i></template>
>                 <template #label>DeepL Auth Key</template>
>               </FormInput>
>               <FormSwitch v-model="deeplIsPro" class="_formBlock">
>                 <template #label>Pro account</template>
>               </FormSwitch>
>             </FormSection>
>           </div>
>         </FormSuspense>
>       </MkSpacer>
>     </MkStickyContainer>
>   </div>
141,153c186,198
< import { } from 'vue';
< import XHeader from './_header_.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormSection from '@/components/form/section.vue';
< import FormSplit from '@/components/form/split.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import * as os from '@/os';
< import { fetchInstance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import XHeader from "./_header_.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormInput from "@/components/form/input.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import * as os from "@/os";
> import { fetchInstance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
166c211,213
< let pinnedUsers: string = $ref('');
---
> let enableLocalTimeline: boolean = $ref(false);
> let enableGlobalTimeline: boolean = $ref(false);
> let pinnedUsers: string = $ref("");
167a215,216
> let localDriveCapacityMb: any = $ref(0);
> let remoteDriveCapacityMb: any = $ref(0);
173c222
< let deeplAuthKey: string = $ref('');
---
> let deeplAuthKey: string = $ref("");
177,197c226,250
< 	const meta = await os.api('admin/meta');
< 	name = meta.name;
< 	description = meta.description;
< 	tosUrl = meta.tosUrl;
< 	iconUrl = meta.iconUrl;
< 	bannerUrl = meta.bannerUrl;
< 	backgroundImageUrl = meta.backgroundImageUrl;
< 	themeColor = meta.themeColor;
< 	defaultLightTheme = meta.defaultLightTheme;
< 	defaultDarkTheme = meta.defaultDarkTheme;
< 	maintainerName = meta.maintainerName;
< 	maintainerEmail = meta.maintainerEmail;
< 	pinnedUsers = meta.pinnedUsers.join('\n');
< 	cacheRemoteFiles = meta.cacheRemoteFiles;
< 	enableRegistration = !meta.disableRegistration;
< 	emailRequiredForSignup = meta.emailRequiredForSignup;
< 	enableServiceWorker = meta.enableServiceWorker;
< 	swPublicKey = meta.swPublickey;
< 	swPrivateKey = meta.swPrivateKey;
< 	deeplAuthKey = meta.deeplAuthKey;
< 	deeplIsPro = meta.deeplIsPro;
---
>   const meta = await os.api("admin/meta");
>   name = meta.name;
>   description = meta.description;
>   tosUrl = meta.tosUrl;
>   iconUrl = meta.iconUrl;
>   bannerUrl = meta.bannerUrl;
>   backgroundImageUrl = meta.backgroundImageUrl;
>   themeColor = meta.themeColor;
>   defaultLightTheme = meta.defaultLightTheme;
>   defaultDarkTheme = meta.defaultDarkTheme;
>   maintainerName = meta.maintainerName;
>   maintainerEmail = meta.maintainerEmail;
>   enableLocalTimeline = !meta.disableLocalTimeline;
>   enableGlobalTimeline = !meta.disableGlobalTimeline;
>   pinnedUsers = meta.pinnedUsers.join("\n");
>   cacheRemoteFiles = meta.cacheRemoteFiles;
>   localDriveCapacityMb = meta.driveCapacityPerLocalUserMb;
>   remoteDriveCapacityMb = meta.driveCapacityPerRemoteUserMb;
>   enableRegistration = !meta.disableRegistration;
>   emailRequiredForSignup = meta.emailRequiredForSignup;
>   enableServiceWorker = meta.enableServiceWorker;
>   swPublicKey = meta.swPublickey;
>   swPrivateKey = meta.swPrivateKey;
>   deeplAuthKey = meta.deeplAuthKey;
>   deeplIsPro = meta.deeplIsPro;
201,224c254,281
< 	os.apiWithDialog('admin/update-meta', {
< 		name,
< 		description,
< 		tosUrl,
< 		iconUrl,
< 		bannerUrl,
< 		backgroundImageUrl,
< 		themeColor: themeColor === '' ? null : themeColor,
< 		defaultLightTheme: defaultLightTheme === '' ? null : defaultLightTheme,
< 		defaultDarkTheme: defaultDarkTheme === '' ? null : defaultDarkTheme,
< 		maintainerName,
< 		maintainerEmail,
< 		pinnedUsers: pinnedUsers.split('\n'),
< 		cacheRemoteFiles,
< 		disableRegistration: !enableRegistration,
< 		emailRequiredForSignup,
< 		enableServiceWorker,
< 		swPublicKey,
< 		swPrivateKey,
< 		deeplAuthKey,
< 		deeplIsPro,
< 	}).then(() => {
< 		fetchInstance();
< 	});
---
>   os.apiWithDialog("admin/update-meta", {
>     name,
>     description,
>     tosUrl,
>     iconUrl,
>     bannerUrl,
>     backgroundImageUrl,
>     themeColor: themeColor === "" ? null : themeColor,
>     defaultLightTheme: defaultLightTheme === "" ? null : defaultLightTheme,
>     defaultDarkTheme: defaultDarkTheme === "" ? null : defaultDarkTheme,
>     maintainerName,
>     maintainerEmail,
>     disableLocalTimeline: !enableLocalTimeline,
>     disableGlobalTimeline: !enableGlobalTimeline,
>     pinnedUsers: pinnedUsers.split("\n"),
>     cacheRemoteFiles,
>     localDriveCapacityMb: parseInt(localDriveCapacityMb, 10),
>     remoteDriveCapacityMb: parseInt(remoteDriveCapacityMb, 10),
>     disableRegistration: !enableRegistration,
>     emailRequiredForSignup,
>     enableServiceWorker,
>     swPublicKey,
>     swPrivateKey,
>     deeplAuthKey,
>     deeplIsPro,
>   }).then(() => {
>     fetchInstance();
>   });
227,232c284,291
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-check',
< 	text: i18n.ts.save,
< 	handler: save,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-check",
>     text: i18n.ts.save,
>     handler: save,
>   },
> ]);
237,238c296,297
< 	title: i18n.ts.general,
< 	icon: 'ti ti-settings',
---
>   title: i18n.ts.general,
>   icon: "fas fa-cog",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin/users.vue RiricaV13/pages/admin/users.vue
2,40c2,64
< <div>
< 	<MkStickyContainer>
< 		<template #header><XHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 		<MkSpacer :content-max="900">
< 			<div class="lknzcolw">
< 				<div class="users">
< 					<div class="inputs">
< 						<MkSelect v-model="sort" style="flex: 1;">
< 							<template #label>{{ i18n.ts.sort }}</template>
< 							<option value="-createdAt">{{ i18n.ts.registeredDate }} ({{ i18n.ts.ascendingOrder }})</option>
< 							<option value="+createdAt">{{ i18n.ts.registeredDate }} ({{ i18n.ts.descendingOrder }})</option>
< 							<option value="-updatedAt">{{ i18n.ts.lastUsed }} ({{ i18n.ts.ascendingOrder }})</option>
< 							<option value="+updatedAt">{{ i18n.ts.lastUsed }} ({{ i18n.ts.descendingOrder }})</option>
< 						</MkSelect>
< 						<MkSelect v-model="state" style="flex: 1;">
< 							<template #label>{{ i18n.ts.state }}</template>
< 							<option value="all">{{ i18n.ts.all }}</option>
< 							<option value="available">{{ i18n.ts.normal }}</option>
< 							<option value="admin">{{ i18n.ts.administrator }}</option>
< 							<option value="moderator">{{ i18n.ts.moderator }}</option>
< 							<option value="suspended">{{ i18n.ts.suspend }}</option>
< 						</MkSelect>
< 						<MkSelect v-model="origin" style="flex: 1;">
< 							<template #label>{{ i18n.ts.instance }}</template>
< 							<option value="combined">{{ i18n.ts.all }}</option>
< 							<option value="local">{{ i18n.ts.local }}</option>
< 							<option value="remote">{{ i18n.ts.remote }}</option>
< 						</MkSelect>
< 					</div>
< 					<div class="inputs">
< 						<MkInput v-model="searchUsername" style="flex: 1;" type="text" :spellcheck="false" @update:model-value="$refs.users.reload()">
< 							<template #prefix>@</template>
< 							<template #label>{{ i18n.ts.username }}</template>
< 						</MkInput>
< 						<MkInput v-model="searchHost" style="flex: 1;" type="text" :spellcheck="false" :disabled="pagination.params.origin === 'local'" @update:model-value="$refs.users.reload()">
< 							<template #prefix>@</template>
< 							<template #label>{{ i18n.ts.host }}</template>
< 						</MkInput>
< 					</div>
---
>   <div>
>     <MkStickyContainer>
>       <template #header
>         ><XHeader :actions="headerActions" :tabs="headerTabs"
>       /></template>
>       <MkSpacer :content-max="900">
>         <div class="lknzcolw">
>           <div class="users">
>             <div class="inputs">
>               <MkSelect v-model="sort" style="flex: 1">
>                 <template #label>{{ i18n.ts.sort }}</template>
>                 <option value="-createdAt">
>                   {{ i18n.ts.registeredDate }} ({{ i18n.ts.ascendingOrder }})
>                 </option>
>                 <option value="+createdAt">
>                   {{ i18n.ts.registeredDate }} ({{ i18n.ts.descendingOrder }})
>                 </option>
>                 <option value="-updatedAt">
>                   {{ i18n.ts.lastUsed }} ({{ i18n.ts.ascendingOrder }})
>                 </option>
>                 <option value="+updatedAt">
>                   {{ i18n.ts.lastUsed }} ({{ i18n.ts.descendingOrder }})
>                 </option>
>               </MkSelect>
>               <MkSelect v-model="state" style="flex: 1">
>                 <template #label>{{ i18n.ts.state }}</template>
>                 <option value="all">{{ i18n.ts.all }}</option>
>                 <option value="available">{{ i18n.ts.normal }}</option>
>                 <option value="admin">{{ i18n.ts.administrator }}</option>
>                 <option value="moderator">{{ i18n.ts.moderator }}</option>
>                 <option value="silenced">{{ i18n.ts.silence }}</option>
>                 <option value="suspended">{{ i18n.ts.suspend }}</option>
>               </MkSelect>
>               <MkSelect v-model="origin" style="flex: 1">
>                 <template #label>{{ i18n.ts.instance }}</template>
>                 <option value="combined">{{ i18n.ts.all }}</option>
>                 <option value="local">{{ i18n.ts.local }}</option>
>                 <option value="remote">{{ i18n.ts.remote }}</option>
>               </MkSelect>
>             </div>
>             <div class="inputs">
>               <MkInput
>                 v-model="searchUsername"
>                 style="flex: 1"
>                 type="text"
>                 :spellcheck="false"
>                 @update:modelValue="$refs.users.reload()"
>               >
>                 <template #prefix>@</template>
>                 <template #label>{{ i18n.ts.username }}</template>
>               </MkInput>
>               <MkInput
>                 v-model="searchHost"
>                 style="flex: 1"
>                 type="text"
>                 :spellcheck="false"
>                 :disabled="pagination.params.origin === 'local'"
>                 @update:modelValue="$refs.users.reload()"
>               >
>                 <template #prefix>@</template>
>                 <template #label>{{ i18n.ts.host }}</template>
>               </MkInput>
>             </div>
42,51c66,88
< 					<MkPagination v-slot="{items}" ref="paginationComponent" :pagination="pagination" class="users">
< 						<MkA v-for="user in items" :key="user.id" v-tooltip.mfm="`Last posted: ${dateString(user.updatedAt)}`" class="user" :to="`/user-info/${user.id}`">
< 							<MkUserCardMini :user="user"/>
< 						</MkA>
< 					</MkPagination>
< 				</div>
< 			</div>
< 		</MkSpacer>
< 	</MkStickyContainer>
< </div>
---
>             <MkPagination
>               v-slot="{ items }"
>               ref="paginationComponent"
>               :pagination="pagination"
>               class="users"
>             >
>               <MkA
>                 v-for="user in items"
>                 :key="user.id"
>                 v-tooltip.mfm="
>                   `Last posted: ${new Date(user.updatedAt).toLocaleString()}`
>                 "
>                 class="user"
>                 :to="`/user-info/${user.id}`"
>               >
>                 <MkUserCardMini :user="user" />
>               </MkA>
>             </MkPagination>
>           </div>
>         </div>
>       </MkSpacer>
>     </MkStickyContainer>
>   </div>
55,65c92,101
< import { computed } from 'vue';
< import XHeader from './_header_.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import * as os from '@/os';
< import { lookupUser } from '@/scripts/lookup-user';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import MkUserCardMini from '@/components/MkUserCardMini.vue';
< import { dateString } from '@/filters/date';
---
> import { computed } from "vue";
> import XHeader from "./_header_.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import * as os from "@/os";
> import { lookupUser } from "@/scripts/lookup-user";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import MkUserCardMini from "@/components/MkUserCardMini.vue";
67c103
< let paginationComponent = $shallowRef<InstanceType<typeof MkPagination>>();
---
> let paginationComponent = $ref<InstanceType<typeof MkPagination>>();
69,73c105,109
< let sort = $ref('+createdAt');
< let state = $ref('all');
< let origin = $ref('local');
< let searchUsername = $ref('');
< let searchHost = $ref('');
---
> let sort = $ref("+createdAt");
> let state = $ref("all");
> let origin = $ref("local");
> let searchUsername = $ref("");
> let searchHost = $ref("");
75,84c111,120
< 	endpoint: 'admin/show-users' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		sort: sort,
< 		state: state,
< 		origin: origin,
< 		username: searchUsername,
< 		hostname: searchHost,
< 	})),
< 	offsetMode: true,
---
>   endpoint: "admin/show-users" as const,
>   limit: 10,
>   params: computed(() => ({
>     sort: sort,
>     state: state,
>     origin: origin,
>     username: searchUsername,
>     hostname: searchHost,
>   })),
>   offsetMode: true,
88,90c124,126
< 	os.selectUser().then(user => {
< 		show(user);
< 	});
---
>   os.selectUser().then((user) => {
>     show(user);
>   });
94,97c130,133
< 	const { canceled: canceled1, result: username } = await os.inputText({
< 		title: i18n.ts.username,
< 	});
< 	if (canceled1) return;
---
>   const { canceled: canceled1, result: username } = await os.inputText({
>     title: i18n.ts.username,
>   });
>   if (canceled1) return;
99,103c135,139
< 	const { canceled: canceled2, result: password } = await os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	});
< 	if (canceled2) return;
---
>   const { canceled: canceled2, result: password } = await os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   });
>   if (canceled2) return;
105,110c141,146
< 	os.apiWithDialog('admin/accounts/create', {
< 		username: username,
< 		password: password,
< 	}).then(res => {
< 		paginationComponent.reload();
< 	});
---
>   os.apiWithDialog("admin/accounts/create", {
>     username: username,
>     password: password,
>   }).then((res) => {
>     paginationComponent.reload();
>   });
114c150
< 	os.pageWindow(`/user-info/${user.id}`);
---
>   os.pageWindow(`/user-info/${user.id}`);
117,131c153,171
< const headerActions = $computed(() => [{
< 	icon: 'ti ti-search',
< 	text: i18n.ts.search,
< 	handler: searchUser,
< }, {
< 	asFullButton: true,
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.addUser,
< 	handler: addUser,
< }, {
< 	asFullButton: true,
< 	icon: 'ti ti-search',
< 	text: i18n.ts.lookup,
< 	handler: lookupUser,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     icon: "fas fa-search",
>     text: i18n.ts.search,
>     handler: searchUser,
>   },
>   {
>     asFullButton: true,
>     icon: "fas fa-plus",
>     text: i18n.ts.addUser,
>     handler: addUser,
>   },
>   {
>     asFullButton: true,
>     icon: "fas fa-search",
>     text: i18n.ts.lookup,
>     handler: lookupUser,
>   },
> ]);
135,138c175,180
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.users,
< 	icon: 'ti ti-users',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.users,
>     icon: "fas fa-users",
>   }))
> );
143c185,188
< 	> .users {
---
>   > .users {
>     > .inputs {
>       display: flex;
>       margin-bottom: 16px;
145,147c190,191
< 		> .inputs {
< 			display: flex;
< 			margin-bottom: 16px;
---
>       > * {
>         margin-right: 16px;
149,150c193,197
< 			> * {
< 				margin-right: 16px;
---
>         &:last-child {
>           margin-right: 0;
>         }
>       }
>     }
152,162c199,203
< 				&:last-child {
< 					margin-right: 0;
< 				}
< 			}
< 		}
< 	
< 		> .users {
< 			margin-top: var(--margin);
< 			display: grid;
< 			grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
< 			grid-gap: 12px;
---
>     > .users {
>       margin-top: var(--margin);
>       display: grid;
>       grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
>       grid-gap: 12px;
164,168c205,209
< 			> .user:hover {
< 				text-decoration: none;
< 			}
< 		}
< 	}
---
>       > .user:hover {
>         text-decoration: none;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/admin-file.vue RiricaV13/pages/admin-file.vue
2,36c2,57
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer v-if="file" :content-max="600" :margin-min="16" :margin-max="32">
< 		<div v-if="tab === 'overview'" class="cxqhhsmd _gaps_m">
< 			<a class="thumbnail" :href="file.url" target="_blank">
< 				<MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain"/>
< 			</a>
< 			<div>
< 				<MkKeyValue :copy="file.type" oneline style="margin: 1em 0;">
< 					<template #key>MIME Type</template>
< 					<template #value><span class="_monospace">{{ file.type }}</span></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>Size</template>
< 					<template #value><span class="_monospace">{{ bytes(file.size) }}</span></template>
< 				</MkKeyValue>
< 				<MkKeyValue :copy="file.id" oneline style="margin: 1em 0;">
< 					<template #key>ID</template>
< 					<template #value><span class="_monospace">{{ file.id }}</span></template>
< 				</MkKeyValue>
< 				<MkKeyValue :copy="file.md5" oneline style="margin: 1em 0;">
< 					<template #key>MD5</template>
< 					<template #value><span class="_monospace">{{ file.md5 }}</span></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>{{ i18n.ts.createdAt }}</template>
< 					<template #value><span class="_monospace"><MkTime :time="file.createdAt" mode="detail" style="display: block;"/></span></template>
< 				</MkKeyValue>
< 			</div>
< 			<MkA v-if="file.user" class="user" :to="`/user-info/${file.user.id}`">
< 				<MkUserCardMini :user="file.user"/>
< 			</MkA>
< 			<div>
< 				<MkSwitch v-model="isSensitive" @update:model-value="toggleIsSensitive">NSFW</MkSwitch>
< 			</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer v-if="file" :content-max="600" :margin-min="16" :margin-max="32">
>       <div v-if="tab === 'overview'" class="cxqhhsmd _formRoot">
>         <a class="_formBlock thumbnail" :href="file.url" target="_blank">
>           <MkDriveFileThumbnail class="thumbnail" :file="file" fit="contain" />
>         </a>
>         <div class="_formBlock">
>           <MkKeyValue :copy="file.type" oneline style="margin: 1em 0">
>             <template #key>MIME Type</template>
>             <template #value
>               ><span class="_monospace">{{ file.type }}</span></template
>             >
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>Size</template>
>             <template #value
>               ><span class="_monospace">{{ bytes(file.size) }}</span></template
>             >
>           </MkKeyValue>
>           <MkKeyValue :copy="file.id" oneline style="margin: 1em 0">
>             <template #key>ID</template>
>             <template #value
>               ><span class="_monospace">{{ file.id }}</span></template
>             >
>           </MkKeyValue>
>           <MkKeyValue :copy="file.md5" oneline style="margin: 1em 0">
>             <template #key>MD5</template>
>             <template #value
>               ><span class="_monospace">{{ file.md5 }}</span></template
>             >
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.createdAt }}</template>
>             <template #value
>               ><span class="_monospace"
>                 ><MkTime
>                   :time="file.createdAt"
>                   mode="detail"
>                   style="display: block" /></span
>             ></template>
>           </MkKeyValue>
>         </div>
>         <MkA v-if="file.user" class="user" :to="`/user-info/${file.user.id}`">
>           <MkUserCardMini :user="file.user" />
>         </MkA>
>         <div class="_formBlock">
>           <MkSwitch v-model="isSensitive" @update:modelValue="toggleIsSensitive"
>             >NSFW</MkSwitch
>           >
>         </div>
38,61c59,92
< 			<div>
< 				<MkButton danger @click="del"><i class="ti ti-trash"></i> {{ i18n.ts.delete }}</MkButton>
< 			</div>
< 		</div>
< 		<div v-else-if="tab === 'ip' && info" class="_gaps_m">
< 			<MkInfo v-if="!iAmAdmin" warn>{{ i18n.ts.requireAdminForView }}</MkInfo>
< 			<MkKeyValue v-if="info.requestIp" class="_monospace" :copy="info.requestIp" oneline>
< 				<template #key>IP</template>
< 				<template #value>{{ info.requestIp }}</template>
< 			</MkKeyValue>
< 			<FormSection v-if="info.requestHeaders">
< 				<template #label>Headers</template>
< 				<MkKeyValue v-for="(v, k) in info.requestHeaders" :key="k" class="_monospace">
< 					<template #key>{{ k }}</template>
< 					<template #value>{{ v }}</template>
< 				</MkKeyValue>
< 			</FormSection>
< 		</div>
< 		<div v-else-if="tab === 'raw'" class="_gaps_m">
< 			<MkObjectView v-if="info" tall :value="info">
< 			</MkObjectView>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <div class="_formBlock">
>           <MkButton danger @click="del"
>             ><i class="fas fa-trash-alt"></i> {{ i18n.ts.delete }}</MkButton
>           >
>         </div>
>       </div>
>       <div v-else-if="tab === 'ip' && info" class="_formRoot">
>         <MkInfo v-if="!iAmAdmin" warn>{{ i18n.ts.requireAdminForView }}</MkInfo>
>         <MkKeyValue
>           v-if="info.requestIp"
>           class="_formBlock _monospace"
>           :copy="info.requestIp"
>           oneline
>         >
>           <template #key>IP</template>
>           <template #value>{{ info.requestIp }}</template>
>         </MkKeyValue>
>         <FormSection v-if="info.requestHeaders">
>           <template #label>Headers</template>
>           <MkKeyValue
>             v-for="(v, k) in info.requestHeaders"
>             :key="k"
>             class="_formBlock _monospace"
>           >
>             <template #key>{{ k }}</template>
>             <template #value>{{ v }}</template>
>           </MkKeyValue>
>         </FormSection>
>       </div>
>       <div v-else-if="tab === 'raw'" class="_formRoot">
>         <MkObjectView v-if="info" tall :value="info"> </MkObjectView>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
65,79c96,110
< import { computed } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkObjectView from '@/components/MkObjectView.vue';
< import MkDriveFileThumbnail from '@/components/MkDriveFileThumbnail.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import FormSection from '@/components/form/section.vue';
< import MkUserCardMini from '@/components/MkUserCardMini.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import bytes from '@/filters/bytes';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { acct } from '@/filters/user';
< import { iAmAdmin, iAmModerator } from '@/account';
---
> import { computed } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import MkObjectView from "@/components/MkObjectView.vue";
> import MkDriveFileThumbnail from "@/components/MkDriveFileThumbnail.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import FormSection from "@/components/form/section.vue";
> import MkUserCardMini from "@/components/MkUserCardMini.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import bytes from "@/filters/bytes";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { acct } from "@/filters/user";
> import { iAmAdmin, iAmModerator } from "@/account";
81c112
< let tab = $ref('overview');
---
> let tab = $ref("overview");
87c118
< 	fileId: string,
---
>   fileId: string;
91,93c122,124
< 	file = await os.api('drive/files/show', { fileId: props.fileId });
< 	info = await os.api('admin/drive/show-file', { fileId: props.fileId });
< 	isSensitive = file.isSensitive;
---
>   file = await os.api("drive/files/show", { fileId: props.fileId });
>   info = await os.api("admin/drive/show-file", { fileId: props.fileId });
>   isSensitive = file.isSensitive;
99,103c130,134
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: file.name }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: file.name }),
>   });
>   if (canceled) return;
105,107c136,138
< 	os.apiWithDialog('drive/files/delete', {
< 		fileId: file.id,
< 	});
---
>   os.apiWithDialog("drive/files/delete", {
>     fileId: file.id,
>   });
111,112c142,143
< 	await os.api('drive/files/update', { fileId: props.fileId, isSensitive: v });
< 	isSensitive = v;
---
>   await os.api("drive/files/update", { fileId: props.fileId, isSensitive: v });
>   isSensitive = v;
115,121c146,154
< const headerActions = $computed(() => [{
< 	text: i18n.ts.openInNewTab,
< 	icon: 'ti ti-external-link',
< 	handler: () => {
< 		window.open(file.url, '_blank');
< 	},
< }]);
---
> const headerActions = $computed(() => [
>   {
>     text: i18n.ts.openInNewTab,
>     icon: "fas fa-external-link-alt",
>     handler: () => {
>       window.open(file.url, "_blank");
>     },
>   },
> ]);
123,135c156,174
< const headerTabs = $computed(() => [{
< 	key: 'overview',
< 	title: i18n.ts.overview,
< 	icon: 'ti ti-info-circle',
< }, iAmModerator ? {
< 	key: 'ip',
< 	title: 'IP',
< 	icon: 'ti ti-password',
< } : null, {
< 	key: 'raw',
< 	title: 'Raw data',
< 	icon: 'ti ti-code',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "overview",
>     title: i18n.ts.overview,
>     icon: "fas fa-info-circle",
>   },
>   iAmModerator
>     ? {
>         key: "ip",
>         title: "IP",
>         icon: "fas fa-bars-staggered",
>       }
>     : null,
>   {
>     key: "raw",
>     title: "Raw data",
>     icon: "fas fa-code",
>   },
> ]);
137,140c176,181
< definePageMetadata(computed(() => ({
< 	title: file ? i18n.ts.file + ': ' + file.name : i18n.ts.file,
< 	icon: 'ti ti-file',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: file ? i18n.ts.file + ": " + file.name : i18n.ts.file,
>     icon: "fas fa-file",
>   }))
> );
145,146c186,187
< 	> .thumbnail {
< 		display: block;
---
>   > .thumbnail {
>     display: block;
148,152c189,193
< 		> .thumbnail {
< 			height: 300px;
< 			max-width: 100%;
< 		}
< 	}
---
>     > .thumbnail {
>       height: 300px;
>       max-width: 100%;
>     }
>   }
154,158c195,199
< 	> .user {
< 		&:hover {
< 			text-decoration: none;
< 		}
< 	}
---
>   > .user {
>     &:hover {
>       text-decoration: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/announcements.vue RiricaV13/pages/announcements.vue
2,18c2,33
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<MkPagination v-slot="{items}" :pagination="pagination" class="ruryvtyk _gaps_m">
< 			<section v-for="(announcement, i) in items" :key="announcement.id" class="announcement _panel">
< 				<div class="header"><span v-if="$i && !announcement.isRead">🆕 </span>{{ announcement.title }}</div>
< 				<div class="content">
< 					<Mfm :text="announcement.text"/>
< 					<img v-if="announcement.imageUrl" :src="announcement.imageUrl"/>
< 				</div>
< 				<div v-if="$i && !announcement.isRead" class="footer">
< 					<MkButton primary @click="read(items, announcement, i)"><i class="ti ti-check"></i> {{ $ts.gotIt }}</MkButton>
< 				</div>
< 			</section>
< 		</MkPagination>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <MkPagination
>         v-slot="{ items }"
>         :pagination="pagination"
>         class="ruryvtyk _content"
>       >
>         <section
>           v-for="(announcement, i) in items"
>           :key="announcement.id"
>           class="_card announcement"
>         >
>           <div class="_title">
>             <span v-if="$i && !announcement.isRead">🆕 </span
>             >{{ announcement.title }}
>           </div>
>           <div class="_content">
>             <Mfm :text="announcement.text" />
>             <img v-if="announcement.imageUrl" :src="announcement.imageUrl" />
>           </div>
>           <div v-if="$i && !announcement.isRead" class="_footer">
>             <MkButton primary @click="read(items, announcement, i)"
>               ><i class="fas fa-check"></i> {{ $ts.gotIt }}</MkButton
>             >
>           </div>
>         </section>
>       </MkPagination>
>     </MkSpacer>
>   </MkStickyContainer>
22,27c37,42
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
30,31c45,46
< 	endpoint: 'announcements' as const,
< 	limit: 10,
---
>   endpoint: "announcements" as const,
>   limit: 10,
36,40c51,55
< 	items[i] = {
< 		...announcement,
< 		isRead: true,
< 	};
< 	os.api('i/read-announcement', { announcementId: announcement.id });
---
>   items[i] = {
>     ...announcement,
>     isRead: true,
>   };
>   os.api("i/read-announcement", { announcementId: announcement.id });
48,49c63,64
< 	title: i18n.ts.announcements,
< 	icon: 'ti ti-speakerphone',
---
>   title: i18n.ts.announcements,
>   icon: "fas fa-broadcast-tower",
55,56c70,73
< 	> .announcement {
< 		padding: 16px;
---
>   > .announcement {
>     &:not(:last-child) {
>       margin-bottom: var(--margin);
>     }
58,74c75,82
< 		> .header {
< 			margin-bottom: 16px;
< 			font-weight: bold;
< 		}
< 
< 		> .content {
< 			> img {
< 				display: block;
< 				max-height: 300px;
< 				max-width: 100%;
< 			}
< 		}
< 
< 		> .footer {
< 			margin-top: 16px;
< 		}
< 	}
---
>     > ._content {
>       > img {
>         display: block;
>         max-height: 300px;
>         max-width: 100%;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/antenna-timeline.vue RiricaV13/pages/antenna-timeline.vue
2,17c2,29
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<div ref="rootEl" v-hotkey.global="keymap" class="tqmomfks">
< 		<div v-if="queue > 0" class="new"><button class="_buttonPrimary" @click="top()">{{ $ts.newNoteRecived }}</button></div>
< 		<div class="tl">
< 			<XTimeline
< 				ref="tlEl" :key="antennaId"
< 				class="tl"
< 				src="antenna"
< 				:antenna="antennaId"
< 				:sound="true"
< 				@queue="queueUpdated"
< 			/>
< 		</div>
< 	</div>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <div
>       ref="rootEl"
>       v-hotkey.global="keymap"
>       v-size="{ min: [800] }"
>       class="tqmomfks"
>     >
>       <div v-if="queue > 0" class="new">
>         <button class="_buttonPrimary" @click="top()">
>           {{ $ts.newNoteRecived }}
>         </button>
>       </div>
>       <div class="tl _block">
>         <XTimeline
>           ref="tlEl"
>           :key="antennaId"
>           class="tl"
>           src="antenna"
>           :antenna="antennaId"
>           :sound="true"
>           @queue="queueUpdated"
>         />
>       </div>
>     </div>
>   </MkStickyContainer>
21,27c33,39
< import { computed, inject, watch } from 'vue';
< import XTimeline from '@/components/MkTimeline.vue';
< import { scroll } from '@/scripts/scroll';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, inject, watch } from "vue";
> import XTimeline from "@/components/MkTimeline.vue";
> import { scroll } from "@/scripts/scroll";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
32c44
< 	antennaId: string;
---
>   antennaId: string;
37,38c49,50
< let rootEl = $shallowRef<HTMLElement>();
< let tlEl = $shallowRef<InstanceType<typeof XTimeline>>();
---
> let rootEl = $ref<HTMLElement>();
> let tlEl = $ref<InstanceType<typeof XTimeline>>();
40c52
< 	't': focus,
---
>   t: focus,
44c56
< 	queue = q;
---
>   queue = q;
48c60
< 	scroll(rootEl, { top: 0 });
---
>   scroll(rootEl, { top: 0 });
52,55c64,67
< 	const { canceled, result: date } = await os.inputDate({
< 		title: i18n.ts.date,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: date } = await os.inputDate({
>     title: i18n.ts.date,
>   });
>   if (canceled) return;
57c69
< 	tlEl.timetravel(date);
---
>   tlEl.timetravel(date);
61c73
< 	router.push(`/my/antennas/${props.antennaId}`);
---
>   router.push(`/my/antennas/${props.antennaId}`);
65c77
< 	tlEl.focus();
---
>   tlEl.focus();
68,72c80,88
< watch(() => props.antennaId, async () => {
< 	antenna = await os.api('antennas/show', {
< 		antennaId: props.antennaId,
< 	});
< }, { immediate: true });
---
> watch(
>   () => props.antennaId,
>   async () => {
>     antenna = await os.api("antennas/show", {
>       antennaId: props.antennaId,
>     });
>   },
>   { immediate: true }
> );
74,82c90,105
< const headerActions = $computed(() => antenna ? [{
< 	icon: 'fas fa-calendar-alt',
< 	text: i18n.ts.jumpToSpecifiedDate,
< 	handler: timetravel,
< }, {
< 	icon: 'ti ti-settings',
< 	text: i18n.ts.settings,
< 	handler: settings,
< }] : []);
---
> const headerActions = $computed(() =>
>   antenna
>     ? [
>         {
>           icon: "fas fa-calendar-alt",
>           text: i18n.ts.jumpToSpecifiedDate,
>           handler: timetravel,
>         },
>         {
>           icon: "fas fa-cog",
>           text: i18n.ts.settings,
>           handler: settings,
>         },
>       ]
>     : []
> );
86,89c109,118
< definePageMetadata(computed(() => antenna ? {
< 	title: antenna.name,
< 	icon: 'ti ti-antenna',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     antenna
>       ? {
>           title: antenna.name,
>           icon: "fas fa-satellite",
>         }
>       : null
>   )
> );
94c123
< 	padding: var(--margin);
---
>   padding: var(--margin);
96,100c125,129
< 	> .new {
< 		position: sticky;
< 		top: calc(var(--stickyTop, 0px) + 16px);
< 		z-index: 1000;
< 		width: 100%;
---
>   > .new {
>     position: sticky;
>     top: calc(var(--stickyTop, 0px) + 16px);
>     z-index: 1000;
>     width: 100%;
102,108c131,137
< 		> button {
< 			display: block;
< 			margin: var(--margin) auto 0 auto;
< 			padding: 8px 16px;
< 			border-radius: 32px;
< 		}
< 	}
---
>     > button {
>       display: block;
>       margin: var(--margin) auto 0 auto;
>       padding: 8px 16px;
>       border-radius: 32px;
>     }
>   }
110,115c139,143
< 	> .tl {
< 		background: var(--bg);
< 		border-radius: var(--radius);
< 		overflow: clip;
< 	}
< }
---
>   > .tl {
>     background: var(--bg);
>     border-radius: var(--radius);
>     overflow: clip;
>   }
117,121c145,148
< @container (min-width: 800px) {
< 	.tqmomfks {
< 		max-width: 800px;
< 		margin: 0 auto;
< 	}
---
>   &.min-width_800px {
>     max-width: 800px;
>     margin: 0 auto;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/api-console.vue RiricaV13/pages/api-console.vue
2,28c2,40
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="_gaps_m">
< 			<div class="_gaps_m">
< 				<MkInput v-model="endpoint" :datalist="endpoints" @update:model-value="onEndpointChange()">
< 					<template #label>Endpoint</template>
< 				</MkInput>
< 				<MkTextarea v-model="body" code>
< 					<template #label>Params (JSON or JSON5)</template>
< 				</MkTextarea>
< 				<MkSwitch v-model="withCredential">
< 					With credential
< 				</MkSwitch>
< 				<MkButton primary :disabled="sending" @click="send">
< 					<template v-if="sending"><MkEllipsis/></template>
< 					<template v-else><i class="ti ti-send"></i> Send</template>
< 				</MkButton>
< 			</div>
< 			<div v-if="res">
< 				<MkTextarea v-model="res" code readonly tall>
< 					<template #label>Response</template>
< 				</MkTextarea>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="_formRoot">
>         <div class="_formBlock">
>           <MkInput
>             v-model="endpoint"
>             :datalist="endpoints"
>             class="_formBlock"
>             @update:modelValue="onEndpointChange()"
>           >
>             <template #label>Endpoint</template>
>           </MkInput>
>           <MkTextarea v-model="body" class="_formBlock" code>
>             <template #label>Params (JSON or JSON5)</template>
>           </MkTextarea>
>           <MkSwitch v-model="withCredential" class="_formBlock">
>             With credential
>           </MkSwitch>
>           <MkButton
>             class="_formBlock"
>             primary
>             :disabled="sending"
>             @click="send"
>           >
>             <template v-if="sending"><MkEllipsis /></template>
>             <template v-else><i class="fas fa-paper-plane"></i> Send</template>
>           </MkButton>
>         </div>
>         <div v-if="res" class="_formBlock">
>           <MkTextarea v-model="res" code readonly tall>
>             <template #label>Response</template>
>           </MkTextarea>
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
32,40c44,52
< import { ref } from 'vue';
< import JSON5 from 'json5';
< import { Endpoints } from 'misskey-js';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref } from "vue";
> import JSON5 from "json5";
> import { Endpoints } from "misskey-js";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
42,43c54,55
< const body = ref('{}');
< const endpoint = ref('');
---
> const body = ref("{}");
> const endpoint = ref("");
46c58
< const res = ref('');
---
> const res = ref("");
49,50c61,62
< os.api('endpoints').then(endpointResponse => {
< 	endpoints.value = endpointResponse;
---
> os.api("endpoints").then((endpointResponse) => {
>   endpoints.value = endpointResponse;
54,62c66,81
< 	sending.value = true;
< 	const requestBody = JSON5.parse(body.value);
< 	os.api(endpoint.value as keyof Endpoints, requestBody, requestBody.i || (withCredential.value ? undefined : null)).then(resp => {
< 		sending.value = false;
< 		res.value = JSON5.stringify(resp, null, 2);
< 	}, err => {
< 		sending.value = false;
< 		res.value = JSON5.stringify(err, null, 2);
< 	});
---
>   sending.value = true;
>   const requestBody = JSON5.parse(body.value);
>   os.api(
>     endpoint.value as keyof Endpoints,
>     requestBody,
>     requestBody.i || (withCredential.value ? undefined : null)
>   ).then(
>     (resp) => {
>       sending.value = false;
>       res.value = JSON5.stringify(resp, null, 2);
>     },
>     (err) => {
>       sending.value = false;
>       res.value = JSON5.stringify(err, null, 2);
>     }
>   );
66,78c85,106
< 	os.api('endpoint', { endpoint: endpoint.value }, withCredential.value ? undefined : null).then(resp => {
< 		const endpointBody = {};
< 		for (const p of resp.params) {
< 			endpointBody[p.name] =
< 				p.type === 'String' ? '' :
< 				p.type === 'Number' ? 0 :
< 				p.type === 'Boolean' ? false :
< 				p.type === 'Array' ? [] :
< 				p.type === 'Object' ? {} :
< 				null;
< 		}
< 		body.value = JSON5.stringify(endpointBody, null, 2);
< 	});
---
>   os.api(
>     "endpoint",
>     { endpoint: endpoint.value },
>     withCredential.value ? undefined : null
>   ).then((resp) => {
>     const endpointBody = {};
>     for (const p of resp.params) {
>       endpointBody[p.name] =
>         p.type === "String"
>           ? ""
>           : p.type === "Number"
>           ? 0
>           : p.type === "Boolean"
>           ? false
>           : p.type === "Array"
>           ? []
>           : p.type === "Object"
>           ? {}
>           : null;
>     }
>     body.value = JSON5.stringify(endpointBody, null, 2);
>   });
86,87c114,115
< 	title: 'API console',
< 	icon: 'ti ti-terminal-2',
---
>   title: "API console",
>   icon: "fas fa-terminal",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/auth.form.vue RiricaV13/pages/auth.form.vue
2,19c2,21
< <section class="">
< 	<div class="">{{ $t('_auth.shareAccess', { name: app.name }) }}</div>
< 	<div class="">
< 		<h2>{{ app.name }}</h2>
< 		<p class="id">{{ app.id }}</p>
< 		<p class="description">{{ app.description }}</p>
< 	</div>
< 	<div class="">
< 		<h2>{{ $ts._auth.permissionAsk }}</h2>
< 		<ul>
< 			<li v-for="p in app.permission" :key="p">{{ $t(`_permissions.${p}`) }}</li>
< 		</ul>
< 	</div>
< 	<div class="">
< 		<MkButton inline @click="cancel">{{ $ts.cancel }}</MkButton>
< 		<MkButton inline primary @click="accept">{{ $ts.accept }}</MkButton>
< 	</div>
< </section>
---
>   <section class="_section">
>     <div class="_title">{{ $t("_auth.shareAccess", { name: app.name }) }}</div>
>     <div class="_content">
>       <h2>{{ app.name }}</h2>
>       <p class="id">{{ app.id }}</p>
>       <p class="description">{{ app.description }}</p>
>     </div>
>     <div class="_content">
>       <h2>{{ $ts._auth.permissionAsk }}</h2>
>       <ul>
>         <li v-for="p in app.permission" :key="p">
>           {{ $t(`_permissions.${p}`) }}
>         </li>
>       </ul>
>     </div>
>     <div class="_footer">
>       <MkButton inline @click="cancel">{{ $ts.cancel }}</MkButton>
>       <MkButton inline primary @click="accept">{{ $ts.accept }}</MkButton>
>     </div>
>   </section>
23,25c25,27
< import { defineComponent } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
---
> import { defineComponent } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
28,49c30,51
< 	components: {
< 		MkButton,
< 	},
< 	props: ['session'],
< 	computed: {
< 		name(): string {
< 			const el = document.createElement('div');
< 			el.textContent = this.app.name;
< 			return el.innerHTML;
< 		},
< 		app(): any {
< 			return this.session.app;
< 		},
< 	},
< 	methods: {
< 		cancel() {
< 			os.api('auth/deny', {
< 				token: this.session.token,
< 			}).then(() => {
< 				this.$emit('denied');
< 			});
< 		},
---
>   components: {
>     MkButton,
>   },
>   props: ["session"],
>   computed: {
>     name(): string {
>       const el = document.createElement("div");
>       el.textContent = this.app.name;
>       return el.innerHTML;
>     },
>     app(): any {
>       return this.session.app;
>     },
>   },
>   methods: {
>     cancel() {
>       os.api("auth/deny", {
>         token: this.session.token,
>       }).then(() => {
>         this.$emit("denied");
>       });
>     },
51,58c53,60
< 		accept() {
< 			os.api('auth/accept', {
< 				token: this.session.token,
< 			}).then(() => {
< 				this.$emit('accepted');
< 			});
< 		},
< 	},
---
>     accept() {
>       os.api("auth/accept", {
>         token: this.session.token,
>       }).then(() => {
>         this.$emit("accepted");
>       });
>     },
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/pages/auth.vue RiricaV13/pages/auth.vue
2,28c2,32
< <div v-if="$i && fetching" class="">
< 	<MkLoading/>
< </div>
< <div v-else-if="$i">
< 	<XForm
< 		v-if="state == 'waiting'"
< 		ref="form"
< 		class="form"
< 		:session="session"
< 		@denied="state = 'denied'"
< 		@accepted="accepted"
< 	/>
< 	<div v-if="state == 'denied'" class="denied">
< 		<h1>{{ $ts._auth.denied }}</h1>
< 	</div>
< 	<div v-if="state == 'accepted'" class="accepted">
< 		<h1>{{ session.app.isAuthorized ? $t('already-authorized') : $ts.allowed }}</h1>
< 		<p v-if="session.app.callbackUrl">{{ $ts._auth.callback }}<MkEllipsis/></p>
< 		<p v-if="!session.app.callbackUrl">{{ $ts._auth.pleaseGoBack }}</p>
< 	</div>
< 	<div v-if="state == 'fetch-session-error'" class="error">
< 		<p>{{ $ts.somethingHappened }}</p>
< 	</div>
< </div>
< <div v-else class="signin">
< 	<MkSignin @login="onLogin"/>
< </div>
---
>   <div v-if="$i && fetching" class="">
>     <MkLoading />
>   </div>
>   <div v-else-if="$i">
>     <XForm
>       v-if="state == 'waiting'"
>       ref="form"
>       class="form"
>       :session="session"
>       @denied="state = 'denied'"
>       @accepted="accepted"
>     />
>     <div v-if="state == 'denied'" class="denied">
>       <h1>{{ $ts._auth.denied }}</h1>
>     </div>
>     <div v-if="state == 'accepted'" class="accepted">
>       <h1>
>         {{ session.app.isAuthorized ? $t("already-authorized") : $ts.allowed }}
>       </h1>
>       <p v-if="session.app.callbackUrl">
>         {{ $ts._auth.callback }}<MkEllipsis />
>       </p>
>       <p v-if="!session.app.callbackUrl">{{ $ts._auth.pleaseGoBack }}</p>
>     </div>
>     <div v-if="state == 'fetch-session-error'" class="error">
>       <p>{{ $ts.somethingHappened }}</p>
>     </div>
>   </div>
>   <div v-else class="signin">
>     <MkSignin @login="onLogin" />
>   </div>
32,36c36,40
< import { defineComponent } from 'vue';
< import XForm from './auth.form.vue';
< import MkSignin from '@/components/MkSignin.vue';
< import * as os from '@/os';
< import { login } from '@/account';
---
> import { defineComponent } from "vue";
> import XForm from "./auth.form.vue";
> import MkSignin from "@/components/MkSignin.vue";
> import * as os from "@/os";
> import { login } from "@/account";
39,52c43,56
< 	components: {
< 		XForm,
< 		MkSignin,
< 	},
< 	props: ['token'],
< 	data() {
< 		return {
< 			state: null,
< 			session: null,
< 			fetching: true,
< 		};
< 	},
< 	mounted() {
< 		if (!this.$i) return;
---
>   components: {
>     XForm,
>     MkSignin,
>   },
>   props: ["token"],
>   data() {
>     return {
>       state: null,
>       session: null,
>       fetching: true,
>     };
>   },
>   mounted() {
>     if (!this.$i) return;
54,59c58,64
< 		// Fetch session
< 		os.api('auth/session/show', {
< 			token: this.token,
< 		}).then(session => {
< 			this.session = session;
< 			this.fetching = false;
---
>     // Fetch session
>     os.api("auth/session/show", {
>       token: this.token,
>     })
>       .then((session) => {
>         this.session = session;
>         this.fetching = false;
61,85c66,92
< 			// 既に連携していた場合
< 			if (this.session.app.isAuthorized) {
< 				os.api('auth/accept', {
< 					token: this.session.token,
< 				}).then(() => {
< 					this.accepted();
< 				});
< 			} else {
< 				this.state = 'waiting';
< 			}
< 		}).catch(error => {
< 			this.state = 'fetch-session-error';
< 			this.fetching = false;
< 		});
< 	},
< 	methods: {
< 		accepted() {
< 			this.state = 'accepted';
< 			if (this.session.app.callbackUrl) {
< 				location.href = `${this.session.app.callbackUrl}?token=${this.session.token}`;
< 			}
< 		}, onLogin(res) {
< 			login(res.i);
< 		},
< 	},
---
>         // 既に連携していた場合
>         if (this.session.app.isAuthorized) {
>           os.api("auth/accept", {
>             token: this.session.token,
>           }).then(() => {
>             this.accepted();
>           });
>         } else {
>           this.state = "waiting";
>         }
>       })
>       .catch((error) => {
>         this.state = "fetch-session-error";
>         this.fetching = false;
>       });
>   },
>   methods: {
>     accepted() {
>       this.state = "accepted";
>       if (this.session.app.callbackUrl) {
>         location.href = `${this.session.app.callbackUrl}?token=${this.session.token}`;
>       }
>     },
>     onLogin(res) {
>       login(res.i);
>     },
>   },
89,91c96
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/channel-editor.vue RiricaV13/pages/channel-editor.vue
2,8c2,10
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="_gaps_m">
< 			<MkInput v-model="name">
< 				<template #label>{{ i18n.ts.name }}</template>
< 			</MkInput>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="_formRoot">
>         <MkInput v-model="name" class="_formBlock">
>           <template #label>{{ i18n.ts.name }}</template>
>         </MkInput>
10,12c12,14
< 			<MkTextarea v-model="description">
< 				<template #label>{{ i18n.ts.description }}</template>
< 			</MkTextarea>
---
>         <MkTextarea v-model="description" class="_formBlock">
>           <template #label>{{ i18n.ts.description }}</template>
>         </MkTextarea>
14,26c16,37
< 			<div class="banner">
< 				<MkButton v-if="bannerId == null" @click="setBannerImage"><i class="ti ti-plus"></i> {{ i18n.ts._channel.setBanner }}</MkButton>
< 				<div v-else-if="bannerUrl">
< 					<img :src="bannerUrl" style="width: 100%;"/>
< 					<MkButton @click="removeBannerImage()"><i class="ti ti-trash"></i> {{ i18n.ts._channel.removeBanner }}</MkButton>
< 				</div>
< 			</div>
< 			<div>
< 				<MkButton primary @click="save()"><i class="ti ti-device-floppy"></i> {{ channelId ? i18n.ts.save : i18n.ts.create }}</MkButton>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <div class="banner">
>           <MkButton v-if="bannerId == null" @click="setBannerImage"
>             ><i class="fas fa-plus"></i>
>             {{ i18n.ts._channel.setBanner }}</MkButton
>           >
>           <div v-else-if="bannerUrl">
>             <img :src="bannerUrl" style="width: 100%" />
>             <MkButton @click="removeBannerImage()"
>               ><i class="fas fa-trash-alt"></i>
>               {{ i18n.ts._channel.removeBanner }}</MkButton
>             >
>           </div>
>         </div>
>         <div class="_formBlock">
>           <MkButton primary @click="save()"
>             ><i class="fas fa-save"></i>
>             {{ channelId ? i18n.ts.save : i18n.ts.create }}</MkButton
>           >
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
30,38c41,49
< import { computed, inject, watch } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import { selectFile } from '@/scripts/select-file';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, inject, watch } from "vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import { selectFile } from "@/scripts/select-file";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
43c54
< 	channelId?: string;
---
>   channelId?: string;
52,60c63,76
< watch(() => bannerId, async () => {
< 	if (bannerId == null) {
< 		bannerUrl = null;
< 	} else {
< 		bannerUrl = (await os.api('drive/files/show', {
< 			fileId: bannerId,
< 		})).url;
< 	}
< });
---
> watch(
>   () => bannerId,
>   async () => {
>     if (bannerId == null) {
>       bannerUrl = null;
>     } else {
>       bannerUrl = (
>         await os.api("drive/files/show", {
>           fileId: bannerId,
>         })
>       ).url;
>     }
>   }
> );
63c79
< 	if (props.channelId == null) return;
---
>   if (props.channelId == null) return;
65,67c81,83
< 	channel = await os.api('channels/show', {
< 		channelId: props.channelId,
< 	});
---
>   channel = await os.api("channels/show", {
>     channelId: props.channelId,
>   });
69,72c85,88
< 	name = channel.name;
< 	description = channel.description;
< 	bannerId = channel.bannerId;
< 	bannerUrl = channel.bannerUrl;
---
>   name = channel.name;
>   description = channel.description;
>   bannerId = channel.bannerId;
>   bannerUrl = channel.bannerUrl;
78,82c94,98
< 	const params = {
< 		name: name,
< 		description: description,
< 		bannerId: bannerId,
< 	};
---
>   const params = {
>     name: name,
>     description: description,
>     bannerId: bannerId,
>   };
84,94c100,110
< 	if (props.channelId) {
< 		params.channelId = props.channelId;
< 		os.api('channels/update', params).then(() => {
< 			os.success();
< 		});
< 	} else {
< 		os.api('channels/create', params).then(created => {
< 			os.success();
< 			router.push(`/channels/${created.id}`);
< 		});
< 	}
---
>   if (props.channelId) {
>     params.channelId = props.channelId;
>     os.api("channels/update", params).then(() => {
>       os.success();
>     });
>   } else {
>     os.api("channels/create", params).then((created) => {
>       os.success();
>       router.push(`/channels/${created.id}`);
>     });
>   }
98,100c114,116
< 	selectFile(evt.currentTarget ?? evt.target, null).then(file => {
< 		bannerId = file.id;
< 	});
---
>   selectFile(evt.currentTarget ?? evt.target, null).then((file) => {
>     bannerId = file.id;
>   });
104c120
< 	bannerId = null;
---
>   bannerId = null;
111,117c127,139
< definePageMetadata(computed(() => props.channelId ? {
< 	title: i18n.ts._channel.edit,
< 	icon: 'ti ti-device-tv',
< } : {
< 	title: i18n.ts._channel.create,
< 	icon: 'ti ti-device-tv',
< }));
---
> definePageMetadata(
>   computed(() =>
>     props.channelId
>       ? {
>           title: i18n.ts._channel.edit,
>           icon: "fas fa-satellite-dish",
>         }
>       : {
>           title: i18n.ts._channel.create,
>           icon: "fas fa-satellite-dish",
>         }
>   )
> );
120,122c142
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/channel.vue RiricaV13/pages/channel.vue
2,24c2,61
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div v-if="channel">
< 			<div class="wpgynlbz _panel _margin" :class="{ hide: !showBanner }">
< 				<XChannelFollowButton :channel="channel" :full="true" class="subscribe"/>
< 				<button class="_button toggle" @click="() => showBanner = !showBanner">
< 					<template v-if="showBanner"><i class="ti ti-chevron-up"></i></template>
< 					<template v-else><i class="ti ti-chevron-down"></i></template>
< 				</button>
< 				<div v-if="!showBanner" class="hideOverlay">
< 				</div>
< 				<div :style="{ backgroundImage: channel.bannerUrl ? `url(${channel.bannerUrl})` : null }" class="banner">
< 					<div class="status">
< 						<div><i class="ti ti-users ti-fw"></i><I18n :src="i18n.ts._channel.usersCount" tag="span" style="margin-left: 4px;"><template #n><b>{{ channel.usersCount }}</b></template></I18n></div>
< 						<div><i class="ti ti-pencil ti-fw"></i><I18n :src="i18n.ts._channel.notesCount" tag="span" style="margin-left: 4px;"><template #n><b>{{ channel.notesCount }}</b></template></I18n></div>
< 					</div>
< 					<div class="fade"></div>
< 				</div>
< 				<div v-if="channel.description" class="description">
< 					<Mfm :text="channel.description" :is-note="false" :i="$i"/>
< 				</div>
< 			</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div v-if="channel">
>         <div class="wpgynlbz _panel _gap" :class="{ hide: !showBanner }">
>           <XChannelFollowButton
>             :channel="channel"
>             :full="true"
>             class="subscribe"
>           />
>           <button
>             class="_button toggle"
>             @click="() => (showBanner = !showBanner)"
>           >
>             <template v-if="showBanner"
>               ><i class="fas fa-angle-up"></i
>             ></template>
>             <template v-else><i class="fas fa-angle-down"></i></template>
>           </button>
>           <div v-if="!showBanner" class="hideOverlay"></div>
>           <div
>             :style="{
>               backgroundImage: channel.bannerUrl
>                 ? `url(${channel.bannerUrl})`
>                 : null,
>             }"
>             class="banner"
>           >
>             <div class="status">
>               <div>
>                 <i class="fas fa-users fa-fw"></i
>                 ><I18n
>                   :src="i18n.ts._channel.usersCount"
>                   tag="span"
>                   style="margin-left: 4px"
>                   ><template #n
>                     ><b>{{ channel.usersCount }}</b></template
>                   ></I18n
>                 >
>               </div>
>               <div>
>                 <i class="fas fa-pencil-alt fa-fw"></i
>                 ><I18n
>                   :src="i18n.ts._channel.notesCount"
>                   tag="span"
>                   style="margin-left: 4px"
>                   ><template #n
>                     ><b>{{ channel.notesCount }}</b></template
>                   ></I18n
>                 >
>               </div>
>             </div>
>             <div class="fade"></div>
>           </div>
>           <div v-if="channel.description" class="description">
>             <Mfm :text="channel.description" :is-note="false" :i="$i" />
>           </div>
>         </div>
26c63,68
< 			<XPostForm v-if="$i" :channel="channel" class="post-form _panel _margin" fixed/>
---
>         <XPostForm
>           v-if="$i"
>           :channel="channel"
>           class="post-form _panel _gap"
>           fixed
>         />
28,31c70,80
< 			<XTimeline :key="channelId" class="_margin" src="channel" :channel="channelId" @before="before" @after="after"/>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <XTimeline
>           :key="channelId"
>           class="_gap"
>           src="channel"
>           :channel="channelId"
>           @before="before"
>           @after="after"
>         />
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
35,44c84,93
< import { computed, inject, watch } from 'vue';
< import MkContainer from '@/components/MkContainer.vue';
< import XPostForm from '@/components/MkPostForm.vue';
< import XTimeline from '@/components/MkTimeline.vue';
< import XChannelFollowButton from '@/components/MkChannelFollowButton.vue';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, inject, watch } from "vue";
> import MkContainer from "@/components/MkContainer.vue";
> import XPostForm from "@/components/MkPostForm.vue";
> import XTimeline from "@/components/MkTimeline.vue";
> import XChannelFollowButton from "@/components/MkChannelFollowButton.vue";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
49c98
< 	channelId: string;
---
>   channelId: string;
55,59c104,108
< 	endpoint: 'channels/timeline' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		channelId: props.channelId,
< 	})),
---
>   endpoint: "channels/timeline" as const,
>   limit: 10,
>   params: computed(() => ({
>     channelId: props.channelId,
>   })),
62,66c111,119
< watch(() => props.channelId, async () => {
< 	channel = await os.api('channels/show', {
< 		channelId: props.channelId,
< 	});
< }, { immediate: true });
---
> watch(
>   () => props.channelId,
>   async () => {
>     channel = await os.api("channels/show", {
>       channelId: props.channelId,
>     });
>   },
>   { immediate: true }
> );
69c122
< 	router.push(`/channels/${channel.id}/edit`);
---
>   router.push(`/channels/${channel.id}/edit`);
72,76c125,135
< const headerActions = $computed(() => channel && channel.userId ? [{
< 	icon: 'ti ti-settings',
< 	text: i18n.ts.edit,
< 	handler: edit,
< }] : null);
---
> const headerActions = $computed(() =>
>   channel && channel.userId
>     ? [
>         {
>           icon: "fas fa-cog",
>           text: i18n.ts.edit,
>           handler: edit,
>         },
>       ]
>     : null
> );
80,83c139,148
< definePageMetadata(computed(() => channel ? {
< 	title: channel.name,
< 	icon: 'ti ti-device-tv',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     channel
>       ? {
>           title: channel.name,
>           icon: "fas fa-satellite-dish",
>         }
>       : null
>   )
> );
88c153
< 	position: relative;
---
>   position: relative;
90,95c155,160
< 	> .subscribe {
< 		position: absolute;
< 		z-index: 1;
< 		top: 16px;
< 		left: 16px;
< 	}
---
>   > .subscribe {
>     position: absolute;
>     z-index: 1;
>     top: 16px;
>     left: 16px;
>   }
97,99c162,164
< 	> .toggle {
< 		position: absolute;
< 		z-index: 2;
---
>   > .toggle {
>     position: absolute;
>     z-index: 2;
101,118c166,172
< 		right: 8px;
< 		font-size: 1.2em;
< 		width: 48px;
< 		height: 48px;
< 		color: #fff;
< 		background: rgba(0, 0, 0, 0.5);
< 		border-radius: 100%;
< 		
< 		> i {
< 			vertical-align: middle;
< 		}
< 	}
< 	
< 	> .banner {
< 		position: relative;
< 		height: 200px;
< 		background-position: center;
< 		background-size: cover;
---
>     right: 8px;
>     font-size: 1.2em;
>     width: 48px;
>     height: 48px;
>     color: #fff;
>     background: rgba(0, 0, 0, 0.5);
>     border-radius: 100%;
120,127c174,177
< 		> .fade {
< 			position: absolute;
< 			bottom: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 64px;
< 			background: linear-gradient(0deg, var(--panel), var(--X15));
< 		}
---
>     > i {
>       vertical-align: middle;
>     }
>   }
129,140c179,183
< 		> .status {
< 			position: absolute;
< 			z-index: 1;
< 			bottom: 16px;
< 			right: 16px;
< 			padding: 8px 12px;
< 			font-size: 80%;
< 			background: rgba(0, 0, 0, 0.7);
< 			border-radius: 6px;
< 			color: #fff;
< 		}
< 	}
---
>   > .banner {
>     position: relative;
>     height: 200px;
>     background-position: center;
>     background-size: cover;
142,144c185,192
< 	> .description {
< 		padding: 16px;
< 	}
---
>     > .fade {
>       position: absolute;
>       bottom: 0;
>       left: 0;
>       width: 100%;
>       height: 64px;
>       background: linear-gradient(0deg, var(--panel), var(--X15));
>     }
146,156c194,205
< 	> .hideOverlay {
< 		position: absolute;
< 		z-index: 1;
< 		top: 0;
< 		left: 0;
< 		width: 100%;
< 		height: 100%;
< 		-webkit-backdrop-filter: var(--blur, blur(16px));
< 		backdrop-filter: var(--blur, blur(16px));
< 		background: rgba(0, 0, 0, 0.3);
< 	}
---
>     > .status {
>       position: absolute;
>       z-index: 1;
>       bottom: 16px;
>       right: 16px;
>       padding: 8px 12px;
>       font-size: 80%;
>       background: rgba(0, 0, 0, 0.7);
>       border-radius: 6px;
>       color: #fff;
>     }
>   }
158,161c207,209
< 	&.hide {
< 		> .subscribe {
< 			display: none;
< 		}
---
>   > .description {
>     padding: 16px;
>   }
163,168c211,221
< 		> .toggle {
< 			top: 0;
< 			right: 0;
< 			height: 100%;
< 			background: transparent;
< 		}
---
>   > .hideOverlay {
>     position: absolute;
>     z-index: 1;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     -webkit-backdrop-filter: var(--blur, blur(16px));
>     backdrop-filter: var(--blur, blur(16px));
>     background: rgba(0, 0, 0, 0.3);
>   }
170,172c223,226
< 		> .banner {
< 			height: 42px;
< 			filter: blur(8px);
---
>   &.hide {
>     > .subscribe {
>       display: none;
>     }
174,177c228,233
< 			> * {
< 				display: none;
< 			}
< 		}
---
>     > .toggle {
>       top: 0;
>       right: 0;
>       height: 100%;
>       background: transparent;
>     }
179,182c235,247
< 		> .description {
< 			display: none;
< 		}
< 	}
---
>     > .banner {
>       height: 42px;
>       filter: blur(8px);
> 
>       > * {
>         display: none;
>       }
>     }
> 
>     > .description {
>       display: none;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/channels.vue RiricaV13/pages/channels.vue
2,22c2,44
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div v-if="tab === 'featured'" class="grwlizim featured">
< 			<MkPagination v-slot="{items}" :pagination="featuredPagination">
< 				<MkChannelPreview v-for="channel in items" :key="channel.id" class="_margin" :channel="channel"/>
< 			</MkPagination>
< 		</div>
< 		<div v-else-if="tab === 'following'" class="grwlizim following">
< 			<MkPagination v-slot="{items}" :pagination="followingPagination">
< 				<MkChannelPreview v-for="channel in items" :key="channel.id" class="_margin" :channel="channel"/>
< 			</MkPagination>
< 		</div>
< 		<div v-else-if="tab === 'owned'" class="grwlizim owned">
< 			<MkButton class="new" @click="create()"><i class="ti ti-plus"></i></MkButton>
< 			<MkPagination v-slot="{items}" :pagination="ownedPagination">
< 				<MkChannelPreview v-for="channel in items" :key="channel.id" class="_margin" :channel="channel"/>
< 			</MkPagination>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div v-if="tab === 'featured'" class="_content grwlizim featured">
>         <MkPagination v-slot="{ items }" :pagination="featuredPagination">
>           <MkChannelPreview
>             v-for="channel in items"
>             :key="channel.id"
>             class="_gap"
>             :channel="channel"
>           />
>         </MkPagination>
>       </div>
>       <div v-else-if="tab === 'following'" class="_content grwlizim following">
>         <MkPagination v-slot="{ items }" :pagination="followingPagination">
>           <MkChannelPreview
>             v-for="channel in items"
>             :key="channel.id"
>             class="_gap"
>             :channel="channel"
>           />
>         </MkPagination>
>       </div>
>       <div v-else-if="tab === 'owned'" class="_content grwlizim owned">
>         <MkButton class="new" @click="create()"
>           ><i class="fas fa-plus"></i
>         ></MkButton>
>         <MkPagination v-slot="{ items }" :pagination="ownedPagination">
>           <MkChannelPreview
>             v-for="channel in items"
>             :key="channel.id"
>             class="_gap"
>             :channel="channel"
>           />
>         </MkPagination>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
26,32c48,54
< import { computed, defineComponent, inject } from 'vue';
< import MkChannelPreview from '@/components/MkChannelPreview.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, defineComponent, inject } from "vue";
> import MkChannelPreview from "@/components/MkChannelPreview.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
36c58
< let tab = $ref('featured');
---
> let tab = $ref("featured");
39,40c61,62
< 	endpoint: 'channels/featured' as const,
< 	noPaging: true,
---
>   endpoint: "channels/featured" as const,
>   noPaging: true,
43,44c65,66
< 	endpoint: 'channels/followed' as const,
< 	limit: 5,
---
>   endpoint: "channels/followed" as const,
>   limit: 5,
47,48c69,70
< 	endpoint: 'channels/owned' as const,
< 	limit: 5,
---
>   endpoint: "channels/owned" as const,
>   limit: 5,
52c74
< 	router.push('/channels/new');
---
>   router.push("/channels/new");
55,59c77,83
< const headerActions = $computed(() => [{
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.create,
< 	handler: create,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     icon: "fas fa-plus",
>     text: i18n.ts.create,
>     handler: create,
>   },
> ]);
61,73c85,101
< const headerTabs = $computed(() => [{
< 	key: 'featured',
< 	title: i18n.ts._channel.featured,
< 	icon: 'ti ti-comet',
< }, {
< 	key: 'following',
< 	title: i18n.ts._channel.following,
< 	icon: 'ti ti-heart',
< }, {
< 	key: 'owned',
< 	title: i18n.ts._channel.owned,
< 	icon: 'ti ti-edit',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "featured",
>     title: i18n.ts._channel.featured,
>     icon: "fas fa-fire-alt",
>   },
>   {
>     key: "following",
>     title: i18n.ts._channel.following,
>     icon: "fas fa-heart",
>   },
>   {
>     key: "owned",
>     title: i18n.ts._channel.owned,
>     icon: "fas fa-edit",
>   },
> ]);
75,78c103,108
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.channel,
< 	icon: 'ti ti-device-tv',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.channel,
>     icon: "fas fa-satellite-dish",
>   }))
> );
Only in misskeyV13/packages/frontend/src/pages: clicker.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/clip.vue RiricaV13/pages/clip.vue
2,13c2,14
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions"/></template>
< 	<MkSpacer :content-max="800">
< 		<div v-if="clip">
< 			<div class="okzinsic _panel">
< 				<div v-if="clip.description" class="description">
< 					<Mfm :text="clip.description" :is-note="false" :i="$i"/>
< 				</div>
< 				<div class="user">
< 					<MkAvatar :user="clip.user" class="avatar" indicator link preview/> <MkUserName :user="clip.user" :nowrap="false"/>
< 				</div>
< 			</div>
---
>   <MkStickyContainer>
>     <template #header><MkPageHeader :actions="headerActions" /></template>
>     <MkSpacer :content-max="800">
>       <div v-if="clip">
>         <div class="okzinsic _panel">
>           <div v-if="clip.description" class="description">
>             <Mfm :text="clip.description" :is-note="false" :i="$i" />
>           </div>
>           <div class="user">
>             <MkAvatar :user="clip.user" class="avatar" :show-indicator="true" />
>             <MkUserName :user="clip.user" :nowrap="false" />
>           </div>
>         </div>
15,18c16,19
< 			<XNotes :pagination="pagination" :detail="true"/>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <XNotes :pagination="pagination" :detail="true" />
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
22,28c23,29
< import { computed, watch, provide } from 'vue';
< import * as misskey from 'misskey-js';
< import XNotes from '@/components/MkNotes.vue';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, watch, provide } from "vue";
> import * as misskey from "misskey-js";
> import XNotes from "@/components/MkNotes.vue";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
31c32
< 	clipId: string,
---
>   clipId: string;
36,40c37,41
< 	endpoint: 'clips/notes' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		clipId: props.clipId,
< 	})),
---
>   endpoint: "clips/notes" as const,
>   limit: 10,
>   params: computed(() => ({
>     clipId: props.clipId,
>   })),
43c44,46
< const isOwned: boolean | null = $computed<boolean | null>(() => $i && clip && ($i.id === clip.userId));
---
> const isOwned: boolean | null = $computed<boolean | null>(
>   () => $i && clip && $i.id === clip.userId
> );
45,51c48,58
< watch(() => props.clipId, async () => {
< 	clip = await os.api('clips/show', {
< 		clipId: props.clipId,
< 	});
< }, {
< 	immediate: true,
< }); 
---
> watch(
>   () => props.clipId,
>   async () => {
>     clip = await os.api("clips/show", {
>       clipId: props.clipId,
>     });
>   },
>   {
>     immediate: true,
>   }
> );
53c60
< provide('currentClipPage', $$(clip));
---
> provide("currentClipPage", $$(clip));
55,78c62,88
< const headerActions = $computed(() => clip && isOwned ? [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.edit,
< 	handler: async (): Promise<void> => {
< 		const { canceled, result } = await os.form(clip.name, {
< 			name: {
< 				type: 'string',
< 				label: i18n.ts.name,
< 				default: clip.name,
< 			},
< 			description: {
< 				type: 'string',
< 				required: false,
< 				multiline: true,
< 				label: i18n.ts.description,
< 				default: clip.description,
< 			},
< 			isPublic: {
< 				type: 'boolean',
< 				label: i18n.ts.public,
< 				default: clip.isPublic,
< 			},
< 		});
< 		if (canceled) return;
---
> const headerActions = $computed(() =>
>   clip && isOwned
>     ? [
>         {
>           icon: "fas fa-pencil-alt",
>           text: i18n.ts.edit,
>           handler: async (): Promise<void> => {
>             const { canceled, result } = await os.form(clip.name, {
>               name: {
>                 type: "string",
>                 label: i18n.ts.name,
>                 default: clip.name,
>               },
>               description: {
>                 type: "string",
>                 required: false,
>                 multiline: true,
>                 label: i18n.ts.description,
>                 default: clip.description,
>               },
>               isPublic: {
>                 type: "boolean",
>                 label: i18n.ts.public,
>                 default: clip.isPublic,
>               },
>             });
>             if (canceled) return;
80,94c90,105
< 		os.apiWithDialog('clips/update', {
< 			clipId: clip.id,
< 			...result,
< 		});
< 	},
< }, {
< 	icon: 'ti ti-trash',
< 	text: i18n.ts.delete,
< 	danger: true,
< 	handler: async (): Promise<void> => {
< 		const { canceled } = await os.confirm({
< 			type: 'warning',
< 			text: i18n.t('deleteAreYouSure', { x: clip.name }),
< 		});
< 		if (canceled) return;
---
>             os.apiWithDialog("clips/update", {
>               clipId: clip.id,
>               ...result,
>             });
>           },
>         },
>         {
>           icon: "fas fa-trash-alt",
>           text: i18n.ts.delete,
>           danger: true,
>           handler: async (): Promise<void> => {
>             const { canceled } = await os.confirm({
>               type: "warning",
>               text: i18n.t("deleteAreYouSure", { x: clip.name }),
>             });
>             if (canceled) return;
96,100c107,114
< 		await os.apiWithDialog('clips/delete', {
< 			clipId: clip.id,
< 		});
< 	},
< }] : null);
---
>             await os.apiWithDialog("clips/delete", {
>               clipId: clip.id,
>             });
>           },
>         },
>       ]
>     : null
> );
102,105c116,125
< definePageMetadata(computed(() => clip ? {
< 	title: clip.name,
< 	icon: 'ti ti-paperclip',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     clip
>       ? {
>           title: clip.name,
>           icon: "fas fa-paperclip",
>         }
>       : null
>   )
> );
110,111c130,131
< 	position: relative;
< 	margin-bottom: var(--margin);
---
>   position: relative;
>   margin-bottom: var(--margin);
113,115c133,135
< 	> .description {
< 		padding: 16px;
< 	}
---
>   > .description {
>     padding: 16px;
>   }
117,121c137,141
< 	> .user {
< 		$height: 32px;
< 		padding: 16px;
< 		border-top: solid 0.5px var(--divider);
< 		line-height: $height;
---
>   > .user {
>     $height: 32px;
>     padding: 16px;
>     border-top: solid 0.5px var(--divider);
>     line-height: $height;
123,127c143,147
< 		> .avatar {
< 			width: $height;
< 			height: $height;
< 		}
< 	}
---
>     > .avatar {
>       width: $height;
>       height: $height;
>     }
>   }
Only in misskeyV13/packages/frontend/src/pages: custom-emojis-manager.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/drive.vue RiricaV13/pages/drive.vue
2,4c2,4
< <div>
< 	<XDrive ref="drive" @cd="x => folder = x"/>
< </div>
---
>   <div>
>     <XDrive ref="drive" @cd="(x) => (folder = x)" />
>   </div>
8,12c8,12
< import { computed } from 'vue';
< import XDrive from '@/components/MkDrive.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed } from "vue";
> import XDrive from "@/components/MkDrive.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
20,24c20,26
< definePageMetadata(computed(() => ({
< 	title: folder ? folder.name : i18n.ts.drive,
< 	icon: 'ti ti-cloud',
< 	hideHeader: true,
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: folder ? folder.name : i18n.ts.drive,
>     icon: "fas fa-cloud",
>     hideHeader: true,
>   }))
> );
Only in misskeyV13/packages/frontend/src/pages: emoji-edit-dialog.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/emojis.emoji.vue RiricaV13/pages/emojis.emoji.vue
2,8c2,8
< <button class="zuvgdzyu _button" @click="menu">
< 	<img :src="emoji.url" class="img" loading="lazy"/>
< 	<div class="body">
< 		<div class="name _monospace">{{ emoji.name }}</div>
< 		<div class="info">{{ emoji.aliases.join(' ') }}</div>
< 	</div>
< </button>
---
>   <button class="zuvgdzyu _button" @click="menu">
>     <img :src="emoji.url" class="img" :alt="emoji.name" />
>     <div class="body">
>       <div class="name _monospace">{{ emoji.name }}</div>
>       <div class="info">{{ emoji.aliases.join(" ") }}</div>
>     </div>
>   </button>
12,15c12,15
< import { } from 'vue';
< import * as os from '@/os';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as os from "@/os";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { i18n } from "@/i18n";
18,23c18
< 	emoji: {
< 		name: string;
< 		aliases: string[];
< 		category: string;
< 		url: string;
< 	};
---
>   emoji: Record<string, unknown>; // TODO
27,37c22,38
< 	os.popupMenu([{
< 		type: 'label',
< 		text: ':' + props.emoji.name + ':',
< 	}, {
< 		text: i18n.ts.copy,
< 		icon: 'ti ti-copy',
< 		action: () => {
< 			copyToClipboard(`:${props.emoji.name}:`);
< 			os.success();
< 		},
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         type: "label",
>         text: ":" + props.emoji.name + ":",
>       },
>       {
>         text: i18n.ts.copy,
>         icon: "fas fa-copy",
>         action: () => {
>           copyToClipboard(`:${props.emoji.name}:`);
>           os.success();
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
43,48c44,49
< 	display: flex;
< 	align-items: center;
< 	padding: 12px;
< 	text-align: left;
< 	background: var(--panel);
< 	border-radius: 8px;
---
>   display: flex;
>   align-items: center;
>   padding: 12px;
>   text-align: left;
>   background: var(--panel);
>   border-radius: 8px;
50,52c51,53
< 	&:hover {
< 		border-color: var(--accent);
< 	}
---
>   &:hover {
>     border-color: var(--accent);
>   }
54,58c55,58
< 	> .img {
< 		width: 42px;
< 		height: 42px;
< 		object-fit: contain;
< 	}
---
>   > .img {
>     width: 42px;
>     height: 42px;
>   }
60,63c60,63
< 	> .body {
< 		padding: 0 0 0 8px;
< 		white-space: nowrap;
< 		overflow: hidden;
---
>   > .body {
>     padding: 0 0 0 8px;
>     white-space: nowrap;
>     overflow: hidden;
65,68c65,68
< 		> .name {
< 			text-overflow: ellipsis;
< 			overflow: hidden;
< 		}
---
>     > .name {
>       text-overflow: ellipsis;
>       overflow: hidden;
>     }
70,76c70,76
< 		> .info {
< 			opacity: 0.5;
< 			font-size: 0.9em;
< 			text-overflow: ellipsis;
< 			overflow: hidden;
< 		}
< 	}
---
>     > .info {
>       opacity: 0.5;
>       font-size: 0.9em;
>       text-overflow: ellipsis;
>       overflow: hidden;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/explore.featured.vue RiricaV13/pages/explore.featured.vue
2,9c2,9
< <MkSpacer :content-max="800">
< 	<MkTab v-model="tab" style="margin-bottom: var(--margin);">
< 		<option value="notes">{{ i18n.ts.notes }}</option>
< 		<option value="polls">{{ i18n.ts.poll }}</option>
< 	</MkTab>
< 	<XNotes v-if="tab === 'notes'" :pagination="paginationForNotes"/>
< 	<XNotes v-else-if="tab === 'polls'" :pagination="paginationForPolls"/>
< </MkSpacer>
---
>   <MkSpacer :content-max="800">
>     <MkTab v-model="tab" style="margin-bottom: var(--margin)">
>       <option value="notes">{{ i18n.ts.notes }}</option>
>       <option value="polls">{{ i18n.ts.poll }}</option>
>     </MkTab>
>     <XNotes v-if="tab === 'notes'" :pagination="paginationForNotes" />
>     <XNotes v-else-if="tab === 'polls'" :pagination="paginationForPolls" />
>   </MkSpacer>
13,15c13,15
< import XNotes from '@/components/MkNotes.vue';
< import MkTab from '@/components/MkTab.vue';
< import { i18n } from '@/i18n';
---
> import XNotes from "@/components/MkNotes.vue";
> import MkTab from "@/components/MkTab.vue";
> import { i18n } from "@/i18n";
18,20c18,20
< 	endpoint: 'notes/featured' as const,
< 	limit: 10,
< 	offsetMode: true,
---
>   endpoint: "notes/featured" as const,
>   limit: 10,
>   offsetMode: true,
24,26c24,26
< 	endpoint: 'notes/polls/recommendation' as const,
< 	limit: 10,
< 	offsetMode: true,
---
>   endpoint: "notes/polls/recommendation" as const,
>   limit: 10,
>   offsetMode: true,
29c29
< let tab = $ref('notes');
---
> let tab = $ref("notes");
diff --color=auto -r misskeyV13/packages/frontend/src/pages/explore.users.vue RiricaV13/pages/explore.users.vue
2,29c2,44
< <MkSpacer :content-max="1200">
< 	<MkTab v-model="origin" style="margin-bottom: var(--margin);">
< 		<option value="local">{{ i18n.ts.local }}</option>
< 		<option value="remote">{{ i18n.ts.remote }}</option>
< 	</MkTab>
< 	<div v-if="origin === 'local'">
< 		<template v-if="tag == null">
< 			<MkFoldableSection class="_margin" persist-key="explore-pinned-users">
< 				<template #header><i class="fas fa-bookmark ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.pinnedUsers }}</template>
< 				<XUserList :pagination="pinnedUsers"/>
< 			</MkFoldableSection>
< 			<MkFoldableSection class="_margin" persist-key="explore-popular-users">
< 				<template #header><i class="fas fa-chart-line ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.popularUsers }}</template>
< 				<XUserList :pagination="popularUsers"/>
< 			</MkFoldableSection>
< 			<MkFoldableSection class="_margin" persist-key="explore-recently-updated-users">
< 				<template #header><i class="fas fa-comment-alt ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.recentlyUpdatedUsers }}</template>
< 				<XUserList :pagination="recentlyUpdatedUsers"/>
< 			</MkFoldableSection>
< 			<MkFoldableSection class="_margin" persist-key="explore-recently-registered-users">
< 				<template #header><i class="ti ti-plus ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.recentlyRegisteredUsers }}</template>
< 				<XUserList :pagination="recentlyRegisteredUsers"/>
< 			</MkFoldableSection>
< 		</template>
< 	</div>
< 	<div v-else>
< 		<MkFoldableSection ref="tagsEl" :foldable="true" :expanded="false" class="_margin">
< 			<template #header><i class="ti ti-hash ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.popularTags }}</template>
---
>   <MkSpacer :content-max="1200">
>     <MkTab v-model="origin" style="margin-bottom: var(--margin)">
>       <option value="local">{{ i18n.ts.local }}</option>
>       <option value="remote">{{ i18n.ts.remote }}</option>
>     </MkTab>
>     <div v-if="origin === 'local'">
>       <template v-if="tag == null">
>         <MkFolder class="_gap" persist-key="explore-pinned-users">
>           <template #header
>             ><i class="fas fa-bookmark fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.pinnedUsers }}</template
>           >
>           <XUserList :pagination="pinnedUsers" />
>         </MkFolder>
>         <MkFolder class="_gap" persist-key="explore-popular-users">
>           <template #header
>             ><i class="fas fa-chart-line fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.popularUsers }}</template
>           >
>           <XUserList :pagination="popularUsers" />
>         </MkFolder>
>         <MkFolder class="_gap" persist-key="explore-recently-updated-users">
>           <template #header
>             ><i class="fas fa-comment-alt fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.recentlyUpdatedUsers }}</template
>           >
>           <XUserList :pagination="recentlyUpdatedUsers" />
>         </MkFolder>
>         <MkFolder class="_gap" persist-key="explore-recently-registered-users">
>           <template #header
>             ><i class="fas fa-plus fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.recentlyRegisteredUsers }}</template
>           >
>           <XUserList :pagination="recentlyRegisteredUsers" />
>         </MkFolder>
>       </template>
>     </div>
>     <div v-else>
>       <MkFolder ref="tagsEl" :foldable="true" :expanded="false" class="_gap">
>         <template #header
>           ><i class="fas fa-hashtag fa-fw" style="margin-right: 0.5em"></i
>           >{{ i18n.ts.popularTags }}</template
>         >
31,35c46,61
< 			<div class="vxjfqztj">
< 				<MkA v-for="tag in tagsLocal" :key="'local:' + tag.tag" :to="`/explore/tags/${tag.tag}`" class="local">{{ tag.tag }}</MkA>
< 				<MkA v-for="tag in tagsRemote" :key="'remote:' + tag.tag" :to="`/explore/tags/${tag.tag}`">{{ tag.tag }}</MkA>
< 			</div>
< 		</MkFoldableSection>
---
>         <div class="vxjfqztj">
>           <MkA
>             v-for="tag in tagsLocal"
>             :key="'local:' + tag.tag"
>             :to="`/explore/tags/${tag.tag}`"
>             class="local"
>             >{{ tag.tag }}</MkA
>           >
>           <MkA
>             v-for="tag in tagsRemote"
>             :key="'remote:' + tag.tag"
>             :to="`/explore/tags/${tag.tag}`"
>             >{{ tag.tag }}</MkA
>           >
>         </div>
>       </MkFolder>
37,40c63,69
< 		<MkFoldableSection v-if="tag != null" :key="`${tag}`" class="_margin">
< 			<template #header><i class="ti ti-hash ti-fw" style="margin-right: 0.5em;"></i>{{ tag }}</template>
< 			<XUserList :pagination="tagUsers"/>
< 		</MkFoldableSection>
---
>       <MkFolder v-if="tag != null" :key="`${tag}`" class="_gap">
>         <template #header
>           ><i class="fas fa-hashtag fa-fw" style="margin-right: 0.5em"></i
>           >{{ tag }}</template
>         >
>         <XUserList :pagination="tagUsers" />
>       </MkFolder>
42,57c71,95
< 		<template v-if="tag == null">
< 			<MkFoldableSection class="_margin">
< 				<template #header><i class="fas fa-chart-line ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.popularUsers }}</template>
< 				<XUserList :pagination="popularUsersF"/>
< 			</MkFoldableSection>
< 			<MkFoldableSection class="_margin">
< 				<template #header><i class="fas fa-comment-alt ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.recentlyUpdatedUsers }}</template>
< 				<XUserList :pagination="recentlyUpdatedUsersF"/>
< 			</MkFoldableSection>
< 			<MkFoldableSection class="_margin">
< 				<template #header><i class="fas fa-rocket ti-fw" style="margin-right: 0.5em;"></i>{{ i18n.ts.recentlyDiscoveredUsers }}</template>
< 				<XUserList :pagination="recentlyRegisteredUsersF"/>
< 			</MkFoldableSection>
< 		</template>
< 	</div>
< </MkSpacer>
---
>       <template v-if="tag == null">
>         <MkFolder class="_gap">
>           <template #header
>             ><i class="fas fa-chart-line fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.popularUsers }}</template
>           >
>           <XUserList :pagination="popularUsersF" />
>         </MkFolder>
>         <MkFolder class="_gap">
>           <template #header
>             ><i class="fas fa-comment-alt fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.recentlyUpdatedUsers }}</template
>           >
>           <XUserList :pagination="recentlyUpdatedUsersF" />
>         </MkFolder>
>         <MkFolder class="_gap">
>           <template #header
>             ><i class="fas fa-rocket fa-fw" style="margin-right: 0.5em"></i
>             >{{ i18n.ts.recentlyDiscoveredUsers }}</template
>           >
>           <XUserList :pagination="recentlyRegisteredUsersF" />
>         </MkFolder>
>       </template>
>     </div>
>   </MkSpacer>
61,68c99,106
< import { computed, watch } from 'vue';
< import XUserList from '@/components/MkUserList.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkTab from '@/components/MkTab.vue';
< import number from '@/filters/number';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
---
> import { computed, watch } from "vue";
> import XUserList from "@/components/MkUserList.vue";
> import MkFolder from "@/components/MkFolder.vue";
> import MkTab from "@/components/MkTab.vue";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
71c109
< 	tag?: string;
---
>   tag?: string;
74,75c112,113
< let origin = $ref('local');
< let tagsEl = $shallowRef<InstanceType<typeof MkFoldableSection>>();
---
> let origin = $ref("local");
> let tagsEl = $ref<InstanceType<typeof MkFolder>>();
79,81c117,122
< watch(() => props.tag, () => {
< 	if (tagsEl) tagsEl.toggleContent(props.tag == null);
< });
---
> watch(
>   () => props.tag,
>   () => {
>     if (tagsEl) tagsEl.toggleContent(props.tag == null);
>   }
> );
84,90c125,131
< 	endpoint: 'hashtags/users' as const,
< 	limit: 30,
< 	params: {
< 		tag: props.tag,
< 		origin: 'combined',
< 		sort: '+follower',
< 	},
---
>   endpoint: "hashtags/users" as const,
>   limit: 30,
>   params: {
>     tag: props.tag,
>     origin: "combined",
>     sort: "+follower",
>   },
93,120c134,191
< const pinnedUsers = { endpoint: 'pinned-users' };
< const popularUsers = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	state: 'alive',
< 	origin: 'local',
< 	sort: '+follower',
< } };
< const recentlyUpdatedUsers = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	origin: 'local',
< 	sort: '+updatedAt',
< } };
< const recentlyRegisteredUsers = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	origin: 'local',
< 	state: 'alive',
< 	sort: '+createdAt',
< } };
< const popularUsersF = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	state: 'alive',
< 	origin: 'remote',
< 	sort: '+follower',
< } };
< const recentlyUpdatedUsersF = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	origin: 'combined',
< 	sort: '+updatedAt',
< } };
< const recentlyRegisteredUsersF = { endpoint: 'users', limit: 10, noPaging: true, params: {
< 	origin: 'combined',
< 	sort: '+createdAt',
< } };
---
> const pinnedUsers = { endpoint: "pinned-users" };
> const popularUsers = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     state: "alive",
>     origin: "local",
>     sort: "+follower",
>   },
> };
> const recentlyUpdatedUsers = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     origin: "local",
>     sort: "+updatedAt",
>   },
> };
> const recentlyRegisteredUsers = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     origin: "local",
>     state: "alive",
>     sort: "+createdAt",
>   },
> };
> const popularUsersF = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     state: "alive",
>     origin: "remote",
>     sort: "+follower",
>   },
> };
> const recentlyUpdatedUsersF = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     origin: "combined",
>     sort: "+updatedAt",
>   },
> };
> const recentlyRegisteredUsersF = {
>   endpoint: "users",
>   limit: 10,
>   noPaging: true,
>   params: {
>     origin: "combined",
>     sort: "+createdAt",
>   },
> };
122,127c193,198
< os.api('hashtags/list', {
< 	sort: '+attachedLocalUsers',
< 	attachedToLocalUserOnly: true,
< 	limit: 30,
< }).then(tags => {
< 	tagsLocal = tags;
---
> os.api("hashtags/list", {
>   sort: "+attachedLocalUsers",
>   attachedToLocalUserOnly: true,
>   limit: 30,
> }).then((tags) => {
>   tagsLocal = tags;
129,134c200,205
< os.api('hashtags/list', {
< 	sort: '+attachedRemoteUsers',
< 	attachedToRemoteUserOnly: true,
< 	limit: 30,
< }).then(tags => {
< 	tagsRemote = tags;
---
> os.api("hashtags/list", {
>   sort: "+attachedRemoteUsers",
>   attachedToRemoteUserOnly: true,
>   limit: 30,
> }).then((tags) => {
>   tagsRemote = tags;
140,141c211,212
< 	> * {
< 		margin-right: 16px;
---
>   > * {
>     margin-right: 16px;
143,146c214,217
< 		&.local {
< 			font-weight: bold;
< 		}
< 	}
---
>     &.local {
>       font-weight: bold;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/explore.vue RiricaV13/pages/explore.vue
2,23c2,33
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<div class="lznhrdub">
< 		<div v-if="tab === 'featured'">
< 			<XFeatured/>
< 		</div>
< 		<div v-else-if="tab === 'users'">
< 			<XUsers/>
< 		</div>
< 		<div v-else-if="tab === 'search'">
< 			<MkSpacer :content-max="1200">
< 				<div>
< 					<MkInput v-model="searchQuery" :debounce="true" type="search">
< 						<template #prefix><i class="ti ti-search"></i></template>
< 						<template #label>{{ i18n.ts.searchUser }}</template>
< 					</MkInput>
< 					<MkRadios v-model="searchOrigin">
< 						<option value="combined">{{ i18n.ts.all }}</option>
< 						<option value="local">{{ i18n.ts.local }}</option>
< 						<option value="remote">{{ i18n.ts.remote }}</option>
< 					</MkRadios>
< 				</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <div class="lznhrdub">
>       <div v-if="tab === 'featured'">
>         <XFeatured />
>       </div>
>       <div v-else-if="tab === 'users'">
>         <XUsers />
>       </div>
>       <div v-else-if="tab === 'search'">
>         <MkSpacer :content-max="1200">
>           <div>
>             <MkInput
>               v-model="searchQuery"
>               :debounce="true"
>               type="search"
>               class="_formBlock"
>             >
>               <template #prefix><i class="fas fa-search"></i></template>
>               <template #label>{{ i18n.ts.searchUser }}</template>
>             </MkInput>
>             <MkRadios v-model="searchOrigin" class="_formBlock">
>               <option value="combined">{{ i18n.ts.all }}</option>
>               <option value="local">{{ i18n.ts.local }}</option>
>               <option value="remote">{{ i18n.ts.remote }}</option>
>             </MkRadios>
>           </div>
25,29c35,44
< 				<XUserList v-if="searchQuery" ref="searchEl" class="_margin" :pagination="searchPagination"/>
< 			</MkSpacer>
< 		</div>
< 	</div>
< </MkStickyContainer>
---
>           <XUserList
>             v-if="searchQuery"
>             ref="searchEl"
>             class="_gap"
>             :pagination="searchPagination"
>           />
>         </MkSpacer>
>       </div>
>     </div>
>   </MkStickyContainer>
33,44c48,59
< import { computed, watch } from 'vue';
< import XFeatured from './explore.featured.vue';
< import XUsers from './explore.users.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import number from '@/filters/number';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import XUserList from '@/components/MkUserList.vue';
---
> import { computed, watch } from "vue";
> import XFeatured from "./explore.featured.vue";
> import XUsers from "./explore.users.vue";
> import MkFolder from "@/components/MkFolder.vue";
> import MkInput from "@/components/form/input.vue";
> import MkRadios from "@/components/form/radios.vue";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import XUserList from "@/components/MkUserList.vue";
46,51c61,63
< const props = withDefaults(defineProps<{
< 	tag?: string;
< 	initialTab?: string;
< }>(), {
< 	initialTab: 'featured',
< });
---
> const props = defineProps<{
>   tag?: string;
> }>();
53,54c65,66
< let tab = $ref(props.initialTab);
< let tagsEl = $shallowRef<InstanceType<typeof MkFoldableSection>>();
---
> let tab = $ref("featured");
> let tagsEl = $ref<InstanceType<typeof MkFolder>>();
56c68
< let searchOrigin = $ref('combined');
---
> let searchOrigin = $ref("combined");
58,60c70,75
< watch(() => props.tag, () => {
< 	if (tagsEl) tagsEl.toggleContent(props.tag == null);
< });
---
> watch(
>   () => props.tag,
>   () => {
>     if (tagsEl) tagsEl.toggleContent(props.tag == null);
>   }
> );
63,68c78,87
< 	endpoint: 'users/search' as const,
< 	limit: 10,
< 	params: computed(() => (searchQuery && searchQuery !== '') ? {
< 		query: searchQuery,
< 		origin: searchOrigin,
< 	} : null),
---
>   endpoint: "users/search" as const,
>   limit: 10,
>   params: computed(() =>
>     searchQuery && searchQuery !== ""
>       ? {
>           query: searchQuery,
>           origin: searchOrigin,
>         }
>       : null
>   ),
73,84c92,107
< const headerTabs = $computed(() => [{
< 	key: 'featured',
< 	icon: 'ti ti-bolt',
< 	title: i18n.ts.featured,
< }, {
< 	key: 'users',
< 	icon: 'ti ti-users',
< 	title: i18n.ts.users,
< }, {
< 	key: 'search',
< 	title: i18n.ts.search,
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "featured",
>     icon: "fas fa-bolt",
>     title: i18n.ts.featured,
>   },
>   {
>     key: "users",
>     icon: "fas fa-users",
>     title: i18n.ts.users,
>   },
>   {
>     key: "search",
>     title: i18n.ts.search,
>   },
> ]);
86,89c109,114
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.explore,
< 	icon: 'ti ti-hash',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.explore,
>     icon: "fas fa-hashtag",
>   }))
> );
diff --color=auto -r misskeyV13/packages/frontend/src/pages/favorites.vue RiricaV13/pages/favorites.vue
2,11c2,11
< <MkStickyContainer>
< 	<template #header><MkPageHeader/></template>
< 	<MkSpacer :content-max="800">
< 		<MkPagination :pagination="pagination">
< 			<template #empty>
< 				<div class="_fullinfo">
< 					<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 					<div>{{ i18n.ts.noNotes }}</div>
< 				</div>
< 			</template>
---
>   <MkStickyContainer>
>     <template #header><MkPageHeader /></template>
>     <MkSpacer :content-max="800">
>       <MkPagination ref="pagingComponent" :pagination="pagination">
>         <template #empty>
>           <div class="_fullinfo">
>             <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>             <div>{{ i18n.ts.noNotes }}</div>
>           </div>
>         </template>
13,20c13,26
< 			<template #default="{ items }">
< 				<MkDateSeparatedList v-slot="{ item }" :items="items" :direction="'down'" :no-gap="false" :ad="false">
< 					<XNote :key="item.id" :note="item.note" :class="$style.note"/>
< 				</MkDateSeparatedList>
< 			</template>
< 		</MkPagination>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <template #default="{ items }">
>           <XList
>             v-slot="{ item }"
>             :items="items"
>             :direction="'down'"
>             :no-gap="false"
>             :ad="false"
>           >
>             <XNote :key="item.id" :note="item.note" :class="$style.note" />
>           </XList>
>         </template>
>       </MkPagination>
>     </MkSpacer>
>   </MkStickyContainer>
24,29c30,35
< import { ref } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import XNote from '@/components/MkNote.vue';
< import MkDateSeparatedList from '@/components/MkDateSeparatedList.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref } from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import XNote from "@/components/MkNote.vue";
> import XList from "@/components/MkDateSeparatedList.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
32,33c38,39
< 	endpoint: 'i/favorites' as const,
< 	limit: 10,
---
>   endpoint: "i/favorites" as const,
>   limit: 10,
35a42,43
> const pagingComponent = ref<InstanceType<typeof MkPagination>>();
> 
37,38c45,46
< 	title: i18n.ts.favorites,
< 	icon: 'ti ti-star',
---
>   title: i18n.ts.favorites,
>   icon: "fas fa-star",
44,45c52,53
< 	background: var(--panel);
< 	border-radius: var(--radius);
---
>   background: var(--panel);
>   border-radius: var(--radius);
Only in misskeyV13/packages/frontend/src/pages: flash
diff --color=auto -r misskeyV13/packages/frontend/src/pages/follow-requests.vue RiricaV13/pages/follow-requests.vue
2,34c2,59
< <MkStickyContainer>
< 	<template #header><MkPageHeader/></template>
< 	<MkSpacer :content-max="800">
< 		<MkPagination ref="paginationComponent" :pagination="pagination">
< 			<template #empty>
< 				<div class="_fullinfo">
< 					<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 					<div>{{ i18n.ts.noFollowRequests }}</div>
< 				</div>
< 			</template>
< 			<template #default="{items}">
< 				<div class="mk-follow-requests">
< 					<div v-for="req in items" :key="req.id" class="user _panel">
< 						<MkAvatar class="avatar" :user="req.follower" indicator link preview/>
< 						<div class="body">
< 							<div class="name">
< 								<MkA v-user-preview="req.follower.id" class="name" :to="userPage(req.follower)"><MkUserName :user="req.follower"/></MkA>
< 								<p class="acct">@{{ acct(req.follower) }}</p>
< 							</div>
< 							<div v-if="req.follower.description" class="description" :title="req.follower.description">
< 								<Mfm :text="req.follower.description" :is-note="false" :author="req.follower" :i="$i" :plain="true" :nowrap="true"/>
< 							</div>
< 							<div class="actions">
< 								<button class="_button" @click="accept(req.follower)"><i class="ti ti-check"></i></button>
< 								<button class="_button" @click="reject(req.follower)"><i class="ti ti-x"></i></button>
< 							</div>
< 						</div>
< 					</div>
< 				</div>
< 			</template>
< 		</MkPagination>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header><MkPageHeader /></template>
>     <MkSpacer :content-max="800">
>       <MkPagination ref="paginationComponent" :pagination="pagination">
>         <template #empty>
>           <div class="_fullinfo">
>             <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>             <div>{{ i18n.ts.noFollowRequests }}</div>
>           </div>
>         </template>
>         <template #default="{ items }">
>           <div class="mk-follow-requests">
>             <div v-for="req in items" :key="req.id" class="user _panel">
>               <MkAvatar
>                 class="avatar"
>                 :user="req.follower"
>                 :show-indicator="true"
>               />
>               <div class="body">
>                 <div class="name">
>                   <MkA
>                     v-user-preview="req.follower.id"
>                     class="name"
>                     :to="userPage(req.follower)"
>                     ><MkUserName :user="req.follower"
>                   /></MkA>
>                   <p class="acct">@{{ acct(req.follower) }}</p>
>                 </div>
>                 <div
>                   v-if="req.follower.description"
>                   class="description"
>                   :title="req.follower.description"
>                 >
>                   <Mfm
>                     :text="req.follower.description"
>                     :is-note="false"
>                     :author="req.follower"
>                     :i="$i"
>                     :custom-emojis="req.follower.emojis"
>                     :plain="true"
>                     :nowrap="true"
>                   />
>                 </div>
>                 <div class="actions">
>                   <button class="_button" @click="accept(req.follower)">
>                     <i class="fas fa-check"></i>
>                   </button>
>                   <button class="_button" @click="reject(req.follower)">
>                     <i class="fas fa-times"></i>
>                   </button>
>                 </div>
>               </div>
>             </div>
>           </div>
>         </template>
>       </MkPagination>
>     </MkSpacer>
>   </MkStickyContainer>
38,43c63,68
< import { shallowRef, computed } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import { userPage, acct } from '@/filters/user';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref, computed } from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import { userPage, acct } from "@/filters/user";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
45c70
< const paginationComponent = shallowRef<InstanceType<typeof MkPagination>>();
---
> const paginationComponent = ref<InstanceType<typeof MkPagination>>();
48,49c73,74
< 	endpoint: 'following/requests/list' as const,
< 	limit: 10,
---
>   endpoint: "following/requests/list" as const,
>   limit: 10,
53,55c78,80
< 	os.api('following/requests/accept', { userId: user.id }).then(() => {
< 		paginationComponent.value.reload();
< 	});
---
>   os.api("following/requests/accept", { userId: user.id }).then(() => {
>     paginationComponent.value.reload();
>   });
59,61c84,86
< 	os.api('following/requests/reject', { userId: user.id }).then(() => {
< 		paginationComponent.value.reload();
< 	});
---
>   os.api("following/requests/reject", { userId: user.id }).then(() => {
>     paginationComponent.value.reload();
>   });
68,71c93,98
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.followRequests,
< 	icon: 'ti ti-user-plus',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.followRequests,
>     icon: "fas fa-user-clock",
>   }))
> );
76,78c103,105
< 	> .user {
< 		display: flex;
< 		padding: 16px;
---
>   > .user {
>     display: flex;
>     padding: 16px;
80,87c107,114
< 		> .avatar {
< 			display: block;
< 			flex-shrink: 0;
< 			margin: 0 12px 0 0;
< 			width: 42px;
< 			height: 42px;
< 			border-radius: 8px;
< 		}
---
>     > .avatar {
>       display: block;
>       flex-shrink: 0;
>       margin: 0 12px 0 0;
>       width: 42px;
>       height: 42px;
>       border-radius: 8px;
>     }
89,92c116,119
< 		> .body {
< 			display: flex;
< 			width: calc(100% - 54px);
< 			position: relative;
---
>     > .body {
>       display: flex;
>       width: calc(100% - 54px);
>       position: relative;
94,95c121,122
< 			> .name {
< 				width: 45%;
---
>       > .name {
>         width: 45%;
97,99c124,126
< 				@media (max-width: 500px) {
< 					width: 100%;
< 				}
---
>         @media (max-width: 500px) {
>           width: 100%;
>         }
101,108c128,135
< 				> .name,
< 				> .acct {
< 					display: block;
< 					white-space: nowrap;
< 					text-overflow: ellipsis;
< 					overflow: hidden;
< 					margin: 0;
< 				}
---
>         > .name,
>         > .acct {
>           display: block;
>           white-space: nowrap;
>           text-overflow: ellipsis;
>           overflow: hidden;
>           margin: 0;
>         }
110,113c137,140
< 				> .name {
< 					font-size: 16px;
< 					line-height: 24px;
< 				}
---
>         > .name {
>           font-size: 16px;
>           line-height: 24px;
>         }
115,120c142,147
< 				> .acct {
< 					font-size: 15px;
< 					line-height: 16px;
< 					opacity: 0.7;
< 				}
< 			}
---
>         > .acct {
>           font-size: 15px;
>           line-height: 16px;
>           opacity: 0.7;
>         }
>       }
122,132c149,159
< 			> .description {
< 				width: 55%;
< 				line-height: 42px;
< 				white-space: nowrap;
< 				overflow: hidden;
< 				text-overflow: ellipsis;
< 				opacity: 0.7;
< 				font-size: 14px;
< 				padding-right: 40px;
< 				padding-left: 8px;
< 				box-sizing: border-box;
---
>       > .description {
>         width: 55%;
>         line-height: 42px;
>         white-space: nowrap;
>         overflow: hidden;
>         text-overflow: ellipsis;
>         opacity: 0.7;
>         font-size: 14px;
>         padding-right: 40px;
>         padding-left: 8px;
>         box-sizing: border-box;
134,137c161,164
< 				@media (max-width: 500px) {
< 					display: none;
< 				}
< 			}
---
>         @media (max-width: 500px) {
>           display: none;
>         }
>       }
139,144c166,171
< 			> .actions {
< 				position: absolute;
< 				top: 0;
< 				bottom: 0;
< 				right: 0;
< 				margin: auto 0;
---
>       > .actions {
>         position: absolute;
>         top: 0;
>         bottom: 0;
>         right: 0;
>         margin: auto 0;
146,151c173,178
< 				> button {
< 					padding: 12px;
< 				}
< 			}
< 		}
< 	}
---
>         > button {
>           padding: 12px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/follow.vue RiricaV13/pages/follow.vue
2,3c2
< <div class="mk-follow-page">
< </div>
---
>   <div class="mk-follow-page"></div>
7,11c6,10
< import { } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import * as os from '@/os';
< import { mainRouter } from '@/router';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as Acct from "misskey-js/built/acct";
> import * as os from "@/os";
> import { mainRouter } from "@/router";
> import { i18n } from "@/i18n";
14,17c13,16
< 	const { canceled } = await os.confirm({
< 		type: 'question',
< 		text: i18n.t('followConfirm', { name: user.name || user.username }),
< 	});
---
>   const { canceled } = await os.confirm({
>     type: "question",
>     text: i18n.t("followConfirm", { name: user.name || user.username }),
>   });
19,26c18,25
< 	if (canceled) {
< 		window.close();
< 		return;
< 	}
< 	
< 	os.apiWithDialog('following/create', {
< 		userId: user.id,
< 	});
---
>   if (canceled) {
>     window.close();
>     return;
>   }
> 
>   os.apiWithDialog("following/create", {
>     userId: user.id,
>   });
29c28
< const acct = new URL(location.href).searchParams.get('acct');
---
> const acct = new URL(location.href).searchParams.get("acct");
31c30
< 	throw new Error('acct required');
---
>   throw new Error("acct required");
36,53c35,52
< if (acct.startsWith('https://')) {
< 	promise = os.api('ap/show', {
< 		uri: acct,
< 	});
< 	promise.then(res => {
< 		if (res.type === 'User') {
< 			follow(res.object);
< 		} else if (res.type === 'Note') {
< 			mainRouter.push(`/notes/${res.object.id}`);
< 		} else {
< 			os.alert({
< 				type: 'error',
< 				text: 'Not a user',
< 			}).then(() => {
< 				window.close();
< 			});
< 		}
< 	});
---
> if (acct.startsWith("https://")) {
>   promise = os.api("ap/show", {
>     uri: acct,
>   });
>   promise.then((res) => {
>     if (res.type === "User") {
>       follow(res.object);
>     } else if (res.type === "Note") {
>       mainRouter.push(`/notes/${res.object.id}`);
>     } else {
>       os.alert({
>         type: "error",
>         text: "Not a user",
>       }).then(() => {
>         window.close();
>       });
>     }
>   });
55,58c54,57
< 	promise = os.api('users/show', Acct.parse(acct));
< 	promise.then(user => {
< 		follow(user);
< 	});
---
>   promise = os.api("users/show", Acct.parse(acct));
>   promise.then((user) => {
>     follow(user);
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/gallery/edit.vue RiricaV13/pages/gallery/edit.vue
2,8c2,10
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<MkInput v-model="title">
< 				<template #label>{{ i18n.ts.title }}</template>
< 			</MkInput>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <FormInput v-model="title">
>           <template #label>{{ i18n.ts.title }}</template>
>         </FormInput>
10,12c12,14
< 			<MkTextarea v-model="description" :max="500">
< 				<template #label>{{ i18n.ts.description }}</template>
< 			</MkTextarea>
---
>         <FormTextarea v-model="description" :max="500">
>           <template #label>{{ i18n.ts.description }}</template>
>         </FormTextarea>
14,20c16,37
< 			<div class="">
< 				<div v-for="file in files" :key="file.id" class="wqugxsfx" :style="{ backgroundImage: file ? `url(${ file.thumbnailUrl })` : null }">
< 					<div class="name">{{ file.name }}</div>
< 					<button v-tooltip="i18n.ts.remove" class="remove _button" @click="remove(file)"><i class="ti ti-x"></i></button>
< 				</div>
< 				<MkButton primary @click="selectFile"><i class="ti ti-plus"></i> {{ i18n.ts.attachFile }}</MkButton>
< 			</div>
---
>         <div class="">
>           <div
>             v-for="file in files"
>             :key="file.id"
>             class="wqugxsfx"
>             :style="{
>               backgroundImage: file ? `url(${file.thumbnailUrl})` : null,
>             }"
>           >
>             <div class="name">{{ file.name }}</div>
>             <button
>               v-tooltip="i18n.ts.remove"
>               class="remove _button"
>               @click="remove(file)"
>             >
>               <i class="fas fa-times"></i>
>             </button>
>           </div>
>           <FormButton primary @click="selectFile"
>             ><i class="fas fa-plus"></i> {{ i18n.ts.attachFile }}</FormButton
>           >
>         </div>
22c39,41
< 			<MkSwitch v-model="isSensitive">{{ i18n.ts.markAsSensitive }}</MkSwitch>
---
>         <FormSwitch v-model="isSensitive">{{
>           i18n.ts.markAsSensitive
>         }}</FormSwitch>
24,25c43,48
< 			<MkButton v-if="postId" primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 			<MkButton v-else primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.publish }}</MkButton>
---
>         <FormButton v-if="postId" primary @click="save"
>           ><i class="fas fa-save"></i> {{ i18n.ts.save }}</FormButton
>         >
>         <FormButton v-else primary @click="save"
>           ><i class="fas fa-save"></i> {{ i18n.ts.publish }}</FormButton
>         >
27,30c50,55
< 			<MkButton v-if="postId" danger @click="del"><i class="ti ti-trash"></i> {{ i18n.ts.delete }}</MkButton>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <FormButton v-if="postId" danger @click="del"
>           ><i class="fas fa-trash-alt"></i> {{ i18n.ts.delete }}</FormButton
>         >
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
34,44c59,69
< import { computed, inject, watch } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import { selectFiles } from '@/scripts/select-file';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, inject, watch } from "vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInput from "@/components/form/input.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import { selectFiles } from "@/scripts/select-file";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
49c74
< 	postId?: string;
---
>   postId?: string;
59,61c84,86
< 	selectFiles(evt.currentTarget ?? evt.target, null).then(selected => {
< 		files = files.concat(selected);
< 	});
---
>   selectFiles(evt.currentTarget ?? evt.target, null).then((selected) => {
>     files = files.concat(selected);
>   });
65c90
< 	files = files.filter(f => f.id !== file.id);
---
>   files = files.filter((f) => f.id !== file.id);
69,86c94,111
< 	if (props.postId) {
< 		await os.apiWithDialog('gallery/posts/update', {
< 			postId: props.postId,
< 			title: title,
< 			description: description,
< 			fileIds: files.map(file => file.id),
< 			isSensitive: isSensitive,
< 		});
< 		router.push(`/gallery/${props.postId}`);
< 	} else {
< 		const created = await os.apiWithDialog('gallery/posts/create', {
< 			title: title,
< 			description: description,
< 			fileIds: files.map(file => file.id),
< 			isSensitive: isSensitive,
< 		});
< 		router.push(`/gallery/${created.id}`);
< 	}
---
>   if (props.postId) {
>     await os.apiWithDialog("gallery/posts/update", {
>       postId: props.postId,
>       title: title,
>       description: description,
>       fileIds: files.map((file) => file.id),
>       isSensitive: isSensitive,
>     });
>     router.push(`/gallery/${props.postId}`);
>   } else {
>     const created = await os.apiWithDialog("gallery/posts/create", {
>       title: title,
>       description: description,
>       fileIds: files.map((file) => file.id),
>       isSensitive: isSensitive,
>     });
>     router.push(`/gallery/${created.id}`);
>   }
90,98c115,123
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.deleteConfirm,
< 	});
< 	if (canceled) return;
< 	await os.apiWithDialog('gallery/posts/delete', {
< 		postId: props.postId,
< 	});
< 	router.push('/gallery');
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.ts.deleteConfirm,
>   });
>   if (canceled) return;
>   await os.apiWithDialog("gallery/posts/delete", {
>     postId: props.postId,
>   });
>   router.push("/gallery");
101,110c126,144
< watch(() => props.postId, () => {
< 	init = () => props.postId ? os.api('gallery/posts/show', {
< 		postId: props.postId,
< 	}).then(post => {
< 		files = post.files;
< 		title = post.title;
< 		description = post.description;
< 		isSensitive = post.isSensitive;
< 	}) : Promise.resolve(null);
< }, { immediate: true });
---
> watch(
>   () => props.postId,
>   () => {
>     init = () =>
>       props.postId
>         ? os
>             .api("gallery/posts/show", {
>               postId: props.postId,
>             })
>             .then((post) => {
>               files = post.files;
>               title = post.title;
>               description = post.description;
>               isSensitive = post.isSensitive;
>             })
>         : Promise.resolve(null);
>   },
>   { immediate: true }
> );
116,122c150,162
< definePageMetadata(computed(() => props.postId ? {
< 	title: i18n.ts.edit,
< 	icon: 'ti ti-pencil',
< } : {
< 	title: i18n.ts.postToGallery,
< 	icon: 'ti ti-pencil',
< }));
---
> definePageMetadata(
>   computed(() =>
>     props.postId
>       ? {
>           title: i18n.ts.edit,
>           icon: "fas fa-pencil-alt",
>         }
>       : {
>           title: i18n.ts.postToGallery,
>           icon: "fas fa-pencil-alt",
>         }
>   )
> );
127,131c167,171
< 	height: 200px;
< 	background-size: contain;
< 	background-position: center;
< 	background-repeat: no-repeat;
< 	position: relative;
---
>   height: 200px;
>   background-size: contain;
>   background-position: center;
>   background-repeat: no-repeat;
>   position: relative;
133,139c173,179
< 	> .name {
< 		position: absolute;
< 		top: 8px;
< 		left: 9px;
< 		padding: 8px;
< 		background: var(--panel);
< 	}
---
>   > .name {
>     position: absolute;
>     top: 8px;
>     left: 9px;
>     padding: 8px;
>     background: var(--panel);
>   }
141,147c181,187
< 	> .remove {
< 		position: absolute;
< 		top: 8px;
< 		right: 9px;
< 		padding: 8px;
< 		background: var(--panel);
< 	}
---
>   > .remove {
>     position: absolute;
>     top: 8px;
>     right: 9px;
>     padding: 8px;
>     background: var(--panel);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/gallery/index.vue RiricaV13/pages/gallery/index.vue
2,41c2,81
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="1400">
< 		<div class="_root">
< 			<div v-if="tab === 'explore'">
< 				<MkFoldableSection class="_margin">
< 					<template #header><i class="ti ti-clock"></i>{{ i18n.ts.recentPosts }}</template>
< 					<MkPagination v-slot="{items}" :pagination="recentPostsPagination" :disable-auto-load="true">
< 						<div class="vfpdbgtk">
< 							<MkGalleryPostPreview v-for="post in items" :key="post.id" :post="post" class="post"/>
< 						</div>
< 					</MkPagination>
< 				</MkFoldableSection>
< 				<MkFoldableSection class="_margin">
< 					<template #header><i class="ti ti-comet"></i>{{ i18n.ts.popularPosts }}</template>
< 					<MkPagination v-slot="{items}" :pagination="popularPostsPagination" :disable-auto-load="true">
< 						<div class="vfpdbgtk">
< 							<MkGalleryPostPreview v-for="post in items" :key="post.id" :post="post" class="post"/>
< 						</div>
< 					</MkPagination>
< 				</MkFoldableSection>
< 			</div>
< 			<div v-else-if="tab === 'liked'">
< 				<MkPagination v-slot="{items}" :pagination="likedPostsPagination">
< 					<div class="vfpdbgtk">
< 						<MkGalleryPostPreview v-for="like in items" :key="like.id" :post="like.post" class="post"/>
< 					</div>
< 				</MkPagination>
< 			</div>
< 			<div v-else-if="tab === 'my'">
< 				<MkA to="/gallery/new" class="_link" style="margin: 16px;"><i class="ti ti-plus"></i> {{ i18n.ts.postToGallery }}</MkA>
< 				<MkPagination v-slot="{items}" :pagination="myPostsPagination">
< 					<div class="vfpdbgtk">
< 						<MkGalleryPostPreview v-for="post in items" :key="post.id" :post="post" class="post"/>
< 					</div>
< 				</MkPagination>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="1400">
>       <div class="_root">
>         <div v-if="tab === 'explore'">
>           <MkFolder class="_gap">
>             <template #header
>               ><i class="fas fa-clock"></i>{{ i18n.ts.recentPosts }}</template
>             >
>             <MkPagination
>               v-slot="{ items }"
>               :pagination="recentPostsPagination"
>               :disable-auto-load="true"
>             >
>               <div class="vfpdbgtk">
>                 <MkGalleryPostPreview
>                   v-for="post in items"
>                   :key="post.id"
>                   :post="post"
>                   class="post"
>                 />
>               </div>
>             </MkPagination>
>           </MkFolder>
>           <MkFolder class="_gap">
>             <template #header
>               ><i class="fas fa-fire-alt"></i
>               >{{ i18n.ts.popularPosts }}</template
>             >
>             <MkPagination
>               v-slot="{ items }"
>               :pagination="popularPostsPagination"
>               :disable-auto-load="true"
>             >
>               <div class="vfpdbgtk">
>                 <MkGalleryPostPreview
>                   v-for="post in items"
>                   :key="post.id"
>                   :post="post"
>                   class="post"
>                 />
>               </div>
>             </MkPagination>
>           </MkFolder>
>         </div>
>         <div v-else-if="tab === 'liked'">
>           <MkPagination v-slot="{ items }" :pagination="likedPostsPagination">
>             <div class="vfpdbgtk">
>               <MkGalleryPostPreview
>                 v-for="like in items"
>                 :key="like.id"
>                 :post="like.post"
>                 class="post"
>               />
>             </div>
>           </MkPagination>
>         </div>
>         <div v-else-if="tab === 'my'">
>           <MkA to="/gallery/new" class="_link" style="margin: 16px"
>             ><i class="fas fa-plus"></i> {{ i18n.ts.postToGallery }}</MkA
>           >
>           <MkPagination v-slot="{ items }" :pagination="myPostsPagination">
>             <div class="vfpdbgtk">
>               <MkGalleryPostPreview
>                 v-for="post in items"
>                 :key="post.id"
>                 :post="post"
>                 class="post"
>               />
>             </div>
>           </MkPagination>
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
45,57c85,97
< import { computed, defineComponent, watch } from 'vue';
< import XUserList from '@/components/MkUserList.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkTab from '@/components/MkTab.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkGalleryPostPreview from '@/components/MkGalleryPostPreview.vue';
< import number from '@/filters/number';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { useRouter } from '@/router';
---
> import { computed, defineComponent, watch } from "vue";
> import XUserList from "@/components/MkUserList.vue";
> import MkFolder from "@/components/MkFolder.vue";
> import MkInput from "@/components/form/input.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkTab from "@/components/MkTab.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkGalleryPostPreview from "@/components/MkGalleryPostPreview.vue";
> import number from "@/filters/number";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import { useRouter } from "@/router";
62c102
< 	tag?: string;
---
>   tag?: string;
65c105
< let tab = $ref('explore');
---
> let tab = $ref("explore");
70,71c110,111
< 	endpoint: 'gallery/posts' as const,
< 	limit: 6,
---
>   endpoint: "gallery/posts" as const,
>   limit: 6,
74,75c114,115
< 	endpoint: 'gallery/featured' as const,
< 	limit: 5,
---
>   endpoint: "gallery/featured" as const,
>   limit: 5,
78,79c118,119
< 	endpoint: 'i/gallery/posts' as const,
< 	limit: 5,
---
>   endpoint: "i/gallery/posts" as const,
>   limit: 5,
82,83c122,123
< 	endpoint: 'i/gallery/likes' as const,
< 	limit: 5,
---
>   endpoint: "i/gallery/likes" as const,
>   limit: 5,
87,93c127,133
< 	endpoint: 'hashtags/users' as const,
< 	limit: 30,
< 	params: {
< 		tag: this.tag,
< 		origin: 'combined',
< 		sort: '+follower',
< 	},
---
>   endpoint: "hashtags/users" as const,
>   limit: 30,
>   params: {
>     tag: this.tag,
>     origin: "combined",
>     sort: "+follower",
>   },
96,98c136,141
< watch(() => props.tag, () => {
< 	if (tagsRef) tagsRef.tags.toggleContent(props.tag == null);
< });
---
> watch(
>   () => props.tag,
>   () => {
>     if (tagsRef) tagsRef.tags.toggleContent(props.tag == null);
>   }
> );
100,106c143,151
< const headerActions = $computed(() => [{
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.create,
< 	handler: () => {
< 		router.push('/gallery/new');
< 	},
< }]);
---
> const headerActions = $computed(() => [
>   {
>     icon: "fas fa-plus",
>     text: i18n.ts.create,
>     handler: () => {
>       router.push("/gallery/new");
>     },
>   },
> ]);
108,120c153,169
< const headerTabs = $computed(() => [{
< 	key: 'explore',
< 	title: i18n.ts.gallery,
< 	icon: 'ti ti-icons',
< }, {
< 	key: 'liked',
< 	title: i18n.ts._gallery.liked,
< 	icon: 'ti ti-heart',
< }, {
< 	key: 'my',
< 	title: i18n.ts._gallery.my,
< 	icon: 'ti ti-edit',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "explore",
>     title: i18n.ts.gallery,
>     icon: "fas fa-icons",
>   },
>   {
>     key: "liked",
>     title: i18n.ts._gallery.liked,
>     icon: "fas fa-heart",
>   },
>   {
>     key: "my",
>     title: i18n.ts._gallery.my,
>     icon: "fas fa-edit",
>   },
> ]);
123,124c172,173
< 	title: i18n.ts.gallery,
< 	icon: 'ti ti-icons',
---
>   title: i18n.ts.gallery,
>   icon: "fas fa-icons",
130,133c179,182
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
< 	grid-gap: 12px;
< 	margin: 0 var(--margin);
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
>   grid-gap: 12px;
>   margin: 0 var(--margin);
135,137c184,185
< 	> .post {
< 
< 	}
---
>   > .post {
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/gallery/post.vue RiricaV13/pages/gallery/post.vue
2,55c2,117
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="1000" :margin-min="16" :margin-max="32">
< 		<div class="_root">
< 			<Transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
< 				<div v-if="post" class="rkxwuolj">
< 					<div class="files">
< 						<div v-for="file in post.files" :key="file.id" class="file">
< 							<img :src="file.url"/>
< 						</div>
< 					</div>
< 					<div class="body">
< 						<div class="title">{{ post.title }}</div>
< 						<div class="description"><Mfm :text="post.description"/></div>
< 						<div class="info">
< 							<i class="ti ti-clock"></i> <MkTime :time="post.createdAt" mode="detail"/>
< 						</div>
< 						<div class="actions">
< 							<div class="like">
< 								<MkButton v-if="post.isLiked" v-tooltip="i18n.ts._gallery.unlike" class="button" primary @click="unlike()"><i class="ti ti-heart-off"></i><span v-if="post.likedCount > 0" class="count">{{ post.likedCount }}</span></MkButton>
< 								<MkButton v-else v-tooltip="i18n.ts._gallery.like" class="button" @click="like()"><i class="ti ti-heart"></i><span v-if="post.likedCount > 0" class="count">{{ post.likedCount }}</span></MkButton>
< 							</div>
< 							<div class="other">
< 								<button v-if="$i && $i.id === post.user.id" v-tooltip="i18n.ts.edit" v-click-anime class="_button" @click="edit"><i class="ti ti-pencil ti-fw"></i></button>
< 								<button v-tooltip="i18n.ts.shareWithNote" v-click-anime class="_button" @click="shareWithNote"><i class="ti ti-repeat ti-fw"></i></button>
< 								<button v-tooltip="i18n.ts.share" v-click-anime class="_button" @click="share"><i class="ti ti-share ti-fw"></i></button>
< 							</div>
< 						</div>
< 						<div class="user">
< 							<MkAvatar :user="post.user" class="avatar" link preview/>
< 							<div class="name">
< 								<MkUserName :user="post.user" style="display: block;"/>
< 								<MkAcct :user="post.user"/>
< 							</div>
< 							<MkFollowButton v-if="!$i || $i.id != post.user.id" :user="post.user" :inline="true" :transparent="false" :full="true" large class="koudoku"/>
< 						</div>
< 					</div>
< 					<MkAd :prefer="['horizontal', 'horizontal-big']"/>
< 					<MkContainer :max-height="300" :foldable="true" class="other">
< 						<template #icon><i class="ti ti-clock"></i></template>
< 						<template #header>{{ i18n.ts.recentPosts }}</template>
< 						<MkPagination v-slot="{items}" :pagination="otherPostsPagination">
< 							<div class="sdrarzaf">
< 								<MkGalleryPostPreview v-for="post in items" :key="post.id" :post="post" class="post"/>
< 							</div>
< 						</MkPagination>
< 					</MkContainer>
< 				</div>
< 				<MkError v-else-if="error" @retry="fetch()"/>
< 				<MkLoading v-else/>
< 			</Transition>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="1000" :margin-min="16" :margin-max="32">
>       <div class="_root">
>         <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>           <div v-if="post" class="rkxwuolj">
>             <div class="files">
>               <div v-for="file in post.files" :key="file.id" class="file">
>                 <img :src="file.url" />
>               </div>
>             </div>
>             <div class="body _block">
>               <div class="title">{{ post.title }}</div>
>               <div class="description"><Mfm :text="post.description" /></div>
>               <div class="info">
>                 <i class="fas fa-clock"></i>
>                 <MkTime :time="post.createdAt" mode="detail" />
>               </div>
>               <div class="actions">
>                 <div class="like">
>                   <MkButton
>                     v-if="post.isLiked"
>                     v-tooltip="i18n.ts._gallery.unlike"
>                     class="button"
>                     primary
>                     @click="unlike()"
>                     ><i class="fas fa-heart"></i
>                     ><span v-if="post.likedCount > 0" class="count">{{
>                       post.likedCount
>                     }}</span></MkButton
>                   >
>                   <MkButton
>                     v-else
>                     v-tooltip="i18n.ts._gallery.like"
>                     class="button"
>                     @click="like()"
>                     ><i class="far fa-heart"></i
>                     ><span v-if="post.likedCount > 0" class="count">{{
>                       post.likedCount
>                     }}</span></MkButton
>                   >
>                 </div>
>                 <div class="other">
>                   <button
>                     v-if="$i && $i.id === post.user.id"
>                     v-tooltip="i18n.ts.edit"
>                     v-click-anime
>                     class="_button"
>                     @click="edit"
>                   >
>                     <i class="fas fa-pencil-alt fa-fw"></i>
>                   </button>
>                   <button
>                     v-tooltip="i18n.ts.shareWithNote"
>                     v-click-anime
>                     class="_button"
>                     @click="shareWithNote"
>                   >
>                     <i class="fas fa-retweet fa-fw"></i>
>                   </button>
>                   <button
>                     v-tooltip="i18n.ts.share"
>                     v-click-anime
>                     class="_button"
>                     @click="share"
>                   >
>                     <i class="fas fa-share-alt fa-fw"></i>
>                   </button>
>                 </div>
>               </div>
>               <div class="user">
>                 <MkAvatar :user="post.user" class="avatar" />
>                 <div class="name">
>                   <MkUserName :user="post.user" style="display: block" />
>                   <MkAcct :user="post.user" />
>                 </div>
>                 <MkFollowButton
>                   v-if="!$i || $i.id != post.user.id"
>                   :user="post.user"
>                   :inline="true"
>                   :transparent="false"
>                   :full="true"
>                   large
>                   class="koudoku"
>                 />
>               </div>
>             </div>
>             <MkAd :prefer="['horizontal', 'horizontal-big']" />
>             <MkContainer :max-height="300" :foldable="true" class="other">
>               <template #header
>                 ><i class="fas fa-clock"></i>
>                 {{ i18n.ts.recentPosts }}</template
>               >
>               <MkPagination
>                 v-slot="{ items }"
>                 :pagination="otherPostsPagination"
>               >
>                 <div class="sdrarzaf">
>                   <MkGalleryPostPreview
>                     v-for="post in items"
>                     :key="post.id"
>                     :post="post"
>                     class="post"
>                   />
>                 </div>
>               </MkPagination>
>             </MkContainer>
>           </div>
>           <MkError v-else-if="error" @retry="fetch()" />
>           <MkLoading v-else />
>         </transition>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
59,70c121,132
< import { computed, defineComponent, inject, watch } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import MkContainer from '@/components/MkContainer.vue';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkGalleryPostPreview from '@/components/MkGalleryPostPreview.vue';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import { url } from '@/config';
< import { useRouter } from '@/router';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, defineComponent, inject, watch } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import MkContainer from "@/components/MkContainer.vue";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkGalleryPostPreview from "@/components/MkGalleryPostPreview.vue";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import { url } from "@/config";
> import { useRouter } from "@/router";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
75c137
< 	postId: string;
---
>   postId: string;
81,85c143,147
< 	endpoint: 'users/gallery/posts' as const,
< 	limit: 6,
< 	params: computed(() => ({
< 		userId: post.user.id,
< 	})),
---
>   endpoint: "users/gallery/posts" as const,
>   limit: 6,
>   params: computed(() => ({
>     userId: post.user.id,
>   })),
89,96c151,160
< 	post = null;
< 	os.api('gallery/posts/show', {
< 		postId: props.postId,
< 	}).then(_post => {
< 		post = _post;
< 	}).catch(_error => {
< 		error = _error;
< 	});
---
>   post = null;
>   os.api("gallery/posts/show", {
>     postId: props.postId,
>   })
>     .then((_post) => {
>       post = _post;
>     })
>     .catch((_error) => {
>       error = _error;
>     });
100,104c164,168
< 	navigator.share({
< 		title: post.title,
< 		text: post.description,
< 		url: `${url}/gallery/${post.id}`,
< 	});
---
>   navigator.share({
>     title: post.title,
>     text: post.description,
>     url: `${url}/gallery/${post.id}`,
>   });
108,110c172,174
< 	os.post({
< 		initialText: `${post.title} ${url}/gallery/${post.id}`,
< 	});
---
>   os.post({
>     initialText: `${post.title} ${url}/gallery/${post.id}`,
>   });
114,119c178,183
< 	os.apiWithDialog('gallery/posts/like', {
< 		postId: props.postId,
< 	}).then(() => {
< 		post.isLiked = true;
< 		post.likedCount++;
< 	});
---
>   os.apiWithDialog("gallery/posts/like", {
>     postId: props.postId,
>   }).then(() => {
>     post.isLiked = true;
>     post.likedCount++;
>   });
123,133c187,197
< 	const confirm = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.unlikeConfirm,
< 	});
< 	if (confirm.canceled) return;
< 	os.apiWithDialog('gallery/posts/unlike', {
< 		postId: props.postId,
< 	}).then(() => {
< 		post.isLiked = false;
< 		post.likedCount--;
< 	});
---
>   const confirm = await os.confirm({
>     type: "warning",
>     text: i18n.ts.unlikeConfirm,
>   });
>   if (confirm.canceled) return;
>   os.apiWithDialog("gallery/posts/unlike", {
>     postId: props.postId,
>   }).then(() => {
>     post.isLiked = false;
>     post.likedCount--;
>   });
137c201
< 	router.push(`/gallery/${post.id}/edit`);
---
>   router.push(`/gallery/${post.id}/edit`);
142,146c206,212
< const headerActions = $computed(() => [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.edit,
< 	handler: edit,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.edit,
>     handler: edit,
>   },
> ]);
150,153c216,225
< definePageMetadata(computed(() => post ? {
< 	title: post.title,
< 	avatar: post.user,
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     post
>       ? {
>           title: post.title,
>           avatar: post.user,
>         }
>       : null
>   )
> );
159c231
< 	transition: opacity 0.125s ease;
---
>   transition: opacity 0.125s ease;
163c235
< 	opacity: 0;
---
>   opacity: 0;
167,174c239,246
< 	> .files {
< 		> .file {
< 			> img {
< 				display: block;
< 				max-width: 100%;
< 				max-height: 500px;
< 				margin: 0 auto;
< 			}
---
>   > .files {
>     > .file {
>       > img {
>         display: block;
>         max-width: 100%;
>         max-height: 500px;
>         margin: 0 auto;
>       }
176,180c248,252
< 			& + .file {
< 				margin-top: 16px;
< 			}
< 		}
< 	}
---
>       & + .file {
>         margin-top: 16px;
>       }
>     }
>   }
182,183c254,255
< 	> .body {
< 		padding: 32px;
---
>   > .body {
>     padding: 32px;
185,189c257,261
< 		> .title {
< 			font-weight: bold;
< 			font-size: 1.2em;
< 			margin-bottom: 16px;
< 		}
---
>     > .title {
>       font-weight: bold;
>       font-size: 1.2em;
>       margin-bottom: 16px;
>     }
191,195c263,267
< 		> .info {
< 			margin-top: 16px;
< 			font-size: 90%;
< 			opacity: 0.7;
< 		}
---
>     > .info {
>       margin-top: 16px;
>       font-size: 90%;
>       opacity: 0.7;
>     }
197,202c269,274
< 		> .actions {
< 			display: flex;
< 			align-items: center;
< 			margin-top: 16px;
< 			padding: 16px 0 0 0;
< 			border-top: solid 0.5px var(--divider);
---
>     > .actions {
>       display: flex;
>       align-items: center;
>       margin-top: 16px;
>       padding: 16px 0 0 0;
>       border-top: solid 0.5px var(--divider);
204,210c276,282
< 			> .like {
< 				> .button {
< 					--accent: rgb(241 97 132);
< 					--X8: rgb(241 92 128);
< 					--buttonBg: rgb(216 71 106 / 5%);
< 					--buttonHoverBg: rgb(216 71 106 / 10%);
< 					color: #ff002f;
---
>       > .like {
>         > .button {
>           --accent: rgb(241 97 132);
>           --X8: rgb(241 92 128);
>           --buttonBg: rgb(216 71 106 / 5%);
>           --buttonHoverBg: rgb(216 71 106 / 10%);
>           color: #ff002f;
212,216c284,288
< 					::v-deep(.count) {
< 						margin-left: 0.5em;
< 					}
< 				}
< 			}
---
>           ::v-deep(.count) {
>             margin-left: 0.5em;
>           }
>         }
>       }
218,219c290,291
< 			> .other {
< 				margin-left: auto;
---
>       > .other {
>         margin-left: auto;
221,223c293,295
< 				> button {
< 					padding: 8px;
< 					margin: 0 8px;
---
>         > button {
>           padding: 8px;
>           margin: 0 8px;
225,230c297,302
< 					&:hover {
< 						color: var(--fgHighlighted);
< 					}
< 				}
< 			}
< 		}
---
>           &:hover {
>             color: var(--fgHighlighted);
>           }
>         }
>       }
>     }
232,237c304,309
< 		> .user {
< 			margin-top: 16px;
< 			padding: 16px 0 0 0;
< 			border-top: solid 0.5px var(--divider);
< 			display: flex;
< 			align-items: center;
---
>     > .user {
>       margin-top: 16px;
>       padding: 16px 0 0 0;
>       border-top: solid 0.5px var(--divider);
>       display: flex;
>       align-items: center;
239,242c311,314
< 			> .avatar {
< 				width: 52px;
< 				height: 52px;
< 			}
---
>       > .avatar {
>         width: 52px;
>         height: 52px;
>       }
244,247c316,319
< 			> .name {
< 				margin: 0 0 0 12px;
< 				font-size: 90%;
< 			}
---
>       > .name {
>         margin: 0 0 0 12px;
>         font-size: 90%;
>       }
249,253c321,325
< 			> .koudoku {
< 				margin-left: auto;
< 			}
< 		}
< 	}
---
>       > .koudoku {
>         margin-left: auto;
>       }
>     }
>   }
257,260c329,332
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
< 	grid-gap: 12px;
< 	margin: var(--margin);
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
>   grid-gap: 12px;
>   margin: var(--margin);
262,264c334,335
< 	> .post {
< 
< 	}
---
>   > .post {
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/instance-info.vue RiricaV13/pages/instance-info.vue
2,27c2,54
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer v-if="instance" :content-max="600" :margin-min="16" :margin-max="32">
< 		<div v-if="tab === 'overview'" class="_gaps_m">
< 			<div class="fnfelxur">
< 				<img :src="faviconUrl" alt="" class="icon"/>
< 				<span class="name">{{ instance.name || `(${i18n.ts.unknown})` }}</span>
< 			</div>
< 			<div style="display: flex; flex-direction: column; gap: 1em;">
< 				<MkKeyValue :copy="host" oneline>
< 					<template #key>Host</template>
< 					<template #value><span class="_monospace"><MkLink :url="`https://${host}`">{{ host }}</MkLink></span></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline>
< 					<template #key>{{ i18n.ts.software }}</template>
< 					<template #value><span class="_monospace">{{ instance.softwareName || `(${i18n.ts.unknown})` }} / {{ instance.softwareVersion || `(${i18n.ts.unknown})` }}</span></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline>
< 					<template #key>{{ i18n.ts.administrator }}</template>
< 					<template #value>{{ instance.maintainerName || `(${i18n.ts.unknown})` }} ({{ instance.maintainerEmail || `(${i18n.ts.unknown})` }})</template>
< 				</MkKeyValue>
< 			</div>
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.description }}</template>
< 				<template #value>{{ instance.description }}</template>
< 			</MkKeyValue>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer
>       v-if="instance"
>       :content-max="600"
>       :margin-min="16"
>       :margin-max="32"
>     >
>       <div v-if="tab === 'overview'" class="_formRoot">
>         <div class="fnfelxur">
>           <img
>             :src="instance.iconUrl || instance.faviconUrl"
>             alt=""
>             class="icon"
>           />
>           <span class="name">{{
>             instance.name || `(${i18n.ts.unknown})`
>           }}</span>
>         </div>
>         <MkKeyValue :copy="host" oneline style="margin: 1em 0">
>           <template #key>Host</template>
>           <template #value
>             ><span class="_monospace"
>               ><MkLink :url="`https://${host}`">{{ host }}</MkLink></span
>             ></template
>           >
>         </MkKeyValue>
>         <MkKeyValue oneline style="margin: 1em 0">
>           <template #key>{{ i18n.ts.software }}</template>
>           <template #value
>             ><span class="_monospace"
>               >{{ instance.softwareName || `(${i18n.ts.unknown})` }} /
>               {{ instance.softwareVersion || `(${i18n.ts.unknown})` }}</span
>             ></template
>           >
>         </MkKeyValue>
>         <MkKeyValue oneline style="margin: 1em 0">
>           <template #key>{{ i18n.ts.administrator }}</template>
>           <template #value
>             >{{ instance.maintainerName || `(${i18n.ts.unknown})` }} ({{
>               instance.maintainerEmail || `(${i18n.ts.unknown})`
>             }})</template
>           >
>         </MkKeyValue>
>         <MkKeyValue>
>           <template #key>{{ i18n.ts.description }}</template>
>           <template #value>{{ instance.description }}</template>
>         </MkKeyValue>
29,36c56,73
< 			<FormSection v-if="iAmModerator">
< 				<template #label>Moderation</template>
< 				<div class="_gaps_s">
< 					<MkSwitch v-model="suspended" @update:model-value="toggleSuspend">{{ i18n.ts.stopActivityDelivery }}</MkSwitch>
< 					<MkSwitch v-model="isBlocked" @update:model-value="toggleBlock">{{ i18n.ts.blockThisInstance }}</MkSwitch>
< 					<MkButton @click="refreshMetadata"><i class="ti ti-refresh"></i> Refresh metadata</MkButton>
< 				</div>
< 			</FormSection>
---
>         <FormSection v-if="iAmModerator">
>           <template #label>Moderation</template>
>           <FormSwitch
>             v-model="suspended"
>             class="_formBlock"
>             @update:modelValue="toggleSuspend"
>             >{{ i18n.ts.stopActivityDelivery }}</FormSwitch
>           >
>           <FormSwitch
>             v-model="isBlocked"
>             class="_formBlock"
>             @update:modelValue="toggleBlock"
>             >{{ i18n.ts.blockThisInstance }}</FormSwitch
>           >
>           <MkButton @click="refreshMetadata"
>             ><i class="fas fa-refresh"></i> Refresh metadata</MkButton
>           >
>         </FormSection>
38,62c75,112
< 			<FormSection>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>{{ i18n.ts.registeredAt }}</template>
< 					<template #value><MkTime mode="detail" :time="instance.firstRetrievedAt"/></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>{{ i18n.ts.updatedAt }}</template>
< 					<template #value><MkTime mode="detail" :time="instance.infoUpdatedAt"/></template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>{{ i18n.ts.latestRequestReceivedAt }}</template>
< 					<template #value><MkTime v-if="instance.latestRequestReceivedAt" :time="instance.latestRequestReceivedAt"/><span v-else>N/A</span></template>
< 				</MkKeyValue>
< 			</FormSection>
< 	
< 			<FormSection>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>Following (Pub)</template>
< 					<template #value>{{ number(instance.followingCount) }}</template>
< 				</MkKeyValue>
< 				<MkKeyValue oneline style="margin: 1em 0;">
< 					<template #key>Followers (Sub)</template>
< 					<template #value>{{ number(instance.followersCount) }}</template>
< 				</MkKeyValue>
< 			</FormSection>
---
>         <FormSection>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.registeredAt }}</template>
>             <template #value
>               ><MkTime mode="detail" :time="instance.caughtAt"
>             /></template>
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.updatedAt }}</template>
>             <template #value
>               ><MkTime mode="detail" :time="instance.infoUpdatedAt"
>             /></template>
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.latestRequestSentAt }}</template>
>             <template #value
>               ><MkTime
>                 v-if="instance.latestRequestSentAt"
>                 :time="instance.latestRequestSentAt"
>               /><span v-else>N/A</span></template
>             >
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.latestStatus }}</template>
>             <template #value>{{
>               instance.latestStatus ? instance.latestStatus : "N/A"
>             }}</template>
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>{{ i18n.ts.latestRequestReceivedAt }}</template>
>             <template #value
>               ><MkTime
>                 v-if="instance.latestRequestReceivedAt"
>                 :time="instance.latestRequestReceivedAt"
>               /><span v-else>N/A</span></template
>             >
>           </MkKeyValue>
>         </FormSection>
64,110c114,247
< 			<FormSection>
< 				<template #label>Well-known resources</template>
< 				<FormLink :to="`https://${host}/.well-known/host-meta`" external style="margin-bottom: 8px;">host-meta</FormLink>
< 				<FormLink :to="`https://${host}/.well-known/host-meta.json`" external style="margin-bottom: 8px;">host-meta.json</FormLink>
< 				<FormLink :to="`https://${host}/.well-known/nodeinfo`" external style="margin-bottom: 8px;">nodeinfo</FormLink>
< 				<FormLink :to="`https://${host}/robots.txt`" external style="margin-bottom: 8px;">robots.txt</FormLink>
< 				<FormLink :to="`https://${host}/manifest.json`" external style="margin-bottom: 8px;">manifest.json</FormLink>
< 			</FormSection>
< 		</div>
< 		<div v-else-if="tab === 'chart'" class="_gaps_m">
< 			<div class="cmhjzshl">
< 				<div class="selects">
< 					<MkSelect v-model="chartSrc" style="margin: 0 10px 0 0; flex: 1;">
< 						<option value="instance-requests">{{ i18n.ts._instanceCharts.requests }}</option>
< 						<option value="instance-users">{{ i18n.ts._instanceCharts.users }}</option>
< 						<option value="instance-users-total">{{ i18n.ts._instanceCharts.usersTotal }}</option>
< 						<option value="instance-notes">{{ i18n.ts._instanceCharts.notes }}</option>
< 						<option value="instance-notes-total">{{ i18n.ts._instanceCharts.notesTotal }}</option>
< 						<option value="instance-ff">{{ i18n.ts._instanceCharts.ff }}</option>
< 						<option value="instance-ff-total">{{ i18n.ts._instanceCharts.ffTotal }}</option>
< 						<option value="instance-drive-usage">{{ i18n.ts._instanceCharts.cacheSize }}</option>
< 						<option value="instance-drive-usage-total">{{ i18n.ts._instanceCharts.cacheSizeTotal }}</option>
< 						<option value="instance-drive-files">{{ i18n.ts._instanceCharts.files }}</option>
< 						<option value="instance-drive-files-total">{{ i18n.ts._instanceCharts.filesTotal }}</option>
< 					</MkSelect>
< 				</div>
< 				<div class="charts">
< 					<div class="label">{{ i18n.t('recentNHours', { n: 90 }) }}</div>
< 					<MkChart class="chart" :src="chartSrc" span="hour" :limit="90" :args="{ host: host }" :detailed="true"></MkChart>
< 					<div class="label">{{ i18n.t('recentNDays', { n: 90 }) }}</div>
< 					<MkChart class="chart" :src="chartSrc" span="day" :limit="90" :args="{ host: host }" :detailed="true"></MkChart>
< 				</div>
< 			</div>
< 		</div>
< 		<div v-else-if="tab === 'users'" class="_gaps_m">
< 			<MkPagination v-slot="{items}" :pagination="usersPagination" style="display: grid; grid-template-columns: repeat(auto-fill,minmax(270px,1fr)); grid-gap: 12px;">
< 				<MkA v-for="user in items" :key="user.id" v-tooltip.mfm="`Last posted: ${dateString(user.updatedAt)}`" class="user" :to="`/user-info/${user.id}`">
< 					<MkUserCardMini :user="user"/>
< 				</MkA>
< 			</MkPagination>
< 		</div>
< 		<div v-else-if="tab === 'raw'" class="_gaps_m">
< 			<MkObjectView tall :value="instance">
< 			</MkObjectView>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <FormSection>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>Following (Pub)</template>
>             <template #value>{{ number(instance.followingCount) }}</template>
>           </MkKeyValue>
>           <MkKeyValue oneline style="margin: 1em 0">
>             <template #key>Followers (Sub)</template>
>             <template #value>{{ number(instance.followersCount) }}</template>
>           </MkKeyValue>
>         </FormSection>
> 
>         <FormSection>
>           <template #label>Well-known resources</template>
>           <FormLink
>             :to="`https://${host}/.well-known/host-meta`"
>             external
>             style="margin-bottom: 8px"
>             >host-meta</FormLink
>           >
>           <FormLink
>             :to="`https://${host}/.well-known/host-meta.json`"
>             external
>             style="margin-bottom: 8px"
>             >host-meta.json</FormLink
>           >
>           <FormLink
>             :to="`https://${host}/.well-known/nodeinfo`"
>             external
>             style="margin-bottom: 8px"
>             >nodeinfo</FormLink
>           >
>           <FormLink
>             :to="`https://${host}/robots.txt`"
>             external
>             style="margin-bottom: 8px"
>             >robots.txt</FormLink
>           >
>           <FormLink
>             :to="`https://${host}/manifest.json`"
>             external
>             style="margin-bottom: 8px"
>             >manifest.json</FormLink
>           >
>         </FormSection>
>       </div>
>       <div v-else-if="tab === 'chart'" class="_formRoot">
>         <div class="cmhjzshl">
>           <div class="selects">
>             <MkSelect v-model="chartSrc" style="margin: 0 10px 0 0; flex: 1">
>               <option value="instance-requests">
>                 {{ i18n.ts._instanceCharts.requests }}
>               </option>
>               <option value="instance-users">
>                 {{ i18n.ts._instanceCharts.users }}
>               </option>
>               <option value="instance-users-total">
>                 {{ i18n.ts._instanceCharts.usersTotal }}
>               </option>
>               <option value="instance-notes">
>                 {{ i18n.ts._instanceCharts.notes }}
>               </option>
>               <option value="instance-notes-total">
>                 {{ i18n.ts._instanceCharts.notesTotal }}
>               </option>
>               <option value="instance-ff">
>                 {{ i18n.ts._instanceCharts.ff }}
>               </option>
>               <option value="instance-ff-total">
>                 {{ i18n.ts._instanceCharts.ffTotal }}
>               </option>
>               <option value="instance-drive-usage">
>                 {{ i18n.ts._instanceCharts.cacheSize }}
>               </option>
>               <option value="instance-drive-usage-total">
>                 {{ i18n.ts._instanceCharts.cacheSizeTotal }}
>               </option>
>               <option value="instance-drive-files">
>                 {{ i18n.ts._instanceCharts.files }}
>               </option>
>               <option value="instance-drive-files-total">
>                 {{ i18n.ts._instanceCharts.filesTotal }}
>               </option>
>             </MkSelect>
>           </div>
>           <div class="charts">
>             <div class="label">{{ i18n.t("recentNHours", { n: 90 }) }}</div>
>             <MkChart
>               class="chart"
>               :src="chartSrc"
>               span="hour"
>               :limit="90"
>               :args="{ host: host }"
>               :detailed="true"
>             ></MkChart>
>             <div class="label">{{ i18n.t("recentNDays", { n: 90 }) }}</div>
>             <MkChart
>               class="chart"
>               :src="chartSrc"
>               span="day"
>               :limit="90"
>               :args="{ host: host }"
>               :detailed="true"
>             ></MkChart>
>           </div>
>         </div>
>       </div>
>       <div v-else-if="tab === 'users'" class="_formRoot">
>         <MkPagination
>           v-slot="{ items }"
>           :pagination="usersPagination"
>           style="
>             display: grid;
>             grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
>             grid-gap: 12px;
>           "
>         >
>           <MkA
>             v-for="user in items"
>             :key="user.id"
>             v-tooltip.mfm="
>               `Last posted: ${new Date(user.updatedAt).toLocaleString()}`
>             "
>             class="user"
>             :to="`/user-info/${user.id}`"
>           >
>             <MkUserCardMini :user="user" />
>           </MkA>
>         </MkPagination>
>       </div>
>       <div v-else-if="tab === 'raw'" class="_formRoot">
>         <MkObjectView tall :value="instance"> </MkObjectView>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
114,134c251,269
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkChart from '@/components/MkChart.vue';
< import MkObjectView from '@/components/MkObjectView.vue';
< import FormLink from '@/components/form/link.vue';
< import MkLink from '@/components/MkLink.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormSection from '@/components/form/section.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import bytes from '@/filters/bytes';
< import { iAmModerator } from '@/account';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import MkUserCardMini from '@/components/MkUserCardMini.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import { getProxiedImageUrlNullable } from '@/scripts/media-proxy';
< import { dateString } from '@/filters/date';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import MkChart from "@/components/MkChart.vue";
> import MkObjectView from "@/components/MkObjectView.vue";
> import FormLink from "@/components/form/link.vue";
> import MkLink from "@/components/MkLink.vue";
> import MkButton from "@/components/MkButton.vue";
> import FormSection from "@/components/form/section.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import MkSelect from "@/components/form/select.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import bytes from "@/filters/bytes";
> import { iAmModerator } from "@/account";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import MkUserCardMini from "@/components/MkUserCardMini.vue";
> import MkPagination from "@/components/MkPagination.vue";
137c272
< 	host: string;
---
>   host: string;
140,141c275,276
< let tab = $ref('overview');
< let chartSrc = $ref('instance-requests');
---
> let tab = $ref("overview");
> let chartSrc = $ref("instance-requests");
146d280
< let faviconUrl = $ref(null);
149,156c283,290
< 	endpoint: iAmModerator ? 'admin/show-users' : 'users' as const,
< 	limit: 10,
< 	params: {
< 		sort: '+updatedAt',
< 		state: 'all',
< 		hostname: props.host,
< 	},
< 	offsetMode: true,
---
>   endpoint: iAmModerator ? "admin/show-users" : ("users" as const),
>   limit: 10,
>   params: {
>     sort: "+updatedAt",
>     state: "all",
>     hostname: props.host,
>   },
>   offsetMode: true,
160,165c294,298
< 	instance = await os.api('federation/show-instance', {
< 		host: props.host,
< 	});
< 	suspended = instance.isSuspended;
< 	isBlocked = instance.isBlocked;
< 	faviconUrl = getProxiedImageUrlNullable(instance.faviconUrl, 'preview') ?? getProxiedImageUrlNullable(instance.iconUrl, 'preview');
---
>   instance = await os.api("federation/show-instance", {
>     host: props.host,
>   });
>   suspended = instance.isSuspended;
>   isBlocked = instance.isBlocked;
169,172c302,307
< 	if (meta == null) return;
< 	await os.api('admin/update-meta', {
< 		blockedHosts: isBlocked ? meta.blockedHosts.concat([instance.host]) : meta.blockedHosts.filter(x => x !== instance.host),
< 	});
---
>   if (meta == null) return;
>   await os.api("admin/update-meta", {
>     blockedHosts: isBlocked
>       ? meta.blockedHosts.concat([instance.host])
>       : meta.blockedHosts.filter((x) => x !== instance.host),
>   });
176,179c311,314
< 	await os.api('admin/federation/update-instance', {
< 		host: instance.host,
< 		isSuspended: suspended,
< 	});
---
>   await os.api("admin/federation/update-instance", {
>     host: instance.host,
>     isSuspended: suspended,
>   });
183,188c318,323
< 	os.api('admin/federation/refresh-remote-instance-metadata', {
< 		host: instance.host,
< 	});
< 	os.alert({
< 		text: 'Refresh requested',
< 	});
---
>   os.api("admin/federation/refresh-remote-instance-metadata", {
>     host: instance.host,
>   });
>   os.alert({
>     text: "Refresh requested",
>   });
193,199c328,336
< const headerActions = $computed(() => [{
< 	text: `https://${props.host}`,
< 	icon: 'ti ti-external-link',
< 	handler: () => {
< 		window.open(`https://${props.host}`, '_blank');
< 	},
< }]);
---
> const headerActions = $computed(() => [
>   {
>     text: `https://${props.host}`,
>     icon: "fas fa-external-link-alt",
>     handler: () => {
>       window.open(`https://${props.host}`, "_blank");
>     },
>   },
> ]);
201,217c338,359
< const headerTabs = $computed(() => [{
< 	key: 'overview',
< 	title: i18n.ts.overview,
< 	icon: 'ti ti-info-circle',
< }, {
< 	key: 'chart',
< 	title: i18n.ts.charts,
< 	icon: 'ti ti-chart-line',
< }, {
< 	key: 'users',
< 	title: i18n.ts.users,
< 	icon: 'ti ti-users',
< }, {
< 	key: 'raw',
< 	title: 'Raw',
< 	icon: 'ti ti-code',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "overview",
>     title: i18n.ts.overview,
>     icon: "fas fa-info-circle",
>   },
>   {
>     key: "chart",
>     title: i18n.ts.charts,
>     icon: "fas fa-chart-simple",
>   },
>   {
>     key: "users",
>     title: i18n.ts.users,
>     icon: "fas fa-users",
>   },
>   {
>     key: "raw",
>     title: "Raw",
>     icon: "fas fa-code",
>   },
> ]);
220,221c362,363
< 	title: props.host,
< 	icon: 'ti ti-server',
---
>   title: props.host,
>   icon: "fas fa-server",
227,228c369,370
< 	display: flex;
< 	align-items: center;
---
>   display: flex;
>   align-items: center;
230,235c372,377
< 	> .icon {
< 		display: block;
< 		margin: 0 16px 0 0;
< 		height: 64px;
< 		border-radius: 8px;
< 	}
---
>   > .icon {
>     display: block;
>     margin: 0 16px 0 0;
>     height: 64px;
>     border-radius: 8px;
>   }
237,239c379,381
< 	> .name {
< 		word-break: break-all;
< 	}
---
>   > .name {
>     word-break: break-all;
>   }
243,246c385,388
< 	> .selects {
< 		display: flex;
< 		margin: 0 0 16px 0;
< 	}
---
>   > .selects {
>     display: flex;
>     margin: 0 0 16px 0;
>   }
248,253c390,395
< 	> .charts {
< 		> .label {
< 			margin-bottom: 12px;
< 			font-weight: bold;
< 		}
< 	}
---
>   > .charts {
>     > .label {
>       margin-bottom: 12px;
>       font-weight: bold;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/messaging/index.vue RiricaV13/pages/messaging/index.vue
2,6c2,10
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<div class="yweeujhr">
< 			<MkButton primary class="start" @click="start"><i class="ti ti-plus"></i> {{ $ts.startMessaging }}</MkButton>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <div v-size="{ max: [400] }" class="yweeujhr">
>         <MkButton primary class="start" @click="start"
>           ><i class="fas fa-plus"></i> {{ $ts.startMessaging }}</MkButton
>         >
8,42c12,77
< 			<div v-if="messages.length > 0" class="history">
< 				<MkA
< 					v-for="(message, i) in messages"
< 					:key="message.id"
< 					v-anim="i"
< 					class="message _panel"
< 					:class="{ isMe: isMe(message), isRead: message.groupId ? message.reads.includes($i.id) : message.isRead }"
< 					:to="message.groupId ? `/my/messaging/group/${message.groupId}` : `/my/messaging/${getAcct(isMe(message) ? message.recipient : message.user)}`"
< 					:data-index="i"
< 				>
< 					<div>
< 						<MkAvatar class="avatar" :user="message.groupId ? message.user : isMe(message) ? message.recipient : message.user" indicator link preview/>
< 						<header v-if="message.groupId">
< 							<span class="name">{{ message.group.name }}</span>
< 							<MkTime :time="message.createdAt" class="time"/>
< 						</header>
< 						<header v-else>
< 							<span class="name"><MkUserName :user="isMe(message) ? message.recipient : message.user"/></span>
< 							<span class="username">@{{ acct(isMe(message) ? message.recipient : message.user) }}</span>
< 							<MkTime :time="message.createdAt" class="time"/>
< 						</header>
< 						<div class="body">
< 							<p class="text"><span v-if="isMe(message)" class="me">{{ $ts.you }}:</span>{{ message.text }}</p>
< 						</div>
< 					</div>
< 				</MkA>
< 			</div>
< 			<div v-if="!fetching && messages.length == 0" class="_fullinfo">
< 				<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 				<div>{{ $ts.noHistory }}</div>
< 			</div>
< 			<MkLoading v-if="fetching"/>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <div v-if="messages.length > 0" class="history">
>           <MkA
>             v-for="(message, i) in messages"
>             :key="message.id"
>             v-anim="i"
>             class="message _block"
>             :class="{
>               isMe: isMe(message),
>               isRead: message.groupId
>                 ? message.reads.includes($i.id)
>                 : message.isRead,
>             }"
>             :to="
>               message.groupId
>                 ? `/my/messaging/group/${message.groupId}`
>                 : `/my/messaging/${getAcct(
>                     isMe(message) ? message.recipient : message.user
>                   )}`
>             "
>             :data-index="i"
>           >
>             <div>
>               <MkAvatar
>                 class="avatar"
>                 :user="
>                   message.groupId
>                     ? message.user
>                     : isMe(message)
>                     ? message.recipient
>                     : message.user
>                 "
>                 :show-indicator="true"
>               />
>               <header v-if="message.groupId">
>                 <span class="name">{{ message.group.name }}</span>
>                 <MkTime :time="message.createdAt" class="time" />
>               </header>
>               <header v-else>
>                 <span class="name"
>                   ><MkUserName
>                     :user="isMe(message) ? message.recipient : message.user"
>                 /></span>
>                 <span class="username"
>                   >@{{
>                     acct(isMe(message) ? message.recipient : message.user)
>                   }}</span
>                 >
>                 <MkTime :time="message.createdAt" class="time" />
>               </header>
>               <div class="body">
>                 <p class="text">
>                   <span v-if="isMe(message)" class="me">{{ $ts.you }}:</span
>                   >{{ message.text }}
>                 </p>
>               </div>
>             </div>
>           </MkA>
>         </div>
>         <div v-if="!fetching && messages.length == 0" class="_fullinfo">
>           <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>           <div>{{ $ts.noHistory }}</div>
>         </div>
>         <MkLoading v-if="fetching" />
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
46,55c81,97
< import { defineAsyncComponent, defineComponent, inject, markRaw, onMounted, onUnmounted } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import MkButton from '@/components/MkButton.vue';
< import { acct } from '@/filters/user';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { useRouter } from '@/router';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { $i } from '@/account';
---
> import {
>   defineAsyncComponent,
>   defineComponent,
>   inject,
>   markRaw,
>   onMounted,
>   onUnmounted,
> } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import MkButton from "@/components/MkButton.vue";
> import { acct } from "@/filters/user";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { useRouter } from "@/router";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { $i } from "@/account";
67c109
< 	return message.userId === $i.id;
---
>   return message.userId === $i.id;
71,74c113,121
< 	if (message.recipientId) {
< 		messages = messages.filter(m => !(
< 			(m.recipientId === message.recipientId && m.userId === message.userId) ||
< 			(m.recipientId === message.userId && m.userId === message.recipientId)));
---
>   if (message.recipientId) {
>     messages = messages.filter(
>       (m) =>
>         !(
>           (m.recipientId === message.recipientId &&
>             m.userId === message.userId) ||
>           (m.recipientId === message.userId && m.userId === message.recipientId)
>         )
>     );
76,80c123,127
< 		messages.unshift(message);
< 	} else if (message.groupId) {
< 		messages = messages.filter(m => m.groupId !== message.groupId);
< 		messages.unshift(message);
< 	}
---
>     messages.unshift(message);
>   } else if (message.groupId) {
>     messages = messages.filter((m) => m.groupId !== message.groupId);
>     messages.unshift(message);
>   }
84,93c131,140
< 	for (const id of ids) {
< 		const found = messages.find(m => m.id === id);
< 		if (found) {
< 			if (found.recipientId) {
< 				found.isRead = true;
< 			} else if (found.groupId) {
< 				found.reads.push($i.id);
< 			}
< 		}
< 	}
---
>   for (const id of ids) {
>     const found = messages.find((m) => m.id === id);
>     if (found) {
>       if (found.recipientId) {
>         found.isRead = true;
>       } else if (found.groupId) {
>         found.reads.push($i.id);
>       }
>     }
>   }
97,105c144,162
< 	os.popupMenu([{
< 		text: i18n.ts.messagingWithUser,
< 		icon: 'ti ti-user',
< 		action: () => { startUser(); },
< 	}, {
< 		text: i18n.ts.messagingWithGroup,
< 		icon: 'ti ti-users',
< 		action: () => { startGroup(); },
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.messagingWithUser,
>         icon: "fas fa-user",
>         action: () => {
>           startUser();
>         },
>       },
>       {
>         text: i18n.ts.messagingWithGroup,
>         icon: "fas fa-users",
>         action: () => {
>           startGroup();
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
109,111c166,168
< 	os.selectUser().then(user => {
< 		router.push(`/my/messaging/${Acct.toString(user)}`);
< 	});
---
>   os.selectUser().then((user) => {
>     router.push(`/my/messaging/${Acct.toString(user)}`);
>   });
115,132c172,190
< 	const groups1 = await os.api('users/groups/owned');
< 	const groups2 = await os.api('users/groups/joined');
< 	if (groups1.length === 0 && groups2.length === 0) {
< 		os.alert({
< 			type: 'warning',
< 			title: i18n.ts.youHaveNoGroups,
< 			text: i18n.ts.joinOrCreateGroup,
< 		});
< 		return;
< 	}
< 	const { canceled, result: group } = await os.select({
< 		title: i18n.ts.group,
< 		items: groups1.concat(groups2).map(group => ({
< 			value: group, text: group.name,
< 		})),
< 	});
< 	if (canceled) return;
< 	router.push(`/my/messaging/group/${group.id}`);
---
>   const groups1 = await os.api("users/groups/owned");
>   const groups2 = await os.api("users/groups/joined");
>   if (groups1.length === 0 && groups2.length === 0) {
>     os.alert({
>       type: "warning",
>       title: i18n.ts.youHaveNoGroups,
>       text: i18n.ts.joinOrCreateGroup,
>     });
>     return;
>   }
>   const { canceled, result: group } = await os.select({
>     title: i18n.ts.group,
>     items: groups1.concat(groups2).map((group) => ({
>       value: group,
>       text: group.name,
>     })),
>   });
>   if (canceled) return;
>   router.push(`/my/messaging/group/${group.id}`);
136c194
< 	connection = markRaw(stream.useChannel('messagingIndex'));
---
>   connection = markRaw(stream.useChannel("messagingIndex"));
138,139c196,197
< 	connection.on('message', onMessage);
< 	connection.on('read', onRead);
---
>   connection.on("message", onMessage);
>   connection.on("read", onRead);
141,148c199,209
< 	os.api('messaging/history', { group: false }).then(userMessages => {
< 		os.api('messaging/history', { group: true }).then(groupMessages => {
< 			const _messages = userMessages.concat(groupMessages);
< 			_messages.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());
< 			messages = _messages;
< 			fetching = false;
< 		});
< 	});
---
>   os.api("messaging/history", { group: false }).then((userMessages) => {
>     os.api("messaging/history", { group: true }).then((groupMessages) => {
>       const _messages = userMessages.concat(groupMessages);
>       _messages.sort(
>         (a, b) =>
>           new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()
>       );
>       messages = _messages;
>       fetching = false;
>     });
>   });
152c213
< 	if (connection) connection.dispose();
---
>   if (connection) connection.dispose();
160,161c221,222
< 	title: i18n.ts.messaging,
< 	icon: 'ti ti-messages',
---
>   title: i18n.ts.messaging,
>   icon: "fas fa-comments",
166a228,230
>   > .start {
>     margin: 0 auto var(--margin) auto;
>   }
168,170c232,236
< 	> .start {
< 		margin: 0 auto var(--margin) auto;
< 	}
---
>   > .history {
>     > .message {
>       display: block;
>       text-decoration: none;
>       margin-bottom: var(--margin);
172,176c238,241
< 	> .history {
< 		> .message {
< 			display: block;
< 			text-decoration: none;
< 			margin-bottom: var(--margin);
---
>       * {
>         pointer-events: none;
>         user-select: none;
>       }
178,181c243,247
< 			* {
< 				pointer-events: none;
< 				user-select: none;
< 			}
---
>       &:hover {
>         .avatar {
>           filter: saturate(200%);
>         }
>       }
183,187c249,250
< 			&:hover {
< 				.avatar {
< 					filter: saturate(200%);
< 				}
< 			}
---
>       &:active {
>       }
189,190c252,255
< 			&:active {
< 			}
---
>       &.isRead,
>       &.isMe {
>         opacity: 0.8;
>       }
192,195c257,263
< 			&.isRead,
< 			&.isMe {
< 				opacity: 0.8;
< 			}
---
>       &:not(.isMe):not(.isRead) {
>         > div {
>           background-image: url("/client-assets/unread.svg");
>           background-repeat: no-repeat;
>           background-position: 0 center;
>         }
>       }
197,203c265,269
< 			&:not(.isMe):not(.isRead) {
< 				> div {
< 					background-image: url("/client-assets/unread.svg");
< 					background-repeat: no-repeat;
< 					background-position: 0 center;
< 				}
< 			}
---
>       &:after {
>         content: "";
>         display: block;
>         clear: both;
>       }
205,209c271,272
< 			&:after {
< 				content: "";
< 				display: block;
< 				clear: both;
< 			}
---
>       > div {
>         padding: 20px 30px;
211,212c274,278
< 			> div {
< 				padding: 20px 30px;
---
>         &:after {
>           content: "";
>           display: block;
>           clear: both;
>         }
214,218c280,285
< 				&:after {
< 					content: "";
< 					display: block;
< 					clear: both;
< 				}
---
>         > header {
>           display: flex;
>           align-items: center;
>           margin-bottom: 2px;
>           white-space: nowrap;
>           overflow: hidden;
220,225c287,295
< 				> header {
< 					display: flex;
< 					align-items: center;
< 					margin-bottom: 2px;
< 					white-space: nowrap;
< 					overflow: hidden;
---
>           > .name {
>             margin: 0;
>             padding: 0;
>             overflow: hidden;
>             text-overflow: ellipsis;
>             font-size: 1em;
>             font-weight: bold;
>             transition: all 0.1s ease;
>           }
227,235c297,299
< 					> .name {
< 						margin: 0;
< 						padding: 0;
< 						overflow: hidden;
< 						text-overflow: ellipsis;
< 						font-size: 1em;
< 						font-weight: bold;
< 						transition: all 0.1s ease;
< 					}
---
>           > .username {
>             margin: 0 8px;
>           }
237,239c301,304
< 					> .username {
< 						margin: 0 8px;
< 					}
---
>           > .time {
>             margin: 0 0 0 auto;
>           }
>         }
241,244c306,313
< 					> .time {
< 						margin: 0 0 0 auto;
< 					}
< 				}
---
>         > .avatar {
>           float: left;
>           width: 54px;
>           height: 54px;
>           margin: 0 16px 0 0;
>           border-radius: 8px;
>           transition: all 0.1s ease;
>         }
246,253c315,323
< 				> .avatar {
< 					float: left;
< 					width: 54px;
< 					height: 54px;
< 					margin: 0 16px 0 0;
< 					border-radius: 8px;
< 					transition: all 0.1s ease;
< 				}
---
>         > .body {
>           > .text {
>             display: block;
>             margin: 0 0 0 0;
>             padding: 0;
>             overflow: hidden;
>             overflow-wrap: break-word;
>             font-size: 1.1em;
>             color: var(--faceText);
255c325,328
< 				> .body {
---
>             .me {
>               opacity: 0.7;
>             }
>           }
257,264c330,338
< 					> .text {
< 						display: block;
< 						margin: 0 0 0 0;
< 						padding: 0;
< 						overflow: hidden;
< 						overflow-wrap: break-word;
< 						font-size: 1.1em;
< 						color: var(--faceText);
---
>           > .image {
>             display: block;
>             max-width: 100%;
>             max-height: 512px;
>           }
>         }
>       }
>     }
>   }
266,269c340,348
< 						.me {
< 							opacity: 0.7;
< 						}
< 					}
---
>   &.max-width_400px {
>     > .history {
>       > .message {
>         &:not(.isMe):not(.isRead) {
>           > div {
>             background-image: none;
>             border-left: solid 4px #3aa2dc;
>           }
>         }
271,280c350,352
< 					> .image {
< 						display: block;
< 						max-width: 100%;
< 						max-height: 512px;
< 					}
< 				}
< 			}
< 		}
< 	}
< }
---
>         > div {
>           padding: 16px;
>           font-size: 0.9em;
282,303c354,360
< @container (max-width: 400px) {
< 	.yweeujhr {
< 		> .history {
< 			> .message {
< 				&:not(.isMe):not(.isRead) {
< 					> div {
< 						background-image: none;
< 						border-left: solid 4px #3aa2dc;
< 					}
< 				}
< 
< 				> div {
< 					padding: 16px;
< 					font-size: 0.9em;
< 
< 					> .avatar {
< 						margin: 0 12px 0 0;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > .avatar {
>             margin: 0 12px 0 0;
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/messaging/messaging-room.form.vue RiricaV13/pages/messaging/messaging-room.form.vue
2,28c2,34
< <div
< 	:class="$style['root']"
< 	@dragover.stop="onDragover"
< 	@drop.stop="onDrop"
< >
< 	<textarea
< 		:class="$style['textarea']"
< 		class="_acrylic"
< 		ref="textEl"
< 		v-model="text"
< 		:placeholder="i18n.ts.inputMessageHere"
< 		@keydown="onKeydown"
< 		@compositionupdate="onCompositionUpdate"
< 		@paste="onPaste"
< 	></textarea>
< 	<footer :class="$style['footer']">
< 		<div v-if="file" :class="$style['file']" @click="file = null">{{ file.name }}</div>
< 		<div :class="$style['buttons']">
< 			<button class="_button" :class="$style['button']" @click="chooseFile"><i class="ti ti-photo-plus"></i></button>
< 			<button class="_button" :class="$style['button']" @click="insertEmoji"><i class="ti ti-mood-happy"></i></button>
< 			<button class="_button" :class="[$style['button'], $style['send']]" :disabled="!canSend || sending" :title="i18n.ts.send" @click="send">
< 				<template v-if="!sending"><i class="ti ti-send"></i></template><template v-if="sending"><MkLoading :em="true"/></template>
< 			</button>
< 		</div>
< 	</footer>
< 	<input :class="$style['file-input']" ref="fileEl" type="file" @change="onChangeFile"/>
< </div>
---
>   <div class="pemppnzi _block" @dragover.stop="onDragover" @drop.stop="onDrop">
>     <textarea
>       ref="textEl"
>       v-model="text"
>       :placeholder="i18n.ts.inputMessageHere"
>       @keydown="onKeydown"
>       @compositionupdate="onCompositionUpdate"
>       @paste="onPaste"
>     ></textarea>
>     <footer>
>       <div v-if="file" class="file" @click="file = null">{{ file.name }}</div>
>       <div class="buttons">
>         <button class="_button" @click="chooseFile">
>           <i class="fas fa-photo-video"></i>
>         </button>
>         <button class="_button" @click="insertEmoji">
>           <i class="fas fa-laugh-squint"></i>
>         </button>
>         <button
>           class="send _button"
>           :disabled="!canSend || sending"
>           :title="i18n.ts.send"
>           @click="send"
>         >
>           <template v-if="!sending"><i class="fas fa-paper-plane"></i></template
>           ><template v-if="sending"
>             ><i class="fas fa-spinner fa-pulse fa-fw"></i
>           ></template>
>         </button>
>       </div>
>     </footer>
>     <input ref="fileEl" type="file" @change="onChangeFile" />
>   </div>
32,34c38,40
< import { onMounted, watch } from 'vue';
< import * as Misskey from 'misskey-js';
< import autosize from 'autosize';
---
> import { onMounted, watch } from "vue";
> import * as Misskey from "misskey-js";
> import autosize from "autosize";
36,42c42,48
< import { throttle } from 'throttle-debounce';
< import { formatTimeString } from '@/scripts/format-time-string';
< import { selectFile } from '@/scripts/select-file';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
---
> import { throttle } from "throttle-debounce";
> import { formatTimeString } from "@/scripts/format-time-string";
> import { selectFile } from "@/scripts/select-file";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
44,45c50
< import { uploadFile } from '@/scripts/upload';
< import { miLocalStorage } from '@/local-storage';
---
> import { uploadFile } from "@/scripts/upload";
48,49c53,54
< 	user?: Misskey.entities.UserDetailed | null;
< 	group?: Misskey.entities.UserGroup | null;
---
>   user?: Misskey.entities.UserDetailed | null;
>   group?: Misskey.entities.UserGroup | null;
52,53c57,58
< let textEl = $shallowRef<HTMLTextAreaElement>();
< let fileEl = $shallowRef<HTMLInputElement>();
---
> let textEl = $ref<HTMLTextAreaElement>();
> let fileEl = $ref<HTMLInputElement>();
55c60
< let text = $ref<string>('');
---
> let text = $ref<string>("");
59c64,67
< 	stream.send('typingOnMessaging', props.user ? { partner: props.user.id } : { group: props.group?.id });
---
>   stream.send(
>     "typingOnMessaging",
>     props.user ? { partner: props.user.id } : { group: props.group?.id }
>   );
62,63c70,73
< let draftKey = $computed(() => props.user ? 'user:' + props.user.id : 'group:' + props.group?.id);
< let canSend = $computed(() => (text != null && text !== '') || file != null);
---
> let draftKey = $computed(() =>
>   props.user ? "user:" + props.user.id : "group:" + props.group?.id
> );
> let canSend = $computed(() => (text != null && text !== "") || file != null);
68c78
< 	if (!ev.clipboardData) return;
---
>   if (!ev.clipboardData) return;
70,71c80,81
< 	const clipboardData = ev.clipboardData;
< 	const items = clipboardData.items;
---
>   const clipboardData = ev.clipboardData;
>   const items = clipboardData.items;
73,89c83,103
< 	if (items.length === 1) {
< 		if (items[0].kind === 'file') {
< 			const pastedFile = items[0].getAsFile();
< 			if (!pastedFile) return;
< 			const lio = pastedFile.name.lastIndexOf('.');
< 			const ext = lio >= 0 ? pastedFile.name.slice(lio) : '';
< 			const formatted = formatTimeString(new Date(pastedFile.lastModified), defaultStore.state.pastedFileName).replace(/{{number}}/g, '1') + ext;
< 			if (formatted) upload(pastedFile, formatted);
< 		}
< 	} else {
< 		if (items[0].kind === 'file') {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts.onlyOneFileCanBeAttached,
< 			});
< 		}
< 	}
---
>   if (items.length === 1) {
>     if (items[0].kind === "file") {
>       const pastedFile = items[0].getAsFile();
>       if (!pastedFile) return;
>       const lio = pastedFile.name.lastIndexOf(".");
>       const ext = lio >= 0 ? pastedFile.name.slice(lio) : "";
>       const formatted =
>         formatTimeString(
>           new Date(pastedFile.lastModified),
>           defaultStore.state.pastedFileName
>         ).replace(/{{number}}/g, "1") + ext;
>       if (formatted) upload(pastedFile, formatted);
>     }
>   } else {
>     if (items[0].kind === "file") {
>       os.alert({
>         type: "error",
>         text: i18n.ts.onlyOneFileCanBeAttached,
>       });
>     }
>   }
93c107
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
95,115c109,129
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
< 	if (isFile || isDriveFile) {
< 		ev.preventDefault();
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	}
---
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
>   if (isFile || isDriveFile) {
>     ev.preventDefault();
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   }
119c133
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
121,133c135,147
< 	// ファイルだったら
< 	if (ev.dataTransfer.files.length === 1) {
< 		ev.preventDefault();
< 		upload(ev.dataTransfer.files[0]);
< 		return;
< 	} else if (ev.dataTransfer.files.length > 1) {
< 		ev.preventDefault();
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.onlyOneFileCanBeAttached,
< 		});
< 		return;
< 	}
---
>   // ファイルだったら
>   if (ev.dataTransfer.files.length === 1) {
>     ev.preventDefault();
>     upload(ev.dataTransfer.files[0]);
>     return;
>   } else if (ev.dataTransfer.files.length > 1) {
>     ev.preventDefault();
>     os.alert({
>       type: "error",
>       text: i18n.ts.onlyOneFileCanBeAttached,
>     });
>     return;
>   }
135,141c149,155
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		file = JSON.parse(driveFile);
< 		ev.preventDefault();
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     file = JSON.parse(driveFile);
>     ev.preventDefault();
>   }
>   //#endregion
145,148c159,162
< 	typing();
< 	if ((ev.key === 'Enter') && (ev.ctrlKey || ev.metaKey) && canSend) {
< 		send();
< 	}
---
>   typing();
>   if (ev.key === "Enter" && (ev.ctrlKey || ev.metaKey) && canSend) {
>     send();
>   }
152c166
< 	typing();
---
>   typing();
156,158c170,174
< 	selectFile(ev.currentTarget ?? ev.target, i18n.ts.selectFile).then(selectedFile => {
< 		file = selectedFile;
< 	});
---
>   selectFile(ev.currentTarget ?? ev.target, i18n.ts.selectFile).then(
>     (selectedFile) => {
>       file = selectedFile;
>     }
>   );
162c178
< 	if (fileEl.files![0]) upload(fileEl.files[0]);
---
>   if (fileEl.files![0]) upload(fileEl.files[0]);
166,168c182,186
< 	uploadFile(fileToUpload, defaultStore.state.uploadFolder, name).then(res => {
< 		file = res;
< 	});
---
>   uploadFile(fileToUpload, defaultStore.state.uploadFolder, name).then(
>     (res) => {
>       file = res;
>     }
>   );
172,184c190,205
< 	sending = true;
< 	os.api('messaging/messages/create', {
< 		userId: props.user ? props.user.id : undefined,
< 		groupId: props.group ? props.group.id : undefined,
< 		text: text ? text : undefined,
< 		fileId: file ? file.id : undefined,
< 	}).then(message => {
< 		clear();
< 	}).catch(err => {
< 		console.error(err);
< 	}).then(() => {
< 		sending = false;
< 	});
---
>   sending = true;
>   os.api("messaging/messages/create", {
>     userId: props.user ? props.user.id : undefined,
>     groupId: props.group ? props.group.id : undefined,
>     text: text ? text : undefined,
>     fileId: file ? file.id : undefined,
>   })
>     .then((message) => {
>       clear();
>     })
>     .catch((err) => {
>       console.error(err);
>     })
>     .then(() => {
>       sending = false;
>     });
188,190c209,211
< 	text = '';
< 	file = null;
< 	deleteDraft();
---
>   text = "";
>   file = null;
>   deleteDraft();
194c215
< 	const drafts = JSON.parse(miLocalStorage.getItem('message_drafts') || '{}');
---
>   const drafts = JSON.parse(localStorage.getItem("message_drafts") || "{}");
196,203c217,224
< 	drafts[draftKey] = {
< 		updatedAt: new Date(),
< 		// eslint-disable-next-line id-denylist
< 		data: {
< 			text: text,
< 			file: file,
< 		},
< 	};
---
>   drafts[draftKey] = {
>     updatedAt: new Date(),
>     // eslint-disable-next-line id-denylist
>     data: {
>       text: text,
>       file: file,
>     },
>   };
205c226
< 	miLocalStorage.setItem('message_drafts', JSON.stringify(drafts));
---
>   localStorage.setItem("message_drafts", JSON.stringify(drafts));
209c230
< 	const drafts = JSON.parse(miLocalStorage.getItem('message_drafts') || '{}');
---
>   const drafts = JSON.parse(localStorage.getItem("message_drafts") || "{}");
211c232
< 	delete drafts[draftKey];
---
>   delete drafts[draftKey];
213c234
< 	miLocalStorage.setItem('message_drafts', JSON.stringify(drafts));
---
>   localStorage.setItem("message_drafts", JSON.stringify(drafts));
217c238
< 	os.openEmojiPicker(ev.currentTarget ?? ev.target, {}, textEl);
---
>   os.openEmojiPicker(ev.currentTarget ?? ev.target, {}, textEl);
221c242
< 	autosize(textEl);
---
>   autosize(textEl);
223,225c244,246
< 	// TODO: detach when unmount
< 	// TODO
< 	//new Autocomplete(textEl, this, { model: 'text' });
---
>   // TODO: detach when unmount
>   // TODO
>   //new Autocomplete(textEl, this, { model: 'text' });
227,232c248,255
< 	// 書きかけの投稿を復元
< 	const draft = JSON.parse(miLocalStorage.getItem('message_drafts') || '{}')[draftKey];
< 	if (draft) {
< 		text = draft.data.text;
< 		file = draft.data.file;
< 	}
---
>   // 書きかけの投稿を復元
>   const draft = JSON.parse(localStorage.getItem("message_drafts") || "{}")[
>     draftKey
>   ];
>   if (draft) {
>     text = draft.data.text;
>     file = draft.data.file;
>   }
236,237c259,260
< 	file,
< 	upload,
---
>   file,
>   upload,
241,244c264,266
< <style lang="scss" module>
< .root {
< 	position: relative;
< }
---
> <style lang="scss" scoped>
> .pemppnzi {
>   position: relative;
246,264c268,287
< .textarea {
< 	cursor: auto;
< 	display: block;
< 	width: 100%;
< 	min-width: 100%;
< 	max-width: 100%;
< 	min-height: 80px;
< 	margin: 0;
< 	padding: 16px 16px 0 16px;
< 	resize: none;
< 	font-size: 1em;
< 	font-family: inherit;
< 	outline: none;
< 	border: none;
< 	border-radius: 0;
< 	box-shadow: none;
< 	box-sizing: border-box;
< 	color: var(--fg);
< }
---
>   > textarea {
>     cursor: auto;
>     display: block;
>     width: 100%;
>     min-width: 100%;
>     max-width: 100%;
>     min-height: 80px;
>     margin: 0;
>     padding: 16px 16px 0 16px;
>     resize: none;
>     font-size: 1em;
>     font-family: inherit;
>     outline: none;
>     border: none;
>     border-radius: 0;
>     box-shadow: none;
>     background: transparent;
>     box-sizing: border-box;
>     color: var(--fg);
>   }
266,270c289,292
< .footer {
< 	position: sticky;
< 	bottom: 0;
< 	background: var(--panel);
< }
---
>   footer {
>     position: sticky;
>     bottom: 0;
>     background: var(--panel);
272,283c294,300
< .file {
< 	padding: 8px;
< 	color: var(--fg);
< 	background: transparent;
< 	cursor: pointer;
< }
< /*
< .files {
< 	display: block;
< 	margin: 0;
< 	padding: 0 8px;
< 	list-style: none;
---
>     > .file {
>       padding: 8px;
>       color: var(--fg);
>       background: transparent;
>       cursor: pointer;
>     }
>   }
285,289c302,306
< 	&:after {
< 		content: '';
< 		display: block;
< 		clear: both;
< 	}
---
>   .files {
>     display: block;
>     margin: 0;
>     padding: 0 8px;
>     list-style: none;
291,302c308,312
< 	> li {
< 		display: block;
< 		float: left;
< 		margin: 4px;
< 		padding: 0;
< 		width: 64px;
< 		height: 64px;
< 		background-color: #eee;
< 		background-repeat: no-repeat;
< 		background-position: center center;
< 		background-size: cover;
< 		cursor: move;
---
>     &:after {
>       content: "";
>       display: block;
>       clear: both;
>     }
304,310c314,325
< 		&:hover {
< 			> .remove {
< 				display: block;
< 			}
< 		}
< 	}
< }
---
>     > li {
>       display: block;
>       float: left;
>       margin: 4px;
>       padding: 0;
>       width: 64px;
>       height: 64px;
>       background-color: #eee;
>       background-repeat: no-repeat;
>       background-position: center center;
>       background-size: cover;
>       cursor: move;
312,326c327,331
< .file-remove {
< 	display: none;
< 	position: absolute;
< 	right: -6px;
< 	top: -6px;
< 	margin: 0;
< 	padding: 0;
< 	background: transparent;
< 	outline: none;
< 	border: none;
< 	border-radius: 0;
< 	box-shadow: none;
< 	cursor: pointer;
< }
< */
---
>       &:hover {
>         > .remove {
>           display: block;
>         }
>       }
328,330c333,348
< .buttons {
< 	display: flex;
< }
---
>       > .remove {
>         display: none;
>         position: absolute;
>         right: -6px;
>         top: -6px;
>         margin: 0;
>         padding: 0;
>         background: transparent;
>         outline: none;
>         border: none;
>         border-radius: 0;
>         box-shadow: none;
>         cursor: pointer;
>       }
>     }
>   }
332,338c350,351
< .button {
< 	margin: 0;
< 	padding: 16px;
< 	font-size: 1em;
< 	font-weight: normal;
< 	text-decoration: none;
< 	transition: color 0.1s ease;
---
>   .buttons {
>     display: flex;
340,342c353,359
< 	&:hover {
< 		color: var(--accent);
< 	}
---
>     ._button {
>       margin: 0;
>       padding: 16px;
>       font-size: 1em;
>       font-weight: normal;
>       text-decoration: none;
>       transition: color 0.1s ease;
344,351c361,363
< 	&:active {
< 		color: var(--accentDarken);
< 		transition: color 0s ease;
< 	}
< }
< .send {
< 	margin-left: auto;
< 	color: var(--accent);
---
>       &:hover {
>         color: var(--accent);
>       }
353,355c365,369
< 	&:hover {
< 		color: var(--accentLighten);
< 	}
---
>       &:active {
>         color: var(--accentDarken);
>         transition: color 0s ease;
>       }
>     }
357,361c371,373
< 	&:active {
< 		color: var(--accentDarken);
< 		transition: color 0s ease;
< 	}
< }
---
>     > .send {
>       margin-left: auto;
>       color: var(--accent);
363,364c375,388
< .file-input {
< 	display: none;
---
>       &:hover {
>         color: var(--accentLighten);
>       }
> 
>       &:active {
>         color: var(--accentDarken);
>         transition: color 0s ease;
>       }
>     }
>   }
> 
>   input[type="file"] {
>     display: none;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/messaging/messaging-room.message.vue RiricaV13/pages/messaging/messaging-room.message.vue
2,35c2,66
< <div class="thvuemwp" :class="{ isMe }">
< 	<MkAvatar class="avatar" :user="message.user" indicator link preview/>
< 	<div class="content">
< 		<div class="balloon" :class="{ noText: message.text == null }">
< 			<button v-if="isMe" class="delete-button" :title="$ts.delete" @click="del">
< 				<img src="/client-assets/remove.png" alt="Delete"/>
< 			</button>
< 			<div v-if="!message.isDeleted" class="content">
< 				<Mfm v-if="message.text" ref="text" class="text" :text="message.text" :i="$i"/>
< 				<div v-if="message.file" class="file">
< 					<a :href="message.file.url" rel="noopener" target="_blank" :title="message.file.name">
< 						<img v-if="message.file.type.split('/')[0] == 'image'" :src="message.file.url" :alt="message.file.name"/>
< 						<p v-else>{{ message.file.name }}</p>
< 					</a>
< 				</div>
< 			</div>
< 			<div v-else class="content">
< 				<p class="is-deleted">{{ $ts.deleted }}</p>
< 			</div>
< 		</div>
< 		<div></div>
< 		<MkUrlPreview v-for="url in urls" :key="url" :url="url" style="margin: 8px 0;"/>
< 		<footer>
< 			<template v-if="isGroup">
< 				<span v-if="message.reads.length > 0" class="read">{{ $ts.messageRead }} {{ message.reads.length }}</span>
< 			</template>
< 			<template v-else>
< 				<span v-if="isMe && message.isRead" class="read">{{ $ts.messageRead }}</span>
< 			</template>
< 			<MkTime :time="message.createdAt"/>
< 			<template v-if="message.is_edited"><i class="ti ti-pencil"></i></template>
< 		</footer>
< 	</div>
< </div>
---
>   <div v-size="{ max: [400, 500] }" class="thvuemwp" :class="{ isMe }">
>     <MkAvatar class="avatar" :user="message.user" :show-indicator="true" />
>     <div class="content">
>       <div class="balloon" :class="{ noText: message.text == null }">
>         <button
>           v-if="isMe"
>           class="delete-button"
>           :title="$ts.delete"
>           @click="del"
>         >
>           <img src="/client-assets/remove.png" alt="Delete" />
>         </button>
>         <div v-if="!message.isDeleted" class="content">
>           <Mfm
>             v-if="message.text"
>             ref="text"
>             class="text"
>             :text="message.text"
>             :i="$i"
>           />
>           <div v-if="message.file" class="file">
>             <a
>               :href="message.file.url"
>               rel="noopener"
>               target="_blank"
>               :title="message.file.name"
>             >
>               <img
>                 v-if="message.file.type.split('/')[0] == 'image'"
>                 :src="message.file.url"
>                 :alt="message.file.name"
>               />
>               <p v-else>{{ message.file.name }}</p>
>             </a>
>           </div>
>         </div>
>         <div v-else class="content">
>           <p class="is-deleted">{{ $ts.deleted }}</p>
>         </div>
>       </div>
>       <div></div>
>       <MkUrlPreview
>         v-for="url in urls"
>         :key="url"
>         :url="url"
>         style="margin: 8px 0"
>       />
>       <footer>
>         <template v-if="isGroup">
>           <span v-if="message.reads.length > 0" class="read"
>             >{{ $ts.messageRead }} {{ message.reads.length }}</span
>           >
>         </template>
>         <template v-else>
>           <span v-if="isMe && message.isRead" class="read">{{
>             $ts.messageRead
>           }}</span>
>         </template>
>         <MkTime :time="message.createdAt" />
>         <template v-if="message.is_edited"
>           ><i class="fas fa-pencil-alt"></i
>         ></template>
>       </footer>
>     </div>
>   </div>
39,45c70,76
< import { } from 'vue';
< import * as mfm from 'mfm-js';
< import * as Misskey from 'misskey-js';
< import { extractUrlFromMfm } from '@/scripts/extract-url-from-mfm';
< import MkUrlPreview from '@/components/MkUrlPreview.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
---
> import {} from "vue";
> import * as mfm from "mfm-js";
> import * as Misskey from "misskey-js";
> import { extractUrlFromMfm } from "@/scripts/extract-url-from-mfm";
> import MkUrlPreview from "@/components/MkUrlPreview.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
48,49c79,80
< 	message: Misskey.entities.MessagingMessage;
< 	isGroup?: boolean;
---
>   message: Misskey.entities.MessagingMessage;
>   isGroup?: boolean;
53c84,86
< const urls = $computed(() => props.message.text ? extractUrlFromMfm(mfm.parse(props.message.text)) : []);
---
> const urls = $computed(() =>
>   props.message.text ? extractUrlFromMfm(mfm.parse(props.message.text)) : []
> );
56,58c89,91
< 	os.api('messaging/messages/delete', {
< 		messageId: props.message.id,
< 	});
---
>   os.api("messaging/messages/delete", {
>     messageId: props.message.id,
>   });
64c97
< 	$me-balloon-color: var(--accent);
---
>   $me-balloon-color: var(--accent);
66,68c99,101
< 	position: relative;
< 	background-color: transparent;
< 	display: flex;
---
>   position: relative;
>   background-color: transparent;
>   display: flex;
70,77c103,110
< 	> .avatar {
< 		position: sticky;
< 		top: calc(var(--stickyTop, 0px) + 16px);
< 		display: block;
< 		width: 54px;
< 		height: 54px;
< 		transition: all 0.1s ease;
< 	}
---
>   > .avatar {
>     position: sticky;
>     top: calc(var(--stickyTop, 0px) + 16px);
>     display: block;
>     width: 54px;
>     height: 54px;
>     transition: all 0.1s ease;
>   }
79,80c112,113
< 	> .content {
< 		min-width: 0;
---
>   > .content {
>     min-width: 0;
82,89c115,122
< 		> .balloon {
< 			position: relative;
< 			display: inline-flex;
< 			align-items: center;
< 			padding: 0;
< 			min-height: 38px;
< 			border-radius: 16px;
< 			max-width: 100%;
---
>     > .balloon {
>       position: relative;
>       display: inline-flex;
>       align-items: center;
>       padding: 0;
>       min-height: 38px;
>       border-radius: 16px;
>       max-width: 100%;
91,97c124,130
< 			&:before {
< 				content: "";
< 				pointer-events: none;
< 				display: block;
< 				position: absolute;
< 				top: 12px;
< 			}
---
>       &:before {
>         content: "";
>         pointer-events: none;
>         display: block;
>         position: absolute;
>         top: 12px;
>       }
99,101c132,134
< 			& + * {
< 				clear: both;
< 			}
---
>       & + * {
>         clear: both;
>       }
103,107c136,140
< 			&:hover {
< 				> .delete-button {
< 					display: block;
< 				}
< 			}
---
>       &:hover {
>         > .delete-button {
>           display: block;
>         }
>       }
109,122c142,155
< 			> .delete-button {
< 				display: none;
< 				position: absolute;
< 				z-index: 1;
< 				top: -4px;
< 				right: -4px;
< 				margin: 0;
< 				padding: 0;
< 				cursor: pointer;
< 				outline: none;
< 				border: none;
< 				border-radius: 0;
< 				box-shadow: none;
< 				background: transparent;
---
>       > .delete-button {
>         display: none;
>         position: absolute;
>         z-index: 1;
>         top: -4px;
>         right: -4px;
>         margin: 0;
>         padding: 0;
>         cursor: pointer;
>         outline: none;
>         border: none;
>         border-radius: 0;
>         box-shadow: none;
>         background: transparent;
124,130c157,163
< 				> img {
< 					vertical-align: bottom;
< 					width: 16px;
< 					height: 16px;
< 					cursor: pointer;
< 				}
< 			}
---
>         > img {
>           vertical-align: bottom;
>           width: 16px;
>           height: 16px;
>           cursor: pointer;
>         }
>       }
132,133c165,166
< 			> .content {
< 				max-width: 100%;
---
>       > .content {
>         max-width: 100%;
135,143c168,176
< 				> .is-deleted {
< 					display: block;
< 					margin: 0;
< 					padding: 0;
< 					overflow: hidden;
< 					overflow-wrap: break-word;
< 					font-size: 1em;
< 					color: rgba(#000, 0.5);
< 				}
---
>         > .is-deleted {
>           display: block;
>           margin: 0;
>           padding: 0;
>           overflow: hidden;
>           overflow-wrap: break-word;
>           font-size: 1em;
>           color: rgba(#000, 0.5);
>         }
145,153c178,186
< 				> .text {
< 					display: block;
< 					margin: 0;
< 					padding: 12px 18px;
< 					overflow: hidden;
< 					overflow-wrap: break-word;
< 					word-break: break-word;
< 					font-size: 1em;
< 					color: rgba(#000, 0.8);
---
>         > .text {
>           display: block;
>           margin: 0;
>           padding: 12px 18px;
>           overflow: hidden;
>           overflow-wrap: break-word;
>           word-break: break-word;
>           font-size: 1em;
>           color: rgba(#000, 0.8);
155,160c188,193
< 					& + .file {
< 						> a {
< 							border-radius: 0 0 16px 16px;
< 						}
< 					}
< 				}
---
>           & + .file {
>             > a {
>               border-radius: 0 0 16px 16px;
>             }
>           }
>         }
162,168c195,201
< 				> .file {
< 					> a {
< 						display: block;
< 						max-width: 100%;
< 						border-radius: 16px;
< 						overflow: hidden;
< 						text-decoration: none;
---
>         > .file {
>           > a {
>             display: block;
>             max-width: 100%;
>             border-radius: 16px;
>             overflow: hidden;
>             text-decoration: none;
170,171c203,204
< 						&:hover {
< 							text-decoration: none;
---
>             &:hover {
>               text-decoration: none;
173,176c206,209
< 							> p {
< 								background: #ccc;
< 							}
< 						}
---
>               > p {
>                 background: #ccc;
>               }
>             }
178,185c211,218
< 						> * {
< 							display: block;
< 							margin: 0;
< 							width: 100%;
< 							max-height: 512px;
< 							object-fit: contain;
< 							box-sizing: border-box;
< 						}
---
>             > * {
>               display: block;
>               margin: 0;
>               width: 100%;
>               max-height: 512px;
>               object-fit: contain;
>               box-sizing: border-box;
>             }
187,196c220,229
< 						> p {
< 							padding: 30px;
< 							text-align: center;
< 							color: #555;
< 							background: #ddd;
< 						}
< 					}
< 				}
< 			}
< 		}
---
>             > p {
>               padding: 30px;
>               text-align: center;
>               color: #555;
>               background: #ddd;
>             }
>           }
>         }
>       }
>     }
198,201c231,234
< 		> footer {
< 			display: block;
< 			margin: 2px 0 0 0;
< 			font-size: 0.65em;
---
>     > footer {
>       display: block;
>       margin: 2px 0 0 0;
>       font-size: 0.65em;
203,205c236,238
< 			> .read {
< 				margin: 0 8px;
< 			}
---
>       > .read {
>         margin: 0 8px;
>       }
207,211c240,244
< 			> i {
< 				margin-left: 4px;
< 			}
< 		}
< 	}
---
>       > i {
>         margin-left: 4px;
>       }
>     }
>   }
213,214c246,247
< 	&:not(.isMe) {
< 		padding-left: var(--margin);
---
>   &:not(.isMe) {
>     padding-left: var(--margin);
216,218c249,251
< 		> .content {
< 			padding-left: 16px;
< 			padding-right: 32px;
---
>     > .content {
>       padding-left: 16px;
>       padding-right: 32px;
220,222c253,255
< 			> .balloon {
< 				$color: var(--messageBg);
< 				background: $color;
---
>       > .balloon {
>         $color: var(--messageBg);
>         background: $color;
224,226c257,259
< 				&.noText {
< 					background: transparent;
< 				}
---
>         &.noText {
>           background: transparent;
>         }
228,234c261,267
< 				&:not(.noText):before {
< 					left: -14px;
< 					border-top: solid 8px transparent;
< 					border-right: solid 8px $color;
< 					border-bottom: solid 8px transparent;
< 					border-left: solid 8px transparent;
< 				}
---
>         &:not(.noText):before {
>           left: -14px;
>           border-top: solid 8px transparent;
>           border-right: solid 8px $color;
>           border-bottom: solid 8px transparent;
>           border-left: solid 8px transparent;
>         }
236,241c269,274
< 				> .content {
< 					> .text {
< 						color: var(--fg);
< 					}
< 				}
< 			}
---
>         > .content {
>           > .text {
>             color: var(--fg);
>           }
>         }
>       }
243,247c276,280
< 			> footer {
< 				text-align: left;
< 			}
< 		}
< 	}
---
>       > footer {
>         text-align: left;
>       }
>     }
>   }
249,252c282,285
< 	&.isMe {
< 		flex-direction: row-reverse;
< 		padding-right: var(--margin);
< 		right: var(--margin); // 削除時にposition: absoluteになったときに使う
---
>   &.isMe {
>     flex-direction: row-reverse;
>     padding-right: var(--margin);
>     right: var(--margin); // 削除時にposition: absoluteになったときに使う
254,257c287,290
< 		> .content {
< 			padding-right: 16px;
< 			padding-left: 32px;
< 			text-align: right;
---
>     > .content {
>       padding-right: 16px;
>       padding-left: 32px;
>       text-align: right;
259,261c292,294
< 			> .balloon {
< 				background: $me-balloon-color;
< 				text-align: left;
---
>       > .balloon {
>         background: $me-balloon-color;
>         text-align: left;
263,266c296,299
< 				::selection {
< 					color: var(--accent);
< 					background-color: #fff;
< 				} 
---
>         ::selection {
>           color: var(--accent);
>           background-color: #fff;
>         }
268,270c301,303
< 				&.noText {
< 					background: transparent;
< 				}
---
>         &.noText {
>           background: transparent;
>         }
272,279c305,312
< 				&:not(.noText):before {
< 					right: -14px;
< 					left: auto;
< 					border-top: solid 8px transparent;
< 					border-right: solid 8px transparent;
< 					border-bottom: solid 8px transparent;
< 					border-left: solid 8px $me-balloon-color;
< 				}
---
>         &:not(.noText):before {
>           right: -14px;
>           left: auto;
>           border-top: solid 8px transparent;
>           border-right: solid 8px transparent;
>           border-bottom: solid 8px transparent;
>           border-left: solid 8px $me-balloon-color;
>         }
281c314,317
< 				> .content {
---
>         > .content {
>           > p.is-deleted {
>             color: rgba(#fff, 0.5);
>           }
283,285c319,326
< 					> p.is-deleted {
< 						color: rgba(#fff, 0.5);
< 					}
---
>           > .text {
>             &,
>             ::v-deep(*) {
>               color: var(--fgOnAccent) !important;
>             }
>           }
>         }
>       }
287,293c328,329
< 					> .text {
< 						&, ::v-deep(*) {
< 							color: var(--fgOnAccent) !important;
< 						}
< 					}
< 				}
< 			}
---
>       > footer {
>         text-align: right;
295,296c331,336
< 			> footer {
< 				text-align: right;
---
>         > .read {
>           user-select: none;
>         }
>       }
>     }
>   }
298,304c338,342
< 				> .read {
< 					user-select: none;
< 				}
< 			}
< 		}
< 	}
< }
---
>   &.max-width_400px {
>     > .avatar {
>       width: 48px;
>       height: 48px;
>     }
306,311c344,353
< @container (max-width: 400px) {
< 	.thvuemwp {
< 		> .avatar {
< 			width: 48px;
< 			height: 48px;
< 		}
---
>     > .content {
>       > .balloon {
>         > .content {
>           > .text {
>             font-size: 0.9em;
>           }
>         }
>       }
>     }
>   }
313,336c355,365
< 		> .content {
< 			> .balloon {
< 				> .content {
< 					> .text {
< 						font-size: 0.9em;
< 					}
< 				}
< 			}
< 		}
< 	}
< }
< 
< @container (max-width: 500px) {
< 	.thvuemwp {
< 		> .content {
< 			> .balloon {
< 				> .content {
< 					> .text {
< 						padding: 8px 16px;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>   &.max-width_500px {
>     > .content {
>       > .balloon {
>         > .content {
>           > .text {
>             padding: 8px 16px;
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/messaging/messaging-room.vue RiricaV13/pages/messaging/messaging-room.vue
2,4c2,69
< <MkStickyContainer>
< <template #header>
< 	<MkPageHeader />
---
>   <div
>     ref="rootEl"
>     class="_section"
>     @dragover.prevent.stop="onDragover"
>     @drop.prevent.stop="onDrop"
>   >
>     <div class="_content mk-messaging-room">
>       <div class="body">
>         <MkPagination
>           v-if="pagination"
>           ref="pagingComponent"
>           :key="userAcct || groupId"
>           :pagination="pagination"
>         >
>           <template #empty>
>             <div class="_fullinfo">
>               <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>               <div>{{ i18n.ts.noMessagesYet }}</div>
>             </div>
>           </template>
> 
>           <template #default="{ items: messages, fetching: pFetching }">
>             <XList
>               v-if="messages.length > 0"
>               v-slot="{ item: message }"
>               :class="{ messages: true, 'deny-move-transition': pFetching }"
>               :items="messages"
>               direction="up"
>               reversed
>             >
>               <XMessage
>                 :key="message.id"
>                 :message="message"
>                 :is-group="group != null"
>               />
>             </XList>
>           </template>
>         </MkPagination>
>       </div>
>       <footer>
>         <div v-if="typers.length > 0" class="typers">
>           <I18n :src="i18n.ts.typingUsers" text-tag="span" class="users">
>             <template #users>
>               <b v-for="typer in typers" :key="typer.id" class="user">{{
>                 typer.username
>               }}</b>
>             </template>
>           </I18n>
>           <MkEllipsis />
>         </div>
>         <transition :name="animation ? 'fade' : ''">
>           <div v-show="showIndicator" class="new-message">
>             <button class="_buttonPrimary" @click="onIndicatorClick">
>               <i class="fas fa-fw fa-arrow-circle-down"></i
>               >{{ i18n.ts.newMessageExists }}
>             </button>
>           </div>
>         </transition>
>         <XForm
>           v-if="!fetching"
>           ref="formEl"
>           :user="user"
>           :group="group"
>           class="form"
>         />
>       </footer>
>     </div>
>   </div>
6,54d70
< <div
< 	ref="rootEl"
< 	:class="$style['root']"
< 	@dragover.prevent.stop="onDragover"
< 	@drop.prevent.stop="onDrop"
< >
< 	<div :class="$style['body']">
< 		<MkPagination v-if="pagination" ref="pagingComponent" :key="userAcct || groupId" :pagination="pagination">
< 			<template #empty>
< 				<div class="_fullinfo">
< 					<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 					<div>{{ i18n.ts.noMessagesYet }}</div>
< 				</div>
< 			</template>
< 			<template #default="{ items: messages, fetching: pFetching }">
< 				<MkDateSeparatedList
< 					v-if="messages.length > 0"
< 					v-slot="{ item: message }"
< 					:class="{ [$style['messages']]: true, 'deny-move-transition': pFetching }"
< 					:items="messages"
< 					direction="up"
< 					reversed
< 				>
< 					<XMessage :key="message.id" :message="message" :is-group="group != null"/>
< 				</MkDateSeparatedList>
< 			</template>
< 		</MkPagination>
< 	</div>
< 	<footer :class="$style['footer']">
< 		<div v-if="typers.length > 0" :class="$style['typers']">
< 			<I18n :src="i18n.ts.typingUsers" text-tag="span">
< 				<template #users>
< 					<b v-for="typer in typers" :key="typer.id" :class="$style['user']">{{ typer.username }}</b>
< 				</template>
< 			</I18n>
< 			<MkEllipsis/>
< 		</div>
< 		<Transition :name="animation ? 'fade' : ''">
< 			<div v-show="showIndicator" :class="$style['new-message']">
< 				<button class="_buttonPrimary" @click="onIndicatorClick" :class="$style['new-message-button']">
< 					<i class="fas ti-fw fa-arrow-circle-down" :class="$style['new-message-icon']"></i>{{ i18n.ts.newMessageExists }}
< 				</button>
< 			</div>
< 		</Transition>
< 		<XForm v-if="!fetching" ref="formEl" :user="user" :group="group" :class="$style['form']"/>
< 	</footer>
< </div>
< </MkStickyContainer>
< </template>
57,71c73,91
< import { computed, watch, onMounted, nextTick, onBeforeUnmount } from 'vue';
< import * as Misskey from 'misskey-js';
< import * as Acct from 'misskey-js/built/acct';
< import XMessage from './messaging-room.message.vue';
< import XForm from './messaging-room.form.vue';
< import MkDateSeparatedList from '@/components/MkDateSeparatedList.vue';
< import MkPagination, { Paging } from '@/components/MkPagination.vue';
< import { isBottomVisible, onScrollBottom, scrollToBottom } from '@/scripts/scroll';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import * as sound from '@/scripts/sound';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
< import { defaultStore } from '@/store';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, watch, onMounted, nextTick, onBeforeUnmount } from "vue";
> import * as Misskey from "misskey-js";
> import * as Acct from "misskey-js/built/acct";
> import XMessage from "./messaging-room.message.vue";
> import XForm from "./messaging-room.form.vue";
> import XList from "@/components/MkDateSeparatedList.vue";
> import MkPagination, { Paging } from "@/components/MkPagination.vue";
> import {
>   isBottomVisible,
>   onScrollBottom,
>   scrollToBottom,
> } from "@/scripts/scroll";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import * as sound from "@/scripts/sound";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
> import { defaultStore } from "@/store";
> import { definePageMetadata } from "@/scripts/page-metadata";
74,75c94,95
< 	userAcct?: string;
< 	groupId?: string;
---
>   userAcct?: string;
>   groupId?: string;
78,80c98,100
< let rootEl = $shallowRef<HTMLDivElement>();
< let formEl = $shallowRef<InstanceType<typeof XForm>>();
< let pagingComponent = $shallowRef<InstanceType<typeof MkPagination>>();
---
> let rootEl = $ref<HTMLDivElement>();
> let formEl = $ref<InstanceType<typeof XForm>>();
> let pagingComponent = $ref<InstanceType<typeof MkPagination>>();
86c106,108
< let connection: Misskey.ChannelConnection<Misskey.Channels['messaging']> | null = $ref(null);
---
> let connection: Misskey.ChannelConnection<
>   Misskey.Channels["messaging"]
> > | null = $ref(null);
88,90c110
< const {
< 	animation,
< } = defaultStore.reactiveState;
---
> const { animation } = defaultStore.reactiveState;
95,96c115,116
< 	if (connection) connection.dispose();
< 	fetch();
---
>   if (connection) connection.dispose();
>   fetch();
100c120
< 	fetching = true;
---
>   fetching = true;
102,121c122,128
< 	if (props.userAcct) {
< 		const acct = Acct.parse(props.userAcct);
< 		user = await os.api('users/show', { username: acct.username, host: acct.host || undefined });
< 		group = null;
< 		
< 		pagination = {
< 			endpoint: 'messaging/messages',
< 			limit: 20,
< 			params: {
< 				userId: user.id,
< 			},
< 			reversed: true,
< 			pageEl: $$(rootEl).value,
< 		};
< 		connection = stream.useChannel('messaging', {
< 			otherparty: user.id,
< 		});
< 	} else {
< 		user = null;
< 		group = await os.api('users/groups/show', { groupId: props.groupId });
---
>   if (props.userAcct) {
>     const acct = Acct.parse(props.userAcct);
>     user = await os.api("users/show", {
>       username: acct.username,
>       host: acct.host || undefined,
>     });
>     group = null;
123,135c130,144
< 		pagination = {
< 			endpoint: 'messaging/messages',
< 			limit: 20,
< 			params: {
< 				groupId: group?.id,
< 			},
< 			reversed: true,
< 			pageEl: $$(rootEl).value,
< 		};
< 		connection = stream.useChannel('messaging', {
< 			group: group?.id,
< 		});
< 	}
---
>     pagination = {
>       endpoint: "messaging/messages",
>       limit: 20,
>       params: {
>         userId: user.id,
>       },
>       reversed: true,
>       pageEl: $$(rootEl).value,
>     };
>     connection = stream.useChannel("messaging", {
>       otherparty: user.id,
>     });
>   } else {
>     user = null;
>     group = await os.api("users/groups/show", { groupId: props.groupId });
137,142c146,158
< 	connection.on('message', onMessage);
< 	connection.on('read', onRead);
< 	connection.on('deleted', onDeleted);
< 	connection.on('typers', _typers => {
< 		typers = _typers.filter(u => u.id !== $i?.id);
< 	});
---
>     pagination = {
>       endpoint: "messaging/messages",
>       limit: 20,
>       params: {
>         groupId: group?.id,
>       },
>       reversed: true,
>       pageEl: $$(rootEl).value,
>     };
>     connection = stream.useChannel("messaging", {
>       group: group?.id,
>     });
>   }
144c160,165
< 	document.addEventListener('visibilitychange', onVisibilitychange);
---
>   connection.on("message", onMessage);
>   connection.on("read", onRead);
>   connection.on("deleted", onDeleted);
>   connection.on("typers", (_typers) => {
>     typers = _typers.filter((u) => u.id !== $i?.id);
>   });
146,153c167,174
< 	nextTick(() => {
< 		pagingComponent.inited.then(() => {
< 			thisScrollToBottom();
< 		});
< 		window.setTimeout(() => {
< 			fetching = false;
< 		}, 300);
< 	});
---
>   document.addEventListener("visibilitychange", onVisibilitychange);
> 
>   nextTick(() => {
>     thisScrollToBottom();
>     window.setTimeout(() => {
>       fetching = false;
>     }, 300);
>   });
157c178
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
159,160c180,181
< 	const isFile = ev.dataTransfer.items[0].kind === 'file';
< 	const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
---
>   const isFile = ev.dataTransfer.items[0].kind === "file";
>   const isDriveFile = ev.dataTransfer.types[0] === _DATA_TRANSFER_DRIVE_FILE_;
162,181c183,202
< 	if (isFile || isDriveFile) {
< 		switch (ev.dataTransfer.effectAllowed) {
< 			case 'all':
< 			case 'uninitialized':
< 			case 'copy': 
< 			case 'copyLink': 
< 			case 'copyMove': 
< 				ev.dataTransfer.dropEffect = 'copy';
< 				break;
< 			case 'linkMove':
< 			case 'move':
< 				ev.dataTransfer.dropEffect = 'move';
< 				break;
< 			default:
< 				ev.dataTransfer.dropEffect = 'none';
< 				break;
< 		}
< 	} else {
< 		ev.dataTransfer.dropEffect = 'none';
< 	}
---
>   if (isFile || isDriveFile) {
>     switch (ev.dataTransfer.effectAllowed) {
>       case "all":
>       case "uninitialized":
>       case "copy":
>       case "copyLink":
>       case "copyMove":
>         ev.dataTransfer.dropEffect = "copy";
>         break;
>       case "linkMove":
>       case "move":
>         ev.dataTransfer.dropEffect = "move";
>         break;
>       default:
>         ev.dataTransfer.dropEffect = "none";
>         break;
>     }
>   } else {
>     ev.dataTransfer.dropEffect = "none";
>   }
185c206
< 	if (!ev.dataTransfer) return;
---
>   if (!ev.dataTransfer) return;
187,197c208,218
< 	// ファイルだったら
< 	if (ev.dataTransfer.files.length === 1) {
< 		formEl.upload(ev.dataTransfer.files[0]);
< 		return;
< 	} else if (ev.dataTransfer.files.length > 1) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.onlyOneFileCanBeAttached,
< 		});
< 		return;
< 	}
---
>   // ファイルだったら
>   if (ev.dataTransfer.files.length === 1) {
>     formEl.upload(ev.dataTransfer.files[0]);
>     return;
>   } else if (ev.dataTransfer.files.length > 1) {
>     os.alert({
>       type: "error",
>       text: i18n.ts.onlyOneFileCanBeAttached,
>     });
>     return;
>   }
199,205c220,226
< 	//#region ドライブのファイル
< 	const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
< 	if (driveFile != null && driveFile !== '') {
< 		const file = JSON.parse(driveFile);
< 		formEl.file = file;
< 	}
< 	//#endregion
---
>   //#region ドライブのファイル
>   const driveFile = ev.dataTransfer.getData(_DATA_TRANSFER_DRIVE_FILE_);
>   if (driveFile != null && driveFile !== "") {
>     const file = JSON.parse(driveFile);
>     formEl.file = file;
>   }
>   //#endregion
209c230
< 	sound.play('chat');
---
>   sound.play("chat");
211c232
< 	const _isBottom = isBottomVisible(rootEl, 64);
---
>   const _isBottom = isBottomVisible(rootEl, 64);
213,218c234,239
< 	pagingComponent.prepend(message);
< 	if (message.userId !== $i?.id && !document.hidden) {
< 		connection?.send('read', {
< 			id: message.id,
< 		});
< 	}
---
>   pagingComponent.prepend(message);
>   if (message.userId !== $i?.id && !document.hidden) {
>     connection?.send("read", {
>       id: message.id,
>     });
>   }
220,228c241,249
< 	if (_isBottom) {
< 		// Scroll to bottom
< 		nextTick(() => {
< 			thisScrollToBottom();
< 		});
< 	} else if (message.userId !== $i?.id) {
< 		// Notify
< 		notifyNewMessage();
< 	}
---
>   if (_isBottom) {
>     // Scroll to bottom
>     nextTick(() => {
>       thisScrollToBottom();
>     });
>   } else if (message.userId !== $i?.id) {
>     // Notify
>     notifyNewMessage();
>   }
232,253c253,274
< 	if (user) {
< 		if (!Array.isArray(x)) x = [x];
< 		for (const id of x) {
< 			if (pagingComponent.items.some(y => y.id === id)) {
< 				const exist = pagingComponent.items.map(y => y.id).indexOf(id);
< 				pagingComponent.items[exist] = {
< 					...pagingComponent.items[exist],
< 					isRead: true,
< 				};
< 			}
< 		}
< 	} else if (group) {
< 		for (const id of x.ids) {
< 			if (pagingComponent.items.some(y => y.id === id)) {
< 				const exist = pagingComponent.items.map(y => y.id).indexOf(id);
< 				pagingComponent.items[exist] = {
< 					...pagingComponent.items[exist],
< 					reads: [...pagingComponent.items[exist].reads, x.userId],
< 				};
< 			}
< 		}
< 	}
---
>   if (user) {
>     if (!Array.isArray(x)) x = [x];
>     for (const id of x) {
>       if (pagingComponent.items.some((y) => y.id === id)) {
>         const exist = pagingComponent.items.map((y) => y.id).indexOf(id);
>         pagingComponent.items[exist] = {
>           ...pagingComponent.items[exist],
>           isRead: true,
>         };
>       }
>     }
>   } else if (group) {
>     for (const id of x.ids) {
>       if (pagingComponent.items.some((y) => y.id === id)) {
>         const exist = pagingComponent.items.map((y) => y.id).indexOf(id);
>         pagingComponent.items[exist] = {
>           ...pagingComponent.items[exist],
>           reads: [...pagingComponent.items[exist].reads, x.userId],
>         };
>       }
>     }
>   }
257,260c278,283
< 	const msg = pagingComponent.items.find(m => m.id === id);
< 	if (msg) {
< 		pagingComponent.items = pagingComponent.items.filter(m => m.id !== msg.id);
< 	}
---
>   const msg = pagingComponent.items.find((m) => m.id === id);
>   if (msg) {
>     pagingComponent.items = pagingComponent.items.filter(
>       (m) => m.id !== msg.id
>     );
>   }
264c287
< 	scrollToBottom($$(rootEl).value, { behavior: 'smooth' });
---
>   scrollToBottom($$(rootEl).value, { behavior: "smooth" });
268,269c291,292
< 	showIndicator = false;
< 	thisScrollToBottom();
---
>   showIndicator = false;
>   thisScrollToBottom();
275c298
< 	showIndicator = true;
---
>   showIndicator = true;
277,280c300,303
< 	scrollRemove = onScrollBottom(rootEl, () => {
< 		showIndicator = false;
< 		scrollRemove = null;
< 	});
---
>   scrollRemove = onScrollBottom(rootEl, () => {
>     showIndicator = false;
>     scrollRemove = null;
>   });
284,291c307,314
< 	if (document.hidden) return;
< 	for (const message of pagingComponent.items) {
< 		if (message.userId !== $i?.id && !message.isRead) {
< 			connection?.send('read', {
< 				id: message.id,
< 			});
< 		}
< 	}
---
>   if (document.hidden) return;
>   for (const message of pagingComponent.items) {
>     if (message.userId !== $i?.id && !message.isRead) {
>       connection?.send("read", {
>         id: message.id,
>       });
>     }
>   }
295c318
< 	fetch();
---
>   fetch();
299,301c322,324
< 	connection?.dispose();
< 	document.removeEventListener('visibilitychange', onVisibilitychange);
< 	if (scrollRemove) scrollRemove();
---
>   connection?.dispose();
>   document.removeEventListener("visibilitychange", onVisibilitychange);
>   if (scrollRemove) scrollRemove();
304,310c327,341
< definePageMetadata(computed(() => !fetching ? user ? {
< 	userName: user,
< 	avatar: user,
< } : {
< 	title: group?.name,
< 	icon: 'ti ti-users',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     !fetching
>       ? user
>         ? {
>             userName: user,
>             avatar: user,
>           }
>         : {
>             title: group?.name,
>             icon: "fas fa-users",
>           }
>       : null
>   )
> );
313,316c344,347
< <style lang="scss" module>
< .root {
< 	display: content;
< }
---
> <style lang="scss" scoped>
> .mk-messaging-room {
>   position: relative;
>   overflow: auto;
318,320c349,357
< .body {
< 	min-height: 80%;
< }
---
>   > .body {
>     .more {
>       display: block;
>       margin: 16px auto;
>       padding: 0 12px;
>       line-height: 24px;
>       color: #fff;
>       background: rgba(#000, 0.3);
>       border-radius: 12px;
322,339c359,361
< .more {
< 	display: block;
< 	margin: 16px auto;
< 	padding: 0 12px;
< 	line-height: 24px;
< 	color: #fff;
< 	background: rgba(#000, 0.3);
< 	border-radius: 12px;
< 	&:hover {
< 		background: rgba(#000, 0.4);
< 	}
< 	&:active {
< 		background: rgba(#000, 0.5);
< 	}
< 	> i {
< 		margin-right: 4px;
< 	}
< }
---
>       &:hover {
>         background: rgba(#000, 0.4);
>       }
341,343c363,365
< .fetching {
< 	cursor: wait;
< }
---
>       &:active {
>         background: rgba(#000, 0.5);
>       }
345,346c367,369
< .messages {
< 	padding: 16px 0 0;
---
>       &.fetching {
>         cursor: wait;
>       }
348,351c371,374
< 	> * {
< 		margin-bottom: 16px;
< 	}
< }
---
>       > i {
>         margin-right: 4px;
>       }
>     }
353,359c376,377
< .footer {
< 	width: 100%;
< 	position: sticky;
< 	z-index: 2;
< 	padding-top: 8px;
< 	bottom: var(--minBottomSpacing);
< }
---
>     .messages {
>       padding: 8px 0;
361,365c379,383
< .new-message {
< 	width: 100%;
< 	padding-bottom: 8px;
< 	text-align: center;
< }
---
>       > ::v-deep(*) {
>         margin-bottom: 16px;
>       }
>     }
>   }
367,374c385,391
< .new-message-button {
< 	display: inline-block;
< 	margin: 0;
< 	padding: 0 12px;
< 	line-height: 32px;
< 	font-size: 12px;
< 	border-radius: 16px;
< }
---
>   > footer {
>     width: 100%;
>     position: sticky;
>     z-index: 2;
>     bottom: 0;
>     padding-top: 8px;
>     bottom: calc(env(safe-area-inset-bottom, 0px) + 8px);
376,379c393,396
< .new-message-icon {
< 	display: inline-block;
< 	margin-right: 8px;
< }
---
>     > .new-message {
>       width: 100%;
>       padding-bottom: 8px;
>       text-align: center;
381,387c398,404
< .typers {
< 	position: absolute;
< 	bottom: 100%;
< 	padding: 0 8px 0 8px;
< 	font-size: 0.9em;
< 	color: var(--fgTransparentWeak);
< }
---
>       > button {
>         display: inline-block;
>         margin: 0;
>         padding: 0 12px;
>         line-height: 32px;
>         font-size: 12px;
>         border-radius: 16px;
388a406,411
>         > i {
>           display: inline-block;
>           margin-right: 8px;
>         }
>       }
>     }
390,393c413,418
< .user + .user:before {
< 	content: ", ";
< 	font-weight: normal;
< }
---
>     > .typers {
>       position: absolute;
>       bottom: 100%;
>       padding: 0 8px 0 8px;
>       font-size: 0.9em;
>       color: var(--fgTransparentWeak);
395,397c420,424
< .user:last-of-type:after {
< 	content: " ";
< }
---
>       > .users {
>         > .user + .user:before {
>           content: ", ";
>           font-weight: normal;
>         }
399,404c426,437
< .form {
< 	max-height: 12em;
< 	overflow-y: scroll;
< 	border-top: solid 0.5px var(--divider);
< 	border-bottom-left-radius: 0;
< 	border-bottom-right-radius: 0;
---
>         > .user:last-of-type:after {
>           content: " ";
>         }
>       }
>     }
> 
>     > .form {
>       max-height: 12em;
>       overflow-y: scroll;
>       border-top: solid 0.5px var(--divider);
>     }
>   }
407,408c440,442
< .fade-enter-active, .fade-leave-active {
< 	transition: opacity 0.1s;
---
> .fade-enter-active,
> .fade-leave-active {
>   transition: opacity 0.1s;
411,413c445,448
< .fade-enter-from, .fade-leave-to {
< 	transition: opacity 0.5s;
< 	opacity: 0;
---
> .fade-enter-from,
> .fade-leave-to {
>   transition: opacity 0.5s;
>   opacity: 0;
diff --color=auto -r misskeyV13/packages/frontend/src/pages/mfm-cheat-sheet.vue RiricaV13/pages/mfm-cheat-sheet.vue
2,118c2,152
< <MkStickyContainer>
< 	<template #header><MkPageHeader/></template>
< 	<MkSpacer :content-max="800">
< 		<div class="mwysmxbg">
< 			<div>{{ i18n.ts._mfm.intro }}</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.mention }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.mentionDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_mention"/>
< 						<MkTextarea v-model="preview_mention"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.hashtag }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.hashtagDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_hashtag"/>
< 						<MkTextarea v-model="preview_hashtag"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.url }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.urlDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_url"/>
< 						<MkTextarea v-model="preview_url"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.link }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.linkDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_link"/>
< 						<MkTextarea v-model="preview_link"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.emoji }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.emojiDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_emoji"/>
< 						<MkTextarea v-model="preview_emoji"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.bold }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.boldDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_bold"/>
< 						<MkTextarea v-model="preview_bold"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.small }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.smallDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_small"/>
< 						<MkTextarea v-model="preview_small"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.quote }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.quoteDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_quote"/>
< 						<MkTextarea v-model="preview_quote"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.center }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.centerDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_center"/>
< 						<MkTextarea v-model="preview_center"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.inlineCode }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.inlineCodeDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_inlineCode"/>
< 						<MkTextarea v-model="preview_inlineCode"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.blockCode }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.blockCodeDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_blockCode"/>
< 						<MkTextarea v-model="preview_blockCode"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<!-- deprecated
< 		<div class="section">
---
>   <MkStickyContainer>
>     <template #header><MkPageHeader /></template>
>     <MkSpacer :content-max="800">
>       <div class="mwysmxbg">
>         <div>{{ i18n.ts._mfm.intro }}</div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.mention }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.mentionDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_mention" />
>               <MkTextarea v-model="preview_mention"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.hashtag }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.hashtagDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_hashtag" />
>               <MkTextarea v-model="preview_hashtag"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.url }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.urlDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_url" />
>               <MkTextarea v-model="preview_url"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.link }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.linkDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_link" />
>               <MkTextarea v-model="preview_link"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.emoji }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.emojiDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_emoji" />
>               <MkTextarea v-model="preview_emoji"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.bold }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.boldDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_bold" />
>               <MkTextarea v-model="preview_bold"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.small }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.smallDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_small" />
>               <MkTextarea v-model="preview_small"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.quote }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.quoteDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_quote" />
>               <MkTextarea v-model="preview_quote"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.center }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.centerDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_center" />
>               <MkTextarea v-model="preview_center"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.inlineCode }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.inlineCodeDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_inlineCode" />
>               <MkTextarea v-model="preview_inlineCode"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.blockCode }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.blockCodeDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_blockCode" />
>               <MkTextarea v-model="preview_blockCode"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.inlineMath }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.inlineMathDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_inlineMath" />
>               <MkTextarea v-model="preview_inlineMath"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <!-- deprecated
> 		<div class="section _block">
129,301c163,365
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.flip }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.flipDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_flip"/>
< 						<MkTextarea v-model="preview_flip"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.font }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.fontDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_font"/>
< 						<MkTextarea v-model="preview_font"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.x2 }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.x2Description }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_x2"/>
< 						<MkTextarea v-model="preview_x2"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.x3 }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.x3Description }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_x3"/>
< 						<MkTextarea v-model="preview_x3"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.x4 }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.x4Description }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_x4"/>
< 						<MkTextarea v-model="preview_x4"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.blur }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.blurDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_blur"/>
< 						<MkTextarea v-model="preview_blur"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.jelly }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.jellyDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_jelly"/>
< 						<MkTextarea v-model="preview_jelly"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.tada }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.tadaDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_tada"/>
< 						<MkTextarea v-model="preview_tada"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.jump }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.jumpDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_jump"/>
< 						<MkTextarea v-model="preview_jump"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.bounce }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.bounceDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_bounce"/>
< 						<MkTextarea v-model="preview_bounce"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.spin }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.spinDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_spin"/>
< 						<MkTextarea v-model="preview_spin"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.shake }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.shakeDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_shake"/>
< 						<MkTextarea v-model="preview_shake"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.twitch }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.twitchDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_twitch"/>
< 						<MkTextarea v-model="preview_twitch"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.rainbow }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.rainbowDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_rainbow"/>
< 						<MkTextarea v-model="preview_rainbow"><template #label>MFM</template></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.sparkle }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.sparkleDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_sparkle"/>
< 						<MkTextarea v-model="preview_sparkle"><span>MFM</span></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.rotate }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.rotateDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_rotate"/>
< 						<MkTextarea v-model="preview_rotate"><span>MFM</span></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 			<div class="section">
< 				<div class="title">{{ i18n.ts._mfm.plain }}</div>
< 				<div class="content">
< 					<p>{{ i18n.ts._mfm.plainDescription }}</p>
< 					<div class="preview">
< 						<Mfm :text="preview_plain"/>
< 						<MkTextarea v-model="preview_plain"><span>MFM</span></MkTextarea>
< 					</div>
< 				</div>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.flip }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.flipDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_flip" />
>               <MkTextarea v-model="preview_flip"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.font }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.fontDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_font" />
>               <MkTextarea v-model="preview_font"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.x2 }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.x2Description }}</p>
>             <div class="preview">
>               <Mfm :text="preview_x2" />
>               <MkTextarea v-model="preview_x2"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.x3 }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.x3Description }}</p>
>             <div class="preview">
>               <Mfm :text="preview_x3" />
>               <MkTextarea v-model="preview_x3"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.x4 }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.x4Description }}</p>
>             <div class="preview">
>               <Mfm :text="preview_x4" />
>               <MkTextarea v-model="preview_x4"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.blur }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.blurDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_blur" />
>               <MkTextarea v-model="preview_blur"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.jelly }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.jellyDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_jelly" />
>               <MkTextarea v-model="preview_jelly"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.tada }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.tadaDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_tada" />
>               <MkTextarea v-model="preview_tada"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.jump }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.jumpDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_jump" />
>               <MkTextarea v-model="preview_jump"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.bounce }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.bounceDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_bounce" />
>               <MkTextarea v-model="preview_bounce"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.spin }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.spinDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_spin" />
>               <MkTextarea v-model="preview_spin"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.shake }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.shakeDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_shake" />
>               <MkTextarea v-model="preview_shake"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.twitch }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.twitchDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_twitch" />
>               <MkTextarea v-model="preview_twitch"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.rainbow }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.rainbowDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_rainbow" />
>               <MkTextarea v-model="preview_rainbow"
>                 ><template #label>MFM</template></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.sparkle }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.sparkleDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_sparkle" />
>               <MkTextarea v-model="preview_sparkle"
>                 ><span>MFM</span></MkTextarea
>               >
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.rotate }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.rotateDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_rotate" />
>               <MkTextarea v-model="preview_rotate"><span>MFM</span></MkTextarea>
>             </div>
>           </div>
>         </div>
>         <div class="section _block">
>           <div class="title">{{ i18n.ts._mfm.plain }}</div>
>           <div class="content">
>             <p>{{ i18n.ts._mfm.plainDescription }}</p>
>             <div class="preview">
>               <Mfm :text="preview_plain" />
>               <MkTextarea v-model="preview_plain"><span>MFM</span></MkTextarea>
>             </div>
>           </div>
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
305,310c369,373
< import { defineComponent } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import { customEmojis } from '@/custom-emojis';
---
> import { defineComponent } from "vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
312,314c375,377
< let preview_mention = $ref('@example');
< let preview_hashtag = $ref('#test');
< let preview_url = $ref('https://example.com');
---
> let preview_mention = $ref("@example");
> let preview_hashtag = $ref("#test");
> let preview_url = $ref("https://example.com");
316c379,381
< let preview_emoji = $ref(customEmojis.value.length ? `:${customEmojis.value[0].name}:` : ':emojiname:');
---
> let preview_emoji = $ref(
>   instance.emojis.length ? `:${instance.emojis[0].name}:` : ":emojiname:"
> );
321c386,389
< let preview_blockCode = $ref('```\n~ (#i, 100) {\n\t<: ? ((i % 15) = 0) "FizzBuzz"\n\t\t.? ((i % 3) = 0) "Fizz"\n\t\t.? ((i % 5) = 0) "Buzz"\n\t\t. i\n}\n```');
---
> let preview_blockCode = $ref(
>   '```\n~ (#i, 100) {\n\t<: ? ((i % 15) = 0) "FizzBuzz"\n\t\t.? ((i % 3) = 0) "Fizz"\n\t\t.? ((i % 5) = 0) "Buzz"\n\t\t. i\n}\n```'
> );
> let preview_inlineMath = $ref("\\(x= \\frac{-b' \\pm \\sqrt{(b')^2-ac}}{a}\\)");
324,335c392,409
< let preview_jelly = $ref('$[jelly 🍮] $[jelly.speed=5s 🍮]');
< let preview_tada = $ref('$[tada 🍮] $[tada.speed=5s 🍮]');
< let preview_jump = $ref('$[jump 🍮] $[jump.speed=5s 🍮]');
< let preview_bounce = $ref('$[bounce 🍮] $[bounce.speed=5s 🍮]');
< let preview_shake = $ref('$[shake 🍮] $[shake.speed=5s 🍮]');
< let preview_twitch = $ref('$[twitch 🍮] $[twitch.speed=5s 🍮]');
< let preview_spin = $ref('$[spin 🍮] $[spin.left 🍮] $[spin.alternate 🍮]\n$[spin.x 🍮] $[spin.x,left 🍮] $[spin.x,alternate 🍮]\n$[spin.y 🍮] $[spin.y,left 🍮] $[spin.y,alternate 🍮]\n\n$[spin.speed=5s 🍮]');
< let preview_flip = $ref(`$[flip ${i18n.ts._mfm.dummy}]\n$[flip.v ${i18n.ts._mfm.dummy}]\n$[flip.h,v ${i18n.ts._mfm.dummy}]`);
< let preview_font = $ref(`$[font.serif ${i18n.ts._mfm.dummy}]\n$[font.monospace ${i18n.ts._mfm.dummy}]\n$[font.cursive ${i18n.ts._mfm.dummy}]\n$[font.fantasy ${i18n.ts._mfm.dummy}]`);
< let preview_x2 = $ref('$[x2 🍮]');
< let preview_x3 = $ref('$[x3 🍮]');
< let preview_x4 = $ref('$[x4 🍮]');
---
> let preview_jelly = $ref("$[jelly 🍮] $[jelly.speed=5s 🍮]");
> let preview_tada = $ref("$[tada 🍮] $[tada.speed=5s 🍮]");
> let preview_jump = $ref("$[jump 🍮] $[jump.speed=5s 🍮]");
> let preview_bounce = $ref("$[bounce 🍮] $[bounce.speed=5s 🍮]");
> let preview_shake = $ref("$[shake 🍮] $[shake.speed=5s 🍮]");
> let preview_twitch = $ref("$[twitch 🍮] $[twitch.speed=5s 🍮]");
> let preview_spin = $ref(
>   "$[spin 🍮] $[spin.left 🍮] $[spin.alternate 🍮]\n$[spin.x 🍮] $[spin.x,left 🍮] $[spin.x,alternate 🍮]\n$[spin.y 🍮] $[spin.y,left 🍮] $[spin.y,alternate 🍮]\n\n$[spin.speed=5s 🍮]"
> );
> let preview_flip = $ref(
>   `$[flip ${i18n.ts._mfm.dummy}]\n$[flip.v ${i18n.ts._mfm.dummy}]\n$[flip.h,v ${i18n.ts._mfm.dummy}]`
> );
> let preview_font = $ref(
>   `$[font.serif ${i18n.ts._mfm.dummy}]\n$[font.monospace ${i18n.ts._mfm.dummy}]\n$[font.cursive ${i18n.ts._mfm.dummy}]\n$[font.fantasy ${i18n.ts._mfm.dummy}]`
> );
> let preview_x2 = $ref("$[x2 🍮]");
> let preview_x3 = $ref("$[x3 🍮]");
> let preview_x4 = $ref("$[x4 🍮]");
337,340c411,416
< let preview_rainbow = $ref('$[rainbow 🍮] $[rainbow.speed=5s 🍮]');
< let preview_sparkle = $ref('$[sparkle 🍮]');
< let preview_rotate = $ref('$[rotate 🍮]');
< let preview_plain = $ref('<plain>**bold** @mention #hashtag `code` $[x2 🍮]</plain>');
---
> let preview_rainbow = $ref("$[rainbow 🍮] $[rainbow.speed=5s 🍮]");
> let preview_sparkle = $ref("$[sparkle 🍮]");
> let preview_rotate = $ref("$[rotate 🍮]");
> let preview_plain = $ref(
>   "<plain>**bold** @mention #hashtag `code` $[x2 🍮]</plain>"
> );
343,344c419,420
< 	title: i18n.ts._mfm.cheatSheet,
< 	icon: 'ti ti-question-circle',
---
>   title: i18n.ts._mfm.cheatSheet,
>   icon: "fas fa-question-circle",
350c426
< 	background: var(--bg);
---
>   background: var(--bg);
352,362c428,438
< 	> .section {
< 		> .title {
< 			position: sticky;
< 			z-index: 1;
< 			top: var(--stickyTop, 0px);
< 			padding: 16px;
< 			font-weight: bold;
< 			-webkit-backdrop-filter: var(--blur, blur(10px));
< 			backdrop-filter: var(--blur, blur(10px));
< 			background-color: var(--X16);
< 		}
---
>   > .section {
>     > .title {
>       position: sticky;
>       z-index: 1;
>       top: var(--stickyTop, 0px);
>       padding: 16px;
>       font-weight: bold;
>       -webkit-backdrop-filter: var(--blur, blur(10px));
>       backdrop-filter: var(--blur, blur(10px));
>       background-color: var(--X16);
>     }
364,368c440,444
< 		> .content {
< 			> p {
< 				margin: 0;
< 				padding: 16px;
< 			}
---
>     > .content {
>       > p {
>         margin: 0;
>         padding: 16px;
>       }
370,375c446,451
< 			> .preview {
< 				border-top: solid 0.5px var(--divider);
< 				padding: 16px;
< 			}
< 		}
< 	}
---
>       > .preview {
>         border-top: solid 0.5px var(--divider);
>         padding: 16px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/miauth.vue RiricaV13/pages/miauth.vue
2,38c2,44
< <MkSpacer :content-max="800">
< 	<div v-if="$i">
< 		<div v-if="state == 'waiting'" class="waiting">
< 			<div class="">
< 				<MkLoading/>
< 			</div>
< 		</div>
< 		<div v-if="state == 'denied'" class="denied">
< 			<div class="">
< 				<p>{{ i18n.ts._auth.denied }}</p>
< 			</div>
< 		</div>
< 		<div v-else-if="state == 'accepted'" class="accepted">
< 			<div class="">
< 				<p v-if="callback">{{ i18n.ts._auth.callback }}<MkEllipsis/></p>
< 				<p v-else>{{ i18n.ts._auth.pleaseGoBack }}</p>
< 			</div>
< 		</div>
< 		<div v-else class="">
< 			<div v-if="name" class="">{{ $t('_auth.shareAccess', { name: name }) }}</div>
< 			<div v-else class="">{{ i18n.ts._auth.shareAccessAsk }}</div>
< 			<div class="">
< 				<p>{{ i18n.ts._auth.permissionAsk }}</p>
< 				<ul>
< 					<li v-for="p in _permissions" :key="p">{{ $t(`_permissions.${p}`) }}</li>
< 				</ul>
< 			</div>
< 			<div class="">
< 				<MkButton inline @click="deny">{{ i18n.ts.cancel }}</MkButton>
< 				<MkButton inline primary @click="accept">{{ i18n.ts.accept }}</MkButton>
< 			</div>
< 		</div>
< 	</div>
< 	<div v-else class="signin">
< 		<MkSignin @login="onLogin"/>
< 	</div>
< </MkSpacer>
---
>   <MkSpacer :content-max="800">
>     <div v-if="$i">
>       <div v-if="state == 'waiting'" class="waiting _section">
>         <div class="_content">
>           <MkLoading />
>         </div>
>       </div>
>       <div v-if="state == 'denied'" class="denied _section">
>         <div class="_content">
>           <p>{{ i18n.ts._auth.denied }}</p>
>         </div>
>       </div>
>       <div v-else-if="state == 'accepted'" class="accepted _section">
>         <div class="_content">
>           <p v-if="callback">{{ i18n.ts._auth.callback }}<MkEllipsis /></p>
>           <p v-else>{{ i18n.ts._auth.pleaseGoBack }}</p>
>         </div>
>       </div>
>       <div v-else class="_section">
>         <div v-if="name" class="_title">
>           {{ $t("_auth.shareAccess", { name: name }) }}
>         </div>
>         <div v-else class="_title">{{ i18n.ts._auth.shareAccessAsk }}</div>
>         <div class="_content">
>           <p>{{ i18n.ts._auth.permissionAsk }}</p>
>           <ul>
>             <li v-for="p in _permissions" :key="p">
>               {{ $t(`_permissions.${p}`) }}
>             </li>
>           </ul>
>         </div>
>         <div class="_footer">
>           <MkButton inline @click="deny">{{ i18n.ts.cancel }}</MkButton>
>           <MkButton inline primary @click="accept">{{
>             i18n.ts.accept
>           }}</MkButton>
>         </div>
>       </div>
>     </div>
>     <div v-else class="signin">
>       <MkSignin @login="onLogin" />
>     </div>
>   </MkSpacer>
42,47c48,54
< import { } from 'vue';
< import MkSignin from '@/components/MkSignin.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { $i, login } from '@/account';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import MkSignin from "@/components/MkSignin.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { $i, login } from "@/account";
> import { appendQuery, query } from "@/scripts/url";
> import { i18n } from "@/i18n";
50,54c57,61
< 	session: string;
< 	callback?: string;
< 	name: string;
< 	icon: string;
< 	permission: string; // コンマ区切り
---
>   session: string;
>   callback?: string;
>   name: string;
>   icon: string;
>   permission: string; // コンマ区切り
57c64
< const _permissions = props.permission.split(',');
---
> const _permissions = props.permission.split(",");
62,68c69,75
< 	state = 'waiting';
< 	await os.api('miauth/gen-token', {
< 		session: props.session,
< 		name: props.name,
< 		iconUrl: props.icon,
< 		permission: _permissions,
< 	});
---
>   state = "waiting";
>   await os.api("miauth/gen-token", {
>     session: props.session,
>     name: props.name,
>     iconUrl: props.icon,
>     permission: _permissions,
>   });
70,75c77,85
< 	state = 'accepted';
< 	if (props.callback) {
< 		const cbUrl = new URL(props.callback);
< 		cbUrl.searchParams.set('session', props.session);
< 		location.href = cbUrl.href;
< 	}
---
>   state = "accepted";
>   if (props.callback) {
>     location.href = appendQuery(
>       props.callback,
>       query({
>         session: props.session,
>       })
>     );
>   }
79c89
< 	state = 'denied';
---
>   state = "denied";
83c93
< 	login(res.i);
---
>   login(res.i);
87,89c97
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-antennas/create.vue RiricaV13/pages/my-antennas/create.vue
2,4c2,4
< <div class="geegznzt">
< 	<XAntenna :antenna="draft" @created="onAntennaCreated"/>
< </div>
---
>   <div class="geegznzt">
>     <XAntenna :antenna="draft" @created="onAntennaCreated" />
>   </div>
8,12c8,12
< import { inject } from 'vue';
< import XAntenna from './editor.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { useRouter } from '@/router';
---
> import { inject } from "vue";
> import XAntenna from "./editor.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { useRouter } from "@/router";
17,27c17,27
< 	name: '',
< 	src: 'all',
< 	userListId: null,
< 	userGroupId: null,
< 	users: [],
< 	keywords: [],
< 	excludeKeywords: [],
< 	withReplies: false,
< 	caseSensitive: false,
< 	withFile: false,
< 	notify: false,
---
>   name: "",
>   src: "all",
>   userListId: null,
>   userGroupId: null,
>   users: [],
>   keywords: [],
>   excludeKeywords: [],
>   withReplies: false,
>   caseSensitive: false,
>   withFile: false,
>   notify: false,
31c31
< 	router.push('/my/antennas');
---
>   router.push("/my/antennas");
39,40c39,40
< 	title: i18n.ts.manageAntennas,
< 	icon: 'ti ti-antenna',
---
>   title: i18n.ts.manageAntennas,
>   icon: "fas fa-satellite",
44,46c44
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-antennas/edit.vue RiricaV13/pages/my-antennas/edit.vue
2,4c2,4
< <div class="">
< 	<XAntenna v-if="antenna" :antenna="antenna" @updated="onAntennaUpdated"/>
< </div>
---
>   <div class="">
>     <XAntenna v-if="antenna" :antenna="antenna" @updated="onAntennaUpdated" />
>   </div>
8,13c8,13
< import { inject, watch } from 'vue';
< import XAntenna from './editor.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { inject, watch } from "vue";
> import XAntenna from "./editor.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
20c20
< 	antennaId: string
---
>   antennaId: string;
24c24
< 	router.push('/my/antennas');
---
>   router.push("/my/antennas");
27,29c27,31
< os.api('antennas/show', { antennaId: props.antennaId }).then((antennaResponse) => {
< 	antenna = antennaResponse;
< });
---
> os.api("antennas/show", { antennaId: props.antennaId }).then(
>   (antennaResponse) => {
>     antenna = antennaResponse;
>   }
> );
36,37c38,39
< 	title: i18n.ts.manageAntennas,
< 	icon: 'ti ti-antenna',
---
>   title: i18n.ts.manageAntennas,
>   icon: "fas fa-satellite",
41,43c43
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-antennas/editor.vue RiricaV13/pages/my-antennas/editor.vue
2,46c2,73
< <MkSpacer :content-max="700">
< 	<div class="shaynizk">
< 		<div class="_gaps_m">
< 			<MkInput v-model="name">
< 				<template #label>{{ i18n.ts.name }}</template>
< 			</MkInput>
< 			<MkSelect v-model="src">
< 				<template #label>{{ i18n.ts.antennaSource }}</template>
< 				<option value="all">{{ i18n.ts._antennaSources.all }}</option>
< 				<!--<option value="home">{{ i18n.ts._antennaSources.homeTimeline }}</option>-->
< 				<option value="users">{{ i18n.ts._antennaSources.users }}</option>
< 				<!--<option value="list">{{ i18n.ts._antennaSources.userList }}</option>-->
< 				<!--<option value="group">{{ i18n.ts._antennaSources.userGroup }}</option>-->
< 			</MkSelect>
< 			<MkSelect v-if="src === 'list'" v-model="userListId">
< 				<template #label>{{ i18n.ts.userList }}</template>
< 				<option v-for="list in userLists" :key="list.id" :value="list.id">{{ list.name }}</option>
< 			</MkSelect>
< 			<MkSelect v-else-if="src === 'group'" v-model="userGroupId">
< 				<template #label>{{ i18n.ts.userGroup }}</template>
< 				<option v-for="group in userGroups" :key="group.id" :value="group.id">{{ group.name }}</option>
< 			</MkSelect>
< 			<MkTextarea v-else-if="src === 'users'" v-model="users">
< 				<template #label>{{ i18n.ts.users }}</template>
< 				<template #caption>{{ i18n.ts.antennaUsersDescription }} <button class="_textButton" @click="addUser">{{ i18n.ts.addUser }}</button></template>
< 			</MkTextarea>
< 			<MkSwitch v-model="withReplies">{{ i18n.ts.withReplies }}</MkSwitch>
< 			<MkTextarea v-model="keywords">
< 				<template #label>{{ i18n.ts.antennaKeywords }}</template>
< 				<template #caption>{{ i18n.ts.antennaKeywordsDescription }}</template>
< 			</MkTextarea>
< 			<MkTextarea v-model="excludeKeywords">
< 				<template #label>{{ i18n.ts.antennaExcludeKeywords }}</template>
< 				<template #caption>{{ i18n.ts.antennaKeywordsDescription }}</template>
< 			</MkTextarea>
< 			<MkSwitch v-model="caseSensitive">{{ i18n.ts.caseSensitive }}</MkSwitch>
< 			<MkSwitch v-model="withFile">{{ i18n.ts.withFileAntenna }}</MkSwitch>
< 			<MkSwitch v-model="notify">{{ i18n.ts.notifyAntenna }}</MkSwitch>
< 		</div>
< 		<div class="actions">
< 			<MkButton inline primary @click="saveAntenna()"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< 			<MkButton v-if="antenna.id != null" inline danger @click="deleteAntenna()"><i class="ti ti-trash"></i> {{ i18n.ts.delete }}</MkButton>
< 		</div>
< 	</div>
< </MkSpacer>
---
>   <div class="shaynizk">
>     <div class="form">
>       <MkInput v-model="name" class="_formBlock">
>         <template #label>{{ i18n.ts.name }}</template>
>       </MkInput>
>       <MkSelect v-model="src" class="_formBlock">
>         <template #label>{{ i18n.ts.antennaSource }}</template>
>         <option value="all">{{ i18n.ts._antennaSources.all }}</option>
>         <!--<option value="home">{{ i18n.ts._antennaSources.homeTimeline }}</option>-->
>         <option value="users">{{ i18n.ts._antennaSources.users }}</option>
>         <!--<option value="list">{{ i18n.ts._antennaSources.userList }}</option>-->
>         <!--<option value="group">{{ i18n.ts._antennaSources.userGroup }}</option>-->
>       </MkSelect>
>       <MkSelect v-if="src === 'list'" v-model="userListId" class="_formBlock">
>         <template #label>{{ i18n.ts.userList }}</template>
>         <option v-for="list in userLists" :key="list.id" :value="list.id">
>           {{ list.name }}
>         </option>
>       </MkSelect>
>       <MkSelect
>         v-else-if="src === 'group'"
>         v-model="userGroupId"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.userGroup }}</template>
>         <option v-for="group in userGroups" :key="group.id" :value="group.id">
>           {{ group.name }}
>         </option>
>       </MkSelect>
>       <MkTextarea
>         v-else-if="src === 'users'"
>         v-model="users"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.users }}</template>
>         <template #caption
>           >{{ i18n.ts.antennaUsersDescription }}
>           <button class="_textButton" @click="addUser">
>             {{ i18n.ts.addUser }}
>           </button></template
>         >
>       </MkTextarea>
>       <MkSwitch v-model="withReplies" class="_formBlock">{{
>         i18n.ts.withReplies
>       }}</MkSwitch>
>       <MkTextarea v-model="keywords" class="_formBlock">
>         <template #label>{{ i18n.ts.antennaKeywords }}</template>
>         <template #caption>{{ i18n.ts.antennaKeywordsDescription }}</template>
>       </MkTextarea>
>       <MkTextarea v-model="excludeKeywords" class="_formBlock">
>         <template #label>{{ i18n.ts.antennaExcludeKeywords }}</template>
>         <template #caption>{{ i18n.ts.antennaKeywordsDescription }}</template>
>       </MkTextarea>
>       <MkSwitch v-model="caseSensitive" class="_formBlock">{{
>         i18n.ts.caseSensitive
>       }}</MkSwitch>
>       <MkSwitch v-model="withFile" class="_formBlock">{{
>         i18n.ts.withFileAntenna
>       }}</MkSwitch>
>       <MkSwitch v-model="notify" class="_formBlock">{{
>         i18n.ts.notifyAntenna
>       }}</MkSwitch>
>     </div>
>     <div class="actions">
>       <MkButton inline primary @click="saveAntenna()"
>         ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>       >
>       <MkButton v-if="antenna.id != null" inline danger @click="deleteAntenna()"
>         ><i class="fas fa-trash"></i> {{ i18n.ts.delete }}</MkButton
>       >
>     </div>
>   </div>
50,58c77,85
< import { watch } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { watch } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
61c88
< 	antenna: any
---
>   antenna: any;
65,67c92,94
< 	(ev: 'created'): void,
< 	(ev: 'updated'): void,
< 	(ev: 'deleted'): void,
---
>   (ev: "created"): void;
>   (ev: "updated"): void;
>   (ev: "deleted"): void;
74,76c101,107
< let users: string = $ref(props.antenna.users.join('\n'));
< let keywords: string = $ref(props.antenna.keywords.map(x => x.join(' ')).join('\n'));
< let excludeKeywords: string = $ref(props.antenna.excludeKeywords.map(x => x.join(' ')).join('\n'));
---
> let users: string = $ref(props.antenna.users.join("\n"));
> let keywords: string = $ref(
>   props.antenna.keywords.map((x) => x.join(" ")).join("\n")
> );
> let excludeKeywords: string = $ref(
>   props.antenna.excludeKeywords.map((x) => x.join(" ")).join("\n")
> );
84,87c115,120
< watch(() => src, async () => {
< 	if (src === 'list' && userLists === null) {
< 		userLists = await os.api('users/lists/list');
< 	}
---
> watch(
>   () => src,
>   async () => {
>     if (src === "list" && userLists === null) {
>       userLists = await os.api("users/lists/list");
>     }
89,91c122,124
< 	if (src === 'group' && userGroups === null) {
< 		const groups1 = await os.api('users/groups/owned');
< 		const groups2 = await os.api('users/groups/joined');
---
>     if (src === "group" && userGroups === null) {
>       const groups1 = await os.api("users/groups/owned");
>       const groups2 = await os.api("users/groups/joined");
93,95c126,129
< 		userGroups = [...groups1, ...groups2];
< 	}
< });
---
>       userGroups = [...groups1, ...groups2];
>     }
>   }
> );
98,110c132,153
< 	const antennaData = {
< 		name,
< 		src,
< 		userListId,
< 		userGroupId,
< 		withReplies,
< 		withFile,
< 		notify,
< 		caseSensitive,
< 		users: users.trim().split('\n').map(x => x.trim()),
< 		keywords: keywords.trim().split('\n').map(x => x.trim().split(' ')),
< 		excludeKeywords: excludeKeywords.trim().split('\n').map(x => x.trim().split(' ')),
< 	};
---
>   const antennaData = {
>     name,
>     src,
>     userListId,
>     userGroupId,
>     withReplies,
>     withFile,
>     notify,
>     caseSensitive,
>     users: users
>       .trim()
>       .split("\n")
>       .map((x) => x.trim()),
>     keywords: keywords
>       .trim()
>       .split("\n")
>       .map((x) => x.trim().split(" ")),
>     excludeKeywords: excludeKeywords
>       .trim()
>       .split("\n")
>       .map((x) => x.trim().split(" ")),
>   };
112,119c155,162
< 	if (props.antenna.id == null) {
< 		await os.apiWithDialog('antennas/create', antennaData);
< 		emit('created');
< 	} else {
< 		antennaData['antennaId'] = props.antenna.id;
< 		await os.apiWithDialog('antennas/update', antennaData);
< 		emit('updated');
< 	}
---
>   if (props.antenna.id == null) {
>     await os.apiWithDialog("antennas/create", antennaData);
>     emit("created");
>   } else {
>     antennaData["antennaId"] = props.antenna.id;
>     await os.apiWithDialog("antennas/update", antennaData);
>     emit("updated");
>   }
123,127c166,170
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: props.antenna.name }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: props.antenna.name }),
>   });
>   if (canceled) return;
129,131c172,174
< 	await os.api('antennas/delete', {
< 		antennaId: props.antenna.id,
< 	});
---
>   await os.api("antennas/delete", {
>     antennaId: props.antenna.id,
>   });
133,134c176,177
< 	os.success();
< 	emit('deleted');
---
>   os.success();
>   emit("deleted");
138,142c181,185
< 	os.selectUser().then(user => {
< 		users = users.trim();
< 		users += '\n@' + Acct.toString(user as any);
< 		users = users.trim();
< 	});
---
>   os.selectUser().then((user) => {
>     users = users.trim();
>     users += "\n@" + Acct.toString(user as any);
>     users = users.trim();
>   });
148,152c191,198
< 	> .actions {
< 		margin-top: 16px;
< 		padding: 24px 0;
< 		border-top: solid 0.5px var(--divider);
< 	}
---
>   > .form {
>     padding: 32px;
>   }
> 
>   > .actions {
>     padding: 24px 32px;
>     border-top: solid 0.5px var(--divider);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-antennas/index.vue RiricaV13/pages/my-antennas/index.vue
1,5c1,10
< <template><MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 		<MkSpacer :content-max="700">
< 	<div class="ieepwinx">
< 		<MkButton :link="true" to="/my/antennas/create" primary class="add"><i class="ti ti-plus"></i> {{ i18n.ts.add }}</MkButton>
---
> <template>
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="ieepwinx">
>         <MkButton :link="true" to="/my/antennas/create" primary class="add"
>           ><i class="fas fa-plus"></i> {{ i18n.ts.add }}</MkButton
>         >
7,15c12,26
< 		<div class="">
< 			<MkPagination v-slot="{items}" ref="list" :pagination="pagination">
< 				<MkA v-for="antenna in items" :key="antenna.id" class="ljoevbzj" :to="`/my/antennas/${antenna.id}`">
< 					<div class="name">{{ antenna.name }}</div>
< 				</MkA>
< 			</MkPagination>
< 		</div>
< 	</div>
< </MkSpacer></MkStickyContainer>
---
>         <div class="">
>           <MkPagination v-slot="{ items }" ref="list" :pagination="pagination">
>             <MkA
>               v-for="antenna in items"
>               :key="antenna.id"
>               class="ljoevbzj"
>               :to="`/my/antennas/${antenna.id}`"
>             >
>               <div class="name">{{ antenna.name }}</div>
>             </MkA>
>           </MkPagination>
>         </div>
>       </div>
>     </MkSpacer></MkStickyContainer
>   >
19,23c30,34
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
26,27c37,38
< 	endpoint: 'antennas/list' as const,
< 	limit: 10,
---
>   endpoint: "antennas/list" as const,
>   limit: 10,
35,36c46,47
< 	title: i18n.ts.manageAntennas,
< 	icon: 'ti ti-antenna',
---
>   title: i18n.ts.manageAntennas,
>   icon: "fas fa-satellite",
41a53,55
>   > .add {
>     margin: 0 auto 16px auto;
>   }
43,45c57,62
< 	> .add {
< 		margin: 0 auto 16px auto;
< 	}
---
>   .ljoevbzj {
>     display: block;
>     padding: 16px;
>     margin-bottom: 8px;
>     border: solid 1px var(--divider);
>     border-radius: 6px;
47,52c64,67
< 	.ljoevbzj {
< 		display: block;
< 		padding: 16px;
< 		margin-bottom: 8px;
< 		border: solid 1px var(--divider);
< 		border-radius: 6px;
---
>     &:hover {
>       border: solid 1px var(--accent);
>       text-decoration: none;
>     }
54,62c69,72
< 		&:hover {
< 			border: solid 1px var(--accent);
< 			text-decoration: none;
< 		}
< 
< 		> .name {
< 			font-weight: bold;
< 		}
< 	}
---
>     > .name {
>       font-weight: bold;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-clips/index.vue RiricaV13/pages/my-clips/index.vue
2,6c2,10
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="qtcaoidl">
< 			<MkButton primary class="add" @click="create"><i class="ti ti-plus"></i> {{ i18n.ts.add }}</MkButton>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="qtcaoidl">
>         <MkButton primary class="add" @click="create"
>           ><i class="fas fa-plus"></i> {{ i18n.ts.add }}</MkButton
>         >
8,16c12,32
< 			<MkPagination v-slot="{items}" ref="pagingComponent" :pagination="pagination" class="list">
< 				<MkA v-for="item in items" :key="item.id" :to="`/clips/${item.id}`" class="item _panel _margin">
< 					<b>{{ item.name }}</b>
< 					<div v-if="item.description" class="description">{{ item.description }}</div>
< 				</MkA>
< 			</MkPagination>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <MkPagination
>           v-slot="{ items }"
>           ref="pagingComponent"
>           :pagination="pagination"
>           class="list"
>         >
>           <MkA
>             v-for="item in items"
>             :key="item.id"
>             :to="`/clips/${item.id}`"
>             class="item _panel _gap"
>           >
>             <b>{{ item.name }}</b>
>             <div v-if="item.description" class="description">
>               {{ item.description }}
>             </div>
>           </MkA>
>         </MkPagination>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
20,25c36,41
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
28,29c44,45
< 	endpoint: 'clips/list' as const,
< 	limit: 10,
---
>   endpoint: "clips/list" as const,
>   limit: 10,
32c48
< const pagingComponent = $shallowRef<InstanceType<typeof MkPagination>>();
---
> const pagingComponent = $ref<InstanceType<typeof MkPagination>>();
35,52c51,68
< 	const { canceled, result } = await os.form(i18n.ts.createNewClip, {
< 		name: {
< 			type: 'string',
< 			label: i18n.ts.name,
< 		},
< 		description: {
< 			type: 'string',
< 			required: false,
< 			multiline: true,
< 			label: i18n.ts.description,
< 		},
< 		isPublic: {
< 			type: 'boolean',
< 			label: i18n.ts.public,
< 			default: false,
< 		},
< 	});
< 	if (canceled) return;
---
>   const { canceled, result } = await os.form(i18n.ts.createNewClip, {
>     name: {
>       type: "string",
>       label: i18n.ts.name,
>     },
>     description: {
>       type: "string",
>       required: false,
>       multiline: true,
>       label: i18n.ts.description,
>     },
>     isPublic: {
>       type: "boolean",
>       label: i18n.ts.public,
>       default: false,
>     },
>   });
>   if (canceled) return;
54c70
< 	os.apiWithDialog('clips/create', result);
---
>   os.apiWithDialog("clips/create", result);
56c72
< 	pagingComponent.reload();
---
>   pagingComponent.reload();
60c76
< 	pagingComponent.reload();
---
>   pagingComponent.reload();
64c80
< 	pagingComponent.reload();
---
>   pagingComponent.reload();
72,77c88,93
< 	title: i18n.ts.clip,
< 	icon: 'ti ti-paperclip',
< 	action: {
< 		icon: 'ti ti-plus',
< 		handler: create,
< 	},
---
>   title: i18n.ts.clip,
>   icon: "fas fa-paperclip",
>   action: {
>     icon: "fas fa-plus",
>     handler: create,
>   },
83,85c99,101
< 	> .add {
< 		margin: 0 auto 16px auto;
< 	}
---
>   > .add {
>     margin: 0 auto 16px auto;
>   }
87,90c103,106
< 	> .list {
< 		> .item {
< 			display: block;
< 			padding: 16px;
---
>   > .list {
>     > .item {
>       display: block;
>       padding: 16px;
92,98c108,114
< 			> .description {
< 				margin-top: 8px;
< 				padding-top: 8px;
< 				border-top: solid 0.5px var(--divider);
< 			}
< 		}
< 	}
---
>       > .description {
>         margin-top: 8px;
>         padding-top: 8px;
>         border-top: solid 0.5px var(--divider);
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-lists/index.vue RiricaV13/pages/my-lists/index.vue
2,6c2,10
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="qkcjvfiv">
< 			<MkButton primary class="add" @click="create"><i class="ti ti-plus"></i> {{ i18n.ts.createList }}</MkButton>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="qkcjvfiv">
>         <MkButton primary class="add" @click="create"
>           ><i class="fas fa-plus"></i> {{ i18n.ts.createList }}</MkButton
>         >
8,16c12,30
< 			<MkPagination v-slot="{items}" ref="pagingComponent" :pagination="pagination" class="lists">
< 				<MkA v-for="list in items" :key="list.id" class="list _panel" :to="`/my/lists/${ list.id }`">
< 					<div class="name">{{ list.name }}</div>
< 					<MkAvatars :user-ids="list.userIds"/>
< 				</MkA>
< 			</MkPagination>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <MkPagination
>           v-slot="{ items }"
>           ref="pagingComponent"
>           :pagination="pagination"
>           class="lists _content"
>         >
>           <MkA
>             v-for="list in items"
>             :key="list.id"
>             class="list _panel"
>             :to="`/my/lists/${list.id}`"
>           >
>             <div class="name">{{ list.name }}</div>
>             <MkAvatars :user-ids="list.userIds" />
>           </MkA>
>         </MkPagination>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
20,26c34,40
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkAvatars from '@/components/MkAvatars.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkAvatars from "@/components/MkAvatars.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
28c42
< const pagingComponent = $shallowRef<InstanceType<typeof MkPagination>>();
---
> const pagingComponent = $ref<InstanceType<typeof MkPagination>>();
31,32c45,46
< 	endpoint: 'users/lists/list' as const,
< 	limit: 10,
---
>   endpoint: "users/lists/list" as const,
>   limit: 10,
36,41c50,55
< 	const { canceled, result: name } = await os.inputText({
< 		title: i18n.ts.enterListName,
< 	});
< 	if (canceled) return;
< 	await os.apiWithDialog('users/lists/create', { name: name });
< 	pagingComponent.reload();
---
>   const { canceled, result: name } = await os.inputText({
>     title: i18n.ts.enterListName,
>   });
>   if (canceled) return;
>   await os.apiWithDialog("users/lists/create", { name: name });
>   pagingComponent.reload();
49,54c63,68
< 	title: i18n.ts.manageLists,
< 	icon: 'ti ti-list',
< 	action: {
< 		icon: 'ti ti-plus',
< 		handler: create,
< 	},
---
>   title: i18n.ts.manageLists,
>   icon: "fas fa-list-ul",
>   action: {
>     icon: "fas fa-plus",
>     handler: create,
>   },
60,62c74,76
< 	> .add {
< 		margin: 0 auto var(--margin) auto;
< 	}
---
>   > .add {
>     margin: 0 auto var(--margin) auto;
>   }
64,69c78,83
< 	> .lists {
< 		> .list {
< 			display: block;
< 			padding: 16px;
< 			border: solid 1px var(--divider);
< 			border-radius: 6px;
---
>   > .lists {
>     > .list {
>       display: block;
>       padding: 16px;
>       border: solid 1px var(--divider);
>       border-radius: 6px;
71,74c85,88
< 			&:hover {
< 				border: solid 1px var(--accent);
< 				text-decoration: none;
< 			}
---
>       &:hover {
>         border: solid 1px var(--accent);
>         text-decoration: none;
>       }
76,80c90,94
< 			> .name {
< 				margin-bottom: 4px;
< 			}
< 		}
< 	}
---
>       > .name {
>         margin-bottom: 4px;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/my-lists/list.vue RiricaV13/pages/my-lists/list.vue
2,14c2,22
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="mk-list-page">
< 			<Transition :name="$store.state.animation ? '_transition_zoom' : ''" mode="out-in">
< 				<div v-if="list" class="">
< 					<div class="">
< 						<MkButton inline @click="addUser()">{{ i18n.ts.addUser }}</MkButton>
< 						<MkButton inline @click="renameList()">{{ i18n.ts.rename }}</MkButton>
< 						<MkButton inline @click="deleteList()">{{ i18n.ts.delete }}</MkButton>
< 					</div>
< 				</div>
< 			</Transition>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="mk-list-page">
>         <transition :name="$store.state.animation ? 'zoom' : ''" mode="out-in">
>           <div v-if="list" class="_section">
>             <div class="_content">
>               <MkButton inline @click="addUser()">{{
>                 i18n.ts.addUser
>               }}</MkButton>
>               <MkButton inline @click="renameList()">{{
>                 i18n.ts.rename
>               }}</MkButton>
>               <MkButton inline @click="deleteList()">{{
>                 i18n.ts.delete
>               }}</MkButton>
>             </div>
>           </div>
>         </transition>
16,37c24,51
< 			<Transition :name="$store.state.animation ? '_transition_zoom' : ''" mode="out-in">
< 				<div v-if="list" class="members _margin">
< 					<div class="">{{ i18n.ts.members }}</div>
< 					<div class="">
< 						<div class="users">
< 							<div v-for="user in users" :key="user.id" class="user _panel">
< 								<MkAvatar :user="user" class="avatar" indicator link preview/>
< 								<div class="body">
< 									<MkUserName :user="user" class="name"/>
< 									<MkAcct :user="user" class="acct"/>
< 								</div>
< 								<div class="action">
< 									<button class="_button" @click="removeUser(user)"><i class="ti ti-x"></i></button>
< 								</div>
< 							</div>
< 						</div>
< 					</div>
< 				</div>
< 			</Transition>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <transition :name="$store.state.animation ? 'zoom' : ''" mode="out-in">
>           <div v-if="list" class="_section members _gap">
>             <div class="_title">{{ i18n.ts.members }}</div>
>             <div class="_content">
>               <div class="users">
>                 <div v-for="user in users" :key="user.id" class="user _panel">
>                   <MkAvatar
>                     :user="user"
>                     class="avatar"
>                     :show-indicator="true"
>                   />
>                   <div class="body">
>                     <MkUserName :user="user" class="name" />
>                     <MkAcct :user="user" class="acct" />
>                   </div>
>                   <div class="action">
>                     <button class="_button" @click="removeUser(user)">
>                       <i class="fas fa-times"></i>
>                     </button>
>                   </div>
>                 </div>
>               </div>
>             </div>
>           </div>
>         </transition>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
41,46c55,60
< import { computed, watch } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { mainRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, watch } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { mainRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
49c63
< 	listId: string;
---
>   listId: string;
56,65c70,79
< 	os.api('users/lists/show', {
< 		listId: props.listId,
< 	}).then(_list => {
< 		list = _list;
< 		os.api('users/show', {
< 			userIds: list.userIds,
< 		}).then(_users => {
< 			users = _users;
< 		});
< 	});
---
>   os.api("users/lists/show", {
>     listId: props.listId,
>   }).then((_list) => {
>     list = _list;
>     os.api("users/show", {
>       userIds: list.userIds,
>     }).then((_users) => {
>       users = _users;
>     });
>   });
69,76c83,90
< 	os.selectUser().then(user => {
< 		os.apiWithDialog('users/lists/push', {
< 			listId: list.id,
< 			userId: user.id,
< 		}).then(() => {
< 			users.push(user);
< 		});
< 	});
---
>   os.selectUser().then((user) => {
>     os.apiWithDialog("users/lists/push", {
>       listId: list.id,
>       userId: user.id,
>     }).then(() => {
>       users.push(user);
>     });
>   });
80,85c94,99
< 	os.api('users/lists/pull', {
< 		listId: list.id,
< 		userId: user.id,
< 	}).then(() => {
< 		users = users.filter(x => x.id !== user.id);
< 	});
---
>   os.api("users/lists/pull", {
>     listId: list.id,
>     userId: user.id,
>   }).then(() => {
>     users = users.filter((x) => x.id !== user.id);
>   });
89,93c103,107
< 	const { canceled, result: name } = await os.inputText({
< 		title: i18n.ts.enterListName,
< 		default: list.name,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: name } = await os.inputText({
>     title: i18n.ts.enterListName,
>     default: list.name,
>   });
>   if (canceled) return;
95,98c109,112
< 	await os.api('users/lists/update', {
< 		listId: list.id,
< 		name: name,
< 	});
---
>   await os.api("users/lists/update", {
>     listId: list.id,
>     name: name,
>   });
100c114
< 	list.name = name;
---
>   list.name = name;
104,108c118,122
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: list.name }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: list.name }),
>   });
>   if (canceled) return;
110,114c124,128
< 	await os.api('users/lists/delete', {
< 		listId: list.id,
< 	});
< 	os.success();
< 	mainRouter.push('/my/lists');
---
>   await os.api("users/lists/delete", {
>     listId: list.id,
>   });
>   os.success();
>   mainRouter.push("/my/lists");
123,126c137,146
< definePageMetadata(computed(() => list ? {
< 	title: list.name,
< 	icon: 'ti ti-list',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     list
>       ? {
>           title: list.name,
>           icon: "fas fa-list-ul",
>         }
>       : null
>   )
> );
131,137c151,157
< 	> .members {
< 		> ._content {
< 			> .users {
< 				> .user {
< 					display: flex;
< 					align-items: center;
< 					padding: 16px;
---
>   > .members {
>     > ._content {
>       > .users {
>         > .user {
>           display: flex;
>           align-items: center;
>           padding: 16px;
139,142c159,162
< 					> .avatar {
< 						width: 50px;
< 						height: 50px;
< 					}
---
>           > .avatar {
>             width: 50px;
>             height: 50px;
>           }
144,146c164,166
< 					> .body {
< 						flex: 1;
< 						padding: 8px;
---
>           > .body {
>             flex: 1;
>             padding: 8px;
148,151c168,171
< 						> .name {
< 							display: block;
< 							font-weight: bold;
< 						}
---
>             > .name {
>               display: block;
>               font-weight: bold;
>             }
153,160c173,180
< 						> .acct {
< 							opacity: 0.5;
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
---
>             > .acct {
>               opacity: 0.5;
>             }
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/not-found.vue RiricaV13/pages/not-found.vue
2,7c2,7
< <div class="ipledcug">
< 	<div class="_fullinfo">
< 		<img src="https://xn--931a.moe/assets/not-found.jpg" class="_ghost"/>
< 		<div>{{ i18n.ts.notFoundDescription }}</div>
< 	</div>
< </div>
---
>   <div class="ipledcug">
>     <div class="_fullinfo">
>       <img src="https://xn--931a.moe/assets/not-found.jpg" class="_ghost" />
>       <div>{{ i18n.ts.notFoundDescription }}</div>
>     </div>
>   </div>
11,12c11,12
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
19,20c19,20
< 	title: i18n.ts.notFound,
< 	icon: 'ti ti-alert-triangle',
---
>   title: i18n.ts.notFound,
>   icon: "fas fa-exclamation-triangle",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/note.vue RiricaV13/pages/note.vue
2,10c2,16
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<div class="fcuexfpr">
< 			<Transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
< 				<div v-if="note" class="note">
< 					<div v-if="showNext" class="_margin">
< 						<XNotes class="" :pagination="nextPagination" :no-gap="true"/>
< 					</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <div class="fcuexfpr">
>         <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>           <div v-if="note" class="note">
>             <div v-if="showNext" class="_gap">
>               <XNotes
>                 class="_content"
>                 :pagination="nextPagination"
>                 :no-gap="true"
>               />
>             </div>
12,29c18,64
< 					<div class="main _margin">
< 						<MkButton v-if="!showNext && hasNext" class="load next" @click="showNext = true"><i class="ti ti-chevron-up"></i></MkButton>
< 						<div class="note _margin _gaps_s">
< 							<MkRemoteCaution v-if="note.user.host != null" :href="note.url ?? note.uri"/>
< 							<XNoteDetailed :key="note.id" v-model:note="note" class="note"/>
< 						</div>
< 						<div v-if="clips && clips.length > 0" class="clips _margin">
< 							<div class="title">{{ i18n.ts.clip }}</div>
< 							<MkA v-for="item in clips" :key="item.id" :to="`/clips/${item.id}`" class="item _panel _margin">
< 								<b>{{ item.name }}</b>
< 								<div v-if="item.description" class="description">{{ item.description }}</div>
< 								<div class="user">
< 									<MkAvatar :user="item.user" class="avatar" indicator link preview/> <MkUserName :user="item.user" :nowrap="false"/>
< 								</div>
< 							</MkA>
< 						</div>
< 						<MkButton v-if="!showPrev && hasPrev" class="load prev" @click="showPrev = true"><i class="ti ti-chevron-down"></i></MkButton>
< 					</div>
---
>             <div class="main _gap">
>               <MkButton
>                 v-if="!showNext && hasNext"
>                 class="load next"
>                 @click="showNext = true"
>                 ><i class="fas fa-chevron-up"></i
>               ></MkButton>
>               <div class="note _gap">
>                 <MkRemoteCaution
>                   v-if="note.user.host != null"
>                   :href="note.url ?? note.uri"
>                 />
>                 <XNoteDetailed
>                   :key="note.id"
>                   v-model:note="note"
>                   class="note"
>                 />
>               </div>
>               <div v-if="clips && clips.length > 0" class="_content clips _gap">
>                 <div class="title">{{ i18n.ts.clip }}</div>
>                 <MkA
>                   v-for="item in clips"
>                   :key="item.id"
>                   :to="`/clips/${item.id}`"
>                   class="item _panel _gap"
>                 >
>                   <b>{{ item.name }}</b>
>                   <div v-if="item.description" class="description">
>                     {{ item.description }}
>                   </div>
>                   <div class="user">
>                     <MkAvatar
>                       :user="item.user"
>                       class="avatar"
>                       :show-indicator="true"
>                     />
>                     <MkUserName :user="item.user" :nowrap="false" />
>                   </div>
>                 </MkA>
>               </div>
>               <MkButton
>                 v-if="!showPrev && hasPrev"
>                 class="load prev"
>                 @click="showPrev = true"
>                 ><i class="fas fa-chevron-down"></i
>               ></MkButton>
>             </div>
31,40c66,79
< 					<div v-if="showPrev" class="_margin">
< 						<XNotes class="" :pagination="prevPagination" :no-gap="true"/>
< 					</div>
< 				</div>
< 				<MkError v-else-if="error" @retry="fetch()"/>
< 				<MkLoading v-else/>
< 			</Transition>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>             <div v-if="showPrev" class="_gap">
>               <XNotes
>                 class="_content"
>                 :pagination="prevPagination"
>                 :no-gap="true"
>               />
>             </div>
>           </div>
>           <MkError v-else-if="error" @retry="fetch()" />
>           <MkLoading v-else />
>         </transition>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
44,54c83,92
< import { computed, defineComponent, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import XNote from '@/components/MkNote.vue';
< import XNoteDetailed from '@/components/MkNoteDetailed.vue';
< import XNotes from '@/components/MkNotes.vue';
< import MkRemoteCaution from '@/components/MkRemoteCaution.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { dateString } from '@/filters/date';
---
> import { computed, defineComponent, watch } from "vue";
> import * as misskey from "misskey-js";
> import XNote from "@/components/MkNote.vue";
> import XNoteDetailed from "@/components/MkNoteDetailed.vue";
> import XNotes from "@/components/MkNotes.vue";
> import MkRemoteCaution from "@/components/MkRemoteCaution.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
57c95
< 	noteId: string;
---
>   noteId: string;
69,74c107,116
< 	endpoint: 'users/notes' as const,
< 	limit: 10,
< 	params: computed(() => note ? ({
< 		userId: note.userId,
< 		untilId: note.id,
< 	}) : null),
---
>   endpoint: "users/notes" as const,
>   limit: 10,
>   params: computed(() =>
>     note
>       ? {
>           userId: note.userId,
>           untilId: note.id,
>         }
>       : null
>   ),
78,84c120,130
< 	reversed: true,
< 	endpoint: 'users/notes' as const,
< 	limit: 10,
< 	params: computed(() => note ? ({
< 		userId: note.userId,
< 		sinceId: note.id,
< 	}) : null),
---
>   reversed: true,
>   endpoint: "users/notes" as const,
>   limit: 10,
>   params: computed(() =>
>     note
>       ? {
>           userId: note.userId,
>           sinceId: note.id,
>         }
>       : null
>   ),
88,118c134,166
< 	hasPrev = false;
< 	hasNext = false;
< 	showPrev = false;
< 	showNext = false;
< 	note = null;
< 	os.api('notes/show', {
< 		noteId: props.noteId,
< 	}).then(res => {
< 		note = res;
< 		Promise.all([
< 			os.api('notes/clips', {
< 				noteId: note.id,
< 			}),
< 			os.api('users/notes', {
< 				userId: note.userId,
< 				untilId: note.id,
< 				limit: 1,
< 			}),
< 			os.api('users/notes', {
< 				userId: note.userId,
< 				sinceId: note.id,
< 				limit: 1,
< 			}),
< 		]).then(([_clips, prev, next]) => {
< 			clips = _clips;
< 			hasPrev = prev.length !== 0;
< 			hasNext = next.length !== 0;
< 		});
< 	}).catch(err => {
< 		error = err;
< 	});
---
>   hasPrev = false;
>   hasNext = false;
>   showPrev = false;
>   showNext = false;
>   note = null;
>   os.api("notes/show", {
>     noteId: props.noteId,
>   })
>     .then((res) => {
>       note = res;
>       Promise.all([
>         os.api("notes/clips", {
>           noteId: note.id,
>         }),
>         os.api("users/notes", {
>           userId: note.userId,
>           untilId: note.id,
>           limit: 1,
>         }),
>         os.api("users/notes", {
>           userId: note.userId,
>           sinceId: note.id,
>           limit: 1,
>         }),
>       ]).then(([_clips, prev, next]) => {
>         clips = _clips;
>         hasPrev = prev.length !== 0;
>         hasNext = next.length !== 0;
>       });
>     })
>     .catch((err) => {
>       error = err;
>     });
122c170
< 	immediate: true,
---
>   immediate: true,
129,138c177,192
< definePageMetadata(computed(() => note ? {
< 	title: i18n.ts.note,
< 	subtitle: dateString(note.createdAt),
< 	avatar: note.user,
< 	path: `/notes/${note.id}`,
< 	share: {
< 		title: i18n.t('noteOf', { user: note.user.name }),
< 		text: note.text,
< 	},
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     note
>       ? {
>           title: i18n.ts.note,
>           subtitle: new Date(note.createdAt).toLocaleString(),
>           avatar: note.user,
>           path: `/notes/${note.id}`,
>           share: {
>             title: i18n.t("noteOf", { user: note.user.name }),
>             text: note.text,
>           },
>         }
>       : null
>   )
> );
144c198
< 	transition: opacity 0.125s ease;
---
>   transition: opacity 0.125s ease;
148c202
< 	opacity: 0;
---
>   opacity: 0;
152c206
< 	background: var(--bg);
---
>   background: var(--bg);
154,159c208,213
< 	> .note {
< 		> .main {
< 			> .load {
< 				min-width: 0;
< 				margin: 0 auto;
< 				border-radius: 999px;
---
>   > .note {
>     > .main {
>       > .load {
>         min-width: 0;
>         margin: 0 auto;
>         border-radius: 999px;
161,163c215,217
< 				&.next {
< 					margin-bottom: var(--margin);
< 				}
---
>         &.next {
>           margin-bottom: var(--margin);
>         }
165,168c219,222
< 				&.prev {
< 					margin-top: var(--margin);
< 				}
< 			}
---
>         &.prev {
>           margin-top: var(--margin);
>         }
>       }
170,175c224,229
< 			> .note {
< 				> .note {
< 					border-radius: var(--radius);
< 					background: var(--panel);
< 				}
< 			}
---
>       > .note {
>         > .note {
>           border-radius: var(--radius);
>           background: var(--panel);
>         }
>       }
177,181c231,235
< 			> .clips {
< 				> .title {
< 					font-weight: bold;
< 					padding: 12px;
< 				}
---
>       > .clips {
>         > .title {
>           font-weight: bold;
>           padding: 12px;
>         }
183,185c237,239
< 				> .item {
< 					display: block;
< 					padding: 16px;
---
>         > .item {
>           display: block;
>           padding: 16px;
187,189c241,243
< 					> .description {
< 						padding: 8px 0;
< 					}
---
>           > .description {
>             padding: 8px 0;
>           }
191,195c245,249
< 					> .user {
< 						$height: 32px;
< 						padding-top: 16px;
< 						border-top: solid 0.5px var(--divider);
< 						line-height: $height;
---
>           > .user {
>             $height: 32px;
>             padding-top: 16px;
>             border-top: solid 0.5px var(--divider);
>             line-height: $height;
197,205c251,259
< 						> .avatar {
< 							width: $height;
< 							height: $height;
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
---
>             > .avatar {
>               width: $height;
>               height: $height;
>             }
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/notifications.vue RiricaV13/pages/notifications.vue
2,15c2,24
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<div v-if="tab === 'all' || tab === 'unread'">
< 			<XNotifications class="notifications" :include-types="includeTypes" :unread-only="unreadOnly"/>
< 		</div>
< 		<div v-else-if="tab === 'mentions'">
< 			<XNotes :pagination="mentionsPagination"/>
< 		</div>
< 		<div v-else-if="tab === 'directNotes'">
< 			<XNotes :pagination="directNotesPagination"/>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <div v-if="tab === 'all' || tab === 'unread'">
>         <XNotifications
>           class="notifications"
>           :include-types="includeTypes"
>           :unread-only="unreadOnly"
>         />
>       </div>
>       <div v-else-if="tab === 'mentions'">
>         <XNotes :pagination="mentionsPagination" />
>       </div>
>       <div v-else-if="tab === 'directNotes'">
>         <XNotes :pagination="directNotesPagination" />
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
19,25c28,34
< import { computed } from 'vue';
< import { notificationTypes } from 'misskey-js';
< import XNotifications from '@/components/MkNotifications.vue';
< import XNotes from '@/components/MkNotes.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed } from "vue";
> import { notificationTypes } from "misskey-js";
> import XNotifications from "@/components/MkNotifications.vue";
> import XNotes from "@/components/MkNotes.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
27c36
< let tab = $ref('all');
---
> let tab = $ref("all");
29c38
< let unreadOnly = $computed(() => tab === 'unread');
---
> let unreadOnly = $computed(() => tab === "unread");
32,33c41,42
< 	endpoint: 'notes/mentions' as const,
< 	limit: 10,
---
>   endpoint: "notes/mentions" as const,
>   limit: 10,
37,41c46,50
< 	endpoint: 'notes/mentions' as const,
< 	limit: 10,
< 	params: {
< 		visibility: 'specified',
< 	},
---
>   endpoint: "notes/mentions" as const,
>   limit: 10,
>   params: {
>     visibility: "specified",
>   },
45,59c54,75
< 	const typeItems = notificationTypes.map(t => ({
< 		text: i18n.t(`_notification._types.${t}`),
< 		active: includeTypes && includeTypes.includes(t),
< 		action: () => {
< 			includeTypes = [t];
< 		},
< 	}));
< 	const items = includeTypes != null ? [{
< 		icon: 'ti ti-x',
< 		text: i18n.ts.clear,
< 		action: () => {
< 			includeTypes = null;
< 		},
< 	}, null, ...typeItems] : typeItems;
< 	os.popupMenu(items, ev.currentTarget ?? ev.target);
---
>   const typeItems = notificationTypes.map((t) => ({
>     text: i18n.t(`_notification._types.${t}`),
>     active: includeTypes && includeTypes.includes(t),
>     action: () => {
>       includeTypes = [t];
>     },
>   }));
>   const items =
>     includeTypes != null
>       ? [
>           {
>             icon: "fas fa-times",
>             text: i18n.ts.clear,
>             action: () => {
>               includeTypes = null;
>             },
>           },
>           null,
>           ...typeItems,
>         ]
>       : typeItems;
>   os.popupMenu(items, ev.currentTarget ?? ev.target);
62,73c78,98
< const headerActions = $computed(() => [tab === 'all' ? {
< 	text: i18n.ts.filter,
< 	icon: 'ti ti-filter',
< 	highlighted: includeTypes != null,
< 	handler: setFilter,
< } : undefined, tab === 'all' ? {
< 	text: i18n.ts.markAllAsRead,
< 	icon: 'ti ti-check',
< 	handler: () => {
< 		os.apiWithDialog('notifications/mark-all-as-read');
< 	},
< } : undefined].filter(x => x !== undefined));
---
> const headerActions = $computed(() =>
>   [
>     tab === "all"
>       ? {
>           text: i18n.ts.filter,
>           icon: "fas fa-filter",
>           highlighted: includeTypes != null,
>           handler: setFilter,
>         }
>       : undefined,
>     tab === "all"
>       ? {
>           text: i18n.ts.markAllAsRead,
>           icon: "fas fa-check",
>           handler: () => {
>             os.apiWithDialog("notifications/mark-all-as-read");
>           },
>         }
>       : undefined,
>   ].filter((x) => x !== undefined)
> );
75,89c100,119
< const headerTabs = $computed(() => [{
< 	key: 'all',
< 	title: i18n.ts.all,
< }, {
< 	key: 'unread',
< 	title: i18n.ts.unread,
< }, {
< 	key: 'mentions',
< 	title: i18n.ts.mentions,
< 	icon: 'ti ti-at',
< }, {
< 	key: 'directNotes',
< 	title: i18n.ts.directNotes,
< 	icon: 'ti ti-mail',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "all",
>     title: i18n.ts.all,
>   },
>   {
>     key: "unread",
>     title: i18n.ts.unread,
>   },
>   {
>     key: "mentions",
>     title: i18n.ts.mentions,
>     icon: "fas fa-at",
>   },
>   {
>     key: "directNotes",
>     title: i18n.ts.directNotes,
>     icon: "fas fa-envelope",
>   },
> ]);
91,94c121,126
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.notifications,
< 	icon: 'ti ti-bell',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.notifications,
>     icon: "fas fa-bell",
>   }))
> );
Only in RiricaV13/pages/page-editor/els: page-editor.el.button.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.canvas.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.counter.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.if.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/els/page-editor.el.image.vue RiricaV13/pages/page-editor/els/page-editor.el.image.vue
2,9c2,11
< <!-- eslint-disable vue/no-mutating-props -->
< <XContainer :draggable="true" @remove="() => $emit('remove')">
< 	<template #header><i class="fas fa-image"></i> {{ $ts._pages.blocks.image }}</template>
< 	<template #func>
< 		<button @click="choose()">
< 			<i class="fas fa-folder-open"></i>
< 		</button>
< 	</template>
---
>   <!-- eslint-disable vue/no-mutating-props -->
>   <XContainer :draggable="true" @remove="() => $emit('remove')">
>     <template #header
>       ><i class="fas fa-image"></i> {{ $ts._pages.blocks.image }}</template
>     >
>     <template #func>
>       <button @click="choose()">
>         <i class="fas fa-folder-open"></i>
>       </button>
>     </template>
11,14c13,22
< 	<section class="oyyftmcf">
< 		<MkDriveFileThumbnail v-if="file" class="preview" :file="file" fit="contain" @click="choose()"/>
< 	</section>
< </XContainer>
---
>     <section class="oyyftmcf">
>       <MkDriveFileThumbnail
>         v-if="file"
>         class="preview"
>         :file="file"
>         fit="contain"
>         @click="choose()"
>       />
>     </section>
>   </XContainer>
19,22c27,30
< import { onMounted } from 'vue';
< import XContainer from '../page-editor.container.vue';
< import MkDriveFileThumbnail from '@/components/MkDriveFileThumbnail.vue';
< import * as os from '@/os';
---
> import { onMounted } from "vue";
> import XContainer from "../page-editor.container.vue";
> import MkDriveFileThumbnail from "@/components/MkDriveFileThumbnail.vue";
> import * as os from "@/os";
24,26c32,41
< const props = defineProps<{
< 	modelValue: any
< }>();
---
> const props = withDefaults(
>   defineProps<{
>     value: any;
>   }>(),
>   {
>     value: {
>       fileId: null,
>     },
>   }
> );
28,31d42
< const emit = defineEmits<{
< 	(ev: 'update:modelValue', value: any): void;
< }>();
< 
35,41c46,49
< 	os.selectDriveFile(false).then((fileResponse: any) => {
< 		file = fileResponse;
< 		emit('update:modelValue', {
< 			...props.modelValue,
< 			fileId: fileResponse.id,
< 		});
< 	});
---
>   os.selectDriveFile(false).then((fileResponse: any) => {
>     file = fileResponse;
>     props.value.fileId = fileResponse.id;
>   });
45,53c53,61
< 	if (props.modelValue.fileId == null) {
< 		await choose();
< 	} else {
< 		os.api('drive/files/show', {
< 			fileId: props.modelValue.fileId,
< 		}).then(fileResponse => {
< 			file = fileResponse;
< 		});
< 	}
---
>   if (props.value.fileId == null) {
>     await choose();
>   } else {
>     os.api("drive/files/show", {
>       fileId: props.value.fileId,
>     }).then((fileResponse) => {
>       file = fileResponse;
>     });
>   }
59,61c67,69
< 	> .preview {
< 		height: 150px;
< 	}
---
>   > .preview {
>     height: 150px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/els/page-editor.el.note.vue RiricaV13/pages/page-editor/els/page-editor.el.note.vue
2,4c2,6
< <!-- eslint-disable vue/no-mutating-props -->
< <XContainer :draggable="true" @remove="() => $emit('remove')">
< 	<template #header><i class="ti ti-note"></i> {{ $ts._pages.blocks.note }}</template>
---
>   <!-- eslint-disable vue/no-mutating-props -->
>   <XContainer :draggable="true" @remove="() => $emit('remove')">
>     <template #header
>       ><i class="fas fa-sticky-note"></i> {{ $ts._pages.blocks.note }}</template
>     >
6,11c8,17
< 	<section style="padding: 0 16px 0 16px;">
< 		<MkInput v-model="id">
< 			<template #label>{{ $ts._pages.blocks._note.id }}</template>
< 			<template #caption>{{ $ts._pages.blocks._note.idDescription }}</template>
< 		</MkInput>
< 		<MkSwitch v-model="props.modelValue.detailed"><span>{{ $ts._pages.blocks._note.detailed }}</span></MkSwitch>
---
>     <section style="padding: 0 16px 0 16px">
>       <MkInput v-model="id">
>         <template #label>{{ $ts._pages.blocks._note.id }}</template>
>         <template #caption>{{
>           $ts._pages.blocks._note.idDescription
>         }}</template>
>       </MkInput>
>       <MkSwitch v-model="value.detailed"
>         ><span>{{ $ts._pages.blocks._note.detailed }}</span></MkSwitch
>       >
13,16c19,32
< 		<XNote v-if="note && !props.modelValue.detailed" :key="note.id + ':normal'" v-model:note="note" style="margin-bottom: 16px;"/>
< 		<XNoteDetailed v-if="note && props.modelValue.detailed" :key="note.id + ':detail'" v-model:note="note" style="margin-bottom: 16px;"/>
< 	</section>
< </XContainer>
---
>       <XNote
>         v-if="note && !value.detailed"
>         :key="note.id + ':normal'"
>         v-model:note="note"
>         style="margin-bottom: 16px"
>       />
>       <XNoteDetailed
>         v-if="note && value.detailed"
>         :key="note.id + ':detail'"
>         v-model:note="note"
>         style="margin-bottom: 16px"
>       />
>     </section>
>   </XContainer>
21,27c37,43
< import { watch } from 'vue';
< import XContainer from '../page-editor.container.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import XNote from '@/components/MkNote.vue';
< import XNoteDetailed from '@/components/MkNoteDetailed.vue';
< import * as os from '@/os';
---
> import { watch } from "vue";
> import XContainer from "../page-editor.container.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import XNote from "@/components/MkNote.vue";
> import XNoteDetailed from "@/components/MkNoteDetailed.vue";
> import * as os from "@/os";
29,31c45,55
< const props = defineProps<{
< 	modelValue: any
< }>();
---
> const props = withDefaults(
>   defineProps<{
>     value: any;
>   }>(),
>   {
>     value: {
>       note: null,
>       detailed: false,
>     },
>   }
> );
33,37c57
< const emit = defineEmits<{
< 	(ev: 'update:modelValue', value: any): void;
< }>();
< 
< let id: any = $ref(props.modelValue.note);
---
> let id: any = $ref(props.value.note);
40,43c60,69
< watch($$(id), async () => {
< 	if (id && (id.startsWith('http://') || id.startsWith('https://'))) {
< 		id = (id.endsWith('/') ? id.slice(0, -1) : id).split('/').pop();
< 	}
---
> watch(
>   id,
>   async () => {
>     if (id && (id.startsWith("http://") || id.startsWith("https://"))) {
>       props.value.note = (id.endsWith("/") ? id.slice(0, -1) : id)
>         .split("/")
>         .pop();
>     } else {
>       props.value.note = id;
>     }
45,52c71,76
< 	emit('update:modelValue', {
< 		...props.modelValue,
< 		note: id,
< 	});
< 	note = await os.api('notes/show', { noteId: id });
< }, {
< 	immediate: true,
< });
---
>     note = await os.api("notes/show", { noteId: props.value.note });
>   },
>   {
>     immediate: true,
>   }
> );
Only in RiricaV13/pages/page-editor/els: page-editor.el.number-input.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.post.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.radio-button.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/els/page-editor.el.section.vue RiricaV13/pages/page-editor/els/page-editor.el.section.vue
2,9c2,14
< <!-- eslint-disable vue/no-mutating-props -->
< <XContainer :draggable="true" @remove="() => $emit('remove')">
< 	<template #header><i class="ti ti-note"></i> {{ props.modelValue.title }}</template>
< 	<template #func>
< 		<button class="_button" @click="rename()">
< 			<i class="ti ti-pencil"></i>
< 		</button>
< 	</template>
---
>   <!-- eslint-disable vue/no-mutating-props -->
>   <XContainer :draggable="true" @remove="() => $emit('remove')">
>     <template #header
>       ><i class="fas fa-sticky-note"></i> {{ value.title }}</template
>     >
>     <template #func>
>       <button class="_button" @click="rename()">
>         <i class="fas fa-pencil-alt"></i>
>       </button>
>       <button class="_button" @click="add()">
>         <i class="fas fa-plus"></i>
>       </button>
>     </template>
11,15c16,19
< 	<section class="ilrvjyvi">
< 		<XBlocks v-model="children" class="children"/>
< 		<MkButton rounded class="add" @click="add()"><i class="ti ti-plus"></i></MkButton>
< 	</section>
< </XContainer>
---
>     <section class="ilrvjyvi">
>       <XBlocks v-model="value.children" class="children" :hpml="hpml" />
>     </section>
>   </XContainer>
20,26c24,28
< import { defineAsyncComponent, inject, onMounted, watch } from 'vue';
< import { v4 as uuid } from 'uuid';
< import XContainer from '../page-editor.container.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { deepClone } from '@/scripts/clone';
< import MkButton from '@/components/MkButton.vue';
---
> import { defineAsyncComponent, inject, onMounted } from "vue";
> import { v4 as uuid } from "uuid";
> import XContainer from "../page-editor.container.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
28c30
< const XBlocks = defineAsyncComponent(() => import('../page-editor.blocks.vue'));
---
> const XBlocks = defineAsyncComponent(() => import("../page-editor.blocks.vue"));
30,34c32,43
< const props = withDefaults(defineProps<{
< 	modelValue: any,
< }>(), {
< 	modelValue: {},
< });
---
> const props = withDefaults(
>   defineProps<{
>     value: any;
>     hpml: any;
>   }>(),
>   {
>     value: {
>       title: null,
>       children: [],
>     },
>   }
> );
36,38c45
< const emit = defineEmits<{
< 	(ev: 'update:modelValue', value: any): void;
< }>();
---
> const getPageBlockList = inject<(any) => any>("getPageBlockList");
40,52d46
< const children = $ref(deepClone(props.modelValue.children ?? []));
< 
< watch($$(children), () => {
< 	emit('update:modelValue', {
< 		...props.modelValue,
< 		children,
< 	});
< }, {
< 	deep: true,
< });
< 
< const getPageBlockList = inject<(any) => any>('getPageBlockList');
< 
54,62c48,53
< 	const { canceled, result: title } = await os.inputText({
< 		title: 'Enter title',
< 		default: props.modelValue.title,
< 	});
< 	if (canceled) return;
< 	emit('update:modelValue', {
< 		...props.modelValue,
< 		title,
< 	});
---
>   const { canceled, result: title } = await os.inputText({
>     title: "Enter title",
>     default: props.value.title,
>   });
>   if (canceled) return;
>   props.value.title = title;
66,70c57,61
< 	const { canceled, result: type } = await os.select({
< 		title: i18n.ts._pages.chooseBlock,
< 		items: getPageBlockList(),
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: type } = await os.select({
>     title: i18n.ts._pages.chooseBlock,
>     groupedItems: getPageBlockList(),
>   });
>   if (canceled) return;
72,73c63,64
< 	const id = uuid();
< 	children.push({ id, type });
---
>   const id = uuid();
>   props.value.children.push({ id, type });
77,79c68,70
< 	if (props.modelValue.title == null) {
< 		rename();
< 	}
---
>   if (props.value.title == null) {
>     rename();
>   }
85,95c76,78
< 	> .children {
< 		margin: 16px;
< 
< 		&:empty {
< 			display: none;
< 		}
< 	}
< 
< 	> .add {
< 		margin: 16px auto;
< 	}
---
>   > .children {
>     padding: 16px;
>   }
Only in RiricaV13/pages/page-editor/els: page-editor.el.switch.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.text-input.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/els/page-editor.el.text.vue RiricaV13/pages/page-editor/els/page-editor.el.text.vue
2,4c2,6
< <!-- eslint-disable vue/no-mutating-props -->
< <XContainer :draggable="true" @remove="() => $emit('remove')">
< 	<template #header><i class="fas fa-align-left"></i> {{ $ts._pages.blocks.text }}</template>
---
>   <!-- eslint-disable vue/no-mutating-props -->
>   <XContainer :draggable="true" @remove="() => $emit('remove')">
>     <template #header
>       ><i class="fas fa-align-left"></i> {{ $ts._pages.blocks.text }}</template
>     >
6,9c8,11
< 	<section class="vckmsadr">
< 		<textarea v-model="text"></textarea>
< 	</section>
< </XContainer>
---
>     <section class="vckmsadr">
>       <textarea v-model="value.text"></textarea>
>     </section>
>   </XContainer>
14,15c16,17
< import { watch } from 'vue';
< import XContainer from '../page-editor.container.vue';
---
> import {} from "vue";
> import XContainer from "../page-editor.container.vue";
17,32c19,28
< const props = defineProps<{
< 	modelValue: any
< }>();
< 
< const emit = defineEmits<{
< 	(ev: 'update:modelValue', value: any): void;
< }>();
< 
< const text = $ref(props.modelValue.text ?? '');
< 
< watch($$(text), () => {
< 	emit('update:modelValue', {
< 		...props.modelValue,
< 		text,
< 	});
< });
---
> withDefaults(
>   defineProps<{
>     value: any;
>   }>(),
>   {
>     value: {
>       text: "",
>     },
>   }
> );
37,52c33,48
< 	> textarea {
< 		display: block;
< 		-webkit-appearance: none;
< 		-moz-appearance: none;
< 		appearance: none;
< 		width: 100%;
< 		min-width: 100%;
< 		min-height: 150px;
< 		border: none;
< 		box-shadow: none;
< 		padding: 16px;
< 		background: transparent;
< 		color: var(--fg);
< 		font-size: 14px;
< 		box-sizing: border-box;
< 	}
---
>   > textarea {
>     display: block;
>     -webkit-appearance: none;
>     -moz-appearance: none;
>     appearance: none;
>     width: 100%;
>     min-width: 100%;
>     min-height: 150px;
>     border: none;
>     box-shadow: none;
>     padding: 16px;
>     background: transparent;
>     color: var(--fg);
>     font-size: 14px;
>     box-sizing: border-box;
>   }
Only in RiricaV13/pages/page-editor/els: page-editor.el.textarea-input.vue
Only in RiricaV13/pages/page-editor/els: page-editor.el.textarea.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/page-editor.blocks.vue RiricaV13/pages/page-editor/page-editor.blocks.vue
2,9c2,20
< <Sortable :model-value="modelValue" tag="div" item-key="id" handle=".drag-handle" :group="{ name: 'blocks' }" :animation="150" :swap-threshold="0.5" @update:model-value="v => $emit('update:modelValue', v)">
< 	<template #item="{element}">
< 		<div :class="$style.item">
< 			<!-- divが無いとエラーになる https://github.com/SortableJS/vue.draggable.next/issues/189 -->
< 			<component :is="'x-' + element.type" :model-value="element" @update:model-value="updateItem" @remove="() => removeItem(element)"/>
< 		</div>
< 	</template>
< </Sortable>
---
>   <XDraggable
>     v-model="blocks"
>     tag="div"
>     item-key="id"
>     handle=".drag-handle"
>     :group="{ name: 'blocks' }"
>     animation="150"
>     swap-threshold="0.5"
>   >
>     <template #item="{ element }">
>       <component
>         :is="'x-' + element.type"
>         :value="element"
>         :hpml="hpml"
>         @update:value="updateItem"
>         @remove="() => removeItem(element)"
>       />
>     </template>
>   </XDraggable>
13,19c24,40
< import { defineComponent, defineAsyncComponent } from 'vue';
< import XSection from './els/page-editor.el.section.vue';
< import XText from './els/page-editor.el.text.vue';
< import XImage from './els/page-editor.el.image.vue';
< import XNote from './els/page-editor.el.note.vue';
< import * as os from '@/os';
< import { deepClone } from '@/scripts/clone';
---
> import { defineComponent, defineAsyncComponent } from "vue";
> import XSection from "./els/page-editor.el.section.vue";
> import XText from "./els/page-editor.el.text.vue";
> import XTextarea from "./els/page-editor.el.textarea.vue";
> import XImage from "./els/page-editor.el.image.vue";
> import XButton from "./els/page-editor.el.button.vue";
> import XTextInput from "./els/page-editor.el.text-input.vue";
> import XTextareaInput from "./els/page-editor.el.textarea-input.vue";
> import XNumberInput from "./els/page-editor.el.number-input.vue";
> import XSwitch from "./els/page-editor.el.switch.vue";
> import XIf from "./els/page-editor.el.if.vue";
> import XPost from "./els/page-editor.el.post.vue";
> import XCounter from "./els/page-editor.el.counter.vue";
> import XRadioButton from "./els/page-editor.el.radio-button.vue";
> import XCanvas from "./els/page-editor.el.canvas.vue";
> import XNote from "./els/page-editor.el.note.vue";
> import * as os from "@/os";
22,25c43,62
< 	components: {
< 		Sortable: defineAsyncComponent(() => import('vuedraggable').then(x => x.default)),
< 		XSection, XText, XImage, XNote,
< 	},
---
>   components: {
>     XDraggable: defineAsyncComponent(() =>
>       import("vuedraggable").then((x) => x.default)
>     ),
>     XSection,
>     XText,
>     XImage,
>     XButton,
>     XTextarea,
>     XTextInput,
>     XTextareaInput,
>     XNumberInput,
>     XSwitch,
>     XIf,
>     XPost,
>     XCounter,
>     XRadioButton,
>     XCanvas,
>     XNote,
>   },
27,32c64,72
< 	props: {
< 		modelValue: {
< 			type: Array,
< 			required: true,
< 		},
< 	},
---
>   props: {
>     modelValue: {
>       type: Array,
>       required: true,
>     },
>     hpml: {
>       required: true,
>     },
>   },
34c74
< 	emits: ['update:modelValue'],
---
>   emits: ["update:modelValue"],
36,45c76,85
< 	methods: {
< 		updateItem(v) {
< 			const i = this.modelValue.findIndex(x => x.id === v.id);
< 			const newValue = [
< 				...this.modelValue.slice(0, i),
< 				v,
< 				...this.modelValue.slice(i + 1),
< 			];
< 			this.$emit('update:modelValue', newValue);
< 		},
---
>   computed: {
>     blocks: {
>       get() {
>         return this.modelValue;
>       },
>       set(value) {
>         this.$emit("update:modelValue", value);
>       },
>     },
>   },
47,55c87,106
< 		removeItem(el) {
< 			const i = this.modelValue.findIndex(x => x.id === el.id);
< 			const newValue = [
< 				...this.modelValue.slice(0, i),
< 				...this.modelValue.slice(i + 1),
< 			];
< 			this.$emit('update:modelValue', newValue);
< 		},
< 	},
---
>   methods: {
>     updateItem(v) {
>       const i = this.blocks.findIndex((x) => x.id === v.id);
>       const newValue = [
>         ...this.blocks.slice(0, i),
>         v,
>         ...this.blocks.slice(i + 1),
>       ];
>       this.$emit("update:modelValue", newValue);
>     },
> 
>     removeItem(el) {
>       const i = this.blocks.findIndex((x) => x.id === el.id);
>       const newValue = [
>         ...this.blocks.slice(0, i),
>         ...this.blocks.slice(i + 1),
>       ];
>       this.$emit("update:modelValue", newValue);
>     },
>   },
58,65d108
< 
< <style lang="scss" module>
< .item {
< 	& + .item {
< 		margin-top: 16px;
< 	}
< }
< </style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/page-editor.container.vue RiricaV13/pages/page-editor/page-editor.container.vue
2,24c2,34
< <div class="cpjygsrt" :class="{ error: error != null, warn: warn != null }">
< 	<header>
< 		<div class="title"><slot name="header"></slot></div>
< 		<div class="buttons">
< 			<slot name="func"></slot>
< 			<button v-if="removable" class="_button" @click="remove()">
< 				<i class="ti ti-trash"></i>
< 			</button>
< 			<button v-if="draggable" class="drag-handle _button">
< 				<i class="ti ti-menu-2"></i>
< 			</button>
< 			<button class="_button" @click="toggleContent(!showBody)">
< 				<template v-if="showBody"><i class="ti ti-chevron-up"></i></template>
< 				<template v-else><i class="ti ti-chevron-down"></i></template>
< 			</button>
< 		</div>
< 	</header>
< 	<p v-show="showBody" v-if="error != null" class="error">{{ $t('_pages.script.typeError', { slot: error.arg + 1, expect: $t(`script.types.${error.expect}`), actual: $t(`script.types.${error.actual}`) }) }}</p>
< 	<p v-show="showBody" v-if="warn != null" class="warn">{{ $t('_pages.script.thereIsEmptySlot', { slot: warn.slot + 1 }) }}</p>
< 	<div v-show="showBody" class="body">
< 		<slot></slot>
< 	</div>
< </div>
---
>   <div class="cpjygsrt" :class="{ error: error != null, warn: warn != null }">
>     <header>
>       <div class="title"><slot name="header"></slot></div>
>       <div class="buttons">
>         <slot name="func"></slot>
>         <button v-if="removable" class="_button" @click="remove()">
>           <i class="fas fa-trash-alt"></i>
>         </button>
>         <button v-if="draggable" class="drag-handle _button">
>           <i class="fas fa-bars"></i>
>         </button>
>         <button class="_button" @click="toggleContent(!showBody)">
>           <template v-if="showBody"><i class="fas fa-angle-up"></i></template>
>           <template v-else><i class="fas fa-angle-down"></i></template>
>         </button>
>       </div>
>     </header>
>     <p v-show="showBody" v-if="error != null" class="error">
>       {{
>         $t("_pages.script.typeError", {
>           slot: error.arg + 1,
>           expect: $t(`script.types.${error.expect}`),
>           actual: $t(`script.types.${error.actual}`),
>         })
>       }}
>     </p>
>     <p v-show="showBody" v-if="warn != null" class="warn">
>       {{ $t("_pages.script.thereIsEmptySlot", { slot: warn.slot + 1 }) }}
>     </p>
>     <div v-show="showBody" class="body">
>       <slot></slot>
>     </div>
>   </div>
28c38
< import { defineComponent } from 'vue';
---
> import { defineComponent } from "vue";
31,67c41,77
< 	props: {
< 		expanded: {
< 			type: Boolean,
< 			default: true,
< 		},
< 		removable: {
< 			type: Boolean,
< 			default: true,
< 		},
< 		draggable: {
< 			type: Boolean,
< 			default: false,
< 		},
< 		error: {
< 			required: false,
< 			default: null,
< 		},
< 		warn: {
< 			required: false,
< 			default: null,
< 		},
< 	},
< 	emits: ['toggle', 'remove'],
< 	data() {
< 		return {
< 			showBody: this.expanded,
< 		};
< 	},
< 	methods: {
< 		toggleContent(show: boolean) {
< 			this.showBody = show;
< 			this.$emit('toggle', show);
< 		},
< 		remove() {
< 			this.$emit('remove');
< 		},
< 	},
---
>   props: {
>     expanded: {
>       type: Boolean,
>       default: true,
>     },
>     removable: {
>       type: Boolean,
>       default: true,
>     },
>     draggable: {
>       type: Boolean,
>       default: false,
>     },
>     error: {
>       required: false,
>       default: null,
>     },
>     warn: {
>       required: false,
>       default: null,
>     },
>   },
>   emits: ["toggle", "remove"],
>   data() {
>     return {
>       showBody: this.expanded,
>     };
>   },
>   methods: {
>     toggleContent(show: boolean) {
>       this.showBody = show;
>       this.$emit("toggle", show);
>     },
>     remove() {
>       this.$emit("remove");
>     },
>   },
73,77c83,87
< 	position: relative;
< 	overflow: hidden;
< 	background: var(--panel);
< 	border: solid 2px var(--X12);
< 	border-radius: 8px;
---
>   position: relative;
>   overflow: hidden;
>   background: var(--panel);
>   border: solid 2px var(--X12);
>   border-radius: 6px;
79,81c89,91
< 	&:hover {
< 		border: solid 2px var(--X13);
< 	}
---
>   &:hover {
>     border: solid 2px var(--X13);
>   }
83,85c93,95
< 	&.warn {
< 		border: solid 2px #dec44c;
< 	}
---
>   &.warn {
>     border: solid 2px #dec44c;
>   }
87,89c97,99
< 	&.error {
< 		border: solid 2px #f00;
< 	}
---
>   &.error {
>     border: solid 2px #f00;
>   }
91,99c101,103
< 	> header {
< 		> .title {
< 			z-index: 1;
< 			margin: 0;
< 			padding: 0 16px;
< 			line-height: 42px;
< 			font-size: 0.9em;
< 			font-weight: bold;
< 			box-shadow: 0 1px rgba(#000, 0.07);
---
>   & + .cpjygsrt {
>     margin-top: 16px;
>   }
101,103c105,113
< 			> i {
< 				margin-right: 6px;
< 			}
---
>   > header {
>     > .title {
>       z-index: 1;
>       margin: 0;
>       padding: 0 16px;
>       line-height: 42px;
>       font-size: 0.9em;
>       font-weight: bold;
>       box-shadow: 0 1px rgba(#000, 0.07);
105,108c115,117
< 			&:empty {
< 				display: none;
< 			}
< 		}
---
>       > i {
>         margin-right: 6px;
>       }
110,114c119,122
< 		> .buttons {
< 			position: absolute;
< 			z-index: 2;
< 			top: 0;
< 			right: 0;
---
>       &:empty {
>         display: none;
>       }
>     }
116,121c124,128
< 			> button {
< 				padding: 0;
< 				width: 42px;
< 				font-size: 0.9em;
< 				line-height: 42px;
< 			}
---
>     > .buttons {
>       position: absolute;
>       z-index: 2;
>       top: 0;
>       right: 0;
123,127c130,135
< 			.drag-handle {
< 				cursor: move;
< 			}
< 		}
< 	}
---
>       > button {
>         padding: 0;
>         width: 42px;
>         font-size: 0.9em;
>         line-height: 42px;
>       }
129,134c137,141
< 	> .warn {
< 		color: #b19e49;
< 		margin: 0;
< 		padding: 16px 16px 0 16px;
< 		font-size: 14px;
< 	}
---
>       .drag-handle {
>         cursor: move;
>       }
>     }
>   }
136,141c143,148
< 	> .error {
< 		color: #f00;
< 		margin: 0;
< 		padding: 16px 16px 0 16px;
< 		font-size: 14px;
< 	}
---
>   > .warn {
>     color: #b19e49;
>     margin: 0;
>     padding: 16px 16px 0 16px;
>     font-size: 14px;
>   }
143,147c150,155
< 	> .body {
< 		::v-deep(.juejbjww), ::v-deep(.eiipwacr) {
< 			&:not(.inline):first-child {
< 				margin-top: 28px;
< 			}
---
>   > .error {
>     color: #f00;
>     margin: 0;
>     padding: 16px 16px 0 16px;
>     font-size: 14px;
>   }
149,153c157,168
< 			&:not(.inline):last-child {
< 				margin-bottom: 20px;
< 			}
< 		}
< 	}
---
>   > .body {
>     ::v-deep(.juejbjww),
>     ::v-deep(.eiipwacr) {
>       &:not(.inline):first-child {
>         margin-top: 28px;
>       }
> 
>       &:not(.inline):last-child {
>         margin-bottom: 20px;
>       }
>     }
>   }
Only in RiricaV13/pages/page-editor: page-editor.script-block.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page-editor/page-editor.vue RiricaV13/pages/page-editor/page-editor.vue
2,10c2,34
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div class="jqqmcavi">
< 			<MkButton v-if="pageId" class="button" inline link :to="`/@${ author.username }/pages/${ currentName }`"><i class="ti ti-external-link"></i> {{ $ts._pages.viewPage }}</MkButton>
< 			<MkButton v-if="!readonly" inline primary class="button" @click="save"><i class="ti ti-device-floppy"></i> {{ $ts.save }}</MkButton>
< 			<MkButton v-if="pageId" inline class="button" @click="duplicate"><i class="ti ti-copy"></i> {{ $ts.duplicate }}</MkButton>
< 			<MkButton v-if="pageId && !readonly" inline class="button" danger @click="del"><i class="ti ti-trash"></i> {{ $ts.delete }}</MkButton>
< 		</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div class="jqqmcavi">
>         <MkButton
>           v-if="pageId"
>           class="button"
>           inline
>           link
>           :to="`/@${author.username}/pages/${currentName}`"
>           ><i class="fas fa-external-link-square-alt"></i>
>           {{ $ts._pages.viewPage }}</MkButton
>         >
>         <MkButton v-if="!readonly" inline primary class="button" @click="save"
>           ><i class="fas fa-save"></i> {{ $ts.save }}</MkButton
>         >
>         <MkButton v-if="pageId" inline class="button" @click="duplicate"
>           ><i class="fas fa-copy"></i> {{ $ts.duplicate }}</MkButton
>         >
>         <MkButton
>           v-if="pageId && !readonly"
>           inline
>           class="button"
>           danger
>           @click="del"
>           ><i class="fas fa-trash-alt"></i> {{ $ts.delete }}</MkButton
>         >
>       </div>
12,16c36,40
< 		<div v-if="tab === 'settings'">
< 			<div class="_gaps_m">
< 				<MkInput v-model="title">
< 					<template #label>{{ $ts._pages.title }}</template>
< 				</MkInput>
---
>       <div v-if="tab === 'settings'">
>         <div class="_formRoot">
>           <MkInput v-model="title" class="_formBlock">
>             <template #label>{{ $ts._pages.title }}</template>
>           </MkInput>
18,20c42,44
< 				<MkInput v-model="summary">
< 					<template #label>{{ $ts._pages.summary }}</template>
< 				</MkInput>
---
>           <MkInput v-model="summary" class="_formBlock">
>             <template #label>{{ $ts._pages.summary }}</template>
>           </MkInput>
22,25c46,49
< 				<MkInput v-model="name">
< 					<template #prefix>{{ url }}/@{{ author.username }}/pages/</template>
< 					<template #label>{{ $ts._pages.url }}</template>
< 				</MkInput>
---
>           <MkInput v-model="name" class="_formBlock">
>             <template #prefix>{{ url }}/@{{ author.username }}/pages/</template>
>             <template #label>{{ $ts._pages.url }}</template>
>           </MkInput>
27c51,53
< 				<MkSwitch v-model="alignCenter">{{ $ts._pages.alignCenter }}</MkSwitch>
---
>           <MkSwitch v-model="alignCenter" class="_formBlock">{{
>             $ts._pages.alignCenter
>           }}</MkSwitch>
29,33c55,59
< 				<MkSelect v-model="font">
< 					<template #label>{{ $ts._pages.font }}</template>
< 					<option value="serif">{{ $ts._pages.fontSerif }}</option>
< 					<option value="sans-serif">{{ $ts._pages.fontSansSerif }}</option>
< 				</MkSelect>
---
>           <MkSelect v-model="font" class="_formBlock">
>             <template #label>{{ $ts._pages.font }}</template>
>             <option value="serif">{{ $ts._pages.fontSerif }}</option>
>             <option value="sans-serif">{{ $ts._pages.fontSansSerif }}</option>
>           </MkSelect>
35c61,63
< 				<MkSwitch v-model="hideTitleWhenPinned">{{ $ts._pages.hideTitleWhenPinned }}</MkSwitch>
---
>           <MkSwitch v-model="hideTitleWhenPinned" class="_formBlock">{{
>             $ts._pages.hideTitleWhenPinned
>           }}</MkSwitch>
37,45c65,85
< 				<div class="eyeCatch">
< 					<MkButton v-if="eyeCatchingImageId == null && !readonly" @click="setEyeCatchingImage"><i class="ti ti-plus"></i> {{ $ts._pages.eyeCatchingImageSet }}</MkButton>
< 					<div v-else-if="eyeCatchingImage">
< 						<img :src="eyeCatchingImage.url" :alt="eyeCatchingImage.name" style="max-width: 100%;"/>
< 						<MkButton v-if="!readonly" @click="removeEyeCatchingImage()"><i class="ti ti-trash"></i> {{ $ts._pages.eyeCatchingImageRemove }}</MkButton>
< 					</div>
< 				</div>
< 			</div>
< 		</div>
---
>           <div class="eyeCatch">
>             <MkButton
>               v-if="eyeCatchingImageId == null && !readonly"
>               @click="setEyeCatchingImage"
>               ><i class="fas fa-plus"></i>
>               {{ $ts._pages.eyeCatchingImageSet }}</MkButton
>             >
>             <div v-else-if="eyeCatchingImage">
>               <img
>                 :src="eyeCatchingImage.url"
>                 :alt="eyeCatchingImage.name"
>                 style="max-width: 100%"
>               />
>               <MkButton v-if="!readonly" @click="removeEyeCatchingImage()"
>                 ><i class="fas fa-trash-alt"></i>
>                 {{ $ts._pages.eyeCatchingImageRemove }}</MkButton
>               >
>             </div>
>           </div>
>         </div>
>       </div>
47,49c87,89
< 		<div v-else-if="tab === 'contents'">
< 			<div :class="$style.contents">
< 				<XBlocks v-model="content" class="content"/>
---
>       <div v-else-if="tab === 'contents'">
>         <div>
>           <XBlocks v-model="content" class="content" :hpml="hpml" />
51,55c91,135
< 				<MkButton v-if="!readonly" rounded class="add" @click="add()"><i class="ti ti-plus"></i></MkButton>
< 			</div>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>           <MkButton v-if="!readonly" @click="add()"
>             ><i class="fas fa-plus"></i
>           ></MkButton>
>         </div>
>       </div>
> 
>       <div v-else-if="tab === 'variables'">
>         <div class="qmuvgica">
>           <XDraggable
>             v-show="variables.length > 0"
>             v-model="variables"
>             tag="div"
>             class="variables"
>             item-key="name"
>             handle=".drag-handle"
>             :group="{ name: 'variables' }"
>             animation="150"
>             swap-threshold="0.5"
>           >
>             <template #item="{ element }">
>               <XVariable
>                 :model-value="element"
>                 :removable="true"
>                 :hpml="hpml"
>                 :name="element.name"
>                 :title="element.name"
>                 :draggable="true"
>                 @remove="() => removeVariable(element)"
>               />
>             </template>
>           </XDraggable>
> 
>           <MkButton v-if="!readonly" class="add" @click="addVariable()"
>             ><i class="fas fa-plus"></i
>           ></MkButton>
>         </div>
>       </div>
> 
>       <div v-else-if="tab === 'script'">
>         <div>
>           <MkTextarea v-model="script" class="_code" />
>         </div>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
59,73c139,166
< import { defineAsyncComponent, computed, provide, watch } from 'vue';
< import { v4 as uuid } from 'uuid';
< import XBlocks from './page-editor.blocks.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkInput from '@/components/MkInput.vue';
< import { url } from '@/config';
< import * as os from '@/os';
< import { selectFile } from '@/scripts/select-file';
< import { mainRouter } from '@/router';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { $i } from '@/account';
---
> import { defineAsyncComponent, computed, provide, watch } from "vue";
> import "prismjs";
> import { highlight, languages } from "prismjs/components/prism-core";
> import "prismjs/components/prism-clike";
> import "prismjs/components/prism-javascript";
> import "prismjs/themes/prism-okaidia.css";
> import "vue-prism-editor/dist/prismeditor.min.css";
> import { v4 as uuid } from "uuid";
> import XVariable from "./page-editor.script-block.vue";
> import XBlocks from "./page-editor.blocks.vue";
> import MkTextarea from "@/components/form/textarea.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkSelect from "@/components/form/select.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import MkInput from "@/components/form/input.vue";
> import { blockDefs } from "@/scripts/hpml/index";
> import { HpmlTypeChecker } from "@/scripts/hpml/type-checker";
> import { url } from "@/config";
> import { collectPageVars } from "@/scripts/collect-page-vars";
> import * as os from "@/os";
> import { selectFile } from "@/scripts/select-file";
> import { mainRouter } from "@/router";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { $i } from "@/account";
> const XDraggable = defineAsyncComponent(() =>
>   import("vuedraggable").then((x) => x.default)
> );
76,78c169,171
< 	initPageId?: string;
< 	initPageName?: string;
< 	initUser?: string;
---
>   initPageId?: string;
>   initPageName?: string;
>   initUser?: string;
81c174
< let tab = $ref('settings');
---
> let tab = $ref("settings");
87c180
< let title = $ref('');
---
> let title = $ref("");
92c185
< let font = $ref('sans-serif');
---
> let font = $ref("sans-serif");
95a189,191
> let variables = $ref([]);
> let hpml = $ref(null);
> let script = $ref("");
97,98c193,195
< provide('readonly', readonly);
< provide('getPageBlockList', getPageBlockList);
---
> provide("readonly", readonly);
> provide("getScriptBlockList", getScriptBlockList);
> provide("getPageBlockList", getPageBlockList);
101,107c198,204
< 	if (eyeCatchingImageId == null) {
< 		eyeCatchingImage = null;
< 	} else {
< 		eyeCatchingImage = await os.api('drive/files/show', {
< 			fileId: eyeCatchingImageId,
< 		});
< 	}
---
>   if (eyeCatchingImageId == null) {
>     eyeCatchingImage = null;
>   } else {
>     eyeCatchingImage = await os.api("drive/files/show", {
>       fileId: eyeCatchingImageId,
>     });
>   }
111,122c208,219
< 	return {
< 		title: title.trim(),
< 		name: name.trim(),
< 		summary: summary,
< 		font: font,
< 		script: '',
< 		hideTitleWhenPinned: hideTitleWhenPinned,
< 		alignCenter: alignCenter,
< 		content: content,
< 		variables: [],
< 		eyeCatchingImageId: eyeCatchingImageId,
< 	};
---
>   return {
>     title: title.trim(),
>     name: name.trim(),
>     summary: summary,
>     font: font,
>     script: script,
>     hideTitleWhenPinned: hideTitleWhenPinned,
>     alignCenter: alignCenter,
>     content: content,
>     variables: variables,
>     eyeCatchingImageId: eyeCatchingImageId,
>   };
126c223
< 	const options = getSaveOptions();
---
>   const options = getSaveOptions();
128,143c225,240
< 	const onError = err => {
< 		if (err.id === '3d81ceae-475f-4600-b2a8-2bc116157532') {
< 			if (err.info.param === 'name') {
< 				os.alert({
< 					type: 'error',
< 					title: i18n.ts._pages.invalidNameTitle,
< 					text: i18n.ts._pages.invalidNameText,
< 				});
< 			}
< 		} else if (err.code === 'NAME_ALREADY_EXISTS') {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts._pages.nameAlreadyExists,
< 			});
< 		}
< 	};
---
>   const onError = (err) => {
>     if (err.id === "3d81ceae-475f-4600-b2a8-2bc116157532") {
>       if (err.info.param === "name") {
>         os.alert({
>           type: "error",
>           title: i18n.ts._pages.invalidNameTitle,
>           text: i18n.ts._pages.invalidNameText,
>         });
>       }
>     } else if (err.code === "NAME_ALREADY_EXISTS") {
>       os.alert({
>         type: "error",
>         text: i18n.ts._pages.nameAlreadyExists,
>       });
>     }
>   };
145,166c242,265
< 	if (pageId) {
< 		options.pageId = pageId;
< 		os.api('pages/update', options)
< 			.then(page => {
< 				currentName = name.trim();
< 				os.alert({
< 					type: 'success',
< 					text: i18n.ts._pages.updated,
< 				});
< 			}).catch(onError);
< 	} else {
< 		os.api('pages/create', options)
< 			.then(created => {
< 				pageId = created.id;
< 				currentName = name.trim();
< 				os.alert({
< 					type: 'success',
< 					text: i18n.ts._pages.created,
< 				});
< 				mainRouter.push(`/pages/edit/${pageId}`);
< 			}).catch(onError);
< 	}
---
>   if (pageId) {
>     options.pageId = pageId;
>     os.api("pages/update", options)
>       .then((page) => {
>         currentName = name.trim();
>         os.alert({
>           type: "success",
>           text: i18n.ts._pages.updated,
>         });
>       })
>       .catch(onError);
>   } else {
>     os.api("pages/create", options)
>       .then((created) => {
>         pageId = created.id;
>         currentName = name.trim();
>         os.alert({
>           type: "success",
>           text: i18n.ts._pages.created,
>         });
>         mainRouter.push(`/pages/edit/${pageId}`);
>       })
>       .catch(onError);
>   }
170,184c269,283
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.t('removeAreYouSure', { x: title.trim() }),
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
< 		os.api('pages/delete', {
< 			pageId: pageId,
< 		}).then(() => {
< 			os.alert({
< 				type: 'success',
< 				text: i18n.ts._pages.deleted,
< 			});
< 			mainRouter.push('/pages');
< 		});
< 	});
---
>   os.confirm({
>     type: "warning",
>     text: i18n.t("removeAreYouSure", { x: title.trim() }),
>   }).then(({ canceled }) => {
>     if (canceled) return;
>     os.api("pages/delete", {
>       pageId: pageId,
>     }).then(() => {
>       os.alert({
>         type: "success",
>         text: i18n.ts._pages.deleted,
>       });
>       mainRouter.push("/pages");
>     });
>   });
188,198c287,297
< 	title = title + ' - copy';
< 	name = name + '-copy';
< 	os.api('pages/create', getSaveOptions()).then(created => {
< 		pageId = created.id;
< 		currentName = name.trim();
< 		os.alert({
< 			type: 'success',
< 			text: i18n.ts._pages.created,
< 		});
< 		mainRouter.push(`/pages/edit/${pageId}`);
< 	});
---
>   title = title + " - copy";
>   name = name + "-copy";
>   os.api("pages/create", getSaveOptions()).then((created) => {
>     pageId = created.id;
>     currentName = name.trim();
>     os.alert({
>       type: "success",
>       text: i18n.ts._pages.created,
>     });
>     mainRouter.push(`/pages/edit/${pageId}`);
>   });
202,207c301,306
< 	const { canceled, result: type } = await os.select({
< 		type: null,
< 		title: i18n.ts._pages.chooseBlock,
< 		items: getPageBlockList(),
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: type } = await os.select({
>     type: null,
>     title: i18n.ts._pages.chooseBlock,
>     groupedItems: getPageBlockList(),
>   });
>   if (canceled) return;
209,210c308,309
< 	const id = uuid();
< 	content.push({ id, type });
---
>   const id = uuid();
>   content.push({ id, type });
212a312,335
> async function addVariable() {
>   let { canceled, result: name } = await os.inputText({
>     title: i18n.ts._pages.enterVariableName,
>   });
>   if (canceled) return;
> 
>   name = name.trim();
> 
>   if (hpml.isUsedName(name)) {
>     os.alert({
>       type: "error",
>       text: i18n.ts._pages.variableNameIsAlreadyUsed,
>     });
>     return;
>   }
> 
>   const id = uuid();
>   variables.push({ id, name, type: null });
> }
> 
> function removeVariable(v) {
>   variables = variables.filter((x) => x.name !== v.name);
> }
> 
214,219c337,368
< 	return [
< 		{ value: 'section', text: i18n.ts._pages.blocks.section },
< 		{ value: 'text', text: i18n.ts._pages.blocks.text },
< 		{ value: 'image', text: i18n.ts._pages.blocks.image },
< 		{ value: 'note', text: i18n.ts._pages.blocks.note },
< 	];
---
>   return [
>     {
>       label: i18n.ts._pages.contentBlocks,
>       items: [
>         { value: "section", text: i18n.ts._pages.blocks.section },
>         { value: "text", text: i18n.ts._pages.blocks.text },
>         { value: "image", text: i18n.ts._pages.blocks.image },
>         { value: "textarea", text: i18n.ts._pages.blocks.textarea },
>         { value: "note", text: i18n.ts._pages.blocks.note },
>         { value: "canvas", text: i18n.ts._pages.blocks.canvas },
>       ],
>     },
>     {
>       label: i18n.ts._pages.inputBlocks,
>       items: [
>         { value: "button", text: i18n.ts._pages.blocks.button },
>         { value: "radioButton", text: i18n.ts._pages.blocks.radioButton },
>         { value: "textInput", text: i18n.ts._pages.blocks.textInput },
>         { value: "textareaInput", text: i18n.ts._pages.blocks.textareaInput },
>         { value: "numberInput", text: i18n.ts._pages.blocks.numberInput },
>         { value: "switch", text: i18n.ts._pages.blocks.switch },
>         { value: "counter", text: i18n.ts._pages.blocks.counter },
>       ],
>     },
>     {
>       label: i18n.ts._pages.specialBlocks,
>       items: [
>         { value: "if", text: i18n.ts._pages.blocks.if },
>         { value: "post", text: i18n.ts._pages.blocks.post },
>       ],
>     },
>   ];
221a371,416
> function getScriptBlockList(type: string = null) {
>   const list = [];
> 
>   const blocks = blockDefs.filter(
>     (block) =>
>       type == null ||
>       block.out == null ||
>       block.out === type ||
>       typeof block.out === "number"
>   );
> 
>   for (const block of blocks) {
>     const category = list.find((x) => x.category === block.category);
>     if (category) {
>       category.items.push({
>         value: block.type,
>         text: i18n.t(`_pages.script.blocks.${block.type}`),
>       });
>     } else {
>       list.push({
>         category: block.category,
>         label: i18n.t(`_pages.script.categories.${block.category}`),
>         items: [
>           {
>             value: block.type,
>             text: i18n.t(`_pages.script.blocks.${block.type}`),
>           },
>         ],
>       });
>     }
>   }
> 
>   const userFns = variables.filter((x) => x.type === "fn");
>   if (userFns.length > 0) {
>     list.unshift({
>       label: i18n.t("_pages.script.categories.fn"),
>       items: userFns.map((v) => ({
>         value: "fn:" + v.name,
>         text: v.name,
>       })),
>     });
>   }
> 
>   return list;
> }
> 
223,225c418,420
< 	selectFile(img.currentTarget ?? img.target, null).then(file => {
< 		eyeCatchingImageId = file.id;
< 	});
---
>   selectFile(img.currentTarget ?? img.target, null).then((file) => {
>     eyeCatchingImageId = file.id;
>   });
229c424
< 	eyeCatchingImageId = null;
---
>   eyeCatchingImageId = null;
231a427,430
> function highlighter(code) {
>   return highlight(code, languages.js, "javascript");
> }
> 
233,243c432
< 	if (props.initPageId) {
< 		page = await os.api('pages/show', {
< 			pageId: props.initPageId,
< 		});
< 	} else if (props.initPageName && props.initUser) {
< 		page = await os.api('pages/show', {
< 			name: props.initPageName,
< 			username: props.initUser,
< 		});
< 		readonly = true;
< 	}
---
>   hpml = new HpmlTypeChecker();
245,264c434,485
< 	if (page) {
< 		author = page.user;
< 		pageId = page.id;
< 		title = page.title;
< 		name = page.name;
< 		currentName = page.name;
< 		summary = page.summary;
< 		font = page.font;
< 		hideTitleWhenPinned = page.hideTitleWhenPinned;
< 		alignCenter = page.alignCenter;
< 		content = page.content;
< 		eyeCatchingImageId = page.eyeCatchingImageId;
< 	} else {
< 		const id = uuid();
< 		content = [{
< 			id,
< 			type: 'text',
< 			text: 'Hello World!',
< 		}];
< 	}
---
>   watch(
>     $$(variables),
>     () => {
>       hpml.variables = variables;
>     },
>     { deep: true }
>   );
> 
>   watch(
>     $$(content),
>     () => {
>       hpml.pageVars = collectPageVars(content);
>     },
>     { deep: true }
>   );
> 
>   if (props.initPageId) {
>     page = await os.api("pages/show", {
>       pageId: props.initPageId,
>     });
>   } else if (props.initPageName && props.initUser) {
>     page = await os.api("pages/show", {
>       name: props.initPageName,
>       username: props.initUser,
>     });
>     readonly = true;
>   }
> 
>   if (page) {
>     author = page.user;
>     pageId = page.id;
>     title = page.title;
>     name = page.name;
>     currentName = page.name;
>     summary = page.summary;
>     font = page.font;
>     script = page.script;
>     hideTitleWhenPinned = page.hideTitleWhenPinned;
>     alignCenter = page.alignCenter;
>     content = page.content;
>     variables = page.variables;
>     eyeCatchingImageId = page.eyeCatchingImageId;
>   } else {
>     const id = uuid();
>     content = [
>       {
>         id,
>         type: "text",
>         text: "Hello World!",
>       },
>     ];
>   }
271,279c492,513
< const headerTabs = $computed(() => [{
< 	key: 'settings',
< 	title: i18n.ts._pages.pageSetting,
< 	icon: 'ti ti-settings',
< }, {
< 	key: 'contents',
< 	title: i18n.ts._pages.contents,
< 	icon: 'ti ti-note',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "settings",
>     title: i18n.ts._pages.pageSetting,
>     icon: "fas fa-cog",
>   },
>   {
>     key: "contents",
>     title: i18n.ts._pages.contents,
>     icon: "fas fa-sticky-note",
>   },
>   {
>     key: "variables",
>     title: i18n.ts._pages.variables,
>     icon: "fas fa-magic",
>   },
>   {
>     key: "script",
>     title: i18n.ts.script,
>     icon: "fas fa-code",
>   },
> ]);
281,293c515,528
< definePageMetadata(computed(() => {
< 	let title = i18n.ts._pages.newPage;
< 	if (props.initPageId) {
< 		title = i18n.ts._pages.editPage;
< 	}
< 	else if (props.initPageName && props.initUser) {
< 		title = i18n.ts._pages.readPage;
< 	}
< 	return {
< 		title: title,
< 		icon: 'ti ti-pencil',
< 	};
< }));
---
> definePageMetadata(
>   computed(() => {
>     let title = i18n.ts._pages.newPage;
>     if (props.initPageId) {
>       title = i18n.ts._pages.editPage;
>     } else if (props.initPageName && props.initUser) {
>       title = i18n.ts._pages.readPage;
>     }
>     return {
>       title: title,
>       icon: "fas fa-pencil-alt",
>     };
>   })
> );
296,305d530
< <style lang="scss" module>
< .contents {
< 	&:global {
< 		> .add {
< 			margin: 16px auto 0 auto;
< 		}
< 	}
< }
< </style>
< 
308,314c533,537
< 	margin-bottom: 16px;
< 
< 	> .button {
< 		& + .button {
< 			margin-left: 8px;
< 		}
< 	}
---
>   > .button {
>     & + .button {
>       margin-left: 8px;
>     }
>   }
318c541
< 	position: relative;
---
>   position: relative;
320,328c543,551
< 	> header {
< 		> .title {
< 			z-index: 1;
< 			margin: 0;
< 			padding: 0 16px;
< 			line-height: 42px;
< 			font-size: 0.9em;
< 			font-weight: bold;
< 			box-shadow: 0 1px rgba(#000, 0.07);
---
>   > header {
>     > .title {
>       z-index: 1;
>       margin: 0;
>       padding: 0 16px;
>       line-height: 42px;
>       font-size: 0.9em;
>       font-weight: bold;
>       box-shadow: 0 1px rgba(#000, 0.07);
330,332c553,555
< 			> i {
< 				margin-right: 6px;
< 			}
---
>       > i {
>         margin-right: 6px;
>       }
334,337c557,560
< 			&:empty {
< 				display: none;
< 			}
< 		}
---
>       &:empty {
>         display: none;
>       }
>     }
339,343c562,566
< 		> .buttons {
< 			position: absolute;
< 			z-index: 2;
< 			top: 0;
< 			right: 0;
---
>     > .buttons {
>       position: absolute;
>       z-index: 2;
>       top: 0;
>       right: 0;
345,352c568,575
< 			> button {
< 				padding: 0;
< 				width: 42px;
< 				font-size: 0.9em;
< 				line-height: 42px;
< 			}
< 		}
< 	}
---
>       > button {
>         padding: 0;
>         width: 42px;
>         font-size: 0.9em;
>         line-height: 42px;
>       }
>     }
>   }
354,355c577,578
< 	> section {
< 		padding: 0 32px 32px 32px;
---
>   > section {
>     padding: 0 32px 32px 32px;
357,359c580,582
< 		@media (max-width: 500px) {
< 			padding: 0 16px 16px 16px;
< 		}
---
>     @media (max-width: 500px) {
>       padding: 0 16px 16px 16px;
>     }
361,365c584,588
< 		> .view {
< 			display: inline-block;
< 			margin: 16px 0 0 0;
< 			font-size: 14px;
< 		}
---
>     > .view {
>       display: inline-block;
>       margin: 16px 0 0 0;
>       font-size: 14px;
>     }
367,369c590,592
< 		> .content {
< 			margin-bottom: 16px;
< 		}
---
>     > .content {
>       margin-bottom: 16px;
>     }
371,372c594,595
< 		> .eyeCatch {
< 			margin-bottom: 16px;
---
>     > .eyeCatch {
>       margin-bottom: 16px;
374,380c597,603
< 			> div {
< 				> img {
< 					max-width: 100%;
< 				}
< 			}
< 		}
< 	}
---
>       > div {
>         > img {
>           max-width: 100%;
>         }
>       }
>     }
>   }
384c607
< 	padding: 16px;
---
>   padding: 16px;
386,388c609,611
< 	> .variables {
< 		margin-bottom: 16px;
< 	}
---
>   > .variables {
>     margin-bottom: 16px;
>   }
390,392c613,615
< 	> .add {
< 		margin-bottom: 16px;
< 	}
---
>   > .add {
>     margin-bottom: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/page.vue RiricaV13/pages/page.vue
2,8c2,15
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<Transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
< 			<div v-if="page" :key="page.id" class="xcukqgmh">
< 				<div class="main">
< 					<!--
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <transition :name="$store.state.animation ? 'fade' : ''" mode="out-in">
>         <div
>           v-if="page"
>           :key="page.id"
>           v-size="{ max: [450] }"
>           class="xcukqgmh"
>         >
>           <div class="_block main">
>             <!--
13,63c20,140
< 					<div class="banner">
< 						<img v-if="page.eyeCatchingImageId" :src="page.eyeCatchingImage.url"/>
< 					</div>
< 					<div class="content">
< 						<XPage :page="page"/>
< 					</div>
< 					<div class="actions">
< 						<div class="like">
< 							<MkButton v-if="page.isLiked" v-tooltip="i18n.ts._pages.unlike" class="button" as-like primary @click="unlike()"><i class="ti ti-heart-off"></i><span v-if="page.likedCount > 0" class="count">{{ page.likedCount }}</span></MkButton>
< 							<MkButton v-else v-tooltip="i18n.ts._pages.like" class="button" as-like @click="like()"><i class="ti ti-heart"></i><span v-if="page.likedCount > 0" class="count">{{ page.likedCount }}</span></MkButton>
< 						</div>
< 						<div class="other">
< 							<button v-tooltip="i18n.ts.shareWithNote" v-click-anime class="_button" @click="shareWithNote"><i class="ti ti-repeat ti-fw"></i></button>
< 							<button v-tooltip="i18n.ts.share" v-click-anime class="_button" @click="share"><i class="ti ti-share ti-fw"></i></button>
< 						</div>
< 					</div>
< 					<div class="user">
< 						<MkAvatar :user="page.user" class="avatar" link preview/>
< 						<div class="name">
< 							<MkUserName :user="page.user" style="display: block;"/>
< 							<MkAcct :user="page.user"/>
< 						</div>
< 						<MkFollowButton v-if="!$i || $i.id != page.user.id" :user="page.user" :inline="true" :transparent="false" :full="true" large class="koudoku"/>
< 					</div>
< 					<div class="links">
< 						<MkA :to="`/@${username}/pages/${pageName}/view-source`" class="link">{{ i18n.ts._pages.viewSource }}</MkA>
< 						<template v-if="$i && $i.id === page.userId">
< 							<MkA :to="`/pages/edit/${page.id}`" class="link">{{ i18n.ts._pages.editThisPage }}</MkA>
< 							<button v-if="$i.pinnedPageId === page.id" class="link _textButton" @click="pin(false)">{{ i18n.ts.unpin }}</button>
< 							<button v-else class="link _textButton" @click="pin(true)">{{ i18n.ts.pin }}</button>
< 						</template>
< 					</div>
< 				</div>
< 				<div class="footer">
< 					<div><i class="ti ti-clock"></i> {{ i18n.ts.createdAt }}: <MkTime :time="page.createdAt" mode="detail"/></div>
< 					<div v-if="page.createdAt != page.updatedAt"><i class="ti ti-clock"></i> {{ i18n.ts.updatedAt }}: <MkTime :time="page.updatedAt" mode="detail"/></div>
< 				</div>
< 				<MkAd :prefer="['horizontal', 'horizontal-big']"/>
< 				<MkContainer :max-height="300" :foldable="true" class="other">
< 					<template #icon><i class="ti ti-clock"></i></template>
< 					<template #header>{{ i18n.ts.recentPosts }}</template>
< 					<MkPagination v-slot="{items}" :pagination="otherPostsPagination">
< 						<MkPagePreview v-for="page in items" :key="page.id" :page="page" class="_margin"/>
< 					</MkPagination>
< 				</MkContainer>
< 			</div>
< 			<MkError v-else-if="error" @retry="fetchPage()"/>
< 			<MkLoading v-else/>
< 		</Transition>
< 	</MkSpacer>
< </MkStickyContainer>
---
>             <div class="banner">
>               <img
>                 v-if="page.eyeCatchingImageId"
>                 :src="page.eyeCatchingImage.url"
>               />
>             </div>
>             <div class="content">
>               <XPage :page="page" />
>             </div>
>             <div class="actions">
>               <div class="like">
>                 <MkButton
>                   v-if="page.isLiked"
>                   v-tooltip="i18n.ts._pages.unlike"
>                   class="button"
>                   primary
>                   @click="unlike()"
>                   ><i class="fas fa-heart"></i
>                   ><span v-if="page.likedCount > 0" class="count">{{
>                     page.likedCount
>                   }}</span></MkButton
>                 >
>                 <MkButton
>                   v-else
>                   v-tooltip="i18n.ts._pages.like"
>                   class="button"
>                   @click="like()"
>                   ><i class="far fa-heart"></i
>                   ><span v-if="page.likedCount > 0" class="count">{{
>                     page.likedCount
>                   }}</span></MkButton
>                 >
>               </div>
>               <div class="other">
>                 <button
>                   v-tooltip="i18n.ts.shareWithNote"
>                   v-click-anime
>                   class="_button"
>                   @click="shareWithNote"
>                 >
>                   <i class="fas fa-retweet fa-fw"></i>
>                 </button>
>                 <button
>                   v-tooltip="i18n.ts.share"
>                   v-click-anime
>                   class="_button"
>                   @click="share"
>                 >
>                   <i class="fas fa-share-alt fa-fw"></i>
>                 </button>
>               </div>
>             </div>
>             <div class="user">
>               <MkAvatar :user="page.user" class="avatar" />
>               <div class="name">
>                 <MkUserName :user="page.user" style="display: block" />
>                 <MkAcct :user="page.user" />
>               </div>
>               <MkFollowButton
>                 v-if="!$i || $i.id != page.user.id"
>                 :user="page.user"
>                 :inline="true"
>                 :transparent="false"
>                 :full="true"
>                 large
>                 class="koudoku"
>               />
>             </div>
>             <div class="links">
>               <MkA
>                 :to="`/@${username}/pages/${pageName}/view-source`"
>                 class="link"
>                 >{{ i18n.ts._pages.viewSource }}</MkA
>               >
>               <template v-if="$i && $i.id === page.userId">
>                 <MkA :to="`/pages/edit/${page.id}`" class="link">{{
>                   i18n.ts._pages.editThisPage
>                 }}</MkA>
>                 <button
>                   v-if="$i.pinnedPageId === page.id"
>                   class="link _textButton"
>                   @click="pin(false)"
>                 >
>                   {{ i18n.ts.unpin }}
>                 </button>
>                 <button v-else class="link _textButton" @click="pin(true)">
>                   {{ i18n.ts.pin }}
>                 </button>
>               </template>
>             </div>
>           </div>
>           <div class="footer">
>             <div>
>               <i class="far fa-clock"></i> {{ i18n.ts.createdAt }}:
>               <MkTime :time="page.createdAt" mode="detail" />
>             </div>
>             <div v-if="page.createdAt != page.updatedAt">
>               <i class="far fa-clock"></i> {{ i18n.ts.updatedAt }}:
>               <MkTime :time="page.updatedAt" mode="detail" />
>             </div>
>           </div>
>           <MkAd :prefer="['horizontal', 'horizontal-big']" />
>           <MkContainer :max-height="300" :foldable="true" class="other">
>             <template #header
>               ><i class="fas fa-clock"></i> {{ i18n.ts.recentPosts }}</template
>             >
>             <MkPagination v-slot="{ items }" :pagination="otherPostsPagination">
>               <MkPagePreview
>                 v-for="page in items"
>                 :key="page.id"
>                 :page="page"
>                 class="_gap"
>               />
>             </MkPagination>
>           </MkContainer>
>         </div>
>         <MkError v-else-if="error" @retry="fetchPage()" />
>         <MkLoading v-else />
>       </transition>
>     </MkSpacer>
>   </MkStickyContainer>
67,77c144,154
< import { computed, watch } from 'vue';
< import XPage from '@/components/page/page.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { url } from '@/config';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import MkContainer from '@/components/MkContainer.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkPagePreview from '@/components/MkPagePreview.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, watch } from "vue";
> import XPage from "@/components/page/page.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { url } from "@/config";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import MkContainer from "@/components/MkContainer.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkPagePreview from "@/components/MkPagePreview.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
80,81c157,158
< 	pageName: string;
< 	username: string;
---
>   pageName: string;
>   username: string;
87,91c164,168
< 	endpoint: 'users/pages' as const,
< 	limit: 6,
< 	params: computed(() => ({
< 		userId: page.user.id,
< 	})),
---
>   endpoint: "users/pages" as const,
>   limit: 6,
>   params: computed(() => ({
>     userId: page.user.id,
>   })),
93c170
< const path = $computed(() => props.username + '/' + props.pageName);
---
> const path = $computed(() => props.username + "/" + props.pageName);
96,104c173,183
< 	page = null;
< 	os.api('pages/show', {
< 		name: props.pageName,
< 		username: props.username,
< 	}).then(_page => {
< 		page = _page;
< 	}).catch(err => {
< 		error = err;
< 	});
---
>   page = null;
>   os.api("pages/show", {
>     name: props.pageName,
>     username: props.username,
>   })
>     .then((_page) => {
>       page = _page;
>     })
>     .catch((err) => {
>       error = err;
>     });
108,112c187,191
< 	navigator.share({
< 		title: page.title ?? page.name,
< 		text: page.summary,
< 		url: `${url}/@${page.user.username}/pages/${page.name}`,
< 	});
---
>   navigator.share({
>     title: page.title ?? page.name,
>     text: page.summary,
>     url: `${url}/@${page.user.username}/pages/${page.name}`,
>   });
116,118c195,199
< 	os.post({
< 		initialText: `${page.title || page.name} ${url}/@${page.user.username}/pages/${page.name}`,
< 	});
---
>   os.post({
>     initialText: `${page.title || page.name} ${url}/@${
>       page.user.username
>     }/pages/${page.name}`,
>   });
122,127c203,208
< 	os.apiWithDialog('pages/like', {
< 		pageId: page.id,
< 	}).then(() => {
< 		page.isLiked = true;
< 		page.likedCount++;
< 	});
---
>   os.apiWithDialog("pages/like", {
>     pageId: page.id,
>   }).then(() => {
>     page.isLiked = true;
>     page.likedCount++;
>   });
131,141c212,222
< 	const confirm = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.unlikeConfirm,
< 	});
< 	if (confirm.canceled) return;
< 	os.apiWithDialog('pages/unlike', {
< 		pageId: page.id,
< 	}).then(() => {
< 		page.isLiked = false;
< 		page.likedCount--;
< 	});
---
>   const confirm = await os.confirm({
>     type: "warning",
>     text: i18n.ts.unlikeConfirm,
>   });
>   if (confirm.canceled) return;
>   os.apiWithDialog("pages/unlike", {
>     pageId: page.id,
>   }).then(() => {
>     page.isLiked = false;
>     page.likedCount--;
>   });
145,147c226,228
< 	os.apiWithDialog('i/update', {
< 		pinnedPageId: pin ? page.id : null,
< 	});
---
>   os.apiWithDialog("i/update", {
>     pinnedPageId: pin ? page.id : null,
>   });
156,164c237,251
< definePageMetadata(computed(() => page ? {
< 	title: computed(() => page.title || page.name),
< 	avatar: page.user,
< 	path: `/@${page.user.username}/pages/${page.name}`,
< 	share: {
< 		title: page.title || page.name,
< 		text: page.summary,
< 	},
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     page
>       ? {
>           title: computed(() => page.title || page.name),
>           avatar: page.user,
>           path: `/@${page.user.username}/pages/${page.name}`,
>           share: {
>             title: page.title || page.name,
>             text: page.summary,
>           },
>         }
>       : null
>   )
> );
170c257
< 	transition: opacity 0.125s ease;
---
>   transition: opacity 0.125s ease;
174c261
< 	opacity: 0;
---
>   opacity: 0;
178,179c265,267
< 	> .main {
< 		padding: 32px;
---
>   > .main {
>     > .header {
>       padding: 16px;
181,182c269,272
< 		> .header {
< 			padding: 16px;
---
>       > h1 {
>         margin: 0;
>       }
>     }
184,187c274,282
< 			> h1 {
< 				margin: 0;
< 			}
< 		}
---
>     > .banner {
>       > img {
>         // TODO: 良い感じのアスペクト比で表示
>         display: block;
>         width: 100%;
>         height: 150px;
>         object-fit: cover;
>       }
>     }
189,197c284,287
< 		> .banner {
< 			> img {
< 				// TODO: 良い感じのアスペクト比で表示
< 				display: block;
< 				width: 100%;
< 				height: 150px;
< 				object-fit: cover;
< 			}
< 		}
---
>     > .content {
>       margin-top: 16px;
>       padding: 16px 0 0 0;
>     }
199,202c289,294
< 		> .content {
< 			margin-top: 16px;
< 			padding: 16px 0 0 0;
< 		}
---
>     > .actions {
>       display: flex;
>       align-items: center;
>       margin-top: 16px;
>       padding: 16px 0 0 0;
>       border-top: solid 0.5px var(--divider);
204,209c296,302
< 		> .actions {
< 			display: flex;
< 			align-items: center;
< 			margin-top: 16px;
< 			padding: 16px 0 0 0;
< 			border-top: solid 0.5px var(--divider);
---
>       > .like {
>         > .button {
>           --accent: rgb(241 97 132);
>           --X8: rgb(241 92 128);
>           --buttonBg: rgb(216 71 106 / 5%);
>           --buttonHoverBg: rgb(216 71 106 / 10%);
>           color: #ff002f;
211,212c304,308
< 			> .other {
< 				margin-left: auto;
---
>           ::v-deep(.count) {
>             margin-left: 0.5em;
>           }
>         }
>       }
214,216c310,311
< 				> button {
< 					padding: 8px;
< 					margin: 0 8px;
---
>       > .other {
>         margin-left: auto;
218,223c313,315
< 					&:hover {
< 						color: var(--fgHighlighted);
< 					}
< 				}
< 			}
< 		}
---
>         > button {
>           padding: 8px;
>           margin: 0 8px;
225,230c317,322
< 		> .user {
< 			margin-top: 16px;
< 			padding: 16px 0 0 0;
< 			border-top: solid 0.5px var(--divider);
< 			display: flex;
< 			align-items: center;
---
>           &:hover {
>             color: var(--fgHighlighted);
>           }
>         }
>       }
>     }
232,235c324,329
< 			> .avatar {
< 				width: 52px;
< 				height: 52px;
< 			}
---
>     > .user {
>       margin-top: 16px;
>       padding: 16px 0 0 0;
>       border-top: solid 0.5px var(--divider);
>       display: flex;
>       align-items: center;
237,240c331,334
< 			> .name {
< 				margin: 0 0 0 12px;
< 				font-size: 90%;
< 			}
---
>       > .avatar {
>         width: 52px;
>         height: 52px;
>       }
242,245c336,339
< 			> .koudoku {
< 				margin-left: auto;
< 			}
< 		}
---
>       > .name {
>         margin: 0 0 0 12px;
>         font-size: 90%;
>       }
247,250c341,344
< 		> .links {
< 			margin-top: 16px;
< 			padding: 24px 0 0 0;
< 			border-top: solid 0.5px var(--divider);
---
>       > .koudoku {
>         margin-left: auto;
>       }
>     }
252,256c346,349
< 			> .link {
< 				margin-right: 0.75em;
< 			}
< 		}
< 	}
---
>     > .links {
>       margin-top: 16px;
>       padding: 24px 0 0 0;
>       border-top: solid 0.5px var(--divider);
258,262c351,361
< 	> .footer {
< 		margin: var(--margin) 0 var(--margin) 0;
< 		font-size: 85%;
< 		opacity: 0.75;
< 	}
---
>       > .link {
>         margin-right: 0.75em;
>       }
>     }
>   }
> 
>   > .footer {
>     margin: var(--margin) 0 var(--margin) 0;
>     font-size: 85%;
>     opacity: 0.75;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/pages.vue RiricaV13/pages/pages.vue
2,9c2,19
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="700">
< 		<div v-if="tab === 'featured'" class="rknalgpo">
< 			<MkPagination v-slot="{items}" :pagination="featuredPagesPagination">
< 				<MkPagePreview v-for="page in items" :key="page.id" class="ckltabjg" :page="page"/>
< 			</MkPagination>
< 		</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="700">
>       <div v-if="tab === 'featured'" class="rknalgpo">
>         <MkPagination v-slot="{ items }" :pagination="featuredPagesPagination">
>           <MkPagePreview
>             v-for="page in items"
>             :key="page.id"
>             class="ckltabjg"
>             :page="page"
>           />
>         </MkPagination>
>       </div>
11,16c21,33
< 		<div v-else-if="tab === 'my'" class="rknalgpo my">
< 			<MkButton class="new" @click="create()"><i class="ti ti-plus"></i></MkButton>
< 			<MkPagination v-slot="{items}" :pagination="myPagesPagination">
< 				<MkPagePreview v-for="page in items" :key="page.id" class="ckltabjg" :page="page"/>
< 			</MkPagination>
< 		</div>
---
>       <div v-else-if="tab === 'my'" class="rknalgpo my">
>         <MkButton class="new" @click="create()"
>           ><i class="fas fa-plus"></i
>         ></MkButton>
>         <MkPagination v-slot="{ items }" :pagination="myPagesPagination">
>           <MkPagePreview
>             v-for="page in items"
>             :key="page.id"
>             class="ckltabjg"
>             :page="page"
>           />
>         </MkPagination>
>       </div>
18,24c35,46
< 		<div v-else-if="tab === 'liked'" class="rknalgpo">
< 			<MkPagination v-slot="{items}" :pagination="likedPagesPagination">
< 				<MkPagePreview v-for="like in items" :key="like.page.id" class="ckltabjg" :page="like.page"/>
< 			</MkPagination>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>       <div v-else-if="tab === 'liked'" class="rknalgpo">
>         <MkPagination v-slot="{ items }" :pagination="likedPagesPagination">
>           <MkPagePreview
>             v-for="like in items"
>             :key="like.page.id"
>             class="ckltabjg"
>             :page="like.page"
>           />
>         </MkPagination>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
28,34c50,56
< import { computed, inject } from 'vue';
< import MkPagePreview from '@/components/MkPagePreview.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkButton from '@/components/MkButton.vue';
< import { useRouter } from '@/router';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, inject } from "vue";
> import MkPagePreview from "@/components/MkPagePreview.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import { useRouter } from "@/router";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
38c60
< let tab = $ref('featured');
---
> let tab = $ref("featured");
41,42c63,64
< 	endpoint: 'pages/featured' as const,
< 	noPaging: true,
---
>   endpoint: "pages/featured" as const,
>   noPaging: true,
45,46c67,68
< 	endpoint: 'i/pages' as const,
< 	limit: 5,
---
>   endpoint: "i/pages" as const,
>   limit: 5,
49,50c71,72
< 	endpoint: 'i/page-likes' as const,
< 	limit: 5,
---
>   endpoint: "i/page-likes" as const,
>   limit: 5,
54c76
< 	router.push('/pages/new');
---
>   router.push("/pages/new");
57,61c79,85
< const headerActions = $computed(() => [{
< 	icon: 'ti ti-plus',
< 	text: i18n.ts.create,
< 	handler: create,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     icon: "fas fa-plus",
>     text: i18n.ts.create,
>     handler: create,
>   },
> ]);
63,75c87,103
< const headerTabs = $computed(() => [{
< 	key: 'featured',
< 	title: i18n.ts._pages.featured,
< 	icon: 'ti ti-flare',
< }, {
< 	key: 'my',
< 	title: i18n.ts._pages.my,
< 	icon: 'ti ti-edit',
< }, {
< 	key: 'liked',
< 	title: i18n.ts._pages.liked,
< 	icon: 'ti ti-heart',
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "featured",
>     title: i18n.ts._pages.featured,
>     icon: "fas fa-fire-alt",
>   },
>   {
>     key: "my",
>     title: i18n.ts._pages.my,
>     icon: "fas fa-edit",
>   },
>   {
>     key: "liked",
>     title: i18n.ts._pages.liked,
>     icon: "fas fa-heart",
>   },
> ]);
77,80c105,110
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.pages,
< 	icon: 'ti ti-note',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.pages,
>     icon: "fas fa-sticky-note",
>   }))
> );
85,87c115,117
< 	&.my .ckltabjg:first-child {
< 		margin-top: 16px;
< 	}
---
>   &.my .ckltabjg:first-child {
>     margin-top: 16px;
>   }
89,91c119,121
< 	.ckltabjg:not(:last-child) {
< 		margin-bottom: 8px;
< 	}
---
>   .ckltabjg:not(:last-child) {
>     margin-bottom: 8px;
>   }
93,97c123,127
< 	@media (min-width: 500px) {
< 		.ckltabjg:not(:last-child) {
< 			margin-bottom: 16px;
< 		}
< 	}
---
>   @media (min-width: 500px) {
>     .ckltabjg:not(:last-child) {
>       margin-bottom: 16px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/preview.vue RiricaV13/pages/preview.vue
2,4c2,4
< <div class="graojtoi">
< 	<MkSample/>
< </div>
---
>   <div class="graojtoi">
>     <MkSample />
>   </div>
8,11c8,11
< import { computed } from 'vue';
< import MkSample from '@/components/MkSample.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed } from "vue";
> import MkSample from "@/components/MkSample.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
17,20c17,22
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.preview,
< 	icon: 'ti ti-eye',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.preview,
>     icon: "fas fa-eye",
>   }))
> );
25c27
< 	padding: var(--margin);
---
>   padding: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/registry.keys.vue RiricaV13/pages/registry.keys.vue
2,17c2,16
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="600" :margin-min="16">
< 		<div class="_gaps_m">
< 			<FormSplit>
< 				<MkKeyValue>
< 					<template #key>{{ i18n.ts._registry.domain }}</template>
< 					<template #value>{{ i18n.ts.system }}</template>
< 				</MkKeyValue>
< 				<MkKeyValue>
< 					<template #key>{{ i18n.ts._registry.scope }}</template>
< 					<template #value>{{ scope.join('/') }}</template>
< 				</MkKeyValue>
< 			</FormSplit>
< 			
< 			<MkButton primary @click="createKey">{{ i18n.ts._registry.createKey }}</MkButton>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="600" :margin-min="16">
>       <FormSplit>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts._registry.domain }}</template>
>           <template #value>{{ i18n.ts.system }}</template>
>         </MkKeyValue>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts._registry.scope }}</template>
>           <template #value>{{ scope.join("/") }}</template>
>         </MkKeyValue>
>       </FormSplit>
19,27c18,35
< 			<FormSection v-if="keys">
< 				<template #label>{{ i18n.ts.keys }}</template>
< 				<div class="_formLinks">
< 					<FormLink v-for="key in keys" :to="`/registry/value/system/${scope.join('/')}/${key[0]}`" class="_monospace">{{ key[0] }}<template #suffix>{{ key[1].toUpperCase() }}</template></FormLink>
< 				</div>
< 			</FormSection>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>       <MkButton primary @click="createKey">{{
>         i18n.ts._registry.createKey
>       }}</MkButton>
> 
>       <FormSection v-if="keys">
>         <template #label>{{ i18n.ts.keys }}</template>
>         <div class="_formLinks">
>           <FormLink
>             v-for="key in keys"
>             :to="`/registry/value/system/${scope.join('/')}/${key[0]}`"
>             class="_monospace"
>             >{{ key[0]
>             }}<template #suffix>{{ key[1].toUpperCase() }}</template></FormLink
>           >
>         </div>
>       </FormSection>
>     </MkSpacer>
>   </MkStickyContainer>
31,40c39,48
< import { ref, watch } from 'vue';
< import JSON5 from 'json5';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import FormSplit from '@/components/form/split.vue';
---
> import { ref, watch } from "vue";
> import JSON5 from "json5";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import FormSplit from "@/components/form/split.vue";
43c51
< 	path: string;
---
>   path: string;
46c54
< const scope = $computed(() => props.path.split('/'));
---
> const scope = $computed(() => props.path.split("/"));
51,55c59,63
< 	os.api('i/registry/keys-with-type', {
< 		scope: scope,
< 	}).then(res => {
< 		keys = Object.entries(res).sort((a, b) => a[0].localeCompare(b[0]));
< 	});
---
>   os.api("i/registry/keys-with-type", {
>     scope: scope,
>   }).then((res) => {
>     keys = Object.entries(res).sort((a, b) => a[0].localeCompare(b[0]));
>   });
59,82c67,90
< 	const { canceled, result } = await os.form(i18n.ts._registry.createKey, {
< 		key: {
< 			type: 'string',
< 			label: i18n.ts._registry.key,
< 		},
< 		value: {
< 			type: 'string',
< 			multiline: true,
< 			label: i18n.ts.value,
< 		},
< 		scope: {
< 			type: 'string',
< 			label: i18n.ts._registry.scope,
< 			default: scope.join('/'),
< 		},
< 	});
< 	if (canceled) return;
< 	os.apiWithDialog('i/registry/set', {
< 		scope: result.scope.split('/'),
< 		key: result.key,
< 		value: JSON5.parse(result.value),
< 	}).then(() => {
< 		fetchKeys();
< 	});
---
>   const { canceled, result } = await os.form(i18n.ts._registry.createKey, {
>     key: {
>       type: "string",
>       label: i18n.ts._registry.key,
>     },
>     value: {
>       type: "string",
>       multiline: true,
>       label: i18n.ts.value,
>     },
>     scope: {
>       type: "string",
>       label: i18n.ts._registry.scope,
>       default: scope.join("/"),
>     },
>   });
>   if (canceled) return;
>   os.apiWithDialog("i/registry/set", {
>     scope: result.scope.split("/"),
>     key: result.key,
>     value: JSON5.parse(result.value),
>   }).then(() => {
>     fetchKeys();
>   });
92,93c100,101
< 	title: i18n.ts.registry,
< 	icon: 'ti ti-adjustments',
---
>   title: i18n.ts.registry,
>   icon: "fas fa-cogs",
97,98c105
< <style lang="scss" scoped>
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/registry.value.vue RiricaV13/pages/registry.value.vue
2,6c2,7
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="600" :margin-min="16">
< 		<div class="_gaps_m">
< 			<FormInfo warn>{{ i18n.ts.editTheseSettingsMayBreakAccount }}</FormInfo>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="600" :margin-min="16">
>       <FormInfo warn>{{ i18n.ts.editTheseSettingsMayBreakAccount }}</FormInfo>
8,26c9,23
< 			<template v-if="value">
< 				<FormSplit>
< 					<MkKeyValue>
< 						<template #key>{{ i18n.ts._registry.domain }}</template>
< 						<template #value>{{ i18n.ts.system }}</template>
< 					</MkKeyValue>
< 					<MkKeyValue>
< 						<template #key>{{ i18n.ts._registry.scope }}</template>
< 						<template #value>{{ scope.join('/') }}</template>
< 					</MkKeyValue>
< 					<MkKeyValue>
< 						<template #key>{{ i18n.ts._registry.key }}</template>
< 						<template #value>{{ key }}</template>
< 					</MkKeyValue>
< 				</FormSplit>
< 				
< 				<MkTextarea v-model="valueForEditor" tall class="_monospace">
< 					<template #label>{{ i18n.ts.value }} (JSON)</template>
< 				</MkTextarea>
---
>       <template v-if="value">
>         <FormSplit>
>           <MkKeyValue class="_formBlock">
>             <template #key>{{ i18n.ts._registry.domain }}</template>
>             <template #value>{{ i18n.ts.system }}</template>
>           </MkKeyValue>
>           <MkKeyValue class="_formBlock">
>             <template #key>{{ i18n.ts._registry.scope }}</template>
>             <template #value>{{ scope.join("/") }}</template>
>           </MkKeyValue>
>           <MkKeyValue class="_formBlock">
>             <template #key>{{ i18n.ts._registry.key }}</template>
>             <template #value>{{ key }}</template>
>           </MkKeyValue>
>         </FormSplit>
28c25,31
< 				<MkButton primary @click="save"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
---
>         <FormTextarea
>           v-model="valueForEditor"
>           tall
>           class="_formBlock _monospace"
>         >
>           <template #label>{{ i18n.ts.value }} (JSON)</template>
>         </FormTextarea>
30,33c33,35
< 				<MkKeyValue>
< 					<template #key>{{ i18n.ts.updatedAt }}</template>
< 					<template #value><MkTime :time="value.updatedAt" mode="detail"/></template>
< 				</MkKeyValue>
---
>         <MkButton class="_formBlock" primary @click="save"
>           ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>         >
35,39c37,49
< 				<MkButton danger @click="del"><i class="ti ti-trash"></i> {{ i18n.ts.delete }}</MkButton>
< 			</template>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.updatedAt }}</template>
>           <template #value
>             ><MkTime :time="value.updatedAt" mode="detail"
>           /></template>
>         </MkKeyValue>
> 
>         <MkButton danger @click="del"
>           ><i class="fas fa-trash"></i> {{ i18n.ts.delete }}</MkButton
>         >
>       </template>
>     </MkSpacer>
>   </MkStickyContainer>
43,54c53,64
< import { ref, watch } from 'vue';
< import JSON5 from 'json5';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import FormSplit from '@/components/form/split.vue';
< import FormInfo from '@/components/MkInfo.vue';
---
> import { ref, watch } from "vue";
> import JSON5 from "json5";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormInfo from "@/components/MkInfo.vue";
57c67
< 	path: string;
---
>   path: string;
60,61c70,71
< const scope = $computed(() => props.path.split('/').slice(0, -1));
< const key = $computed(() => props.path.split('/').at(-1));
---
> const scope = $computed(() => props.path.split("/").slice(0, -1));
> const key = $computed(() => props.path.split("/").at(-1));
67,73c77,83
< 	os.api('i/registry/get-detail', {
< 		scope,
< 		key,
< 	}).then(res => {
< 		value = res;
< 		valueForEditor = JSON5.stringify(res.value, null, '\t');
< 	});
---
>   os.api("i/registry/get-detail", {
>     scope,
>     key,
>   }).then((res) => {
>     value = res;
>     valueForEditor = JSON5.stringify(res.value, null, "\t");
>   });
77,96c87,106
< 	try {
< 		JSON5.parse(valueForEditor);
< 	} catch (err) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.invalidValue,
< 		});
< 		return;
< 	}
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.saveConfirm,
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
< 		os.apiWithDialog('i/registry/set', {
< 			scope,
< 			key,
< 			value: JSON5.parse(valueForEditor),
< 		});
< 	});
---
>   try {
>     JSON5.parse(valueForEditor);
>   } catch (err) {
>     os.alert({
>       type: "error",
>       text: i18n.ts.invalidValue,
>     });
>     return;
>   }
>   os.confirm({
>     type: "warning",
>     text: i18n.ts.saveConfirm,
>   }).then(({ canceled }) => {
>     if (canceled) return;
>     os.apiWithDialog("i/registry/set", {
>       scope,
>       key,
>       value: JSON5.parse(valueForEditor),
>     });
>   });
100,109c110,119
< 	os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.deleteConfirm,
< 	}).then(({ canceled }) => {
< 		if (canceled) return;
< 		os.apiWithDialog('i/registry/remove', {
< 			scope,
< 			key,
< 		});
< 	});
---
>   os.confirm({
>     type: "warning",
>     text: i18n.ts.deleteConfirm,
>   }).then(({ canceled }) => {
>     if (canceled) return;
>     os.apiWithDialog("i/registry/remove", {
>       scope,
>       key,
>     });
>   });
119,120c129,130
< 	title: i18n.ts.registry,
< 	icon: 'ti ti-adjustments',
---
>   title: i18n.ts.registry,
>   icon: "fas fa-cogs",
124,125c134
< <style lang="scss" scoped>
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/registry.vue RiricaV13/pages/registry.vue
2,5c2,9
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="600" :margin-min="16">
< 		<MkButton primary @click="createKey">{{ i18n.ts._registry.createKey }}</MkButton>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="600" :margin-min="16">
>       <MkButton primary @click="createKey">{{
>         i18n.ts._registry.createKey
>       }}</MkButton>
7,14c11,23
< 		<FormSection v-if="scopes">
< 			<template #label>{{ i18n.ts.system }}</template>
< 			<div class="_formLinks">
< 				<FormLink v-for="scope in scopes" :to="`/registry/keys/system/${scope.join('/')}`" class="_monospace">{{ scope.join('/') }}</FormLink>
< 			</div>
< 		</FormSection>
< 	</MkSpacer>
< </MkStickyContainer>
---
>       <FormSection v-if="scopes">
>         <template #label>{{ i18n.ts.system }}</template>
>         <div class="_formLinks">
>           <FormLink
>             v-for="scope in scopes"
>             :to="`/registry/keys/system/${scope.join('/')}`"
>             class="_monospace"
>             >{{ scope.join("/") }}</FormLink
>           >
>         </div>
>       </FormSection>
>     </MkSpacer>
>   </MkStickyContainer>
18,25c27,34
< import { ref, watch } from 'vue';
< import JSON5 from 'json5';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
---
> import { ref, watch } from "vue";
> import JSON5 from "json5";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
30,32c39,41
< 	os.api('i/registry/scopes').then(res => {
< 		scopes = res.slice().sort((a, b) => a.join('/').localeCompare(b.join('/')));
< 	});
---
>   os.api("i/registry/scopes").then((res) => {
>     scopes = res.slice().sort((a, b) => a.join("/").localeCompare(b.join("/")));
>   });
36,58c45,67
< 	const { canceled, result } = await os.form(i18n.ts._registry.createKey, {
< 		key: {
< 			type: 'string',
< 			label: i18n.ts._registry.key,
< 		},
< 		value: {
< 			type: 'string',
< 			multiline: true,
< 			label: i18n.ts.value,
< 		},
< 		scope: {
< 			type: 'string',
< 			label: i18n.ts._registry.scope,
< 		},
< 	});
< 	if (canceled) return;
< 	os.apiWithDialog('i/registry/set', {
< 		scope: result.scope.split('/'),
< 		key: result.key,
< 		value: JSON5.parse(result.value),
< 	}).then(() => {
< 		fetchScopes();
< 	});
---
>   const { canceled, result } = await os.form(i18n.ts._registry.createKey, {
>     key: {
>       type: "string",
>       label: i18n.ts._registry.key,
>     },
>     value: {
>       type: "string",
>       multiline: true,
>       label: i18n.ts.value,
>     },
>     scope: {
>       type: "string",
>       label: i18n.ts._registry.scope,
>     },
>   });
>   if (canceled) return;
>   os.apiWithDialog("i/registry/set", {
>     scope: result.scope.split("/"),
>     key: result.key,
>     value: JSON5.parse(result.value),
>   }).then(() => {
>     fetchScopes();
>   });
68,69c77,78
< 	title: i18n.ts.registry,
< 	icon: 'ti ti-adjustments',
---
>   title: i18n.ts.registry,
>   icon: "fas fa-cogs",
73,74c82
< <style lang="scss" scoped>
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/reset-password.vue RiricaV13/pages/reset-password.vue
2,14c2,18
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer v-if="token" :content-max="700" :margin-min="16" :margin-max="32">
< 		<div class="_gaps_m">
< 			<MkInput v-model="password" type="password">
< 				<template #prefix><i class="ti ti-lock"></i></template>
< 				<template #label>{{ i18n.ts.newPassword }}</template>
< 			</MkInput>
< 		
< 			<MkButton primary @click="save">{{ i18n.ts.save }}</MkButton>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer v-if="token" :content-max="700" :margin-min="16" :margin-max="32">
>       <div class="_formRoot">
>         <FormInput v-model="password" type="password" class="_formBlock">
>           <template #prefix><i class="fas fa-lock"></i></template>
>           <template #label>{{ i18n.ts.newPassword }}</template>
>         </FormInput>
> 
>         <FormButton primary class="_formBlock" @click="save">{{
>           i18n.ts.save
>         }}</FormButton>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
18,24c22,28
< import { defineAsyncComponent, onMounted } from 'vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { mainRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { defineAsyncComponent, onMounted } from "vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { mainRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
27c31
< 	token?: string;
---
>   token?: string;
30c34
< let password = $ref('');
---
> let password = $ref("");
33,37c37,41
< 	await os.apiWithDialog('reset-password', {
< 		token: props.token,
< 		password: password,
< 	});
< 	mainRouter.push('/');
---
>   await os.apiWithDialog("reset-password", {
>     token: props.token,
>     password: password,
>   });
>   mainRouter.push("/");
41,44c45,53
< 	if (props.token == null) {
< 		os.popup(defineAsyncComponent(() => import('@/components/MkForgotPassword.vue')), {}, {}, 'closed');
< 		mainRouter.push('/');
< 	}
---
>   if (props.token == null) {
>     os.popup(
>       defineAsyncComponent(() => import("@/components/MkForgotPassword.vue")),
>       {},
>       {},
>       "closed"
>     );
>     mainRouter.push("/");
>   }
52,53c61,62
< 	title: i18n.ts.resetPassword,
< 	icon: 'ti ti-lock',
---
>   title: i18n.ts.resetPassword,
>   icon: "fas fa-lock",
57,59c66
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/scratchpad.vue RiricaV13/pages/scratchpad.vue
2,7c2,16
< <MkSpacer :content-max="800">
< 	<div :class="$style.root">
< 		<div :class="$style.editor" class="_panel">
< 			<PrismEditor v-model="code" class="_code code" :highlight="highlighter" :line-numbers="false"/>
< 			<MkButton style="position: absolute; top: 8px; right: 8px;" primary @click="run()"><i class="ti ti-player-play"></i></MkButton>
< 		</div>
---
>   <div class="iltifgqe">
>     <div class="editor _panel _gap">
>       <PrismEditor
>         v-model="code"
>         class="_code code"
>         :highlight="highlighter"
>         :line-numbers="false"
>       />
>       <MkButton
>         style="position: absolute; top: 8px; right: 8px"
>         primary
>         @click="run()"
>         ><i class="fas fa-play"></i
>       ></MkButton>
>     </div>
9,14c18,30
< 		<MkContainer v-if="root && components.length > 1" :key="uiKey" :foldable="true">
< 			<template #header>UI</template>
< 			<div :class="$style.ui">
< 				<MkAsUi :component="root" :components="components" size="small"/>
< 			</div>
< 		</MkContainer>
---
>     <MkContainer :foldable="true" class="_gap">
>       <template #header>{{ i18n.ts.output }}</template>
>       <div class="bepmlvbi">
>         <div
>           v-for="log in logs"
>           :key="log.id"
>           class="log"
>           :class="{ print: log.print }"
>         >
>           {{ log.text }}
>         </div>
>       </div>
>     </MkContainer>
16,27c32,35
< 		<MkContainer :foldable="true" class="">
< 			<template #header>{{ i18n.ts.output }}</template>
< 			<div :class="$style.logs">
< 				<div v-for="log in logs" :key="log.id" class="log" :class="{ print: log.print }">{{ log.text }}</div>
< 			</div>
< 		</MkContainer>
< 
< 		<div class="">
< 			{{ i18n.ts.scratchpadDescription }}
< 		</div>
< 	</div>
< </MkSpacer>
---
>     <div class="_gap">
>       {{ i18n.ts.scratchpadDescription }}
>     </div>
>   </div>
31,50c39,54
< import { onDeactivated, onUnmounted, Ref, ref, watch } from 'vue';
< import 'prismjs';
< import { highlight, languages } from 'prismjs/components/prism-core';
< import 'prismjs/components/prism-clike';
< import 'prismjs/components/prism-javascript';
< import 'prismjs/themes/prism-okaidia.css';
< import { PrismEditor } from 'vue-prism-editor';
< import 'vue-prism-editor/dist/prismeditor.min.css';
< import { Interpreter, Parser, utils } from '@syuilo/aiscript';
< import MkContainer from '@/components/MkContainer.vue';
< import MkButton from '@/components/MkButton.vue';
< import { createAiScriptEnv } from '@/scripts/aiscript/api';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { AsUiComponent, AsUiRoot, patch, registerAsUiLib, render } from '@/scripts/aiscript/ui';
< import MkAsUi from '@/components/MkAsUi.vue';
< import { miLocalStorage } from '@/local-storage';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { ref, watch } from "vue";
> import "prismjs";
> import { highlight, languages } from "prismjs/components/prism-core";
> import "prismjs/components/prism-clike";
> import "prismjs/components/prism-javascript";
> import "prismjs/themes/prism-okaidia.css";
> import { PrismEditor } from "vue-prism-editor";
> import "vue-prism-editor/dist/prismeditor.min.css";
> import { AiScript, parse, utils } from "@syuilo/aiscript";
> import MkContainer from "@/components/MkContainer.vue";
> import MkButton from "@/components/MkButton.vue";
> import { createAiScriptEnv } from "@/scripts/aiscript/api";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
52,54c56
< const parser = new Parser();
< let aiscript: Interpreter;
< const code = ref('');
---
> const code = ref("");
56,58d57
< const root = ref<AsUiRoot>();
< let components: Ref<AsUiComponent>[] = $ref([]);
< let uiKey = $ref(0);
60c59
< const saved = miLocalStorage.getItem('scratchpad');
---
> const saved = localStorage.getItem("scratchpad");
62c61
< 	code.value = saved;
---
>   code.value = saved;
66c65
< 	miLocalStorage.setItem('scratchpad', code.value);
---
>   localStorage.setItem("scratchpad", code.value);
70,113c69,106
< 	if (aiscript) aiscript.abort();
< 	root.value = undefined;
< 	components = [];
< 	uiKey++;
< 	logs.value = [];
< 	aiscript = new Interpreter(({
< 		...createAiScriptEnv({
< 			storageKey: 'widget',
< 			token: $i?.token,
< 		}),
< 		...registerAsUiLib(components, (_root) => {
< 			root.value = _root.value;
< 		}),
< 	}), {
< 		in: (q) => {
< 			return new Promise(ok => {
< 				os.inputText({
< 					title: q,
< 				}).then(({ canceled, result: a }) => {
< 					ok(a);
< 				});
< 			});
< 		},
< 		out: (value) => {
< 			if (value.type === 'str' && value.value.toLowerCase().replace(',', '').includes('hello world')) {
< 				claimAchievement('outputHelloWorldOnScratchpad');
< 			}
< 			logs.value.push({
< 				id: Math.random(),
< 				text: value.type === 'str' ? value.value : utils.valToString(value),
< 				print: true,
< 			});
< 		},
< 		log: (type, params) => {
< 			switch (type) {
< 				case 'end': logs.value.push({
< 					id: Math.random(),
< 					text: utils.valToString(params.val, true),
< 					print: false,
< 				}); break;
< 				default: break;
< 			}
< 		},
< 	});
---
>   logs.value = [];
>   const aiscript = new AiScript(
>     createAiScriptEnv({
>       storageKey: "scratchpad",
>       token: $i?.token,
>     }),
>     {
>       in: (q) => {
>         return new Promise((ok) => {
>           os.inputText({
>             title: q,
>           }).then(({ canceled, result: a }) => {
>             ok(a);
>           });
>         });
>       },
>       out: (value) => {
>         logs.value.push({
>           id: Math.random(),
>           text: value.type === "str" ? value.value : utils.valToString(value),
>           print: true,
>         });
>       },
>       log: (type, params) => {
>         switch (type) {
>           case "end":
>             logs.value.push({
>               id: Math.random(),
>               text: utils.valToString(params.val, true),
>               print: false,
>             });
>             break;
>           default:
>             break;
>         }
>       },
>     }
>   );
115,133c108,125
< 	let ast;
< 	try {
< 		ast = parser.parse(code.value);
< 	} catch (error) {
< 		os.alert({
< 			type: 'error',
< 			text: 'Syntax error :(',
< 		});
< 		return;
< 	}
< 	try {
< 		await aiscript.exec(ast);
< 	} catch (err: any) {
< 		os.alert({
< 			type: 'error',
< 			title: 'AiScript Error',
< 			text: err.message,
< 		});
< 	}
---
>   let ast;
>   try {
>     ast = parse(code.value);
>   } catch (error) {
>     os.alert({
>       type: "error",
>       text: "Syntax error :(",
>     });
>     return;
>   }
>   try {
>     await aiscript.exec(ast);
>   } catch (error: any) {
>     os.alert({
>       type: "error",
>       text: error.message,
>     });
>   }
137c129
< 	return highlight(code, languages.js, 'javascript');
---
>   return highlight(code, languages.js, "javascript");
140,147d131
< onDeactivated(() => {
< 	if (aiscript) aiscript.abort();
< });
< 
< onUnmounted(() => {
< 	if (aiscript) aiscript.abort();
< });
< 
153,154c137,138
< 	title: i18n.ts.scratchpad,
< 	icon: 'ti ti-terminal-2',
---
>   title: i18n.ts.scratchpad,
>   icon: "fas fa-terminal",
158,163c142,144
< <style lang="scss" module>
< .root {
< 	display: flex;
< 	flex-direction: column;
< 	gap: var(--margin);
< }
---
> <style lang="scss" scoped>
> .iltifgqe {
>   padding: 16px;
165,166c146,148
< .editor {
< 	position: relative;
---
>   > .editor {
>     position: relative;
>   }
169,171c151,152
< .ui {
< 	padding: 32px;
< }
---
> .bepmlvbi {
>   padding: 16px;
173,182c154,158
< .logs {
< 	padding: 16px;
< 
< 	&:global {
< 		> .log {
< 			&:not(.print) {
< 				opacity: 0.7;
< 			}
< 		}
< 	}
---
>   > .log {
>     &:not(.print) {
>       opacity: 0.7;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/search.vue RiricaV13/pages/search.vue
2,7c2,9
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<XNotes ref="notes" :pagination="pagination"/>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <XNotes ref="notes" :pagination="pagination" />
>     </MkSpacer>
>   </MkStickyContainer>
11,17c13,16
< import { computed } from 'vue';
< import XNotes from '@/components/MkNotes.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { $i } from '@/account';
---
> import { computed } from "vue";
> import XNotes from "@/components/MkNotes.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
19,20d17
< const router = useRouter();
< 
22,23c19,20
< 	query: string;
< 	channel?: string;
---
>   query: string;
>   channel?: string;
26,45d22
< const query = props.query;
< 
< if ($i != null) {
< 	if (query.startsWith('https://') || (query.startsWith('@') && !query.includes(' '))) {
< 		const promise = os.api('ap/show', {
< 			uri: props.query,
< 		});
< 
< 		os.promiseDialog(promise, null, null, i18n.ts.fetchingAsApObject);
< 
< 		const res = await promise;
< 
< 		if (res.type === 'User') {
< 			router.replace(`/@${res.object.username}@${res.object.host}`);
< 		} else if (res.type === 'Note') {
< 			router.replace(`/notes/${res.object.id}`);
< 		}
< 	}
< }
< 
47,52c24,29
< 	endpoint: 'notes/search' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		query: props.query,
< 		channelId: props.channel,
< 	})),
---
>   endpoint: "notes/search" as const,
>   limit: 10,
>   params: computed(() => ({
>     query: props.query,
>     channelId: props.channel,
>   })),
59,62c36,41
< definePageMetadata(computed(() => ({
< 	title: i18n.t('searchWith', { q: props.query }),
< 	icon: 'ti ti-search',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.t("searchWith", { q: props.query }),
>     icon: "fas fa-search",
>   }))
> );
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/2fa.vue RiricaV13/pages/settings/2fa.vue
2,6c2,8
< <div>
< 	<MkButton v-if="!twoFactorData && !$i.twoFactorEnabled" @click="register">{{ i18n.ts._2fa.registerDevice }}</MkButton>
< 	<template v-if="$i.twoFactorEnabled">
< 		<p>{{ i18n.ts._2fa.alreadyRegistered }}</p>
< 		<MkButton @click="unregister">{{ i18n.ts.unregister }}</MkButton>
---
>   <div>
>     <MkButton v-if="!twoFactorData && !$i.twoFactorEnabled" @click="register">{{
>       i18n.ts._2fa.registerDevice
>     }}</MkButton>
>     <template v-if="$i.twoFactorEnabled">
>       <p>{{ i18n.ts._2fa.alreadyRegistered }}</p>
>       <MkButton @click="unregister">{{ i18n.ts.unregister }}</MkButton>
8,9c10,11
< 		<template v-if="supportsCredentials">
< 			<hr class="totp-method-sep">
---
>       <template v-if="supportsCredentials">
>         <hr class="totp-method-sep" />
11,19c13,25
< 			<h2 class="heading">{{ i18n.ts.securityKey }}</h2>
< 			<p>{{ i18n.ts._2fa.securityKeyInfo }}</p>
< 			<div class="key-list">
< 				<div v-for="key in $i.securityKeysList" class="key">
< 					<h3>{{ key.name }}</h3>
< 					<div class="last-used">{{ i18n.ts.lastUsed }}<MkTime :time="key.lastUsed"/></div>
< 					<MkButton @click="unregisterKey(key)">{{ i18n.ts.unregister }}</MkButton>
< 				</div>
< 			</div>
---
>         <h2 class="heading">{{ i18n.ts.securityKey }}</h2>
>         <p>{{ i18n.ts._2fa.securityKeyInfo }}</p>
>         <div class="key-list">
>           <div v-for="key in $i.securityKeysList" class="key">
>             <h3>{{ key.name }}</h3>
>             <div class="last-used">
>               {{ i18n.ts.lastUsed }}<MkTime :time="key.lastUsed" />
>             </div>
>             <MkButton @click="unregisterKey(key)">{{
>               i18n.ts.unregister
>             }}</MkButton>
>           </div>
>         </div>
21c27,32
< 			<MkSwitch v-if="$i.securityKeysList.length > 0" v-model="usePasswordLessLogin" @update:model-value="updatePasswordLessLogin">{{ i18n.ts.passwordLessLogin }}</MkSwitch>
---
>         <MkSwitch
>           v-if="$i.securityKeysList.length > 0"
>           v-model="usePasswordLessLogin"
>           @update:modelValue="updatePasswordLessLogin"
>           >{{ i18n.ts.passwordLessLogin }}</MkSwitch
>         >
23,24c34,41
< 			<MkInfo v-if="registration && registration.error" warn>{{ i18n.ts.error }} {{ registration.error }}</MkInfo>
< 			<MkButton v-if="!registration || registration.error" @click="addSecurityKey">{{ i18n.ts._2fa.registerKey }}</MkButton>
---
>         <MkInfo v-if="registration && registration.error" warn
>           >{{ i18n.ts.error }} {{ registration.error }}</MkInfo
>         >
>         <MkButton
>           v-if="!registration || registration.error"
>           @click="addSecurityKey"
>           >{{ i18n.ts._2fa.registerKey }}</MkButton
>         >
26,64c43,111
< 			<ol v-if="registration && !registration.error">
< 				<li v-if="registration.stage >= 0">
< 					{{ i18n.ts.tapSecurityKey }}
< 					<MkLoading v-if="registration.saving && registration.stage == 0" :em="true"/>
< 				</li>
< 				<li v-if="registration.stage >= 1">
< 					<MkForm :disabled="registration.stage != 1 || registration.saving">
< 						<MkInput v-model="keyName" :max="30">
< 							<template #label>{{ i18n.ts.securityKeyName }}</template>
< 						</MkInput>
< 						<MkButton :disabled="keyName.length == 0" @click="registerKey">{{ i18n.ts.registerSecurityKey }}</MkButton>
< 						<MkLoading v-if="registration.saving && registration.stage == 1" :em="true"/>
< 					</MkForm>
< 				</li>
< 			</ol>
< 		</template>
< 	</template>
< 	<div v-if="twoFactorData && !$i.twoFactorEnabled">
< 		<ol style="margin: 0; padding: 0 0 0 1em;">
< 			<li>
< 				<I18n :src="i18n.ts._2fa.step1" tag="span">
< 					<template #a>
< 						<a href="https://authy.com/" rel="noopener" target="_blank" class="_link">Authy</a>
< 					</template>
< 					<template #b>
< 						<a href="https://support.google.com/accounts/answer/1066447" rel="noopener" target="_blank" class="_link">Google Authenticator</a>
< 					</template>
< 				</I18n>
< 			</li>
< 			<li>{{ i18n.ts._2fa.step2 }}<br><img :src="twoFactorData.qr"><p>{{ $ts._2fa.step2Url }}<br>{{ twoFactorData.url }}</p></li>
< 			<li>
< 				{{ i18n.ts._2fa.step3 }}<br>
< 				<MkInput v-model="token" type="text" pattern="^[0-9]{6}$" autocomplete="off" :spellcheck="false"><template #label>{{ i18n.ts.token }}</template></MkInput>
< 				<MkButton primary @click="submit">{{ i18n.ts.done }}</MkButton>
< 			</li>
< 		</ol>
< 		<MkInfo>{{ i18n.ts._2fa.step4 }}</MkInfo>
< 	</div>
< </div>
---
>         <ol v-if="registration && !registration.error">
>           <li v-if="registration.stage >= 0">
>             {{ i18n.ts.tapSecurityKey }}
>             <i
>               v-if="registration.saving && registration.stage == 0"
>               class="fas fa-spinner fa-pulse fa-fw"
>             ></i>
>           </li>
>           <li v-if="registration.stage >= 1">
>             <MkForm :disabled="registration.stage != 1 || registration.saving">
>               <MkInput v-model="keyName" :max="30">
>                 <template #label>{{ i18n.ts.securityKeyName }}</template>
>               </MkInput>
>               <MkButton :disabled="keyName.length == 0" @click="registerKey">{{
>                 i18n.ts.registerSecurityKey
>               }}</MkButton>
>               <i
>                 v-if="registration.saving && registration.stage == 1"
>                 class="fas fa-spinner fa-pulse fa-fw"
>               ></i>
>             </MkForm>
>           </li>
>         </ol>
>       </template>
>     </template>
>     <div v-if="twoFactorData && !$i.twoFactorEnabled">
>       <ol style="margin: 0; padding: 0 0 0 1em">
>         <li>
>           <I18n :src="i18n.ts._2fa.step1" tag="span">
>             <template #a>
>               <a
>                 href="https://authy.com/"
>                 rel="noopener"
>                 target="_blank"
>                 class="_link"
>                 >Authy</a
>               >
>             </template>
>             <template #b>
>               <a
>                 href="https://support.google.com/accounts/answer/1066447"
>                 rel="noopener"
>                 target="_blank"
>                 class="_link"
>                 >Google Authenticator</a
>               >
>             </template>
>           </I18n>
>         </li>
>         <li>
>           {{ i18n.ts._2fa.step2 }}<br /><img :src="twoFactorData.qr" />
>           <p>{{ $ts._2fa.step2Url }}<br />{{ twoFactorData.url }}</p>
>         </li>
>         <li>
>           {{ i18n.ts._2fa.step3 }}<br />
>           <MkInput
>             v-model="token"
>             type="text"
>             pattern="^[0-9]{6}$"
>             autocomplete="off"
>             :spellcheck="false"
>             ><template #label>{{ i18n.ts.token }}</template></MkInput
>           >
>           <MkButton primary @click="submit">{{ i18n.ts.done }}</MkButton>
>         </li>
>       </ol>
>       <MkInfo>{{ i18n.ts._2fa.step4 }}</MkInfo>
>     </div>
>   </div>
68,77c115,124
< import { ref } from 'vue';
< import { hostname } from '@/config';
< import { byteify, hexify, stringify } from '@/scripts/2fa';
< import MkButton from '@/components/MkButton.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
---
> import { ref } from "vue";
> import { hostname } from "@/config";
> import { byteify, hexify, stringify } from "@/scripts/2fa";
> import MkButton from "@/components/MkButton.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
83c130
< const keyName = ref('');
---
> const keyName = ref("");
87,97c134,144
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		os.api('i/2fa/register', {
< 			password: password,
< 		}).then(data => {
< 			twoFactorData.value = data;
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     os.api("i/2fa/register", {
>       password: password,
>     }).then((data) => {
>       twoFactorData.value = data;
>     });
>   });
101,115c148,164
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		os.api('i/2fa/unregister', {
< 			password: password,
< 		}).then(() => {
< 			usePasswordLessLogin.value = false;
< 			updatePasswordLessLogin();
< 		}).then(() => {
< 			os.success();
< 			$i!.twoFactorEnabled = false;
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     os.api("i/2fa/unregister", {
>       password: password,
>     })
>       .then(() => {
>         usePasswordLessLogin.value = false;
>         updatePasswordLessLogin();
>       })
>       .then(() => {
>         os.success();
>         $i!.twoFactorEnabled = false;
>       });
>   });
119,129c168,180
< 	os.api('i/2fa/done', {
< 		token: token.value,
< 	}).then(() => {
< 		os.success();
< 		$i!.twoFactorEnabled = true;
< 	}).catch(err => {
< 		os.alert({
< 			type: 'error',
< 			text: err,
< 		});
< 	});
---
>   os.api("i/2fa/done", {
>     token: token.value,
>   })
>     .then(() => {
>       os.success();
>       $i!.twoFactorEnabled = true;
>     })
>     .catch((err) => {
>       os.alert({
>         type: "error",
>         text: err,
>       });
>     });
133,145c184,200
< 	registration.value.saving = true;
< 	os.api('i/2fa/key-done', {
< 		password: registration.value.password,
< 		name: keyName.value,
< 		challengeId: registration.value.challengeId,
< 		// we convert each 16 bits to a string to serialise
< 		clientDataJSON: stringify(registration.value.credential.response.clientDataJSON),
< 		attestationObject: hexify(registration.value.credential.response.attestationObject),
< 	}).then(key => {
< 		registration.value = null;
< 		key.lastUsed = new Date();
< 		os.success();
< 	});
---
>   registration.value.saving = true;
>   os.api("i/2fa/key-done", {
>     password: registration.value.password,
>     name: keyName.value,
>     challengeId: registration.value.challengeId,
>     // we convert each 16 bits to a string to serialise
>     clientDataJSON: stringify(
>       registration.value.credential.response.clientDataJSON
>     ),
>     attestationObject: hexify(
>       registration.value.credential.response.attestationObject
>     ),
>   }).then((key) => {
>     registration.value = null;
>     key.lastUsed = new Date();
>     os.success();
>   });
149,163c204,221
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		return os.api('i/2fa/remove-key', {
< 			password,
< 			credentialId: key.id,
< 		}).then(() => {
< 			usePasswordLessLogin.value = false;
< 			updatePasswordLessLogin();
< 		}).then(() => {
< 			os.success();
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     return os
>       .api("i/2fa/remove-key", {
>         password,
>         credentialId: key.id,
>       })
>       .then(() => {
>         usePasswordLessLogin.value = false;
>         updatePasswordLessLogin();
>       })
>       .then(() => {
>         os.success();
>       });
>   });
167,208c225,269
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		os.api('i/2fa/register-key', {
< 			password,
< 		}).then(reg => {
< 			registration.value = {
< 				password,
< 				challengeId: reg!.challengeId,
< 				stage: 0,
< 				publicKeyOptions: {
< 					challenge: byteify(reg!.challenge, 'base64'),
< 					rp: {
< 						id: hostname,
< 						name: 'Misskey',
< 					},
< 					user: {
< 						id: byteify($i!.id, 'ascii'),
< 						name: $i!.username,
< 						displayName: $i!.name,
< 					},
< 					pubKeyCredParams: [{ alg: -7, type: 'public-key' }],
< 					timeout: 60000,
< 					attestation: 'direct',
< 				},
< 				saving: true,
< 			};
< 			return navigator.credentials.create({
< 				publicKey: registration.value.publicKeyOptions,
< 			});
< 		}).then(credential => {
< 			registration.value.credential = credential;
< 			registration.value.saving = false;
< 			registration.value.stage = 1;
< 		}).catch(err => {
< 			console.warn('Error while registering?', err);
< 			registration.value.error = err.message;
< 			registration.value.stage = -1;
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     os.api("i/2fa/register-key", {
>       password,
>     })
>       .then((reg) => {
>         registration.value = {
>           password,
>           challengeId: reg!.challengeId,
>           stage: 0,
>           publicKeyOptions: {
>             challenge: byteify(reg!.challenge, "base64"),
>             rp: {
>               id: hostname,
>               name: "Misskey",
>             },
>             user: {
>               id: byteify($i!.id, "ascii"),
>               name: $i!.username,
>               displayName: $i!.name,
>             },
>             pubKeyCredParams: [{ alg: -7, type: "public-key" }],
>             timeout: 60000,
>             attestation: "direct",
>           },
>           saving: true,
>         };
>         return navigator.credentials.create({
>           publicKey: registration.value.publicKeyOptions,
>         });
>       })
>       .then((credential) => {
>         registration.value.credential = credential;
>         registration.value.saving = false;
>         registration.value.stage = 1;
>       })
>       .catch((err) => {
>         console.warn("Error while registering?", err);
>         registration.value.error = err.message;
>         registration.value.stage = -1;
>       });
>   });
212,214c273,275
< 	await os.api('i/2fa/password-less', {
< 		value: !!usePasswordLessLogin.value,
< 	});
---
>   await os.api("i/2fa/password-less", {
>     value: !!usePasswordLessLogin.value,
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/account-info.vue RiricaV13/pages/settings/account-info.vue
2,6c2,8
< <div class="_gaps_m">
< 	<MkKeyValue>
< 		<template #key>ID</template>
< 		<template #value><span class="_monospace">{{ $i.id }}</span></template>
< 	</MkKeyValue>
---
>   <div class="_formRoot">
>     <MkKeyValue>
>       <template #key>ID</template>
>       <template #value
>         ><span class="_monospace">{{ $i.id }}</span></template
>       >
>     </MkKeyValue>
8,13c10,17
< 	<FormSection>
< 		<MkKeyValue>
< 			<template #key>{{ i18n.ts.registeredDate }}</template>
< 			<template #value><MkTime :time="$i.createdAt" mode="detail"/></template>
< 		</MkKeyValue>
< 	</FormSection>
---
>     <FormSection>
>       <MkKeyValue>
>         <template #key>{{ i18n.ts.registeredDate }}</template>
>         <template #value
>           ><MkTime :time="$i.createdAt" mode="detail"
>         /></template>
>       </MkKeyValue>
>     </FormSection>
15,97c19,109
< 	<FormSection v-if="stats">
< 		<template #label>{{ i18n.ts.statistics }}</template>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.notesCount }}</template>
< 			<template #value>{{ number(stats.notesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.repliesCount }}</template>
< 			<template #value>{{ number(stats.repliesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.renotesCount }}</template>
< 			<template #value>{{ number(stats.renotesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.repliedCount }}</template>
< 			<template #value>{{ number(stats.repliedCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.renotedCount }}</template>
< 			<template #value>{{ number(stats.renotedCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.pollVotesCount }}</template>
< 			<template #value>{{ number(stats.pollVotesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.pollVotedCount }}</template>
< 			<template #value>{{ number(stats.pollVotedCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.sentReactionsCount }}</template>
< 			<template #value>{{ number(stats.sentReactionsCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.receivedReactionsCount }}</template>
< 			<template #value>{{ number(stats.receivedReactionsCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.noteFavoritesCount }}</template>
< 			<template #value>{{ number(stats.noteFavoritesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followingCount }}</template>
< 			<template #value>{{ number(stats.followingCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followingCount }} ({{ i18n.ts.local }})</template>
< 			<template #value>{{ number(stats.localFollowingCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followingCount }} ({{ i18n.ts.remote }})</template>
< 			<template #value>{{ number(stats.remoteFollowingCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followersCount }}</template>
< 			<template #value>{{ number(stats.followersCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followersCount }} ({{ i18n.ts.local }})</template>
< 			<template #value>{{ number(stats.localFollowersCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.followersCount }} ({{ i18n.ts.remote }})</template>
< 			<template #value>{{ number(stats.remoteFollowersCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.pageLikesCount }}</template>
< 			<template #value>{{ number(stats.pageLikesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.pageLikedCount }}</template>
< 			<template #value>{{ number(stats.pageLikedCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.driveFilesCount }}</template>
< 			<template #value>{{ number(stats.driveFilesCount) }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>{{ i18n.ts.driveUsage }}</template>
< 			<template #value>{{ bytes(stats.driveUsage) }}</template>
< 		</MkKeyValue>
< 	</FormSection>
---
>     <FormSection v-if="stats">
>       <template #label>{{ i18n.ts.statistics }}</template>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.notesCount }}</template>
>         <template #value>{{ number(stats.notesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.repliesCount }}</template>
>         <template #value>{{ number(stats.repliesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.renotesCount }}</template>
>         <template #value>{{ number(stats.renotesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.repliedCount }}</template>
>         <template #value>{{ number(stats.repliedCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.renotedCount }}</template>
>         <template #value>{{ number(stats.renotedCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.pollVotesCount }}</template>
>         <template #value>{{ number(stats.pollVotesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.pollVotedCount }}</template>
>         <template #value>{{ number(stats.pollVotedCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.sentReactionsCount }}</template>
>         <template #value>{{ number(stats.sentReactionsCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.receivedReactionsCount }}</template>
>         <template #value>{{ number(stats.receivedReactionsCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.noteFavoritesCount }}</template>
>         <template #value>{{ number(stats.noteFavoritesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.followingCount }}</template>
>         <template #value>{{ number(stats.followingCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key
>           >{{ i18n.ts.followingCount }} ({{ i18n.ts.local }})</template
>         >
>         <template #value>{{ number(stats.localFollowingCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key
>           >{{ i18n.ts.followingCount }} ({{ i18n.ts.remote }})</template
>         >
>         <template #value>{{ number(stats.remoteFollowingCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.followersCount }}</template>
>         <template #value>{{ number(stats.followersCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key
>           >{{ i18n.ts.followersCount }} ({{ i18n.ts.local }})</template
>         >
>         <template #value>{{ number(stats.localFollowersCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key
>           >{{ i18n.ts.followersCount }} ({{ i18n.ts.remote }})</template
>         >
>         <template #value>{{ number(stats.remoteFollowersCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.pageLikesCount }}</template>
>         <template #value>{{ number(stats.pageLikesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.pageLikedCount }}</template>
>         <template #value>{{ number(stats.pageLikedCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.driveFilesCount }}</template>
>         <template #value>{{ number(stats.driveFilesCount) }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>{{ i18n.ts.driveUsage }}</template>
>         <template #value>{{ bytes(stats.driveUsage) }}</template>
>       </MkKeyValue>
>     </FormSection>
99,126c111,148
< 	<FormSection>
< 		<template #label>{{ i18n.ts.other }}</template>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>emailVerified</template>
< 			<template #value>{{ $i.emailVerified ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>twoFactorEnabled</template>
< 			<template #value>{{ $i.twoFactorEnabled ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>securityKeys</template>
< 			<template #value>{{ $i.securityKeys ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>usePasswordLessLogin</template>
< 			<template #value>{{ $i.usePasswordLessLogin ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>isModerator</template>
< 			<template #value>{{ $i.isModerator ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 		<MkKeyValue oneline style="margin: 1em 0;">
< 			<template #key>isAdmin</template>
< 			<template #value>{{ $i.isAdmin ? i18n.ts.yes : i18n.ts.no }}</template>
< 		</MkKeyValue>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.other }}</template>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>emailVerified</template>
>         <template #value>{{
>           $i.emailVerified ? i18n.ts.yes : i18n.ts.no
>         }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>twoFactorEnabled</template>
>         <template #value>{{
>           $i.twoFactorEnabled ? i18n.ts.yes : i18n.ts.no
>         }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>securityKeys</template>
>         <template #value>{{
>           $i.securityKeys ? i18n.ts.yes : i18n.ts.no
>         }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>usePasswordLessLogin</template>
>         <template #value>{{
>           $i.usePasswordLessLogin ? i18n.ts.yes : i18n.ts.no
>         }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>isModerator</template>
>         <template #value>{{
>           $i.isModerator ? i18n.ts.yes : i18n.ts.no
>         }}</template>
>       </MkKeyValue>
>       <MkKeyValue oneline style="margin: 1em 0">
>         <template #key>isAdmin</template>
>         <template #value>{{ $i.isAdmin ? i18n.ts.yes : i18n.ts.no }}</template>
>       </MkKeyValue>
>     </FormSection>
>   </div>
130,138c152,160
< import { onMounted, ref } from 'vue';
< import FormSection from '@/components/form/section.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import bytes from '@/filters/bytes';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { onMounted, ref } from "vue";
> import FormSection from "@/components/form/section.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import bytes from "@/filters/bytes";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
143,147c165,169
< 	os.api('users/stats', {
< 		userId: $i!.id,
< 	}).then(response => {
< 		stats.value = response;
< 	});
---
>   os.api("users/stats", {
>     userId: $i!.id,
>   }).then((response) => {
>     stats.value = response;
>   });
155,156c177,178
< 	title: i18n.ts.accountInfo,
< 	icon: 'ti ti-info-circle',
---
>   title: i18n.ts.accountInfo,
>   icon: "fas fa-info-circle",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/accounts.vue RiricaV13/pages/settings/accounts.vue
2,5c2,6
< <div class="">
< 	<FormSuspense :p="init">
< 		<div class="_gaps">
< 			<MkButton primary @click="addAccount"><i class="ti ti-plus"></i> {{ i18n.ts.addAccount }}</MkButton>
---
>   <div class="_formRoot">
>     <FormSuspense :p="init">
>       <FormButton primary @click="addAccount"
>         ><i class="fas fa-plus"></i> {{ i18n.ts.addAccount }}</FormButton
>       >
7,22c8,27
< 			<div v-for="account in accounts" :key="account.id" class="_panel _button lcjjdxlm" @click="menu(account, $event)">
< 				<div class="avatar">
< 					<MkAvatar :user="account" class="avatar"/>
< 				</div>
< 				<div class="body">
< 					<div class="name">
< 						<MkUserName :user="account"/>
< 					</div>
< 					<div class="acct">
< 						<MkAcct :user="account"/>
< 					</div>
< 				</div>
< 			</div>
< 		</div>
< 	</FormSuspense>
< </div>
---
>       <div
>         v-for="account in accounts"
>         :key="account.id"
>         class="_panel _button lcjjdxlm"
>         @click="menu(account, $event)"
>       >
>         <div class="avatar">
>           <MkAvatar :user="account" class="avatar" />
>         </div>
>         <div class="body">
>           <div class="name">
>             <MkUserName :user="account" />
>           </div>
>           <div class="acct">
>             <MkAcct :user="account" :detail="true" />
>           </div>
>         </div>
>       </div>
>     </FormSuspense>
>   </div>
26,32c31,45
< import { defineAsyncComponent, ref } from 'vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { getAccounts, addAccount as addAccounts, removeAccount as _removeAccount, login, $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { defineAsyncComponent, ref } from "vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import {
>   getAccounts,
>   addAccount as addAccounts,
>   removeAccount as _removeAccount,
>   login,
>   $i,
> } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { apiGet } from "@/os";
> import  * as Misskey from "misskey-js"
35c48
< const accounts = ref<any>(null);
---
> const accounts = ref<any>([]);
38,39c51,63
< 	getAccounts().then(accounts => {
< 		storedAccounts.value = accounts.filter(x => x.id !== $i!.id);
---
>    await getAccounts()
>     .then(async ( ac) => {
>       return  ac.filter((x) => x.id !== $i!.id).forEach(async a => {
>         accounts.value.push(
>           {
>             ...await new Misskey.api.APIClient({ origin: a.instanceUrl, credential: a.token }).request("users/show", {
>               userId: a.id
>             }),
>             host: a.instanceUrl
>           }
>         )
>     })
>   });
41,49c65
< 		console.log(storedAccounts.value);
< 
< 		return os.api('users/show', {
< 			userIds: storedAccounts.value.map(x => x.id),
< 		});
< 	}).then(response => {
< 		accounts.value = response;
< 		console.log(accounts.value);
< 	});
---
>   return Promise.resolve()
53,62c69,84
< 	os.popupMenu([{
< 		text: i18n.ts.switch,
< 		icon: 'ti ti-switch-horizontal',
< 		action: () => switchAccount(account),
< 	}, {
< 		text: i18n.ts.remove,
< 		icon: 'ti ti-trash',
< 		danger: true,
< 		action: () => removeAccount(account),
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.switch,
>         icon: "fas fa-exchange-alt",
>         action: () => switchAccount(account),
>       },
>       {
>         text: i18n.ts.remove,
>         icon: "fas fa-trash-alt",
>         danger: true,
>         action: () => removeAccount(account),
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
66,72c88,98
< 	os.popupMenu([{
< 		text: i18n.ts.existingAccount,
< 		action: () => { addExistingAccount(); },
< 	}, {
< 		text: i18n.ts.createAccount,
< 		action: () => { createAccount(); },
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.existingAccount,
>         action: () => {
>           addExistingAccount();
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
76c102
< 	_removeAccount(account.id);
---
>   _removeAccount(account.id);
80,85c106,116
< 	os.popup(defineAsyncComponent(() => import('@/components/MkSigninDialog.vue')), {}, {
< 		done: res => {
< 			addAccounts(res.id, res.i);
< 			os.success();
< 		},
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkSigninDialog.vue")),
>     {},
>     {
>       done: (res) => {
>         addAccounts(res.id, res.i, res.instanceUrl);
>         os.success();
>       },
>     },
>     "closed"
>   );
88,96d118
< function createAccount() {
< 	os.popup(defineAsyncComponent(() => import('@/components/MkSignupDialog.vue')), {}, {
< 		done: res => {
< 			addAccounts(res.id, res.i);
< 			switchAccountWithToken(res.i);
< 		},
< 	}, 'closed');
< }
< 
98,100c120,122
< 	const fetchedAccounts: any[] = await getAccounts();
< 	const token = fetchedAccounts.find(x => x.id === account.id).token;
< 	switchAccountWithToken(token);
---
>   const fetchedAccounts: any[] = await getAccounts();
>   const { token, instanceUrl } = fetchedAccounts.find((x) => x.id === account.id);
>   switchAccountWithToken(token, instanceUrl);
103,104c125,126
< function switchAccountWithToken(token: string) {
< 	login(token);
---
> function switchAccountWithToken(token: string, instanceUrl: string) {
>   login(token, instanceUrl);
112,113c134,135
< 	title: i18n.ts.accounts,
< 	icon: 'ti ti-users',
---
>   title: i18n.ts.accounts,
>   icon: "fas fa-users",
119,120c141,142
< 	display: flex;
< 	padding: 16px;
---
>   display: flex;
>   padding: 16px;
122,125c144,147
< 	> .avatar {
< 		display: block;
< 		flex-shrink: 0;
< 		margin: 0 12px 0 0;
---
>   > .avatar {
>     display: block;
>     flex-shrink: 0;
>     margin: 0 12px 0 0;
127,131c149,153
< 		> .avatar {
< 			width: 50px;
< 			height: 50px;
< 		}
< 	}
---
>     > .avatar {
>       width: 50px;
>       height: 50px;
>     }
>   }
133,138c155,160
< 	> .body {
< 		display: flex;
< 		flex-direction: column;
< 		justify-content: center;
< 		width: calc(100% - 62px);
< 		position: relative;
---
>   > .body {
>     display: flex;
>     flex-direction: column;
>     justify-content: center;
>     width: calc(100% - 62px);
>     position: relative;
140,143c162,165
< 		> .name {
< 			font-weight: bold;
< 		}
< 	}
---
>     > .name {
>       font-weight: bold;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/api.vue RiricaV13/pages/settings/api.vue
2,6c2,15
< <div class="_gaps_m">
< 	<MkButton primary @click="generateToken">{{ i18n.ts.generateAccessToken }}</MkButton>
< 	<FormLink to="/settings/apps">{{ i18n.ts.manageAccessTokens }}</FormLink>
< 	<FormLink to="/api-console" :behavior="isDesktop ? 'window' : null">API console</FormLink>
< </div>
---
>   <div class="_formRoot">
>     <FormButton primary class="_formBlock" @click="generateToken">{{
>       i18n.ts.generateAccessToken
>     }}</FormButton>
>     <FormLink to="/settings/apps" class="_formBlock">{{
>       i18n.ts.manageAccessTokens
>     }}</FormLink>
>     <FormLink
>       to="/api-console"
>       :behavior="isDesktop ? 'window' : null"
>       class="_formBlock"
>       >API console</FormLink
>     >
>   </div>
10,15c19,24
< import { defineAsyncComponent, ref } from 'vue';
< import FormLink from '@/components/form/link.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { defineAsyncComponent, ref } from "vue";
> import FormLink from "@/components/form/link.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
20,27c29,41
< 	os.popup(defineAsyncComponent(() => import('@/components/MkTokenGenerateWindow.vue')), {}, {
< 		done: async result => {
< 			const { name, permissions } = result;
< 			const { token } = await os.api('miauth/gen-token', {
< 				session: null,
< 				name: name,
< 				permission: permissions,
< 			});
---
>   os.popup(
>     defineAsyncComponent(
>       () => import("@/components/MkTokenGenerateWindow.vue")
>     ),
>     {},
>     {
>       done: async (result) => {
>         const { name, permissions } = result;
>         const { token } = await os.api("miauth/gen-token", {
>           session: null,
>           name: name,
>           permission: permissions,
>         });
29,35c43,51
< 			os.alert({
< 				type: 'success',
< 				title: i18n.ts.token,
< 				text: token,
< 			});
< 		},
< 	}, 'closed');
---
>         os.alert({
>           type: "success",
>           title: i18n.ts.token,
>           text: token,
>         });
>       },
>     },
>     "closed"
>   );
43,44c59,60
< 	title: 'API',
< 	icon: 'ti ti-api',
---
>   title: "API",
>   icon: "fas fa-key",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/apps.vue RiricaV13/pages/settings/apps.vue
2,37c2,41
< <div class="_gaps_m">
< 	<FormPagination ref="list" :pagination="pagination">
< 		<template #empty>
< 			<div class="_fullinfo">
< 				<img src="https://xn--931a.moe/assets/info.jpg" class="_ghost"/>
< 				<div>{{ i18n.ts.nothing }}</div>
< 			</div>
< 		</template>
< 		<template #default="{items}">
< 			<div v-for="token in items" :key="token.id" class="_panel bfomjevm">
< 				<img v-if="token.iconUrl" class="icon" :src="token.iconUrl" alt=""/>
< 				<div class="body">
< 					<div class="name">{{ token.name }}</div>
< 					<div class="description">{{ token.description }}</div>
< 					<MkKeyValue oneline>
< 						<template #key>{{ i18n.ts.installedDate }}</template>
< 						<template #value><MkTime :time="token.createdAt"/></template>
< 					</MkKeyValue>
< 					<MkKeyValue oneline>
< 						<template #key>{{ i18n.ts.lastUsedDate }}</template>
< 						<template #value><MkTime :time="token.lastUsedAt"/></template>
< 					</MkKeyValue>
< 					<details>
< 						<summary>{{ i18n.ts.details }}</summary>
< 						<ul>
< 							<li v-for="p in token.permission" :key="p">{{ $t(`_permissions.${p}`) }}</li>
< 						</ul>
< 					</details>
< 					<div class="actions">
< 						<MkButton inline danger @click="revoke(token)"><i class="ti ti-trash"></i></MkButton>
< 					</div>
< 				</div>
< 			</div>
< 		</template>
< 	</FormPagination>
< </div>
---
>   <div class="_formRoot">
>     <FormPagination ref="list" :pagination="pagination">
>       <template #empty>
>         <div class="_fullinfo">
>           <img src="https://xn--931a.moe/assets/info.jpg" class="_ghost" />
>           <div>{{ i18n.ts.nothing }}</div>
>         </div>
>       </template>
>       <template #default="{ items }">
>         <div v-for="token in items" :key="token.id" class="_panel bfomjevm">
>           <img v-if="token.iconUrl" class="icon" :src="token.iconUrl" alt="" />
>           <div class="body">
>             <div class="name">{{ token.name }}</div>
>             <div class="description">{{ token.description }}</div>
>             <div class="_keyValue">
>               <div>{{ i18n.ts.installedDate }}:</div>
>               <div><MkTime :time="token.createdAt" /></div>
>             </div>
>             <div class="_keyValue">
>               <div>{{ i18n.ts.lastUsedDate }}:</div>
>               <div><MkTime :time="token.lastUsedAt" /></div>
>             </div>
>             <div class="actions">
>               <button class="_button" @click="revoke(token)">
>                 <i class="fas fa-trash-alt"></i>
>               </button>
>             </div>
>             <details>
>               <summary>{{ i18n.ts.details }}</summary>
>               <ul>
>                 <li v-for="p in token.permission" :key="p">
>                   {{ $t(`_permissions.${p}`) }}
>                 </li>
>               </ul>
>             </details>
>           </div>
>         </div>
>       </template>
>     </FormPagination>
>   </div>
41,47c45,49
< import { ref } from 'vue';
< import FormPagination from '@/components/MkPagination.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkButton from '@/components/MkButton.vue';
---
> import { ref } from "vue";
> import FormPagination from "@/components/MkPagination.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
52,56c54,58
< 	endpoint: 'i/apps' as const,
< 	limit: 100,
< 	params: {
< 		sort: '+lastUsedAt',
< 	},
---
>   endpoint: "i/apps" as const,
>   limit: 100,
>   params: {
>     sort: "+lastUsedAt",
>   },
60,62c62,64
< 	os.api('i/revoke-token', { tokenId: token.id }).then(() => {
< 		list.value.reload();
< 	});
---
>   os.api("i/revoke-token", { tokenId: token.id }).then(() => {
>     list.value.reload();
>   });
70,71c72,73
< 	title: i18n.ts.installedApps,
< 	icon: 'ti ti-plug',
---
>   title: i18n.ts.installedApps,
>   icon: "fas fa-plug",
77,78c79,80
< 	display: flex;
< 	padding: 16px;
---
>   display: flex;
>   padding: 16px;
80,87c82,89
< 	> .icon {
< 		display: block;
< 		flex-shrink: 0;
< 		margin: 0 12px 0 0;
< 		width: 50px;
< 		height: 50px;
< 		border-radius: 8px;
< 	}
---
>   > .icon {
>     display: block;
>     flex-shrink: 0;
>     margin: 0 12px 0 0;
>     width: 50px;
>     height: 50px;
>     border-radius: 8px;
>   }
89,91c91,93
< 	> .body {
< 		width: calc(100% - 62px);
< 		position: relative;
---
>   > .body {
>     width: calc(100% - 62px);
>     position: relative;
93,96c95,98
< 		> .name {
< 			font-weight: bold;
< 		}
< 	}
---
>     > .name {
>       font-weight: bold;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/custom-css.vue RiricaV13/pages/settings/custom-css.vue
2,3c2,3
< <div class="_gaps_m">
< 	<FormInfo warn>{{ i18n.ts.customCssWarn }}</FormInfo>
---
>   <div class="_formRoot">
>     <FormInfo warn class="_formBlock">{{ i18n.ts.customCssWarn }}</FormInfo>
5,8c5,14
< 	<MkTextarea v-model="localCustomCss" manual-save tall class="_monospace" style="tab-size: 2;">
< 		<template #label>CSS</template>
< 	</MkTextarea>
< </div>
---
>     <FormTextarea
>       v-model="localCustomCss"
>       manual-save
>       tall
>       class="_monospace _formBlock"
>       style="tab-size: 2"
>     >
>       <template #label>CSS</template>
>     </FormTextarea>
>   </div>
12,19c18,24
< import { ref, watch } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import * as os from '@/os';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { miLocalStorage } from '@/local-storage';
---
> import { ref, watch } from "vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import * as os from "@/os";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
21c26
< const localCustomCss = ref(miLocalStorage.getItem('customCss') ?? '');
---
> const localCustomCss = ref(localStorage.getItem("customCss") ?? "");
24c29
< 	miLocalStorage.setItem('customCss', localCustomCss.value);
---
>   localStorage.setItem("customCss", localCustomCss.value);
26,30c31,35
< 	const { canceled } = await os.confirm({
< 		type: 'info',
< 		text: i18n.ts.reloadToApplySetting,
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "info",
>     text: i18n.ts.reloadToApplySetting,
>   });
>   if (canceled) return;
32c37
< 	unisonReload();
---
>   unisonReload();
36c41
< 	await apply();
---
>   await apply();
44,45c49,50
< 	title: i18n.ts.customCss,
< 	icon: 'ti ti-code',
---
>   title: i18n.ts.customCss,
>   icon: "fas fa-code",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/deck.vue RiricaV13/pages/settings/deck.vue
2,3c2,6
< <div class="_gaps_m">
< 	<MkSwitch v-model="navWindow">{{ i18n.ts.defaultNavigationBehaviour }}: {{ i18n.ts.openInWindow }}</MkSwitch>
---
>   <div class="_formRoot">
>     <FormSwitch v-model="navWindow"
>       >{{ i18n.ts.defaultNavigationBehaviour }}:
>       {{ i18n.ts.openInWindow }}</FormSwitch
>     >
5c8,10
< 	<MkSwitch v-model="alwaysShowMainColumn">{{ i18n.ts._deck.alwaysShowMainColumn }}</MkSwitch>
---
>     <FormSwitch v-model="alwaysShowMainColumn" class="_formBlock">{{
>       i18n.ts._deck.alwaysShowMainColumn
>     }}</FormSwitch>
7,12c12,17
< 	<MkRadios v-model="columnAlign">
< 		<template #label>{{ i18n.ts._deck.columnAlign }}</template>
< 		<option value="left">{{ i18n.ts.left }}</option>
< 		<option value="center">{{ i18n.ts.center }}</option>
< 	</MkRadios>
< </div>
---
>     <FormRadios v-model="columnAlign" class="_formBlock">
>       <template #label>{{ i18n.ts._deck.columnAlign }}</template>
>       <option value="left">{{ i18n.ts.left }}</option>
>       <option value="center">{{ i18n.ts.center }}</option>
>     </FormRadios>
>   </div>
16,25c21,30
< import { computed, watch } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormLink from '@/components/form/link.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkInput from '@/components/MkInput.vue';
< import { deckStore } from '@/ui/deck/deck-store';
< import * as os from '@/os';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, watch } from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormLink from "@/components/form/link.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormInput from "@/components/form/input.vue";
> import { deckStore } from "@/ui/deck/deck-store";
> import * as os from "@/os";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
27,29c32,36
< const navWindow = computed(deckStore.makeGetterSetter('navWindow'));
< const alwaysShowMainColumn = computed(deckStore.makeGetterSetter('alwaysShowMainColumn'));
< const columnAlign = computed(deckStore.makeGetterSetter('columnAlign'));
---
> const navWindow = computed(deckStore.makeGetterSetter("navWindow"));
> const alwaysShowMainColumn = computed(
>   deckStore.makeGetterSetter("alwaysShowMainColumn")
> );
> const columnAlign = computed(deckStore.makeGetterSetter("columnAlign"));
36,37c43,44
< 	title: i18n.ts.deck,
< 	icon: 'ti ti-columns',
---
>   title: i18n.ts.deck,
>   icon: "fas fa-columns",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/delete-account.vue RiricaV13/pages/settings/delete-account.vue
2,7c2,19
< <div class="_gaps_m">
< 	<FormInfo warn>{{ i18n.ts._accountDelete.mayTakeTime }}</FormInfo>
< 	<FormInfo>{{ i18n.ts._accountDelete.sendEmail }}</FormInfo>
< 	<MkButton v-if="!$i.isDeleted" danger @click="deleteAccount">{{ i18n.ts._accountDelete.requestAccountDelete }}</MkButton>
< 	<MkButton v-else disabled>{{ i18n.ts._accountDelete.inProgress }}</MkButton>
< </div>
---
>   <div class="_formRoot">
>     <FormInfo warn class="_formBlock">{{
>       i18n.ts._accountDelete.mayTakeTime
>     }}</FormInfo>
>     <FormInfo class="_formBlock">{{
>       i18n.ts._accountDelete.sendEmail
>     }}</FormInfo>
>     <FormButton
>       v-if="!$i.isDeleted"
>       danger
>       class="_formBlock"
>       @click="deleteAccount"
>       >{{ i18n.ts._accountDelete.requestAccountDelete }}</FormButton
>     >
>     <FormButton v-else disabled>{{
>       i18n.ts._accountDelete.inProgress
>     }}</FormButton>
>   </div>
11,16c23,28
< import FormInfo from '@/components/MkInfo.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { signout } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import FormInfo from "@/components/MkInfo.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { signout } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
19,25c31,37
< 	{
< 		const { canceled } = await os.confirm({
< 			type: 'warning',
< 			text: i18n.ts.deleteAccountConfirm,
< 		});
< 		if (canceled) return;
< 	}
---
>   {
>     const { canceled } = await os.confirm({
>       type: "warning",
>       text: i18n.ts.deleteAccountConfirm,
>     });
>     if (canceled) return;
>   }
27,31c39,43
< 	const { canceled, result: password } = await os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: password } = await os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   });
>   if (canceled) return;
33,35c45,47
< 	await os.apiWithDialog('i/delete-account', {
< 		password: password,
< 	});
---
>   await os.apiWithDialog("i/delete-account", {
>     password: password,
>   });
37,39c49,51
< 	await os.alert({
< 		title: i18n.ts._accountDelete.started,
< 	});
---
>   await os.alert({
>     title: i18n.ts._accountDelete.started,
>   });
41c53
< 	await signout();
---
>   await signout();
49,50c61,62
< 	title: i18n.ts._accountDelete.accountDelete,
< 	icon: 'ti ti-alert-triangle',
---
>   title: i18n.ts._accountDelete.accountDelete,
>   icon: "fas fa-exclamation-triangle",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/drive.vue RiricaV13/pages/settings/drive.vue
2,4c2,18
< <div class="_gaps_m">
< 	<FormSection v-if="!fetching" first>
< 		<template #label>{{ i18n.ts.usageAmount }}</template>
---
>   <div class="_formRoot">
>     <FormSection v-if="!fetching">
>       <template #label>{{ i18n.ts.usageAmount }}</template>
>       <div class="_formBlock uawsfosz">
>         <div class="meter"><div :style="meterStyle"></div></div>
>       </div>
>       <FormSplit>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.capacity }}</template>
>           <template #value>{{ bytes(capacity, 1) }}</template>
>         </MkKeyValue>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.inUse }}</template>
>           <template #value>{{ bytes(usage, 1) }}</template>
>         </MkKeyValue>
>       </FormSplit>
>     </FormSection>
6,21c20,32
< 		<div class="_gaps_m">
< 			<div class="uawsfosz">
< 				<div class="meter"><div :style="meterStyle"></div></div>
< 			</div>
< 			<FormSplit>
< 				<MkKeyValue>
< 					<template #key>{{ i18n.ts.capacity }}</template>
< 					<template #value>{{ bytes(capacity, 1) }}</template>
< 				</MkKeyValue>
< 				<MkKeyValue>
< 					<template #key>{{ i18n.ts.inUse }}</template>
< 					<template #value>{{ bytes(usage, 1) }}</template>
< 				</MkKeyValue>
< 			</FormSplit>
< 		</div>
< 	</FormSection>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.statistics }}</template>
>       <MkChart
>         src="per-user-drive"
>         :args="{ user: $i }"
>         span="day"
>         :limit="7 * 5"
>         :bar="true"
>         :stacked="true"
>         :detailed="false"
>         :aspect-ratio="6"
>       />
>     </FormSection>
23,48c34,69
< 	<FormSection>
< 		<template #label>{{ i18n.ts.statistics }}</template>
< 		<MkChart src="per-user-drive" :args="{ user: $i }" span="day" :limit="7 * 5" :bar="true" :stacked="true" :detailed="false" :aspect-ratio="6"/>
< 	</FormSection>
< 
< 	<FormSection>
< 		<div class="_gaps_m">
< 			<FormLink @click="chooseUploadFolder()">
< 				{{ i18n.ts.uploadFolder }}
< 				<template #suffix>{{ uploadFolder ? uploadFolder.name : '-' }}</template>
< 				<template #suffixIcon><i class="fas fa-folder-open"></i></template>
< 			</FormLink>
< 			<MkSwitch v-model="keepOriginalUploading">
< 				<template #label>{{ i18n.ts.keepOriginalUploading }}</template>
< 				<template #caption>{{ i18n.ts.keepOriginalUploadingDescription }}</template>
< 			</MkSwitch>
< 			<MkSwitch v-model="alwaysMarkNsfw" @update:model-value="saveProfile()">
< 				<template #label>{{ i18n.ts.alwaysMarkSensitive }}</template>
< 			</MkSwitch>
< 			<MkSwitch v-model="autoSensitive" @update:model-value="saveProfile()">
< 				<template #label>{{ i18n.ts.enableAutoSensitive }}<span class="_beta">{{ i18n.ts.beta }}</span></template>
< 				<template #caption>{{ i18n.ts.enableAutoSensitiveDescription }}</template>
< 			</MkSwitch>
< 		</div>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <FormLink @click="chooseUploadFolder()">
>         {{ i18n.ts.uploadFolder }}
>         <template #suffix>{{
>           uploadFolder ? uploadFolder.name : "-"
>         }}</template>
>         <template #suffixIcon><i class="fas fa-folder-open"></i></template>
>       </FormLink>
>       <FormSwitch v-model="keepOriginalUploading" class="_formBlock">
>         <template #label>{{ i18n.ts.keepOriginalUploading }}</template>
>         <template #caption>{{
>           i18n.ts.keepOriginalUploadingDescription
>         }}</template>
>       </FormSwitch>
>       <FormSwitch
>         v-model="alwaysMarkNsfw"
>         class="_formBlock"
>         @update:modelValue="saveProfile()"
>       >
>         <template #label>{{ i18n.ts.alwaysMarkSensitive }}</template>
>       </FormSwitch>
>       <FormSwitch
>         v-model="autoSensitive"
>         class="_formBlock"
>         @update:modelValue="saveProfile()"
>       >
>         <template #label
>           >{{ i18n.ts.enableAutoSensitive
>           }}<span class="_beta">{{ i18n.ts.beta }}</span></template
>         >
>         <template #caption>{{
>           i18n.ts.enableAutoSensitiveDescription
>         }}</template>
>       </FormSwitch>
>     </FormSection>
>   </div>
52,65c73,86
< import { computed, ref } from 'vue';
< import tinycolor from 'tinycolor2';
< import FormLink from '@/components/form/link.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormSection from '@/components/form/section.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import FormSplit from '@/components/form/split.vue';
< import * as os from '@/os';
< import bytes from '@/filters/bytes';
< import { defaultStore } from '@/store';
< import MkChart from '@/components/MkChart.vue';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { $i } from '@/account';
---
> import { computed, ref } from "vue";
> import tinycolor from "tinycolor2";
> import FormLink from "@/components/form/link.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSection from "@/components/form/section.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import FormSplit from "@/components/form/split.vue";
> import * as os from "@/os";
> import bytes from "@/filters/bytes";
> import { defaultStore } from "@/store";
> import MkChart from "@/components/MkChart.vue";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { $i } from "@/account";
75,82c96,103
< 	return {
< 		width: `${usage.value / capacity.value * 100}%`,
< 		background: tinycolor({
< 			h: 180 - (usage.value / capacity.value * 180),
< 			s: 0.7,
< 			l: 0.5,
< 		}),
< 	};
---
>   return {
>     width: `${(usage.value / capacity.value) * 100}%`,
>     background: tinycolor({
>       h: 180 - (usage.value / capacity.value) * 180,
>       s: 0.7,
>       l: 0.5,
>     }),
>   };
85c106,108
< const keepOriginalUploading = computed(defaultStore.makeGetterSetter('keepOriginalUploading'));
---
> const keepOriginalUploading = computed(
>   defaultStore.makeGetterSetter("keepOriginalUploading")
> );
87,90c110,113
< os.api('drive').then(info => {
< 	capacity.value = info.capacity;
< 	usage.value = info.usage;
< 	fetching.value = false;
---
> os.api("drive").then((info) => {
>   capacity.value = info.capacity;
>   usage.value = info.usage;
>   fetching.value = false;
94,98c117,121
< 	os.api('drive/folders/show', {
< 		folderId: defaultStore.state.uploadFolder,
< 	}).then(response => {
< 		uploadFolder.value = response;
< 	});
---
>   os.api("drive/folders/show", {
>     folderId: defaultStore.state.uploadFolder,
>   }).then((response) => {
>     uploadFolder.value = response;
>   });
102,112c125,135
< 	os.selectDriveFolder(false).then(async folder => {
< 		defaultStore.set('uploadFolder', folder ? folder.id : null);
< 		os.success();
< 		if (defaultStore.state.uploadFolder) {
< 			uploadFolder.value = await os.api('drive/folders/show', {
< 				folderId: defaultStore.state.uploadFolder,
< 			});
< 		} else {
< 			uploadFolder.value = null;
< 		}
< 	});
---
>   os.selectDriveFolder(false).then(async (folder) => {
>     defaultStore.set("uploadFolder", folder ? folder.id : null);
>     os.success();
>     if (defaultStore.state.uploadFolder) {
>       uploadFolder.value = await os.api("drive/folders/show", {
>         folderId: defaultStore.state.uploadFolder,
>       });
>     } else {
>       uploadFolder.value = null;
>     }
>   });
116,119c139,142
< 	os.api('i/update', {
< 		alwaysMarkNsfw: !!alwaysMarkNsfw,
< 		autoSensitive: !!autoSensitive,
< 	});
---
>   os.api("i/update", {
>     alwaysMarkNsfw: !!alwaysMarkNsfw,
>     autoSensitive: !!autoSensitive,
>   });
127,128c150,151
< 	title: i18n.ts.drive,
< 	icon: 'ti ti-cloud',
---
>   title: i18n.ts.drive,
>   icon: "fas fa-cloud",
133d155
< 
136a159,163
>   > .meter {
>     $size: 12px;
>     background: rgba(0, 0, 0, 0.1);
>     border-radius: math.div($size, 2);
>     overflow: hidden;
138,148c165,169
< 	> .meter {
< 		$size: 12px;
< 		background: rgba(0, 0, 0, 0.1);
< 		border-radius: math.div($size, 2);
< 		overflow: hidden;
< 
< 		> div {
< 			height: $size;
< 			border-radius: math.div($size, 2);
< 		}
< 	}
---
>     > div {
>       height: $size;
>       border-radius: math.div($size, 2);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/email.vue RiricaV13/pages/settings/email.vue
2,10c2,17
< <div class="_gaps_m">
< 	<FormSection first>
< 		<template #label>{{ i18n.ts.emailAddress }}</template>
< 		<MkInput v-model="emailAddress" type="email" manual-save>
< 			<template #prefix><i class="ti ti-mail"></i></template>
< 			<template v-if="$i.email && !$i.emailVerified" #caption>{{ i18n.ts.verificationEmailSent }}</template>
< 			<template v-else-if="emailAddress === $i.email && $i.emailVerified" #caption><i class="ti ti-check" style="color: var(--success);"></i> {{ i18n.ts.emailVerified }}</template>
< 		</MkInput>
< 	</FormSection>
---
>   <div class="_formRoot">
>     <FormSection>
>       <template #label>{{ i18n.ts.emailAddress }}</template>
>       <FormInput v-model="emailAddress" type="email" manual-save>
>         <template #prefix><i class="fas fa-envelope"></i></template>
>         <template v-if="$i.email && !$i.emailVerified" #caption>{{
>           i18n.ts.verificationEmailSent
>         }}</template>
>         <template
>           v-else-if="emailAddress === $i.email && $i.emailVerified"
>           #caption
>           ><i class="fas fa-check" style="color: var(--success)"></i>
>           {{ i18n.ts.emailVerified }}</template
>         >
>       </FormInput>
>     </FormSection>
12,16c19,26
< 	<FormSection>
< 		<MkSwitch :model-value="$i.receiveAnnouncementEmail" @update:model-value="onChangeReceiveAnnouncementEmail">
< 			{{ i18n.ts.receiveAnnouncementFromInstance }}
< 		</MkSwitch>
< 	</FormSection>
---
>     <FormSection>
>       <FormSwitch
>         :model-value="$i.receiveAnnouncementEmail"
>         @update:modelValue="onChangeReceiveAnnouncementEmail"
>       >
>         {{ i18n.ts.receiveAnnouncementFromInstance }}
>       </FormSwitch>
>     </FormSection>
18,42c28,52
< 	<FormSection>
< 		<template #label>{{ i18n.ts.emailNotification }}</template>
< 
< 		<div class="_gaps_s">
< 			<MkSwitch v-model="emailNotification_mention">
< 				{{ i18n.ts._notification._types.mention }}
< 			</MkSwitch>
< 			<MkSwitch v-model="emailNotification_reply">
< 				{{ i18n.ts._notification._types.reply }}
< 			</MkSwitch>
< 			<MkSwitch v-model="emailNotification_quote">
< 				{{ i18n.ts._notification._types.quote }}
< 			</MkSwitch>
< 			<MkSwitch v-model="emailNotification_follow">
< 				{{ i18n.ts._notification._types.follow }}
< 			</MkSwitch>
< 			<MkSwitch v-model="emailNotification_receiveFollowRequest">
< 				{{ i18n.ts._notification._types.receiveFollowRequest }}
< 			</MkSwitch>
< 			<MkSwitch v-model="emailNotification_groupInvited">
< 				{{ i18n.ts._notification._types.groupInvited }}
< 			</MkSwitch>
< 		</div>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.emailNotification }}</template>
>       <FormSwitch v-model="emailNotification_mention" class="_formBlock">
>         {{ i18n.ts._notification._types.mention }}
>       </FormSwitch>
>       <FormSwitch v-model="emailNotification_reply" class="_formBlock">
>         {{ i18n.ts._notification._types.reply }}
>       </FormSwitch>
>       <FormSwitch v-model="emailNotification_quote" class="_formBlock">
>         {{ i18n.ts._notification._types.quote }}
>       </FormSwitch>
>       <FormSwitch v-model="emailNotification_follow" class="_formBlock">
>         {{ i18n.ts._notification._types.follow }}
>       </FormSwitch>
>       <FormSwitch
>         v-model="emailNotification_receiveFollowRequest"
>         class="_formBlock"
>       >
>         {{ i18n.ts._notification._types.receiveFollowRequest }}
>       </FormSwitch>
>       <FormSwitch v-model="emailNotification_groupInvited" class="_formBlock">
>         {{ i18n.ts._notification._types.groupInvited }}
>       </FormSwitch>
>     </FormSection>
>   </div>
46,53c56,63
< import { onMounted, ref, watch } from 'vue';
< import FormSection from '@/components/form/section.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { onMounted, ref, watch } from "vue";
> import FormSection from "@/components/form/section.vue";
> import FormInput from "@/components/form/input.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
58,60c68,70
< 	os.api('i/update', {
< 		receiveAnnouncementEmail: v,
< 	});
---
>   os.api("i/update", {
>     receiveAnnouncementEmail: v,
>   });
64,73c74,83
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		os.apiWithDialog('i/update-email', {
< 			password: password,
< 			email: emailAddress.value,
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     os.apiWithDialog("i/update-email", {
>       password: password,
>       email: emailAddress.value,
>     });
>   });
76,81c86,103
< const emailNotification_mention = ref($i!.emailNotificationTypes.includes('mention'));
< const emailNotification_reply = ref($i!.emailNotificationTypes.includes('reply'));
< const emailNotification_quote = ref($i!.emailNotificationTypes.includes('quote'));
< const emailNotification_follow = ref($i!.emailNotificationTypes.includes('follow'));
< const emailNotification_receiveFollowRequest = ref($i!.emailNotificationTypes.includes('receiveFollowRequest'));
< const emailNotification_groupInvited = ref($i!.emailNotificationTypes.includes('groupInvited'));
---
> const emailNotification_mention = ref(
>   $i!.emailNotificationTypes.includes("mention")
> );
> const emailNotification_reply = ref(
>   $i!.emailNotificationTypes.includes("reply")
> );
> const emailNotification_quote = ref(
>   $i!.emailNotificationTypes.includes("quote")
> );
> const emailNotification_follow = ref(
>   $i!.emailNotificationTypes.includes("follow")
> );
> const emailNotification_receiveFollowRequest = ref(
>   $i!.emailNotificationTypes.includes("receiveFollowRequest")
> );
> const emailNotification_groupInvited = ref(
>   $i!.emailNotificationTypes.includes("groupInvited")
> );
84,93c106,119
< 	os.api('i/update', {
< 		emailNotificationTypes: [
< 			...[emailNotification_mention.value ? 'mention' : null],
< 			...[emailNotification_reply.value ? 'reply' : null],
< 			...[emailNotification_quote.value ? 'quote' : null],
< 			...[emailNotification_follow.value ? 'follow' : null],
< 			...[emailNotification_receiveFollowRequest.value ? 'receiveFollowRequest' : null],
< 			...[emailNotification_groupInvited.value ? 'groupInvited' : null],
< 		].filter(x => x != null),
< 	});
---
>   os.api("i/update", {
>     emailNotificationTypes: [
>       ...[emailNotification_mention.value ? "mention" : null],
>       ...[emailNotification_reply.value ? "reply" : null],
>       ...[emailNotification_quote.value ? "quote" : null],
>       ...[emailNotification_follow.value ? "follow" : null],
>       ...[
>         emailNotification_receiveFollowRequest.value
>           ? "receiveFollowRequest"
>           : null,
>       ],
>       ...[emailNotification_groupInvited.value ? "groupInvited" : null],
>     ].filter((x) => x != null),
>   });
96,98c122,134
< watch([emailNotification_mention, emailNotification_reply, emailNotification_quote, emailNotification_follow, emailNotification_receiveFollowRequest, emailNotification_groupInvited], () => {
< 	saveNotificationSettings();
< });
---
> watch(
>   [
>     emailNotification_mention,
>     emailNotification_reply,
>     emailNotification_quote,
>     emailNotification_follow,
>     emailNotification_receiveFollowRequest,
>     emailNotification_groupInvited,
>   ],
>   () => {
>     saveNotificationSettings();
>   }
> );
101,103c137,139
< 	watch(emailAddress, () => {
< 		saveEmailAddress();
< 	});
---
>   watch(emailAddress, () => {
>     saveEmailAddress();
>   });
111,112c147,148
< 	title: i18n.ts.email,
< 	icon: 'ti ti-mail',
---
>   title: i18n.ts.email,
>   icon: "fas fa-envelope",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/general.vue RiricaV13/pages/settings/general.vue
2,13c2,13
< <div class="_gaps_m">
< 	<MkSelect v-model="lang">
< 		<template #label>{{ i18n.ts.uiLanguage }}</template>
< 		<option v-for="x in langs" :key="x[0]" :value="x[0]">{{ x[1] }}</option>
< 		<template #caption>
< 			<I18n :src="i18n.ts.i18nInfo" tag="span">
< 				<template #link>
< 					<MkLink url="https://crowdin.com/project/misskey">Crowdin</MkLink>
< 				</template>
< 			</I18n>
< 		</template>
< 	</MkSelect>
---
>   <div class="_formRoot">
>     <FormSelect v-model="lang" class="_formBlock">
>       <template #label>{{ i18n.ts.uiLanguage }}</template>
>       <option v-for="x in langs" :key="x[0]" :value="x[0]">{{ x[1] }}</option>
>       <template #caption>
>         <I18n :src="i18n.ts.i18nInfo" tag="span">
>           <template #link>
>             <MkLink url="https://crowdin.com/project/misskey">Crowdin</MkLink>
>           </template>
>         </I18n>
>       </template>
>     </FormSelect>
15,21c15,27
< 	<MkRadios v-model="overridedDeviceKind">
< 		<template #label>{{ i18n.ts.overridedDeviceKind }}</template>
< 		<option :value="null">{{ i18n.ts.auto }}</option>
< 		<option value="smartphone"><i class="ti ti-device-mobile"/> {{ i18n.ts.smartphone }}</option>
< 		<option value="tablet"><i class="ti ti-device-tablet"/> {{ i18n.ts.tablet }}</option>
< 		<option value="desktop"><i class="ti ti-device-desktop"/> {{ i18n.ts.desktop }}</option>
< 	</MkRadios>
---
>     <FormRadios v-model="overridedDeviceKind" class="_formBlock">
>       <template #label>{{ i18n.ts.overridedDeviceKind }}</template>
>       <option :value="null">{{ i18n.ts.auto }}</option>
>       <option value="smartphone">
>         <i class="fas fa-mobile-alt" /> {{ i18n.ts.smartphone }}
>       </option>
>       <option value="tablet">
>         <i class="fas fa-tablet-alt" /> {{ i18n.ts.tablet }}
>       </option>
>       <option value="desktop">
>         <i class="fas fa-desktop" /> {{ i18n.ts.desktop }}
>       </option>
>     </FormRadios>
23c29,31
< 	<MkSwitch v-model="showFixedPostForm">{{ i18n.ts.showFixedPostForm }}</MkSwitch>
---
>     <FormSwitch v-model="showFixedPostForm" class="_formBlock">{{
>       i18n.ts.showFixedPostForm
>     }}</FormSwitch>
25,26c33,48
< 	<FormSection>
< 		<template #label>{{ i18n.ts.behavior }}</template>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.behavior }}</template>
>       <FormSwitch v-model="imageNewTab" class="_formBlock">{{
>         i18n.ts.openImageInNewTab
>       }}</FormSwitch>
>       <FormSwitch v-model="enableInfiniteScroll" class="_formBlock">{{
>         i18n.ts.enableInfiniteScroll
>       }}</FormSwitch>
>       <FormSwitch
>         v-model="useReactionPickerForContextMenu"
>         class="_formBlock"
>         >{{ i18n.ts.useReactionPickerForContextMenu }}</FormSwitch
>       >
>       <FormSwitch v-model="disablePagesScript" class="_formBlock">{{
>         i18n.ts.disablePagesScript
>       }}</FormSwitch>
28,41c50,62
< 		<div class="_gaps_m">
< 			<div class="_gaps_s">
< 				<MkSwitch v-model="imageNewTab">{{ i18n.ts.openImageInNewTab }}</MkSwitch>
< 				<MkSwitch v-model="enableInfiniteScroll">{{ i18n.ts.enableInfiniteScroll }}</MkSwitch>
< 				<MkSwitch v-model="useReactionPickerForContextMenu">{{ i18n.ts.useReactionPickerForContextMenu }}</MkSwitch>
< 			</div>
< 			<MkSelect v-model="serverDisconnectedBehavior">
< 				<template #label>{{ i18n.ts.whenServerDisconnected }}</template>
< 				<option value="reload">{{ i18n.ts._serverDisconnectedBehavior.reload }}</option>
< 				<option value="dialog">{{ i18n.ts._serverDisconnectedBehavior.dialog }}</option>
< 				<option value="quiet">{{ i18n.ts._serverDisconnectedBehavior.quiet }}</option>
< 			</MkSelect>
< 		</div>
< 	</FormSection>
---
>       <FormSelect v-model="serverDisconnectedBehavior" class="_formBlock">
>         <template #label>{{ i18n.ts.whenServerDisconnected }}</template>
>         <option value="reload">
>           {{ i18n.ts._serverDisconnectedBehavior.reload }}
>         </option>
>         <option value="dialog">
>           {{ i18n.ts._serverDisconnectedBehavior.dialog }}
>         </option>
>         <option value="quiet">
>           {{ i18n.ts._serverDisconnectedBehavior.quiet }}
>         </option>
>       </FormSelect>
>     </FormSection>
43,44c64,99
< 	<FormSection>
< 		<template #label>{{ i18n.ts.appearance }}</template>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.appearance }}</template>
>       <FormSwitch v-model="disableAnimatedMfm" class="_formBlock">{{
>         i18n.ts.disableAnimatedMfm
>       }}</FormSwitch>
>       <FormSwitch v-model="reduceAnimation" class="_formBlock">{{
>         i18n.ts.reduceUiAnimation
>       }}</FormSwitch>
>       <FormSwitch v-model="useBlurEffect" class="_formBlock">{{
>         i18n.ts.useBlurEffect
>       }}</FormSwitch>
>       <FormSwitch v-model="useBlurEffectForModal" class="_formBlock">{{
>         i18n.ts.useBlurEffectForModal
>       }}</FormSwitch>
>       <FormSwitch v-model="showGapBetweenNotesInTimeline" class="_formBlock">{{
>         i18n.ts.showGapBetweenNotesInTimeline
>       }}</FormSwitch>
>       <FormSwitch v-model="loadRawImages" class="_formBlock">{{
>         i18n.ts.loadRawImages
>       }}</FormSwitch>
>       <FormSwitch v-model="disableShowingAnimatedImages" class="_formBlock">{{
>         i18n.ts.disableShowingAnimatedImages
>       }}</FormSwitch>
>       <FormSwitch v-model="squareAvatars" class="_formBlock">{{
>         i18n.ts.squareAvatars
>       }}</FormSwitch>
>       <FormSwitch v-model="useSystemFont" class="_formBlock">{{
>         i18n.ts.useSystemFont
>       }}</FormSwitch>
>       <FormSwitch v-model="useOsNativeEmojis" class="_formBlock">
>         {{ i18n.ts.useOsNativeEmojis }}
>         <div><Mfm :key="useOsNativeEmojis" text="🍮🍦🍭🍩🍰🍫🍬🥞🍪" /></div>
>       </FormSwitch>
>       <FormSwitch v-model="disableDrawer" class="_formBlock">{{
>         i18n.ts.disableDrawer
>       }}</FormSwitch>
46,67c101,108
< 		<div class="_gaps_m">
< 			<div class="_gaps_s">
< 				<MkSwitch v-model="disableAnimatedMfm">{{ i18n.ts.disableAnimatedMfm }}</MkSwitch>
< 				<MkSwitch v-model="reduceAnimation">{{ i18n.ts.reduceUiAnimation }}</MkSwitch>
< 				<MkSwitch v-model="useBlurEffect">{{ i18n.ts.useBlurEffect }}</MkSwitch>
< 				<MkSwitch v-model="useBlurEffectForModal">{{ i18n.ts.useBlurEffectForModal }}</MkSwitch>
< 				<MkSwitch v-model="showGapBetweenNotesInTimeline">{{ i18n.ts.showGapBetweenNotesInTimeline }}</MkSwitch>
< 				<MkSwitch v-model="loadRawImages">{{ i18n.ts.loadRawImages }}</MkSwitch>
< 				<MkSwitch v-model="disableShowingAnimatedImages">{{ i18n.ts.disableShowingAnimatedImages }}</MkSwitch>
< 				<MkSwitch v-model="squareAvatars">{{ i18n.ts.squareAvatars }}</MkSwitch>
< 				<MkSwitch v-model="useSystemFont">{{ i18n.ts.useSystemFont }}</MkSwitch>
< 				<MkSwitch v-model="disableDrawer">{{ i18n.ts.disableDrawer }}</MkSwitch>
< 			</div>
< 			<div>
< 				<MkRadios v-model="emojiStyle">
< 					<template #label>{{ i18n.ts.emojiStyle }}</template>
< 					<option value="native">{{ i18n.ts.native }}</option>
< 					<option value="fluentEmoji">Fluent Emoji</option>
< 					<option value="twemoji">Twemoji</option>
< 				</MkRadios>
< 				<div style="margin: 8px 0 0 0; font-size: 1.5em;"><Mfm :key="emojiStyle" text="🍮🍦🍭🍩🍰🍫🍬🥞🍪"/></div>
< 			</div>
---
>       <FormRadios v-model="fontSize" class="_formBlock">
>         <template #label>{{ i18n.ts.fontSize }}</template>
>         <option :value="null"><span style="font-size: 14px">Aa</span></option>
>         <option value="1"><span style="font-size: 15px">Aa</span></option>
>         <option value="2"><span style="font-size: 16px">Aa</span></option>
>         <option value="3"><span style="font-size: 17px">Aa</span></option>
>       </FormRadios>
>     </FormSection>
69,77c110,112
< 			<MkRadios v-model="fontSize">
< 				<template #label>{{ i18n.ts.fontSize }}</template>
< 				<option :value="null"><span style="font-size: 14px;">Aa</span></option>
< 				<option value="1"><span style="font-size: 15px;">Aa</span></option>
< 				<option value="2"><span style="font-size: 16px;">Aa</span></option>
< 				<option value="3"><span style="font-size: 17px;">Aa</span></option>
< 			</MkRadios>
< 		</div>
< 	</FormSection>
---
>     <FormSection>
>       <FormSwitch v-model="aiChanMode">{{ i18n.ts.aiChanMode }}</FormSwitch>
>     </FormSection>
79,81c114,119
< 	<FormSection>
< 		<MkSwitch v-model="aiChanMode">{{ i18n.ts.aiChanMode }}</MkSwitch>
< 	</FormSection>
---
>     <FormSelect v-model="instanceTicker" class="_formBlock">
>       <template #label>{{ i18n.ts.instanceTicker }}</template>
>       <option value="none">{{ i18n.ts._instanceTicker.none }}</option>
>       <option value="remote">{{ i18n.ts._instanceTicker.remote }}</option>
>       <option value="always">{{ i18n.ts._instanceTicker.always }}</option>
>     </FormSelect>
83,88c121,126
< 	<MkSelect v-model="instanceTicker">
< 		<template #label>{{ i18n.ts.instanceTicker }}</template>
< 		<option value="none">{{ i18n.ts._instanceTicker.none }}</option>
< 		<option value="remote">{{ i18n.ts._instanceTicker.remote }}</option>
< 		<option value="always">{{ i18n.ts._instanceTicker.always }}</option>
< 	</MkSelect>
---
>     <FormSelect v-model="nsfw" class="_formBlock">
>       <template #label>{{ i18n.ts.nsfw }}</template>
>       <option value="respect">{{ i18n.ts._nsfw.respect }}</option>
>       <option value="ignore">{{ i18n.ts._nsfw.ignore }}</option>
>       <option value="force">{{ i18n.ts._nsfw.force }}</option>
>     </FormSelect>
90,95c128,138
< 	<MkSelect v-model="nsfw">
< 		<template #label>{{ i18n.ts.nsfw }}</template>
< 		<option value="respect">{{ i18n.ts._nsfw.respect }}</option>
< 		<option value="ignore">{{ i18n.ts._nsfw.ignore }}</option>
< 		<option value="force">{{ i18n.ts._nsfw.force }}</option>
< 	</MkSelect>
---
>     <FormRange
>       v-model="numberOfPageCache"
>       :min="1"
>       :max="10"
>       :step="1"
>       easing
>       class="_formBlock"
>     >
>       <template #label>{{ i18n.ts.numberOfPageCache }}</template>
>       <template #caption>{{ i18n.ts.numberOfPageCacheDescription }}</template>
>     </FormRange>
97,100c140,142
< 	<MkRange v-model="numberOfPageCache" :min="1" :max="10" :step="1" easing>
< 		<template #label>{{ i18n.ts.numberOfPageCache }}</template>
< 		<template #caption>{{ i18n.ts.numberOfPageCacheDescription }}</template>
< 	</MkRange>
---
>     <FormLink to="/settings/deck" class="_formBlock">{{
>       i18n.ts.deck
>     }}</FormLink>
102,105c144,148
< 	<FormLink to="/settings/deck">{{ i18n.ts.deck }}</FormLink>
< 
< 	<FormLink to="/settings/custom-css"><template #icon><i class="ti ti-code"></i></template>{{ i18n.ts.customCss }}</FormLink>
< </div>
---
>     <FormLink to="/settings/custom-css" class="_formBlock"
>       ><template #icon><i class="fas fa-code"></i></template
>       >{{ i18n.ts.customCss }}</FormLink
>     >
>   </div>
109,123c152,165
< import { computed, ref, watch } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkRange from '@/components/MkRange.vue';
< import FormSection from '@/components/form/section.vue';
< import FormLink from '@/components/form/link.vue';
< import MkLink from '@/components/MkLink.vue';
< import { langs } from '@/config';
< import { defaultStore } from '@/store';
< import * as os from '@/os';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { miLocalStorage } from '@/local-storage';
---
> import { computed, ref, watch } from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSelect from "@/components/form/select.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormRange from "@/components/form/range.vue";
> import FormSection from "@/components/form/section.vue";
> import FormLink from "@/components/form/link.vue";
> import MkLink from "@/components/MkLink.vue";
> import { langs } from "@/config";
> import { defaultStore } from "@/store";
> import * as os from "@/os";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
125,127c167,169
< const lang = ref(miLocalStorage.getItem('lang'));
< const fontSize = ref(miLocalStorage.getItem('fontSize'));
< const useSystemFont = ref(miLocalStorage.getItem('useSystemFont') != null);
---
> const lang = ref(localStorage.getItem("lang"));
> const fontSize = ref(localStorage.getItem("fontSize"));
> const useSystemFont = ref(localStorage.getItem("useSystemFont") != null);
130,134c172,176
< 	const { canceled } = await os.confirm({
< 		type: 'info',
< 		text: i18n.ts.reloadToApplySetting,
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "info",
>     text: i18n.ts.reloadToApplySetting,
>   });
>   if (canceled) return;
136c178
< 	unisonReload();
---
>   unisonReload();
139,158c181,237
< const overridedDeviceKind = computed(defaultStore.makeGetterSetter('overridedDeviceKind'));
< const serverDisconnectedBehavior = computed(defaultStore.makeGetterSetter('serverDisconnectedBehavior'));
< const reduceAnimation = computed(defaultStore.makeGetterSetter('animation', v => !v, v => !v));
< const useBlurEffectForModal = computed(defaultStore.makeGetterSetter('useBlurEffectForModal'));
< const useBlurEffect = computed(defaultStore.makeGetterSetter('useBlurEffect'));
< const showGapBetweenNotesInTimeline = computed(defaultStore.makeGetterSetter('showGapBetweenNotesInTimeline'));
< const disableAnimatedMfm = computed(defaultStore.makeGetterSetter('animatedMfm', v => !v, v => !v));
< const emojiStyle = computed(defaultStore.makeGetterSetter('emojiStyle'));
< const disableDrawer = computed(defaultStore.makeGetterSetter('disableDrawer'));
< const disableShowingAnimatedImages = computed(defaultStore.makeGetterSetter('disableShowingAnimatedImages'));
< const loadRawImages = computed(defaultStore.makeGetterSetter('loadRawImages'));
< const imageNewTab = computed(defaultStore.makeGetterSetter('imageNewTab'));
< const nsfw = computed(defaultStore.makeGetterSetter('nsfw'));
< const showFixedPostForm = computed(defaultStore.makeGetterSetter('showFixedPostForm'));
< const numberOfPageCache = computed(defaultStore.makeGetterSetter('numberOfPageCache'));
< const instanceTicker = computed(defaultStore.makeGetterSetter('instanceTicker'));
< const enableInfiniteScroll = computed(defaultStore.makeGetterSetter('enableInfiniteScroll'));
< const useReactionPickerForContextMenu = computed(defaultStore.makeGetterSetter('useReactionPickerForContextMenu'));
< const squareAvatars = computed(defaultStore.makeGetterSetter('squareAvatars'));
< const aiChanMode = computed(defaultStore.makeGetterSetter('aiChanMode'));
---
> const overridedDeviceKind = computed(
>   defaultStore.makeGetterSetter("overridedDeviceKind")
> );
> const serverDisconnectedBehavior = computed(
>   defaultStore.makeGetterSetter("serverDisconnectedBehavior")
> );
> const reduceAnimation = computed(
>   defaultStore.makeGetterSetter(
>     "animation",
>     (v) => !v,
>     (v) => !v
>   )
> );
> const useBlurEffectForModal = computed(
>   defaultStore.makeGetterSetter("useBlurEffectForModal")
> );
> const useBlurEffect = computed(defaultStore.makeGetterSetter("useBlurEffect"));
> const showGapBetweenNotesInTimeline = computed(
>   defaultStore.makeGetterSetter("showGapBetweenNotesInTimeline")
> );
> const disableAnimatedMfm = computed(
>   defaultStore.makeGetterSetter(
>     "animatedMfm",
>     (v) => !v,
>     (v) => !v
>   )
> );
> const useOsNativeEmojis = computed(
>   defaultStore.makeGetterSetter("useOsNativeEmojis")
> );
> const disableDrawer = computed(defaultStore.makeGetterSetter("disableDrawer"));
> const disableShowingAnimatedImages = computed(
>   defaultStore.makeGetterSetter("disableShowingAnimatedImages")
> );
> const loadRawImages = computed(defaultStore.makeGetterSetter("loadRawImages"));
> const imageNewTab = computed(defaultStore.makeGetterSetter("imageNewTab"));
> const nsfw = computed(defaultStore.makeGetterSetter("nsfw"));
> const disablePagesScript = computed(
>   defaultStore.makeGetterSetter("disablePagesScript")
> );
> const showFixedPostForm = computed(
>   defaultStore.makeGetterSetter("showFixedPostForm")
> );
> const numberOfPageCache = computed(
>   defaultStore.makeGetterSetter("numberOfPageCache")
> );
> const instanceTicker = computed(
>   defaultStore.makeGetterSetter("instanceTicker")
> );
> const enableInfiniteScroll = computed(
>   defaultStore.makeGetterSetter("enableInfiniteScroll")
> );
> const useReactionPickerForContextMenu = computed(
>   defaultStore.makeGetterSetter("useReactionPickerForContextMenu")
> );
> const squareAvatars = computed(defaultStore.makeGetterSetter("squareAvatars"));
> const aiChanMode = computed(defaultStore.makeGetterSetter("aiChanMode"));
161,162c240,241
< 	miLocalStorage.setItem('lang', lang.value as string);
< 	miLocalStorage.removeItem('locale');
---
>   localStorage.setItem("lang", lang.value as string);
>   localStorage.removeItem("locale");
166,170c245,249
< 	if (fontSize.value == null) {
< 		miLocalStorage.removeItem('fontSize');
< 	} else {
< 		miLocalStorage.setItem('fontSize', fontSize.value);
< 	}
---
>   if (fontSize.value == null) {
>     localStorage.removeItem("fontSize");
>   } else {
>     localStorage.setItem("fontSize", fontSize.value);
>   }
174,178c253,257
< 	if (useSystemFont.value) {
< 		miLocalStorage.setItem('useSystemFont', 't');
< 	} else {
< 		miLocalStorage.removeItem('useSystemFont');
< 	}
---
>   if (useSystemFont.value) {
>     localStorage.setItem("useSystemFont", "t");
>   } else {
>     localStorage.removeItem("useSystemFont");
>   }
181,193c260,275
< watch([
< 	lang,
< 	fontSize,
< 	useSystemFont,
< 	enableInfiniteScroll,
< 	squareAvatars,
< 	aiChanMode,
< 	showGapBetweenNotesInTimeline,
< 	instanceTicker,
< 	overridedDeviceKind,
< ], async () => {
< 	await reloadAsk();
< });
---
> watch(
>   [
>     lang,
>     fontSize,
>     useSystemFont,
>     enableInfiniteScroll,
>     squareAvatars,
>     aiChanMode,
>     showGapBetweenNotesInTimeline,
>     instanceTicker,
>     overridedDeviceKind,
>   ],
>   async () => {
>     await reloadAsk();
>   }
> );
200,201c282,283
< 	title: i18n.ts.general,
< 	icon: 'ti ti-adjustments',
---
>   title: i18n.ts.general,
>   icon: "fas fa-cogs",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/import-export.vue RiricaV13/pages/settings/import-export.vue
2,87c2,115
< <div class="_gaps_m">
< 	<FormSection first>
< 		<template #label><i class="ti ti-pencil"></i> {{ i18n.ts._exportOrImport.allNotes }}</template>
< 		<MkFolder>
< 			<template #label>{{ i18n.ts.export }}</template>
< 			<template #icon><i class="ti ti-download"></i></template>
< 			<MkButton primary :class="$style.button" inline @click="exportNotes()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 		</MkFolder>
< 	</FormSection>
< 	<FormSection>
< 		<template #label><i class="ti ti-star"></i> {{ i18n.ts._exportOrImport.favoritedNotes }}</template>
< 		<MkFolder>
< 			<template #label>{{ i18n.ts.export }}</template>
< 			<template #icon><i class="ti ti-download"></i></template>
< 			<MkButton primary :class="$style.button" inline @click="exportFavorites()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 		</MkFolder>
< 	</FormSection>
< 	<FormSection>
< 		<template #label><i class="ti ti-users"></i> {{ i18n.ts._exportOrImport.followingList }}</template>
< 		<div class="_gaps_s">
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.export }}</template>
< 				<template #icon><i class="ti ti-download"></i></template>
< 				<div class="_gaps_s">
< 					<MkSwitch v-model="excludeMutingUsers">
< 						{{ i18n.ts._exportOrImport.excludeMutingUsers }}
< 					</MkSwitch>
< 					<MkSwitch v-model="excludeInactiveUsers">
< 						{{ i18n.ts._exportOrImport.excludeInactiveUsers }}
< 					</MkSwitch>
< 					<MkButton primary :class="$style.button" inline @click="exportFollowing()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 				</div>
< 			</MkFolder>
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.import }}</template>
< 				<template #icon><i class="ti ti-upload"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="importFollowing($event)"><i class="ti ti-upload"></i> {{ i18n.ts.import }}</MkButton>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
< 	<FormSection>
< 		<template #label><i class="ti ti-users"></i> {{ i18n.ts._exportOrImport.userLists }}</template>
< 		<div class="_gaps_s">
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.export }}</template>
< 				<template #icon><i class="ti ti-download"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="exportUserLists()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 			</MkFolder>
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.import }}</template>
< 				<template #icon><i class="ti ti-upload"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="importUserLists($event)"><i class="ti ti-upload"></i> {{ i18n.ts.import }}</MkButton>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
< 	<FormSection>
< 		<template #label><i class="ti ti-user-off"></i> {{ i18n.ts._exportOrImport.muteList }}</template>
< 		<div class="_gaps_s">
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.export }}</template>
< 				<template #icon><i class="ti ti-download"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="exportMuting()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 			</MkFolder>
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.import }}</template>
< 				<template #icon><i class="ti ti-upload"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="importMuting($event)"><i class="ti ti-upload"></i> {{ i18n.ts.import }}</MkButton>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
< 	<FormSection>
< 		<template #label><i class="ti ti-user-off"></i> {{ i18n.ts._exportOrImport.blockingList }}</template>
< 		<div class="_gaps_s">
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.export }}</template>
< 				<template #icon><i class="ti ti-download"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="exportBlocking()"><i class="ti ti-download"></i> {{ i18n.ts.export }}</MkButton>
< 			</MkFolder>
< 			<MkFolder>
< 				<template #label>{{ i18n.ts.import }}</template>
< 				<template #icon><i class="ti ti-upload"></i></template>
< 				<MkButton primary :class="$style.button" inline @click="importBlocking($event)"><i class="ti ti-upload"></i> {{ i18n.ts.import }}</MkButton>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
< </div>
---
>   <div class="_formRoot">
>     <FormSection>
>       <template #label>{{ i18n.ts._exportOrImport.allNotes }}</template>
>       <FormFolder>
>         <template #label>{{ i18n.ts.export }}</template>
>         <template #icon><i class="fas fa-download"></i></template>
>         <MkButton primary :class="$style.button" inline @click="exportNotes()"
>           ><i class="fas fa-download"></i> {{ i18n.ts.export }}</MkButton
>         >
>       </FormFolder>
>     </FormSection>
>     <FormSection>
>       <template #label>{{ i18n.ts._exportOrImport.followingList }}</template>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.export }}</template>
>         <template #icon><i class="fas fa-download"></i></template>
>         <FormSwitch v-model="excludeMutingUsers" class="_formBlock">
>           {{ i18n.ts._exportOrImport.excludeMutingUsers }}
>         </FormSwitch>
>         <FormSwitch v-model="excludeInactiveUsers" class="_formBlock">
>           {{ i18n.ts._exportOrImport.excludeInactiveUsers }}
>         </FormSwitch>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="exportFollowing()"
>           ><i class="fas fa-download"></i> {{ i18n.ts.export }}</MkButton
>         >
>       </FormFolder>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.import }}</template>
>         <template #icon><i class="fas fa-upload"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="importFollowing($event)"
>           ><i class="fas fa-upload"></i> {{ i18n.ts.import }}</MkButton
>         >
>       </FormFolder>
>     </FormSection>
>     <FormSection>
>       <template #label>{{ i18n.ts._exportOrImport.userLists }}</template>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.export }}</template>
>         <template #icon><i class="fas fa-download"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="exportUserLists()"
>           ><i class="fas fa-download"></i> {{ i18n.ts.export }}</MkButton
>         >
>       </FormFolder>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.import }}</template>
>         <template #icon><i class="fas fa-upload"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="importUserLists($event)"
>           ><i class="fas fa-upload"></i> {{ i18n.ts.import }}</MkButton
>         >
>       </FormFolder>
>     </FormSection>
>     <FormSection>
>       <template #label>{{ i18n.ts._exportOrImport.muteList }}</template>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.export }}</template>
>         <template #icon><i class="fas fa-download"></i></template>
>         <MkButton primary :class="$style.button" inline @click="exportMuting()"
>           ><i class="fas fa-download"></i> {{ i18n.ts.export }}</MkButton
>         >
>       </FormFolder>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.import }}</template>
>         <template #icon><i class="fas fa-upload"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="importMuting($event)"
>           ><i class="fas fa-upload"></i> {{ i18n.ts.import }}</MkButton
>         >
>       </FormFolder>
>     </FormSection>
>     <FormSection>
>       <template #label>{{ i18n.ts._exportOrImport.blockingList }}</template>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.export }}</template>
>         <template #icon><i class="fas fa-download"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="exportBlocking()"
>           ><i class="fas fa-download"></i> {{ i18n.ts.export }}</MkButton
>         >
>       </FormFolder>
>       <FormFolder class="_formBlock">
>         <template #label>{{ i18n.ts.import }}</template>
>         <template #icon><i class="fas fa-upload"></i></template>
>         <MkButton
>           primary
>           :class="$style.button"
>           inline
>           @click="importBlocking($event)"
>           ><i class="fas fa-upload"></i> {{ i18n.ts.import }}</MkButton
>         >
>       </FormFolder>
>     </FormSection>
>   </div>
91,99c119,127
< import { ref } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import FormSection from '@/components/form/section.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { selectFile } from '@/scripts/select-file';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import FormSection from "@/components/form/section.vue";
> import FormFolder from "@/components/form/folder.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { selectFile } from "@/scripts/select-file";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
105,108c133,136
< 	os.alert({
< 		type: 'info',
< 		text: i18n.ts.exportRequested,
< 	});
---
>   os.alert({
>     type: "info",
>     text: i18n.ts.exportRequested,
>   });
112,115c140,143
< 	os.alert({
< 		type: 'info',
< 		text: i18n.ts.importRequested,
< 	});
---
>   os.alert({
>     type: "info",
>     text: i18n.ts.importRequested,
>   });
119,122c147,150
< 	os.alert({
< 		type: 'error',
< 		text: ev.message,
< 	});
---
>   os.alert({
>     type: "error",
>     text: ev.message,
>   });
126c154
< 	os.api('i/export-notes', {}).then(onExportSuccess).catch(onError);
---
>   os.api("i/export-notes", {}).then(onExportSuccess).catch(onError);
129,132d156
< const exportFavorites = () => {
< 	os.api('i/export-favorites', {}).then(onExportSuccess).catch(onError);
< };
< 
134,138c158,163
< 	os.api('i/export-following', {
< 		excludeMuting: excludeMutingUsers.value,
< 		excludeInactive: excludeInactiveUsers.value,
< 	})
< 		.then(onExportSuccess).catch(onError);
---
>   os.api("i/export-following", {
>     excludeMuting: excludeMutingUsers.value,
>     excludeInactive: excludeInactiveUsers.value,
>   })
>     .then(onExportSuccess)
>     .catch(onError);
142c167
< 	os.api('i/export-blocking', {}).then(onExportSuccess).catch(onError);
---
>   os.api("i/export-blocking", {}).then(onExportSuccess).catch(onError);
146c171
< 	os.api('i/export-user-lists', {}).then(onExportSuccess).catch(onError);
---
>   os.api("i/export-user-lists", {}).then(onExportSuccess).catch(onError);
150c175
< 	os.api('i/export-mute', {}).then(onExportSuccess).catch(onError);
---
>   os.api("i/export-mute", {}).then(onExportSuccess).catch(onError);
154,155c179,182
< 	const file = await selectFile(ev.currentTarget ?? ev.target);
< 	os.api('i/import-following', { fileId: file.id }).then(onImportSuccess).catch(onError);
---
>   const file = await selectFile(ev.currentTarget ?? ev.target);
>   os.api("i/import-following", { fileId: file.id })
>     .then(onImportSuccess)
>     .catch(onError);
159,160c186,189
< 	const file = await selectFile(ev.currentTarget ?? ev.target);
< 	os.api('i/import-user-lists', { fileId: file.id }).then(onImportSuccess).catch(onError);
---
>   const file = await selectFile(ev.currentTarget ?? ev.target);
>   os.api("i/import-user-lists", { fileId: file.id })
>     .then(onImportSuccess)
>     .catch(onError);
164,165c193,196
< 	const file = await selectFile(ev.currentTarget ?? ev.target);
< 	os.api('i/import-muting', { fileId: file.id }).then(onImportSuccess).catch(onError);
---
>   const file = await selectFile(ev.currentTarget ?? ev.target);
>   os.api("i/import-muting", { fileId: file.id })
>     .then(onImportSuccess)
>     .catch(onError);
169,170c200,203
< 	const file = await selectFile(ev.currentTarget ?? ev.target);
< 	os.api('i/import-blocking', { fileId: file.id }).then(onImportSuccess).catch(onError);
---
>   const file = await selectFile(ev.currentTarget ?? ev.target);
>   os.api("i/import-blocking", { fileId: file.id })
>     .then(onImportSuccess)
>     .catch(onError);
178,179c211,212
< 	title: i18n.ts.importAndExport,
< 	icon: 'ti ti-package',
---
>   title: i18n.ts.importAndExport,
>   icon: "fas fa-boxes",
185c218
< 	margin-right: 16px;
---
>   margin-right: 16px;
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/index.vue RiricaV13/pages/settings/index.vue
3c3,5
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
---
> 	<template #header>
> 		<MkPageHeader :actions="headerActions" :tabs="headerTabs"/>
> 	</template>
9,10c11,14
< 						<MkInfo v-if="emailNotConfigured" warn class="info">{{ i18n.ts.emailNotConfiguredWarning }} <MkA to="/settings/email" class="_link">{{ i18n.ts.configure }}</MkA></MkInfo>
< 						<MkSuperMenu :def="menuDef" :grid="currentPage?.route.name == null"></MkSuperMenu>
---
> 						<MkSuperMenu
> 							:def="menuDef"
> 							:grid="currentPage?.route.name == null"
> 						></MkSuperMenu>
14c18
< 					<div class="bkzroven" style="container-type: inline-size;">
---
> 					<div class="bkzroven">
21c25
< </mkstickycontainer>
---
> </MkStickyContainer>
25,36c29,54
< import { computed, defineAsyncComponent, inject, nextTick, onActivated, onMounted, onUnmounted, provide, ref, shallowRef, watch } from 'vue';
< import { i18n } from '@/i18n';
< import MkInfo from '@/components/MkInfo.vue';
< import MkSuperMenu from '@/components/MkSuperMenu.vue';
< import { scroll } from '@/scripts/scroll';
< import { signout, $i } from '@/account';
< import { unisonReload } from '@/scripts/unison-reload';
< import { instance } from '@/instance';
< import { useRouter } from '@/router';
< import { definePageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import * as os from '@/os';
< import { miLocalStorage } from '@/local-storage';
---
> import {
>   computed,
>   defineAsyncComponent,
>   inject,
>   nextTick,
>   onActivated,
>   onMounted,
>   onUnmounted,
>   provide,
>   ref,
>   watch,
> } from "vue";
> import { i18n } from "@/i18n";
> import MkInfo from "@/components/MkInfo.vue";
> import MkSuperMenu from "@/components/MkSuperMenu.vue";
> import { scroll } from "@/scripts/scroll";
> import { signout, $i } from "@/account";
> import { unisonReload } from "@/scripts/unison-reload";
> import { instance } from "@/instance";
> import { useRouter } from "@/router";
> import {
>   definePageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
> import * as os from "@/os";
39,41c57,59
< 	title: i18n.ts.settings,
< 	icon: 'ti ti-settings',
< 	hideHeader: true,
---
>   title: i18n.ts.settings,
>   icon: "fas fa-cog",
>   hideHeader: true,
44c62
< const el = shallowRef<HTMLElement | null>(null);
---
> const el = ref<HTMLElement | null>(null);
55,56c73,74
< 	if (entries.length === 0) return;
< 	narrow = entries[0].borderBoxSize[0].inlineSize < NARROW_THRESHOLD;
---
>   if (entries.length === 0) return;
>   narrow = entries[0].borderBoxSize[0].inlineSize < NARROW_THRESHOLD;
59,204c77,211
< const menuDef = computed(() => [{
< 	title: i18n.ts.basicSettings,
< 	items: [{
< 		icon: 'ti ti-user',
< 		text: i18n.ts.profile,
< 		to: '/settings/profile',
< 		active: currentPage?.route.name === 'profile',
< 	}, {
< 		icon: 'ti ti-lock-open',
< 		text: i18n.ts.privacy,
< 		to: '/settings/privacy',
< 		active: currentPage?.route.name === 'privacy',
< 	}, {
< 		icon: 'ti ti-mood-happy',
< 		text: i18n.ts.reaction,
< 		to: '/settings/reaction',
< 		active: currentPage?.route.name === 'reaction',
< 	}, {
< 		icon: 'ti ti-cloud',
< 		text: i18n.ts.drive,
< 		to: '/settings/drive',
< 		active: currentPage?.route.name === 'drive',
< 	}, {
< 		icon: 'ti ti-bell',
< 		text: i18n.ts.notifications,
< 		to: '/settings/notifications',
< 		active: currentPage?.route.name === 'notifications',
< 	}, {
< 		icon: 'ti ti-mail',
< 		text: i18n.ts.email,
< 		to: '/settings/email',
< 		active: currentPage?.route.name === 'email',
< 	}, {
< 		icon: 'ti ti-share',
< 		text: i18n.ts.integration,
< 		to: '/settings/integration',
< 		active: currentPage?.route.name === 'integration',
< 	}, {
< 		icon: 'ti ti-lock',
< 		text: i18n.ts.security,
< 		to: '/settings/security',
< 		active: currentPage?.route.name === 'security',
< 	}],
< }, {
< 	title: i18n.ts.clientSettings,
< 	items: [{
< 		icon: 'ti ti-adjustments',
< 		text: i18n.ts.general,
< 		to: '/settings/general',
< 		active: currentPage?.route.name === 'general',
< 	}, {
< 		icon: 'ti ti-palette',
< 		text: i18n.ts.theme,
< 		to: '/settings/theme',
< 		active: currentPage?.route.name === 'theme',
< 	}, {
< 		icon: 'ti ti-menu-2',
< 		text: i18n.ts.navbar,
< 		to: '/settings/navbar',
< 		active: currentPage?.route.name === 'navbar',
< 	}, {
< 		icon: 'ti ti-equal-double',
< 		text: i18n.ts.statusbar,
< 		to: '/settings/statusbar',
< 		active: currentPage?.route.name === 'statusbar',
< 	}, {
< 		icon: 'ti ti-music',
< 		text: i18n.ts.sounds,
< 		to: '/settings/sounds',
< 		active: currentPage?.route.name === 'sounds',
< 	}, {
< 		icon: 'ti ti-plug',
< 		text: i18n.ts.plugins,
< 		to: '/settings/plugin',
< 		active: currentPage?.route.name === 'plugin',
< 	}],
< }, {
< 	title: i18n.ts.otherSettings,
< 	items: [{
< 		icon: 'ti ti-package',
< 		text: i18n.ts.importAndExport,
< 		to: '/settings/import-export',
< 		active: currentPage?.route.name === 'import-export',
< 	}, {
< 		icon: 'ti ti-planet-off',
< 		text: i18n.ts.instanceMute,
< 		to: '/settings/instance-mute',
< 		active: currentPage?.route.name === 'instance-mute',
< 	}, {
< 		icon: 'ti ti-ban',
< 		text: i18n.ts.muteAndBlock,
< 		to: '/settings/mute-block',
< 		active: currentPage?.route.name === 'mute-block',
< 	}, {
< 		icon: 'ti ti-message-off',
< 		text: i18n.ts.wordMute,
< 		to: '/settings/word-mute',
< 		active: currentPage?.route.name === 'word-mute',
< 	}, {
< 		icon: 'ti ti-api',
< 		text: 'API',
< 		to: '/settings/api',
< 		active: currentPage?.route.name === 'api',
< 	}, {
< 		icon: 'ti ti-webhook',
< 		text: 'Webhook',
< 		to: '/settings/webhook',
< 		active: currentPage?.route.name === 'webhook',
< 	}, {
< 		icon: 'ti ti-dots',
< 		text: i18n.ts.other,
< 		to: '/settings/other',
< 		active: currentPage?.route.name === 'other',
< 	}],
< }, {
< 	items: [{
< 		icon: 'ti ti-device-floppy',
< 		text: i18n.ts.preferencesBackups,
< 		to: '/settings/preferences-backups',
< 		active: currentPage?.route.name === 'preferences-backups',
< 	}, {
< 		type: 'button',
< 		icon: 'ti ti-trash',
< 		text: i18n.ts.clearCache,
< 		action: () => {
< 			miLocalStorage.removeItem('locale');
< 			miLocalStorage.removeItem('theme');
< 			miLocalStorage.removeItem('emojis');
< 			miLocalStorage.removeItem('lastEmojisFetchedAt');
< 			unisonReload();
< 		},
< 	}, {
< 		type: 'button',
< 		icon: 'ti ti-power',
< 		text: i18n.ts.logout,
< 		action: async () => {
< 			const { canceled } = await os.confirm({
< 				type: 'warning',
< 				text: i18n.ts.logoutConfirm,
< 			});
< 			if (canceled) return;
< 			signout();
< 		},
< 		danger: true,
< 	}],
< }]);
---
> const menuDef = computed(() => [
>   {
>     title: i18n.ts.basicSettings,
>     items: [
>       {
>         icon: "fas fa-user",
>         text: i18n.ts.profile,
>         to: "/settings/profile",
>         active: currentPage?.route.name === "profile",
>       },
>       {
>         icon: "fas fa-lock-open",
>         text: i18n.ts.privacy,
>         to: "/settings/privacy",
>         active: currentPage?.route.name === "privacy",
>       },
>       {
>         icon: "fas fa-laugh",
>         text: i18n.ts.reaction,
>         to: "/settings/reaction",
>         active: currentPage?.route.name === "reaction",
>       },
>       {
>         icon: "fas fa-cloud",
>         text: i18n.ts.drive,
>         to: "/settings/drive",
>         active: currentPage?.route.name === "drive",
>       },
>       {
>         icon: "fas fa-bell",
>         text: i18n.ts.notifications,
>         to: "/settings/notifications",
>         active: currentPage?.route.name === "notifications",
>       },
>     ],
>   },
>   {
>     title: i18n.ts.clientSettings,
>     items: [
>       {
>         icon: "fas fa-cogs",
>         text: i18n.ts.general,
>         to: "/settings/general",
>         active: currentPage?.route.name === "general",
>       },
>       {
>         icon: "fas fa-palette",
>         text: i18n.ts.theme,
>         to: "/settings/theme",
>         active: currentPage?.route.name === "theme",
>       },
>       {
>         icon: "fas fa-bars",
>         text: i18n.ts.navbar,
>         to: "/settings/navbar",
>         active: currentPage?.route.name === "navbar",
>       },
>       {
>         icon: "fas fa-bars-progress",
>         text: i18n.ts.statusbar,
>         to: "/settings/statusbar",
>         active: currentPage?.route.name === "statusbar",
>       },
>       {
>         icon: "fas fa-music",
>         text: i18n.ts.sounds,
>         to: "/settings/sounds",
>         active: currentPage?.route.name === "sounds",
>       },
>       {
>         icon: "fas fa-plug",
>         text: i18n.ts.plugins,
>         to: "/settings/plugin",
>         active: currentPage?.route.name === "plugin",
>       },
>     ],
>   },
>   {
>     title: i18n.ts.otherSettings,
>     items: [
>       {
>         icon: "fas fa-boxes",
>         text: i18n.ts.importAndExport,
>         to: "/settings/import-export",
>         active: currentPage?.route.name === "import-export",
>       },
>       {
>         icon: "fas fa-volume-mute",
>         text: i18n.ts.instanceMute,
>         to: "/settings/instance-mute",
>         active: currentPage?.route.name === "instance-mute",
>       },
>       {
>         icon: "fas fa-ban",
>         text: i18n.ts.muteAndBlock,
>         to: "/settings/mute-block",
>         active: currentPage?.route.name === "mute-block",
>       },
>       {
>         icon: "fas fa-comment-slash",
>         text: i18n.ts.wordMute,
>         to: "/settings/word-mute",
>         active: currentPage?.route.name === "word-mute",
>       },
>     ],
>   },
>   {
>     items: [
>       {
>         type: "button",
>         icon: "fas fa-trash",
>         text: i18n.ts.clearCache,
>         action: () => {
>           localStorage.removeItem("locale");
>           localStorage.removeItem("theme");
>           unisonReload();
>         },
>       },
>       {
>         type: "button",
>         icon: "fas fa-sign-in-alt fa-flip-horizontal",
>         text: i18n.ts.logout,
>         action: async () => {
>           const { canceled } = await os.confirm({
>             type: "warning",
>             text: i18n.ts.logoutConfirm,
>           });
>           if (canceled) return;
>           signout();
>         },
>         danger: true,
>       },
>     ],
>   },
> ]);
206,207c213
< watch($$(narrow), () => {
< });
---
> watch($$(narrow), () => {});
210c216
< 	ro.observe(el.value);
---
>   ro.observe(el.value);
212c218
< 	narrow = el.value.offsetWidth < NARROW_THRESHOLD;
---
>   narrow = el.value.offsetWidth < NARROW_THRESHOLD;
214,216c220,222
< 	if (!narrow && currentPage?.route.name == null) {
< 		router.replace('/settings/profile');
< 	}
---
>   if (!narrow && currentPage?.route.name == null) {
>     router.replace("/settings/profile");
>   }
220c226
< 	narrow = el.value.offsetWidth < NARROW_THRESHOLD;
---
>   narrow = el.value.offsetWidth < NARROW_THRESHOLD;
222,224c228,230
< 	if (!narrow && currentPage?.route.name == null) {
< 		router.replace('/settings/profile');
< 	}
---
>   if (!narrow && currentPage?.route.name == null) {
>     router.replace("/settings/profile");
>   }
228c234
< 	ro.disconnect();
---
>   ro.disconnect();
231c237,239
< const emailNotConfigured = computed(() => instance.enableEmail && ($i.email == null || !$i.emailVerified));
---
> const emailNotConfigured = computed(
>   () => instance.enableEmail && ($i.email == null || !$i.emailVerified)
> );
234,238c242,246
< 	if (info == null) {
< 		childInfo.value = null;
< 	} else {
< 		childInfo.value = info;
< 	}
---
>   if (info == null) {
>     childInfo.value = null;
>   } else {
>     childInfo.value = info;
>   }
252,257c260,265
< 	> .body {
< 		> .nav {
< 			.baaadecd {
< 				> .info {
< 					margin: 16px 0;
< 				}
---
>   > .body {
>     > .nav {
>       .baaadecd {
>         > .info {
>           margin: 16px 0;
>         }
259,268c267,276
< 				> .accounts {
< 					> .avatar {
< 						display: block;
< 						width: 50px;
< 						height: 50px;
< 						margin: 8px auto 16px auto;
< 					}
< 				}
< 			}
< 		}
---
>         > .accounts {
>           > .avatar {
>             display: block;
>             width: 50px;
>             height: 50px;
>             margin: 8px auto 16px auto;
>           }
>         }
>       }
>     }
270,274c278,282
< 		> .main {
< 			.bkzroven {
< 			}
< 		}
< 	}
---
>     > .main {
>       .bkzroven {
>       }
>     }
>   }
276,279c284,287
< 	&.wide {
< 		> .body {
< 			display: flex;
< 			height: 100%;
---
>   &.wide {
>     > .body {
>       display: flex;
>       height: 100%;
281,285c289,293
< 			> .nav {
< 				width: 34%;
< 				padding-right: 32px;
< 				box-sizing: border-box;
< 			}
---
>       > .nav {
>         width: 34%;
>         padding-right: 32px;
>         box-sizing: border-box;
>       }
287,292c295,300
< 			> .main {
< 				flex: 1;
< 				min-width: 0;
< 			}
< 		}
< 	}
---
>       > .main {
>         flex: 1;
>         min-width: 0;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/instance-mute.vue RiricaV13/pages/settings/instance-mute.vue
2,9c2,15
< <div class="_gaps_m">
< 	<MkInfo>{{ i18n.ts._instanceMute.title }}</MkInfo>
< 	<MkTextarea v-model="instanceMutes">
< 		<template #label>{{ i18n.ts._instanceMute.heading }}</template>
< 		<template #caption>{{ i18n.ts._instanceMute.instanceMuteDescription }}<br>{{ i18n.ts._instanceMute.instanceMuteDescription2 }}</template>
< 	</MkTextarea>
< 	<MkButton primary :disabled="!changed" @click="save()"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< </div>
---
>   <div class="_formRoot">
>     <MkInfo>{{ i18n.ts._instanceMute.title }}</MkInfo>
>     <FormTextarea v-model="instanceMutes" class="_formBlock">
>       <template #label>{{ i18n.ts._instanceMute.heading }}</template>
>       <template #caption
>         >{{ i18n.ts._instanceMute.instanceMuteDescription }}<br />{{
>           i18n.ts._instanceMute.instanceMuteDescription2
>         }}</template
>       >
>     </FormTextarea>
>     <MkButton primary :disabled="!changed" class="_formBlock" @click="save()"
>       ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>     >
>   </div>
13,20c19,26
< import { ref, watch } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref, watch } from "vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import MkButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
22c28
< const instanceMutes = ref($i!.mutedInstances.join('\n'));
---
> const instanceMutes = ref($i!.mutedInstances.join("\n"));
26,29c32,36
< 	let mutes = instanceMutes.value
< 		.trim().split('\n')
< 		.map(el => el.trim())
< 		.filter(el => el);
---
>   let mutes = instanceMutes.value
>     .trim()
>     .split("\n")
>     .map((el) => el.trim())
>     .filter((el) => el);
31,33c38,40
< 	await os.api('i/update', {
< 		mutedInstances: mutes,
< 	});
---
>   await os.api("i/update", {
>     mutedInstances: mutes,
>   });
35c42
< 	changed.value = false;
---
>   changed.value = false;
37,38c44,45
< 	// Refresh filtered list to signal to the user how they've been saved
< 	instanceMutes.value = mutes.join('\n');
---
>   // Refresh filtered list to signal to the user how they've been saved
>   instanceMutes.value = mutes.join("\n");
42c49
< 	changed.value = true;
---
>   changed.value = true;
50,51c57,58
< 	title: i18n.ts.instanceMute,
< 	icon: 'ti ti-planet-off',
---
>   title: i18n.ts.instanceMute,
>   icon: "fas fa-volume-mute",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/integration.vue RiricaV13/pages/settings/integration.vue
2,8c2,20
< <div class="_gaps_m">
< 	<FormSection v-if="instance.enableTwitterIntegration">
< 		<template #label><i class="ti ti-brand-twitter"></i> Twitter</template>
< 		<p v-if="integrations.twitter">{{ i18n.ts.connectedTo }}: <a :href="`https://twitter.com/${integrations.twitter.screenName}`" rel="nofollow noopener" target="_blank">@{{ integrations.twitter.screenName }}</a></p>
< 		<MkButton v-if="integrations.twitter" danger @click="disconnectTwitter">{{ i18n.ts.disconnectService }}</MkButton>
< 		<MkButton v-else primary @click="connectTwitter">{{ i18n.ts.connectService }}</MkButton>
< 	</FormSection>
---
>   <div class="_formRoot">
>     <FormSection v-if="instance.enableTwitterIntegration">
>       <template #label><i class="fab fa-twitter"></i> Twitter</template>
>       <p v-if="integrations.twitter">
>         {{ i18n.ts.connectedTo }}:
>         <a
>           :href="`https://twitter.com/${integrations.twitter.screenName}`"
>           rel="nofollow noopener"
>           target="_blank"
>           >@{{ integrations.twitter.screenName }}</a
>         >
>       </p>
>       <MkButton v-if="integrations.twitter" danger @click="disconnectTwitter">{{
>         i18n.ts.disconnectService
>       }}</MkButton>
>       <MkButton v-else primary @click="connectTwitter">{{
>         i18n.ts.connectService
>       }}</MkButton>
>     </FormSection>
10,15c22,41
< 	<FormSection v-if="instance.enableDiscordIntegration">
< 		<template #label><i class="ti ti-brand-discord"></i> Discord</template>
< 		<p v-if="integrations.discord">{{ i18n.ts.connectedTo }}: <a :href="`https://discord.com/users/${integrations.discord.id}`" rel="nofollow noopener" target="_blank">@{{ integrations.discord.username }}#{{ integrations.discord.discriminator }}</a></p>
< 		<MkButton v-if="integrations.discord" danger @click="disconnectDiscord">{{ i18n.ts.disconnectService }}</MkButton>
< 		<MkButton v-else primary @click="connectDiscord">{{ i18n.ts.connectService }}</MkButton>
< 	</FormSection>
---
>     <FormSection v-if="instance.enableDiscordIntegration">
>       <template #label><i class="fab fa-discord"></i> Discord</template>
>       <p v-if="integrations.discord">
>         {{ i18n.ts.connectedTo }}:
>         <a
>           :href="`https://discord.com/users/${integrations.discord.id}`"
>           rel="nofollow noopener"
>           target="_blank"
>           >@{{ integrations.discord.username }}#{{
>             integrations.discord.discriminator
>           }}</a
>         >
>       </p>
>       <MkButton v-if="integrations.discord" danger @click="disconnectDiscord">{{
>         i18n.ts.disconnectService
>       }}</MkButton>
>       <MkButton v-else primary @click="connectDiscord">{{
>         i18n.ts.connectService
>       }}</MkButton>
>     </FormSection>
17,23c43,61
< 	<FormSection v-if="instance.enableGithubIntegration">
< 		<template #label><i class="ti ti-brand-github"></i> GitHub</template>
< 		<p v-if="integrations.github">{{ i18n.ts.connectedTo }}: <a :href="`https://github.com/${integrations.github.login}`" rel="nofollow noopener" target="_blank">@{{ integrations.github.login }}</a></p>
< 		<MkButton v-if="integrations.github" danger @click="disconnectGithub">{{ i18n.ts.disconnectService }}</MkButton>
< 		<MkButton v-else primary @click="connectGithub">{{ i18n.ts.connectService }}</MkButton>
< 	</FormSection>
< </div>
---
>     <FormSection v-if="instance.enableGithubIntegration">
>       <template #label><i class="fab fa-github"></i> GitHub</template>
>       <p v-if="integrations.github">
>         {{ i18n.ts.connectedTo }}:
>         <a
>           :href="`https://github.com/${integrations.github.login}`"
>           rel="nofollow noopener"
>           target="_blank"
>           >@{{ integrations.github.login }}</a
>         >
>       </p>
>       <MkButton v-if="integrations.github" danger @click="disconnectGithub">{{
>         i18n.ts.disconnectService
>       }}</MkButton>
>       <MkButton v-else primary @click="connectGithub">{{
>         i18n.ts.connectService
>       }}</MkButton>
>     </FormSection>
>   </div>
27,34c65,72
< import { computed, onMounted, ref, watch } from 'vue';
< import { apiUrl } from '@/config';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import { $i } from '@/account';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, onMounted, ref, watch } from "vue";
> import { apiUrl } from "@/config";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import { $i } from "@/account";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
43,46c81,85
< 	return window.open(`${apiUrl}/${type}/${service}`,
< 		`${service}_${type}_window`,
< 		'height=570, width=520',
< 	);
---
>   return window.open(
>     `${apiUrl}/${type}/${service}`,
>     `${service}_${type}_window`,
>     "height=570, width=520"
>   );
50c89
< 	twitterForm.value = openWindow('twitter', 'connect');
---
>   twitterForm.value = openWindow("twitter", "connect");
54c93
< 	openWindow('twitter', 'disconnect');
---
>   openWindow("twitter", "disconnect");
58c97
< 	discordForm.value = openWindow('discord', 'connect');
---
>   discordForm.value = openWindow("discord", "connect");
62c101
< 	openWindow('discord', 'disconnect');
---
>   openWindow("discord", "disconnect");
66c105
< 	githubForm.value = openWindow('github', 'connect');
---
>   githubForm.value = openWindow("github", "connect");
70c109
< 	openWindow('github', 'disconnect');
---
>   openWindow("github", "disconnect");
74,76c113,116
< 	document.cookie = `igi=${$i!.token}; path=/;` +
< 		' max-age=31536000;' +
< 		(document.location.protocol.startsWith('https') ? ' secure' : '');
---
>   document.cookie =
>     `igi=${$i!.token}; path=/;` +
>     " max-age=31536000;" +
>     (document.location.protocol.startsWith("https") ? " secure" : "");
78,88c118,128
< 	watch(integrations, () => {
< 		if (integrations.value.twitter) {
< 			if (twitterForm.value) twitterForm.value.close();
< 		}
< 		if (integrations.value.discord) {
< 			if (discordForm.value) discordForm.value.close();
< 		}
< 		if (integrations.value.github) {
< 			if (githubForm.value) githubForm.value.close();
< 		}
< 	});
---
>   watch(integrations, () => {
>     if (integrations.value.twitter) {
>       if (twitterForm.value) twitterForm.value.close();
>     }
>     if (integrations.value.discord) {
>       if (discordForm.value) discordForm.value.close();
>     }
>     if (integrations.value.github) {
>       if (githubForm.value) githubForm.value.close();
>     }
>   });
96,97c136,137
< 	title: i18n.ts.integration,
< 	icon: 'ti ti-share',
---
>   title: i18n.ts.integration,
>   icon: "fas fa-share-alt",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/mute-block.vue RiricaV13/pages/settings/mute-block.vue
2,27c2,39
< <div class="_gaps_m">
< 	<MkTab v-model="tab" style="margin-bottom: var(--margin);">
< 		<option value="mute">{{ i18n.ts.mutedUsers }}</option>
< 		<option value="block">{{ i18n.ts.blockedUsers }}</option>
< 	</MkTab>
< 	<div v-if="tab === 'mute'">
< 		<MkPagination :pagination="mutingPagination" class="muting">
< 			<template #empty><FormInfo>{{ i18n.ts.noUsers }}</FormInfo></template>
< 			<template #default="{items}">
< 				<FormLink v-for="mute in items" :key="mute.id" :to="userPage(mute.mutee)">
< 					<MkAcct :user="mute.mutee"/>
< 				</FormLink>
< 			</template>
< 		</MkPagination>
< 	</div>
< 	<div v-if="tab === 'block'">
< 		<MkPagination :pagination="blockingPagination" class="blocking">
< 			<template #empty><FormInfo>{{ i18n.ts.noUsers }}</FormInfo></template>
< 			<template #default="{items}">
< 				<FormLink v-for="block in items" :key="block.id" :to="userPage(block.blockee)">
< 					<MkAcct :user="block.blockee"/>
< 				</FormLink>
< 			</template>
< 		</MkPagination>
< 	</div>
< </div>
---
>   <div class="_formRoot">
>     <MkTab v-model="tab" style="margin-bottom: var(--margin)">
>       <option value="mute">{{ i18n.ts.mutedUsers }}</option>
>       <option value="block">{{ i18n.ts.blockedUsers }}</option>
>     </MkTab>
>     <div v-if="tab === 'mute'">
>       <MkPagination :pagination="mutingPagination" class="muting">
>         <template #empty
>           ><FormInfo>{{ i18n.ts.noUsers }}</FormInfo></template
>         >
>         <template #default="{ items }">
>           <FormLink
>             v-for="mute in items"
>             :key="mute.id"
>             :to="userPage(mute.mutee)"
>           >
>             <MkAcct :user="mute.mutee" />
>           </FormLink>
>         </template>
>       </MkPagination>
>     </div>
>     <div v-if="tab === 'block'">
>       <MkPagination :pagination="blockingPagination" class="blocking">
>         <template #empty
>           ><FormInfo>{{ i18n.ts.noUsers }}</FormInfo></template
>         >
>         <template #default="{ items }">
>           <FormLink
>             v-for="block in items"
>             :key="block.id"
>             :to="userPage(block.blockee)"
>           >
>             <MkAcct :user="block.blockee" />
>           </FormLink>
>         </template>
>       </MkPagination>
>     </div>
>   </div>
31,39c43,51
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import MkTab from '@/components/MkTab.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import FormLink from '@/components/form/link.vue';
< import { userPage } from '@/filters/user';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import MkTab from "@/components/MkTab.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import FormLink from "@/components/form/link.vue";
> import { userPage } from "@/filters/user";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
41c53
< let tab = $ref('mute');
---
> let tab = $ref("mute");
44,45c56,57
< 	endpoint: 'mute/list' as const,
< 	limit: 10,
---
>   endpoint: "mute/list" as const,
>   limit: 10,
49,50c61,62
< 	endpoint: 'blocking/list' as const,
< 	limit: 10,
---
>   endpoint: "blocking/list" as const,
>   limit: 10,
58,59c70,71
< 	title: i18n.ts.muteAndBlock,
< 	icon: 'ti ti-ban',
---
>   title: i18n.ts.muteAndBlock,
>   icon: "fas fa-ban",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/navbar.vue RiricaV13/pages/settings/navbar.vue
2,6c2,10
< <div class="_gaps_m">
< 	<MkTextarea v-model="items" tall manual-save>
< 		<template #label>{{ i18n.ts.navbar }}</template>
< 		<template #caption><button class="_textButton" @click="addItem">{{ i18n.ts.addItem }}</button></template>
< 	</MkTextarea>
---
>   <div class="_formRoot">
>     <FormTextarea v-model="items" tall manual-save class="_formBlock">
>       <template #label>{{ i18n.ts.navbar }}</template>
>       <template #caption
>         ><button class="_textButton" @click="addItem">
>           {{ i18n.ts.addItem }}
>         </button></template
>       >
>     </FormTextarea>
8,14c12,19
< 	<MkRadios v-model="menuDisplay">
< 		<template #label>{{ i18n.ts.display }}</template>
< 		<option value="sideFull">{{ i18n.ts._menuDisplay.sideFull }}</option>
< 		<option value="sideIcon">{{ i18n.ts._menuDisplay.sideIcon }}</option>
< 		<option value="top">{{ i18n.ts._menuDisplay.top }}</option>
< 		<!-- <MkRadio v-model="menuDisplay" value="hide" disabled>{{ i18n.ts._menuDisplay.hide }}</MkRadio>--> <!-- TODO: サイドバーを完全に隠せるようにすると、別途ハンバーガーボタンのようなものをUIに表示する必要があり面倒 -->
< 	</MkRadios>
---
>     <FormRadios v-model="menuDisplay" class="_formBlock">
>       <template #label>{{ i18n.ts.display }}</template>
>       <option value="sideFull">{{ i18n.ts._menuDisplay.sideFull }}</option>
>       <option value="sideIcon">{{ i18n.ts._menuDisplay.sideIcon }}</option>
>       <option value="top">{{ i18n.ts._menuDisplay.top }}</option>
>       <!-- <MkRadio v-model="menuDisplay" value="hide" disabled>{{ i18n.ts._menuDisplay.hide }}</MkRadio>-->
>       <!-- TODO: サイドバーを完全に隠せるようにすると、別途ハンバーガーボタンのようなものをUIに表示する必要があり面倒 -->
>     </FormRadios>
16,17c21,24
< 	<MkButton danger @click="reset()"><i class="ti ti-reload"></i> {{ i18n.ts.default }}</MkButton>
< </div>
---
>     <FormButton danger class="_formBlock" @click="reset()"
>       ><i class="fas fa-redo"></i> {{ i18n.ts.default }}</FormButton
>     >
>   </div>
21,30c28,37
< import { computed, ref, watch } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { defaultStore } from '@/store';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, ref, watch } from "vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { defaultStore } from "@/store";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
32c39
< const items = ref(defaultStore.state.menu.join('\n'));
---
> const items = ref(defaultStore.state.menu.join("\n"));
34,35c41,47
< const split = computed(() => items.value.trim().split('\n').filter(x => x.trim() !== ''));
< const menuDisplay = computed(defaultStore.makeGetterSetter('menuDisplay'));
---
> const split = computed(() =>
>   items.value
>     .trim()
>     .split("\n")
>     .filter((x) => x.trim() !== "")
> );
> const menuDisplay = computed(defaultStore.makeGetterSetter("menuDisplay"));
38,42c50,54
< 	const { canceled } = await os.confirm({
< 		type: 'info',
< 		text: i18n.ts.reloadToApplySetting,
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "info",
>     text: i18n.ts.reloadToApplySetting,
>   });
>   if (canceled) return;
44c56
< 	unisonReload();
---
>   unisonReload();
48,58c60,77
< 	const menu = Object.keys(navbarItemDef).filter(k => !defaultStore.state.menu.includes(k));
< 	const { canceled, result: item } = await os.select({
< 		title: i18n.ts.addItem,
< 		items: [...menu.map(k => ({
< 			value: k, text: navbarItemDef[k].title,
< 		})), {
< 			value: '-', text: i18n.ts.divider,
< 		}],
< 	});
< 	if (canceled) return;
< 	items.value = [...split.value, item].join('\n');
---
>   const menu = Object.keys(navbarItemDef).filter(
>     (k) => !defaultStore.state.menu.includes(k)
>   );
>   const { canceled, result: item } = await os.select({
>     title: i18n.ts.addItem,
>     items: [
>       ...menu.map((k) => ({
>         value: k,
>         text: i18n.ts[navbarItemDef[k].title],
>       })),
>       {
>         value: "-",
>         text: i18n.ts.divider,
>       },
>     ],
>   });
>   if (canceled) return;
>   items.value = [...split.value, item].join("\n");
62,63c81,82
< 	defaultStore.set('menu', split.value);
< 	await reloadAsk();
---
>   defaultStore.set("menu", split.value);
>   await reloadAsk();
67,68c86,87
< 	defaultStore.reset('menu');
< 	items.value = defaultStore.state.menu.join('\n');
---
>   defaultStore.reset("menu");
>   items.value = defaultStore.state.menu.join("\n");
72c91
< 	await save();
---
>   await save();
76c95
< 	await reloadAsk();
---
>   await reloadAsk();
84,85c103,104
< 	title: i18n.ts.navbar,
< 	icon: 'ti ti-list',
---
>   title: i18n.ts.navbar,
>   icon: "fas fa-list-ul",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/notifications.vue RiricaV13/pages/settings/notifications.vue
2,26c2,18
< <div class="_gaps_m">
< 	<FormLink @click="configure"><template #icon><i class="ti ti-settings"></i></template>{{ i18n.ts.notificationSetting }}</FormLink>
< 	<FormSection>
< 		<div class="_gaps_m">
< 			<FormLink @click="readAllNotifications">{{ i18n.ts.markAsReadAllNotifications }}</FormLink>
< 			<FormLink @click="readAllUnreadNotes">{{ i18n.ts.markAsReadAllUnreadNotes }}</FormLink>
< 			<FormLink @click="readAllMessagingMessages">{{ i18n.ts.markAsReadAllTalkMessages }}</FormLink>
< 		</div>
< 	</FormSection>
< 	<FormSection>
< 		<template #label>{{ i18n.ts.pushNotification }}</template>
< 
< 		<div class="_gaps_m">
< 			<MkPushNotificationAllowButton ref="allowButton"/>
< 			<MkSwitch :disabled="!pushRegistrationInServer" :model-value="sendReadMessage" @update:model-value="onChangeSendReadMessage">
< 				<template #label>{{ i18n.ts.sendPushNotificationReadMessage }}</template>
< 				<template #caption>
< 					<I18n :src="i18n.ts.sendPushNotificationReadMessageCaption">
< 						<template #emptyPushNotificationMessage>{{ i18n.ts._notification.emptyPushNotificationMessage }}</template>
< 					</I18n>
< 				</template>
< 			</MkSwitch>
< 		</div>
< 	</FormSection>
< </div>
---
>   <div class="_formRoot">
>     <FormLink class="_formBlock" @click="configure"
>       ><template #icon><i class="fas fa-cog"></i></template
>       >{{ i18n.ts.notificationSetting }}</FormLink
>     >
>     <FormSection>
>       <FormLink class="_formBlock" @click="readAllNotifications">{{
>         i18n.ts.markAsReadAllNotifications
>       }}</FormLink>
>       <FormLink class="_formBlock" @click="readAllUnreadNotes">{{
>         i18n.ts.markAsReadAllUnreadNotes
>       }}</FormLink>
>       <FormLink class="_formBlock" @click="readAllMessagingMessages">{{
>         i18n.ts.markAsReadAllTalkMessages
>       }}</FormLink>
>     </FormSection>
>   </div>
30,40c22,30
< import { defineAsyncComponent } from 'vue';
< import { notificationTypes } from 'misskey-js';
< import MkButton from '@/components/MkButton.vue';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import MkPushNotificationAllowButton from '@/components/MkPushNotificationAllowButton.vue';
---
> import { defineAsyncComponent } from "vue";
> import { notificationTypes } from "misskey-js";
> import FormButton from "@/components/MkButton.vue";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
42,45d31
< let allowButton = $shallowRef<InstanceType<typeof MkPushNotificationAllowButton>>();
< let pushRegistrationInServer = $computed(() => allowButton?.pushRegistrationInServer);
< let sendReadMessage = $computed(() => pushRegistrationInServer?.sendReadMessage || false);
< 
47c33
< 	await os.api('i/read-all-unread-notes');
---
>   await os.api("i/read-all-unread-notes");
51c37
< 	await os.api('i/read-all-messaging-messages');
---
>   await os.api("i/read-all-messaging-messages");
55c41
< 	await os.api('notifications/mark-all-as-read');
---
>   await os.api("notifications/mark-all-as-read");
59,72c45,71
< 	const includingTypes = notificationTypes.filter(x => !$i!.mutingNotificationTypes.includes(x));
< 	os.popup(defineAsyncComponent(() => import('@/components/MkNotificationSettingWindow.vue')), {
< 		includingTypes,
< 		showGlobalToggle: false,
< 	}, {
< 		done: async (res) => {
< 			const { includingTypes: value } = res;
< 			await os.apiWithDialog('i/update', {
< 				mutingNotificationTypes: notificationTypes.filter(x => !value.includes(x)),
< 			}).then(i => {
< 				$i!.mutingNotificationTypes = i.mutingNotificationTypes;
< 			});
< 		},
< 	}, 'closed');
---
>   const includingTypes = notificationTypes.filter(
>     (x) => !$i!.mutingNotificationTypes.includes(x)
>   );
>   os.popup(
>     defineAsyncComponent(
>       () => import("@/components/MkNotificationSettingWindow.vue")
>     ),
>     {
>       includingTypes,
>       showGlobalToggle: false,
>     },
>     {
>       done: async (res) => {
>         const { includingTypes: value } = res;
>         await os
>           .apiWithDialog("i/update", {
>             mutingNotificationTypes: notificationTypes.filter(
>               (x) => !value.includes(x)
>             ),
>           })
>           .then((i) => {
>             $i!.mutingNotificationTypes = i.mutingNotificationTypes;
>           });
>       },
>     },
>     "closed"
>   );
75,86d73
< function onChangeSendReadMessage(v: boolean) {
< 	if (!pushRegistrationInServer) return;
< 
< 	os.apiWithDialog('sw/update-registration', {
< 		endpoint: pushRegistrationInServer.endpoint,
< 		sendReadMessage: v,
< 	}).then(res => {
< 		if (!allowButton)	return;
< 		allowButton.pushRegistrationInServer = res;
< 	});
< }
< 
92,93c79,80
< 	title: i18n.ts.notifications,
< 	icon: 'ti ti-bell',
---
>   title: i18n.ts.notifications,
>   icon: "fas fa-bell",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/other.vue RiricaV13/pages/settings/other.vue
2,5c2,9
< <div class="_gaps_m">
< 	<MkSwitch v-model="$i.injectFeaturedNote" @update:model-value="onChangeInjectFeaturedNote">
< 		{{ i18n.ts.showFeaturedNotesInTimeline }}
< 	</MkSwitch>
---
>   <div class="_formRoot">
>     <FormSwitch
>       v-model="$i.injectFeaturedNote"
>       class="_formBlock"
>       @update:modelValue="onChangeInjectFeaturedNote"
>     >
>       {{ i18n.ts.showFeaturedNotesInTimeline }}
>     </FormSwitch>
7,8c11,12
< 	<!--
< 	<MkSwitch v-model="reportError">{{ i18n.ts.sendErrorReports }}<template #caption>{{ i18n.ts.sendErrorReportsDescription }}</template></MkSwitch>
---
>     <!--
> 	<FormSwitch v-model="reportError" class="_formBlock">{{ i18n.ts.sendErrorReports }}<template #caption>{{ i18n.ts.sendErrorReportsDescription }}</template></FormSwitch>
11c15,17
< 	<FormLink to="/settings/account-info">{{ i18n.ts.accountInfo }}</FormLink>
---
>     <FormLink to="/settings/account-info" class="_formBlock">{{
>       i18n.ts.accountInfo
>     }}</FormLink>
13c19,22
< 	<FormLink to="/registry"><template #icon><i class="ti ti-adjustments"></i></template>{{ i18n.ts.registry }}</FormLink>
---
>     <FormLink to="/registry" class="_formBlock"
>       ><template #icon><i class="fas fa-cogs"></i></template
>       >{{ i18n.ts.registry }}</FormLink
>     >
15,16c24,28
< 	<FormLink to="/settings/delete-account"><template #icon><i class="ti ti-alert-triangle"></i></template>{{ i18n.ts.closeAccount }}</FormLink>
< </div>
---
>     <FormLink to="/settings/delete-account" class="_formBlock"
>       ><template #icon><i class="fas fa-exclamation-triangle"></i></template
>       >{{ i18n.ts.closeAccount }}</FormLink
>     >
>   </div>
20,27c32,39
< import { computed } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormLink from '@/components/form/link.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed } from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormLink from "@/components/form/link.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
29c41
< const reportError = computed(defaultStore.makeGetterSetter('reportError'));
---
> const reportError = computed(defaultStore.makeGetterSetter("reportError"));
32,36c44,48
< 	os.api('i/update', {
< 		injectFeaturedNote: v,
< 	}).then((i) => {
< 		$i!.injectFeaturedNote = i.injectFeaturedNote;
< 	});
---
>   os.api("i/update", {
>     injectFeaturedNote: v,
>   }).then((i) => {
>     $i!.injectFeaturedNote = i.injectFeaturedNote;
>   });
44,45c56,57
< 	title: i18n.ts.other,
< 	icon: 'ti ti-dots',
---
>   title: i18n.ts.other,
>   icon: "fas fa-ellipsis-h",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/plugin.install.vue RiricaV13/pages/settings/plugin.install.vue
2,3c2,5
< <div class="_gaps_m">
< 	<FormInfo warn>{{ i18n.ts._plugin.installWarn }}</FormInfo>
---
>   <div class="_formRoot">
>     <FormInfo warn class="_formBlock">{{
>       i18n.ts._plugin.installWarn
>     }}</FormInfo>
5,7c7,9
< 	<MkTextarea v-model="code" tall>
< 		<template #label>{{ i18n.ts.code }}</template>
< 	</MkTextarea>
---
>     <FormTextarea v-model="code" tall class="_formBlock">
>       <template #label>{{ i18n.ts.code }}</template>
>     </FormTextarea>
9,12c11,16
< 	<div>
< 		<MkButton :disabled="code == null" primary inline @click="install"><i class="ti ti-check"></i> {{ i18n.ts.install }}</MkButton>
< 	</div>
< </div>
---
>     <div class="_formBlock">
>       <FormButton :disabled="code == null" primary inline @click="install"
>         ><i class="fas fa-check"></i> {{ i18n.ts.install }}</FormButton
>       >
>     </div>
>   </div>
16,26c20,31
< import { defineAsyncComponent, nextTick, ref } from 'vue';
< import { Interpreter, Parser, utils } from '@syuilo/aiscript';
< import { v4 as uuid } from 'uuid';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormInfo from '@/components/MkInfo.vue';
< import * as os from '@/os';
< import { ColdDeviceStorage } from '@/store';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { defineAsyncComponent, nextTick, ref } from "vue";
> import { AiScript, parse } from "@syuilo/aiscript";
> import { serialize } from "@syuilo/aiscript/built/serializer";
> import { v4 as uuid } from "uuid";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInfo from "@/components/MkInfo.vue";
> import * as os from "@/os";
> import { ColdDeviceStorage } from "@/store";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
28d32
< const parser = new Parser();
31,39c35,46
< function installPlugin({ id, meta, src, token }) {
< 	ColdDeviceStorage.set('plugins', ColdDeviceStorage.get('plugins').concat({
< 		...meta,
< 		id,
< 		active: true,
< 		configData: {},
< 		token: token,
< 		src: src,
< 	}));
---
> function installPlugin({ id, meta, ast, token }) {
>   ColdDeviceStorage.set(
>     "plugins",
>     ColdDeviceStorage.get("plugins").concat({
>       ...meta,
>       id,
>       active: true,
>       configData: {},
>       token: token,
>       ast: ast,
>     })
>   );
43c50,59
< 	if (code.value == null) return;
---
>   let ast;
>   try {
>     ast = parse(code.value);
>   } catch (err) {
>     os.alert({
>       type: "error",
>       text: "Syntax error :(",
>     });
>     return;
>   }
45,58c61,68
< 	const lv = utils.getLangVersion(code.value);
< 	if (lv == null) {
< 		os.alert({
< 			type: 'error',
< 			text: 'No language version annotation found :(',
< 		});
< 		return;
< 	} else if (!lv.startsWith('0.12.')) {
< 		os.alert({
< 			type: 'error',
< 			text: `aiscript version '${lv}' is not supported :(`,
< 		});
< 		return;
< 	}
---
>   const meta = AiScript.collectMetadata(ast);
>   if (meta == null) {
>     os.alert({
>       type: "error",
>       text: "No metadata found :(",
>     });
>     return;
>   }
60,69c70,77
< 	let ast;
< 	try {
< 		ast = parser.parse(code.value);
< 	} catch (err) {
< 		os.alert({
< 			type: 'error',
< 			text: 'Syntax error :(',
< 		});
< 		return;
< 	}
---
>   const metadata = meta.get(null);
>   if (metadata == null) {
>     os.alert({
>       type: "error",
>       text: "No metadata found :(",
>     });
>     return;
>   }
71,78c79,86
< 	const meta = Interpreter.collectMetadata(ast);
< 	if (meta == null) {
< 		os.alert({
< 			type: 'error',
< 			text: 'No metadata found :(',
< 		});
< 		return;
< 	}
---
>   const { name, version, author, description, permissions, config } = metadata;
>   if (name == null || version == null || author == null) {
>     os.alert({
>       type: "error",
>       text: "Required property not found :(",
>     });
>     return;
>   }
80,87c88,115
< 	const metadata = meta.get(null);
< 	if (metadata == null) {
< 		os.alert({
< 			type: 'error',
< 			text: 'No metadata found :(',
< 		});
< 		return;
< 	}
---
>   const token =
>     permissions == null || permissions.length === 0
>       ? null
>       : await new Promise((res, rej) => {
>           os.popup(
>             defineAsyncComponent(
>               () => import("@/components/MkTokenGenerateWindow.vue")
>             ),
>             {
>               title: i18n.ts.tokenRequested,
>               information: i18n.ts.pluginTokenRequestedDescription,
>               initialName: name,
>               initialPermissions: permissions,
>             },
>             {
>               done: async (result) => {
>                 const { name, permissions } = result;
>                 const { token } = await os.api("miauth/gen-token", {
>                   session: null,
>                   name: name,
>                   permission: permissions,
>                 });
>                 res(token);
>               },
>             },
>             "closed"
>           );
>         });
89,96c117,129
< 	const { name, version, author, description, permissions, config } = metadata;
< 	if (name == null || version == null || author == null) {
< 		os.alert({
< 			type: 'error',
< 			text: 'Required property not found :(',
< 		});
< 		return;
< 	}
---
>   installPlugin({
>     id: uuid(),
>     meta: {
>       name,
>       version,
>       author,
>       description,
>       permissions,
>       config,
>     },
>     token,
>     ast: serialize(ast),
>   });
98,115c131
< 	const token = permissions == null || permissions.length === 0 ? null : await new Promise((res, rej) => {
< 		os.popup(defineAsyncComponent(() => import('@/components/MkTokenGenerateWindow.vue')), {
< 			title: i18n.ts.tokenRequested,
< 			information: i18n.ts.pluginTokenRequestedDescription,
< 			initialName: name,
< 			initialPermissions: permissions,
< 		}, {
< 			done: async result => {
< 				const { name, permissions } = result;
< 				const { token } = await os.api('miauth/gen-token', {
< 					session: null,
< 					name: name,
< 					permission: permissions,
< 				});
< 				res(token);
< 			},
< 		}, 'closed');
< 	});
---
>   os.success();
117,130c133,135
< 	installPlugin({
< 		id: uuid(),
< 		meta: {
< 			name, version, author, description, permissions, config,
< 		},
< 		token,
< 		src: code.value,
< 	});
< 
< 	os.success();
< 
< 	nextTick(() => {
< 		unisonReload();
< 	});
---
>   nextTick(() => {
>     unisonReload();
>   });
138,139c143,144
< 	title: i18n.ts._plugin.install,
< 	icon: 'ti ti-download',
---
>   title: i18n.ts._plugin.install,
>   icon: "fas fa-download",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/plugin.vue RiricaV13/pages/settings/plugin.vue
2,3c2,6
< <div class="_gaps_m">
< 	<FormLink to="/settings/plugin/install"><template #icon><i class="ti ti-download"></i></template>{{ i18n.ts._plugin.install }}</FormLink>
---
>   <div class="_formRoot">
>     <FormLink to="/settings/plugin/install"
>       ><template #icon><i class="fas fa-download"></i></template
>       >{{ i18n.ts._plugin.install }}</FormLink
>     >
5,8c8,19
< 	<FormSection>
< 		<template #label>{{ i18n.ts.manage }}</template>
< 		<div v-for="plugin in plugins" :key="plugin.id" class="_panel _gaps_s" style="padding: 20px;">
< 			<span style="display: flex;"><b>{{ plugin.name }}</b><span style="margin-left: auto;">v{{ plugin.version }}</span></span>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.manage }}</template>
>       <div
>         v-for="plugin in plugins"
>         :key="plugin.id"
>         class="_formBlock _panel"
>         style="padding: 20px"
>       >
>         <span style="display: flex"
>           ><b>{{ plugin.name }}</b
>           ><span style="margin-left: auto">v{{ plugin.version }}</span></span
>         >
10c21,26
< 			<MkSwitch :model-value="plugin.active" @update:model-value="changeActive(plugin, $event)">{{ i18n.ts.makeActive }}</MkSwitch>
---
>         <FormSwitch
>           class="_formBlock"
>           :model-value="plugin.active"
>           @update:modelValue="changeActive(plugin, $event)"
>           >{{ i18n.ts.makeActive }}</FormSwitch
>         >
12,23c28,39
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.author }}</template>
< 				<template #value>{{ plugin.author }}</template>
< 			</MkKeyValue>
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.description }}</template>
< 				<template #value>{{ plugin.description }}</template>
< 			</MkKeyValue>
< 			<MkKeyValue>
< 				<template #key>{{ i18n.ts.permission }}</template>
< 				<template #value>{{ plugin.permission }}</template>
< 			</MkKeyValue>
---
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.author }}</template>
>           <template #value>{{ plugin.author }}</template>
>         </MkKeyValue>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.description }}</template>
>           <template #value>{{ plugin.description }}</template>
>         </MkKeyValue>
>         <MkKeyValue class="_formBlock">
>           <template #key>{{ i18n.ts.permission }}</template>
>           <template #value>{{ plugin.permission }}</template>
>         </MkKeyValue>
25,31c41,51
< 			<div class="_buttons">
< 				<MkButton v-if="plugin.config" inline @click="config(plugin)"><i class="ti ti-settings"></i> {{ i18n.ts.settings }}</MkButton>
< 				<MkButton inline danger @click="uninstall(plugin)"><i class="ti ti-trash"></i> {{ i18n.ts.uninstall }}</MkButton>
< 			</div>
< 		</div>
< 	</FormSection>
< </div>
---
>         <div style="display: flex; gap: var(--margin); flex-wrap: wrap">
>           <MkButton v-if="plugin.config" inline @click="config(plugin)"
>             ><i class="fas fa-cog"></i> {{ i18n.ts.settings }}</MkButton
>           >
>           <MkButton inline danger @click="uninstall(plugin)"
>             ><i class="fas fa-trash-alt"></i> {{ i18n.ts.uninstall }}</MkButton
>           >
>         </div>
>       </div>
>     </FormSection>
>   </div>
35,45c55,65
< import { nextTick, ref } from 'vue';
< import FormLink from '@/components/form/link.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import * as os from '@/os';
< import { ColdDeviceStorage } from '@/store';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { nextTick, ref } from "vue";
> import FormLink from "@/components/form/link.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import * as os from "@/os";
> import { ColdDeviceStorage } from "@/store";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
47c67
< const plugins = ref(ColdDeviceStorage.get('plugins'));
---
> const plugins = ref(ColdDeviceStorage.get("plugins"));
50,54c70,77
< 	ColdDeviceStorage.set('plugins', plugins.value.filter(x => x.id !== plugin.id));
< 	os.success();
< 	nextTick(() => {
< 		unisonReload();
< 	});
---
>   ColdDeviceStorage.set(
>     "plugins",
>     plugins.value.filter((x) => x.id !== plugin.id)
>   );
>   os.success();
>   nextTick(() => {
>     unisonReload();
>   });
59,62c82,85
< 	const config = plugin.config;
< 	for (const key in plugin.configData) {
< 		config[key].default = plugin.configData[key];
< 	}
---
>   const config = plugin.config;
>   for (const key in plugin.configData) {
>     config[key].default = plugin.configData[key];
>   }
64,65c87,88
< 	const { canceled, result } = await os.form(plugin.name, config);
< 	if (canceled) return;
---
>   const { canceled, result } = await os.form(plugin.name, config);
>   if (canceled) return;
67,69c90,92
< 	const coldPlugins = ColdDeviceStorage.get('plugins');
< 	coldPlugins.find(p => p.id === plugin.id)!.configData = result;
< 	ColdDeviceStorage.set('plugins', coldPlugins);
---
>   const coldPlugins = ColdDeviceStorage.get("plugins");
>   coldPlugins.find((p) => p.id === plugin.id)!.configData = result;
>   ColdDeviceStorage.set("plugins", coldPlugins);
71,73c94,96
< 	nextTick(() => {
< 		location.reload();
< 	});
---
>   nextTick(() => {
>     location.reload();
>   });
77,79c100,102
< 	const coldPlugins = ColdDeviceStorage.get('plugins');
< 	coldPlugins.find(p => p.id === plugin.id)!.active = active;
< 	ColdDeviceStorage.set('plugins', coldPlugins);
---
>   const coldPlugins = ColdDeviceStorage.get("plugins");
>   coldPlugins.find((p) => p.id === plugin.id)!.active = active;
>   ColdDeviceStorage.set("plugins", coldPlugins);
81,83c104,106
< 	nextTick(() => {
< 		location.reload();
< 	});
---
>   nextTick(() => {
>     location.reload();
>   });
91,92c114,115
< 	title: i18n.ts.plugins,
< 	icon: 'ti ti-plug',
---
>   title: i18n.ts.plugins,
>   icon: "fas fa-plug",
96,98c119
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/preferences-backups.vue RiricaV13/pages/settings/preferences-backups.vue
2,6c2,10
< <div class="_gaps_m">
< 	<div :class="$style.buttons">
< 		<MkButton inline primary @click="saveNew">{{ ts._preferencesBackups.saveNew }}</MkButton>
< 		<MkButton inline @click="loadFile">{{ ts._preferencesBackups.loadFile }}</MkButton>
< 	</div>
---
>   <div class="_formRoot">
>     <div :class="$style.buttons">
>       <MkButton inline primary @click="saveNew">{{
>         ts._preferencesBackups.saveNew
>       }}</MkButton>
>       <MkButton inline @click="loadFile">{{
>         ts._preferencesBackups.loadFile
>       }}</MkButton>
>     </div>
8,31c12,47
< 	<FormSection>
< 		<template #label>{{ ts._preferencesBackups.list }}</template>
< 		<template v-if="profiles && Object.keys(profiles).length > 0">
< 			<div class="_gaps_s">
< 				<div
< 					v-for="(profile, id) in profiles"
< 					:key="id"
< 					class="_panel"
< 					:class="$style.profile"
< 					@click="$event => menu($event, id)"
< 					@contextmenu.prevent.stop="$event => menu($event, id)"
< 				>
< 					<div :class="$style.profileName">{{ profile.name }}</div>
< 					<div :class="$style.profileTime">{{ t('_preferencesBackups.createdAt', { date: (new Date(profile.createdAt)).toLocaleDateString(), time: (new Date(profile.createdAt)).toLocaleTimeString() }) }}</div>
< 					<div v-if="profile.updatedAt" :class="$style.profileTime">{{ t('_preferencesBackups.updatedAt', { date: (new Date(profile.updatedAt)).toLocaleDateString(), time: (new Date(profile.updatedAt)).toLocaleTimeString() }) }}</div>
< 				</div>
< 			</div>
< 		</template>
< 		<div v-else-if="profiles">
< 			<MkInfo>{{ ts._preferencesBackups.noBackups }}</MkInfo>
< 		</div>
< 		<MkLoading v-else/>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <template #label>{{ ts._preferencesBackups.list }}</template>
>       <template v-if="profiles && Object.keys(profiles).length > 0">
>         <div
>           v-for="(profile, id) in profiles"
>           :key="id"
>           class="_formBlock _panel"
>           :class="$style.profile"
>           @click="($event) => menu($event, id)"
>           @contextmenu.prevent.stop="($event) => menu($event, id)"
>         >
>           <div :class="$style.profileName">{{ profile.name }}</div>
>           <div :class="$style.profileTime">
>             {{
>               t("_preferencesBackups.createdAt", {
>                 date: new Date(profile.createdAt).toLocaleDateString(),
>                 time: new Date(profile.createdAt).toLocaleTimeString(),
>               })
>             }}
>           </div>
>           <div v-if="profile.updatedAt" :class="$style.profileTime">
>             {{
>               t("_preferencesBackups.updatedAt", {
>                 date: new Date(profile.updatedAt).toLocaleDateString(),
>                 time: new Date(profile.updatedAt).toLocaleTimeString(),
>               })
>             }}
>           </div>
>         </div>
>       </template>
>       <div v-else-if="profiles">
>         <MkInfo>{{ ts._preferencesBackups.noBackups }}</MkInfo>
>       </div>
>       <MkLoading v-else />
>     </FormSection>
>   </div>
35,48c51,63
< import { computed, onMounted, onUnmounted, useCssModule } from 'vue';
< import { v4 as uuid } from 'uuid';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import * as os from '@/os';
< import { ColdDeviceStorage, defaultStore } from '@/store';
< import { unisonReload } from '@/scripts/unison-reload';
< import { stream } from '@/stream';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { version, host } from '@/config';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { miLocalStorage } from '@/local-storage';
---
> import { computed, onMounted, onUnmounted, useCssModule } from "vue";
> import { v4 as uuid } from "uuid";
> import FormSection from "@/components/form/section.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import * as os from "@/os";
> import { ColdDeviceStorage, defaultStore } from "@/store";
> import { unisonReload } from "@/scripts/unison-reload";
> import { stream } from "@/stream";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { version, host } from "@/config";
> import { definePageMetadata } from "@/scripts/page-metadata";
53,86c68,102
< const defaultStoreSaveKeys: (keyof typeof defaultStore['state'])[] = [
< 	'menu',
< 	'visibility',
< 	'localOnly',
< 	'statusbars',
< 	'widgets',
< 	'tl',
< 	'overridedDeviceKind',
< 	'serverDisconnectedBehavior',
< 	'nsfw',
< 	'animation',
< 	'animatedMfm',
< 	'loadRawImages',
< 	'imageNewTab',
< 	'disableShowingAnimatedImages',
< 	'emojiStyle',
< 	'disableDrawer',
< 	'useBlurEffectForModal',
< 	'useBlurEffect',
< 	'showFixedPostForm',
< 	'enableInfiniteScroll',
< 	'useReactionPickerForContextMenu',
< 	'showGapBetweenNotesInTimeline',
< 	'instanceTicker',
< 	'reactionPickerSize',
< 	'reactionPickerWidth',
< 	'reactionPickerHeight',
< 	'reactionPickerUseDrawerForMobile',
< 	'defaultSideView',
< 	'menuDisplay',
< 	'reportError',
< 	'squareAvatars',
< 	'numberOfPageCache',
< 	'aiChanMode',
---
> const defaultStoreSaveKeys: (keyof typeof defaultStore["state"])[] = [
>   "menu",
>   "visibility",
>   "localOnly",
>   "statusbars",
>   "widgets",
>   "tl",
>   "overridedDeviceKind",
>   "serverDisconnectedBehavior",
>   "nsfw",
>   "animation",
>   "animatedMfm",
>   "loadRawImages",
>   "imageNewTab",
>   "disableShowingAnimatedImages",
>   "disablePagesScript",
>   "useOsNativeEmojis",
>   "disableDrawer",
>   "useBlurEffectForModal",
>   "useBlurEffect",
>   "showFixedPostForm",
>   "enableInfiniteScroll",
>   "useReactionPickerForContextMenu",
>   "showGapBetweenNotesInTimeline",
>   "instanceTicker",
>   "reactionPickerSize",
>   "reactionPickerWidth",
>   "reactionPickerHeight",
>   "reactionPickerUseDrawerForMobile",
>   "defaultSideView",
>   "menuDisplay",
>   "reportError",
>   "squareAvatars",
>   "numberOfPageCache",
>   "aiChanMode",
89,101c105,117
< 	'lightTheme',
< 	'darkTheme',
< 	'syncDeviceDarkMode',
< 	'plugins',
< 	'mediaVolume',
< 	'sound_masterVolume',
< 	'sound_note',
< 	'sound_noteMy',
< 	'sound_notification',
< 	'sound_chat',
< 	'sound_chatBg',
< 	'sound_antenna',
< 	'sound_channel',
---
>   "lightTheme",
>   "darkTheme",
>   "syncDeviceDarkMode",
>   "plugins",
>   "mediaVolume",
>   "sound_masterVolume",
>   "sound_note",
>   "sound_noteMy",
>   "sound_notification",
>   "sound_chat",
>   "sound_chatBg",
>   "sound_antenna",
>   "sound_channel",
104c120
< const scope = ['clientPreferencesProfiles'];
---
> const scope = ["clientPreferencesProfiles"];
106c122,128
< const profileProps = ['name', 'createdAt', 'updatedAt', 'misskeyVersion', 'settings', 'host'];
---
> const profileProps = [
>   "name",
>   "createdAt",
>   "updatedAt",
>   "misskeyVersion",
>   "settings",
> ];
109,120c131,142
< 	name: string;
< 	createdAt: string;
< 	updatedAt: string | null;
< 	misskeyVersion: string;
< 	host: string;
< 	settings: {
< 		hot: Record<keyof typeof defaultStoreSaveKeys, unknown>;
< 		cold: Record<keyof typeof coldDeviceStorageSaveKeys, unknown>;
< 		fontSize: string | null;
< 		useSystemFont: 't' | null;
< 		wallpaper: string | null;
< 	};
---
>   name: string;
>   createdAt: string;
>   updatedAt: string | null;
>   misskeyVersion: string;
>   host: string;
>   settings: {
>     hot: Record<keyof typeof defaultStoreSaveKeys, unknown>;
>     cold: Record<keyof typeof coldDeviceStorageSaveKeys, unknown>;
>     fontSize: string | null;
>     useSystemFont: "t" | null;
>     wallpaper: string | null;
>   };
123c145
< const connection = $i && stream.useChannel('main');
---
> const connection = $i && stream.useChannel("main");
127,130c149,151
< os.api('i/registry/get-all', { scope })
< 	.then(res => {
< 		profiles = res || {};
< 	});
---
> os.api("i/registry/get-all", { scope }).then((res) => {
>   profiles = res || {};
> });
133c154
< 	return value != null && typeof value === 'object' && !Array.isArray(value);
---
>   return value != null && typeof value === "object" && !Array.isArray(value);
137c158
< 	if (!isObject(profile)) throw new Error('not an object');
---
>   if (!isObject(profile)) throw new Error("not an object");
139,140c160,162
< 	// Check if unnecessary properties exist
< 	if (Object.keys(profile).some(key => !profileProps.includes(key))) throw new Error('Unnecessary properties exist');
---
>   // Check if unnecessary properties exist
>   if (Object.keys(profile).some((key) => !profileProps.includes(key)))
>     throw new Error("Unnecessary properties exist");
142,154c164,166
< 	if (!profile.name) throw new Error('Missing required prop: name');
< 	if (!profile.misskeyVersion) throw new Error('Missing required prop: misskeyVersion');
< 	
< 	// Check if createdAt and updatedAt is Date
< 	// https://zenn.dev/lollipop_onl/articles/eoz-judge-js-invalid-date
< 	if (!profile.createdAt || Number.isNaN(new Date(profile.createdAt).getTime())) throw new Error('createdAt is falsy or not Date');
< 	if (profile.updatedAt) {
< 		if (Number.isNaN(new Date(profile.updatedAt).getTime())) {
< 			throw new Error('updatedAt is not Date');
< 		}
< 	} else if (profile.updatedAt !== null) {
< 		throw new Error('updatedAt is not null');
< 	}
---
>   if (!profile.name) throw new Error("Missing required prop: name");
>   if (!profile.misskeyVersion)
>     throw new Error("Missing required prop: misskeyVersion");
156,157c168,181
< 	if (!profile.settings) throw new Error('Missing required prop: settings');
< 	if (!isObject(profile.settings)) throw new Error('Invalid prop: settings');
---
>   // Check if createdAt and updatedAt is Date
>   // https://zenn.dev/lollipop_onl/articles/eoz-judge-js-invalid-date
>   if (!profile.createdAt || Number.isNaN(new Date(profile.createdAt).getTime()))
>     throw new Error("createdAt is falsy or not Date");
>   if (profile.updatedAt) {
>     if (Number.isNaN(new Date(profile.updatedAt).getTime())) {
>       throw new Error("updatedAt is not Date");
>     }
>   } else if (profile.updatedAt !== null) {
>     throw new Error("updatedAt is not null");
>   }
> 
>   if (!profile.settings) throw new Error("Missing required prop: settings");
>   if (!isObject(profile.settings)) throw new Error("Invalid prop: settings");
160,164c184,188
< function getSettings(): Profile['settings'] {
< 	const hot = {} as Record<keyof typeof defaultStoreSaveKeys, unknown>;
< 	for (const key of defaultStoreSaveKeys) {
< 		hot[key] = defaultStore.state[key];
< 	}
---
> function getSettings(): Profile["settings"] {
>   const hot = {} as Record<keyof typeof defaultStoreSaveKeys, unknown>;
>   for (const key of defaultStoreSaveKeys) {
>     hot[key] = defaultStore.state[key];
>   }
166,169c190,193
< 	const cold = {} as Record<keyof typeof coldDeviceStorageSaveKeys, unknown>;
< 	for (const key of coldDeviceStorageSaveKeys) {
< 		cold[key] = ColdDeviceStorage.get(key);
< 	}
---
>   const cold = {} as Record<keyof typeof coldDeviceStorageSaveKeys, unknown>;
>   for (const key of coldDeviceStorageSaveKeys) {
>     cold[key] = ColdDeviceStorage.get(key);
>   }
171,177c195,201
< 	return {
< 		hot,
< 		cold,
< 		fontSize: miLocalStorage.getItem('fontSize'),
< 		useSystemFont: miLocalStorage.getItem('useSystemFont') as 't' | null,
< 		wallpaper: miLocalStorage.getItem('wallpaper'),
< 	};
---
>   return {
>     hot,
>     cold,
>     fontSize: localStorage.getItem("fontSize"),
>     useSystemFont: localStorage.getItem("useSystemFont") as "t" | null,
>     wallpaper: localStorage.getItem("wallpaper"),
>   };
181c205
< 	if (!profiles) return;
---
>   if (!profiles) return;
183,186c207,210
< 	const { canceled, result: name } = await os.inputText({
< 		title: ts._preferencesBackups.inputName,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: name } = await os.inputText({
>     title: ts._preferencesBackups.inputName,
>   });
>   if (canceled) return;
188,193c212,217
< 	if (Object.values(profiles).some(x => x.name === name)) {
< 		return os.alert({
< 			title: ts._preferencesBackups.cannotSave,
< 			text: t('_preferencesBackups.nameAlreadyExists', { name }),
< 		});
< 	}
---
>   if (Object.values(profiles).some((x) => x.name === name)) {
>     return os.alert({
>       title: ts._preferencesBackups.cannotSave,
>       text: t("_preferencesBackups.nameAlreadyExists", { name }),
>     });
>   }
195,204c219,228
< 	const id = uuid();
< 	const profile: Profile = {
< 		name,
< 		createdAt: (new Date()).toISOString(),
< 		updatedAt: null,
< 		misskeyVersion: version,
< 		host,
< 		settings: getSettings(),
< 	};
< 	await os.apiWithDialog('i/registry/set', { scope, key: id, value: profile });
---
>   const id = uuid();
>   const profile: Profile = {
>     name,
>     createdAt: new Date().toISOString(),
>     updatedAt: null,
>     misskeyVersion: version,
>     host,
>     settings: getSettings(),
>   };
>   await os.apiWithDialog("i/registry/set", { scope, key: id, value: profile });
208,213c232,237
< 	const input = document.createElement('input');
< 	input.type = 'file';
< 	input.multiple = false;
< 	input.onchange = async () => {
< 		if (!profiles) return;
< 		if (!input.files || input.files.length === 0) return;
---
>   const input = document.createElement("input");
>   input.type = "file";
>   input.multiple = false;
>   input.onchange = async () => {
>     if (!profiles) return;
>     if (!input.files || input.files.length === 0) return;
215c239
< 		const file = input.files[0];
---
>     const file = input.files[0];
217,223c241,247
< 		if (file.type !== 'application/json') {
< 			return os.alert({
< 				type: 'error',
< 				title: ts._preferencesBackups.cannotLoad,
< 				text: ts._preferencesBackups.invalidFile,
< 			});
< 		}
---
>     if (file.type !== "application/json") {
>       return os.alert({
>         type: "error",
>         title: ts._preferencesBackups.cannotLoad,
>         text: ts._preferencesBackups.invalidFile,
>       });
>     }
225,235c249,259
< 		let profile: Profile;
< 		try {
< 			profile = JSON.parse(await file.text()) as unknown as Profile;
< 			validate(profile);
< 		} catch (err) {
< 			return os.alert({
< 				type: 'error',
< 				title: ts._preferencesBackups.cannotLoad,
< 				text: err?.message,
< 			});
< 		}
---
>     let profile: Profile;
>     try {
>       profile = JSON.parse(await file.text()) as unknown as Profile;
>       validate(profile);
>     } catch (err) {
>       return os.alert({
>         type: "error",
>         title: ts._preferencesBackups.cannotLoad,
>         text: err?.message,
>       });
>     }
237,238c261,266
< 		const id = uuid();
< 		await os.apiWithDialog('i/registry/set', { scope, key: id, value: profile });
---
>     const id = uuid();
>     await os.apiWithDialog("i/registry/set", {
>       scope,
>       key: id,
>       value: profile,
>     });
240,242c268,270
< 		// 一応廃棄
< 		(window as any).__misskey_input_ref__ = null;
< 	};
---
>     // 一応廃棄
>     (window as any).__misskey_input_ref__ = null;
>   };
244,246c272,274
< 	// https://qiita.com/fukasawah/items/b9dc732d95d99551013d
< 	// iOS Safari で正常に動かす為のおまじない
< 	(window as any).__misskey_input_ref__ = input;
---
>   // https://qiita.com/fukasawah/items/b9dc732d95d99551013d
>   // iOS Safari で正常に動かす為のおまじない
>   (window as any).__misskey_input_ref__ = input;
248c276
< 	input.click();
---
>   input.click();
252c280
< 	if (!profiles) return;
---
>   if (!profiles) return;
254c282
< 	const profile = profiles[id];
---
>   const profile = profiles[id];
256,261c284,289
< 	const { canceled: cancel1 } = await os.confirm({
< 		type: 'warning',
< 		title: ts._preferencesBackups.apply,
< 		text: t('_preferencesBackups.applyConfirm', { name: profile.name }),
< 	});
< 	if (cancel1) return;
---
>   const { canceled: cancel1 } = await os.confirm({
>     type: "warning",
>     title: ts._preferencesBackups.apply,
>     text: t("_preferencesBackups.applyConfirm", { name: profile.name }),
>   });
>   if (cancel1) return;
263c291
< 	// TODO: バージョン or ホストが違ったらさらに警告を表示
---
>   // TODO: バージョン or ホストが違ったらさらに警告を表示
265c293
< 	const settings = profile.settings;
---
>   const settings = profile.settings;
267,279c295,300
< 	// defaultStore
< 	for (const key of defaultStoreSaveKeys) {
< 		if (settings.hot[key] !== undefined) {
< 			defaultStore.set(key, settings.hot[key]);
< 		}
< 	}
< 	
< 	// coldDeviceStorage
< 	for (const key of coldDeviceStorageSaveKeys) {
< 		if (settings.cold[key] !== undefined) {
< 			ColdDeviceStorage.set(key, settings.cold[key]);
< 		}
< 	}
---
>   // defaultStore
>   for (const key of defaultStoreSaveKeys) {
>     if (settings.hot[key] !== undefined) {
>       defaultStore.set(key, settings.hot[key]);
>     }
>   }
281,286c302,307
< 	// fontSize
< 	if (settings.fontSize) {
< 		miLocalStorage.setItem('fontSize', settings.fontSize);
< 	} else {
< 		miLocalStorage.removeItem('fontSize');
< 	}
---
>   // coldDeviceStorage
>   for (const key of coldDeviceStorageSaveKeys) {
>     if (settings.cold[key] !== undefined) {
>       ColdDeviceStorage.set(key, settings.cold[key]);
>     }
>   }
288,293c309,314
< 	// useSystemFont
< 	if (settings.useSystemFont) {
< 		miLocalStorage.setItem('useSystemFont', settings.useSystemFont);
< 	} else {
< 		miLocalStorage.removeItem('useSystemFont');
< 	}
---
>   // fontSize
>   if (settings.fontSize) {
>     localStorage.setItem("fontSize", settings.fontSize);
>   } else {
>     localStorage.removeItem("fontSize");
>   }
295,300c316,321
< 	// wallpaper
< 	if (settings.wallpaper != null) {
< 		miLocalStorage.setItem('wallpaper', settings.wallpaper);
< 	} else {
< 		miLocalStorage.removeItem('wallpaper');
< 	}
---
>   // useSystemFont
>   if (settings.useSystemFont) {
>     localStorage.setItem("useSystemFont", settings.useSystemFont);
>   } else {
>     localStorage.removeItem("useSystemFont");
>   }
302,306c323,328
< 	const { canceled: cancel2 } = await os.confirm({
< 		type: 'info',
< 		text: ts.reloadToApplySetting,
< 	});
< 	if (cancel2) return;
---
>   // wallpaper
>   if (settings.wallpaper != null) {
>     localStorage.setItem("wallpaper", settings.wallpaper);
>   } else {
>     localStorage.removeItem("wallpaper");
>   }
308c330,336
< 	unisonReload();
---
>   const { canceled: cancel2 } = await os.confirm({
>     type: "info",
>     text: ts.reloadToApplySetting,
>   });
>   if (cancel2) return;
> 
>   unisonReload();
312c340
< 	if (!profiles) return;
---
>   if (!profiles) return;
314,319c342,347
< 	const { canceled } = await os.confirm({
< 		type: 'info',
< 		title: ts.delete,
< 		text: t('deleteAreYouSure', { x: profiles[id].name }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "info",
>     title: ts.delete,
>     text: t("deleteAreYouSure", { x: profiles[id].name }),
>   });
>   if (canceled) return;
321,322c349,350
< 	await os.apiWithDialog('i/registry/remove', { scope, key: id });
< 	delete profiles[id];
---
>   await os.apiWithDialog("i/registry/remove", { scope, key: id });
>   delete profiles[id];
326c354
< 	if (!profiles) return;
---
>   if (!profiles) return;
328c356
< 	const { name, createdAt } = profiles[id];
---
>   const { name, createdAt } = profiles[id];
330,335c358,363
< 	const { canceled } = await os.confirm({
< 		type: 'info',
< 		title: ts._preferencesBackups.save,
< 		text: t('_preferencesBackups.saveConfirm', { name }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "info",
>     title: ts._preferencesBackups.save,
>     text: t("_preferencesBackups.saveConfirm", { name }),
>   });
>   if (canceled) return;
337,345c365,373
< 	const profile: Profile = {
< 		name,
< 		createdAt,
< 		updatedAt: (new Date()).toISOString(),
< 		misskeyVersion: version,
< 		host,
< 		settings: getSettings(),
< 	};
< 	await os.apiWithDialog('i/registry/set', { scope, key: id, value: profile });
---
>   const profile: Profile = {
>     name,
>     createdAt,
>     updatedAt: new Date().toISOString(),
>     misskeyVersion: version,
>     host,
>     settings: getSettings(),
>   };
>   await os.apiWithDialog("i/registry/set", { scope, key: id, value: profile });
349c377
< 	if (!profiles) return;
---
>   if (!profiles) return;
351,354c379,382
< 	const { canceled: cancel1, result: name } = await os.inputText({
< 		title: ts._preferencesBackups.inputName,
< 	});
< 	if (cancel1 || profiles[id].name === name) return;
---
>   const { canceled: cancel1, result: name } = await os.inputText({
>     title: ts._preferencesBackups.inputName,
>   });
>   if (cancel1 || profiles[id].name === name) return;
356,361c384,389
< 	if (Object.values(profiles).some(x => x.name === name)) {
< 		return os.alert({
< 			title: ts._preferencesBackups.cannotSave,
< 			text: t('_preferencesBackups.nameAlreadyExists', { name }),
< 		});
< 	}
---
>   if (Object.values(profiles).some((x) => x.name === name)) {
>     return os.alert({
>       title: ts._preferencesBackups.cannotSave,
>       text: t("_preferencesBackups.nameAlreadyExists", { name }),
>     });
>   }
363c391
< 	const registry = Object.assign({}, { ...profiles[id] });
---
>   const registry = Object.assign({}, { ...profiles[id] });
365,370c393,401
< 	const { canceled: cancel2 } = await os.confirm({
< 		type: 'info',
< 		title: ts._preferencesBackups.rename,
< 		text: t('_preferencesBackups.renameConfirm', { old: registry.name, new: name }),
< 	});
< 	if (cancel2) return;
---
>   const { canceled: cancel2 } = await os.confirm({
>     type: "info",
>     title: ts._preferencesBackups.rename,
>     text: t("_preferencesBackups.renameConfirm", {
>       old: registry.name,
>       new: name,
>     }),
>   });
>   if (cancel2) return;
372,373c403,404
< 	registry.name = name;
< 	await os.apiWithDialog('i/registry/set', { scope, key: id, value: registry });
---
>   registry.name = name;
>   await os.apiWithDialog("i/registry/set", { scope, key: id, value: registry });
377c408
< 	if (!profiles) return;
---
>   if (!profiles) return;
379,402c410,448
< 	return os.popupMenu([{
< 		text: ts._preferencesBackups.apply,
< 		icon: 'ti ti-check',
< 		action: () => applyProfile(profileId),
< 	}, {
< 		type: 'a',
< 		text: ts.download,
< 		icon: 'ti ti-download',
< 		href: URL.createObjectURL(new Blob([JSON.stringify(profiles[profileId], null, 2)], { type: 'application/json' })),
< 		download: `${profiles[profileId].name}.json`,
< 	}, null, {
< 		text: ts.rename,
< 		icon: 'ti ti-forms',
< 		action: () => rename(profileId),
< 	}, {
< 		text: ts._preferencesBackups.save,
< 		icon: 'ti ti-device-floppy',
< 		action: () => save(profileId),
< 	}, null, {
< 		text: ts._preferencesBackups.delete,
< 		icon: 'ti ti-trash',
< 		action: () => deleteProfile(profileId),
< 		danger: true,
< 	}], ev.currentTarget ?? ev.target);
---
>   return os.popupMenu(
>     [
>       {
>         text: ts._preferencesBackups.apply,
>         icon: "fas fa-circle-down",
>         action: () => applyProfile(profileId),
>       },
>       {
>         type: "a",
>         text: ts.download,
>         icon: "fas fa-download",
>         href: URL.createObjectURL(
>           new Blob([JSON.stringify(profiles[profileId], null, 2)], {
>             type: "application/json",
>           })
>         ),
>         download: `${profiles[profileId].name}.json`,
>       },
>       null,
>       {
>         text: ts.rename,
>         icon: "fas fa-i-cursor",
>         action: () => rename(profileId),
>       },
>       {
>         text: ts._preferencesBackups.save,
>         icon: "fas fa-floppy-disk",
>         action: () => save(profileId),
>       },
>       null,
>       {
>         text: ts._preferencesBackups.delete,
>         icon: "fas fa-trash-can",
>         action: () => deleteProfile(profileId),
>         danger: true,
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
406,409c452,460
< 	// streamingのuser storage updateイベントを監視して更新
< 	connection?.on('registryUpdated', ({ scope: recievedScope, key, value }) => {
< 		if (!recievedScope || recievedScope.length !== scope.length || recievedScope[0] !== scope[0]) return;
< 		if (!profiles) return;
---
>   // streamingのuser storage updateイベントを監視して更新
>   connection?.on("registryUpdated", ({ scope: recievedScope, key, value }) => {
>     if (
>       !recievedScope ||
>       recievedScope.length !== scope.length ||
>       recievedScope[0] !== scope[0]
>     )
>       return;
>     if (!profiles) return;
411,412c462,463
< 		profiles[key] = value;
< 	});
---
>     profiles[key] = value;
>   });
416c467
< 	connection?.off('registryUpdated');
---
>   connection?.off("registryUpdated");
419,423c470,476
< definePageMetadata(computed(() => ({
< 	title: ts.preferencesBackups,
< 	icon: 'ti ti-device-floppy',
< 	bg: 'var(--bg)',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: ts.preferencesBackups,
>     icon: "fas fa-floppy-disk",
>     bg: "var(--bg)",
>   }))
> );
428,430c481,483
< 	display: flex;
< 	gap: var(--margin);
< 	flex-wrap: wrap;
---
>   display: flex;
>   gap: var(--margin);
>   flex-wrap: wrap;
434,435c487,488
< 	padding: 20px;
< 	cursor: pointer;
---
>   padding: 20px;
>   cursor: pointer;
437,439c490,492
< 	&Name {
< 		font-weight: 700;
< 	}
---
>   &Name {
>     font-weight: 700;
>   }
441,444c494,497
< 	&Time {
< 		font-size: .85em;
< 		opacity: .7;
< 	}
---
>   &Time {
>     font-size: 0.85em;
>     opacity: 0.7;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/privacy.vue RiricaV13/pages/settings/privacy.vue
2,4c2,18
< <div class="_gaps_m">
< 	<MkSwitch v-model="isLocked" @update:model-value="save()">{{ i18n.ts.makeFollowManuallyApprove }}<template #caption>{{ i18n.ts.lockedAccountInfo }}</template></MkSwitch>
< 	<MkSwitch v-if="isLocked" v-model="autoAcceptFollowed" @update:model-value="save()">{{ i18n.ts.autoAcceptFollowed }}</MkSwitch>
---
>   <div class="_formRoot">
>     <FormSwitch
>       v-model="isLocked"
>       class="_formBlock"
>       @update:modelValue="save()"
>       >{{ i18n.ts.makeFollowManuallyApprove
>       }}<template #caption>{{
>         i18n.ts.lockedAccountInfo
>       }}</template></FormSwitch
>     >
>     <FormSwitch
>       v-if="isLocked"
>       v-model="autoAcceptFollowed"
>       class="_formBlock"
>       @update:modelValue="save()"
>       >{{ i18n.ts.autoAcceptFollowed }}</FormSwitch
>     >
6,30c20,27
< 	<MkSwitch v-model="publicReactions" @update:model-value="save()">
< 		{{ i18n.ts.makeReactionsPublic }}
< 		<template #caption>{{ i18n.ts.makeReactionsPublicDescription }}</template>
< 	</MkSwitch>
< 		
< 	<MkSelect v-model="ffVisibility" @update:model-value="save()">
< 		<template #label>{{ i18n.ts.ffVisibility }}</template>
< 		<option value="public">{{ i18n.ts._ffVisibility.public }}</option>
< 		<option value="followers">{{ i18n.ts._ffVisibility.followers }}</option>
< 		<option value="private">{{ i18n.ts._ffVisibility.private }}</option>
< 		<template #caption>{{ i18n.ts.ffVisibilityDescription }}</template>
< 	</MkSelect>
< 		
< 	<MkSwitch v-model="hideOnlineStatus" @update:model-value="save()">
< 		{{ i18n.ts.hideOnlineStatus }}
< 		<template #caption>{{ i18n.ts.hideOnlineStatusDescription }}</template>
< 	</MkSwitch>
< 	<MkSwitch v-model="noCrawle" @update:model-value="save()">
< 		{{ i18n.ts.noCrawle }}
< 		<template #caption>{{ i18n.ts.noCrawleDescription }}</template>
< 	</MkSwitch>
< 	<MkSwitch v-model="isExplorable" @update:model-value="save()">
< 		{{ i18n.ts.makeExplorable }}
< 		<template #caption>{{ i18n.ts.makeExplorableDescription }}</template>
< 	</MkSwitch>
---
>     <FormSwitch
>       v-model="publicReactions"
>       class="_formBlock"
>       @update:modelValue="save()"
>     >
>       {{ i18n.ts.makeReactionsPublic }}
>       <template #caption>{{ i18n.ts.makeReactionsPublicDescription }}</template>
>     </FormSwitch>
32,40c29,39
< 	<FormSection>
< 		<div class="_gaps_m">
< 			<MkSwitch v-model="rememberNoteVisibility" @update:model-value="save()">{{ i18n.ts.rememberNoteVisibility }}</MkSwitch>
< 			<MkFolder v-if="!rememberNoteVisibility">
< 				<template #label>{{ i18n.ts.defaultNoteVisibility }}</template>
< 				<template v-if="defaultNoteVisibility === 'public'" #suffix>{{ i18n.ts._visibility.public }}</template>
< 				<template v-else-if="defaultNoteVisibility === 'home'" #suffix>{{ i18n.ts._visibility.home }}</template>
< 				<template v-else-if="defaultNoteVisibility === 'followers'" #suffix>{{ i18n.ts._visibility.followers }}</template>
< 				<template v-else-if="defaultNoteVisibility === 'specified'" #suffix>{{ i18n.ts._visibility.specified }}</template>
---
>     <FormSelect
>       v-model="ffVisibility"
>       class="_formBlock"
>       @update:modelValue="save()"
>     >
>       <template #label>{{ i18n.ts.ffVisibility }}</template>
>       <option value="public">{{ i18n.ts._ffVisibility.public }}</option>
>       <option value="followers">{{ i18n.ts._ffVisibility.followers }}</option>
>       <option value="private">{{ i18n.ts._ffVisibility.private }}</option>
>       <template #caption>{{ i18n.ts.ffVisibilityDescription }}</template>
>     </FormSelect>
42,53c41,64
< 				<div class="_gaps_m">
< 					<MkSelect v-model="defaultNoteVisibility">
< 						<option value="public">{{ i18n.ts._visibility.public }}</option>
< 						<option value="home">{{ i18n.ts._visibility.home }}</option>
< 						<option value="followers">{{ i18n.ts._visibility.followers }}</option>
< 						<option value="specified">{{ i18n.ts._visibility.specified }}</option>
< 					</MkSelect>
< 					<MkSwitch v-model="defaultNoteLocalOnly">{{ i18n.ts._visibility.localOnly }}</MkSwitch>
< 				</div>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
---
>     <FormSwitch
>       v-model="hideOnlineStatus"
>       class="_formBlock"
>       @update:modelValue="save()"
>     >
>       {{ i18n.ts.hideOnlineStatus }}
>       <template #caption>{{ i18n.ts.hideOnlineStatusDescription }}</template>
>     </FormSwitch>
>     <FormSwitch
>       v-model="noCrawle"
>       class="_formBlock"
>       @update:modelValue="save()"
>     >
>       {{ i18n.ts.noCrawle }}
>       <template #caption>{{ i18n.ts.noCrawleDescription }}</template>
>     </FormSwitch>
>     <FormSwitch
>       v-model="isExplorable"
>       class="_formBlock"
>       @update:modelValue="save()"
>     >
>       {{ i18n.ts.makeExplorable }}
>       <template #caption>{{ i18n.ts.makeExplorableDescription }}</template>
>     </FormSwitch>
55,56c66,106
< 	<MkSwitch v-model="keepCw" @update:model-value="save()">{{ i18n.ts.keepCw }}</MkSwitch>
< </div>
---
>     <FormSection>
>       <FormSwitch
>         v-model="rememberNoteVisibility"
>         class="_formBlock"
>         @update:modelValue="save()"
>         >{{ i18n.ts.rememberNoteVisibility }}</FormSwitch
>       >
>       <FormFolder v-if="!rememberNoteVisibility" class="_formBlock">
>         <template #label>{{ i18n.ts.defaultNoteVisibility }}</template>
>         <template v-if="defaultNoteVisibility === 'public'" #suffix>{{
>           i18n.ts._visibility.public
>         }}</template>
>         <template v-else-if="defaultNoteVisibility === 'home'" #suffix>{{
>           i18n.ts._visibility.home
>         }}</template>
>         <template v-else-if="defaultNoteVisibility === 'followers'" #suffix>{{
>           i18n.ts._visibility.followers
>         }}</template>
>         <template v-else-if="defaultNoteVisibility === 'specified'" #suffix>{{
>           i18n.ts._visibility.specified
>         }}</template>
> 
>         <FormSelect v-model="defaultNoteVisibility" class="_formBlock">
>           <option value="public">{{ i18n.ts._visibility.public }}</option>
>           <option value="home">{{ i18n.ts._visibility.home }}</option>
>           <option value="followers">{{ i18n.ts._visibility.followers }}</option>
>           <option value="specified">{{ i18n.ts._visibility.specified }}</option>
>         </FormSelect>
>         <FormSwitch v-model="defaultNoteLocalOnly" class="_formBlock">{{
>           i18n.ts._visibility.localOnly
>         }}</FormSwitch>
>       </FormFolder>
>     </FormSection>
> 
>     <FormSwitch
>       v-model="keepCw"
>       class="_formBlock"
>       @update:modelValue="save()"
>       >{{ i18n.ts.keepCw }}</FormSwitch
>     >
>   </div>
60,69c110,119
< import { } from 'vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import FormSection from '@/components/form/section.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSelect from "@/components/form/select.vue";
> import FormSection from "@/components/form/section.vue";
> import FormFolder from "@/components/form/folder.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
> import { definePageMetadata } from "@/scripts/page-metadata";
79,82c129,138
< let defaultNoteVisibility = $computed(defaultStore.makeGetterSetter('defaultNoteVisibility'));
< let defaultNoteLocalOnly = $computed(defaultStore.makeGetterSetter('defaultNoteLocalOnly'));
< let rememberNoteVisibility = $computed(defaultStore.makeGetterSetter('rememberNoteVisibility'));
< let keepCw = $computed(defaultStore.makeGetterSetter('keepCw'));
---
> let defaultNoteVisibility = $computed(
>   defaultStore.makeGetterSetter("defaultNoteVisibility")
> );
> let defaultNoteLocalOnly = $computed(
>   defaultStore.makeGetterSetter("defaultNoteLocalOnly")
> );
> let rememberNoteVisibility = $computed(
>   defaultStore.makeGetterSetter("rememberNoteVisibility")
> );
> let keepCw = $computed(defaultStore.makeGetterSetter("keepCw"));
85,93c141,149
< 	os.api('i/update', {
< 		isLocked: !!isLocked,
< 		autoAcceptFollowed: !!autoAcceptFollowed,
< 		noCrawle: !!noCrawle,
< 		isExplorable: !!isExplorable,
< 		hideOnlineStatus: !!hideOnlineStatus,
< 		publicReactions: !!publicReactions,
< 		ffVisibility: ffVisibility,
< 	});
---
>   os.api("i/update", {
>     isLocked: !!isLocked,
>     autoAcceptFollowed: !!autoAcceptFollowed,
>     noCrawle: !!noCrawle,
>     isExplorable: !!isExplorable,
>     hideOnlineStatus: !!hideOnlineStatus,
>     publicReactions: !!publicReactions,
>     ffVisibility: ffVisibility,
>   });
101,102c157,158
< 	title: i18n.ts.privacy,
< 	icon: 'ti ti-lock-open',
---
>   title: i18n.ts.privacy,
>   icon: "fas fa-lock-open",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/profile.vue RiricaV13/pages/settings/profile.vue
2,9c2,21
< <div class="_gaps_m">
< 	<div class="llvierxe" :style="{ backgroundImage: $i.bannerUrl ? `url(${ $i.bannerUrl })` : null }">
< 		<div class="avatar">
< 			<MkAvatar class="avatar" :user="$i" @click="changeAvatar"/>
< 			<MkButton primary rounded class="avatarEdit" @click="changeAvatar">{{ i18n.ts._profile.changeAvatar }}</MkButton>
< 		</div>
< 		<MkButton primary rounded class="bannerEdit" @click="changeBanner">{{ i18n.ts._profile.changeBanner }}</MkButton>
< 	</div>
---
>   <div class="_formRoot">
>     <div
>       class="llvierxe"
>       :style="{ backgroundImage: $i.bannerUrl ? `url(${$i.bannerUrl})` : null }"
>     >
>       <div class="avatar">
>         <MkAvatar
>           class="avatar"
>           :user="$i"
>           :disable-link="true"
>           @click="changeAvatar"
>         />
>         <MkButton primary rounded class="avatarEdit" @click="changeAvatar">{{
>           i18n.ts._profile.changeAvatar
>         }}</MkButton>
>       </div>
>       <MkButton primary rounded class="bannerEdit" @click="changeBanner">{{
>         i18n.ts._profile.changeBanner
>       }}</MkButton>
>     </div>
11,13c23,25
< 	<MkInput v-model="profile.name" :max="30" manual-save>
< 		<template #label>{{ i18n.ts._profile.name }}</template>
< 	</MkInput>
---
>     <FormInput v-model="profile.name" :max="30" manual-save class="_formBlock">
>       <template #label>{{ i18n.ts._profile.name }}</template>
>     </FormInput>
15,18c27,36
< 	<MkTextarea v-model="profile.description" :max="500" tall manual-save>
< 		<template #label>{{ i18n.ts._profile.description }}</template>
< 		<template #caption>{{ i18n.ts._profile.youCanIncludeHashtags }}</template>
< 	</MkTextarea>
---
>     <FormTextarea
>       v-model="profile.description"
>       :max="500"
>       tall
>       manual-save
>       class="_formBlock"
>     >
>       <template #label>{{ i18n.ts._profile.description }}</template>
>       <template #caption>{{ i18n.ts._profile.youCanIncludeHashtags }}</template>
>     </FormTextarea>
20,23c38,41
< 	<MkInput v-model="profile.location" manual-save>
< 		<template #label>{{ i18n.ts.location }}</template>
< 		<template #prefix><i class="ti ti-map-pin"></i></template>
< 	</MkInput>
---
>     <FormInput v-model="profile.location" manual-save class="_formBlock">
>       <template #label>{{ i18n.ts.location }}</template>
>       <template #prefix><i class="fas fa-map-marker-alt"></i></template>
>     </FormInput>
25,28c43,51
< 	<MkInput v-model="profile.birthday" type="date" manual-save>
< 		<template #label>{{ i18n.ts.birthday }}</template>
< 		<template #prefix><i class="ti ti-cake"></i></template>
< 	</MkInput>
---
>     <FormInput
>       v-model="profile.birthday"
>       type="date"
>       manual-save
>       class="_formBlock"
>     >
>       <template #label>{{ i18n.ts.birthday }}</template>
>       <template #prefix><i class="fas fa-birthday-cake"></i></template>
>     </FormInput>
30,33c53,58
< 	<MkSelect v-model="profile.lang">
< 		<template #label>{{ i18n.ts.language }}</template>
< 		<option v-for="x in Object.keys(langmap)" :key="x" :value="x">{{ langmap[x].nativeName }}</option>
< 	</MkSelect>
---
>     <FormSelect v-model="profile.lang" class="_formBlock">
>       <template #label>{{ i18n.ts.language }}</template>
>       <option v-for="x in Object.keys(langmap)" :key="x" :value="x">
>         {{ langmap[x].nativeName }}
>       </option>
>     </FormSelect>
35,38c60,63
< 	<FormSlot>
< 		<MkFolder>
< 			<template #icon><i class="ti ti-list"></i></template>
< 			<template #label>{{ i18n.ts._profile.metadataEdit }}</template>
---
>     <FormSlot class="_formBlock">
>       <FormFolder>
>         <template #icon><i class="fas fa-table-list"></i></template>
>         <template #label>{{ i18n.ts._profile.metadataEdit }}</template>
40,56c65,95
< 			<div class="_gaps_m">
< 				<FormSplit v-for="(record, i) in fields" :min-width="250">
< 					<MkInput v-model="record.name" small>
< 						<template #label>{{ i18n.ts._profile.metadataLabel }} #{{ i + 1 }}</template>
< 					</MkInput>
< 					<MkInput v-model="record.value" small>
< 						<template #label>{{ i18n.ts._profile.metadataContent }} #{{ i + 1 }}</template>
< 					</MkInput>
< 				</FormSplit>
< 				<div>
< 					<MkButton :disabled="fields.length >= 16" inline style="margin-right: 8px;" @click="addField"><i class="ti ti-plus"></i> {{ i18n.ts.add }}</MkButton>
< 					<MkButton inline primary @click="saveFields"><i class="ti ti-check"></i> {{ i18n.ts.save }}</MkButton>
< 				</div>
< 			</div>
< 		</MkFolder>
< 		<template #caption>{{ i18n.ts._profile.metadataDescription }}</template>
< 	</FormSlot>
---
>         <div class="_formRoot">
>           <FormSplit
>             v-for="(record, i) in fields"
>             :min-width="250"
>             class="_formBlock"
>           >
>             <FormInput v-model="record.name" small>
>               <template #label
>                 >{{ i18n.ts._profile.metadataLabel }} #{{ i + 1 }}</template
>               >
>             </FormInput>
>             <FormInput v-model="record.value" small>
>               <template #label
>                 >{{ i18n.ts._profile.metadataContent }} #{{ i + 1 }}</template
>               >
>             </FormInput>
>           </FormSplit>
>           <MkButton
>             :disabled="fields.length >= 16"
>             inline
>             style="margin-right: 8px"
>             @click="addField"
>             ><i class="fas fa-plus"></i> {{ i18n.ts.add }}</MkButton
>           >
>           <MkButton inline primary @click="saveFields"
>             ><i class="fas fa-check"></i> {{ i18n.ts.save }}</MkButton
>           >
>         </div>
>       </FormFolder>
>       <template #caption>{{ i18n.ts._profile.metadataDescription }}</template>
>     </FormSlot>
58,68c97,116
< 	<MkFolder>
< 		<template #label>{{ i18n.ts.advancedSettings }}</template>
< 
< 		<div class="_gaps_m">
< 			<MkSwitch v-model="profile.isCat">{{ i18n.ts.flagAsCat }}<template #caption>{{ i18n.ts.flagAsCatDescription }}</template></MkSwitch>
< 			<MkSwitch v-model="profile.isBot">{{ i18n.ts.flagAsBot }}<template #caption>{{ i18n.ts.flagAsBotDescription }}</template></MkSwitch>
< 		</div>
< 	</MkFolder>
< 
< 	<MkSwitch v-model="profile.showTimelineReplies">{{ i18n.ts.flagShowTimelineReplies }}<template #caption>{{ i18n.ts.flagShowTimelineRepliesDescription }} {{ i18n.ts.reflectMayTakeTime }}</template></MkSwitch>
< </div>
---
>     <FormSwitch v-model="profile.isCat" class="_formBlock"
>       >{{ i18n.ts.flagAsCat
>       }}<template #caption>{{
>         i18n.ts.flagAsCatDescription
>       }}</template></FormSwitch
>     >
>     <FormSwitch v-model="profile.showTimelineReplies" class="_formBlock"
>       >{{ i18n.ts.flagShowTimelineReplies
>       }}<template #caption
>         >{{ i18n.ts.flagShowTimelineRepliesDescription }}
>         {{ i18n.ts.reflectMayTakeTime }}</template
>       ></FormSwitch
>     >
>     <FormSwitch v-model="profile.isBot" class="_formBlock"
>       >{{ i18n.ts.flagAsBot
>       }}<template #caption>{{
>         i18n.ts.flagAsBotDescription
>       }}</template></FormSwitch
>     >
>   </div>
72,88c120,135
< import { reactive, watch } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import FormSplit from '@/components/form/split.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import FormSlot from '@/components/form/slot.vue';
< import { host } from '@/config';
< import { selectFile } from '@/scripts/select-file';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
< import { langmap } from '@/scripts/langmap';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { claimAchievement } from '@/scripts/achievements';
---
> import { reactive, watch } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import FormInput from "@/components/form/input.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSelect from "@/components/form/select.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormFolder from "@/components/form/folder.vue";
> import FormSlot from "@/components/form/slot.vue";
> import { host } from "@/config";
> import { selectFile } from "@/scripts/select-file";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
> import { langmap } from "@/scripts/langmap";
> import { definePageMetadata } from "@/scripts/page-metadata";
91,98c138,145
< 	name: $i.name,
< 	description: $i.description,
< 	location: $i.location,
< 	birthday: $i.birthday,
< 	lang: $i.lang,
< 	isBot: $i.isBot,
< 	isCat: $i.isCat,
< 	showTimelineReplies: $i.showTimelineReplies,
---
>   name: $i.name,
>   description: $i.description,
>   location: $i.location,
>   birthday: $i.birthday,
>   lang: $i.lang,
>   isBot: $i.isBot,
>   isCat: $i.isCat,
>   showTimelineReplies: $i.showTimelineReplies,
101,105c148,156
< watch(() => profile, () => {
< 	save();
< }, {
< 	deep: true,
< });
---
> watch(
>   () => profile,
>   () => {
>     save();
>   },
>   {
>     deep: true,
>   }
> );
107c158,160
< const fields = reactive($i.fields.map(field => ({ name: field.name, value: field.value })));
---
> const fields = reactive(
>   $i.fields.map((field) => ({ name: field.name, value: field.value }))
> );
110,113c163,166
< 	fields.push({
< 		name: '',
< 		value: '',
< 	});
---
>   fields.push({
>     name: "",
>     value: "",
>   });
117c170
< 	addField();
---
>   addField();
121,123c174,176
< 	os.apiWithDialog('i/update', {
< 		fields: fields.filter(field => field.name !== '' && field.value !== ''),
< 	});
---
>   os.apiWithDialog("i/update", {
>     fields: fields.filter((field) => field.name !== "" && field.value !== ""),
>   });
127,143c180,189
< 	os.apiWithDialog('i/update', {
< 		name: profile.name || null,
< 		description: profile.description || null,
< 		location: profile.location || null,
< 		birthday: profile.birthday || null,
< 		lang: profile.lang || null,
< 		isBot: !!profile.isBot,
< 		isCat: !!profile.isCat,
< 		showTimelineReplies: !!profile.showTimelineReplies,
< 	});
< 	claimAchievement('profileFilled');
< 	if (profile.name === 'syuilo' || profile.name === 'しゅいろ') {
< 		claimAchievement('setNameToSyuilo');
< 	}
< 	if (profile.isCat) {
< 		claimAchievement('markedAsCat');
< 	}
---
>   os.apiWithDialog("i/update", {
>     name: profile.name || null,
>     description: profile.description || null,
>     location: profile.location || null,
>     birthday: profile.birthday || null,
>     lang: profile.lang || null,
>     isBot: !!profile.isBot,
>     isCat: !!profile.isCat,
>     showTimelineReplies: !!profile.showTimelineReplies,
>   });
147,148c193,195
< 	selectFile(ev.currentTarget ?? ev.target, i18n.ts.avatar).then(async (file) => {
< 		let originalOrCropped = file;
---
>   selectFile(ev.currentTarget ?? ev.target, i18n.ts.avatar).then(
>     async (file) => {
>       let originalOrCropped = file;
150,153c197,200
< 		const { canceled } = await os.confirm({
< 			type: 'question',
< 			text: i18n.t('cropImageAsk'),
< 		});
---
>       const { canceled } = await os.confirm({
>         type: "question",
>         text: i18n.t("cropImageAsk"),
>       });
155,159c202,206
< 		if (!canceled) {
< 			originalOrCropped = await os.cropImage(file, {
< 				aspectRatio: 1,
< 			});
< 		}
---
>       if (!canceled) {
>         originalOrCropped = await os.cropImage(file, {
>           aspectRatio: 1,
>         });
>       }
161,167c208,214
< 		const i = await os.apiWithDialog('i/update', {
< 			avatarId: originalOrCropped.id,
< 		});
< 		$i.avatarId = i.avatarId;
< 		$i.avatarUrl = i.avatarUrl;
< 		claimAchievement('profileFilled');
< 	});
---
>       const i = await os.apiWithDialog("i/update", {
>         avatarId: originalOrCropped.id,
>       });
>       $i.avatarId = i.avatarId;
>       $i.avatarUrl = i.avatarUrl;
>     }
>   );
171,172c218,220
< 	selectFile(ev.currentTarget ?? ev.target, i18n.ts.banner).then(async (file) => {
< 		let originalOrCropped = file;
---
>   selectFile(ev.currentTarget ?? ev.target, i18n.ts.banner).then(
>     async (file) => {
>       let originalOrCropped = file;
174,177c222,225
< 		const { canceled } = await os.confirm({
< 			type: 'question',
< 			text: i18n.t('cropImageAsk'),
< 		});
---
>       const { canceled } = await os.confirm({
>         type: "question",
>         text: i18n.t("cropImageAsk"),
>       });
179,183c227,231
< 		if (!canceled) {
< 			originalOrCropped = await os.cropImage(file, {
< 				aspectRatio: 2,
< 			});
< 		}
---
>       if (!canceled) {
>         originalOrCropped = await os.cropImage(file, {
>           aspectRatio: 2,
>         });
>       }
185,190c233,239
< 		const i = await os.apiWithDialog('i/update', {
< 			bannerId: originalOrCropped.id,
< 		});
< 		$i.bannerId = i.bannerId;
< 		$i.bannerUrl = i.bannerUrl;
< 	});
---
>       const i = await os.apiWithDialog("i/update", {
>         bannerId: originalOrCropped.id,
>       });
>       $i.bannerId = i.bannerId;
>       $i.bannerUrl = i.bannerUrl;
>     }
>   );
198,199c247,248
< 	title: i18n.ts.profile,
< 	icon: 'ti ti-user',
---
>   title: i18n.ts.profile,
>   icon: "fas fa-user",
205,210c254,259
< 	position: relative;
< 	background-size: cover;
< 	background-position: center;
< 	border: solid 1px var(--divider);
< 	border-radius: 10px;
< 	overflow: clip;
---
>   position: relative;
>   background-size: cover;
>   background-position: center;
>   border: solid 1px var(--divider);
>   border-radius: 10px;
>   overflow: clip;
212,215c261,264
< 	> .avatar {
< 		display: inline-block;
< 		text-align: center;
< 		padding: 16px;
---
>   > .avatar {
>     display: inline-block;
>     text-align: center;
>     padding: 16px;
217,223c266,272
< 		> .avatar {
< 			display: inline-block;
< 			width: 72px;
< 			height: 72px;
< 			margin: 0 auto 16px auto;
< 		}
< 	}
---
>     > .avatar {
>       display: inline-block;
>       width: 72px;
>       height: 72px;
>       margin: 0 auto 16px auto;
>     }
>   }
225,229c274,278
< 	> .bannerEdit {
< 		position: absolute;
< 		top: 16px;
< 		right: 16px;
< 	}
---
>   > .bannerEdit {
>     position: absolute;
>     top: 16px;
>     right: 16px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/reaction.vue RiricaV13/pages/settings/reaction.vue
2,18c2,32
< <div class="_gaps_m">
< 	<FromSlot>
< 		<template #label>{{ i18n.ts.reactionSettingDescription }}</template>
< 		<div v-panel style="border-radius: 6px;">
< 			<Sortable v-model="reactions" class="zoaiodol" :item-key="item => item" :animation="150" :delay="100" :delay-on-touch-only="true">
< 				<template #item="{element}">
< 					<button class="_button item" @click="remove(element, $event)">
< 						<MkEmoji :emoji="element" :normal="true"/>
< 					</button>
< 				</template>
< 				<template #footer>
< 					<button class="_button add" @click="chooseEmoji"><i class="ti ti-plus"></i></button>
< 				</template>
< 			</Sortable>
< 		</div>
< 		<template #caption>{{ i18n.ts.reactionSettingDescription2 }} <button class="_textButton" @click="preview">{{ i18n.ts.preview }}</button></template>
< 	</FromSlot>
---
>   <div class="_formRoot">
>     <FromSlot class="_formBlock">
>       <template #label>{{ i18n.ts.reactionSettingDescription }}</template>
>       <div v-panel style="border-radius: 6px">
>         <XDraggable
>           v-model="reactions"
>           class="zoaiodol"
>           :item-key="(item) => item"
>           animation="150"
>           delay="100"
>           delay-on-touch-only="true"
>         >
>           <template #item="{ element }">
>             <button class="_button item" @click="remove(element, $event)">
>               <MkEmoji :emoji="element" :normal="true" />
>             </button>
>           </template>
>           <template #footer>
>             <button class="_button add" @click="chooseEmoji">
>               <i class="fas fa-plus"></i>
>             </button>
>           </template>
>         </XDraggable>
>       </div>
>       <template #caption
>         >{{ i18n.ts.reactionSettingDescription2 }}
>         <button class="_textButton" @click="preview">
>           {{ i18n.ts.preview }}
>         </button></template
>       >
>     </FromSlot>
20,40c34,54
< 	<MkRadios v-model="reactionPickerSize">
< 		<template #label>{{ i18n.ts.size }}</template>
< 		<option :value="1">{{ i18n.ts.small }}</option>
< 		<option :value="2">{{ i18n.ts.medium }}</option>
< 		<option :value="3">{{ i18n.ts.large }}</option>
< 	</MkRadios>
< 	<MkRadios v-model="reactionPickerWidth">
< 		<template #label>{{ i18n.ts.numberOfColumn }}</template>
< 		<option :value="1">5</option>
< 		<option :value="2">6</option>
< 		<option :value="3">7</option>
< 		<option :value="4">8</option>
< 		<option :value="5">9</option>
< 	</MkRadios>
< 	<MkRadios v-model="reactionPickerHeight">
< 		<template #label>{{ i18n.ts.height }}</template>
< 		<option :value="1">{{ i18n.ts.small }}</option>
< 		<option :value="2">{{ i18n.ts.medium }}</option>
< 		<option :value="3">{{ i18n.ts.large }}</option>
< 		<option :value="4">{{ i18n.ts.large }}+</option>
< 	</MkRadios>
---
>     <FormRadios v-model="reactionPickerSize" class="_formBlock">
>       <template #label>{{ i18n.ts.size }}</template>
>       <option :value="1">{{ i18n.ts.small }}</option>
>       <option :value="2">{{ i18n.ts.medium }}</option>
>       <option :value="3">{{ i18n.ts.large }}</option>
>     </FormRadios>
>     <FormRadios v-model="reactionPickerWidth" class="_formBlock">
>       <template #label>{{ i18n.ts.numberOfColumn }}</template>
>       <option :value="1">5</option>
>       <option :value="2">6</option>
>       <option :value="3">7</option>
>       <option :value="4">8</option>
>       <option :value="5">9</option>
>     </FormRadios>
>     <FormRadios v-model="reactionPickerHeight" class="_formBlock">
>       <template #label>{{ i18n.ts.height }}</template>
>       <option :value="1">{{ i18n.ts.small }}</option>
>       <option :value="2">{{ i18n.ts.medium }}</option>
>       <option :value="3">{{ i18n.ts.large }}</option>
>       <option :value="4">{{ i18n.ts.large }}+</option>
>     </FormRadios>
42,45c56,59
< 	<MkSwitch v-model="reactionPickerUseDrawerForMobile">
< 		{{ i18n.ts.useDrawerReactionPickerForMobile }}
< 		<template #caption>{{ i18n.ts.needReloadToApply }}</template>
< 	</MkSwitch>
---
>     <FormSwitch v-model="reactionPickerUseDrawerForMobile" class="_formBlock">
>       {{ i18n.ts.useDrawerReactionPickerForMobile }}
>       <template #caption>{{ i18n.ts.needReloadToApply }}</template>
>     </FormSwitch>
47,53c61,71
< 	<FormSection>
< 		<div class="_buttons">
< 			<MkButton inline @click="preview"><i class="ti ti-eye"></i> {{ i18n.ts.preview }}</MkButton>
< 			<MkButton inline danger @click="setDefault"><i class="ti ti-reload"></i> {{ i18n.ts.default }}</MkButton>
< 		</div>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <div style="display: flex; gap: var(--margin); flex-wrap: wrap">
>         <FormButton inline @click="preview"
>           ><i class="fas fa-eye"></i> {{ i18n.ts.preview }}</FormButton
>         >
>         <FormButton inline danger @click="setDefault"
>           ><i class="fas fa-undo"></i> {{ i18n.ts.default }}</FormButton
>         >
>       </div>
>     </FormSection>
>   </div>
57,69c75,87
< import { defineAsyncComponent, watch } from 'vue';
< import Sortable from 'vuedraggable';
< import MkInput from '@/components/MkInput.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import FromSlot from '@/components/form/slot.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormSection from '@/components/form/section.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { deepClone } from '@/scripts/clone';
---
> import { defineAsyncComponent, watch } from "vue";
> import XDraggable from "vuedraggable";
> import FormInput from "@/components/form/input.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FromSlot from "@/components/form/slot.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { deepClone } from "@/scripts/clone";
73,76c91,102
< const reactionPickerSize = $computed(defaultStore.makeGetterSetter('reactionPickerSize'));
< const reactionPickerWidth = $computed(defaultStore.makeGetterSetter('reactionPickerWidth'));
< const reactionPickerHeight = $computed(defaultStore.makeGetterSetter('reactionPickerHeight'));
< const reactionPickerUseDrawerForMobile = $computed(defaultStore.makeGetterSetter('reactionPickerUseDrawerForMobile'));
---
> const reactionPickerSize = $computed(
>   defaultStore.makeGetterSetter("reactionPickerSize")
> );
> const reactionPickerWidth = $computed(
>   defaultStore.makeGetterSetter("reactionPickerWidth")
> );
> const reactionPickerHeight = $computed(
>   defaultStore.makeGetterSetter("reactionPickerHeight")
> );
> const reactionPickerUseDrawerForMobile = $computed(
>   defaultStore.makeGetterSetter("reactionPickerUseDrawerForMobile")
> );
79c105
< 	defaultStore.set('reactions', reactions);
---
>   defaultStore.set("reactions", reactions);
83,88c109,119
< 	os.popupMenu([{
< 		text: i18n.ts.remove,
< 		action: () => {
< 			reactions = reactions.filter(x => x !== reaction);
< 		},
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.remove,
>         action: () => {
>           reactions = reactions.filter((x) => x !== reaction);
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
92,95c123,131
< 	os.popup(defineAsyncComponent(() => import('@/components/MkEmojiPickerDialog.vue')), {
< 		asReactionPicker: true,
< 		src: ev.currentTarget ?? ev.target,
< 	}, {}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkEmojiPickerDialog.vue")),
>     {
>       asReactionPicker: true,
>       src: ev.currentTarget ?? ev.target,
>     },
>     {},
>     "closed"
>   );
99,103c135,139
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.resetAreYouSure,
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.ts.resetAreYouSure,
>   });
>   if (canceled) return;
105c141
< 	reactions = deepClone(defaultStore.def.reactions.default);
---
>   reactions = deepClone(defaultStore.def.reactions.default);
109,115c145,151
< 	os.pickEmoji(ev.currentTarget ?? ev.target, {
< 		showPinned: false,
< 	}).then(emoji => {
< 		if (!reactions.includes(emoji)) {
< 			reactions.push(emoji);
< 		}
< 	});
---
>   os.pickEmoji(ev.currentTarget ?? ev.target, {
>     showPinned: false,
>   }).then((emoji) => {
>     if (!reactions.includes(emoji)) {
>       reactions.push(emoji);
>     }
>   });
118,122c154,162
< watch($$(reactions), () => {
< 	save();
< }, {
< 	deep: true,
< });
---
> watch(
>   $$(reactions),
>   () => {
>     save();
>   },
>   {
>     deep: true,
>   }
> );
129,134c169,174
< 	title: i18n.ts.reaction,
< 	icon: 'ti ti-mood-happy',
< 	action: {
< 		icon: 'ti ti-eye',
< 		handler: preview,
< 	},
---
>   title: i18n.ts.reaction,
>   icon: "fas fa-laugh",
>   action: {
>     icon: "fas fa-eye",
>     handler: preview,
>   },
140,141c180,181
< 	padding: 12px;
< 	font-size: 1.1em;
---
>   padding: 12px;
>   font-size: 1.1em;
143,147c183,187
< 	> .item {
< 		display: inline-block;
< 		padding: 8px;
< 		cursor: move;
< 	}
---
>   > .item {
>     display: inline-block;
>     padding: 8px;
>     cursor: move;
>   }
149,152c189,192
< 	> .add {
< 		display: inline-block;
< 		padding: 8px;
< 	}
---
>   > .add {
>     display: inline-block;
>     padding: 8px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/security.vue RiricaV13/pages/settings/security.vue
2,6c2,8
< <div class="_gaps_m">
< 	<FormSection first>
< 		<template #label>{{ i18n.ts.password }}</template>
< 		<MkButton primary @click="change()">{{ i18n.ts.changePassword }}</MkButton>
< 	</FormSection>
---
>   <div class="_formRoot">
>     <FormSection>
>       <template #label>{{ i18n.ts.password }}</template>
>       <FormButton primary @click="change()">{{
>         i18n.ts.changePassword
>       }}</FormButton>
>     </FormSection>
8,29c10,13
< 	<FormSection>
< 		<template #label>{{ i18n.ts.twoStepAuthentication }}</template>
< 		<X2fa/>
< 	</FormSection>
< 	
< 	<FormSection>
< 		<template #label>{{ i18n.ts.signinHistory }}</template>
< 		<MkPagination :pagination="pagination" disable-auto-load>
< 			<template #default="{items}">
< 				<div>
< 					<div v-for="item in items" :key="item.id" v-panel class="timnmucd">
< 						<header>
< 							<i v-if="item.success" class="ti ti-check icon succ"></i>
< 							<i v-else class="ti ti-circle-x icon fail"></i>
< 							<code class="ip _monospace">{{ item.ip }}</code>
< 							<MkTime :time="item.createdAt" class="time"/>
< 						</header>
< 					</div>
< 				</div>
< 			</template>
< 		</MkPagination>
< 	</FormSection>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.twoStepAuthentication }}</template>
>       <X2fa />
>     </FormSection>
31,37c15,44
< 	<FormSection>
< 		<FormSlot>
< 			<MkButton danger @click="regenerateToken"><i class="ti ti-refresh"></i> {{ i18n.ts.regenerateLoginToken }}</MkButton>
< 			<template #caption>{{ i18n.ts.regenerateLoginTokenDescription }}</template>
< 		</FormSlot>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.signinHistory }}</template>
>       <MkPagination :pagination="pagination" disable-auto-load>
>         <template #default="{ items }">
>           <div>
>             <div v-for="item in items" :key="item.id" v-panel class="timnmucd">
>               <header>
>                 <i v-if="item.success" class="fas fa-check icon succ"></i>
>                 <i v-else class="fas fa-times-circle icon fail"></i>
>                 <code class="ip _monospace">{{ item.ip }}</code>
>                 <MkTime :time="item.createdAt" class="time" />
>               </header>
>             </div>
>           </div>
>         </template>
>       </MkPagination>
>     </FormSection>
> 
>     <FormSection>
>       <FormSlot>
>         <FormButton danger @click="regenerateToken"
>           ><i class="fas fa-sync-alt"></i>
>           {{ i18n.ts.regenerateLoginToken }}</FormButton
>         >
>         <template #caption>{{
>           i18n.ts.regenerateLoginTokenDescription
>         }}</template>
>       </FormSlot>
>     </FormSection>
>   </div>
41,48c48,55
< import X2fa from './2fa.vue';
< import FormSection from '@/components/form/section.vue';
< import FormSlot from '@/components/form/slot.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkPagination from '@/components/MkPagination.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import X2fa from "./2fa.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSlot from "@/components/form/slot.vue";
> import FormButton from "@/components/MkButton.vue";
> import MkPagination from "@/components/MkPagination.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
51,52c58,59
< 	endpoint: 'i/signin-history' as const,
< 	limit: 5,
---
>   endpoint: "i/signin-history" as const,
>   limit: 5,
56,60c63,67
< 	const { canceled: canceled1, result: currentPassword } = await os.inputText({
< 		title: i18n.ts.currentPassword,
< 		type: 'password',
< 	});
< 	if (canceled1) return;
---
>   const { canceled: canceled1, result: currentPassword } = await os.inputText({
>     title: i18n.ts.currentPassword,
>     type: "password",
>   });
>   if (canceled1) return;
62,66c69,73
< 	const { canceled: canceled2, result: newPassword } = await os.inputText({
< 		title: i18n.ts.newPassword,
< 		type: 'password',
< 	});
< 	if (canceled2) return;
---
>   const { canceled: canceled2, result: newPassword } = await os.inputText({
>     title: i18n.ts.newPassword,
>     type: "password",
>   });
>   if (canceled2) return;
68,72c75,79
< 	const { canceled: canceled3, result: newPassword2 } = await os.inputText({
< 		title: i18n.ts.newPasswordRetype,
< 		type: 'password',
< 	});
< 	if (canceled3) return;
---
>   const { canceled: canceled3, result: newPassword2 } = await os.inputText({
>     title: i18n.ts.newPasswordRetype,
>     type: "password",
>   });
>   if (canceled3) return;
74,85c81,92
< 	if (newPassword !== newPassword2) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.retypedNotMatch,
< 		});
< 		return;
< 	}
< 	
< 	os.apiWithDialog('i/change-password', {
< 		currentPassword,
< 		newPassword,
< 	});
---
>   if (newPassword !== newPassword2) {
>     os.alert({
>       type: "error",
>       text: i18n.ts.retypedNotMatch,
>     });
>     return;
>   }
> 
>   os.apiWithDialog("i/change-password", {
>     currentPassword,
>     newPassword,
>   });
89,97c96,104
< 	os.inputText({
< 		title: i18n.ts.password,
< 		type: 'password',
< 	}).then(({ canceled, result: password }) => {
< 		if (canceled) return;
< 		os.api('i/regenerate_token', {
< 			password: password,
< 		});
< 	});
---
>   os.inputText({
>     title: i18n.ts.password,
>     type: "password",
>   }).then(({ canceled, result: password }) => {
>     if (canceled) return;
>     os.api("i/regenerate_token", {
>       password: password,
>     });
>   });
105,106c112,113
< 	title: i18n.ts.security,
< 	icon: 'ti ti-lock',
---
>   title: i18n.ts.security,
>   icon: "fas fa-lock",
112c119
< 	padding: 16px;
---
>   padding: 16px;
114,117c121,124
< 	&:first-child {
< 		border-top-left-radius: 6px;
< 		border-top-right-radius: 6px;
< 	}
---
>   &:first-child {
>     border-top-left-radius: 6px;
>     border-top-right-radius: 6px;
>   }
119,122c126,129
< 	&:last-child {
< 		border-bottom-left-radius: 6px;
< 		border-bottom-right-radius: 6px;
< 	}
---
>   &:last-child {
>     border-bottom-left-radius: 6px;
>     border-bottom-right-radius: 6px;
>   }
124,126c131,133
< 	&:not(:last-child) {
< 		border-bottom: solid 0.5px var(--divider);
< 	}
---
>   &:not(:last-child) {
>     border-bottom: solid 0.5px var(--divider);
>   }
128,130c135,137
< 	> header {
< 		display: flex;
< 		align-items: center;
---
>   > header {
>     display: flex;
>     align-items: center;
132,134c139,141
< 		> .icon {
< 			width: 1em;
< 			margin-right: 0.75em;
---
>     > .icon {
>       width: 1em;
>       margin-right: 0.75em;
136,138c143,145
< 			&.succ {
< 				color: var(--success);
< 			}
---
>       &.succ {
>         color: var(--success);
>       }
140,143c147,150
< 			&.fail {
< 				color: var(--error);
< 			}
< 		}
---
>       &.fail {
>         color: var(--error);
>       }
>     }
145,152c152,159
< 		> .ip {
< 			flex: 1;
< 			min-width: 0;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			margin-right: 12px;
< 		}
---
>     > .ip {
>       flex: 1;
>       min-width: 0;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       margin-right: 12px;
>     }
154,158c161,165
< 		> .time {
< 			margin-left: auto;
< 			opacity: 0.7;
< 		}
< 	}
---
>     > .time {
>       margin-left: auto;
>       opacity: 0.7;
>     }
>   }
Only in misskeyV13/packages/frontend/src/pages/settings: sounds.sound.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/sounds.vue RiricaV13/pages/settings/sounds.vue
2,5c2,12
< <div class="_gaps_m">
< 	<MkRange v-model="masterVolume" :min="0" :max="1" :step="0.05" :text-converter="(v) => `${Math.floor(v * 100)}%`">
< 		<template #label>{{ i18n.ts.masterVolume }}</template>
< 	</MkRange>
---
>   <div class="_formRoot">
>     <FormRange
>       v-model="masterVolume"
>       :min="0"
>       :max="1"
>       :step="0.05"
>       :text-converter="(v) => `${Math.floor(v * 100)}%`"
>       class="_formBlock"
>     >
>       <template #label>{{ i18n.ts.masterVolume }}</template>
>     </FormRange>
7,12c14,26
< 	<FormSection>
< 		<template #label>{{ i18n.ts.sounds }}</template>
< 		<div class="_gaps_s">
< 			<MkFolder v-for="type in Object.keys(sounds)" :key="type">
< 				<template #label>{{ $t('_sfx.' + type) }}</template>
< 				<template #suffix>{{ sounds[type].type ?? i18n.ts.none }}</template>
---
>     <FormSection>
>       <template #label>{{ i18n.ts.sounds }}</template>
>       <FormLink
>         v-for="type in Object.keys(sounds)"
>         :key="type"
>         style="margin-bottom: 8px"
>         @click="edit(type)"
>       >
>         {{ $t("_sfx." + type) }}
>         <template #suffix>{{ sounds[type].type || i18n.ts.none }}</template>
>         <template #suffixIcon><i class="fas fa-chevron-down"></i></template>
>       </FormLink>
>     </FormSection>
14,20c28,31
< 				<XSound :type="sounds[type].type" :volume="sounds[type].volume" @update="(res) => updated(type, res)"/>
< 			</MkFolder>
< 		</div>
< 	</FormSection>
< 
< 	<MkButton danger @click="reset()"><i class="ti ti-reload"></i> {{ i18n.ts.default }}</MkButton>
< </div>
---
>     <FormButton danger class="_formBlock" @click="reset()"
>       ><i class="fas fa-redo"></i> {{ i18n.ts.default }}</FormButton
>     >
>   </div>
24,35c35,44
< import { computed, ref } from 'vue';
< import XSound from './sounds.sound.vue';
< import MkRange from '@/components/MkRange.vue';
< import MkButton from '@/components/MkButton.vue';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import * as os from '@/os';
< import { ColdDeviceStorage } from '@/store';
< import { playFile } from '@/scripts/sound';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, ref } from "vue";
> import FormRange from "@/components/form/range.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import * as os from "@/os";
> import { ColdDeviceStorage } from "@/store";
> import { playFile } from "@/scripts/sound";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
38,43c47,52
< 	get: () => {
< 		return ColdDeviceStorage.get('sound_masterVolume');
< 	},
< 	set: (value) => {
< 		ColdDeviceStorage.set('sound_masterVolume', value);
< 	},
---
>   get: () => {
>     return ColdDeviceStorage.get("sound_masterVolume");
>   },
>   set: (value) => {
>     ColdDeviceStorage.set("sound_masterVolume", value);
>   },
46c55,57
< const volumeIcon = computed(() => masterVolume.value === 0 ? 'fas fa-volume-mute' : 'fas fa-volume-up');
---
> const volumeIcon = computed(() =>
>   masterVolume.value === 0 ? "fas fa-volume-mute" : "fas fa-volume-up"
> );
49,55c60,66
< 	note: ColdDeviceStorage.get('sound_note'),
< 	noteMy: ColdDeviceStorage.get('sound_noteMy'),
< 	notification: ColdDeviceStorage.get('sound_notification'),
< 	chat: ColdDeviceStorage.get('sound_chat'),
< 	chatBg: ColdDeviceStorage.get('sound_chatBg'),
< 	antenna: ColdDeviceStorage.get('sound_antenna'),
< 	channel: ColdDeviceStorage.get('sound_channel'),
---
>   note: ColdDeviceStorage.get("sound_note"),
>   noteMy: ColdDeviceStorage.get("sound_noteMy"),
>   notification: ColdDeviceStorage.get("sound_notification"),
>   chat: ColdDeviceStorage.get("sound_chat"),
>   chatBg: ColdDeviceStorage.get("sound_chatBg"),
>   antenna: ColdDeviceStorage.get("sound_antenna"),
>   channel: ColdDeviceStorage.get("sound_channel"),
58,62c69,94
< async function updated(type, sound) {
< 	const v = {
< 		type: sound.type,
< 		volume: sound.volume,
< 	};
---
> const soundsTypes = [
>   null,
>   "syuilo/up",
>   "syuilo/down",
>   "syuilo/pope1",
>   "syuilo/pope2",
>   "syuilo/waon",
>   "syuilo/popo",
>   "syuilo/triple",
>   "syuilo/poi1",
>   "syuilo/poi2",
>   "syuilo/pirori",
>   "syuilo/pirori-wet",
>   "syuilo/pirori-square-wet",
>   "syuilo/square-pico",
>   "syuilo/reverved",
>   "syuilo/ryukyu",
>   "syuilo/kick",
>   "syuilo/snare",
>   "syuilo/queue-jammed",
>   "aisha/1",
>   "aisha/2",
>   "aisha/3",
>   "noizenecio/kick_gaba",
>   "noizenecio/kick_gaba2",
> ];
64,65c96,132
< 	ColdDeviceStorage.set('sound_' + type, v);
< 	sounds.value[type] = v;
---
> async function edit(type) {
>   const { canceled, result } = await os.form(i18n.t("_sfx." + type), {
>     type: {
>       type: "enum",
>       enum: soundsTypes.map((x) => ({
>         value: x,
>         label: x == null ? i18n.ts.none : x,
>       })),
>       label: i18n.ts.sound,
>       default: sounds.value[type].type,
>     },
>     volume: {
>       type: "range",
>       min: 0,
>       max: 1,
>       step: 0.05,
>       textConverter: (v) => `${Math.floor(v * 100)}%`,
>       label: i18n.ts.volume,
>       default: sounds.value[type].volume,
>     },
>     listen: {
>       type: "button",
>       content: i18n.ts.listen,
>       action: (_, values) => {
>         playFile(values.type, values.volume);
>       },
>     },
>   });
>   if (canceled) return;
> 
>   const v = {
>     type: result.type,
>     volume: result.volume,
>   };
> 
>   ColdDeviceStorage.set("sound_" + type, v);
>   sounds.value[type] = v;
69,73c136,140
< 	for (const sound of Object.keys(sounds.value)) {
< 		const v = ColdDeviceStorage.default['sound_' + sound];
< 		ColdDeviceStorage.set('sound_' + sound, v);
< 		sounds.value[sound] = v;
< 	}
---
>   for (const sound of Object.keys(sounds.value)) {
>     const v = ColdDeviceStorage.default["sound_" + sound];
>     ColdDeviceStorage.set("sound_" + sound, v);
>     sounds.value[sound] = v;
>   }
81,82c148,149
< 	title: i18n.ts.sounds,
< 	icon: 'ti ti-music',
---
>   title: i18n.ts.sounds,
>   icon: "fas fa-music",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/statusbar.statusbar.vue RiricaV13/pages/settings/statusbar.statusbar.vue
2,8c2,12
< <div class="_gaps_m">
< 	<MkSelect v-model="statusbar.type" placeholder="Please select">
< 		<template #label>{{ i18n.ts.type }}</template>
< 		<option value="rss">RSS</option>
< 		<option value="federation">Federation</option>
< 		<option value="userList">User list timeline</option>
< 	</MkSelect>
---
>   <div class="_formRoot">
>     <FormSelect
>       v-model="statusbar.type"
>       placeholder="Please select"
>       class="_formBlock"
>     >
>       <template #label>{{ i18n.ts.type }}</template>
>       <option value="rss">RSS</option>
>       <option value="federation">Federation</option>
>       <option value="userList">User list timeline</option>
>     </FormSelect>
10,12c14,16
< 	<MkInput v-model="statusbar.name" manual-save>
< 		<template #label>{{ i18n.ts.label }}</template>
< 	</MkInput>
---
>     <MkInput v-model="statusbar.name" manual-save class="_formBlock">
>       <template #label>{{ i18n.ts.label }}</template>
>     </MkInput>
14,16c18,20
< 	<MkSwitch v-model="statusbar.black">
< 		<template #label>Black</template>
< 	</MkSwitch>
---
>     <MkSwitch v-model="statusbar.black" class="_formBlock">
>       <template #label>Black</template>
>     </MkSwitch>
18,25c22,29
< 	<MkRadios v-model="statusbar.size">
< 		<template #label>{{ i18n.ts.size }}</template>
< 		<option value="verySmall">{{ i18n.ts.small }}+</option>
< 		<option value="small">{{ i18n.ts.small }}</option>
< 		<option value="medium">{{ i18n.ts.medium }}</option>
< 		<option value="large">{{ i18n.ts.large }}</option>
< 		<option value="veryLarge">{{ i18n.ts.large }}+</option>
< 	</MkRadios>
---
>     <FormRadios v-model="statusbar.size" class="_formBlock">
>       <template #label>{{ i18n.ts.size }}</template>
>       <option value="verySmall">{{ i18n.ts.small }}+</option>
>       <option value="small">{{ i18n.ts.small }}</option>
>       <option value="medium">{{ i18n.ts.medium }}</option>
>       <option value="large">{{ i18n.ts.large }}</option>
>       <option value="veryLarge">{{ i18n.ts.large }}+</option>
>     </FormRadios>
27,75c31,125
< 	<template v-if="statusbar.type === 'rss'">
< 		<MkInput v-model="statusbar.props.url" manual-save type="url">
< 			<template #label>URL</template>
< 		</MkInput>
< 		<MkSwitch v-model="statusbar.props.shuffle">
< 			<template #label>{{ i18n.ts.shuffle }}</template>
< 		</MkSwitch>
< 		<MkInput v-model="statusbar.props.refreshIntervalSec" manual-save type="number">
< 			<template #label>{{ i18n.ts.refreshInterval }}</template>
< 		</MkInput>
< 		<MkRange v-model="statusbar.props.marqueeDuration" :min="5" :max="150" :step="1">
< 			<template #label>{{ i18n.ts.speed }}</template>
< 			<template #caption>{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template>
< 		</MkRange>
< 		<MkSwitch v-model="statusbar.props.marqueeReverse">
< 			<template #label>{{ i18n.ts.reverse }}</template>
< 		</MkSwitch>
< 	</template>
< 	<template v-else-if="statusbar.type === 'federation'">
< 		<MkInput v-model="statusbar.props.refreshIntervalSec" manual-save type="number">
< 			<template #label>{{ i18n.ts.refreshInterval }}</template>
< 		</MkInput>
< 		<MkRange v-model="statusbar.props.marqueeDuration" :min="5" :max="150" :step="1">
< 			<template #label>{{ i18n.ts.speed }}</template>
< 			<template #caption>{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template>
< 		</MkRange>
< 		<MkSwitch v-model="statusbar.props.marqueeReverse">
< 			<template #label>{{ i18n.ts.reverse }}</template>
< 		</MkSwitch>
< 		<MkSwitch v-model="statusbar.props.colored">
< 			<template #label>{{ i18n.ts.colored }}</template>
< 		</MkSwitch>
< 	</template>
< 	<template v-else-if="statusbar.type === 'userList' && userLists != null">
< 		<MkSelect v-model="statusbar.props.userListId">
< 			<template #label>{{ i18n.ts.userList }}</template>
< 			<option v-for="list in userLists" :value="list.id">{{ list.name }}</option>
< 		</MkSelect>
< 		<MkInput v-model="statusbar.props.refreshIntervalSec" manual-save type="number">
< 			<template #label>{{ i18n.ts.refreshInterval }}</template>
< 		</MkInput>
< 		<MkRange v-model="statusbar.props.marqueeDuration" :min="5" :max="150" :step="1">
< 			<template #label>{{ i18n.ts.speed }}</template>
< 			<template #caption>{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template>
< 		</MkRange>
< 		<MkSwitch v-model="statusbar.props.marqueeReverse">
< 			<template #label>{{ i18n.ts.reverse }}</template>
< 		</MkSwitch>
< 	</template>
---
>     <template v-if="statusbar.type === 'rss'">
>       <MkInput
>         v-model="statusbar.props.url"
>         manual-save
>         class="_formBlock"
>         type="url"
>       >
>         <template #label>URL</template>
>       </MkInput>
>       <MkSwitch v-model="statusbar.props.shuffle" class="_formBlock">
>         <template #label>{{ i18n.ts.shuffle }}</template>
>       </MkSwitch>
>       <MkInput
>         v-model="statusbar.props.refreshIntervalSec"
>         manual-save
>         class="_formBlock"
>         type="number"
>       >
>         <template #label>{{ i18n.ts.refreshInterval }}</template>
>       </MkInput>
>       <FormRange
>         v-model="statusbar.props.marqueeDuration"
>         :min="5"
>         :max="150"
>         :step="1"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.speed }}</template>
>         <template #caption
>           >{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template
>         >
>       </FormRange>
>       <MkSwitch v-model="statusbar.props.marqueeReverse" class="_formBlock">
>         <template #label>{{ i18n.ts.reverse }}</template>
>       </MkSwitch>
>     </template>
>     <template v-else-if="statusbar.type === 'federation'">
>       <MkInput
>         v-model="statusbar.props.refreshIntervalSec"
>         manual-save
>         class="_formBlock"
>         type="number"
>       >
>         <template #label>{{ i18n.ts.refreshInterval }}</template>
>       </MkInput>
>       <FormRange
>         v-model="statusbar.props.marqueeDuration"
>         :min="5"
>         :max="150"
>         :step="1"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.speed }}</template>
>         <template #caption
>           >{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template
>         >
>       </FormRange>
>       <MkSwitch v-model="statusbar.props.marqueeReverse" class="_formBlock">
>         <template #label>{{ i18n.ts.reverse }}</template>
>       </MkSwitch>
>       <MkSwitch v-model="statusbar.props.colored" class="_formBlock">
>         <template #label>{{ i18n.ts.colored }}</template>
>       </MkSwitch>
>     </template>
>     <template v-else-if="statusbar.type === 'userList' && userLists != null">
>       <FormSelect v-model="statusbar.props.userListId" class="_formBlock">
>         <template #label>{{ i18n.ts.userList }}</template>
>         <option v-for="list in userLists" :value="list.id">
>           {{ list.name }}
>         </option>
>       </FormSelect>
>       <MkInput
>         v-model="statusbar.props.refreshIntervalSec"
>         manual-save
>         class="_formBlock"
>         type="number"
>       >
>         <template #label>{{ i18n.ts.refreshInterval }}</template>
>       </MkInput>
>       <FormRange
>         v-model="statusbar.props.marqueeDuration"
>         :min="5"
>         :max="150"
>         :step="1"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.speed }}</template>
>         <template #caption
>           >{{ i18n.ts.fast }} &lt;-&gt; {{ i18n.ts.slow }}</template
>         >
>       </FormRange>
>       <MkSwitch v-model="statusbar.props.marqueeReverse" class="_formBlock">
>         <template #label>{{ i18n.ts.reverse }}</template>
>       </MkSwitch>
>     </template>
77,80c127,130
< 	<div class="_buttons">
< 		<MkButton danger @click="del">{{ i18n.ts.remove }}</MkButton>
< 	</div>
< </div>
---
>     <div style="display: flex; gap: var(--margin); flex-wrap: wrap">
>       <FormButton danger @click="del">{{ i18n.ts.remove }}</FormButton>
>     </div>
>   </div>
84,94c134,144
< import { computed, reactive, ref, watch } from 'vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkRange from '@/components/MkRange.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { deepClone } from '@/scripts/clone';
---
> import { computed, reactive, ref, watch } from "vue";
> import FormSelect from "@/components/form/select.vue";
> import MkInput from "@/components/form/input.vue";
> import MkSwitch from "@/components/form/switch.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormRange from "@/components/form/range.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { deepClone } from "@/scripts/clone";
97,98c147,148
< 	_id: string;
< 	userLists: any[] | null;
---
>   _id: string;
>   userLists: any[] | null;
101c151,153
< const statusbar = reactive(deepClone(defaultStore.state.statusbars.find(x => x.id === props._id)));
---
> const statusbar = reactive(
>   deepClone(defaultStore.state.statusbars.find((x) => x.id === props._id))
> );
103,126c155,181
< watch(() => statusbar.type, () => {
< 	if (statusbar.type === 'rss') {
< 		statusbar.name = 'NEWS';
< 		statusbar.props.url = 'http://feeds.afpbb.com/rss/afpbb/afpbbnews';
< 		statusbar.props.shuffle = true;
< 		statusbar.props.refreshIntervalSec = 120;
< 		statusbar.props.display = 'marquee';
< 		statusbar.props.marqueeDuration = 100;
< 		statusbar.props.marqueeReverse = false;
< 	} else if (statusbar.type === 'federation') {
< 		statusbar.name = 'FEDERATION';
< 		statusbar.props.refreshIntervalSec = 120;
< 		statusbar.props.display = 'marquee';
< 		statusbar.props.marqueeDuration = 100;
< 		statusbar.props.marqueeReverse = false;
< 		statusbar.props.colored = false;
< 	} else if (statusbar.type === 'userList') {
< 		statusbar.name = 'LIST TL';
< 		statusbar.props.refreshIntervalSec = 120;
< 		statusbar.props.display = 'marquee';
< 		statusbar.props.marqueeDuration = 100;
< 		statusbar.props.marqueeReverse = false;
< 	}
< });
---
> watch(
>   () => statusbar.type,
>   () => {
>     if (statusbar.type === "rss") {
>       statusbar.name = "NEWS";
>       statusbar.props.url = "http://feeds.afpbb.com/rss/afpbb/afpbbnews";
>       statusbar.props.shuffle = true;
>       statusbar.props.refreshIntervalSec = 120;
>       statusbar.props.display = "marquee";
>       statusbar.props.marqueeDuration = 100;
>       statusbar.props.marqueeReverse = false;
>     } else if (statusbar.type === "federation") {
>       statusbar.name = "FEDERATION";
>       statusbar.props.refreshIntervalSec = 120;
>       statusbar.props.display = "marquee";
>       statusbar.props.marqueeDuration = 100;
>       statusbar.props.marqueeReverse = false;
>       statusbar.props.colored = false;
>     } else if (statusbar.type === "userList") {
>       statusbar.name = "LIST TL";
>       statusbar.props.refreshIntervalSec = 120;
>       statusbar.props.display = "marquee";
>       statusbar.props.marqueeDuration = 100;
>       statusbar.props.marqueeReverse = false;
>     }
>   }
> );
131,134c186,189
< 	const i = defaultStore.state.statusbars.findIndex(x => x.id === props._id);
< 	const statusbars = deepClone(defaultStore.state.statusbars);
< 	statusbars[i] = deepClone(statusbar);
< 	defaultStore.set('statusbars', statusbars);
---
>   const i = defaultStore.state.statusbars.findIndex((x) => x.id === props._id);
>   const statusbars = deepClone(defaultStore.state.statusbars);
>   statusbars[i] = deepClone(statusbar);
>   defaultStore.set("statusbars", statusbars);
138c193,196
< 	defaultStore.set('statusbars', defaultStore.state.statusbars.filter(x => x.id !== props._id));
---
>   defaultStore.set(
>     "statusbars",
>     defaultStore.state.statusbars.filter((x) => x.id !== props._id)
>   );
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/statusbar.vue RiricaV13/pages/settings/statusbar.vue
2,9c2,9
< <div class="_gaps_m">
< 	<MkFolder v-for="x in statusbars" :key="x.id">
< 		<template #label>{{ x.type ?? i18n.ts.notSet }}</template>
< 		<template #suffix>{{ x.name }}</template>
< 		<XStatusbar :_id="x.id" :user-lists="userLists"/>
< 	</MkFolder>
< 	<MkButton primary @click="add">{{ i18n.ts.add }}</MkButton>
< </div>
---
>   <div class="_formRoot">
>     <FormFolder v-for="x in statusbars" :key="x.id" class="_formBlock">
>       <template #label>{{ x.type ?? i18n.ts.notSet }}</template>
>       <template #suffix>{{ x.name }}</template>
>       <XStatusbar :_id="x.id" :user-lists="userLists" />
>     </FormFolder>
>     <FormButton primary @click="add">{{ i18n.ts.add }}</FormButton>
>   </div>
13,23c13,23
< import { computed, onMounted, ref, watch } from 'vue';
< import { v4 as uuid } from 'uuid';
< import XStatusbar from './statusbar.statusbar.vue';
< import MkRadios from '@/components/MkRadios.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { unisonReload } from '@/scripts/unison-reload';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, onMounted, ref, watch } from "vue";
> import { v4 as uuid } from "uuid";
> import XStatusbar from "./statusbar.statusbar.vue";
> import FormRadios from "@/components/form/radios.vue";
> import FormFolder from "@/components/form/folder.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { unisonReload } from "@/scripts/unison-reload";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
30,32c30,32
< 	os.api('users/lists/list').then(res => {
< 		userLists = res;
< 	});
---
>   os.api("users/lists/list").then((res) => {
>     userLists = res;
>   });
36,42c36,42
< 	defaultStore.push('statusbars', {
< 		id: uuid(),
< 		type: null,
< 		black: false,
< 		size: 'medium',
< 		props: {},
< 	});
---
>   defaultStore.push("statusbars", {
>     id: uuid(),
>     type: null,
>     black: false,
>     size: "medium",
>     props: {},
>   });
50,52c50,52
< 	title: i18n.ts.statusbar,
< 	icon: 'ti ti-list',
< 	bg: 'var(--bg)',
---
>   title: i18n.ts.statusbar,
>   icon: "fas fa-list-ul",
>   bg: "var(--bg)",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/theme.install.vue RiricaV13/pages/settings/theme.install.vue
2,5c2,5
< <div class="_gaps_m">
< 	<MkTextarea v-model="installThemeCode">
< 		<template #label>{{ i18n.ts._theme.code }}</template>
< 	</MkTextarea>
---
>   <div class="_formRoot">
>     <FormTextarea v-model="installThemeCode" class="_formBlock">
>       <template #label>{{ i18n.ts._theme.code }}</template>
>     </FormTextarea>
7,11c7,25
< 	<div class="_buttons">
< 		<MkButton :disabled="installThemeCode == null" inline @click="() => preview(installThemeCode)"><i class="ti ti-eye"></i> {{ i18n.ts.preview }}</MkButton>
< 		<MkButton :disabled="installThemeCode == null" primary inline @click="() => install(installThemeCode)"><i class="ti ti-check"></i> {{ i18n.ts.install }}</MkButton>
< 	</div>
< </div>
---
>     <div
>       class="_formBlock"
>       style="display: flex; gap: var(--margin); flex-wrap: wrap"
>     >
>       <FormButton
>         :disabled="installThemeCode == null"
>         inline
>         @click="() => preview(installThemeCode)"
>         ><i class="fas fa-eye"></i> {{ i18n.ts.preview }}</FormButton
>       >
>       <FormButton
>         :disabled="installThemeCode == null"
>         primary
>         inline
>         @click="() => install(installThemeCode)"
>         ><i class="fas fa-check"></i> {{ i18n.ts.install }}</FormButton
>       >
>     </div>
>   </div>
15,23c29,37
< import { } from 'vue';
< import JSON5 from 'json5';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkButton from '@/components/MkButton.vue';
< import { applyTheme, validateTheme } from '@/scripts/theme';
< import * as os from '@/os';
< import { addTheme, getThemes } from '@/theme-store';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import JSON5 from "json5";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormButton from "@/components/MkButton.vue";
> import { applyTheme, validateTheme } from "@/scripts/theme";
> import * as os from "@/os";
> import { addTheme, getThemes } from "@/theme-store";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
28c42
< 	let theme;
---
>   let theme;
30,52c44,66
< 	try {
< 		theme = JSON5.parse(code);
< 	} catch (err) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts._theme.invalid,
< 		});
< 		return false;
< 	}
< 	if (!validateTheme(theme)) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts._theme.invalid,
< 		});
< 		return false;
< 	}
< 	if (getThemes().some(t => t.id === theme.id)) {
< 		os.alert({
< 			type: 'info',
< 			text: i18n.ts._theme.alreadyInstalled,
< 		});
< 		return false;
< 	}
---
>   try {
>     theme = JSON5.parse(code);
>   } catch (err) {
>     os.alert({
>       type: "error",
>       text: i18n.ts._theme.invalid,
>     });
>     return false;
>   }
>   if (!validateTheme(theme)) {
>     os.alert({
>       type: "error",
>       text: i18n.ts._theme.invalid,
>     });
>     return false;
>   }
>   if (getThemes().some((t) => t.id === theme.id)) {
>     os.alert({
>       type: "info",
>       text: i18n.ts._theme.alreadyInstalled,
>     });
>     return false;
>   }
54c68
< 	return theme;
---
>   return theme;
58,59c72,73
< 	const theme = parseThemeCode(code);
< 	if (theme) applyTheme(theme, false);
---
>   const theme = parseThemeCode(code);
>   if (theme) applyTheme(theme, false);
63,69c77,83
< 	const theme = parseThemeCode(code);
< 	if (!theme) return;
< 	await addTheme(theme);
< 	os.alert({
< 		type: 'success',
< 		text: i18n.t('_theme.installed', { name: theme.name }),
< 	});
---
>   const theme = parseThemeCode(code);
>   if (!theme) return;
>   await addTheme(theme);
>   os.alert({
>     type: "success",
>     text: i18n.t("_theme.installed", { name: theme.name }),
>   });
77,78c91,92
< 	title: i18n.ts._theme.install,
< 	icon: 'ti ti-download',
---
>   title: i18n.ts._theme.install,
>   icon: "fas fa-download",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/theme.manage.vue RiricaV13/pages/settings/theme.manage.vue
2,25c2,53
< <div class="_gaps_m">
< 	<MkSelect v-model="selectedThemeId">
< 		<template #label>{{ i18n.ts.theme }}</template>
< 		<optgroup :label="i18n.ts._theme.installedThemes">
< 			<option v-for="x in installedThemes" :key="x.id" :value="x.id">{{ x.name }}</option>
< 		</optgroup>
< 		<optgroup :label="i18n.ts._theme.builtinThemes">
< 			<option v-for="x in builtinThemes" :key="x.id" :value="x.id">{{ x.name }}</option>
< 		</optgroup>
< 	</MkSelect>
< 	<template v-if="selectedTheme">
< 		<MkInput readonly :model-value="selectedTheme.author">
< 			<template #label>{{ i18n.ts.author }}</template>
< 		</MkInput>
< 		<MkTextarea v-if="selectedTheme.desc" readonly :model-value="selectedTheme.desc">
< 			<template #label>{{ i18n.ts._theme.description }}</template>
< 		</MkTextarea>
< 		<MkTextarea readonly tall :model-value="selectedThemeCode">
< 			<template #label>{{ i18n.ts._theme.code }}</template>
< 			<template #caption><button class="_textButton" @click="copyThemeCode()">{{ i18n.ts.copy }}</button></template>
< 		</MkTextarea>
< 		<MkButton v-if="!builtinThemes.some(t => t.id == selectedTheme.id)" danger @click="uninstall()"><i class="ti ti-trash"></i> {{ i18n.ts.uninstall }}</MkButton>
< 	</template>
< </div>
---
>   <div class="_formRoot">
>     <FormSelect v-model="selectedThemeId" class="_formBlock">
>       <template #label>{{ i18n.ts.theme }}</template>
>       <optgroup :label="i18n.ts._theme.installedThemes">
>         <option v-for="x in installedThemes" :key="x.id" :value="x.id">
>           {{ x.name }}
>         </option>
>       </optgroup>
>       <optgroup :label="i18n.ts._theme.builtinThemes">
>         <option v-for="x in builtinThemes" :key="x.id" :value="x.id">
>           {{ x.name }}
>         </option>
>       </optgroup>
>     </FormSelect>
>     <template v-if="selectedTheme">
>       <FormInput
>         readonly
>         :model-value="selectedTheme.author"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts.author }}</template>
>       </FormInput>
>       <FormTextarea
>         v-if="selectedTheme.desc"
>         readonly
>         :model-value="selectedTheme.desc"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts._theme.description }}</template>
>       </FormTextarea>
>       <FormTextarea
>         readonly
>         tall
>         :model-value="selectedThemeCode"
>         class="_formBlock"
>       >
>         <template #label>{{ i18n.ts._theme.code }}</template>
>         <template #caption
>           ><button class="_textButton" @click="copyThemeCode()">
>             {{ i18n.ts.copy }}
>           </button></template
>         >
>       </FormTextarea>
>       <FormButton
>         v-if="!builtinThemes.some((t) => t.id == selectedTheme.id)"
>         class="_formBlock"
>         danger
>         @click="uninstall()"
>         ><i class="fas fa-trash-alt"></i> {{ i18n.ts.uninstall }}</FormButton
>       >
>     </template>
>   </div>
29,40c57,68
< import { computed, ref } from 'vue';
< import JSON5 from 'json5';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import MkInput from '@/components/MkInput.vue';
< import MkButton from '@/components/MkButton.vue';
< import { Theme, getBuiltinThemesRef } from '@/scripts/theme';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import * as os from '@/os';
< import { getThemes, removeTheme } from '@/theme-store';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed, ref } from "vue";
> import JSON5 from "json5";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSelect from "@/components/form/select.vue";
> import FormInput from "@/components/form/input.vue";
> import FormButton from "@/components/MkButton.vue";
> import { Theme, getBuiltinThemesRef } from "@/scripts/theme";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import * as os from "@/os";
> import { getThemes, removeTheme } from "@/theme-store";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
46c74,77
< const themes = computed(() => [...installedThemes.value, ...builtinThemes.value]);
---
> const themes = computed(() => [
>   ...installedThemes.value,
>   ...builtinThemes.value,
> ]);
49,50c80,81
< 	if (selectedThemeId.value == null) return null;
< 	return themes.value.find(x => x.id === selectedThemeId.value);
---
>   if (selectedThemeId.value == null) return null;
>   return themes.value.find((x) => x.id === selectedThemeId.value);
54,55c85,86
< 	if (selectedTheme.value == null) return null;
< 	return JSON5.stringify(selectedTheme.value, null, '\t');
---
>   if (selectedTheme.value == null) return null;
>   return JSON5.stringify(selectedTheme.value, null, "\t");
59,60c90,91
< 	copyToClipboard(selectedThemeCode.value);
< 	os.success();
---
>   copyToClipboard(selectedThemeCode.value);
>   os.success();
64,67c95,100
< 	removeTheme(selectedTheme.value as Theme);
< 	installedThemes.value = installedThemes.value.filter(t => t.id !== selectedThemeId.value);
< 	selectedThemeId.value = null;
< 	os.success();
---
>   removeTheme(selectedTheme.value as Theme);
>   installedThemes.value = installedThemes.value.filter(
>     (t) => t.id !== selectedThemeId.value
>   );
>   selectedThemeId.value = null;
>   os.success();
75,76c108,109
< 	title: i18n.ts._theme.manage,
< 	icon: 'ti ti-tool',
---
>   title: i18n.ts._theme.manage,
>   icon: "fas fa-folder-open",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/theme.vue RiricaV13/pages/settings/theme.vue
2,27c2,29
< <div class="_gaps_m rsljpzjq">
< 	<div v-adaptive-border class="rfqxtzch _panel">
< 		<div class="toggle">
< 			<div class="toggleWrapper">
< 				<input id="dn" v-model="darkMode" type="checkbox" class="dn"/>
< 				<label for="dn" class="toggle">
< 					<span class="before">{{ i18n.ts.light }}</span>
< 					<span class="after">{{ i18n.ts.dark }}</span>
< 					<span class="toggle__handler">
< 						<span class="crater crater--1"></span>
< 						<span class="crater crater--2"></span>
< 						<span class="crater crater--3"></span>
< 					</span>
< 					<span class="star star--1"></span>
< 					<span class="star star--2"></span>
< 					<span class="star star--3"></span>
< 					<span class="star star--4"></span>
< 					<span class="star star--5"></span>
< 					<span class="star star--6"></span>
< 				</label>
< 			</div>
< 		</div>
< 		<div class="sync">
< 			<MkSwitch v-model="syncDeviceDarkMode">{{ i18n.ts.syncDeviceDarkMode }}</MkSwitch>
< 		</div>
< 	</div>
---
>   <div class="_formRoot rsljpzjq">
>     <div v-adaptive-border class="rfqxtzch _panel _formBlock">
>       <div class="toggle">
>         <div class="toggleWrapper">
>           <input id="dn" v-model="darkMode" type="checkbox" class="dn" />
>           <label for="dn" class="toggle">
>             <span class="before">{{ i18n.ts.light }}</span>
>             <span class="after">{{ i18n.ts.dark }}</span>
>             <span class="toggle__handler">
>               <span class="crater crater--1"></span>
>               <span class="crater crater--2"></span>
>               <span class="crater crater--3"></span>
>             </span>
>             <span class="star star--1"></span>
>             <span class="star star--2"></span>
>             <span class="star star--3"></span>
>             <span class="star star--4"></span>
>             <span class="star star--5"></span>
>             <span class="star star--6"></span>
>           </label>
>         </div>
>       </div>
>       <div class="sync">
>         <FormSwitch v-model="syncDeviceDarkMode">{{
>           i18n.ts.syncDeviceDarkMode
>         }}</FormSwitch>
>       </div>
>     </div>
29,52c31,96
< 	<div class="selects">
< 		<MkSelect v-model="lightThemeId" large class="select">
< 			<template #label>{{ i18n.ts.themeForLightMode }}</template>
< 			<template #prefix><i class="ti ti-sun"></i></template>
< 			<option v-if="instanceLightTheme" :key="'instance:' + instanceLightTheme.id" :value="instanceLightTheme.id">{{ instanceLightTheme.name }}</option>
< 			<optgroup v-if="installedLightThemes.length > 0" :label="i18n.ts._theme.installedThemes">
< 				<option v-for="x in installedLightThemes" :key="'installed:' + x.id" :value="x.id">{{ x.name }}</option>
< 			</optgroup>
< 			<optgroup :label="i18n.ts._theme.builtinThemes">
< 				<option v-for="x in builtinLightThemes" :key="'builtin:' + x.id" :value="x.id">{{ x.name }}</option>
< 			</optgroup>
< 		</MkSelect>
< 		<MkSelect v-model="darkThemeId" large class="select">
< 			<template #label>{{ i18n.ts.themeForDarkMode }}</template>
< 			<template #prefix><i class="ti ti-moon"></i></template>
< 			<option v-if="instanceDarkTheme" :key="'instance:' + instanceDarkTheme.id" :value="instanceDarkTheme.id">{{ instanceDarkTheme.name }}</option>
< 			<optgroup v-if="installedDarkThemes.length > 0" :label="i18n.ts._theme.installedThemes">
< 				<option v-for="x in installedDarkThemes" :key="'installed:' + x.id" :value="x.id">{{ x.name }}</option>
< 			</optgroup>
< 			<optgroup :label="i18n.ts._theme.builtinThemes">
< 				<option v-for="x in builtinDarkThemes" :key="'builtin:' + x.id" :value="x.id">{{ x.name }}</option>
< 			</optgroup>
< 		</MkSelect>
< 	</div>
---
>     <div class="selects _formBlock">
>       <FormSelect v-model="lightThemeId" large class="select">
>         <template #label>{{ i18n.ts.themeForLightMode }}</template>
>         <template #prefix><i class="fas fa-sun"></i></template>
>         <option
>           v-if="instanceLightTheme"
>           :key="'instance:' + instanceLightTheme.id"
>           :value="instanceLightTheme.id"
>         >
>           {{ instanceLightTheme.name }}
>         </option>
>         <optgroup
>           v-if="installedLightThemes.length > 0"
>           :label="i18n.ts._theme.installedThemes"
>         >
>           <option
>             v-for="x in installedLightThemes"
>             :key="'installed:' + x.id"
>             :value="x.id"
>           >
>             {{ x.name }}
>           </option>
>         </optgroup>
>         <optgroup :label="i18n.ts._theme.builtinThemes">
>           <option
>             v-for="x in builtinLightThemes"
>             :key="'builtin:' + x.id"
>             :value="x.id"
>           >
>             {{ x.name }}
>           </option>
>         </optgroup>
>       </FormSelect>
>       <FormSelect v-model="darkThemeId" large class="select">
>         <template #label>{{ i18n.ts.themeForDarkMode }}</template>
>         <template #prefix><i class="fas fa-moon"></i></template>
>         <option
>           v-if="instanceDarkTheme"
>           :key="'instance:' + instanceDarkTheme.id"
>           :value="instanceDarkTheme.id"
>         >
>           {{ instanceDarkTheme.name }}
>         </option>
>         <optgroup
>           v-if="installedDarkThemes.length > 0"
>           :label="i18n.ts._theme.installedThemes"
>         >
>           <option
>             v-for="x in installedDarkThemes"
>             :key="'installed:' + x.id"
>             :value="x.id"
>           >
>             {{ x.name }}
>           </option>
>         </optgroup>
>         <optgroup :label="i18n.ts._theme.builtinThemes">
>           <option
>             v-for="x in builtinDarkThemes"
>             :key="'builtin:' + x.id"
>             :value="x.id"
>           >
>             {{ x.name }}
>           </option>
>         </optgroup>
>       </FormSelect>
>     </div>
54,61c98,118
< 	<FormSection>
< 		<div class="_formLinksGrid">
< 			<FormLink to="/settings/theme/manage"><template #icon><i class="ti ti-tool"></i></template>{{ i18n.ts._theme.manage }}<template #suffix>{{ themesCount }}</template></FormLink>
< 			<FormLink to="https://assets.misskey.io/theme/list" external><template #icon><i class="ti ti-world"></i></template>{{ i18n.ts._theme.explore }}</FormLink>
< 			<FormLink to="/settings/theme/install"><template #icon><i class="ti ti-download"></i></template>{{ i18n.ts._theme.install }}</FormLink>
< 			<FormLink to="/theme-editor"><template #icon><i class="ti ti-paint"></i></template>{{ i18n.ts._theme.make }}</FormLink>
< 		</div>
< 	</FormSection>
---
>     <FormSection>
>       <div class="_formLinksGrid">
>         <FormLink to="/settings/theme/manage"
>           ><template #icon><i class="fas fa-folder-open"></i></template
>           >{{ i18n.ts._theme.manage
>           }}<template #suffix>{{ themesCount }}</template></FormLink
>         >
>         <FormLink to="https://assets.misskey.io/theme/list" external
>           ><template #icon><i class="fas fa-globe"></i></template
>           >{{ i18n.ts._theme.explore }}</FormLink
>         >
>         <FormLink to="/settings/theme/install"
>           ><template #icon><i class="fas fa-download"></i></template
>           >{{ i18n.ts._theme.install }}</FormLink
>         >
>         <FormLink to="/theme-editor"
>           ><template #icon><i class="fas fa-paint-roller"></i></template
>           >{{ i18n.ts._theme.make }}</FormLink
>         >
>       </div>
>     </FormSection>
63,65c120,129
< 	<MkButton v-if="wallpaper == null" @click="setWallpaper">{{ i18n.ts.setWallpaper }}</MkButton>
< 	<MkButton v-else @click="wallpaper = null">{{ i18n.ts.removeWallpaper }}</MkButton>
< </div>
---
>     <FormButton
>       v-if="wallpaper == null"
>       class="_formBlock"
>       @click="setWallpaper"
>       >{{ i18n.ts.setWallpaper }}</FormButton
>     >
>     <FormButton v-else class="_formBlock" @click="wallpaper = null">{{
>       i18n.ts.removeWallpaper
>     }}</FormButton>
>   </div>
69,85c133,148
< import { computed, onActivated, ref, watch } from 'vue';
< import JSON5 from 'json5';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import FormSection from '@/components/form/section.vue';
< import FormLink from '@/components/form/link.vue';
< import MkButton from '@/components/MkButton.vue';
< import { getBuiltinThemesRef } from '@/scripts/theme';
< import { selectFile } from '@/scripts/select-file';
< import { isDeviceDarkmode } from '@/scripts/is-device-darkmode';
< import { ColdDeviceStorage, defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import { uniqueBy } from '@/scripts/array';
< import { fetchThemes, getThemes } from '@/theme-store';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { miLocalStorage } from '@/local-storage';
---
> import { computed, onActivated, ref, watch } from "vue";
> import JSON5 from "json5";
> import FormSwitch from "@/components/form/switch.vue";
> import FormSelect from "@/components/form/select.vue";
> import FormSection from "@/components/form/section.vue";
> import FormLink from "@/components/form/link.vue";
> import FormButton from "@/components/MkButton.vue";
> import { getBuiltinThemesRef } from "@/scripts/theme";
> import { selectFile } from "@/scripts/select-file";
> import { isDeviceDarkmode } from "@/scripts/is-device-darkmode";
> import { ColdDeviceStorage, defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import { uniqueBy } from "@/scripts/array";
> import { fetchThemes, getThemes } from "@/theme-store";
> import { definePageMetadata } from "@/scripts/page-metadata";
90,96c153,181
< const instanceDarkTheme = computed(() => instance.defaultDarkTheme ? JSON5.parse(instance.defaultDarkTheme) : null);
< const installedDarkThemes = computed(() => installedThemes.value.filter(t => t.base === 'dark' || t.kind === 'dark'));
< const builtinDarkThemes = computed(() => builtinThemes.value.filter(t => t.base === 'dark' || t.kind === 'dark'));
< const instanceLightTheme = computed(() => instance.defaultLightTheme ? JSON5.parse(instance.defaultLightTheme) : null);
< const installedLightThemes = computed(() => installedThemes.value.filter(t => t.base === 'light' || t.kind === 'light'));
< const builtinLightThemes = computed(() => builtinThemes.value.filter(t => t.base === 'light' || t.kind === 'light'));
< const themes = computed(() => uniqueBy([instanceDarkTheme.value, instanceLightTheme.value, ...builtinThemes.value, ...installedThemes.value].filter(x => x != null), theme => theme.id));
---
> const instanceDarkTheme = computed(() =>
>   instance.defaultDarkTheme ? JSON5.parse(instance.defaultDarkTheme) : null
> );
> const installedDarkThemes = computed(() =>
>   installedThemes.value.filter((t) => t.base === "dark" || t.kind === "dark")
> );
> const builtinDarkThemes = computed(() =>
>   builtinThemes.value.filter((t) => t.base === "dark" || t.kind === "dark")
> );
> const instanceLightTheme = computed(() =>
>   instance.defaultLightTheme ? JSON5.parse(instance.defaultLightTheme) : null
> );
> const installedLightThemes = computed(() =>
>   installedThemes.value.filter((t) => t.base === "light" || t.kind === "light")
> );
> const builtinLightThemes = computed(() =>
>   builtinThemes.value.filter((t) => t.base === "light" || t.kind === "light")
> );
> const themes = computed(() =>
>   uniqueBy(
>     [
>       instanceDarkTheme.value,
>       instanceLightTheme.value,
>       ...builtinThemes.value,
>       ...installedThemes.value,
>     ].filter((x) => x != null),
>     (theme) => theme.id
>   )
> );
98c183
< const darkTheme = ColdDeviceStorage.ref('darkTheme');
---
> const darkTheme = ColdDeviceStorage.ref("darkTheme");
100,108c185,194
< 	get() {
< 		return darkTheme.value.id;
< 	},
< 	set(id) {
< 		const t = themes.value.find(x => x.id === id);
< 		if (t) { // テーマエディタでテーマを作成したときなどは、themesに反映されないため undefined になる
< 			ColdDeviceStorage.set('darkTheme', t);
< 		}
< 	},
---
>   get() {
>     return darkTheme.value.id;
>   },
>   set(id) {
>     const t = themes.value.find((x) => x.id === id);
>     if (t) {
>       // テーマエディタでテーマを作成したときなどは、themesに反映されないため undefined になる
>       ColdDeviceStorage.set("darkTheme", t);
>     }
>   },
110c196
< const lightTheme = ColdDeviceStorage.ref('lightTheme');
---
> const lightTheme = ColdDeviceStorage.ref("lightTheme");
112,120c198,207
< 	get() {
< 		return lightTheme.value.id;
< 	},
< 	set(id) {
< 		const t = themes.value.find(x => x.id === id);
< 		if (t) { // テーマエディタでテーマを作成したときなどは、themesに反映されないため undefined になる
< 			ColdDeviceStorage.set('lightTheme', t);
< 		}
< 	},
---
>   get() {
>     return lightTheme.value.id;
>   },
>   set(id) {
>     const t = themes.value.find((x) => x.id === id);
>     if (t) {
>       // テーマエディタでテーマを作成したときなどは、themesに反映されないため undefined になる
>       ColdDeviceStorage.set("lightTheme", t);
>     }
>   },
122,124c209,213
< const darkMode = computed(defaultStore.makeGetterSetter('darkMode'));
< const syncDeviceDarkMode = computed(ColdDeviceStorage.makeGetterSetter('syncDeviceDarkMode'));
< const wallpaper = ref(miLocalStorage.getItem('wallpaper'));
---
> const darkMode = computed(defaultStore.makeGetterSetter("darkMode"));
> const syncDeviceDarkMode = computed(
>   ColdDeviceStorage.makeGetterSetter("syncDeviceDarkMode")
> );
> const wallpaper = ref(localStorage.getItem("wallpaper"));
128,130c217,219
< 	if (syncDeviceDarkMode.value) {
< 		defaultStore.set('darkMode', isDeviceDarkmode());
< 	}
---
>   if (syncDeviceDarkMode.value) {
>     defaultStore.set("darkMode", isDeviceDarkmode());
>   }
134,139c223,228
< 	if (wallpaper.value == null) {
< 		miLocalStorage.removeItem('wallpaper');
< 	} else {
< 		miLocalStorage.setItem('wallpaper', wallpaper.value);
< 	}
< 	location.reload();
---
>   if (wallpaper.value == null) {
>     localStorage.removeItem("wallpaper");
>   } else {
>     localStorage.setItem("wallpaper", wallpaper.value);
>   }
>   location.reload();
143,145c232,234
< 	fetchThemes().then(() => {
< 		installedThemes.value = getThemes();
< 	});
---
>   fetchThemes().then(() => {
>     installedThemes.value = getThemes();
>   });
149c238
< 	installedThemes.value = getThemes();
---
>   installedThemes.value = getThemes();
153,155c242,244
< 	selectFile(event.currentTarget ?? event.target, null).then(file => {
< 		wallpaper.value = file.url;
< 	});
---
>   selectFile(event.currentTarget ?? event.target, null).then((file) => {
>     wallpaper.value = file.url;
>   });
163,164c252,253
< 	title: i18n.ts.theme,
< 	icon: 'ti ti-palette',
---
>   title: i18n.ts.theme,
>   icon: "fas fa-palette",
170c259
< 	border-radius: 6px;
---
>   border-radius: 6px;
172,175c261,264
< 	> .toggle {
< 		position: relative;
< 		padding: 26px 0;
< 		text-align: center;
---
>   > .toggle {
>     position: relative;
>     padding: 26px 0;
>     text-align: center;
177,178c266,267
< 		&.disabled {
< 			opacity: 0.7;
---
>     &.disabled {
>       opacity: 0.7;
180,183c269,273
< 			&, * {
< 				cursor: not-allowed !important;
< 			}
< 		}
---
>       &,
>       * {
>         cursor: not-allowed !important;
>       }
>     }
185,190c275,280
< 		> .toggleWrapper {
< 			display: inline-block;
< 			text-align: left;
< 			overflow: clip;
< 			padding: 0 100px;
< 			vertical-align: bottom;
---
>     > .toggleWrapper {
>       display: inline-block;
>       text-align: left;
>       overflow: clip;
>       padding: 0 100px;
>       vertical-align: bottom;
192,196c282,286
< 			input {
< 				position: absolute;
< 				left: -99em;
< 			}
< 		}
---
>       input {
>         position: absolute;
>         left: -99em;
>       }
>     }
198,206c288,296
< 		.toggle {
< 			cursor: pointer;
< 			display: inline-block;
< 			position: relative;
< 			width: 90px;
< 			height: 50px;
< 			background-color: #83D8FF;
< 			border-radius: 90px - 6;
< 			transition: background-color 200ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
---
>     .toggle {
>       cursor: pointer;
>       display: inline-block;
>       position: relative;
>       width: 90px;
>       height: 50px;
>       background-color: #83d8ff;
>       border-radius: 90px - 6;
>       transition: background-color 200ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
208,212c298,303
< 			> .before, > .after {
< 				position: absolute;
< 				top: 15px;
< 				transition: color 1s ease;
< 			}
---
>       > .before,
>       > .after {
>         position: absolute;
>         top: 15px;
>         transition: color 1s ease;
>       }
214,217c305,308
< 			> .before {
< 				left: -70px;
< 				color: var(--accent);
< 			}
---
>       > .before {
>         left: -70px;
>         color: var(--accent);
>       }
219,223c310,314
< 			> .after {
< 				right: -68px;
< 				color: var(--fg);
< 			}
< 		}
---
>       > .after {
>         right: -68px;
>         color: var(--fg);
>       }
>     }
225,237c316,328
< 		.toggle__handler {
< 			display: inline-block;
< 			position: relative;
< 			z-index: 1;
< 			top: 3px;
< 			left: 3px;
< 			width: 50px - 6;
< 			height: 50px - 6;
< 			background-color: #FFCF96;
< 			border-radius: 50px;
< 			box-shadow: 0 2px 6px rgba(0,0,0,.3);
< 			transition: all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
< 			transform:  rotate(-45deg);
---
>     .toggle__handler {
>       display: inline-block;
>       position: relative;
>       z-index: 1;
>       top: 3px;
>       left: 3px;
>       width: 50px - 6;
>       height: 50px - 6;
>       background-color: #ffcf96;
>       border-radius: 50px;
>       box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
>       transition: all 400ms cubic-bezier(0.68, -0.55, 0.265, 1.55) !important;
>       transform: rotate(-45deg);
239,245c330,336
< 			.crater {
< 				position: absolute;
< 				background-color: #E8CDA5;
< 				opacity: 0;
< 				transition: opacity 200ms ease-in-out !important;
< 				border-radius: 100%;
< 			}
---
>       .crater {
>         position: absolute;
>         background-color: #e8cda5;
>         opacity: 0;
>         transition: opacity 200ms ease-in-out !important;
>         border-radius: 100%;
>       }
247,252c338,343
< 			.crater--1 {
< 				top: 18px;
< 				left: 10px;
< 				width: 4px;
< 				height: 4px;
< 			}
---
>       .crater--1 {
>         top: 18px;
>         left: 10px;
>         width: 4px;
>         height: 4px;
>       }
254,259c345,350
< 			.crater--2 {
< 				top: 28px;
< 				left: 22px;
< 				width: 6px;
< 				height: 6px;
< 			}
---
>       .crater--2 {
>         top: 28px;
>         left: 22px;
>         width: 6px;
>         height: 6px;
>       }
261,267c352,358
< 			.crater--3 {
< 				top: 10px;
< 				left: 25px;
< 				width: 8px;
< 				height: 8px;
< 			}
< 		}
---
>       .crater--3 {
>         top: 10px;
>         left: 25px;
>         width: 8px;
>         height: 8px;
>       }
>     }
269,274c360,365
< 		.star {
< 			position: absolute;
< 			background-color: #ffffff;
< 			transition: all 300ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
< 			border-radius: 50%;
< 		}
---
>     .star {
>       position: absolute;
>       background-color: #ffffff;
>       transition: all 300ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
>       border-radius: 50%;
>     }
276,282c367,373
< 		.star--1 {
< 			top: 10px;
< 			left: 35px;
< 			z-index: 0;
< 			width: 30px;
< 			height: 3px;
< 		}
---
>     .star--1 {
>       top: 10px;
>       left: 35px;
>       z-index: 0;
>       width: 30px;
>       height: 3px;
>     }
284,290c375,381
< 		.star--2 {
< 			top: 18px;
< 			left: 28px;
< 			z-index: 1;
< 			width: 30px;
< 			height: 3px;
< 		}
---
>     .star--2 {
>       top: 18px;
>       left: 28px;
>       z-index: 1;
>       width: 30px;
>       height: 3px;
>     }
292,298c383,389
< 		.star--3 {
< 			top: 27px;
< 			left: 40px;
< 			z-index: 0;
< 			width: 30px;
< 			height: 3px;
< 		}
---
>     .star--3 {
>       top: 27px;
>       left: 40px;
>       z-index: 0;
>       width: 30px;
>       height: 3px;
>     }
300,305c391,396
< 		.star--4,
< 		.star--5,
< 		.star--6 {
< 			opacity: 0;
< 			transition: all 300ms 0 cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
< 		}
---
>     .star--4,
>     .star--5,
>     .star--6 {
>       opacity: 0;
>       transition: all 300ms 0 cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
>     }
307,314c398,405
< 		.star--4 {
< 			top: 16px;
< 			left: 11px;
< 			z-index: 0;
< 			width: 2px;
< 			height: 2px;
< 			transform: translate3d(3px,0,0);
< 		}
---
>     .star--4 {
>       top: 16px;
>       left: 11px;
>       z-index: 0;
>       width: 2px;
>       height: 2px;
>       transform: translate3d(3px, 0, 0);
>     }
316,323c407,414
< 		.star--5 {
< 			top: 32px;
< 			left: 17px;
< 			z-index: 0;
< 			width: 3px;
< 			height: 3px;
< 			transform: translate3d(3px,0,0);
< 		}
---
>     .star--5 {
>       top: 32px;
>       left: 17px;
>       z-index: 0;
>       width: 3px;
>       height: 3px;
>       transform: translate3d(3px, 0, 0);
>     }
325,332c416,423
< 		.star--6 {
< 			top: 36px;
< 			left: 28px;
< 			z-index: 0;
< 			width: 2px;
< 			height: 2px;
< 			transform: translate3d(3px,0,0);
< 		}
---
>     .star--6 {
>       top: 36px;
>       left: 28px;
>       z-index: 0;
>       width: 2px;
>       height: 2px;
>       transform: translate3d(3px, 0, 0);
>     }
334,336c425,427
< 		input:checked {
< 			+ .toggle {
< 				background-color: #749DD6;
---
>     input:checked {
>       + .toggle {
>         background-color: #749dd6;
338,340c429,431
< 				> .before {
< 					color: var(--fg);
< 				}
---
>         > .before {
>           color: var(--fg);
>         }
342,344c433,435
< 				> .after {
< 					color: var(--accent);
< 				}
---
>         > .after {
>           color: var(--accent);
>         }
346,348c437,439
< 				.toggle__handler {
< 					background-color: #FFE5B5;
< 					transform: translate3d(40px, 0, 0) rotate(0);
---
>         .toggle__handler {
>           background-color: #ffe5b5;
>           transform: translate3d(40px, 0, 0) rotate(0);
350,351c441,444
< 					.crater { opacity: 1; }
< 				}
---
>           .crater {
>             opacity: 1;
>           }
>         }
353,356c446,449
< 				.star--1 {
< 					width: 2px;
< 					height: 2px;
< 				}
---
>         .star--1 {
>           width: 2px;
>           height: 2px;
>         }
358,362c451,455
< 				.star--2 {
< 					width: 4px;
< 					height: 4px;
< 					transform: translate3d(-5px, 0, 0);
< 				}
---
>         .star--2 {
>           width: 4px;
>           height: 4px;
>           transform: translate3d(-5px, 0, 0);
>         }
364,368c457,461
< 				.star--3 {
< 					width: 2px;
< 					height: 2px;
< 					transform: translate3d(-7px, 0, 0);
< 				}
---
>         .star--3 {
>           width: 2px;
>           height: 2px;
>           transform: translate3d(-7px, 0, 0);
>         }
370,375c463,468
< 				.star--4,
< 				.star--5,
< 				.star--6 {
< 					opacity: 1;
< 					transform: translate3d(0,0,0);
< 				}
---
>         .star--4,
>         .star--5,
>         .star--6 {
>           opacity: 1;
>           transform: translate3d(0, 0, 0);
>         }
377,379c470,472
< 				.star--4 {
< 					transition: all 300ms 200ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
< 				}
---
>         .star--4 {
>           transition: all 300ms 200ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
>         }
381,383c474,476
< 				.star--5 {
< 					transition: all 300ms 300ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
< 				}
---
>         .star--5 {
>           transition: all 300ms 300ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
>         }
385,390c478,483
< 				.star--6 {
< 					transition: all 300ms 400ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
< 				}
< 			}
< 		}
< 	}
---
>         .star--6 {
>           transition: all 300ms 400ms cubic-bezier(0.445, 0.05, 0.55, 0.95) !important;
>         }
>       }
>     }
>   }
392,395c485,488
< 	> .sync {
< 		padding: 14px 16px;
< 		border-top: solid 0.5px var(--divider);
< 	}
---
>   > .sync {
>     padding: 14px 16px;
>     border-top: solid 0.5px var(--divider);
>   }
399,402c492,495
< 	> .selects {
< 		display: flex;
< 		gap: 1.5em var(--margin);
< 		flex-wrap: wrap;
---
>   > .selects {
>     display: flex;
>     gap: 1.5em var(--margin);
>     flex-wrap: wrap;
404,408c497,501
< 		> .select {
< 			flex: 1;
< 			min-width: 280px;
< 		}
< 	}
---
>     > .select {
>       flex: 1;
>       min-width: 280px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/webhook.edit.vue RiricaV13/pages/settings/webhook.edit.vue
2,5c2,5
< <div class="_gaps_m">
< 	<MkInput v-model="name">
< 		<template #label>Name</template>
< 	</MkInput>
---
>   <div class="_formRoot">
>     <FormInput v-model="name" class="_formBlock">
>       <template #label>Name</template>
>     </FormInput>
7,9c7,9
< 	<MkInput v-model="url" type="url">
< 		<template #label>URL</template>
< 	</MkInput>
---
>     <FormInput v-model="url" type="url" class="_formBlock">
>       <template #label>URL</template>
>     </FormInput>
11,14c11,14
< 	<MkInput v-model="secret">
< 		<template #prefix><i class="ti ti-lock"></i></template>
< 		<template #label>Secret</template>
< 	</MkInput>
---
>     <FormInput v-model="secret" class="_formBlock">
>       <template #prefix><i class="fas fa-lock"></i></template>
>       <template #label>Secret</template>
>     </FormInput>
16,17c16,17
< 	<FormSection>
< 		<template #label>Events</template>
---
>     <FormSection>
>       <template #label>Events</template>
19,28c19,32
< 		<div class="_gaps_s">
< 			<MkSwitch v-model="event_follow">Follow</MkSwitch>
< 			<MkSwitch v-model="event_followed">Followed</MkSwitch>
< 			<MkSwitch v-model="event_note">Note</MkSwitch>
< 			<MkSwitch v-model="event_reply">Reply</MkSwitch>
< 			<MkSwitch v-model="event_renote">Renote</MkSwitch>
< 			<MkSwitch v-model="event_reaction">Reaction</MkSwitch>
< 			<MkSwitch v-model="event_mention">Mention</MkSwitch>
< 		</div>
< 	</FormSection>
---
>       <FormSwitch v-model="event_follow" class="_formBlock">Follow</FormSwitch>
>       <FormSwitch v-model="event_followed" class="_formBlock"
>         >Followed</FormSwitch
>       >
>       <FormSwitch v-model="event_note" class="_formBlock">Note</FormSwitch>
>       <FormSwitch v-model="event_reply" class="_formBlock">Reply</FormSwitch>
>       <FormSwitch v-model="event_renote" class="_formBlock">Renote</FormSwitch>
>       <FormSwitch v-model="event_reaction" class="_formBlock"
>         >Reaction</FormSwitch
>       >
>       <FormSwitch v-model="event_mention" class="_formBlock"
>         >Mention</FormSwitch
>       >
>     </FormSection>
30c34
< 	<MkSwitch v-model="active">Active</MkSwitch>
---
>     <FormSwitch v-model="active" class="_formBlock">Active</FormSwitch>
32,35c36,44
< 	<div class="_buttons">
< 		<MkButton primary inline @click="save"><i class="ti ti-check"></i> {{ i18n.ts.save }}</MkButton>
< 	</div>
< </div>
---
>     <div
>       class="_formBlock"
>       style="display: flex; gap: var(--margin); flex-wrap: wrap"
>     >
>       <FormButton primary inline @click="save"
>         ><i class="fas fa-check"></i> {{ i18n.ts.save }}</FormButton
>       >
>     </div>
>   </div>
39,46c48,55
< import { } from 'vue';
< import MkInput from '@/components/MkInput.vue';
< import FormSection from '@/components/form/section.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import FormInput from "@/components/form/input.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
49c58
< 	webhookId: string;
---
>   webhookId: string;
52,53c61,62
< const webhook = await os.api('i/webhooks/show', {
< 	webhookId: props.webhookId,
---
> const webhook = await os.api("i/webhooks/show", {
>   webhookId: props.webhookId,
61,67c70,76
< let event_follow = $ref(webhook.on.includes('follow'));
< let event_followed = $ref(webhook.on.includes('followed'));
< let event_note = $ref(webhook.on.includes('note'));
< let event_reply = $ref(webhook.on.includes('reply'));
< let event_renote = $ref(webhook.on.includes('renote'));
< let event_reaction = $ref(webhook.on.includes('reaction'));
< let event_mention = $ref(webhook.on.includes('mention'));
---
> let event_follow = $ref(webhook.on.includes("follow"));
> let event_followed = $ref(webhook.on.includes("followed"));
> let event_note = $ref(webhook.on.includes("note"));
> let event_reply = $ref(webhook.on.includes("reply"));
> let event_renote = $ref(webhook.on.includes("renote"));
> let event_reaction = $ref(webhook.on.includes("reaction"));
> let event_mention = $ref(webhook.on.includes("mention"));
70,77c79,86
< 	const events = [];
< 	if (event_follow) events.push('follow');
< 	if (event_followed) events.push('followed');
< 	if (event_note) events.push('note');
< 	if (event_reply) events.push('reply');
< 	if (event_renote) events.push('renote');
< 	if (event_reaction) events.push('reaction');
< 	if (event_mention) events.push('mention');
---
>   const events = [];
>   if (event_follow) events.push("follow");
>   if (event_followed) events.push("followed");
>   if (event_note) events.push("note");
>   if (event_reply) events.push("reply");
>   if (event_renote) events.push("renote");
>   if (event_reaction) events.push("reaction");
>   if (event_mention) events.push("mention");
79,86c88,95
< 	os.apiWithDialog('i/webhooks/update', {
< 		name,
< 		url,
< 		secret,
< 		webhookId: props.webhookId,
< 		on: events,
< 		active,
< 	});
---
>   os.apiWithDialog("i/webhooks/update", {
>     name,
>     url,
>     secret,
>     webhookId: props.webhookId,
>     on: events,
>     active,
>   });
94,95c103,104
< 	title: 'Edit webhook',
< 	icon: 'ti ti-webhook',
---
>   title: "Edit webhook",
>   icon: "fas fa-bolt",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/webhook.new.vue RiricaV13/pages/settings/webhook.new.vue
2,5c2,5
< <div class="_gaps_m">
< 	<MkInput v-model="name">
< 		<template #label>Name</template>
< 	</MkInput>
---
>   <div class="_formRoot">
>     <FormInput v-model="name" class="_formBlock">
>       <template #label>Name</template>
>     </FormInput>
7,9c7,9
< 	<MkInput v-model="url" type="url">
< 		<template #label>URL</template>
< 	</MkInput>
---
>     <FormInput v-model="url" type="url" class="_formBlock">
>       <template #label>URL</template>
>     </FormInput>
11,14c11,14
< 	<MkInput v-model="secret">
< 		<template #prefix><i class="ti ti-lock"></i></template>
< 		<template #label>Secret</template>
< 	</MkInput>
---
>     <FormInput v-model="secret" class="_formBlock">
>       <template #prefix><i class="fas fa-lock"></i></template>
>       <template #label>Secret</template>
>     </FormInput>
16,17c16,17
< 	<FormSection>
< 		<template #label>Events</template>
---
>     <FormSection>
>       <template #label>Events</template>
19,28c19,32
< 		<div class="_gaps_s">
< 			<MkSwitch v-model="event_follow">Follow</MkSwitch>
< 			<MkSwitch v-model="event_followed">Followed</MkSwitch>
< 			<MkSwitch v-model="event_note">Note</MkSwitch>
< 			<MkSwitch v-model="event_reply">Reply</MkSwitch>
< 			<MkSwitch v-model="event_renote">Renote</MkSwitch>
< 			<MkSwitch v-model="event_reaction">Reaction</MkSwitch>
< 			<MkSwitch v-model="event_mention">Mention</MkSwitch>
< 		</div>
< 	</FormSection>
---
>       <FormSwitch v-model="event_follow" class="_formBlock">Follow</FormSwitch>
>       <FormSwitch v-model="event_followed" class="_formBlock"
>         >Followed</FormSwitch
>       >
>       <FormSwitch v-model="event_note" class="_formBlock">Note</FormSwitch>
>       <FormSwitch v-model="event_reply" class="_formBlock">Reply</FormSwitch>
>       <FormSwitch v-model="event_renote" class="_formBlock">Renote</FormSwitch>
>       <FormSwitch v-model="event_reaction" class="_formBlock"
>         >Reaction</FormSwitch
>       >
>       <FormSwitch v-model="event_mention" class="_formBlock"
>         >Mention</FormSwitch
>       >
>     </FormSection>
30,33c34,42
< 	<div class="_buttons">
< 		<MkButton primary inline @click="create"><i class="ti ti-check"></i> {{ i18n.ts.create }}</MkButton>
< 	</div>
< </div>
---
>     <div
>       class="_formBlock"
>       style="display: flex; gap: var(--margin); flex-wrap: wrap"
>     >
>       <FormButton primary inline @click="create"
>         ><i class="fas fa-check"></i> {{ i18n.ts.create }}</FormButton
>       >
>     </div>
>   </div>
37,44c46,53
< import { } from 'vue';
< import MkInput from '@/components/MkInput.vue';
< import FormSection from '@/components/form/section.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import FormInput from "@/components/form/input.vue";
> import FormSection from "@/components/form/section.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormButton from "@/components/MkButton.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
46,48c55,57
< let name = $ref('');
< let url = $ref('');
< let secret = $ref('');
---
> let name = $ref("");
> let url = $ref("");
> let secret = $ref("");
59,66c68,75
< 	const events = [];
< 	if (event_follow) events.push('follow');
< 	if (event_followed) events.push('followed');
< 	if (event_note) events.push('note');
< 	if (event_reply) events.push('reply');
< 	if (event_renote) events.push('renote');
< 	if (event_reaction) events.push('reaction');
< 	if (event_mention) events.push('mention');
---
>   const events = [];
>   if (event_follow) events.push("follow");
>   if (event_followed) events.push("followed");
>   if (event_note) events.push("note");
>   if (event_reply) events.push("reply");
>   if (event_renote) events.push("renote");
>   if (event_reaction) events.push("reaction");
>   if (event_mention) events.push("mention");
68,73c77,82
< 	os.apiWithDialog('i/webhooks/create', {
< 		name,
< 		url,
< 		secret,
< 		on: events,
< 	});
---
>   os.apiWithDialog("i/webhooks/create", {
>     name,
>     url,
>     secret,
>     on: events,
>   });
81,82c90,91
< 	title: 'Create new webhook',
< 	icon: 'ti ti-webhook',
---
>   title: "Create new webhook",
>   icon: "fas fa-bolt",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/webhook.vue RiricaV13/pages/settings/webhook.vue
2,5c2,5
< <div class="_gaps_m">
< 	<FormLink :to="`/settings/webhook/new`">
< 		Create webhook
< 	</FormLink>
---
>   <div class="_formRoot">
>     <FormSection>
>       <FormLink :to="`/settings/webhook/new`"> Create webhook </FormLink>
>     </FormSection>
7,25c7,47
< 	<FormSection>
< 		<MkPagination :pagination="pagination">
< 			<template #default="{items}">
< 				<FormLink v-for="webhook in items" :key="webhook.id" :to="`/settings/webhook/edit/${webhook.id}`" class="_margin">
< 					<template #icon>
< 						<i v-if="webhook.active === false" class="ti ti-player-pause"></i>
< 						<i v-else-if="webhook.latestStatus === null" class="ti ti-circle"></i>
< 						<i v-else-if="[200, 201, 204].includes(webhook.latestStatus)" class="ti ti-check" :style="{ color: 'var(--success)' }"></i>
< 						<i v-else class="ti ti-alert-triangle" :style="{ color: 'var(--error)' }"></i>
< 					</template>
< 					{{ webhook.name || webhook.url }}
< 					<template #suffix>
< 						<MkTime v-if="webhook.latestSentAt" :time="webhook.latestSentAt"></MkTime>
< 					</template>
< 				</FormLink>
< 			</template>
< 		</MkPagination>
< 	</FormSection>
< </div>
---
>     <FormSection>
>       <MkPagination :pagination="pagination">
>         <template #default="{ items }">
>           <FormLink
>             v-for="webhook in items"
>             :key="webhook.id"
>             :to="`/settings/webhook/edit/${webhook.id}`"
>             class="_formBlock"
>           >
>             <template #icon>
>               <i
>                 v-if="webhook.active === false"
>                 class="fas fa-circle-pause"
>               ></i>
>               <i
>                 v-else-if="webhook.latestStatus === null"
>                 class="far fa-circle"
>               ></i>
>               <i
>                 v-else-if="[200, 201, 204].includes(webhook.latestStatus)"
>                 class="fas fa-check"
>                 :style="{ color: 'var(--success)' }"
>               ></i>
>               <i
>                 v-else
>                 class="fas fa-triangle-exclamation"
>                 :style="{ color: 'var(--error)' }"
>               ></i>
>             </template>
>             {{ webhook.name || webhook.url }}
>             <template #suffix>
>               <MkTime
>                 v-if="webhook.latestSentAt"
>                 :time="webhook.latestSentAt"
>               ></MkTime>
>             </template>
>           </FormLink>
>         </template>
>       </MkPagination>
>     </FormSection>
>   </div>
29,36c51,58
< import { } from 'vue';
< import MkPagination from '@/components/MkPagination.vue';
< import FormSection from '@/components/form/section.vue';
< import FormLink from '@/components/form/link.vue';
< import { userPage } from '@/filters/user';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import {} from "vue";
> import MkPagination from "@/components/MkPagination.vue";
> import FormSection from "@/components/form/section.vue";
> import FormLink from "@/components/form/link.vue";
> import { userPage } from "@/filters/user";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
39,40c61,62
< 	endpoint: 'i/webhooks/list' as const,
< 	limit: 10,
---
>   endpoint: "i/webhooks/list" as const,
>   limit: 10,
48,49c70,71
< 	title: 'Webhook',
< 	icon: 'ti ti-webhook',
---
>   title: "Webhook",
>   icon: "fas fa-bolt",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/settings/word-mute.vue RiricaV13/pages/settings/word-mute.vue
2,28c2,43
< <div class="_gaps_m">
< 	<MkTab v-model="tab">
< 		<option value="soft">{{ i18n.ts._wordMute.soft }}</option>
< 		<option value="hard">{{ i18n.ts._wordMute.hard }}</option>
< 	</MkTab>
< 	<div>
< 		<div v-show="tab === 'soft'" class="_gaps_m">
< 			<MkInfo>{{ i18n.ts._wordMute.softDescription }}</MkInfo>
< 			<MkTextarea v-model="softMutedWords">
< 				<span>{{ i18n.ts._wordMute.muteWords }}</span>
< 				<template #caption>{{ i18n.ts._wordMute.muteWordsDescription }}<br>{{ i18n.ts._wordMute.muteWordsDescription2 }}</template>
< 			</MkTextarea>
< 		</div>
< 		<div v-show="tab === 'hard'" class="_gaps_m">
< 			<MkInfo>{{ i18n.ts._wordMute.hardDescription }} {{ i18n.ts.reflectMayTakeTime }}</MkInfo>
< 			<MkTextarea v-model="hardMutedWords">
< 				<span>{{ i18n.ts._wordMute.muteWords }}</span>
< 				<template #caption>{{ i18n.ts._wordMute.muteWordsDescription }}<br>{{ i18n.ts._wordMute.muteWordsDescription2 }}</template>
< 			</MkTextarea>
< 			<MkKeyValue v-if="hardWordMutedNotesCount != null">
< 				<template #key>{{ i18n.ts._wordMute.mutedNotes }}</template>
< 				<template #value>{{ number(hardWordMutedNotesCount) }}</template>
< 			</MkKeyValue>
< 		</div>
< 	</div>
< 	<MkButton primary inline :disabled="!changed" @click="save()"><i class="ti ti-device-floppy"></i> {{ i18n.ts.save }}</MkButton>
< </div>
---
>   <div class="_formRoot">
>     <MkTab v-model="tab" class="_formBlock">
>       <option value="soft">{{ i18n.ts._wordMute.soft }}</option>
>       <option value="hard">{{ i18n.ts._wordMute.hard }}</option>
>     </MkTab>
>     <div class="_formBlock">
>       <div v-show="tab === 'soft'">
>         <MkInfo class="_formBlock">{{
>           i18n.ts._wordMute.softDescription
>         }}</MkInfo>
>         <FormTextarea v-model="softMutedWords" class="_formBlock">
>           <span>{{ i18n.ts._wordMute.muteWords }}</span>
>           <template #caption
>             >{{ i18n.ts._wordMute.muteWordsDescription }}<br />{{
>               i18n.ts._wordMute.muteWordsDescription2
>             }}</template
>           >
>         </FormTextarea>
>       </div>
>       <div v-show="tab === 'hard'">
>         <MkInfo class="_formBlock"
>           >{{ i18n.ts._wordMute.hardDescription }}
>           {{ i18n.ts.reflectMayTakeTime }}</MkInfo
>         >
>         <FormTextarea v-model="hardMutedWords" class="_formBlock">
>           <span>{{ i18n.ts._wordMute.muteWords }}</span>
>           <template #caption
>             >{{ i18n.ts._wordMute.muteWordsDescription }}<br />{{
>               i18n.ts._wordMute.muteWordsDescription2
>             }}</template
>           >
>         </FormTextarea>
>         <MkKeyValue v-if="hardWordMutedNotesCount != null" class="_formBlock">
>           <template #key>{{ i18n.ts._wordMute.mutedNotes }}</template>
>           <template #value>{{ number(hardWordMutedNotesCount) }}</template>
>         </MkKeyValue>
>       </div>
>     </div>
>     <MkButton primary inline :disabled="!changed" @click="save()"
>       ><i class="fas fa-save"></i> {{ i18n.ts.save }}</MkButton
>     >
>   </div>
32,43c47,58
< import { ref, watch } from 'vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import MkTab from '@/components/MkTab.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import { defaultStore } from '@/store';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { ref, watch } from "vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import MkTab from "@/components/MkTab.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import { defaultStore } from "@/store";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
45,51c60,69
< const render = (mutedWords) => mutedWords.map(x => {
< 	if (Array.isArray(x)) {
< 		return x.join(' ');
< 	} else {
< 		return x;
< 	}
< }).join('\n');
---
> const render = (mutedWords) =>
>   mutedWords
>     .map((x) => {
>       if (Array.isArray(x)) {
>         return x.join(" ");
>       } else {
>         return x;
>       }
>     })
>     .join("\n");
53c71
< const tab = ref('soft');
---
> const tab = ref("soft");
59,60c77,78
< os.api('i/get-word-muted-notes-count', {}).then(response => {
< 	hardWordMutedNotesCount.value = response?.count;
---
> os.api("i/get-word-muted-notes-count", {}).then((response) => {
>   hardWordMutedNotesCount.value = response?.count;
64c82
< 	changed.value = true;
---
>   changed.value = true;
68c86
< 	changed.value = true;
---
>   changed.value = true;
72,74c90,96
< 	const parseMutes = (mutes, tab) => {
< 		// split into lines, remove empty lines and unnecessary whitespace
< 		let lines = mutes.trim().split('\n').map(line => line.trim()).filter(line => line !== '');
---
>   const parseMutes = (mutes, tab) => {
>     // split into lines, remove empty lines and unnecessary whitespace
>     let lines = mutes
>       .trim()
>       .split("\n")
>       .map((line) => line.trim())
>       .filter((line) => line !== "");
76,98c98,123
< 		// check each line if it is a RegExp or not
< 		for (let i = 0; i < lines.length; i++) {
< 			const line = lines[i];
< 			const regexp = line.match(/^\/(.+)\/(.*)$/);
< 			if (regexp) {
< 				// check that the RegExp is valid
< 				try {
< 					new RegExp(regexp[1], regexp[2]);
< 					// note that regex lines will not be split by spaces!
< 				} catch (err: any) {
< 					// invalid syntax: do not save, do not reset changed flag
< 					os.alert({
< 						type: 'error',
< 						title: i18n.ts.regexpError,
< 						text: i18n.t('regexpErrorDescription', { tab, line: i + 1 }) + '\n' + err.toString(),
< 					});
< 					// re-throw error so these invalid settings are not saved
< 					throw err;
< 				}
< 			} else {
< 				lines[i] = line.split(' ');
< 			}
< 		}
---
>     // check each line if it is a RegExp or not
>     for (let i = 0; i < lines.length; i++) {
>       const line = lines[i];
>       const regexp = line.match(/^\/(.+)\/(.*)$/);
>       if (regexp) {
>         // check that the RegExp is valid
>         try {
>           new RegExp(regexp[1], regexp[2]);
>           // note that regex lines will not be split by spaces!
>         } catch (err: any) {
>           // invalid syntax: do not save, do not reset changed flag
>           os.alert({
>             type: "error",
>             title: i18n.ts.regexpError,
>             text:
>               i18n.t("regexpErrorDescription", { tab, line: i + 1 }) +
>               "\n" +
>               err.toString(),
>           });
>           // re-throw error so these invalid settings are not saved
>           throw err;
>         }
>       } else {
>         lines[i] = line.split(" ");
>       }
>     }
100,101c125,126
< 		return lines;
< 	};
---
>     return lines;
>   };
103,110c128,135
< 	let softMutes, hardMutes;
< 	try {
< 		softMutes = parseMutes(softMutedWords.value, i18n.ts._wordMute.soft);
< 		hardMutes = parseMutes(hardMutedWords.value, i18n.ts._wordMute.hard);
< 	} catch (err) {
< 		// already displayed error message in parseMutes
< 		return;
< 	}
---
>   let softMutes, hardMutes;
>   try {
>     softMutes = parseMutes(softMutedWords.value, i18n.ts._wordMute.soft);
>     hardMutes = parseMutes(hardMutedWords.value, i18n.ts._wordMute.hard);
>   } catch (err) {
>     // already displayed error message in parseMutes
>     return;
>   }
112,115c137,140
< 	defaultStore.set('mutedWords', softMutes);
< 	await os.api('i/update', {
< 		mutedWords: hardMutes,
< 	});
---
>   defaultStore.set("mutedWords", softMutes);
>   await os.api("i/update", {
>     mutedWords: hardMutes,
>   });
117c142
< 	changed.value = false;
---
>   changed.value = false;
125,126c150,151
< 	title: i18n.ts.wordMute,
< 	icon: 'ti ti-message-off',
---
>   title: i18n.ts.wordMute,
>   icon: "fas fa-comment-slash",
diff --color=auto -r misskeyV13/packages/frontend/src/pages/share.vue RiricaV13/pages/share.vue
2,21c2,29
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<XPostForm
< 			v-if="state === 'writing'"
< 			fixed
< 			:instant="true"
< 			:initial-text="initialText"
< 			:initial-visibility="visibility"
< 			:initial-files="files"
< 			:initial-local-only="localOnly"
< 			:reply="reply"
< 			:renote="renote"
< 			:initial-visible-users="visibleUsers"
< 			class="_panel"
< 			@posted="state = 'posted'"
< 		/>
< 		<MkButton v-else-if="state === 'posted'" primary class="close" @click="close()">{{ i18n.ts.close }}</MkButton>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <XPostForm
>         v-if="state === 'writing'"
>         fixed
>         :instant="true"
>         :initial-text="initialText"
>         :initial-visibility="visibility"
>         :initial-files="files"
>         :initial-local-only="localOnly"
>         :reply="reply"
>         :renote="renote"
>         :initial-visible-users="visibleUsers"
>         class="_panel"
>         @posted="state = 'posted'"
>       />
>       <MkButton
>         v-else-if="state === 'posted'"
>         primary
>         class="close"
>         @click="close()"
>         >{{ i18n.ts.close }}</MkButton
>       >
>     </MkSpacer>
>   </MkStickyContainer>
27,36c35,44
< import { } from 'vue';
< import { noteVisibilities } from 'misskey-js';
< import * as Acct from 'misskey-js/built/acct';
< import * as Misskey from 'misskey-js';
< import MkButton from '@/components/MkButton.vue';
< import XPostForm from '@/components/MkPostForm.vue';
< import * as os from '@/os';
< import { mainRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import { noteVisibilities } from "misskey-js";
> import * as Acct from "misskey-js/built/acct";
> import * as Misskey from "misskey-js";
> import MkButton from "@/components/MkButton.vue";
> import XPostForm from "@/components/MkPostForm.vue";
> import * as os from "@/os";
> import { mainRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
39,40c47,48
< const localOnlyQuery = urlParams.get('localOnly');
< const visibilityQuery = urlParams.get('visibility');
---
> const localOnlyQuery = urlParams.get("localOnly");
> const visibilityQuery = urlParams.get("visibility");
42,45c50,53
< let state = $ref('fetching' as 'fetching' | 'writing' | 'posted');
< let title = $ref(urlParams.get('title'));
< const text = urlParams.get('text');
< const url = urlParams.get('url');
---
> let state = $ref("fetching" as "fetching" | "writing" | "posted");
> let title = $ref(urlParams.get("title"));
> const text = urlParams.get("text");
> const url = urlParams.get("url");
49,50c57,62
< let visibility = $ref(noteVisibilities.includes(visibilityQuery) ? visibilityQuery : null);
< let localOnly = $ref(localOnlyQuery === '0' ? false : localOnlyQuery === '1' ? true : null);
---
> let visibility = $ref(
>   noteVisibilities.includes(visibilityQuery) ? visibilityQuery : null
> );
> let localOnly = $ref(
>   localOnlyQuery === "0" ? false : localOnlyQuery === "1" ? true : null
> );
55,61c67,74
< 	let noteText = '';
< 	if (title) noteText += `[ ${title} ]\n`;
< 	// Googleニュース対策
< 	if (text?.startsWith(`${title}.\n`)) noteText += text.replace(`${title}.\n`, '');
< 	else if (text && title !== text) noteText += `${text}\n`;
< 	if (url) noteText += `${url}`;
< 	initialText = noteText.trim();
---
>   let noteText = "";
>   if (title) noteText += `[ ${title} ]\n`;
>   // Googleニュース対策
>   if (text?.startsWith(`${title}.\n`))
>     noteText += text.replace(`${title}.\n`, "");
>   else if (text && title !== text) noteText += `${text}\n`;
>   if (url) noteText += `${url}`;
>   initialText = noteText.trim();
63,81c76,106
< 	if (visibility === 'specified') {
< 		const visibleUserIds = urlParams.get('visibleUserIds');
< 		const visibleAccts = urlParams.get('visibleAccts');
< 		await Promise.all(
< 			[
< 				...(visibleUserIds ? visibleUserIds.split(',').map(userId => ({ userId })) : []),
< 				...(visibleAccts ? visibleAccts.split(',').map(Acct.parse) : []),
< 			]
< 			// TypeScriptの指示通りに変換する
< 			.map(q => 'username' in q ? { username: q.username, host: q.host === null ? undefined : q.host } : q)
< 			.map(q => os.api('users/show', q)
< 				.then(user => {
< 					visibleUsers.push(user);
< 				}, () => {
< 					console.error(`Invalid user query: ${JSON.stringify(q)}`);
< 				}),
< 			),
< 		);
< 	}
---
>   if (visibility === "specified") {
>     const visibleUserIds = urlParams.get("visibleUserIds");
>     const visibleAccts = urlParams.get("visibleAccts");
>     await Promise.all(
>       [
>         ...(visibleUserIds
>           ? visibleUserIds.split(",").map((userId) => ({ userId }))
>           : []),
>         ...(visibleAccts ? visibleAccts.split(",").map(Acct.parse) : []),
>       ]
>         // TypeScriptの指示通りに変換する
>         .map((q) =>
>           "username" in q
>             ? {
>                 username: q.username,
>                 host: q.host === null ? undefined : q.host,
>               }
>             : q
>         )
>         .map((q) =>
>           os.api("users/show", q).then(
>             (user) => {
>               visibleUsers.push(user);
>             },
>             () => {
>               console.error(`Invalid user query: ${JSON.stringify(q)}`);
>             }
>           )
>         )
>     );
>   }
83,99c108,124
< 	try {
< 		//#region Reply
< 		const replyId = urlParams.get('replyId');
< 		const replyUri = urlParams.get('replyUri');
< 		if (replyId) {
< 			reply = await os.api('notes/show', {
< 				noteId: replyId,
< 			});
< 		} else if (replyUri) {
< 			const obj = await os.api('ap/show', {
< 				uri: replyUri,
< 			});
< 			if (obj.type === 'Note') {
< 				reply = obj.object;
< 			}
< 		}
< 		//#endregion
---
>   try {
>     //#region Reply
>     const replyId = urlParams.get("replyId");
>     const replyUri = urlParams.get("replyUri");
>     if (replyId) {
>       reply = await os.api("notes/show", {
>         noteId: replyId,
>       });
>     } else if (replyUri) {
>       const obj = await os.api("ap/show", {
>         uri: replyUri,
>       });
>       if (obj.type === "Note") {
>         reply = obj.object;
>       }
>     }
>     //#endregion
101,116c126,141
< 		//#region Renote
< 		const renoteId = urlParams.get('renoteId');
< 		const renoteUri = urlParams.get('renoteUri');
< 		if (renoteId) {
< 			renote = await os.api('notes/show', {
< 				noteId: renoteId,
< 			});
< 		} else if (renoteUri) {
< 			const obj = await os.api('ap/show', {
< 				uri: renoteUri,
< 			});
< 			if (obj.type === 'Note') {
< 				renote = obj.object;
< 			}
< 		}
< 		//#endregion
---
>     //#region Renote
>     const renoteId = urlParams.get("renoteId");
>     const renoteUri = urlParams.get("renoteUri");
>     if (renoteId) {
>       renote = await os.api("notes/show", {
>         noteId: renoteId,
>       });
>     } else if (renoteUri) {
>       const obj = await os.api("ap/show", {
>         uri: renoteUri,
>       });
>       if (obj.type === "Note") {
>         renote = obj.object;
>       }
>     }
>     //#endregion
118,139c143,166
< 		//#region Drive files
< 		const fileIds = urlParams.get('fileIds');
< 		if (fileIds) {
< 			await Promise.all(
< 				fileIds.split(',')
< 				.map(fileId => os.api('drive/files/show', { fileId })
< 					.then(file => {
< 						files.push(file);
< 					}, () => {
< 						console.error(`Failed to fetch a file ${fileId}`);
< 					}),
< 				),
< 			);
< 		}
< 		//#endregion
< 	} catch (err) {
< 		os.alert({
< 			type: 'error',
< 			title: err.message,
< 			text: err.name,
< 		});
< 	}
---
>     //#region Drive files
>     const fileIds = urlParams.get("fileIds");
>     if (fileIds) {
>       await Promise.all(
>         fileIds.split(",").map((fileId) =>
>           os.api("drive/files/show", { fileId }).then(
>             (file) => {
>               files.push(file);
>             },
>             () => {
>               console.error(`Failed to fetch a file ${fileId}`);
>             }
>           )
>         )
>       );
>     }
>     //#endregion
>   } catch (err) {
>     os.alert({
>       type: "error",
>       title: err.message,
>       text: err.name,
>     });
>   }
141c168
< 	state = 'writing';
---
>   state = "writing";
147c174
< 	window.close();
---
>   window.close();
149,152c176,179
< 	// 閉じなければ100ms後タイムラインに
< 	window.setTimeout(() => {
< 		mainRouter.push('/');
< 	}, 100);
---
>   // 閉じなければ100ms後タイムラインに
>   window.setTimeout(() => {
>     mainRouter.push("/");
>   }, 100);
160,161c187,188
< 	title: i18n.ts.share,
< 	icon: 'ti ti-share',
---
>   title: i18n.ts.share,
>   icon: "fas fa-share-alt",
167c194
< 	margin: 16px auto;
---
>   margin: 16px auto;
diff --color=auto -r misskeyV13/packages/frontend/src/pages/signup-complete.vue RiricaV13/pages/signup-complete.vue
2,4c2,4
< <div>
< 	{{ i18n.ts.processing }}
< </div>
---
>   <div>
>     {{ i18n.ts.processing }}
>   </div>
8,12c8,12
< import { onMounted } from 'vue';
< import * as os from '@/os';
< import { login } from '@/account';
< import { i18n } from '@/i18n';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { onMounted } from "vue";
> import * as os from "@/os";
> import { login } from "@/account";
> import { i18n } from "@/i18n";
> import { definePageMetadata } from "@/scripts/page-metadata";
15c15
< 	code: string;
---
>   code: string;
19,26c19,26
< 	await os.alert({
< 		type: 'info',
< 		text: i18n.t('clickToFinishEmailVerification', { ok: i18n.ts.gotIt }),
< 	});
< 	const res = await os.apiWithDialog('signup-pending', {
< 		code: props.code,
< 	});
< 	login(res.i, '/');
---
>   await os.alert({
>     type: "info",
>     text: i18n.t("clickToFinishEmailVerification", { ok: i18n.ts.gotIt }),
>   });
>   const res = await os.apiWithDialog("signup-pending", {
>     code: props.code,
>   });
>   login(res.i, "/");
34,35c34,35
< 	title: i18n.ts.signup,
< 	icon: 'ti ti-user',
---
>   title: i18n.ts.signup,
>   icon: "fas fa-user",
39,41c39
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/tag.vue RiricaV13/pages/tag.vue
2,7c2,9
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800">
< 		<XNotes class="" :pagination="pagination"/>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800">
>       <XNotes class="_content" :pagination="pagination" />
>     </MkSpacer>
>   </MkStickyContainer>
11,13c13,15
< import { computed } from 'vue';
< import XNotes from '@/components/MkNotes.vue';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { computed } from "vue";
> import XNotes from "@/components/MkNotes.vue";
> import { definePageMetadata } from "@/scripts/page-metadata";
16c18
< 	tag: string;
---
>   tag: string;
20,24c22,26
< 	endpoint: 'notes/search-by-tag' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		tag: props.tag,
< 	})),
---
>   endpoint: "notes/search-by-tag" as const,
>   limit: 10,
>   params: computed(() => ({
>     tag: props.tag,
>   })),
31,34c33,38
< definePageMetadata(computed(() => ({
< 	title: props.tag,
< 	icon: 'ti ti-hash',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: props.tag,
>     icon: "fas fa-hashtag",
>   }))
> );
diff --color=auto -r misskeyV13/packages/frontend/src/pages/theme-editor.vue RiricaV13/pages/theme-editor.vue
2,20c2,40
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
< 		<div class="cwepdizn _gaps_m">
< 			<MkFolder :default-open="true">
< 				<template #label>{{ i18n.ts.backgroundColor }}</template>
< 				<div class="cwepdizn-colors">
< 					<div class="row">
< 						<button v-for="color in bgColors.filter(x => x.kind === 'light')" :key="color.color" class="color _button" :class="{ active: theme.props.bg === color.color }" @click="setBgColor(color)">
< 							<div class="preview" :style="{ background: color.forPreview }"></div>
< 						</button>
< 					</div>
< 					<div class="row">
< 						<button v-for="color in bgColors.filter(x => x.kind === 'dark')" :key="color.color" class="color _button" :class="{ active: theme.props.bg === color.color }" @click="setBgColor(color)">
< 							<div class="preview" :style="{ background: color.forPreview }"></div>
< 						</button>
< 					</div>
< 				</div>
< 			</MkFolder>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="800" :margin-min="16" :margin-max="32">
>       <div class="cwepdizn _formRoot">
>         <FormFolder :default-open="true" class="_formBlock">
>           <template #label>{{ i18n.ts.backgroundColor }}</template>
>           <div class="cwepdizn-colors">
>             <div class="row">
>               <button
>                 v-for="color in bgColors.filter((x) => x.kind === 'light')"
>                 :key="color.color"
>                 class="color _button"
>                 :class="{ active: theme.props.bg === color.color }"
>                 @click="setBgColor(color)"
>               >
>                 <div
>                   class="preview"
>                   :style="{ background: color.forPreview }"
>                 ></div>
>               </button>
>             </div>
>             <div class="row">
>               <button
>                 v-for="color in bgColors.filter((x) => x.kind === 'dark')"
>                 :key="color.color"
>                 class="color _button"
>                 :class="{ active: theme.props.bg === color.color }"
>                 @click="setBgColor(color)"
>               >
>                 <div
>                   class="preview"
>                   :style="{ background: color.forPreview }"
>                 ></div>
>               </button>
>             </div>
>           </div>
>         </FormFolder>
22,31c42,57
< 			<MkFolder :default-open="true">
< 				<template #label>{{ i18n.ts.accentColor }}</template>
< 				<div class="cwepdizn-colors">
< 					<div class="row">
< 						<button v-for="color in accentColors" :key="color" class="color rounded _button" :class="{ active: theme.props.accent === color }" @click="setAccentColor(color)">
< 							<div class="preview" :style="{ background: color }"></div>
< 						</button>
< 					</div>
< 				</div>
< 			</MkFolder>
---
>         <FormFolder :default-open="true" class="_formBlock">
>           <template #label>{{ i18n.ts.accentColor }}</template>
>           <div class="cwepdizn-colors">
>             <div class="row">
>               <button
>                 v-for="color in accentColors"
>                 :key="color"
>                 class="color rounded _button"
>                 :class="{ active: theme.props.accent === color }"
>                 @click="setAccentColor(color)"
>               >
>                 <div class="preview" :style="{ background: color }"></div>
>               </button>
>             </div>
>           </div>
>         </FormFolder>
33,42c59,89
< 			<MkFolder :default-open="true">
< 				<template #label>{{ i18n.ts.textColor }}</template>
< 				<div class="cwepdizn-colors">
< 					<div class="row">
< 						<button v-for="color in fgColors" :key="color" class="color char _button" :class="{ active: (theme.props.fg === color.forLight) || (theme.props.fg === color.forDark) }" @click="setFgColor(color)">
< 							<div class="preview" :style="{ color: color.forPreview ? color.forPreview : theme.base === 'light' ? '#5f5f5f' : '#dadada' }">A</div>
< 						</button>
< 					</div>
< 				</div>
< 			</MkFolder>
---
>         <FormFolder :default-open="true" class="_formBlock">
>           <template #label>{{ i18n.ts.textColor }}</template>
>           <div class="cwepdizn-colors">
>             <div class="row">
>               <button
>                 v-for="color in fgColors"
>                 :key="color"
>                 class="color char _button"
>                 :class="{
>                   active:
>                     theme.props.fg === color.forLight ||
>                     theme.props.fg === color.forDark,
>                 }"
>                 @click="setFgColor(color)"
>               >
>                 <div
>                   class="preview"
>                   :style="{
>                     color: color.forPreview
>                       ? color.forPreview
>                       : theme.base === 'light'
>                       ? '#5f5f5f'
>                       : '#dadada',
>                   }"
>                 >
>                   A
>                 </div>
>               </button>
>             </div>
>           </div>
>         </FormFolder>
44,46c91,93
< 			<MkFolder :default-open="false">
< 				<template #icon><i class="ti ti-code"></i></template>
< 				<template #label>{{ i18n.ts.editCode }}</template>
---
>         <FormFolder :default-open="false" class="_formBlock">
>           <template #icon><i class="fas fa-code"></i></template>
>           <template #label>{{ i18n.ts.editCode }}</template>
48,54c95,103
< 				<div class="_gaps_m">
< 					<MkTextarea v-model="themeCode" tall>
< 						<template #label>{{ i18n.ts._theme.code }}</template>
< 					</MkTextarea>
< 					<MkButton primary @click="applyThemeCode">{{ i18n.ts.apply }}</MkButton>
< 				</div>
< 			</MkFolder>
---
>           <div class="_formRoot">
>             <FormTextarea v-model="themeCode" tall class="_formBlock">
>               <template #label>{{ i18n.ts._theme.code }}</template>
>             </FormTextarea>
>             <FormButton primary class="_formBlock" @click="applyThemeCode">{{
>               i18n.ts.apply
>             }}</FormButton>
>           </div>
>         </FormFolder>
56,57c105,106
< 			<MkFolder :default-open="false">
< 				<template #label>{{ i18n.ts.addDescription }}</template>
---
>         <FormFolder :default-open="false" class="_formBlock">
>           <template #label>{{ i18n.ts.addDescription }}</template>
59,67c108,116
< 				<div class="_gaps_m">
< 					<MkTextarea v-model="description">
< 						<template #label>{{ i18n.ts._theme.description }}</template>
< 					</MkTextarea>
< 				</div>
< 			</MkFolder>
< 		</div>
< 	</MkSpacer>
< </MkStickyContainer>
---
>           <div class="_formRoot">
>             <FormTextarea v-model="description">
>               <template #label>{{ i18n.ts._theme.description }}</template>
>             </FormTextarea>
>           </div>
>         </FormFolder>
>       </div>
>     </MkSpacer>
>   </MkStickyContainer>
71,75c120,124
< import { watch } from 'vue';
< import { toUnicode } from 'punycode/';
< import tinycolor from 'tinycolor2';
< import { v4 as uuid } from 'uuid';
< import JSON5 from 'json5';
---
> import { watch } from "vue";
> import { toUnicode } from "punycode/";
> import tinycolor from "tinycolor2";
> import { v4 as uuid } from "uuid";
> import JSON5 from "json5";
77,79c126,128
< import MkButton from '@/components/MkButton.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkFolder from '@/components/MkFolder.vue';
---
> import FormButton from "@/components/MkButton.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormFolder from "@/components/form/folder.vue";
81,91c130,140
< import { $i } from '@/account';
< import { Theme, applyTheme } from '@/scripts/theme';
< import lightTheme from '@/themes/_light.json5';
< import darkTheme from '@/themes/_dark.json5';
< import { host } from '@/config';
< import * as os from '@/os';
< import { ColdDeviceStorage, defaultStore } from '@/store';
< import { addTheme } from '@/theme-store';
< import { i18n } from '@/i18n';
< import { useLeaveGuard } from '@/scripts/use-leave-guard';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { $i } from "@/account";
> import { Theme, applyTheme } from "@/scripts/theme";
> import lightTheme from "@/themes/_light.json5";
> import darkTheme from "@/themes/_dark.json5";
> import { host } from "@/config";
> import * as os from "@/os";
> import { ColdDeviceStorage, defaultStore } from "@/store";
> import { addTheme } from "@/theme-store";
> import { i18n } from "@/i18n";
> import { useLeaveGuard } from "@/scripts/use-leave-guard";
> import { definePageMetadata } from "@/scripts/page-metadata";
94,109c143,158
< 	{ color: '#f5f5f5', kind: 'light', forPreview: '#f5f5f5' },
< 	{ color: '#f0eee9', kind: 'light', forPreview: '#f3e2b9' },
< 	{ color: '#e9eff0', kind: 'light', forPreview: '#bfe3e8' },
< 	{ color: '#f0e9ee', kind: 'light', forPreview: '#f1d1e8' },
< 	{ color: '#dce2e0', kind: 'light', forPreview: '#a4dccc' },
< 	{ color: '#e2e0dc', kind: 'light', forPreview: '#d8c7a5' },
< 	{ color: '#d5dbe0', kind: 'light', forPreview: '#b0cae0' },
< 	{ color: '#dad5d5', kind: 'light', forPreview: '#d6afaf' },
< 	{ color: '#2b2b2b', kind: 'dark', forPreview: '#444444' },
< 	{ color: '#362e29', kind: 'dark', forPreview: '#735c4d' },
< 	{ color: '#303629', kind: 'dark', forPreview: '#506d2f' },
< 	{ color: '#293436', kind: 'dark', forPreview: '#258192' },
< 	{ color: '#2e2936', kind: 'dark', forPreview: '#504069' },
< 	{ color: '#252722', kind: 'dark', forPreview: '#3c462f' },
< 	{ color: '#212525', kind: 'dark', forPreview: '#303e3e' },
< 	{ color: '#191919', kind: 'dark', forPreview: '#272727' },
---
>   { color: "#f5f5f5", kind: "light", forPreview: "#f5f5f5" },
>   { color: "#f0eee9", kind: "light", forPreview: "#f3e2b9" },
>   { color: "#e9eff0", kind: "light", forPreview: "#bfe3e8" },
>   { color: "#f0e9ee", kind: "light", forPreview: "#f1d1e8" },
>   { color: "#dce2e0", kind: "light", forPreview: "#a4dccc" },
>   { color: "#e2e0dc", kind: "light", forPreview: "#d8c7a5" },
>   { color: "#d5dbe0", kind: "light", forPreview: "#b0cae0" },
>   { color: "#dad5d5", kind: "light", forPreview: "#d6afaf" },
>   { color: "#2b2b2b", kind: "dark", forPreview: "#444444" },
>   { color: "#362e29", kind: "dark", forPreview: "#735c4d" },
>   { color: "#303629", kind: "dark", forPreview: "#506d2f" },
>   { color: "#293436", kind: "dark", forPreview: "#258192" },
>   { color: "#2e2936", kind: "dark", forPreview: "#504069" },
>   { color: "#252722", kind: "dark", forPreview: "#3c462f" },
>   { color: "#212525", kind: "dark", forPreview: "#303e3e" },
>   { color: "#191919", kind: "dark", forPreview: "#272727" },
111c160,169
< const accentColors = ['#e36749', '#f29924', '#98c934', '#34c9a9', '#34a1c9', '#606df7', '#8d34c9', '#e84d83'];
---
> const accentColors = [
>   "#e36749",
>   "#f29924",
>   "#98c934",
>   "#34c9a9",
>   "#34a1c9",
>   "#606df7",
>   "#8d34c9",
>   "#e84d83",
> ];
113,119c171,207
< 	{ color: 'none', forLight: '#5f5f5f', forDark: '#dadada', forPreview: null },
< 	{ color: 'red', forLight: '#7f6666', forDark: '#e4d1d1', forPreview: '#ca4343' },
< 	{ color: 'yellow', forLight: '#736955', forDark: '#e0d5c0', forPreview: '#d49923' },
< 	{ color: 'green', forLight: '#586d5b', forDark: '#d1e4d4', forPreview: '#4cbd5c' },
< 	{ color: 'cyan', forLight: '#5d7475', forDark: '#d1e3e4', forPreview: '#2abdc3' },
< 	{ color: 'blue', forLight: '#676880', forDark: '#d1d2e4', forPreview: '#7275d8' },
< 	{ color: 'pink', forLight: '#84667d', forDark: '#e4d1e0', forPreview: '#b12390' },
---
>   { color: "none", forLight: "#5f5f5f", forDark: "#dadada", forPreview: null },
>   {
>     color: "red",
>     forLight: "#7f6666",
>     forDark: "#e4d1d1",
>     forPreview: "#ca4343",
>   },
>   {
>     color: "yellow",
>     forLight: "#736955",
>     forDark: "#e0d5c0",
>     forPreview: "#d49923",
>   },
>   {
>     color: "green",
>     forLight: "#586d5b",
>     forDark: "#d1e4d4",
>     forPreview: "#4cbd5c",
>   },
>   {
>     color: "cyan",
>     forLight: "#5d7475",
>     forDark: "#d1e3e4",
>     forPreview: "#2abdc3",
>   },
>   {
>     color: "blue",
>     forLight: "#676880",
>     forDark: "#d1d2e4",
>     forPreview: "#7275d8",
>   },
>   {
>     color: "pink",
>     forLight: "#84667d",
>     forDark: "#e4d1e0",
>     forPreview: "#b12390",
>   },
123,124c211,212
< 	base: 'light',
< 	props: lightTheme.props,
---
>   base: "light",
>   props: lightTheme.props,
133c221
< 	os.pageWindow('/preview');
---
>   os.pageWindow("/preview");
137,146c225,234
< 	if (theme.base !== color.kind) {
< 		const base = color.kind === 'dark' ? darkTheme : lightTheme;
< 		for (const prop of Object.keys(base.props)) {
< 			if (prop === 'accent') continue;
< 			if (prop === 'fg') continue;
< 			theme.props[prop] = base.props[prop];
< 		}
< 	}
< 	theme.base = color.kind;
< 	theme.props.bg = color.color;
---
>   if (theme.base !== color.kind) {
>     const base = color.kind === "dark" ? darkTheme : lightTheme;
>     for (const prop of Object.keys(base.props)) {
>       if (prop === "accent") continue;
>       if (prop === "fg") continue;
>       theme.props[prop] = base.props[prop];
>     }
>   }
>   theme.base = color.kind;
>   theme.props.bg = color.color;
148,151c236,244
< 	if (theme.props.fg) {
< 		const matchedFgColor = fgColors.find(x => [tinycolor(x.forLight).toRgbString(), tinycolor(x.forDark).toRgbString()].includes(tinycolor(theme.props.fg).toRgbString()));
< 		if (matchedFgColor) setFgColor(matchedFgColor);
< 	}
---
>   if (theme.props.fg) {
>     const matchedFgColor = fgColors.find((x) =>
>       [
>         tinycolor(x.forLight).toRgbString(),
>         tinycolor(x.forDark).toRgbString(),
>       ].includes(tinycolor(theme.props.fg).toRgbString())
>     );
>     if (matchedFgColor) setFgColor(matchedFgColor);
>   }
155c248
< 	theme.props.accent = color;
---
>   theme.props.accent = color;
159c252
< 	theme.props.fg = theme.base === 'light' ? color.forLight : color.forDark;
---
>   theme.props.fg = theme.base === "light" ? color.forLight : color.forDark;
163,165c256,258
< 	themeCode = JSON5.stringify(theme, null, '\t');
< 	applyTheme(theme, false);
< 	changed = true;
---
>   themeCode = JSON5.stringify(theme, null, "\t");
>   applyTheme(theme, false);
>   changed = true;
169c262
< 	let parsed;
---
>   let parsed;
171,179c264,272
< 	try {
< 		parsed = JSON5.parse(themeCode);
< 	} catch (err) {
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts._theme.invalid,
< 		});
< 		return;
< 	}
---
>   try {
>     parsed = JSON5.parse(themeCode);
>   } catch (err) {
>     os.alert({
>       type: "error",
>       text: i18n.ts._theme.invalid,
>     });
>     return;
>   }
181c274
< 	theme = parsed;
---
>   theme = parsed;
185,189c278,282
< 	const { canceled, result: name } = await os.inputText({
< 		title: i18n.ts.name,
< 		allowEmpty: false,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: name } = await os.inputText({
>     title: i18n.ts.name,
>     allowEmpty: false,
>   });
>   if (canceled) return;
191,206c284,299
< 	theme.id = uuid();
< 	theme.name = name;
< 	theme.author = `@${$i.username}@${toUnicode(host)}`;
< 	if (description) theme.desc = description;
< 	await addTheme(theme);
< 	applyTheme(theme);
< 	if (defaultStore.state.darkMode) {
< 		ColdDeviceStorage.set('darkTheme', theme);
< 	} else {
< 		ColdDeviceStorage.set('lightTheme', theme);
< 	}
< 	changed = false;
< 	os.alert({
< 		type: 'success',
< 		text: i18n.t('_theme.installed', { name: theme.name }),
< 	});
---
>   theme.id = uuid();
>   theme.name = name;
>   theme.author = `@${$i.username}@${toUnicode(host)}`;
>   if (description) theme.desc = description;
>   await addTheme(theme);
>   applyTheme(theme);
>   if (defaultStore.state.darkMode) {
>     ColdDeviceStorage.set("darkTheme", theme);
>   } else {
>     ColdDeviceStorage.set("lightTheme", theme);
>   }
>   changed = false;
>   os.alert({
>     type: "success",
>     text: i18n.t("_theme.installed", { name: theme.name }),
>   });
211,221c304,317
< const headerActions = $computed(() => [{
< 	asFullButton: true,
< 	icon: 'ti ti-eye',
< 	text: i18n.ts.preview,
< 	handler: showPreview,
< }, {
< 	asFullButton: true,
< 	icon: 'ti ti-check',
< 	text: i18n.ts.saveAs,
< 	handler: saveAs,
< }]);
---
> const headerActions = $computed(() => [
>   {
>     asFullButton: true,
>     icon: "fas fa-eye",
>     text: i18n.ts.preview,
>     handler: showPreview,
>   },
>   {
>     asFullButton: true,
>     icon: "fas fa-check",
>     text: i18n.ts.saveAs,
>     handler: saveAs,
>   },
> ]);
226,227c322,323
< 	title: i18n.ts.themeEditor,
< 	icon: 'ti ti-palette',
---
>   title: i18n.ts.themeEditor,
>   icon: "fas fa-palette",
233,234c329,330
< 	::v-deep(.cwepdizn-colors) {
< 		text-align: center;
---
>   ::v-deep(.cwepdizn-colors) {
>     text-align: center;
236,242c332,338
< 		> .row {
< 			> .color {
< 				display: inline-block;
< 				position: relative;
< 				width: 64px;
< 				height: 64px;
< 				border-radius: 8px;
---
>     > .row {
>       > .color {
>         display: inline-block;
>         position: relative;
>         width: 64px;
>         height: 64px;
>         border-radius: 8px;
244,256c340,352
< 				> .preview {
< 					position: absolute;
< 					top: 0;
< 					left: 0;
< 					right: 0;
< 					bottom: 0;
< 					margin: auto;
< 					width: 42px;
< 					height: 42px;
< 					border-radius: 4px;
< 					box-shadow: 0 2px 4px rgb(0 0 0 / 30%);
< 					transition: transform 0.15s ease;
< 				}
---
>         > .preview {
>           position: absolute;
>           top: 0;
>           left: 0;
>           right: 0;
>           bottom: 0;
>           margin: auto;
>           width: 42px;
>           height: 42px;
>           border-radius: 4px;
>           box-shadow: 0 2px 4px rgb(0 0 0 / 30%);
>           transition: transform 0.15s ease;
>         }
258,262c354,358
< 				&:hover {
< 					> .preview {
< 						transform: scale(1.1);
< 					}
< 				}
---
>         &:hover {
>           > .preview {
>             transform: scale(1.1);
>           }
>         }
264,266c360,362
< 				&.active {
< 					box-shadow: 0 0 0 2px var(--divider) inset;
< 				}
---
>         &.active {
>           box-shadow: 0 0 0 2px var(--divider) inset;
>         }
268,269c364,365
< 				&.rounded {
< 					border-radius: 999px;
---
>         &.rounded {
>           border-radius: 999px;
271,274c367,370
< 					> .preview {
< 						border-radius: 999px;
< 					}
< 				}
---
>           > .preview {
>             border-radius: 999px;
>           }
>         }
276,281c372,377
< 				&.char {
< 					line-height: 42px;
< 				}
< 			}
< 		}
< 	}
---
>         &.char {
>           line-height: 42px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/timeline.tutorial.vue RiricaV13/pages/timeline.tutorial.vue
2,66c2,57
< <div :class="$style.container">
< 	<div :class="$style.title">
< 		<div :class="$style.titleText"><i class="ti ti-info-circle"></i> {{ i18n.ts._tutorial.title }}</div>
< 		<div :class="$style.step">
< 			<button class="_button" :class="$style.stepArrow" :disabled="tutorial === 0" @click="tutorial--">
< 				<i class="ti ti-chevron-left"></i>
< 			</button>
< 			<span :class="$style.stepNumber">{{ tutorial + 1 }} / {{ tutorialsNumber }}</span>
< 			<button class="_button" :class="$style.stepArrow" :disabled="tutorial === tutorialsNumber - 1" @click="tutorial++">
< 				<i class="ti ti-chevron-right"></i>
< 			</button>
< 		</div>
< 	</div>
< 	<div v-if="tutorial === 0" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step1_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step1_2 }}</div>
< 		<div>{{ i18n.ts._tutorial.step1_3 }}</div>
< 	</div>
< 	<div v-else-if="tutorial === 1" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step2_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step2_2 }}</div>
< 		<MkA class="_link" to="/settings/profile">{{ i18n.ts.editProfile }}</MkA>
< 	</div>
< 	<div v-else-if="tutorial === 2" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step3_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step3_2 }}</div>
< 		<div>{{ i18n.ts._tutorial.step3_3 }}</div>
< 		<small :class="$style.small">{{ i18n.ts._tutorial.step3_4 }}</small>
< 	</div>
< 	<div v-else-if="tutorial === 3" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step4_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step4_2 }}</div>
< 	</div>
< 	<div v-else-if="tutorial === 4" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step5_1 }}</div>
< 		<I18n :src="i18n.ts._tutorial.step5_2" tag="div">
< 			<template #featured>
< 				<MkA class="_link" to="/explore">{{ i18n.ts.featured }}</MkA>
< 			</template>
< 			<template #explore>
< 				<MkA class="_link" to="/explore#users">{{ i18n.ts.explore }}</MkA>
< 			</template>
< 		</I18n>
< 		<div>{{ i18n.ts._tutorial.step5_3 }}</div>
< 		<small :class="$style.small">{{ i18n.ts._tutorial.step5_4 }}</small>
< 	</div>
< 	<div v-else-if="tutorial === 5" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step6_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step6_2 }}</div>
< 		<div>{{ i18n.ts._tutorial.step6_3 }}</div>
< 	</div>
< 	<div v-else-if="tutorial === 6" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step7_1 }}</div>
< 		<I18n :src="i18n.ts._tutorial.step7_2" tag="div">
< 			<template #help>
< 				<a href="https://misskey-hub.net/help.html" target="_blank" class="_link">{{ i18n.ts.help }}</a>
< 			</template>
< 		</I18n>
< 		<div>{{ i18n.ts._tutorial.step7_3 }}</div>
< 	</div>
< 	<div v-else-if="tutorial === 7" :class="$style.body">
< 		<div>{{ i18n.ts._tutorial.step8_1 }}</div>
< 		<div>{{ i18n.ts._tutorial.step8_2 }}</div>
< 		<small :class="$style.small">{{ i18n.ts._tutorial.step8_3 }}</small>
< 	</div>
---
>   <div class="_card tbkwesmv">
>     <div class="_title">
>       <i class="fas fa-info-circle"></i> {{ i18n.ts._tutorial.title }}
>     </div>
>     <div v-if="tutorial === 0" class="_content">
>       <div>{{ i18n.ts._tutorial.step1_1 }}</div>
>       <div>{{ i18n.ts._tutorial.step1_2 }}</div>
>       <div>{{ i18n.ts._tutorial.step1_3 }}</div>
>     </div>
>     <div v-else-if="tutorial === 1" class="_content">
>       <div>{{ i18n.ts._tutorial.step2_1 }}</div>
>       <div>{{ i18n.ts._tutorial.step2_2 }}</div>
>       <MkA class="_link" to="/settings/profile">{{ i18n.ts.editProfile }}</MkA>
>     </div>
>     <div v-else-if="tutorial === 2" class="_content">
>       <div>{{ i18n.ts._tutorial.step3_1 }}</div>
>       <div>{{ i18n.ts._tutorial.step3_2 }}</div>
>       <div>{{ i18n.ts._tutorial.step3_3 }}</div>
>       <small>{{ i18n.ts._tutorial.step3_4 }}</small>
>     </div>
>     <div v-else-if="tutorial === 3" class="_content">
>       <div>{{ i18n.ts._tutorial.step4_1 }}</div>
>       <div>{{ i18n.ts._tutorial.step4_2 }}</div>
>     </div>
>     <div v-else-if="tutorial === 4" class="_content">
>       <div>{{ i18n.ts._tutorial.step5_1 }}</div>
>       <I18n :src="i18n.ts._tutorial.step5_2" tag="div">
>         <template #featured>
>           <MkA class="_link" to="/featured">{{ i18n.ts.featured }}</MkA>
>         </template>
>         <template #explore>
>           <MkA class="_link" to="/explore">{{ i18n.ts.explore }}</MkA>
>         </template>
>       </I18n>
>       <div>{{ i18n.ts._tutorial.step5_3 }}</div>
>       <small>{{ i18n.ts._tutorial.step5_4 }}</small>
>     </div>
>     <div v-else-if="tutorial === 5" class="_content">
>       <div>{{ i18n.ts._tutorial.step6_1 }}</div>
>       <div>{{ i18n.ts._tutorial.step6_2 }}</div>
>       <div>{{ i18n.ts._tutorial.step6_3 }}</div>
>     </div>
>     <div v-else-if="tutorial === 6" class="_content">
>       <div>{{ i18n.ts._tutorial.step7_1 }}</div>
>       <I18n :src="i18n.ts._tutorial.step7_2" tag="div">
>         <template #help>
>           <a
>             href="https://misskey-hub.net/help.html"
>             target="_blank"
>             class="_link"
>             >{{ i18n.ts.help }}</a
>           >
>         </template>
>       </I18n>
>       <div>{{ i18n.ts._tutorial.step7_3 }}</div>
>     </div>
68,77c59,84
< 	<div :class="$style.footer">
< 		<template v-if="tutorial === tutorialsNumber - 1">
< 			<MkPushNotificationAllowButton :class="$style.footerItem" primary show-only-to-register @click="tutorial = -1"/>
< 			<MkButton :class="$style.footerItem" :primary="false" @click="tutorial = -1">{{ i18n.ts.noThankYou }}</MkButton>
< 		</template>
< 		<template v-else>
< 			<MkButton :class="$style.footerItem" primary @click="tutorial++"><i class="ti ti-check"></i> {{ i18n.ts.next }}</MkButton>
< 		</template>
< 	</div>
< </div>
---
>     <div class="_footer navigation">
>       <div class="step">
>         <button
>           class="arrow _button"
>           :disabled="tutorial === 0"
>           @click="tutorial--"
>         >
>           <i class="fas fa-chevron-left"></i>
>         </button>
>         <span>{{ tutorial + 1 }} / 7</span>
>         <button
>           class="arrow _button"
>           :disabled="tutorial === 6"
>           @click="tutorial++"
>         >
>           <i class="fas fa-chevron-right"></i>
>         </button>
>       </div>
>       <MkButton v-if="tutorial === 6" class="ok" primary @click="tutorial = -1"
>         ><i class="fas fa-check"></i> {{ i18n.ts.gotIt }}</MkButton
>       >
>       <MkButton v-else class="ok" primary @click="tutorial++"
>         ><i class="fas fa-check"></i> {{ i18n.ts.next }}</MkButton
>       >
>     </div>
>   </div>
81,85c88,91
< import { computed } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkPushNotificationAllowButton from '@/components/MkPushNotificationAllowButton.vue';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
---
> import { computed } from "vue";
> import MkButton from "@/components/MkButton.vue";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
87,88d92
< const tutorialsNumber = 8;
< 
90,91c94,99
< 	get() { return defaultStore.reactiveState.tutorial.value || 0; },
< 	set(value) { defaultStore.set('tutorial', value); },
---
>   get() {
>     return defaultStore.reactiveState.tutorial.value || 0;
>   },
>   set(value) {
>     defaultStore.set("tutorial", value);
>   },
95,98c103,109
< <style lang="scss" module>
< .small {
< 	opacity: 0.7;
< }
---
> <style lang="scss" scoped>
> .tbkwesmv {
>   > ._content {
>     > small {
>       opacity: 0.7;
>     }
>   }
100,102c111,114
< .container {
< 	border: solid 2px var(--accent);
< }
---
>   > .navigation {
>     display: flex;
>     flex-direction: row;
>     align-items: baseline;
104,108c116,118
< .title {
< 	display: flex;
< 	flex-wrap: wrap;
< 	padding: 22px 32px;
< 	font-weight: bold;
---
>     > .step {
>       > .arrow {
>         padding: 4px;
110,114c120,122
< 	&Text {
< 		margin: 4px 0;
< 		padding-right: 4px;
< 	}
< }
---
>         &:disabled {
>           opacity: 0.5;
>         }
116,117c124,126
< .step {
< 	margin-left: auto;
---
>         &:first-child {
>           padding-right: 8px;
>         }
119,130c128,131
< 	&Arrow {
< 		padding: 4px;
< 		&:disabled {
< 			opacity: 0.5;
< 		}
< 		&:first-child {
< 			padding-right: 8px;
< 		}
< 		&:last-child {
< 			padding-left: 8px;
< 		}
< 	}
---
>         &:last-child {
>           padding-left: 8px;
>         }
>       }
132,136c133,136
< 	&Number {
< 		font-weight: normal;
< 		margin: 4px;
< 	}
< }
---
>       > span {
>         margin: 0 4px;
>       }
>     }
138,151c138,141
< .body {
< 	padding: 0 32px;
< }
< 
< .footer {
< 	display: flex;
< 	flex-wrap: wrap;
< 	flex-direction: row;
< 	justify-content: right;
< 	padding: 22px 32px;
< 
< 	&Item {
< 		margin: 4px;
< 	}
---
>     > .ok {
>       margin-left: auto;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/timeline.vue RiricaV13/pages/timeline.vue
3c3,10
< 	<template #header><MkPageHeader v-model:tab="src" :actions="headerActions" :tabs="headerTabs" :display-my-avatar="true"/></template>
---
> 	<template #header>
> 		<MkPageHeader
> 			v-model:tab="src"
> 			:actions="headerActions"
> 			:tabs="headerTabs"
> 			:display-my-avatar="true"
> 		/>
> 	</template>
5,7c12,17
< 		<div ref="rootEl" v-hotkey.global="keymap">
< 			<XTutorial v-if="$store.reactiveState.tutorial.value != -1" class="_panel" style="margin-bottom: var(--margin);"/>
< 			<XPostForm v-if="$store.reactiveState.showFixedPostForm.value" :class="$style.postForm" class="post-form _panel" fixed style="margin-bottom: var(--margin);"/>
---
> 		<div ref="rootEl" v-hotkey.global="keymap" class="cmuxhskf">
> 			<XPostForm
> 				v-if="$store.reactiveState.showFixedPostForm.value"
> 				class="post-form _block"
> 				fixed
> 			/>
9,10c19,24
< 			<div v-if="queue > 0" :class="$style.new"><button class="_buttonPrimary" @click="top()">{{ i18n.ts.newNoteRecived }}</button></div>
< 			<div :class="$style.tl">
---
> 			<div v-if="queue > 0" class="new">
> 				<button class="_buttonPrimary" @click="top()">
> 					{{ i18n.ts.newNoteRecived }}
> 				</button>
> 			</div>
> 			<div class="tl _block">
12c26
< 					ref="tlComponent"
---
> 					ref="tl"
13a28
> 					class="tl"
25,34c40,52
< import { defineAsyncComponent, computed, watch } from 'vue';
< import XTimeline from '@/components/MkTimeline.vue';
< import XPostForm from '@/components/MkPostForm.vue';
< import { scroll } from '@/scripts/scroll';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import { $i } from '@/account';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import { defineAsyncComponent, computed, watch } from "vue";
> import XTimeline from "@/components/MkTimeline.vue";
> import XPostForm from "@/components/MkPostForm.vue";
> import { scroll } from "@/scripts/scroll";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import { $i } from "@/account";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import OneSignal from "onesignal-cordova-plugin";
> import {Device} from "@capacitor/device";
> import { storedDeviceInfo } from "@/main";
36d53
< const XTutorial = defineAsyncComponent(() => import('./timeline.tutorial.vue'));
38,39c55,62
< const isLocalTimelineAvailable = ($i == null && instance.policies.ltlAvailable) || ($i != null && $i.policies.ltlAvailable);
< const isGlobalTimelineAvailable = ($i == null && instance.policies.gtlAvailable) || ($i != null && $i.policies.gtlAvailable);
---
> const XTutorial = defineAsyncComponent(() => import("./timeline.tutorial.vue"));
> 
> const isLocalTimelineAvailable =
>   !instance.disableLocalTimeline ||
>   ($i != null && ($i.isModerator || $i.isAdmin));
> const isGlobalTimelineAvailable =
>   !instance.disableGlobalTimeline ||
>   ($i != null && ($i.isModerator || $i.isAdmin));
41c64
< 	't': focus,
---
>   t: focus,
44,45c67,68
< const tlComponent = $shallowRef<InstanceType<typeof XTimeline>>();
< const rootEl = $shallowRef<HTMLElement>();
---
> const tlComponent = $ref<InstanceType<typeof XTimeline>>();
> const rootEl = $ref<HTMLElement>();
48c71,74
< const src = $computed({ get: () => defaultStore.reactiveState.tl.value.src, set: (x) => saveSrc(x) });
---
> const src = $computed({
>   get: () => defaultStore.reactiveState.tl.value.src,
>   set: (x) => saveSrc(x),
> });
50c76
< watch ($$(src), () => queue = 0);
---
> watch($$(src), () => (queue = 0));
53c79
< 	queue = q;
---
>   queue = q;
57c83
< 	scroll(rootEl, { top: 0 });
---
>   scroll(rootEl, { top: 0 });
61,67c87,93
< 	const lists = await os.api('users/lists/list');
< 	const items = lists.map(list => ({
< 		type: 'link' as const,
< 		text: list.name,
< 		to: `/timeline/list/${list.id}`,
< 	}));
< 	os.popupMenu(items, ev.currentTarget ?? ev.target);
---
>   const lists = await os.api("users/lists/list");
>   const items = lists.map((list) => ({
>     type: "link" as const,
>     text: list.name,
>     to: `/timeline/list/${list.id}`,
>   }));
>   os.popupMenu(items, ev.currentTarget ?? ev.target);
71,78c97,104
< 	const antennas = await os.api('antennas/list');
< 	const items = antennas.map(antenna => ({
< 		type: 'link' as const,
< 		text: antenna.name,
< 		indicate: antenna.hasUnreadNote,
< 		to: `/timeline/antenna/${antenna.id}`,
< 	}));
< 	os.popupMenu(items, ev.currentTarget ?? ev.target);
---
>   const antennas = await os.api("antennas/list");
>   const items = antennas.map((antenna) => ({
>     type: "link" as const,
>     text: antenna.name,
>     indicate: antenna.hasUnreadNote,
>     to: `/timeline/antenna/${antenna.id}`,
>   }));
>   os.popupMenu(items, ev.currentTarget ?? ev.target);
82,89c108,115
< 	const channels = await os.api('channels/followed');
< 	const items = channels.map(channel => ({
< 		type: 'link' as const,
< 		text: channel.name,
< 		indicate: channel.hasUnreadNote,
< 		to: `/channels/${channel.id}`,
< 	}));
< 	os.popupMenu(items, ev.currentTarget ?? ev.target);
---
>   const channels = await os.api("channels/followed");
>   const items = channels.map((channel) => ({
>     type: "link" as const,
>     text: channel.name,
>     indicate: channel.hasUnreadNote,
>     to: `/channels/${channel.id}`,
>   }));
>   os.popupMenu(items, ev.currentTarget ?? ev.target);
92,96c118,122
< function saveSrc(newSrc: 'home' | 'local' | 'social' | 'global'): void {
< 	defaultStore.set('tl', {
< 		...defaultStore.state.tl,
< 		src: newSrc,
< 	});
---
> function saveSrc(newSrc: "home" | "local" | "social" | "global"): void {
>   defaultStore.set("tl", {
>     ...defaultStore.state.tl,
>     src: newSrc,
>   });
100,103c126,129
< 	const { canceled, result: date } = await os.inputDate({
< 		title: i18n.ts.date,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: date } = await os.inputDate({
>     title: i18n.ts.date,
>   });
>   if (canceled) return;
105c131
< 	tlComponent.timetravel(date);
---
>   tlComponent.timetravel(date);
109c135
< 	tlComponent.focus();
---
>   tlComponent.focus();
114,149c140,191
< const headerTabs = $computed(() => [{
< 	key: 'home',
< 	title: i18n.ts._timelines.home,
< 	icon: 'ti ti-home',
< 	iconOnly: true,
< }, ...(isLocalTimelineAvailable ? [{
< 	key: 'local',
< 	title: i18n.ts._timelines.local,
< 	icon: 'ti ti-planet',
< 	iconOnly: true,
< }, {
< 	key: 'social',
< 	title: i18n.ts._timelines.social,
< 	icon: 'ti ti-rocket',
< 	iconOnly: true,
< }] : []), ...(isGlobalTimelineAvailable ? [{
< 	key: 'global',
< 	title: i18n.ts._timelines.global,
< 	icon: 'ti ti-whirl',
< 	iconOnly: true,
< }] : []), {
< 	icon: 'ti ti-list',
< 	title: i18n.ts.lists,
< 	iconOnly: true,
< 	onClick: chooseList,
< }, {
< 	icon: 'ti ti-antenna',
< 	title: i18n.ts.antennas,
< 	iconOnly: true,
< 	onClick: chooseAntenna,
< }, {
< 	icon: 'ti ti-device-tv',
< 	title: i18n.ts.channel,
< 	iconOnly: true,
< 	onClick: chooseChannel,
< }]);
---
> const headerTabs = $computed(() => [
>   {
>     key: "home",
>     title: i18n.ts._timelines.home,
>     icon: "fas fa-home",
>     iconOnly: true,
>   },
>   ...(isLocalTimelineAvailable
>     ? [
>         {
>           key: "local",
>           title: i18n.ts._timelines.local,
>           icon: "fas fa-comments",
>           iconOnly: true,
>         },
>         {
>           key: "social",
>           title: i18n.ts._timelines.social,
>           icon: "fas fa-share-alt",
>           iconOnly: true,
>         },
>       ]
>     : []),
>   ...(isGlobalTimelineAvailable
>     ? [
>         {
>           key: "global",
>           title: i18n.ts._timelines.global,
>           icon: "fas fa-globe",
>           iconOnly: true,
>         },
>       ]
>     : []),
>   {
>     icon: "fas fa-list-ul",
>     title: i18n.ts.lists,
>     iconOnly: true,
>     onClick: chooseList,
>   },
>   {
>     icon: "fas fa-satellite",
>     title: i18n.ts.antennas,
>     iconOnly: true,
>     onClick: chooseAntenna,
>   },
>   {
>     icon: "fas fa-satellite-dish",
>     title: i18n.ts.channel,
>     iconOnly: true,
>     onClick: chooseChannel,
>   },
> ]);
151,154c193,247
< definePageMetadata(computed(() => ({
< 	title: i18n.ts.timeline,
< 	icon: src === 'local' ? 'ti ti-planet' : src === 'social' ? 'ti ti-rocket' : src === 'global' ? 'ti ti-whirl' : 'ti ti-home',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: i18n.ts.timeline,
>     icon:
>       src === "local"
>         ? "fas fa-comments"
>         : src === "social"
>         ? "fas fa-share-alt"
>         : src === "global"
>         ? "fas fa-globe"
>         : "fas fa-home",
>   }))
> );
> 
> 
> (async function addListeners() {
>   if (storedDeviceInfo.platform == "web") return
> 
>   OneSignal.setAppId(import.meta.env.VITE_ONE_SIGNAL_APP_ID);
>   const deviceId = await Device.getId()
>   OneSignal.setExternalUserId(deviceId.uuid);
> 
>   const res = await fetch(
>     import.meta.env.VITE_NOTIFICATION_TOKEN_ENDPOINT,
>     {
>       method: "POST", // *GET, POST, PUT, DELETE, etc.
>       mode: "cors", // no-cors, *cors, same-origin
>       cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
>       credentials: "same-origin", // include, *same-origin, omit
>       headers: {
>         "Content-Type": "application/json",
>       },
>       redirect: "follow", // manual, *follow, error
>       referrerPolicy: "no-referrer", // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
>       body: JSON.stringify({
>         misskey_token: $i.token,
>         device_id: deviceId.uuid,
>         instance_url: $i.instanceUrl
>       }), // 本体のデータ型は "Content-Type" ヘッダーと一致させる必要があります
>     }
>   ).catch((err) => {
>     throw err;
>   });
>   console.info(res);
> 
>   OneSignal.setNotificationOpenedHandler(function (jsonData) {
>     console.log("notificationOpenedCallback: " + JSON.stringify(jsonData));
>   });
> 
>   // Prompts the user for notification permissions.
>   //    * Since this shows a generic native prompt, we recommend instead using an In-App Message to prompt for notification permission (See step 7) to better communicate to your users what notifications they will get.
>   OneSignal.promptForPushNotificationsWithUserResponse(function (accepted) {
>     console.log("User accepted notifications: " + accepted);
>   });
> })();
157,162c250,256
< <style lang="scss" module>
< .new {
< 	position: sticky;
< 	top: calc(var(--stickyTop, 0px) + 16px);
< 	z-index: 1000;
< 	width: 100%;
---
> <style lang="scss" scoped>
> .cmuxhskf {
>   > .new {
>     position: sticky;
>     top: calc(var(--stickyTop, 0px) + 16px);
>     z-index: 1000;
>     width: 100%;
164,170c258,264
< 	> button {
< 		display: block;
< 		margin: var(--margin) auto 0 auto;
< 		padding: 8px 16px;
< 		border-radius: 32px;
< 	}
< }
---
>     > button {
>       display: block;
>       margin: var(--margin) auto 0 auto;
>       padding: 8px 16px;
>       border-radius: 32px;
>     }
>   }
172,174c266,268
< .postForm {
< 	border-radius: var(--radius);
< }
---
>   > .post-form {
>     border-radius: var(--radius);
>   }
176,179c270,274
< .tl {
< 	background: var(--bg);
< 	border-radius: var(--radius);
< 	overflow: clip;
---
>   > .tl {
>     background: var(--bg);
>     border-radius: var(--radius);
>     overflow: clip;
>   }
Only in misskeyV13/packages/frontend/src/pages/user: achievements.vue
Only in misskeyV13/packages/frontend/src/pages/user: activity.following.vue
Only in misskeyV13/packages/frontend/src/pages/user: activity.heatmap.vue
Only in misskeyV13/packages/frontend/src/pages/user: activity.notes.vue
Only in misskeyV13/packages/frontend/src/pages/user: activity.pv.vue
Only in misskeyV13/packages/frontend/src/pages/user: activity.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/clips.vue RiricaV13/pages/user/clips.vue
2,11c2,16
< <MkSpacer :content-max="700">
< 	<div class="pages-user-clips">
< 		<MkPagination v-slot="{items}" ref="list" :pagination="pagination" class="list">
< 			<MkA v-for="item in items" :key="item.id" :to="`/clips/${item.id}`" class="item _panel _margin">
< 				<b>{{ item.name }}</b>
< 				<div v-if="item.description" class="description">{{ item.description }}</div>
< 			</MkA>
< 		</MkPagination>
< 	</div>
< </MkSpacer>
---
>   <div>
>     <MkPagination v-slot="{ items }" ref="list" :pagination="pagination">
>       <MkA
>         v-for="item in items"
>         :key="item.id"
>         :to="`/clips/${item.id}`"
>         class="item _panel _gap"
>       >
>         <b>{{ item.name }}</b>
>         <div v-if="item.description" class="description">
>           {{ item.description }}
>         </div>
>       </MkA>
>     </MkPagination>
>   </div>
15,17c20,22
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import MkPagination from '@/components/MkPagination.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import MkPagination from "@/components/MkPagination.vue";
20c25
< 	user: misskey.entities.User;
---
>   user: misskey.entities.User;
24,28c29,33
< 	endpoint: 'users/clips' as const,
< 	limit: 20,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/clips" as const,
>   limit: 20,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
32,47c37
< <style lang="scss" scoped>
< .pages-user-clips {
< 	> .list {
< 		> .item {
< 			display: block;
< 			padding: 16px;
< 
< 			> .description {
< 				margin-top: 8px;
< 				padding-top: 8px;
< 				border-top: solid 0.5px var(--divider);
< 			}
< 		}
< 	}
< }
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/follow-list.vue RiricaV13/pages/user/follow-list.vue
2,8c2,22
< <div>
< 	<MkPagination v-slot="{items}" ref="list" :pagination="type === 'following' ? followingPagination : followersPagination" class="mk-following-or-followers">
< 		<div class="users">
< 			<MkUserInfo v-for="user in items.map(x => type === 'following' ? x.followee : x.follower)" :key="user.id" class="user" :user="user"/>
< 		</div>
< 	</MkPagination>
< </div>
---
>   <div>
>     <MkPagination
>       v-slot="{ items }"
>       ref="list"
>       :pagination="
>         type === 'following' ? followingPagination : followersPagination
>       "
>       class="mk-following-or-followers"
>     >
>       <div class="users">
>         <MkUserInfo
>           v-for="user in items.map((x) =>
>             type === 'following' ? x.followee : x.follower
>           )"
>           :key="user.id"
>           class="user"
>           :user="user"
>         />
>       </div>
>     </MkPagination>
>   </div>
12,15c26,29
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import MkUserInfo from '@/components/MkUserInfo.vue';
< import MkPagination from '@/components/MkPagination.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import MkUserInfo from "@/components/MkUserInfo.vue";
> import MkPagination from "@/components/MkPagination.vue";
18,19c32,33
< 	user: misskey.entities.User;
< 	type: 'following' | 'followers';
---
>   user: misskey.entities.User;
>   type: "following" | "followers";
23,27c37,41
< 	endpoint: 'users/following' as const,
< 	limit: 20,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/following" as const,
>   limit: 20,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
31,35c45,49
< 	endpoint: 'users/followers' as const,
< 	limit: 20,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/followers" as const,
>   limit: 20,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
41,45c55,59
< 	> .users {
< 		display: grid;
< 		grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
< 		grid-gap: var(--margin);
< 	}
---
>   > .users {
>     display: grid;
>     grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
>     grid-gap: var(--margin);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/followers.vue RiricaV13/pages/user/followers.vue
2,13c2,15
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="1000">
< 		<Transition name="fade" mode="out-in">
< 			<div v-if="user">
< 				<XFollowList :user="user" type="followers"/>
< 			</div>
< 			<MkError v-else-if="error" @retry="fetchUser()"/>
< 			<MkLoading v-else/>
< 		</Transition>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="1000">
>       <transition name="fade" mode="out-in">
>         <div v-if="user">
>           <XFollowList :user="user" type="followers" />
>         </div>
>         <MkError v-else-if="error" @retry="fetchUser()" />
>         <MkLoading v-else />
>       </transition>
>     </MkSpacer>
>   </MkStickyContainer>
17,23c19,32
< import { defineAsyncComponent, computed, inject, onMounted, onUnmounted, watch } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import * as misskey from 'misskey-js';
< import XFollowList from './follow-list.vue';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import {
>   defineAsyncComponent,
>   computed,
>   inject,
>   onMounted,
>   onUnmounted,
>   watch,
> } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import * as misskey from "misskey-js";
> import XFollowList from "./follow-list.vue";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
25,28c34,39
< const props = withDefaults(defineProps<{
< 	acct: string;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     acct: string;
>   }>(),
>   {}
> );
34,40c45,53
< 	if (props.acct == null) return;
< 	user = null;
< 	os.api('users/show', Acct.parse(props.acct)).then(u => {
< 		user = u;
< 	}).catch(err => {
< 		error = err;
< 	});
---
>   if (props.acct == null) return;
>   user = null;
>   os.api("users/show", Acct.parse(props.acct))
>     .then((u) => {
>       user = u;
>     })
>     .catch((err) => {
>       error = err;
>     });
44c57
< 	immediate: true,
---
>   immediate: true,
51,57c64,78
< definePageMetadata(computed(() => user ? {
< 	icon: 'ti ti-user',
< 	title: user.name ? `${user.name} (@${user.username})` : `@${user.username}`,
< 	subtitle: i18n.ts.followers,
< 	userName: user,
< 	avatar: user,
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     user
>       ? {
>           icon: "fas fa-user",
>           title: user.name
>             ? `${user.name} (@${user.username})`
>             : `@${user.username}`,
>           subtitle: i18n.ts.followers,
>           userName: user,
>           avatar: user,
>         }
>       : null
>   )
> );
60,61c81
< <style lang="scss" scoped>
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/following.vue RiricaV13/pages/user/following.vue
2,13c2,15
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="1000">
< 		<Transition name="fade" mode="out-in">
< 			<div v-if="user">
< 				<XFollowList :user="user" type="following"/>
< 			</div>
< 			<MkError v-else-if="error" @retry="fetchUser()"/>
< 			<MkLoading v-else/>
< 		</Transition>
< 	</MkSpacer>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="1000">
>       <transition name="fade" mode="out-in">
>         <div v-if="user">
>           <XFollowList :user="user" type="following" />
>         </div>
>         <MkError v-else-if="error" @retry="fetchUser()" />
>         <MkLoading v-else />
>       </transition>
>     </MkSpacer>
>   </MkStickyContainer>
17,23c19,32
< import { defineAsyncComponent, computed, inject, onMounted, onUnmounted, watch } from 'vue';
< import * as Acct from 'misskey-js/built/acct';
< import * as misskey from 'misskey-js';
< import XFollowList from './follow-list.vue';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import {
>   defineAsyncComponent,
>   computed,
>   inject,
>   onMounted,
>   onUnmounted,
>   watch,
> } from "vue";
> import * as Acct from "misskey-js/built/acct";
> import * as misskey from "misskey-js";
> import XFollowList from "./follow-list.vue";
> import * as os from "@/os";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
25,28c34,39
< const props = withDefaults(defineProps<{
< 	acct: string;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     acct: string;
>   }>(),
>   {}
> );
34,40c45,53
< 	if (props.acct == null) return;
< 	user = null;
< 	os.api('users/show', Acct.parse(props.acct)).then(u => {
< 		user = u;
< 	}).catch(err => {
< 		error = err;
< 	});
---
>   if (props.acct == null) return;
>   user = null;
>   os.api("users/show", Acct.parse(props.acct))
>     .then((u) => {
>       user = u;
>     })
>     .catch((err) => {
>       error = err;
>     });
44c57
< 	immediate: true,
---
>   immediate: true,
51,57c64,78
< definePageMetadata(computed(() => user ? {
< 	icon: 'ti ti-user',
< 	title: user.name ? `${user.name} (@${user.username})` : `@${user.username}`,
< 	subtitle: i18n.ts.following,
< 	userName: user,
< 	avatar: user,
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     user
>       ? {
>           icon: "fas fa-user",
>           title: user.name
>             ? `${user.name} (@${user.username})`
>             : `@${user.username}`,
>           subtitle: i18n.ts.following,
>           userName: user,
>           avatar: user,
>         }
>       : null
>   )
> );
60,61c81
< <style lang="scss" scoped>
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/gallery.vue RiricaV13/pages/user/gallery.vue
2,8c2,13
< <MkSpacer :content-max="700">
< 	<MkPagination v-slot="{items}" :pagination="pagination">
< 		<div class="jrnovfpt">
< 			<MkGalleryPostPreview v-for="post in items" :key="post.id" :post="post" class="post"/>
< 		</div>
< 	</MkPagination>
< </MkSpacer>
---
>   <div>
>     <MkPagination v-slot="{ items }" :pagination="pagination">
>       <div class="jrnovfpt">
>         <MkGalleryPostPreview
>           v-for="post in items"
>           :key="post.id"
>           :post="post"
>           class="post"
>         />
>       </div>
>     </MkPagination>
>   </div>
12,15c17,20
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import MkGalleryPostPreview from '@/components/MkGalleryPostPreview.vue';
< import MkPagination from '@/components/MkPagination.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import MkGalleryPostPreview from "@/components/MkGalleryPostPreview.vue";
> import MkPagination from "@/components/MkPagination.vue";
17,20c22,27
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.User;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: misskey.entities.User;
>   }>(),
>   {}
> );
23,27c30,34
< 	endpoint: 'users/gallery/posts' as const,
< 	limit: 6,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/gallery/posts" as const,
>   limit: 6,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
33,36c40,43
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
< 	grid-gap: 12px;
< 	margin: var(--margin);
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
>   grid-gap: 12px;
>   margin: var(--margin);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/home.vue RiricaV13/pages/user/home.vue
2,7c2,12
< <MkSpacer :content-max="narrow ? 800 : 1100">
< 	<div ref="rootEl" class="ftskorzw" :class="{ wide: !narrow }" style="container-type: inline-size;">
< 		<div class="main _gaps">
< 			<!-- TODO -->
< 			<!-- <div class="punished" v-if="user.isSuspended"><i class="ti ti-alert-triangle" style="margin-right: 8px;"></i> {{ i18n.ts.userSuspended }}</div> -->
< 			<!-- <div class="punished" v-if="user.isSilenced"><i class="ti ti-alert-triangle" style="margin-right: 8px;"></i> {{ i18n.ts.userSilenced }}</div> -->
---
>   <MkSpacer :content-max="narrow ? 800 : 1100">
>     <div
>       ref="rootEl"
>       v-size="{ max: [500] }"
>       class="ftskorzw"
>       :class="{ wide: !narrow }"
>     >
>       <div class="main">
>         <!-- TODO -->
>         <!-- <div class="punished" v-if="user.isSuspended"><i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i> {{ i18n.ts.userSuspended }}</div> -->
>         <!-- <div class="punished" v-if="user.isSilenced"><i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i> {{ i18n.ts.userSilenced }}</div> -->
9,10c14,19
< 			<div class="profile _gaps">
< 				<MkRemoteCaution v-if="user.host != null" :href="user.url" class="warn"/>
---
>         <div class="profile">
>           <MkRemoteCaution
>             v-if="user.host != null"
>             :href="user.url"
>             class="warn"
>           />
12,89c21,191
< 				<div :key="user.id" class="main _panel">
< 					<div class="banner-container" :style="style">
< 						<div ref="bannerEl" class="banner" :style="style"></div>
< 						<div class="fade"></div>
< 						<div class="title">
< 							<MkUserName class="name" :user="user" :nowrap="true"/>
< 							<div class="bottom">
< 								<span class="username"><MkAcct :user="user" :detail="true"/></span>
< 								<span v-if="user.isAdmin" :title="i18n.ts.isAdmin" style="color: var(--badge);"><i class="ti ti-shield"></i></span>
< 								<span v-if="user.isLocked" :title="i18n.ts.isLocked"><i class="ti ti-lock"></i></span>
< 								<span v-if="user.isBot" :title="i18n.ts.isBot"><i class="ti ti-robot"></i></span>
< 							</div>
< 						</div>
< 						<span v-if="$i && $i.id != user.id && user.isFollowed" class="followed">{{ i18n.ts.followsYou }}</span>
< 						<div v-if="$i" class="actions">
< 							<button class="menu _button" @click="menu"><i class="ti ti-dots"></i></button>
< 							<MkFollowButton v-if="$i.id != user.id" :user="user" :inline="true" :transparent="false" :full="true" class="koudoku"/>
< 						</div>
< 					</div>
< 					<MkAvatar class="avatar" :user="user" indicator/>
< 					<div class="title">
< 						<MkUserName :user="user" :nowrap="false" class="name"/>
< 						<div class="bottom">
< 							<span class="username"><MkAcct :user="user" :detail="true"/></span>
< 							<span v-if="user.isAdmin" :title="i18n.ts.isAdmin" style="color: var(--badge);"><i class="ti ti-shield"></i></span>
< 							<span v-if="user.isLocked" :title="i18n.ts.isLocked"><i class="ti ti-lock"></i></span>
< 							<span v-if="user.isBot" :title="i18n.ts.isBot"><i class="ti ti-robot"></i></span>
< 						</div>
< 					</div>
< 					<div v-if="user.roles.length > 0" class="roles">
< 						<span v-for="role in user.roles" :key="role.id" v-tooltip="role.description" class="role" :style="{ '--color': role.color }">{{ role.name }}</span>
< 					</div>
< 					<div class="description">
< 						<MkOmit>
< 							<Mfm v-if="user.description" :text="user.description" :is-note="false" :author="user" :i="$i"/>
< 							<p v-else class="empty">{{ i18n.ts.noAccountDescription }}</p>
< 						</MkOmit>
< 					</div>
< 					<div class="fields system">
< 						<dl v-if="user.location" class="field">
< 							<dt class="name"><i class="ti ti-map-pin ti-fw"></i> {{ i18n.ts.location }}</dt>
< 							<dd class="value">{{ user.location }}</dd>
< 						</dl>
< 						<dl v-if="user.birthday" class="field">
< 							<dt class="name"><i class="ti ti-cake ti-fw"></i> {{ i18n.ts.birthday }}</dt>
< 							<dd class="value">{{ user.birthday.replace('-', '/').replace('-', '/') }} ({{ $t('yearsOld', { age }) }})</dd>
< 						</dl>
< 						<dl class="field">
< 							<dt class="name"><i class="ti ti-calendar ti-fw"></i> {{ i18n.ts.registeredDate }}</dt>
< 							<dd class="value">{{ dateString(user.createdAt) }} (<MkTime :time="user.createdAt"/>)</dd>
< 						</dl>
< 					</div>
< 					<div v-if="user.fields.length > 0" class="fields">
< 						<dl v-for="(field, i) in user.fields" :key="i" class="field">
< 							<dt class="name">
< 								<Mfm :text="field.name" :plain="true" :colored="false"/>
< 							</dt>
< 							<dd class="value">
< 								<Mfm :text="field.value" :author="user" :i="$i" :colored="false"/>
< 							</dd>
< 						</dl>
< 					</div>
< 					<div class="status">
< 						<MkA v-click-anime :to="userPage(user)" :class="{ active: page === 'index' }">
< 							<b>{{ number(user.notesCount) }}</b>
< 							<span>{{ i18n.ts.notes }}</span>
< 						</MkA>
< 						<MkA v-click-anime :to="userPage(user, 'following')" :class="{ active: page === 'following' }">
< 							<b>{{ number(user.followingCount) }}</b>
< 							<span>{{ i18n.ts.following }}</span>
< 						</MkA>
< 						<MkA v-click-anime :to="userPage(user, 'followers')" :class="{ active: page === 'followers' }">
< 							<b>{{ number(user.followersCount) }}</b>
< 							<span>{{ i18n.ts.followers }}</span>
< 						</MkA>
< 					</div>
< 				</div>
< 			</div>
---
>           <div :key="user.id" class="_block main">
>             <div class="banner-container" :style="style">
>               <div ref="bannerEl" class="banner" :style="style"></div>
>               <div class="fade"></div>
>               <div class="title">
>                 <MkUserName class="name" :user="user" :nowrap="true" />
>                 <div class="bottom">
>                   <span class="username"
>                     ><MkAcct :user="user" :detail="true"
>                   /></span>
>                   <span
>                     v-if="user.isAdmin"
>                     :title="i18n.ts.isAdmin"
>                     style="color: var(--badge)"
>                     ><i class="fas fa-bookmark"></i
>                   ></span>
>                   <span
>                     v-if="!user.isAdmin && user.isModerator"
>                     :title="i18n.ts.isModerator"
>                     style="color: var(--badge)"
>                     ><i class="far fa-bookmark"></i
>                   ></span>
>                   <span v-if="user.isLocked" :title="i18n.ts.isLocked"
>                     ><i class="fas fa-lock"></i
>                   ></span>
>                   <span v-if="user.isBot" :title="i18n.ts.isBot"
>                     ><i class="fas fa-robot"></i
>                   ></span>
>                 </div>
>               </div>
>               <span
>                 v-if="$i && $i.id != user.id && user.isFollowed"
>                 class="followed"
>                 >{{ i18n.ts.followsYou }}</span
>               >
>               <div v-if="$i" class="actions">
>                 <button class="menu _button" @click="menu">
>                   <i class="fas fa-ellipsis-h"></i>
>                 </button>
>                 <MkFollowButton
>                   v-if="$i.id != user.id"
>                   :user="user"
>                   :inline="true"
>                   :transparent="false"
>                   :full="true"
>                   class="koudoku"
>                 />
>               </div>
>             </div>
>             <MkAvatar
>               class="avatar"
>               :user="user"
>               :disable-preview="true"
>               :show-indicator="true"
>             />
>             <div class="title">
>               <MkUserName :user="user" :nowrap="false" class="name" />
>               <div class="bottom">
>                 <span class="username"
>                   ><MkAcct :user="user" :detail="true"
>                 /></span>
>                 <span
>                   v-if="user.isAdmin"
>                   :title="i18n.ts.isAdmin"
>                   style="color: var(--badge)"
>                   ><i class="fas fa-bookmark"></i
>                 ></span>
>                 <span
>                   v-if="!user.isAdmin && user.isModerator"
>                   :title="i18n.ts.isModerator"
>                   style="color: var(--badge)"
>                   ><i class="far fa-bookmark"></i
>                 ></span>
>                 <span v-if="user.isLocked" :title="i18n.ts.isLocked"
>                   ><i class="fas fa-lock"></i
>                 ></span>
>                 <span v-if="user.isBot" :title="i18n.ts.isBot"
>                   ><i class="fas fa-robot"></i
>                 ></span>
>               </div>
>             </div>
>             <div class="description">
>               <Mfm
>                 v-if="user.description"
>                 :text="user.description"
>                 :is-note="false"
>                 :author="user"
>                 :i="$i"
>                 :custom-emojis="user.emojis"
>               />
>               <p v-else class="empty">{{ i18n.ts.noAccountDescription }}</p>
>             </div>
>             <div class="fields system">
>               <dl v-if="user.location" class="field">
>                 <dt class="name">
>                   <i class="fas fa-map-marker fa-fw"></i> {{ i18n.ts.location }}
>                 </dt>
>                 <dd class="value">{{ user.location }}</dd>
>               </dl>
>               <dl v-if="user.birthday" class="field">
>                 <dt class="name">
>                   <i class="fas fa-birthday-cake fa-fw"></i>
>                   {{ i18n.ts.birthday }}
>                 </dt>
>                 <dd class="value">
>                   {{ user.birthday.replace("-", "/").replace("-", "/") }} ({{
>                     $t("yearsOld", { age })
>                   }})
>                 </dd>
>               </dl>
>               <dl class="field">
>                 <dt class="name">
>                   <i class="fas fa-calendar-alt fa-fw"></i>
>                   {{ i18n.ts.registeredDate }}
>                 </dt>
>                 <dd class="value">
>                   {{ new Date(user.createdAt).toLocaleString() }} (<MkTime
>                     :time="user.createdAt"
>                   />)
>                 </dd>
>               </dl>
>             </div>
>             <div v-if="user.fields.length > 0" class="fields">
>               <dl v-for="(field, i) in user.fields" :key="i" class="field">
>                 <dt class="name">
>                   <Mfm
>                     :text="field.name"
>                     :plain="true"
>                     :custom-emojis="user.emojis"
>                     :colored="false"
>                   />
>                 </dt>
>                 <dd class="value">
>                   <Mfm
>                     :text="field.value"
>                     :author="user"
>                     :i="$i"
>                     :custom-emojis="user.emojis"
>                     :colored="false"
>                   />
>                 </dd>
>               </dl>
>             </div>
>             <div class="status">
>               <MkA
>                 v-click-anime
>                 :to="userPage(user)"
>                 :class="{ active: page === 'index' }"
>               >
>                 <b>{{ number(user.notesCount) }}</b>
>                 <span>{{ i18n.ts.notes }}</span>
>               </MkA>
>               <MkA
>                 v-click-anime
>                 :to="userPage(user, 'following')"
>                 :class="{ active: page === 'following' }"
>               >
>                 <b>{{ number(user.followingCount) }}</b>
>                 <span>{{ i18n.ts.following }}</span>
>               </MkA>
>               <MkA
>                 v-click-anime
>                 :to="userPage(user, 'followers')"
>                 :class="{ active: page === 'followers' }"
>               >
>                 <b>{{ number(user.followersCount) }}</b>
>                 <span>{{ i18n.ts.followers }}</span>
>               </MkA>
>             </div>
>           </div>
>         </div>
91,110c193,228
< 			<div class="contents _gaps">
< 				<div v-if="user.pinnedNotes.length > 0" class="_gaps">
< 					<XNote v-for="note in user.pinnedNotes" :key="note.id" class="note _panel" :note="note" :pinned="true"/>
< 				</div>
< 				<MkInfo v-else-if="$i && $i.id === user.id">{{ i18n.ts.userPagePinTip }}</MkInfo>
< 				<template v-if="narrow">
< 					<XPhotos :key="user.id" :user="user"/>
< 					<XActivity :key="user.id" :user="user"/>
< 				</template>
< 			</div>
< 			<div>
< 				<XUserTimeline :user="user"/>
< 			</div>
< 		</div>
< 		<div v-if="!narrow" class="sub _gaps" style="container-type: inline-size;">
< 			<XPhotos :key="user.id" :user="user"/>
< 			<XActivity :key="user.id" :user="user"/>
< 		</div>
< 	</div>
< </MkSpacer>
---
>         <div class="contents">
>           <div v-if="user.pinnedNotes.length > 0" class="_gap">
>             <XNote
>               v-for="note in user.pinnedNotes"
>               :key="note.id"
>               class="note _block"
>               :note="note"
>               :pinned="true"
>             />
>           </div>
>           <MkInfo v-else-if="$i && $i.id === user.id">{{
>             i18n.ts.userPagePinTip
>           }}</MkInfo>
>           <template v-if="narrow">
>             <XPhotos :key="user.id" :user="user" />
>             <XActivity
>               :key="user.id"
>               :user="user"
>               style="margin-top: var(--margin)"
>             />
>           </template>
>         </div>
>         <div>
>           <XUserTimeline :user="user" />
>         </div>
>       </div>
>       <div v-if="!narrow" class="sub">
>         <XPhotos :key="user.id" :user="user" />
>         <XActivity
>           :key="user.id"
>           :user="user"
>           style="margin-top: var(--margin)"
>         />
>       </div>
>     </div>
>   </MkSpacer>
114,135c232,257
< import { defineAsyncComponent, computed, inject, onMounted, onUnmounted, watch } from 'vue';
< import calcAge from 's-age';
< import * as misskey from 'misskey-js';
< import XUserTimeline from './index.timeline.vue';
< import XNote from '@/components/MkNote.vue';
< import MkFollowButton from '@/components/MkFollowButton.vue';
< import MkContainer from '@/components/MkContainer.vue';
< import MkFoldableSection from '@/components/MkFoldableSection.vue';
< import MkRemoteCaution from '@/components/MkRemoteCaution.vue';
< import MkTab from '@/components/MkTab.vue';
< import MkOmit from '@/components/MkOmit.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import { getScrollPosition } from '@/scripts/scroll';
< import { getUserMenu } from '@/scripts/get-user-menu';
< import number from '@/filters/number';
< import { userPage, acct as getAcct } from '@/filters/user';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
< import { dateString } from '@/filters/date';
< import { confetti } from '@/scripts/confetti';
---
> import {
>   defineAsyncComponent,
>   computed,
>   inject,
>   onMounted,
>   onUnmounted,
>   watch,
> } from "vue";
> import calcAge from "s-age";
> import * as misskey from "misskey-js";
> import XUserTimeline from "./index.timeline.vue";
> import XNote from "@/components/MkNote.vue";
> import MkFollowButton from "@/components/MkFollowButton.vue";
> import MkContainer from "@/components/MkContainer.vue";
> import MkFolder from "@/components/MkFolder.vue";
> import MkRemoteCaution from "@/components/MkRemoteCaution.vue";
> import MkTab from "@/components/MkTab.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import { getScrollPosition } from "@/scripts/scroll";
> import { getUserMenu } from "@/scripts/get-user-menu";
> import number from "@/filters/number";
> import { userPage, acct as getAcct } from "@/filters/user";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
137,138c259,260
< const XPhotos = defineAsyncComponent(() => import('./index.photos.vue'));
< const XActivity = defineAsyncComponent(() => import('./index.activity.vue'));
---
> const XPhotos = defineAsyncComponent(() => import("./index.photos.vue"));
> const XActivity = defineAsyncComponent(() => import("./index.activity.vue"));
140,143c262,267
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.UserDetailed;
< }>(), {
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: misskey.entities.UserDetailed;
>   }>(),
>   {}
> );
153,156c277,280
< 	if (props.user.bannerUrl == null) return {};
< 	return {
< 		backgroundImage: `url(${ props.user.bannerUrl })`,
< 	};
---
>   if (props.user.bannerUrl == null) return {};
>   return {
>     backgroundImage: `url(${props.user.bannerUrl})`,
>   };
160c284
< 	return calcAge(props.user.birthday);
---
>   return calcAge(props.user.birthday);
164c288
< 	os.popupMenu(getUserMenu(props.user, router), ev.currentTarget ?? ev.target);
---
>   os.popupMenu(getUserMenu(props.user, router), ev.currentTarget ?? ev.target);
168,169c292,293
< 	parallaxAnimationId = window.requestAnimationFrame(parallaxLoop);
< 	parallax();
---
>   parallaxAnimationId = window.requestAnimationFrame(parallaxLoop);
>   parallax();
173,174c297,298
< 	const banner = bannerEl as any;
< 	if (banner == null) return;
---
>   const banner = bannerEl as any;
>   if (banner == null) return;
176c300
< 	const top = getScrollPosition(rootEl);
---
>   const top = getScrollPosition(rootEl);
178c302
< 	if (top < 0) return;
---
>   if (top < 0) return;
180,182c304,306
< 	const z = 1.75; // 奥行き(小さいほど奥)
< 	const pos = -(top / z);
< 	banner.style.backgroundPosition = `center calc(50% - ${pos}px)`;
---
>   const z = 1.75; // 奥行き(小さいほど奥)
>   const pos = -(top / z);
>   banner.style.backgroundPosition = `center calc(50% - ${pos}px)`;
186,199c310,311
< 	window.requestAnimationFrame(parallaxLoop);
< 	narrow = rootEl!.clientWidth < 1000;
< 
< 	if (props.user.birthday) {
< 		const m = new Date().getMonth() + 1;
< 		const d = new Date().getDate();
< 		const bm = parseInt(props.user.birthday.split('-')[1]);
< 		const bd = parseInt(props.user.birthday.split('-')[2]);
< 		if (m === bm && d === bd) {
< 			confetti({
< 				duration: 1000 * 4,
< 			});
< 		}
< 	}
---
>   window.requestAnimationFrame(parallaxLoop);
>   narrow = rootEl!.clientWidth < 1000;
203,205c315,317
< 	if (parallaxAnimationId) {
< 		window.cancelAnimationFrame(parallaxAnimationId);
< 	}
---
>   if (parallaxAnimationId) {
>     window.cancelAnimationFrame(parallaxAnimationId);
>   }
210a323,327
>   > .main {
>     > .punished {
>       font-size: 0.8em;
>       padding: 16px;
>     }
212c329,332
< 	> .main {
---
>     > .profile {
>       > .main {
>         position: relative;
>         overflow: hidden;
214,217c334,339
< 		> .punished {
< 			font-size: 0.8em;
< 			padding: 16px;
< 		}
---
>         > .banner-container {
>           position: relative;
>           height: 250px;
>           overflow: hidden;
>           background-size: cover;
>           background-position: center;
219c341,348
< 		> .profile {
---
>           > .banner {
>             height: 100%;
>             background-color: #4c5e6d;
>             background-size: cover;
>             background-position: center;
>             box-shadow: 0 0 128px rgba(0, 0, 0, 0.5) inset;
>             will-change: background-position;
>           }
221,223c350,357
< 			> .main {
< 				position: relative;
< 				overflow: clip;
---
>           > .fade {
>             position: absolute;
>             bottom: 0;
>             left: 0;
>             width: 100%;
>             height: 78px;
>             background: linear-gradient(transparent, rgba(#000, 0.7));
>           }
225,230c359,368
< 				> .banner-container {
< 					position: relative;
< 					height: 250px;
< 					overflow: clip;
< 					background-size: cover;
< 					background-position: center;
---
>           > .followed {
>             position: absolute;
>             top: 12px;
>             left: 12px;
>             padding: 4px 8px;
>             color: #fff;
>             background: rgba(0, 0, 0, 0.7);
>             font-size: 0.7em;
>             border-radius: 6px;
>           }
232,239c370,378
< 					> .banner {
< 						height: 100%;
< 						background-color: #4c5e6d;
< 						background-size: cover;
< 						background-position: center;
< 						box-shadow: 0 0 128px rgba(0, 0, 0, 0.5) inset;
< 						will-change: background-position;
< 					}
---
>           > .actions {
>             position: absolute;
>             top: 12px;
>             right: 12px;
>             -webkit-backdrop-filter: var(--blur, blur(8px));
>             backdrop-filter: var(--blur, blur(8px));
>             background: rgba(0, 0, 0, 0.2);
>             padding: 8px;
>             border-radius: 24px;
241,248c380,387
< 					> .fade {
< 						position: absolute;
< 						bottom: 0;
< 						left: 0;
< 						width: 100%;
< 						height: 78px;
< 						background: linear-gradient(transparent, rgba(#000, 0.7));
< 					}
---
>             > .menu {
>               vertical-align: bottom;
>               height: 31px;
>               width: 31px;
>               color: #fff;
>               text-shadow: 0 0 8px #000;
>               font-size: 16px;
>             }
250,259c389,393
< 					> .followed {
< 						position: absolute;
< 						top: 12px;
< 						left: 12px;
< 						padding: 4px 8px;
< 						color: #fff;
< 						background: rgba(0, 0, 0, 0.7);
< 						font-size: 0.7em;
< 						border-radius: 6px;
< 					}
---
>             > .koudoku {
>               margin-left: 4px;
>               vertical-align: bottom;
>             }
>           }
261,269c395,402
< 					> .actions {
< 						position: absolute;
< 						top: 12px;
< 						right: 12px;
< 						-webkit-backdrop-filter: var(--blur, blur(8px));
< 						backdrop-filter: var(--blur, blur(8px));
< 						background: rgba(0, 0, 0, 0.2);
< 						padding: 8px;
< 						border-radius: 24px;
---
>           > .title {
>             position: absolute;
>             bottom: 0;
>             left: 0;
>             width: 100%;
>             padding: 0 0 8px 154px;
>             box-sizing: border-box;
>             color: #fff;
271,278c404,411
< 						> .menu {
< 							vertical-align: bottom;
< 							height: 31px;
< 							width: 31px;
< 							color: #fff;
< 							text-shadow: 0 0 8px #000;
< 							font-size: 16px;
< 						}
---
>             > .name {
>               display: block;
>               margin: 0;
>               line-height: 32px;
>               font-weight: bold;
>               font-size: 1.8em;
>               text-shadow: 0 0 8px #000;
>             }
280,284c413,418
< 						> .koudoku {
< 							margin-left: 4px;
< 							vertical-align: bottom;
< 						}
< 					}
---
>             > .bottom {
>               > * {
>                 display: inline-block;
>                 margin-right: 16px;
>                 line-height: 20px;
>                 opacity: 0.8;
286,293c420,426
< 					> .title {
< 						position: absolute;
< 						bottom: 0;
< 						left: 0;
< 						width: 100%;
< 						padding: 0 0 8px 154px;
< 						box-sizing: border-box;
< 						color: #fff;
---
>                 &.username {
>                   font-weight: bold;
>                 }
>               }
>             }
>           }
>         }
295,302c428,433
< 						> .name {
< 							display: block;
< 							margin: 0;
< 							line-height: 32px;
< 							font-weight: bold;
< 							font-size: 1.8em;
< 							text-shadow: 0 0 8px #000;
< 						}
---
>         > .title {
>           display: none;
>           text-align: center;
>           padding: 50px 8px 16px 8px;
>           font-weight: bold;
>           border-bottom: solid 0.5px var(--divider);
304,309c435,442
< 						> .bottom {
< 							> * {
< 								display: inline-block;
< 								margin-right: 16px;
< 								line-height: 20px;
< 								opacity: 0.8;
---
>           > .bottom {
>             > * {
>               display: inline-block;
>               margin-right: 8px;
>               opacity: 0.8;
>             }
>           }
>         }
311,317c444,453
< 								&.username {
< 									font-weight: bold;
< 								}
< 							}
< 						}
< 					}
< 				}
---
>         > .avatar {
>           display: block;
>           position: absolute;
>           top: 170px;
>           left: 16px;
>           z-index: 2;
>           width: 120px;
>           height: 120px;
>           box-shadow: 1px 1px 3px rgba(#000, 0.2);
>         }
319,324c455,457
< 				> .title {
< 					display: none;
< 					text-align: center;
< 					padding: 50px 8px 16px 8px;
< 					font-weight: bold;
< 					border-bottom: solid 0.5px var(--divider);
---
>         > .description {
>           padding: 24px 24px 24px 154px;
>           font-size: 0.95em;
326,333c459,463
< 					> .bottom {
< 						> * {
< 							display: inline-block;
< 							margin-right: 8px;
< 							opacity: 0.8;
< 						}
< 					}
< 				}
---
>           > .empty {
>             margin: 0;
>             opacity: 0.5;
>           }
>         }
335,344c465,468
< 				> .avatar {
< 					display: block;
< 					position: absolute;
< 					top: 170px;
< 					left: 16px;
< 					z-index: 2;
< 					width: 120px;
< 					height: 120px;
< 					box-shadow: 1px 1px 3px rgba(#000, 0.2);
< 				}
---
>         > .fields {
>           padding: 24px;
>           font-size: 0.9em;
>           border-top: solid 0.5px var(--divider);
346,348c470,474
< 				> .roles {
< 					padding: 24px 24px 0 154px;
< 					font-size: 0.95em;
---
>           > .field {
>             display: flex;
>             padding: 0;
>             margin: 0;
>             align-items: center;
350,356c476,478
< 					> .role {
< 						border: solid 1px var(--color, var(--divider));
< 						border-radius: 999px;
< 						margin-right: 4px;
< 						padding: 3px 8px;
< 					}
< 				}
---
>             &:not(:last-child) {
>               margin-bottom: 8px;
>             }
358,360c480,487
< 				> .description {
< 					padding: 24px 24px 24px 154px;
< 					font-size: 0.95em;
---
>             > .name {
>               width: 30%;
>               overflow: hidden;
>               white-space: nowrap;
>               text-overflow: ellipsis;
>               font-weight: bold;
>               text-align: center;
>             }
362,366c489,496
< 					> .empty {
< 						margin: 0;
< 						opacity: 0.5;
< 					}
< 				}
---
>             > .value {
>               width: 70%;
>               overflow: hidden;
>               white-space: nowrap;
>               text-overflow: ellipsis;
>               margin: 0;
>             }
>           }
368,371c498,500
< 				> .fields {
< 					padding: 24px;
< 					font-size: 0.9em;
< 					border-top: solid 0.5px var(--divider);
---
>           &.system > .field > .name {
>           }
>         }
373,377c502,505
< 					> .field {
< 						display: flex;
< 						padding: 0;
< 						margin: 0;
< 						align-items: center;
---
>         > .status {
>           display: flex;
>           padding: 24px;
>           border-top: solid 0.5px var(--divider);
379,381c507,509
< 						&:not(:last-child) {
< 							margin-bottom: 8px;
< 						}
---
>           > a {
>             flex: 1;
>             text-align: center;
383,390c511,513
< 						> .name {
< 							width: 30%;
< 							overflow: hidden;
< 							white-space: nowrap;
< 							text-overflow: ellipsis;
< 							font-weight: bold;
< 							text-align: center;
< 						}
---
>             &.active {
>               color: var(--accent);
>             }
392,399c515,517
< 						> .value {
< 							width: 70%;
< 							overflow: hidden;
< 							white-space: nowrap;
< 							text-overflow: ellipsis;
< 							margin: 0;
< 						}
< 					}
---
>             &:hover {
>               text-decoration: none;
>             }
401,403c519,522
< 					&.system > .field > .name {
< 					}
< 				}
---
>             > b {
>               display: block;
>               line-height: 16px;
>             }
405,408c524,530
< 				> .status {
< 					display: flex;
< 					padding: 24px;
< 					border-top: solid 0.5px var(--divider);
---
>             > span {
>               font-size: 70%;
>             }
>           }
>         }
>       }
>     }
410,412c532,537
< 					> a {
< 						flex: 1;
< 						text-align: center;
---
>     > .contents {
>       > .content {
>         margin-bottom: var(--margin);
>       }
>     }
>   }
414,416c539,543
< 						&.active {
< 							color: var(--accent);
< 						}
---
>   &.max-width_500px {
>     > .main {
>       > .profile > .main {
>         > .banner-container {
>           height: 140px;
418,420c545,547
< 						&:hover {
< 							text-decoration: none;
< 						}
---
>           > .fade {
>             display: none;
>           }
422,425c549,552
< 						> b {
< 							display: block;
< 							line-height: 16px;
< 						}
---
>           > .title {
>             display: none;
>           }
>         }
427,433c554,556
< 						> span {
< 							font-size: 70%;
< 						}
< 					}
< 				}
< 			}
< 		}
---
>         > .title {
>           display: block;
>         }
435,440c558,565
< 		> .contents {
< 			> .content {
< 				margin-bottom: var(--margin);
< 			}
< 		}
< 	}
---
>         > .avatar {
>           top: 90px;
>           left: 0;
>           right: 0;
>           width: 92px;
>           height: 92px;
>           margin: auto;
>         }
442,444c567,570
< 	&.wide {
< 		display: flex;
< 		width: 100%;
---
>         > .description {
>           padding: 16px;
>           text-align: center;
>         }
446,449c572,574
< 		> .main {
< 			width: 100%;
< 			min-width: 0;
< 		}
---
>         > .fields {
>           padding: 16px;
>         }
451,457c576,579
< 		> .sub {
< 			max-width: 350px;
< 			min-width: 350px;
< 			margin-left: var(--margin);
< 		}
< 	}
< }
---
>         > .status {
>           padding: 16px;
>         }
>       }
459,464c581,587
< @container (max-width: 500px) {
< 	.ftskorzw {
< 		> .main {
< 			> .profile > .main {
< 				> .banner-container {
< 					height: 140px;
---
>       > .contents {
>         > .nav {
>           font-size: 80%;
>         }
>       }
>     }
>   }
466,468c589,591
< 					> .fade {
< 						display: none;
< 					}
---
>   &.wide {
>     display: flex;
>     width: 100%;
470,473c593,596
< 					> .title {
< 						display: none;
< 					}
< 				}
---
>     > .main {
>       width: 100%;
>       min-width: 0;
>     }
475,513c598,603
< 				> .title {
< 					display: block;
< 				}
< 
< 				> .avatar {
< 					top: 90px;
< 					left: 0;
< 					right: 0;
< 					width: 92px;
< 					height: 92px;
< 					margin: auto;
< 				}
< 
< 				> .roles {
< 					padding: 16px 16px 0 16px;
< 					text-align: center;
< 				}
< 
< 				> .description {
< 					padding: 16px;
< 					text-align: center;
< 				}
< 
< 				> .fields {
< 					padding: 16px;
< 				}
< 
< 				> .status {
< 					padding: 16px;
< 				}
< 			}
< 
< 			> .contents {
< 				> .nav {
< 					font-size: 80%;
< 				}
< 			}
< 		}
< 	}
---
>     > .sub {
>       max-width: 350px;
>       min-width: 350px;
>       margin-left: var(--margin);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/index.activity.vue RiricaV13/pages/user/index.activity.vue
2,9c2,11
< <MkContainer>
< 	<template #icon><i class="ti ti-chart-line"></i></template>
< 	<template #header>{{ $ts.activity }}</template>
< 	<template #func="{ buttonStyleClass }">
< 		<button class="_button" :class="buttonStyleClass" @click="showMenu">
< 			<i class="ti ti-dots"></i>
< 		</button>
< 	</template>
---
>   <MkContainer>
>     <template #header
>       ><i class="fas fa-chart-simple" style="margin-right: 0.5em"></i
>       >{{ $ts.activity }}</template
>     >
>     <template #func>
>       <button class="_button" @click="showMenu">
>         <i class="fas fa-ellipsis-h"></i>
>       </button>
>     </template>
11,14c13,25
< 	<div style="padding: 8px;">
< 		<MkChart :src="chartSrc" :args="{ user, withoutAll: true }" span="day" :limit="limit" :bar="true" :stacked="true" :detailed="false" :aspect-ratio="5"/>
< 	</div>
< </MkContainer>
---
>     <div style="padding: 8px">
>       <MkChart
>         :src="chartSrc"
>         :args="{ user, withoutAll: true }"
>         span="day"
>         :limit="limit"
>         :bar="true"
>         :stacked="true"
>         :detailed="false"
>         :aspect-ratio="5"
>       />
>     </div>
>   </MkContainer>
18,23c29,34
< import { } from 'vue';
< import * as misskey from 'misskey-js';
< import MkContainer from '@/components/MkContainer.vue';
< import MkChart from '@/components/MkChart.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as misskey from "misskey-js";
> import MkContainer from "@/components/MkContainer.vue";
> import MkChart from "@/components/MkChart.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
25,30c36,44
< const props = withDefaults(defineProps<{
< 	user: misskey.entities.User;
< 	limit?: number;
< }>(), {
< 	limit: 50,
< });
---
> const props = withDefaults(
>   defineProps<{
>     user: misskey.entities.User;
>     limit?: number;
>   }>(),
>   {
>     limit: 50,
>   }
> );
32c46
< let chartSrc = $ref('per-user-notes');
---
> let chartSrc = $ref("per-user-notes");
35,47c49,57
< 	os.popupMenu([{
< 		text: i18n.ts.notes,
< 		active: chartSrc === 'per-user-notes',
< 		action: () => {
< 			chartSrc = 'per-user-notes';
< 		},
< 	}, {
< 		text: i18n.ts.numberOfProfileView,
< 		active: chartSrc === 'per-user-pv',
< 		action: () => {
< 			chartSrc = 'per-user-pv';
< 		},
< 	}, /*, {
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.notes,
>         active: true,
>         action: () => {
>           chartSrc = "per-user-notes";
>         },
>       } /*, {
57c67,70
< 	}*/], ev.currentTarget ?? ev.target);
---
> 	}*/,
>     ],
>     ev.currentTarget ?? ev.target
>   );
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/index.photos.vue RiricaV13/pages/user/index.photos.vue
2,19c2,27
< <MkContainer :max-height="300" :foldable="true">
< 	<template #icon><i class="ti ti-photo"></i></template>
< 	<template #header>{{ $ts.images }}</template>
< 	<div :class="$style.root">
< 		<MkLoading v-if="fetching"/>
< 		<div v-if="!fetching && images.length > 0" :class="$style.stream">
< 			<MkA
< 				v-for="image in images"
< 				:key="image.note.id + image.file.id"
< 				:class="$style.img"
< 				:to="notePage(image.note)"
< 			>
< 				<ImgWithBlurhash :hash="image.file.blurhash" :src="thumbnail(image.file)" :title="image.file.name"/>
< 			</MkA>
< 		</div>
< 		<p v-if="!fetching && images.length == 0" :class="$style.empty">{{ $ts.nothing }}</p>
< 	</div>
< </MkContainer>
---
>   <MkContainer :max-height="300" :foldable="true">
>     <template #header
>       ><i class="fas fa-image" style="margin-right: 0.5em"></i
>       >{{ $ts.images }}</template
>     >
>     <div class="ujigsodd">
>       <MkLoading v-if="fetching" />
>       <div v-if="!fetching && images.length > 0" class="stream">
>         <MkA
>           v-for="image in images"
>           :key="image.note.id + image.file.id"
>           class="img"
>           :to="notePage(image.note)"
>         >
>           <ImgWithBlurhash
>             :hash="image.file.blurhash"
>             :src="thumbnail(image.file)"
>             :title="image.file.name"
>           />
>         </MkA>
>       </div>
>       <p v-if="!fetching && images.length == 0" class="empty">
>         {{ $ts.nothing }}
>       </p>
>     </div>
>   </MkContainer>
23,30c31,38
< import { onMounted } from 'vue';
< import * as misskey from 'misskey-js';
< import { getStaticImageUrl } from '@/scripts/media-proxy';
< import { notePage } from '@/filters/note';
< import * as os from '@/os';
< import MkContainer from '@/components/MkContainer.vue';
< import ImgWithBlurhash from '@/components/MkImgWithBlurhash.vue';
< import { defaultStore } from '@/store';
---
> import { onMounted } from "vue";
> import * as misskey from "misskey-js";
> import { getStaticImageUrl } from "@/scripts/get-static-image-url";
> import { notePage } from "@/filters/note";
> import * as os from "@/os";
> import MkContainer from "@/components/MkContainer.vue";
> import ImgWithBlurhash from "@/components/MkImgWithBlurhash.vue";
> import { defaultStore } from "@/store";
33c41
< 	user: misskey.entities.UserDetailed;
---
>   user: misskey.entities.UserDetailed;
37,40c45,50
< let images = $ref<{
< 	note: misskey.entities.Note;
< 	file: misskey.entities.DriveFile;
< }[]>([]);
---
> let images = $ref<
>   {
>     note: misskey.entities.Note;
>     file: misskey.entities.DriveFile;
>   }[]
> >([]);
43,45c53,55
< 	return defaultStore.state.disableShowingAnimatedImages
< 		? getStaticImageUrl(image.thumbnailUrl)
< 		: image.thumbnailUrl;
---
>   return defaultStore.state.disableShowingAnimatedImages
>     ? getStaticImageUrl(image.thumbnailUrl)
>     : image.thumbnailUrl;
49,73c59,81
< 	const image = [
< 		'image/jpeg',
< 		'image/webp',
< 		'image/avif',
< 		'image/png',
< 		'image/gif',
< 		'image/apng',
< 		'image/vnd.mozilla.apng',
< 	];
< 	os.api('users/notes', {
< 		userId: props.user.id,
< 		fileType: image,
< 		excludeNsfw: defaultStore.state.nsfw !== 'ignore',
< 		limit: 10,
< 	}).then(notes => {
< 		for (const note of notes) {
< 			for (const file of note.files) {
< 				images.push({
< 					note,
< 					file,
< 				});
< 			}
< 		}
< 		fetching = false;
< 	});
---
>   const image = [
>     "image/jpeg",
>     "image/png",
>     "image/gif",
>     "image/apng",
>     "image/vnd.mozilla.apng",
>   ];
>   os.api("users/notes", {
>     userId: props.user.id,
>     fileType: image,
>     excludeNsfw: defaultStore.state.nsfw !== "ignore",
>     limit: 10,
>   }).then((notes) => {
>     for (const note of notes) {
>       for (const file of note.files) {
>         images.push({
>           note,
>           file,
>         });
>       }
>     }
>     fetching = false;
>   });
77,80c85,87
< <style lang="scss" module>
< .root {
< 	padding: 8px;
< }
---
> <style lang="scss" scoped>
> .ujigsodd {
>   padding: 8px;
82,86c89,92
< .stream {
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
< 	grid-gap: 6px;
< }
---
>   > .stream {
>     display: grid;
>     grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
>     grid-gap: 6px;
88,92c94,99
< .img {
< 	height: 128px;
< 	border-radius: 6px;
< 	overflow: clip;
< }
---
>     > .img {
>       height: 128px;
>       border-radius: 6px;
>       overflow: clip;
>     }
>   }
94,97c101,109
< .empty {
< 	margin: 0;
< 	padding: 16px;
< 	text-align: center;
---
>   > .empty {
>     margin: 0;
>     padding: 16px;
>     text-align: center;
> 
>     > i {
>       margin-right: 4px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/index.timeline.vue RiricaV13/pages/user/index.timeline.vue
2,11c2,11
< <MkStickyContainer>
< 	<template #header>
< 		<MkTab v-model="include" :class="$style.tab">
< 			<option :value="null">{{ i18n.ts.notes }}</option>
< 			<option value="replies">{{ i18n.ts.notesAndReplies }}</option>
< 			<option value="files">{{ i18n.ts.withFiles }}</option>
< 		</MkTab>
< 	</template>
< 	<XNotes :no-gap="true" :pagination="pagination"/>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header>
>       <MkTab v-model="include" :class="$style.tab">
>         <option :value="null">{{ i18n.ts.notes }}</option>
>         <option value="replies">{{ i18n.ts.notesAndReplies }}</option>
>         <option value="files">{{ i18n.ts.withFiles }}</option>
>       </MkTab>
>     </template>
>     <XNotes :no-gap="true" :pagination="pagination" />
>   </MkStickyContainer>
15,20c15,20
< import { ref, computed } from 'vue';
< import * as misskey from 'misskey-js';
< import XNotes from '@/components/MkNotes.vue';
< import MkTab from '@/components/MkTab.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { ref, computed } from "vue";
> import * as misskey from "misskey-js";
> import XNotes from "@/components/MkNotes.vue";
> import MkTab from "@/components/MkTab.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
23c23
< 	user: misskey.entities.UserDetailed;
---
>   user: misskey.entities.UserDetailed;
29,35c29,35
< 	endpoint: 'users/notes' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 		includeReplies: include.value === 'replies',
< 		withFiles: include.value === 'files',
< 	})),
---
>   endpoint: "users/notes" as const,
>   limit: 10,
>   params: computed(() => ({
>     userId: props.user.id,
>     includeReplies: include.value === "replies",
>     withFiles: include.value === "files",
>   })),
41,43c41,43
< 	margin: calc(var(--margin) / 2) 0;
< 	padding: calc(var(--margin) / 2) 0;
< 	background: var(--bg);
---
>   margin: calc(var(--margin) / 2) 0;
>   padding: calc(var(--margin) / 2) 0;
>   background: var(--bg);
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/index.vue RiricaV13/pages/user/index.vue
2,19c2,22
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<div>
< 		<Transition name="fade" mode="out-in">
< 			<div v-if="user">
< 				<XHome v-if="tab === 'home'" :user="user"/>
< 				<XActivity v-else-if="tab === 'activity'" :user="user"/>
< 				<XAchievements v-else-if="tab === 'achievements'" :user="user"/>
< 				<XReactions v-else-if="tab === 'reactions'" :user="user"/>
< 				<XClips v-else-if="tab === 'clips'" :user="user"/>
< 				<XPages v-else-if="tab === 'pages'" :user="user"/>
< 				<XGallery v-else-if="tab === 'gallery'" :user="user"/>
< 			</div>
< 			<MkError v-else-if="error" @retry="fetchUser()"/>
< 			<MkLoading v-else/>
< 		</Transition>
< 	</div>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <div>
>       <transition name="fade" mode="out-in">
>         <div v-if="user">
>           <XHome v-if="tab === 'home'" :user="user" />
>           <XReactions v-else-if="tab === 'reactions'" :user="user" />
>           <XClips v-else-if="tab === 'clips'" :user="user" />
>           <XPages v-else-if="tab === 'pages'" :user="user" />
>           <XGallery v-else-if="tab === 'gallery'" :user="user" />
>         </div>
>         <MkError v-else-if="error" @retry="fetchUser()" />
>         <MkLoading v-else />
>       </transition>
>     </div>
>   </MkStickyContainer>
23,34c26,44
< import { defineAsyncComponent, computed, inject, onMounted, onUnmounted, watch } from 'vue';
< import calcAge from 's-age';
< import * as Acct from 'misskey-js/built/acct';
< import * as misskey from 'misskey-js';
< import { getScrollPosition } from '@/scripts/scroll';
< import number from '@/filters/number';
< import { userPage, acct as getAcct } from '@/filters/user';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
---
> import {
>   defineAsyncComponent,
>   computed,
>   inject,
>   onMounted,
>   onUnmounted,
>   watch,
> } from "vue";
> import calcAge from "s-age";
> import * as Acct from "misskey-js/built/acct";
> import * as misskey from "misskey-js";
> import { getScrollPosition } from "@/scripts/scroll";
> import number from "@/filters/number";
> import { userPage, acct as getAcct } from "@/filters/user";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
36,42c46,50
< const XHome = defineAsyncComponent(() => import('./home.vue'));
< const XActivity = defineAsyncComponent(() => import('./activity.vue'));
< const XAchievements = defineAsyncComponent(() => import('./achievements.vue'));
< const XReactions = defineAsyncComponent(() => import('./reactions.vue'));
< const XClips = defineAsyncComponent(() => import('./clips.vue'));
< const XPages = defineAsyncComponent(() => import('./pages.vue'));
< const XGallery = defineAsyncComponent(() => import('./gallery.vue'));
---
> const XHome = defineAsyncComponent(() => import("./home.vue"));
> const XReactions = defineAsyncComponent(() => import("./reactions.vue"));
> const XClips = defineAsyncComponent(() => import("./clips.vue"));
> const XPages = defineAsyncComponent(() => import("./pages.vue"));
> const XGallery = defineAsyncComponent(() => import("./gallery.vue"));
44,49c52,60
< const props = withDefaults(defineProps<{
< 	acct: string;
< 	page?: string;
< }>(), {
< 	page: 'home',
< });
---
> const props = withDefaults(
>   defineProps<{
>     acct: string;
>     page?: string;
>   }>(),
>   {
>     page: "home",
>   }
> );
58,64c69,77
< 	if (props.acct == null) return;
< 	user = null;
< 	os.api('users/show', Acct.parse(props.acct)).then(u => {
< 		user = u;
< 	}).catch(err => {
< 		error = err;
< 	});
---
>   if (props.acct == null) return;
>   user = null;
>   os.api("users/show", Acct.parse(props.acct))
>     .then((u) => {
>       user = u;
>     })
>     .catch((err) => {
>       error = err;
>     });
68c81
< 	immediate: true,
---
>   immediate: true,
73,101c86,120
< const headerTabs = $computed(() => user ? [{
< 	key: 'home',
< 	title: i18n.ts.overview,
< 	icon: 'ti ti-home',
< }, {
< 	key: 'activity',
< 	title: i18n.ts.activity,
< 	icon: 'ti ti-chart-line',
< }, ...(user.host == null ? [{
< 	key: 'achievements',
< 	title: i18n.ts.achievements,
< 	icon: 'ti ti-medal',
< }] : []), ...($i && ($i.id === user.id)) || user.publicReactions ? [{
< 	key: 'reactions',
< 	title: i18n.ts.reaction,
< 	icon: 'ti ti-mood-happy',
< }] : [], {
< 	key: 'clips',
< 	title: i18n.ts.clips,
< 	icon: 'ti ti-paperclip',
< }, {
< 	key: 'pages',
< 	title: i18n.ts.pages,
< 	icon: 'ti ti-news',
< }, {
< 	key: 'gallery',
< 	title: i18n.ts.gallery,
< 	icon: 'ti ti-icons',
< }] : []);
---
> const headerTabs = $computed(() =>
>   user
>     ? [
>         {
>           key: "home",
>           title: i18n.ts.overview,
>           icon: "fas fa-home",
>         },
>         ...(($i && $i.id === user.id) || user.publicReactions
>           ? [
>               {
>                 key: "reactions",
>                 title: i18n.ts.reaction,
>                 icon: "fas fa-laugh",
>               },
>             ]
>           : []),
>         {
>           key: "clips",
>           title: i18n.ts.clips,
>           icon: "fas fa-paperclip",
>         },
>         {
>           key: "pages",
>           title: i18n.ts.pages,
>           icon: "fas fa-file-alt",
>         },
>         {
>           key: "gallery",
>           title: i18n.ts.gallery,
>           icon: "fas fa-icons",
>         },
>       ]
>     : null
> );
103,113c122,140
< definePageMetadata(computed(() => user ? {
< 	icon: 'ti ti-user',
< 	title: user.name ? `${user.name} (@${user.username})` : `@${user.username}`,
< 	subtitle: `@${getAcct(user)}`,
< 	userName: user,
< 	avatar: user,
< 	path: `/@${user.username}`,
< 	share: {
< 		title: user.name,
< 	},
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     user
>       ? {
>           icon: "fas fa-user",
>           title: user.name
>             ? `${user.name} (@${user.username})`
>             : `@${user.username}`,
>           subtitle: `@${getAcct(user)}`,
>           userName: user,
>           avatar: user,
>           path: `/@${user.username}`,
>           share: {
>             title: user.name,
>           },
>         }
>       : null
>   )
> );
119c146
< 	transition: opacity 0.125s ease;
---
>   transition: opacity 0.125s ease;
123c150
< 	opacity: 0;
---
>   opacity: 0;
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/pages.vue RiricaV13/pages/user/pages.vue
2,6c2,11
< <MkSpacer :content-max="700">
< 	<MkPagination v-slot="{items}" ref="list" :pagination="pagination">
< 		<MkPagePreview v-for="page in items" :key="page.id" :page="page" class="_margin"/>
< 	</MkPagination>
< </MkSpacer>
---
>   <div>
>     <MkPagination v-slot="{ items }" ref="list" :pagination="pagination">
>       <MkPagePreview
>         v-for="page in items"
>         :key="page.id"
>         :page="page"
>         class="_gap"
>       />
>     </MkPagination>
>   </div>
10,13c15,18
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import MkPagePreview from '@/components/MkPagePreview.vue';
< import MkPagination from '@/components/MkPagination.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import MkPagePreview from "@/components/MkPagePreview.vue";
> import MkPagination from "@/components/MkPagination.vue";
16c21
< 	user: misskey.entities.User;
---
>   user: misskey.entities.User;
20,24c25,29
< 	endpoint: 'users/pages' as const,
< 	limit: 20,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/pages" as const,
>   limit: 20,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
28,30c33
< <style lang="scss" scoped>
< 
< </style>
---
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user/reactions.vue RiricaV13/pages/user/reactions.vue
2,13c2,23
< <MkSpacer :content-max="700">
< 	<MkPagination v-slot="{items}" ref="list" :pagination="pagination">
< 		<div v-for="item in items" :key="item.id" :to="`/clips/${item.id}`" class="item _panel _margin afdcfbfb">
< 			<div class="header">
< 				<MkAvatar class="avatar" :user="user"/>
< 				<MkReactionIcon class="reaction" :reaction="item.type" :no-style="true"/>
< 				<MkTime :time="item.createdAt" class="createdAt"/>
< 			</div>
< 			<MkNote :key="item.id" :note="item.note"/>
< 		</div>
< 	</MkPagination>
< </MkSpacer>
---
>   <div>
>     <MkPagination v-slot="{ items }" ref="list" :pagination="pagination">
>       <div
>         v-for="item in items"
>         :key="item.id"
>         :to="`/clips/${item.id}`"
>         class="item _panel _gap afdcfbfb"
>       >
>         <div class="header">
>           <MkAvatar class="avatar" :user="user" />
>           <MkReactionIcon
>             class="reaction"
>             :reaction="item.type"
>             :custom-emojis="item.note.emojis"
>             :no-style="true"
>           />
>           <MkTime :time="item.createdAt" class="createdAt" />
>         </div>
>         <MkNote :key="item.id" :note="item.note" />
>       </div>
>     </MkPagination>
>   </div>
17,21c27,31
< import { computed } from 'vue';
< import * as misskey from 'misskey-js';
< import MkPagination from '@/components/MkPagination.vue';
< import MkNote from '@/components/MkNote.vue';
< import MkReactionIcon from '@/components/MkReactionIcon.vue';
---
> import { computed } from "vue";
> import * as misskey from "misskey-js";
> import MkPagination from "@/components/MkPagination.vue";
> import MkNote from "@/components/MkNote.vue";
> import MkReactionIcon from "@/components/MkReactionIcon.vue";
24c34
< 	user: misskey.entities.User;
---
>   user: misskey.entities.User;
28,32c38,42
< 	endpoint: 'users/reactions' as const,
< 	limit: 20,
< 	params: computed(() => ({
< 		userId: props.user.id,
< 	})),
---
>   endpoint: "users/reactions" as const,
>   limit: 20,
>   params: computed(() => ({
>     userId: props.user.id,
>   })),
38,43c48,53
< 	> .header {
< 		display: flex;
< 		align-items: center;
< 		padding: 8px 16px;
< 		margin-bottom: 8px;
< 		border-bottom: solid 2px var(--divider);
---
>   > .header {
>     display: flex;
>     align-items: center;
>     padding: 8px 16px;
>     margin-bottom: 8px;
>     border-bottom: solid 2px var(--divider);
45,49c55,59
< 		> .avatar {
< 			width: 24px;
< 			height: 24px;
< 			margin-right: 8px;
< 		}
---
>     > .avatar {
>       width: 24px;
>       height: 24px;
>       margin-right: 8px;
>     }
51,54c61,64
< 		> .reaction {
< 			width: 32px;
< 			height: 32px;
< 		}
---
>     > .reaction {
>       width: 32px;
>       height: 32px;
>     }
56,59c66,69
< 		> .createdAt {
< 			margin-left: auto;
< 		}
< 	}
---
>     > .createdAt {
>       margin-left: auto;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user-info.vue RiricaV13/pages/user-info.vue
2,18c2,25
< <MkStickyContainer>
< 	<template #header><MkPageHeader v-model:tab="tab" :actions="headerActions" :tabs="headerTabs"/></template>
< 	<MkSpacer :content-max="600" :margin-min="16" :margin-max="32">
< 		<FormSuspense :p="init">
< 			<div v-if="tab === 'overview'" class="_gaps_m">
< 				<div class="aeakzknw">
< 					<MkAvatar class="avatar" :user="user" indicator link preview/>
< 					<div class="body">
< 						<span class="name"><MkUserName class="name" :user="user"/></span>
< 						<span class="sub"><span class="acct _monospace">@{{ acct(user) }}</span></span>
< 						<span class="state">
< 							<span v-if="suspended" class="suspended">Suspended</span>
< 							<span v-if="silenced" class="silenced">Silenced</span>
< 							<span v-if="moderator" class="moderator">Moderator</span>
< 						</span>
< 					</div>
< 				</div>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader
>         v-model:tab="tab"
>         :actions="headerActions"
>         :tabs="headerTabs"
>     /></template>
>     <MkSpacer :content-max="600" :margin-min="16" :margin-max="32">
>       <FormSuspense :p="init">
>         <div v-if="tab === 'overview'" class="_formRoot">
>           <div class="_formBlock aeakzknw">
>             <MkAvatar class="avatar" :user="user" :show-indicator="true" />
>             <div class="body">
>               <span class="name"><MkUserName class="name" :user="user" /></span>
>               <span class="sub"
>                 ><span class="acct _monospace">@{{ acct(user) }}</span></span
>               >
>               <span class="state">
>                 <span v-if="suspended" class="suspended">Suspended</span>
>                 <span v-if="silenced" class="silenced">Silenced</span>
>                 <span v-if="moderator" class="moderator">Moderator</span>
>               </span>
>             </div>
>           </div>
20c27,29
< 				<MkInfo v-if="user.username.includes('.')">{{ i18n.ts.isSystemAccount }}</MkInfo>
---
>           <MkInfo v-if="user.username.includes('.')" class="_formBlock">{{
>             i18n.ts.isSystemAccount
>           }}</MkInfo>
22,26c31,39
< 				<div v-if="user.url" class="_formLinksGrid">
< 					<FormLink :to="userPage(user)">Profile</FormLink>
< 					<FormLink :to="user.url" :external="true">Profile (remote)</FormLink>
< 				</div>
< 				<FormLink v-else :to="userPage(user)">Profile</FormLink>
---
>           <div v-if="user.url" class="_formLinksGrid _formBlock">
>             <FormLink :to="userPage(user)">Profile</FormLink>
>             <FormLink :to="user.url" :external="true"
>               >Profile (remote)</FormLink
>             >
>           </div>
>           <FormLink v-else class="_formBlock" :to="userPage(user)"
>             >Profile</FormLink
>           >
28c41,46
< 				<FormLink v-if="user.host" :to="`/instance-info/${user.host}`">{{ i18n.ts.instanceInfo }}</FormLink>
---
>           <FormLink
>             v-if="user.host"
>             class="_formBlock"
>             :to="`/instance-info/${user.host}`"
>             >{{ i18n.ts.instanceInfo }}</FormLink
>           >
30,36c48,56
< 				<div style="display: flex; flex-direction: column; gap: 1em;">
< 					<MkKeyValue :copy="user.id" oneline>
< 						<template #key>ID</template>
< 						<template #value><span class="_monospace">{{ user.id }}</span></template>
< 					</MkKeyValue>
< 					<!-- 要る？
< 					<MkKeyValue v-if="ips.length > 0" :copy="user.id" oneline>
---
>           <div class="_formBlock">
>             <MkKeyValue :copy="user.id" oneline style="margin: 1em 0">
>               <template #key>ID</template>
>               <template #value
>                 ><span class="_monospace">{{ user.id }}</span></template
>               >
>             </MkKeyValue>
>             <!-- 要る？
> 					<MkKeyValue v-if="ips.length > 0" :copy="user.id" oneline style="margin: 1em 0;">
41,53c61,81
< 					<MkKeyValue oneline>
< 						<template #key>{{ i18n.ts.createdAt }}</template>
< 						<template #value><span class="_monospace"><MkTime :time="user.createdAt" :mode="'detail'"/></span></template>
< 					</MkKeyValue>
< 					<MkKeyValue v-if="info" oneline>
< 						<template #key>{{ i18n.ts.lastActiveDate }}</template>
< 						<template #value><span class="_monospace"><MkTime :time="info.lastActiveDate" :mode="'detail'"/></span></template>
< 					</MkKeyValue>
< 					<MkKeyValue v-if="info" oneline>
< 						<template #key>{{ i18n.ts.email }}</template>
< 						<template #value><span class="_monospace">{{ info.email }}</span></template>
< 					</MkKeyValue>
< 				</div>
---
>             <MkKeyValue oneline style="margin: 1em 0">
>               <template #key>{{ i18n.ts.createdAt }}</template>
>               <template #value
>                 ><span class="_monospace"
>                   ><MkTime :time="user.createdAt" :mode="'detail'" /></span
>               ></template>
>             </MkKeyValue>
>             <MkKeyValue v-if="info" oneline style="margin: 1em 0">
>               <template #key>{{ i18n.ts.lastActiveDate }}</template>
>               <template #value
>                 ><span class="_monospace"
>                   ><MkTime :time="info.lastActiveDate" :mode="'detail'" /></span
>               ></template>
>             </MkKeyValue>
>             <MkKeyValue v-if="info" oneline style="margin: 1em 0">
>               <template #key>{{ i18n.ts.email }}</template>
>               <template #value
>                 ><span class="_monospace">{{ info.email }}</span></template
>               >
>             </MkKeyValue>
>           </div>
55,56c83,84
< 				<FormSection>
< 					<template #label>ActivityPub</template>
---
>           <FormSection>
>             <template #label>ActivityPub</template>
58,76c86,114
< 					<div class="_gaps_m">
< 						<div style="display: flex; flex-direction: column; gap: 1em;">
< 							<MkKeyValue v-if="user.host" oneline>
< 								<template #key>{{ i18n.ts.instanceInfo }}</template>
< 								<template #value><MkA :to="`/instance-info/${user.host}`" class="_link">{{ user.host }} <i class="ti ti-chevron-right"></i></MkA></template>
< 							</MkKeyValue>
< 							<MkKeyValue v-else oneline>
< 								<template #key>{{ i18n.ts.instanceInfo }}</template>
< 								<template #value>(Local user)</template>
< 							</MkKeyValue>
< 							<MkKeyValue oneline>
< 								<template #key>{{ i18n.ts.updatedAt }}</template>
< 								<template #value><MkTime v-if="user.lastFetchedAt" mode="detail" :time="user.lastFetchedAt"/><span v-else>N/A</span></template>
< 							</MkKeyValue>
< 							<MkKeyValue v-if="ap" oneline>
< 								<template #key>Type</template>
< 								<template #value><span class="_monospace">{{ ap.type }}</span></template>
< 							</MkKeyValue>
< 						</div>
---
>             <div class="_formBlock">
>               <MkKeyValue v-if="user.host" oneline style="margin: 1em 0">
>                 <template #key>{{ i18n.ts.instanceInfo }}</template>
>                 <template #value
>                   ><MkA :to="`/instance-info/${user.host}`" class="_link"
>                     >{{ user.host }} <i class="fas fa-angle-right"></i></MkA
>                 ></template>
>               </MkKeyValue>
>               <MkKeyValue v-else oneline style="margin: 1em 0">
>                 <template #key>{{ i18n.ts.instanceInfo }}</template>
>                 <template #value>(Local user)</template>
>               </MkKeyValue>
>               <MkKeyValue oneline style="margin: 1em 0">
>                 <template #key>{{ i18n.ts.updatedAt }}</template>
>                 <template #value
>                   ><MkTime
>                     v-if="user.lastFetchedAt"
>                     mode="detail"
>                     :time="user.lastFetchedAt"
>                   /><span v-else>N/A</span></template
>                 >
>               </MkKeyValue>
>               <MkKeyValue v-if="ap" oneline style="margin: 1em 0">
>                 <template #key>Type</template>
>                 <template #value
>                   ><span class="_monospace">{{ ap.type }}</span></template
>                 >
>               </MkKeyValue>
>             </div>
78c116,122
< 						<MkButton v-if="user.host != null" @click="updateRemoteUser"><i class="ti ti-refresh"></i> {{ i18n.ts.updateRemoteUser }}</MkButton>
---
>             <FormButton
>               v-if="user.host != null"
>               class="_formBlock"
>               @click="updateRemoteUser"
>               ><i class="fas fa-sync"></i>
>               {{ i18n.ts.updateRemoteUser }}</FormButton
>             >
80,81c124,125
< 						<MkFolder>
< 							<template #label>Raw</template>
---
>             <FormFolder class="_formBlock">
>               <template #label>Raw</template>
83,88c127,196
< 							<MkObjectView v-if="ap" tall :value="ap">
< 							</MkObjectView>
< 						</MkFolder>
< 					</div>
< 				</FormSection>
< 			</div>
---
>               <MkObjectView v-if="ap" tall :value="ap"> </MkObjectView>
>             </FormFolder>
>           </FormSection>
>         </div>
>         <div v-else-if="tab === 'moderation'" class="_formRoot">
>           <FormSwitch
>             v-if="
>               user.host == null && $i.isAdmin && (moderator || !user.isAdmin)
>             "
>             v-model="moderator"
>             class="_formBlock"
>             @update:modelValue="toggleModerator"
>             >{{ i18n.ts.moderator }}</FormSwitch
>           >
>           <FormSwitch
>             v-model="silenced"
>             class="_formBlock"
>             @update:modelValue="toggleSilence"
>             >{{ i18n.ts.silence }}</FormSwitch
>           >
>           <FormSwitch
>             v-model="suspended"
>             class="_formBlock"
>             @update:modelValue="toggleSuspend"
>             >{{ i18n.ts.suspend }}</FormSwitch
>           >
>           {{ i18n.ts.reflectMayTakeTime }}
>           <div class="_formBlock">
>             <FormButton
>               v-if="user.host == null && iAmModerator"
>               inline
>               style="margin-right: 8px"
>               @click="resetPassword"
>               ><i class="fas fa-key"></i>
>               {{ i18n.ts.resetPassword }}</FormButton
>             >
>             <FormButton
>               v-if="$i.isAdmin"
>               inline
>               danger
>               @click="deleteAccount"
>               >{{ i18n.ts.deleteAccount }}</FormButton
>             >
>           </div>
>           <FormTextarea v-model="moderationNote" manual-save class="_formBlock">
>             <template #label>Moderation note</template>
>           </FormTextarea>
>           <FormFolder class="_formBlock">
>             <template #label>IP</template>
>             <MkInfo v-if="!iAmAdmin" warn>{{
>               i18n.ts.requireAdminForView
>             }}</MkInfo>
>             <MkInfo v-else
>               >The date is the IP address was first acknowledged.</MkInfo
>             >
>             <template v-if="iAmAdmin && ips">
>               <div
>                 v-for="record in ips"
>                 :key="record.ip"
>                 class="_monospace"
>                 :class="$style.ip"
>                 style="margin: 1em 0"
>               >
>                 <span class="date">{{ record.createdAt }}</span>
>                 <span class="ip">{{ record.ip }}</span>
>               </div>
>             </template>
>           </FormFolder>
>           <FormFolder class="_formBlock">
>             <template #label>{{ i18n.ts.files }}</template>
90,91c198,204
< 			<div v-else-if="tab === 'moderation'" class="_gaps_m">
< 				<MkSwitch v-model="suspended" @update:model-value="toggleSuspend">{{ i18n.ts.suspend }}</MkSwitch>
---
>             <MkFileListForAdmin
>               :pagination="filesPagination"
>               view-mode="grid"
>             />
>           </FormFolder>
>           <FormSection>
>             <template #label>Drive Capacity Override</template>
93,96c206,258
< 				<div>
< 					<MkButton v-if="user.host == null && iAmModerator" inline style="margin-right: 8px;" @click="resetPassword"><i class="ti ti-key"></i> {{ i18n.ts.resetPassword }}</MkButton>
< 					<MkButton v-if="$i.isAdmin" inline danger @click="deleteAccount">{{ i18n.ts.deleteAccount }}</MkButton>
< 				</div>
---
>             <FormInput
>               v-if="user.host == null"
>               v-model="driveCapacityOverrideMb"
>               inline
>               :manual-save="true"
>               type="number"
>               :placeholder="
>                 i18n.t('defaultValueIs', {
>                   value: instance.driveCapacityPerLocalUserMb,
>                 })
>               "
>               @update:model-value="applyDriveCapacityOverride"
>             >
>               <template #label>{{ i18n.ts.driveCapOverrideLabel }}</template>
>               <template #suffix>MB</template>
>               <template #caption>
>                 {{ i18n.ts.driveCapOverrideCaption }}
>               </template>
>             </FormInput>
>           </FormSection>
>         </div>
>         <div v-else-if="tab === 'chart'" class="_formRoot">
>           <div class="cmhjzshm">
>             <div class="selects">
>               <MkSelect v-model="chartSrc" style="margin: 0 10px 0 0; flex: 1">
>                 <option value="per-user-notes">{{ i18n.ts.notes }}</option>
>               </MkSelect>
>             </div>
>             <div class="charts">
>               <div class="label">{{ i18n.t("recentNHours", { n: 90 }) }}</div>
>               <MkChart
>                 class="chart"
>                 :src="chartSrc"
>                 span="hour"
>                 :limit="90"
>                 :args="{ user, withoutAll: true }"
>                 :detailed="true"
>               ></MkChart>
>               <div class="label">{{ i18n.t("recentNDays", { n: 90 }) }}</div>
>               <MkChart
>                 class="chart"
>                 :src="chartSrc"
>                 span="day"
>                 :limit="90"
>                 :args="{ user, withoutAll: true }"
>                 :detailed="true"
>               ></MkChart>
>             </div>
>           </div>
>         </div>
>         <div v-else-if="tab === 'raw'" class="_formRoot">
>           <MkObjectView v-if="info && $i.isAdmin" tall :value="info">
>           </MkObjectView>
98,171c260,264
< 				<MkFolder>
< 					<template #icon><i class="ti ti-license"></i></template>
< 					<template #label>{{ i18n.ts._role.policies }}</template>
< 					<div class="_gaps">
< 						<div v-for="policy in Object.keys(info.policies)" :key="policy">
< 							{{ policy }} ... {{ info.policies[policy] }}
< 						</div>
< 					</div>
< 				</MkFolder>
< 
< 				<MkFolder>
< 					<template #icon><i class="ti ti-badges"></i></template>
< 					<template #label>{{ i18n.ts.roles }}</template>
< 					<div class="_gaps">
< 						<MkButton v-if="user.host == null && iAmModerator" primary rounded @click="assignRole"><i class="ti ti-plus"></i> {{ i18n.ts.assign }}</MkButton>
< 
< 						<div v-for="role in info.roles" :key="role.id" :class="$style.roleItem">
< 							<MkRolePreview :class="$style.role" :role="role"/>
< 							<button v-if="role.target === 'manual'" class="_button" :class="$style.roleUnassign" @click="unassignRole(role, $event)"><i class="ti ti-x"></i></button>
< 							<button v-else class="_button" :class="$style.roleUnassign" disabled><i class="ti ti-ban"></i></button>
< 						</div>
< 					</div>
< 				</MkFolder>
< 
< 				<MkFolder>
< 					<template #icon><i class="ti ti-password"></i></template>
< 					<template #label>IP</template>
< 					<MkInfo v-if="!iAmAdmin" warn>{{ i18n.ts.requireAdminForView }}</MkInfo>
< 					<MkInfo v-else>The date is the IP address was first acknowledged.</MkInfo>
< 					<template v-if="iAmAdmin && ips">
< 						<div v-for="record in ips" :key="record.ip" class="_monospace" :class="$style.ip" style="margin: 1em 0;">
< 							<span class="date">{{ record.createdAt }}</span>
< 							<span class="ip">{{ record.ip }}</span>
< 						</div>
< 					</template>
< 				</MkFolder>
< 
< 				<MkFolder>
< 					<template #icon><i class="ti ti-cloud"></i></template>
< 					<template #label>{{ i18n.ts.files }}</template>
< 					<MkFileListForAdmin :pagination="filesPagination" view-mode="grid"/>
< 				</MkFolder>
< 
< 				<MkTextarea v-model="moderationNote" manual-save>
< 					<template #label>Moderation note</template>
< 				</MkTextarea>
< 			</div>
< 
< 			<div v-else-if="tab === 'chart'" class="_gaps_m">
< 				<div class="cmhjzshm">
< 					<div class="selects">
< 						<MkSelect v-model="chartSrc" style="margin: 0 10px 0 0; flex: 1;">
< 							<option value="per-user-notes">{{ i18n.ts.notes }}</option>
< 						</MkSelect>
< 					</div>
< 					<div class="charts">
< 						<div class="label">{{ i18n.t('recentNHours', { n: 90 }) }}</div>
< 						<MkChart class="chart" :src="chartSrc" span="hour" :limit="90" :args="{ user, withoutAll: true }" :detailed="true"></MkChart>
< 						<div class="label">{{ i18n.t('recentNDays', { n: 90 }) }}</div>
< 						<MkChart class="chart" :src="chartSrc" span="day" :limit="90" :args="{ user, withoutAll: true }" :detailed="true"></MkChart>
< 					</div>
< 				</div>
< 			</div>
< 
< 			<div v-else-if="tab === 'raw'" class="_gaps_m">
< 				<MkObjectView v-if="info && $i.isAdmin" tall :value="info">
< 				</MkObjectView>
< 
< 				<MkObjectView tall :value="user">
< 				</MkObjectView>
< 			</div>
< 		</FormSuspense>
< 	</MkSpacer>
< </MkStickyContainer>
---
>           <MkObjectView tall :value="user"> </MkObjectView>
>         </div>
>       </FormSuspense>
>     </MkSpacer>
>   </MkStickyContainer>
175,201c268,293
< import { computed, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import MkChart from '@/components/MkChart.vue';
< import MkObjectView from '@/components/MkObjectView.vue';
< import MkTextarea from '@/components/MkTextarea.vue';
< import MkSwitch from '@/components/MkSwitch.vue';
< import FormLink from '@/components/form/link.vue';
< import FormSection from '@/components/form/section.vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import FormSplit from '@/components/form/split.vue';
< import MkFolder from '@/components/MkFolder.vue';
< import MkKeyValue from '@/components/MkKeyValue.vue';
< import MkSelect from '@/components/MkSelect.vue';
< import FormSuspense from '@/components/form/suspense.vue';
< import MkFileListForAdmin from '@/components/MkFileListForAdmin.vue';
< import MkInfo from '@/components/MkInfo.vue';
< import * as os from '@/os';
< import number from '@/filters/number';
< import bytes from '@/filters/bytes';
< import { url } from '@/config';
< import { userPage, acct } from '@/filters/user';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
< import { iAmAdmin, iAmModerator } from '@/account';
< import { instance } from '@/instance';
< import MkRolePreview from '@/components/MkRolePreview.vue';
---
> import { computed, watch } from "vue";
> import * as misskey from "misskey-js";
> import MkChart from "@/components/MkChart.vue";
> import MkObjectView from "@/components/MkObjectView.vue";
> import FormTextarea from "@/components/form/textarea.vue";
> import FormSwitch from "@/components/form/switch.vue";
> import FormLink from "@/components/form/link.vue";
> import FormSection from "@/components/form/section.vue";
> import FormButton from "@/components/MkButton.vue";
> import FormInput from "@/components/form/input.vue";
> import FormSplit from "@/components/form/split.vue";
> import FormFolder from "@/components/form/folder.vue";
> import MkKeyValue from "@/components/MkKeyValue.vue";
> import MkSelect from "@/components/form/select.vue";
> import FormSuspense from "@/components/form/suspense.vue";
> import MkFileListForAdmin from "@/components/MkFileListForAdmin.vue";
> import MkInfo from "@/components/MkInfo.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import bytes from "@/filters/bytes";
> import { url } from "@/config";
> import { userPage, acct } from "@/filters/user";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
> import { iAmAdmin, iAmModerator } from "@/account";
> import { instance } from "@/instance";
203,208c295,297
< const props = withDefaults(defineProps<{
< 	userId: string;
< 	initialTab?: string;
< }>(), {
< 	initialTab: 'overview',
< });
---
> const props = defineProps<{
>   userId: string;
> }>();
210,211c299,300
< let tab = $ref(props.initialTab);
< let chartSrc = $ref('per-user-notes');
---
> let tab = $ref("overview");
> let chartSrc = $ref("per-user-notes");
220c309,310
< let moderationNote = $ref('');
---
> let driveCapacityOverrideMb: number | null = $ref(0);
> let moderationNote = $ref("");
222,226c312,316
< 	endpoint: 'admin/drive/files' as const,
< 	limit: 10,
< 	params: computed(() => ({
< 		userId: props.userId,
< 	})),
---
>   endpoint: "admin/drive/files" as const,
>   limit: 10,
>   params: computed(() => ({
>     userId: props.userId,
>   })),
230,244c320,342
< 	if (iAmModerator) {
< 		return () => Promise.all([os.api('users/show', {
< 			userId: props.userId,
< 		}), os.api('admin/show-user', {
< 			userId: props.userId,
< 		}), iAmAdmin ? os.api('admin/get-user-ips', {
< 			userId: props.userId,
< 		}) : Promise.resolve(null)]).then(([_user, _info, _ips]) => {
< 			user = _user;
< 			info = _info;
< 			ips = _ips;
< 			moderator = info.isModerator;
< 			silenced = info.isSilenced;
< 			suspended = info.isSuspended;
< 			moderationNote = info.moderationNote;
---
>   if (iAmModerator) {
>     return () =>
>       Promise.all([
>         os.api("users/show", {
>           userId: props.userId,
>         }),
>         os.api("admin/show-user", {
>           userId: props.userId,
>         }),
>         iAmAdmin
>           ? os.api("admin/get-user-ips", {
>               userId: props.userId,
>             })
>           : Promise.resolve(null),
>       ]).then(([_user, _info, _ips]) => {
>         user = _user;
>         info = _info;
>         ips = _ips;
>         moderator = info.isModerator;
>         silenced = info.isSilenced;
>         suspended = info.isSuspended;
>         driveCapacityOverrideMb = user.driveCapacityOverrideMb;
>         moderationNote = info.moderationNote;
246,257c344,361
< 			watch($$(moderationNote), async () => {
< 				await os.api('admin/update-user-note', { userId: user.id, text: moderationNote });
< 				await refreshUser();
< 			});
< 		});
< 	} else {
< 		return () => os.api('users/show', {
< 			userId: props.userId,
< 		}).then((res) => {
< 			user = res;
< 		});
< 	}
---
>         watch($$(moderationNote), async () => {
>           await os.api("admin/update-user-note", {
>             userId: user.id,
>             text: moderationNote,
>           });
>           await refreshUser();
>         });
>       });
>   } else {
>     return () =>
>       os
>         .api("users/show", {
>           userId: props.userId,
>         })
>         .then((res) => {
>           user = res;
>         });
>   }
261c365
< 	init = createFetcher();
---
>   init = createFetcher();
265,266c369,370
< 	await os.apiWithDialog('federation/update-remote-user', { userId: user.id });
< 	refreshUser();
---
>   await os.apiWithDialog("federation/update-remote-user", { userId: user.id });
>   refreshUser();
270,272c374,376
< 	const { password } = await os.api('admin/reset-password', {
< 		userId: user.id,
< 	});
---
>   const { password } = await os.api("admin/reset-password", {
>     userId: user.id,
>   });
274,277c378,381
< 	os.alert({
< 		type: 'success',
< 		text: i18n.t('newPasswordIs', { password }),
< 	});
---
>   os.alert({
>     type: "success",
>     text: i18n.t("newPasswordIs", { password }),
>   });
279a384,398
> async function toggleSilence(v) {
>   const confirm = await os.confirm({
>     type: "warning",
>     text: v ? i18n.ts.silenceConfirm : i18n.ts.unsilenceConfirm,
>   });
>   if (confirm.canceled) {
>     silenced = !v;
>   } else {
>     await os.api(v ? "admin/silence-user" : "admin/unsilence-user", {
>       userId: user.id,
>     });
>     await refreshUser();
>   }
> }
> 
281,290c400,411
< 	const confirm = await os.confirm({
< 		type: 'warning',
< 		text: v ? i18n.ts.suspendConfirm : i18n.ts.unsuspendConfirm,
< 	});
< 	if (confirm.canceled) {
< 		suspended = !v;
< 	} else {
< 		await os.api(v ? 'admin/suspend-user' : 'admin/unsuspend-user', { userId: user.id });
< 		await refreshUser();
< 	}
---
>   const confirm = await os.confirm({
>     type: "warning",
>     text: v ? i18n.ts.suspendConfirm : i18n.ts.unsuspendConfirm,
>   });
>   if (confirm.canceled) {
>     suspended = !v;
>   } else {
>     await os.api(v ? "admin/suspend-user" : "admin/unsuspend-user", {
>       userId: user.id,
>     });
>     await refreshUser();
>   }
292a414,420
> async function toggleModerator(v) {
>   await os.api(v ? "admin/moderators/add" : "admin/moderators/remove", {
>     userId: user.id,
>   });
>   await refreshUser();
> }
> 
294,309c422,437
< 	const confirm = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.deleteAllFilesConfirm,
< 	});
< 	if (confirm.canceled) return;
< 	const process = async () => {
< 		await os.api('admin/delete-all-files-of-a-user', { userId: user.id });
< 		os.success();
< 	};
< 	await process().catch(err => {
< 		os.alert({
< 			type: 'error',
< 			text: err.toString(),
< 		});
< 	});
< 	await refreshUser();
---
>   const confirm = await os.confirm({
>     type: "warning",
>     text: i18n.ts.deleteAllFilesConfirm,
>   });
>   if (confirm.canceled) return;
>   const process = async () => {
>     await os.api("admin/delete-all-files-of-a-user", { userId: user.id });
>     os.success();
>   };
>   await process().catch((err) => {
>     os.alert({
>       type: "error",
>       text: err.toString(),
>     });
>   });
>   await refreshUser();
312,333c440,456
< async function deleteAccount() {
< 	const confirm = await os.confirm({
< 		type: 'warning',
< 		text: i18n.ts.deleteAccountConfirm,
< 	});
< 	if (confirm.canceled) return;
< 
< 	const typed = await os.inputText({
< 		text: i18n.t('typeToConfirm', { x: user?.username }),
< 	});
< 	if (typed.canceled) return;
< 
< 	if (typed.result === user?.username) {
< 		await os.apiWithDialog('admin/delete-account', {
< 			userId: user.id,
< 		});
< 	} else {
< 		os.alert({
< 			type: 'error',
< 			text: 'input not match',
< 		});
< 	}
---
> async function applyDriveCapacityOverride() {
>   let driveCapOrMb = driveCapacityOverrideMb;
>   if (driveCapacityOverrideMb && driveCapacityOverrideMb < 0) {
>     driveCapOrMb = null;
>   }
>   try {
>     await os.apiWithDialog("admin/drive-capacity-override", {
>       userId: user.id,
>       overrideMb: driveCapOrMb,
>     });
>     await refreshUser();
>   } catch (err) {
>     os.alert({
>       type: "error",
>       text: err.toString(),
>     });
>   }
336,337c459,464
< async function assignRole() {
< 	const roles = await os.api('admin/roles/list');
---
> async function deleteAccount() {
>   const confirm = await os.confirm({
>     type: "warning",
>     text: i18n.ts.deleteAccountConfirm,
>   });
>   if (confirm.canceled) return;
339,343c466,469
< 	const { canceled, result: roleId } = await os.select({
< 		title: i18n.ts._role.chooseRoleToAssign,
< 		items: roles.map(r => ({ text: r.name, value: r.id })),
< 	});
< 	if (canceled) return;
---
>   const typed = await os.inputText({
>     text: i18n.t("typeToConfirm", { x: user?.username }),
>   });
>   if (typed.canceled) return;
345,346c471,480
< 	await os.apiWithDialog('admin/roles/assign', { roleId, userId: user.id });
< 	refreshUser();
---
>   if (typed.result === user?.username) {
>     await os.apiWithDialog("admin/delete-account", {
>       userId: user.id,
>     });
>   } else {
>     os.alert({
>       type: "error",
>       text: "input not match",
>     });
>   }
349,359c483,491
< async function unassignRole(role, ev) {
< 	os.popupMenu([{
< 		text: i18n.ts.unassign,
< 		icon: 'ti ti-x',
< 		danger: true,
< 		action: async () => {
< 			await os.apiWithDialog('admin/roles/unassign', { roleId: role.id, userId: user.id });
< 			refreshUser();
< 		},
< 	}], ev.currentTarget ?? ev.target);
< }
---
> watch(
>   () => props.userId,
>   () => {
>     init = createFetcher();
>   },
>   {
>     immediate: true,
>   }
> );
361,366d492
< watch(() => props.userId, () => {
< 	init = createFetcher();
< }, {
< 	immediate: true,
< });
< 
368,372c494,498
< 	os.api('ap/get', {
< 		uri: user.uri ?? `${url}/users/${user.id}`,
< 	}).then(res => {
< 		ap = res;
< 	});
---
>   os.api("ap/get", {
>     uri: user.uri ?? `${url}/users/${user.id}`,
>   }).then((res) => {
>     ap = res;
>   });
377,393c503,528
< const headerTabs = $computed(() => [{
< 	key: 'overview',
< 	title: i18n.ts.overview,
< 	icon: 'ti ti-info-circle',
< }, iAmModerator ? {
< 	key: 'moderation',
< 	title: i18n.ts.moderation,
< 	icon: 'ti ti-user-exclamation',
< } : null, {
< 	key: 'chart',
< 	title: i18n.ts.charts,
< 	icon: 'ti ti-chart-line',
< }, {
< 	key: 'raw',
< 	title: 'Raw',
< 	icon: 'ti ti-code',
< }].filter(x => x != null));
---
> const headerTabs = $computed(() =>
>   [
>     {
>       key: "overview",
>       title: i18n.ts.overview,
>       icon: "fas fa-info-circle",
>     },
>     iAmModerator
>       ? {
>           key: "moderation",
>           title: i18n.ts.moderation,
>           icon: "fas fa-shield-halved",
>         }
>       : null,
>     {
>       key: "chart",
>       title: i18n.ts.charts,
>       icon: "fas fa-chart-simple",
>     },
>     {
>       key: "raw",
>       title: "Raw",
>       icon: "fas fa-code",
>     },
>   ].filter((x) => x != null)
> );
395,398c530,535
< definePageMetadata(computed(() => ({
< 	title: user ? acct(user) : i18n.ts.userInfo,
< 	icon: 'ti ti-info-circle',
< })));
---
> definePageMetadata(
>   computed(() => ({
>     title: user ? acct(user) : i18n.ts.userInfo,
>     icon: "fas fa-info-circle",
>   }))
> );
403,404c540,541
< 	display: flex;
< 	align-items: center;
---
>   display: flex;
>   align-items: center;
406,411c543,548
< 	> .avatar {
< 		display: block;
< 		width: 64px;
< 		height: 64px;
< 		margin-right: 16px;
< 	}
---
>   > .avatar {
>     display: block;
>     width: 64px;
>     height: 64px;
>     margin-right: 16px;
>   }
413,415c550,552
< 	> .body {
< 		flex: 1;
< 		overflow: hidden;
---
>   > .body {
>     flex: 1;
>     overflow: hidden;
417,423c554,560
< 		> .name {
< 			display: block;
< 			width: 100%;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
---
>     > .name {
>       display: block;
>       width: 100%;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
425,433c562,570
< 		> .sub {
< 			display: block;
< 			width: 100%;
< 			font-size: 85%;
< 			opacity: 0.7;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 		}
---
>     > .sub {
>       display: block;
>       width: 100%;
>       font-size: 85%;
>       opacity: 0.7;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>     }
435,439c572,576
< 		> .state {
< 			display: flex;
< 			gap: 8px;
< 			flex-wrap: wrap;
< 			margin-top: 4px;
---
>     > .state {
>       display: flex;
>       gap: 8px;
>       flex-wrap: wrap;
>       margin-top: 4px;
441,443c578,580
< 			&:empty {
< 				display: none;
< 			}
---
>       &:empty {
>         display: none;
>       }
445,451c582,590
< 			> .suspended, > .silenced, > .moderator {
< 				display: inline-block;
< 				border: solid 1px;
< 				border-radius: 6px;
< 				padding: 2px 6px;
< 				font-size: 85%;
< 			}
---
>       > .suspended,
>       > .silenced,
>       > .moderator {
>         display: inline-block;
>         border: solid 1px;
>         border-radius: 6px;
>         padding: 2px 6px;
>         font-size: 85%;
>       }
453,456c592,595
< 			> .suspended {
< 				color: var(--error);
< 				border-color: var(--error);
< 			}
---
>       > .suspended {
>         color: var(--error);
>         border-color: var(--error);
>       }
458,461c597,600
< 			> .silenced {
< 				color: var(--warn);
< 				border-color: var(--warn);
< 			}
---
>       > .silenced {
>         color: var(--warn);
>         border-color: var(--warn);
>       }
463,468c602,607
< 			> .moderator {
< 				color: var(--success);
< 				border-color: var(--success);
< 			}
< 		}
< 	}
---
>       > .moderator {
>         color: var(--success);
>         border-color: var(--success);
>       }
>     }
>   }
472,475c611,614
< 	> .selects {
< 		display: flex;
< 		margin: 0 0 16px 0;
< 	}
---
>   > .selects {
>     display: flex;
>     margin: 0 0 16px 0;
>   }
477,482c616,621
< 	> .charts {
< 		> .label {
< 			margin-bottom: 12px;
< 			font-weight: bold;
< 		}
< 	}
---
>   > .charts {
>     > .label {
>       margin-bottom: 12px;
>       font-weight: bold;
>     }
>   }
488c627
< 	display: flex;
---
>   display: flex;
490,492c629,631
< 	> :global(.date) {
< 		opacity: 0.7;
< 	}
---
>   > :global(.date) {
>     opacity: 0.7;
>   }
494,511c633,635
< 	> :global(.ip) {
< 		margin-left: auto;
< 	}
< }
< 
< .roleItem {
< 	display: flex;
< }
< 
< .role {
< 	flex: 1;
< }
< 
< .roleUnassign {
< 	width: 32px;
< 	height: 32px;
< 	margin-left: 8px;
< 	align-self: center;
---
>   > :global(.ip) {
>     margin-left: auto;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/user-list-timeline.vue RiricaV13/pages/user-list-timeline.vue
2,17c2,24
< <MkStickyContainer>
< 	<template #header><MkPageHeader :actions="headerActions" :tabs="headerTabs"/></template>
< 	<div ref="rootEl" class="eqqrhokj">
< 		<div v-if="queue > 0" class="new"><button class="_buttonPrimary" @click="top()">{{ i18n.ts.newNoteRecived }}</button></div>
< 		<div class="tl">
< 			<XTimeline
< 				ref="tlEl" :key="listId"
< 				class="tl"
< 				src="list"
< 				:list="listId"
< 				:sound="true"
< 				@queue="queueUpdated"
< 			/>
< 		</div>
< 	</div>
< </MkStickyContainer>
---
>   <MkStickyContainer>
>     <template #header
>       ><MkPageHeader :actions="headerActions" :tabs="headerTabs"
>     /></template>
>     <div ref="rootEl" v-size="{ min: [800] }" class="eqqrhokj">
>       <div v-if="queue > 0" class="new">
>         <button class="_buttonPrimary" @click="top()">
>           {{ i18n.ts.newNoteRecived }}
>         </button>
>       </div>
>       <div class="tl _block">
>         <XTimeline
>           ref="tlEl"
>           :key="listId"
>           class="tl"
>           src="list"
>           :list="listId"
>           :sound="true"
>           @queue="queueUpdated"
>         />
>       </div>
>     </div>
>   </MkStickyContainer>
21,27c28,34
< import { computed, watch, inject } from 'vue';
< import XTimeline from '@/components/MkTimeline.vue';
< import { scroll } from '@/scripts/scroll';
< import * as os from '@/os';
< import { useRouter } from '@/router';
< import { definePageMetadata } from '@/scripts/page-metadata';
< import { i18n } from '@/i18n';
---
> import { computed, watch, inject } from "vue";
> import XTimeline from "@/components/MkTimeline.vue";
> import { scroll } from "@/scripts/scroll";
> import * as os from "@/os";
> import { useRouter } from "@/router";
> import { definePageMetadata } from "@/scripts/page-metadata";
> import { i18n } from "@/i18n";
32c39
< 	listId: string;
---
>   listId: string;
37,38c44,45
< let tlEl = $shallowRef<InstanceType<typeof XTimeline>>();
< let rootEl = $shallowRef<HTMLElement>();
---
> let tlEl = $ref<InstanceType<typeof XTimeline>>();
> let rootEl = $ref<HTMLElement>();
40,44c47,55
< watch(() => props.listId, async () => {
< 	list = await os.api('users/lists/show', {
< 		listId: props.listId,
< 	});
< }, { immediate: true });
---
> watch(
>   () => props.listId,
>   async () => {
>     list = await os.api("users/lists/show", {
>       listId: props.listId,
>     });
>   },
>   { immediate: true }
> );
47c58
< 	queue = q;
---
>   queue = q;
51c62
< 	scroll(rootEl, { top: 0 });
---
>   scroll(rootEl, { top: 0 });
55c66
< 	router.push(`/my/lists/${props.listId}`);
---
>   router.push(`/my/lists/${props.listId}`);
59,62c70,73
< 	const { canceled, result: date } = await os.inputDate({
< 		title: i18n.ts.date,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: date } = await os.inputDate({
>     title: i18n.ts.date,
>   });
>   if (canceled) return;
64c75
< 	tlEl.timetravel(date);
---
>   tlEl.timetravel(date);
67,75c78,93
< const headerActions = $computed(() => list ? [{
< 	icon: 'fas fa-calendar-alt',
< 	text: i18n.ts.jumpToSpecifiedDate,
< 	handler: timetravel,
< }, {
< 	icon: 'ti ti-settings',
< 	text: i18n.ts.settings,
< 	handler: settings,
< }] : []);
---
> const headerActions = $computed(() =>
>   list
>     ? [
>         {
>           icon: "fas fa-calendar-alt",
>           text: i18n.ts.jumpToSpecifiedDate,
>           handler: timetravel,
>         },
>         {
>           icon: "fas fa-cog",
>           text: i18n.ts.settings,
>           handler: settings,
>         },
>       ]
>     : []
> );
79,82c97,106
< definePageMetadata(computed(() => list ? {
< 	title: list.name,
< 	icon: 'ti ti-list',
< } : null));
---
> definePageMetadata(
>   computed(() =>
>     list
>       ? {
>           title: list.name,
>           icon: "fas fa-list-ul",
>         }
>       : null
>   )
> );
87c111
< 	padding: var(--margin);
---
>   padding: var(--margin);
89,93c113,117
< 	> .new {
< 		position: sticky;
< 		top: calc(var(--stickyTop, 0px) + 16px);
< 		z-index: 1000;
< 		width: 100%;
---
>   > .new {
>     position: sticky;
>     top: calc(var(--stickyTop, 0px) + 16px);
>     z-index: 1000;
>     width: 100%;
95,101c119,125
< 		> button {
< 			display: block;
< 			margin: var(--margin) auto 0 auto;
< 			padding: 8px 16px;
< 			border-radius: 32px;
< 		}
< 	}
---
>     > button {
>       display: block;
>       margin: var(--margin) auto 0 auto;
>       padding: 8px 16px;
>       border-radius: 32px;
>     }
>   }
103,108c127,131
< 	> .tl {
< 		background: var(--bg);
< 		border-radius: var(--radius);
< 		overflow: clip;
< 	}
< }
---
>   > .tl {
>     background: var(--bg);
>     border-radius: var(--radius);
>     overflow: clip;
>   }
110,114c133,136
< @container (min-width: 800px) {
< 	.eqqrhokj {
< 		max-width: 800px;
< 		margin: 0 auto;
< 	}
---
>   &.min-width_800px {
>     max-width: 800px;
>     margin: 0 auto;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/welcome.entrance.a.vue RiricaV13/pages/welcome.entrance.a.vue
2c2
< <div v-if="meta" class="rsqzvsbo">
---
> <div class="rsqzvsbo">
4,5d3
< 		<MkFeaturedPhotos class="bg"/>
< 		<XTimeline class="tl"/>
17,18c15,17
< 			<img :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'" alt="" class="icon"/>
< 			<button class="_button _acrylic menu" @click="showMenu"><i class="ti ti-dots"></i></button>
---
> 			<button class="_button _acrylic menu" @click="showMenu">
> 				<i class="fas fa-ellipsis-h"></i>
> 			</button>
23c22
< 					<span class="text">{{ instanceName }}</span>
---
> 					<span class="text">{{ $ts.ririca.name }}</span>
26,27c25
< 					<!-- eslint-disable-next-line vue/no-v-html -->
< 					<div class="desc" v-html="meta.description || i18n.ts.headlineMisskey"></div>
---
> 					{{ $ts.ririca.description }}
30,31c28,39
< 					<MkButton inline rounded gradate data-cy-signup style="margin-right: 12px;" @click="signup()">{{ i18n.ts.signup }}</MkButton>
< 					<MkButton inline rounded data-cy-signin @click="signin()">{{ i18n.ts.login }}</MkButton>
---
> 					<div>
> 						<input id="term" v-model="isTerm" type="checkbox"><label for="term">
> 							{{ $ts.ririca.term }}</label><br>
> 						<a href="https://riinswork.space/missRirica/privacy/">{{ $ts.ririca.termLink }}</a>
> 					</div>
> 
> 					<!--					<MkButton inline rounded gradate data-cy-signup style="margin-right: 12px;" @click="signup()">{{ i18n.ts.signup }}</MkButton>-->
> 					<MkButton inline rounded data-cy-signin :disabled="!isTerm" @click="signin()">
> 						{{
> 							i18n.ts.login
> 						}}
> 					</MkButton>
35,43d42
< 		<div v-if="instances" class="federation">
< 			<MarqueeText :duration="40">
< 				<MkA v-for="instance in instances" :key="instance.id" :class="$style.federationInstance" :to="`/instance-info/${instance.host}`" behavior="window">
< 					<!--<MkInstanceCardMini :instance="instance"/>-->
< 					<img v-if="instance.iconUrl" class="icon" :src="instance.iconUrl" alt=""/>
< 					<span class="name _monospace">{{ instance.host }}</span>
< 				</MkA>
< 			</MarqueeText>
< 		</div>
49,61c48,59
< import { } from 'vue';
< import { toUnicode } from 'punycode/';
< import XTimeline from './welcome.timeline.vue';
< import MarqueeText from '@/components/MkMarquee.vue';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import MkButton from '@/components/MkButton.vue';
< import XNote from '@/components/MkNote.vue';
< import MkFeaturedPhotos from '@/components/MkFeaturedPhotos.vue';
< import { host, instanceName } from '@/config';
< import * as os from '@/os';
< import number from '@/filters/number';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import { toUnicode } from "punycode/";
> import MarqueeText from "@/components/MkMarquee.vue";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import MkButton from "@/components/MkButton.vue";
> import XNote from "@/components/MkNote.vue";
> import MkFeaturedPhotos from "@/components/MkFeaturedPhotos.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
> import { i18n } from "@/i18n";
> import { noCredentialApi } from "@/os";
67a66
> let isTerm = $ref()
69,71d67
< os.api('meta', { detail: true }).then(_meta => {
< 	meta = _meta;
< });
73,94d68
< os.api('stats').then(_stats => {
< 	stats = _stats;
< });
< 
< os.api('get-online-users-count').then(res => {
< 	onlineUsersCount = res.count;
< });
< 
< os.api('hashtags/list', {
< 	sort: '+mentionedLocalUsers',
< 	limit: 8,
< }).then(_tags => {
< 	tags = _tags;
< });
< 
< os.api('federation/instances', {
< 	sort: '+pubSub',
< 	limit: 20,
< }).then(_instances => {
< 	instances = _instances;
< });
< 
96,98c70,77
< 	os.popup(XSigninDialog, {
< 		autoSet: true,
< 	}, {}, 'closed');
---
>   os.popup(
>     XSigninDialog,
>     {
>       autoSet: true,
>     },
>     {},
>     "closed"
>   );
102,104c81,88
< 	os.popup(XSignupDialog, {
< 		autoSet: true,
< 	}, {}, 'closed');
---
>   os.popup(
>     XSignupDialog,
>     {
>       autoSet: true,
>     },
>     {},
>     "closed"
>   );
108,126c92,118
< 	os.popupMenu([{
< 		text: i18n.ts.instanceInfo,
< 		icon: 'ti ti-info-circle',
< 		action: () => {
< 			os.pageWindow('/about');
< 		},
< 	}, {
< 		text: i18n.ts.aboutMisskey,
< 		icon: 'ti ti-info-circle',
< 		action: () => {
< 			os.pageWindow('/about-misskey');
< 		},
< 	}, null, {
< 		text: i18n.ts.help,
< 		icon: 'ti ti-question-circle',
< 		action: () => {
< 			window.open('https://misskey-hub.net/help.md', '_blank');
< 		},
< 	}], ev.currentTarget ?? ev.target);
---
>   os.popupMenu(
>     [
>       {
>         text: i18n.ts.instanceInfo,
>         icon: "fas fa-info-circle",
>         action: () => {
>           os.pageWindow("/about");
>         },
>       },
>       {
>         text: i18n.ts.aboutMisskey,
>         icon: "fas fa-info-circle",
>         action: () => {
>           os.pageWindow("/about-misskey");
>         },
>       },
>       null,
>       {
>         text: i18n.ts.help,
>         icon: "fas fa-question-circle",
>         action: () => {
>           window.open("https://misskey-hub.net/help.md", "_blank");
>         },
>       },
>     ],
>     ev.currentTarget ?? ev.target
>   );
132,137c124,129
< 	> .top {
< 		display: flex;
< 		text-align: center;
< 		min-height: 100vh;
< 		box-sizing: border-box;
< 		padding: 16px;
---
>   > .top {
>     display: flex;
>     text-align: center;
>     min-height: 100vh;
>     box-sizing: border-box;
>     padding: 16px;
139,145c131,137
< 		> .bg {
< 			position: absolute;
< 			top: 0;
< 			right: 0;
< 			width: 80%; // 100%からshapeの幅を引いている
< 			height: 100%;
< 		}
---
>     > .bg {
>       position: absolute;
>       top: 0;
>       right: 0;
>       width: 80%; // 100%からshapeの幅を引いている
>       height: 100%;
>     }
147,157c139,161
< 		> .tl {
< 			position: absolute;
< 			top: 0;
< 			bottom: 0;
< 			right: 64px;
< 			margin: auto;
< 			width: 500px;
< 			height: calc(100% - 128px);
< 			overflow: hidden;
< 			-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 128px, rgba(0,0,0,1) calc(100% - 128px), rgba(0,0,0,0) 100%);
< 			mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 128px, rgba(0,0,0,1) calc(100% - 128px), rgba(0,0,0,0) 100%);
---
>     > .tl {
>       position: absolute;
>       top: 0;
>       bottom: 0;
>       right: 64px;
>       margin: auto;
>       width: 500px;
>       height: calc(100% - 128px);
>       overflow: hidden;
>       -webkit-mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 128px,
>         rgba(0, 0, 0, 1) calc(100% - 128px),
>         rgba(0, 0, 0, 0) 100%
>       );
>       mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 128px,
>         rgba(0, 0, 0, 1) calc(100% - 128px),
>         rgba(0, 0, 0, 0) 100%
>       );
159,162c163,166
< 			@media (max-width: 1200px) {
< 				display: none;
< 			}
< 		}
---
>       @media (max-width: 1200px) {
>         display: none;
>       }
>     }
164,182c168,186
< 		> .shape1 {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: var(--accent);
< 			clip-path: polygon(0% 0%, 45% 0%, 20% 100%, 0% 100%);
< 		}
< 		> .shape2 {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: var(--accent);
< 			clip-path: polygon(0% 0%, 25% 0%, 35% 100%, 0% 100%);
< 			opacity: 0.5;
< 		}
---
>     > .shape1 {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: var(--accent);
>       clip-path: polygon(0% 0%, 45% 0%, 20% 100%, 0% 100%);
>     }
>     > .shape2 {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: var(--accent);
>       clip-path: polygon(0% 0%, 25% 0%, 35% 100%, 0% 100%);
>       opacity: 0.5;
>     }
184,188c188,192
< 		> .misskey {
< 			position: absolute;
< 			top: 42px;
< 			left: 42px;
< 			width: 140px;
---
>     > .misskey {
>       position: absolute;
>       top: 42px;
>       left: 42px;
>       width: 140px;
190,193c194,197
< 			@media (max-width: 450px) {
< 				width: 130px;
< 			}
< 		}
---
>       @media (max-width: 450px) {
>         width: 130px;
>       }
>     }
195,198c199,202
< 		> .emojis {
< 			position: absolute;
< 			bottom: 32px;
< 			left: 35px;
---
>     > .emojis {
>       position: absolute;
>       bottom: 32px;
>       left: 35px;
200,202c204,206
< 			> * {
< 				margin-right: 8px;
< 			}
---
>       > * {
>         margin-right: 8px;
>       }
204,207c208,211
< 			@media (max-width: 1200px) {
< 				display: none;
< 			}
< 		}
---
>       @media (max-width: 1200px) {
>         display: none;
>       }
>     }
209,215c213,219
< 		> .main {
< 			position: relative;
< 			width: min(480px, 100%);
< 			margin: auto auto auto 128px;
< 			background: var(--panel);
< 			border-radius: var(--radius);
< 			box-shadow: 0 12px 32px rgb(0 0 0 / 25%);
---
>     > .main {
>       position: relative;
>       width: min(480px, 100%);
>       margin: auto auto auto 128px;
>       background: var(--panel);
>       border-radius: var(--radius);
>       box-shadow: 0 12px 32px rgb(0 0 0 / 25%);
217,219c221,223
< 			@media (max-width: 1200px) {
< 				margin: auto;
< 			}
---
>       @media (max-width: 1200px) {
>         margin: auto;
>       }
221,226c225,230
< 			> .icon {
< 				width: 85px;
< 				margin-top: -47px;
< 				border-radius: 100%;
< 				vertical-align: bottom;
< 			}
---
>       > .icon {
>         width: 85px;
>         margin-top: -47px;
>         border-radius: 100%;
>         vertical-align: bottom;
>       }
228,236c232,240
< 			> .menu {
< 				position: absolute;
< 				top: 16px;
< 				right: 16px;
< 				width: 32px;
< 				height: 32px;
< 				border-radius: 8px;
< 				font-size: 18px;
< 			}
---
>       > .menu {
>         position: absolute;
>         top: 16px;
>         right: 16px;
>         width: 32px;
>         height: 32px;
>         border-radius: 8px;
>         font-size: 18px;
>       }
238,240c242,244
< 			> .fg {
< 				position: relative;
< 				z-index: 1;
---
>       > .fg {
>         position: relative;
>         z-index: 1;
242,246c246,250
< 				> h1 {
< 					display: block;
< 					margin: 0;
< 					padding: 16px 32px 24px 32px;
< 					font-size: 1.4em;
---
>         > h1 {
>           display: block;
>           margin: 0;
>           padding: 16px 32px 24px 32px;
>           font-size: 1.4em;
248,253c252,257
< 					> .logo {
< 						vertical-align: bottom;
< 						max-height: 120px;
< 						max-width: min(100%, 300px);
< 					}
< 				}
---
>           > .logo {
>             vertical-align: bottom;
>             max-height: 120px;
>             max-width: min(100%, 300px);
>           }
>         }
255,257c259,261
< 				> .about {
< 					padding: 0 32px;
< 				}
---
>         > .about {
>           padding: 0 32px;
>         }
259,260c263,264
< 				> .action {
< 					padding: 32px;
---
>         > .action {
>           padding: 32px;
262,267c266,271
< 					> * {
< 						line-height: 28px;
< 					}
< 				}
< 			}
< 		}
---
>           > * {
>             line-height: 28px;
>           }
>         }
>       }
>     }
269,281c273,285
< 		> .federation {
< 			position: absolute;
< 			bottom: 16px;
< 			left: 0;
< 			right: 0;
< 			margin: auto;
< 			background: var(--acrylicPanel);
< 			-webkit-backdrop-filter: var(--blur, blur(15px));
< 			backdrop-filter: var(--blur, blur(15px));
< 			border-radius: 999px;
< 			overflow: clip;
< 			width: 800px;
< 			padding: 8px 0;
---
>     > .federation {
>       position: absolute;
>       bottom: 16px;
>       left: 0;
>       right: 0;
>       margin: auto;
>       background: var(--acrylicPanel);
>       -webkit-backdrop-filter: var(--blur, blur(15px));
>       backdrop-filter: var(--blur, blur(15px));
>       border-radius: 999px;
>       overflow: clip;
>       width: 800px;
>       padding: 8px 0;
283,287c287,291
< 			@media (max-width: 900px) {
< 				display: none;
< 			}
< 		}
< 	}
---
>       @media (max-width: 900px) {
>         display: none;
>       }
>     }
>   }
293,299c297,303
< 	display: inline-flex;
< 	align-items: center;
< 	vertical-align: bottom;
< 	padding: 6px 12px 6px 6px;
< 	margin: 0 10px 0 0;
< 	background: var(--panel);
< 	border-radius: 999px;
---
>   display: inline-flex;
>   align-items: center;
>   vertical-align: bottom;
>   padding: 6px 12px 6px 6px;
>   margin: 0 10px 0 0;
>   background: var(--panel);
>   border-radius: 999px;
301,307c305,311
< 	> :global(.icon) {
< 		display: inline-block;
< 		width: 20px;
< 		height: 20px;
< 		margin-right: 5px;
< 		border-radius: 999px;
< 	}
---
>   > :global(.icon) {
>     display: inline-block;
>     width: 20px;
>     height: 20px;
>     margin-right: 5px;
>     border-radius: 999px;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/welcome.entrance.b.vue RiricaV13/pages/welcome.entrance.b.vue
4,5d3
< 		<MkFeaturedPhotos class="bg"/>
< 		<XTimeline class="tl"/>
9d6
< 				<img v-if="meta.logoImageUrl" class="logo" :src="meta.logoImageUrl"><span v-else class="text">{{ instanceName }}</span>
13c10,13
< 				<div class="desc" v-html="meta.description || $ts.headlineMisskey"></div>
---
> 				<div
> 					class="desc"
> 					v-html="meta.description || $ts.headlineMisskey"
> 				></div>
16,17c16,25
< 				<MkButton class="signup" inline gradate @click="signup()">{{ $ts.signup }}</MkButton>
< 				<MkButton class="signin" inline @click="signin()">{{ $ts.login }}</MkButton>
---
> 				<MkButton class="signup" inline gradate @click="signup()">
> 					{{
> 						$ts.signup
> 					}}
> 				</MkButton>
> 				<MkButton class="signin" inline @click="signin()">
> 					{{
> 						$ts.login
> 					}}
> 				</MkButton>
22c30,32
< 						<template #n><b>{{ number(stats.originalUsersCount) }}</b></template>
---
> 						<template #n>
> 							<b>{{ number(stats.originalUsersCount) }}</b>
> 						</template>
25c35,37
< 						<template #n><b>{{ number(stats.originalNotesCount) }}</b></template>
---
> 						<template #n>
> 							<b>{{ number(stats.originalNotesCount) }}</b>
> 						</template>
29c41,43
< 					<template #n><b>{{ onlineUsersCount }}</b></template>
---
> 					<template #n>
> 						<b>{{ onlineUsersCount }}</b>
> 					</template>
39,49c53,61
< import { defineComponent } from 'vue';
< import { toUnicode } from 'punycode/';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import MkButton from '@/components/MkButton.vue';
< import XNote from '@/components/MkNote.vue';
< import MkFeaturedPhotos from '@/components/MkFeaturedPhotos.vue';
< import XTimeline from './welcome.timeline.vue';
< import { host, instanceName } from '@/config';
< import * as os from '@/os';
< import number from '@/filters/number';
---
> import { defineComponent } from "vue";
> import { toUnicode } from "punycode/";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import MkButton from "@/components/MkButton.vue";
> import XNote from "@/components/MkNote.vue";
> import MkFeaturedPhotos from "@/components/MkFeaturedPhotos.vue";
> import * as os from "@/os";
> import number from "@/filters/number";
52,57c64,68
< 	components: {
< 		MkButton,
< 		XNote,
< 		XTimeline,
< 		MkFeaturedPhotos,
< 	},
---
>   components: {
>     MkButton,
>     XNote,
>     MkFeaturedPhotos,
>   },
59,68c70,77
< 	data() {
< 		return {
< 			host: toUnicode(host),
< 			instanceName,
< 			meta: null,
< 			stats: null,
< 			tags: [],
< 			onlineUsersCount: null,
< 		};
< 	},
---
>   data() {
>     return {
>       meta: null,
>       stats: null,
>       tags: [],
>       onlineUsersCount: null,
>     };
>   },
70,73c79
< 	created() {
< 		os.api('meta', { detail: true }).then(meta => {
< 			this.meta = meta;
< 		});
---
>   created() {
75,77c81
< 		os.api('stats').then(stats => {
< 			this.stats = stats;
< 		});
---
>   },
79,81c83,93
< 		os.api('get-online-users-count').then(res => {
< 			this.onlineUsersCount = res.count;
< 		});
---
>   methods: {
>     signin() {
>       os.popup(
>         XSigninDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
83,89c95,104
< 		os.api('hashtags/list', {
< 			sort: '+mentionedLocalUsers',
< 			limit: 8,
< 		}).then(tags => {
< 			this.tags = tags;
< 		});
< 	},
---
>     signup() {
>       os.popup(
>         XSignupDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
91,96c106,134
< 	methods: {
< 		signin() {
< 			os.popup(XSigninDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>     showMenu(ev) {
>       os.popupMenu(
>         [
>           {
>             text: this.$t("aboutX", { x: instanceName }),
>             icon: "fas fa-info-circle",
>             action: () => {
>               os.pageWindow("/about");
>             },
>           },
>           {
>             text: this.$ts.aboutMisskey,
>             icon: "fas fa-info-circle",
>             action: () => {
>               os.pageWindow("/about-misskey");
>             },
>           },
>           null,
>           {
>             text: this.$ts.help,
>             icon: "fas fa-question-circle",
>             action: () => {
>               window.open(`https://misskey-hub.net/help.md`, "_blank");
>             },
>           },
>         ],
>         ev.currentTarget ?? ev.target
>       );
>     },
98,127c136,137
< 		signup() {
< 			os.popup(XSignupDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
< 
< 		showMenu(ev) {
< 			os.popupMenu([{
< 				text: this.$t('aboutX', { x: instanceName }),
< 				icon: 'ti ti-info-circle',
< 				action: () => {
< 					os.pageWindow('/about');
< 				},
< 			}, {
< 				text: this.$ts.aboutMisskey,
< 				icon: 'ti ti-info-circle',
< 				action: () => {
< 					os.pageWindow('/about-misskey');
< 				},
< 			}, null, {
< 				text: this.$ts.help,
< 				icon: 'ti ti-question-circle',
< 				action: () => {
< 					window.open(`https://misskey-hub.net/help.md`, '_blank');
< 				},
< 			}], ev.currentTarget ?? ev.target);
< 		},
< 
< 		number,
< 	},
---
>     number,
>   },
133,135c143,145
< 	> .top {
< 		min-height: 100vh;
< 		box-sizing: border-box;
---
>   > .top {
>     min-height: 100vh;
>     box-sizing: border-box;
137,143c147,153
< 		> .bg {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 		}
---
>     > .bg {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>     }
145,156c155,178
< 		> .tl {
< 			position: absolute;
< 			top: 0;
< 			bottom: 0;
< 			right: 64px;
< 			margin: auto;
< 			width: 500px;
< 			height: calc(100% - 128px);
< 			overflow: hidden;
< 			-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 128px, rgba(0,0,0,1) calc(100% - 128px), rgba(0,0,0,0) 100%);
< 			mask-image: linear-gradient(0deg, rgba(0,0,0,0) 0%, rgba(0,0,0,1) 128px, rgba(0,0,0,1) calc(100% - 128px), rgba(0,0,0,0) 100%);
< 		}
---
>     > .tl {
>       position: absolute;
>       top: 0;
>       bottom: 0;
>       right: 64px;
>       margin: auto;
>       width: 500px;
>       height: calc(100% - 128px);
>       overflow: hidden;
>       -webkit-mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 128px,
>         rgba(0, 0, 0, 1) calc(100% - 128px),
>         rgba(0, 0, 0, 0) 100%
>       );
>       mask-image: linear-gradient(
>         0deg,
>         rgba(0, 0, 0, 0) 0%,
>         rgba(0, 0, 0, 1) 128px,
>         rgba(0, 0, 0, 1) calc(100% - 128px),
>         rgba(0, 0, 0, 0) 100%
>       );
>     }
158,166c180,188
< 		> .shape {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: var(--accent);
< 			clip-path: polygon(0% 0%, 40% 0%, 22% 100%, 0% 100%);
< 		}
---
>     > .shape {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: var(--accent);
>       clip-path: polygon(0% 0%, 40% 0%, 22% 100%, 0% 100%);
>     }
168,173c190,195
< 		> .misskey {
< 			position: absolute;
< 			bottom: 64px;
< 			left: 64px;
< 			width: 160px;
< 		}
---
>     > .misskey {
>       position: absolute;
>       bottom: 64px;
>       left: 64px;
>       width: 160px;
>     }
175,180c197,202
< 		> .main {
< 			position: relative;
< 			width: min(450px, 100%);
< 			padding: 64px;
< 			color: #fff;
< 			font-size: 1.1em;
---
>     > .main {
>       position: relative;
>       width: min(450px, 100%);
>       padding: 64px;
>       color: #fff;
>       font-size: 1.1em;
182,184c204,206
< 			@media (max-width: 1200px) {
< 				margin: auto;
< 			}
---
>       @media (max-width: 1200px) {
>         margin: auto;
>       }
186,189c208,211
< 			> h1 {
< 				display: block;
< 				margin: 0 0 32px 0;
< 				padding: 0;
---
>       > h1 {
>         display: block;
>         margin: 0 0 32px 0;
>         padding: 0;
191,195c213,217
< 				> .logo {
< 					vertical-align: bottom;
< 					max-height: 100px;
< 				}
< 			}
---
>         > .logo {
>           vertical-align: bottom;
>           max-height: 100px;
>         }
>       }
197,199c219,221
< 			> .about {
< 				padding: 0;
< 			}
---
>       > .about {
>         padding: 0;
>       }
201,202c223,224
< 			> .action {
< 				margin: 32px 0;
---
>       > .action {
>         margin: 32px 0;
204,206c226,228
< 				> * {
< 					line-height: 32px;
< 				}
---
>         > * {
>           line-height: 32px;
>         }
208,211c230,233
< 				> .signup {
< 					background: var(--panel);
< 					color: var(--fg);
< 				}
---
>         > .signup {
>           background: var(--panel);
>           color: var(--fg);
>         }
213,217c235,239
< 				> .signin {
< 					background: var(--accent);
< 					color: inherit;
< 				}
< 			}
---
>         > .signin {
>           background: var(--accent);
>           color: inherit;
>         }
>       }
219,222c241,244
< 			> .status {
< 				margin: 32px 0;
< 				border-top: solid 1px rgba(255, 255, 255, 0.5);
< 				font-size: 90%;
---
>       > .status {
>         margin: 32px 0;
>         border-top: solid 1px rgba(255, 255, 255, 0.5);
>         font-size: 90%;
224,225c246,247
< 				> div {
< 					padding: 16px 0;
---
>         > div {
>           padding: 16px 0;
227,235c249,257
< 					> span:not(:last-child) {
< 						padding-right: 1em;
< 						margin-right: 1em;
< 						border-right: solid 1px rgba(255, 255, 255, 0.5);
< 					}
< 				}
< 			}
< 		}
< 	}
---
>           > span:not(:last-child) {
>             padding-right: 1em;
>             margin-right: 1em;
>             border-right: solid 1px rgba(255, 255, 255, 0.5);
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/welcome.entrance.c.vue RiricaV13/pages/welcome.entrance.c.vue
4d3
< 		<MkFeaturedPhotos class="bg"/>
21c20,24
< 						<img v-if="meta.logoImageUrl" class="logo" :src="meta.logoImageUrl"><span v-else class="text">{{ instanceName }}</span>
---
> 						<img
> 							v-if="meta.logoImageUrl"
> 							class="logo"
> 							:src="meta.logoImageUrl"
> 						/><span v-else class="text">{{ instanceName }}</span>
25c28,31
< 						<div class="desc" v-html="meta.description || $ts.headlineMisskey"></div>
---
> 						<div
> 							class="desc"
> 							v-html="meta.description || $ts.headlineMisskey"
> 						></div>
28c34,38
< 						<MkButton inline gradate @click="signup()">{{ $ts.signup }}</MkButton>
---
> 						<MkButton inline gradate @click="signup()">
> 							{{
> 								$ts.signup
> 							}}
> 						</MkButton>
34c44,46
< 								<template #n><b>{{ number(stats.originalUsersCount) }}</b></template>
---
> 								<template #n>
> 									<b>{{ number(stats.originalUsersCount) }}</b>
> 								</template>
37c49,51
< 								<template #n><b>{{ number(stats.originalNotesCount) }}</b></template>
---
> 								<template #n>
> 									<b>{{ number(stats.originalNotesCount) }}</b>
> 								</template>
41c55,57
< 							<template #n><b>{{ onlineUsersCount }}</b></template>
---
> 							<template #n>
> 								<b>{{ onlineUsersCount }}</b>
> 							</template>
44c60,62
< 					<button class="_button _acrylic menu" @click="showMenu"><i class="ti ti-dots"></i></button>
---
> 					<button class="_button _acrylic menu" @click="showMenu">
> 						<i class="fas fa-ellipsis-h"></i>
> 					</button>
59,69c77,87
< import { defineComponent } from 'vue';
< import { toUnicode } from 'punycode/';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import MkButton from '@/components/MkButton.vue';
< import XNote from '@/components/MkNote.vue';
< import MkFeaturedPhotos from '@/components/MkFeaturedPhotos.vue';
< import XTimeline from './welcome.timeline.vue';
< import { host, instanceName } from '@/config';
< import * as os from '@/os';
< import number from '@/filters/number';
---
> import { defineComponent } from "vue";
> import { toUnicode } from "punycode/";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import MkButton from "@/components/MkButton.vue";
> import XNote from "@/components/MkNote.vue";
> import MkFeaturedPhotos from "@/components/MkFeaturedPhotos.vue";
> import XTimeline from "./welcome.timeline.vue";
> import { host, instanceName } from "@/config";
> import * as os from "@/os";
> import number from "@/filters/number";
72,77c90,95
< 	components: {
< 		MkButton,
< 		XNote,
< 		MkFeaturedPhotos,
< 		XTimeline,
< 	},
---
>   components: {
>     MkButton,
>     XNote,
>     MkFeaturedPhotos,
>     XTimeline,
>   },
79,88c97,106
< 	data() {
< 		return {
< 			host: toUnicode(host),
< 			instanceName,
< 			meta: null,
< 			stats: null,
< 			tags: [],
< 			onlineUsersCount: null,
< 		};
< 	},
---
>   data() {
>     return {
>       host: toUnicode(host),
>       instanceName,
>       meta: null,
>       stats: null,
>       tags: [],
>       onlineUsersCount: null,
>     };
>   },
90,93c108,111
< 	created() {
< 		os.api('meta', { detail: true }).then(meta => {
< 			this.meta = meta;
< 		});
---
>   created() {
>     os.api("meta", { detail: true }).then((meta) => {
>       this.meta = meta;
>     });
95,97c113,115
< 		os.api('stats').then(stats => {
< 			this.stats = stats;
< 		});
---
>     os.api("stats").then((stats) => {
>       this.stats = stats;
>     });
99,101c117,119
< 		os.api('get-online-users-count').then(res => {
< 			this.onlineUsersCount = res.count;
< 		});
---
>     os.api("get-online-users-count").then((res) => {
>       this.onlineUsersCount = res.count;
>     });
103,109c121,127
< 		os.api('hashtags/list', {
< 			sort: '+mentionedLocalUsers',
< 			limit: 8,
< 		}).then(tags => {
< 			this.tags = tags;
< 		});
< 	},
---
>     os.api("hashtags/list", {
>       sort: "+mentionedLocalUsers",
>       limit: 8,
>     }).then((tags) => {
>       this.tags = tags;
>     });
>   },
111,116c129,139
< 	methods: {
< 		signin() {
< 			os.popup(XSigninDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>   methods: {
>     signin() {
>       os.popup(
>         XSigninDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
118,122c141,150
< 		signup() {
< 			os.popup(XSignupDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>     signup() {
>       os.popup(
>         XSignupDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
124,144c152,180
< 		showMenu(ev) {
< 			os.popupMenu([{
< 				text: this.$t('aboutX', { x: instanceName }),
< 				icon: 'ti ti-info-circle',
< 				action: () => {
< 					os.pageWindow('/about');
< 				},
< 			}, {
< 				text: this.$ts.aboutMisskey,
< 				icon: 'ti ti-info-circle',
< 				action: () => {
< 					os.pageWindow('/about-misskey');
< 				},
< 			}, null, {
< 				text: this.$ts.help,
< 				icon: 'ti ti-question-circle',
< 				action: () => {
< 					window.open(`https://misskey-hub.net/help.md`, '_blank');
< 				},
< 			}], ev.currentTarget ?? ev.target);
< 		},
---
>     showMenu(ev) {
>       os.popupMenu(
>         [
>           {
>             text: this.$t("aboutX", { x: instanceName }),
>             icon: "fas fa-info-circle",
>             action: () => {
>               os.pageWindow("/about");
>             },
>           },
>           {
>             text: this.$ts.aboutMisskey,
>             icon: "fas fa-info-circle",
>             action: () => {
>               os.pageWindow("/about-misskey");
>             },
>           },
>           null,
>           {
>             text: this.$ts.help,
>             icon: "fas fa-question-circle",
>             action: () => {
>               window.open(`https://misskey-hub.net/help.md`, "_blank");
>             },
>           },
>         ],
>         ev.currentTarget ?? ev.target
>       );
>     },
146,147c182,183
< 		number,
< 	},
---
>     number,
>   },
153,158c189,194
< 	> .top {
< 		display: flex;
< 		text-align: center;
< 		min-height: 100vh;
< 		box-sizing: border-box;
< 		padding: 16px;
---
>   > .top {
>     display: flex;
>     text-align: center;
>     min-height: 100vh;
>     box-sizing: border-box;
>     padding: 16px;
160,166c196,202
< 		> .bg {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 		}
---
>     > .bg {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>     }
168,175c204,211
< 		> .fade {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: rgba(0, 0, 0, 0.25);
< 		}
---
>     > .fade {
>       position: absolute;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: rgba(0, 0, 0, 0.25);
>     }
177,180c213,216
< 		> .emojis {
< 			position: absolute;
< 			bottom: 32px;
< 			left: 35px;
---
>     > .emojis {
>       position: absolute;
>       bottom: 32px;
>       left: 35px;
182,184c218,220
< 			> * {
< 				margin-right: 8px;
< 			}
---
>       > * {
>         margin-right: 8px;
>       }
186,189c222,225
< 			@media (max-width: 1200px) {
< 				display: none;
< 			}
< 		}
---
>       @media (max-width: 1200px) {
>         display: none;
>       }
>     }
191,194c227,230
< 		> .main {
< 			position: relative;
< 			width: min(460px, 100%);
< 			margin: auto;
---
>     > .main {
>       position: relative;
>       width: min(460px, 100%);
>       margin: auto;
196,198c232,234
< 			> .misskey {
< 				width: 150px;
< 				margin-bottom: 16px;
---
>       > .misskey {
>         width: 150px;
>         margin-bottom: 16px;
200,203c236,239
< 				@media (max-width: 450px) {
< 					width: 130px;
< 				}
< 			}
---
>         @media (max-width: 450px) {
>           width: 130px;
>         }
>       }
205,207c241,243
< 			> .form {
< 				position: relative;
< 				box-shadow: 0 12px 32px rgb(0 0 0 / 25%);
---
>       > .form {
>         position: relative;
>         box-shadow: 0 12px 32px rgb(0 0 0 / 25%);
209,217c245,253
< 				> .bg {
< 					position: absolute;
< 					top: 0;
< 					left: 0;
< 					width: 100%;
< 					height: 128px;
< 					background-position: center;
< 					background-size: cover;
< 					opacity: 0.75;
---
>         > .bg {
>           position: absolute;
>           top: 0;
>           left: 0;
>           width: 100%;
>           height: 128px;
>           background-position: center;
>           background-size: cover;
>           opacity: 0.75;
219,227c255,263
< 					> .fade {
< 						position: absolute;
< 						bottom: 0;
< 						left: 0;
< 						width: 100%;
< 						height: 128px;
< 						background: linear-gradient(0deg, var(--panel), var(--X15));
< 					}
< 				}
---
>           > .fade {
>             position: absolute;
>             bottom: 0;
>             left: 0;
>             width: 100%;
>             height: 128px;
>             background: linear-gradient(0deg, var(--panel), var(--X15));
>           }
>         }
229,231c265,267
< 				> .fg {
< 					position: relative;
< 					z-index: 1;
---
>         > .fg {
>           position: relative;
>           z-index: 1;
233,236c269,272
< 					> h1 {
< 						display: block;
< 						margin: 0;
< 						padding: 32px 32px 24px 32px;
---
>           > h1 {
>             display: block;
>             margin: 0;
>             padding: 32px 32px 24px 32px;
238,242c274,278
< 						> .logo {
< 							vertical-align: bottom;
< 							max-height: 120px;
< 						}
< 					}
---
>             > .logo {
>               vertical-align: bottom;
>               max-height: 120px;
>             }
>           }
244,246c280,282
< 					> .about {
< 						padding: 0 32px;
< 					}
---
>           > .about {
>             padding: 0 32px;
>           }
248,249c284,285
< 					> .action {
< 						padding: 32px;
---
>           > .action {
>             padding: 32px;
251,254c287,290
< 						> * {
< 							line-height: 28px;
< 						}
< 					}
---
>             > * {
>               line-height: 28px;
>             }
>           }
256,259c292,295
< 					> .status {
< 						border-top: solid 0.5px var(--divider);
< 						padding: 32px;
< 						font-size: 90%;
---
>           > .status {
>             border-top: solid 0.5px var(--divider);
>             padding: 32px;
>             font-size: 90%;
261,267c297,303
< 						> div {
< 							> span:not(:last-child) {
< 								padding-right: 1em;
< 								margin-right: 1em;
< 								border-right: solid 0.5px var(--divider);
< 							}
< 						}
---
>             > div {
>               > span:not(:last-child) {
>                 padding-right: 1em;
>                 margin-right: 1em;
>                 border-right: solid 0.5px var(--divider);
>               }
>             }
269,272c305,308
< 						> .online {
< 							::v-deep(b) {
< 								color: #41b781;
< 							}
---
>             > .online {
>               ::v-deep(b) {
>                 color: #41b781;
>               }
274,278c310,314
< 							::v-deep(span) {
< 								opacity: 0.7;
< 							}
< 						}
< 					}
---
>               ::v-deep(span) {
>                 opacity: 0.7;
>               }
>             }
>           }
280,289c316,325
< 					> .menu {
< 						position: absolute;
< 						top: 16px;
< 						right: 16px;
< 						width: 32px;
< 						height: 32px;
< 						border-radius: 8px;
< 					}
< 				}
< 			}
---
>           > .menu {
>             position: absolute;
>             top: 16px;
>             right: 16px;
>             width: 32px;
>             height: 32px;
>             border-radius: 8px;
>           }
>         }
>       }
291,297c327,333
< 			> .nav {
< 				position: relative;
< 				z-index: 2;
< 				margin-top: 20px;
< 				color: #fff;
< 				text-shadow: 0 0 8px black;
< 				font-size: 0.9em;
---
>       > .nav {
>         position: relative;
>         z-index: 2;
>         margin-top: 20px;
>         color: #fff;
>         text-shadow: 0 0 8px black;
>         font-size: 0.9em;
299,304c335,340
< 				> *:not(:last-child) {
< 					margin-right: 1.5em;
< 				}
< 			}
< 		}
< 	}
---
>         > *:not(:last-child) {
>           margin-right: 1.5em;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/pages/welcome.setup.vue RiricaV13/pages/welcome.setup.vue
2,21c2,34
< <form class="mk-setup" @submit.prevent="submit()">
< 	<h1>Welcome to Misskey!</h1>
< 	<div class="_gaps_m">
< 		<p>{{ $ts.intro }}</p>
< 		<MkInput v-model="username" pattern="^[a-zA-Z0-9_]{1,20}$" :spellcheck="false" required data-cy-admin-username>
< 			<template #label>{{ $ts.username }}</template>
< 			<template #prefix>@</template>
< 			<template #suffix>@{{ host }}</template>
< 		</MkInput>
< 		<MkInput v-model="password" type="password" data-cy-admin-password>
< 			<template #label>{{ $ts.password }}</template>
< 			<template #prefix><i class="ti ti-lock"></i></template>
< 		</MkInput>
< 		<div class="bottom">
< 			<MkButton gradate type="submit" :disabled="submitting" data-cy-admin-ok>
< 				{{ submitting ? $ts.processing : $ts.done }}<MkEllipsis v-if="submitting"/>
< 			</MkButton>
< 		</div>
< 	</div>
< </form>
---
>   <form class="mk-setup" @submit.prevent="submit()">
>     <h1>Welcome to Misskey!</h1>
>     <div class="_formRoot">
>       <p>{{ $ts.intro }}</p>
>       <MkInput
>         v-model="username"
>         pattern="^[a-zA-Z0-9_]{1,20}$"
>         :spellcheck="false"
>         required
>         data-cy-admin-username
>         class="_formBlock"
>       >
>         <template #label>{{ $ts.username }}</template>
>         <template #prefix>@</template>
>         <template #suffix>@{{ host }}</template>
>       </MkInput>
>       <MkInput
>         v-model="password"
>         type="password"
>         data-cy-admin-password
>         class="_formBlock"
>       >
>         <template #label>{{ $ts.password }}</template>
>         <template #prefix><i class="fas fa-lock"></i></template>
>       </MkInput>
>       <div class="bottom _formBlock">
>         <MkButton gradate type="submit" :disabled="submitting" data-cy-admin-ok>
>           {{ submitting ? $ts.processing : $ts.done
>           }}<MkEllipsis v-if="submitting" />
>         </MkButton>
>       </div>
>     </div>
>   </form>
25,31c38,44
< import { } from 'vue';
< import MkButton from '@/components/MkButton.vue';
< import MkInput from '@/components/MkInput.vue';
< import { host } from '@/config';
< import * as os from '@/os';
< import { login } from '@/account';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import MkButton from "@/components/MkButton.vue";
> import MkInput from "@/components/form/input.vue";
> import { host } from "@/config";
> import * as os from "@/os";
> import { login } from "@/account";
> import { i18n } from "@/i18n";
33,34c46,47
< let username = $ref('');
< let password = $ref('');
---
> let username = $ref("");
> let password = $ref("");
38,39c51,52
< 	if (submitting) return;
< 	submitting = true;
---
>   if (submitting) return;
>   submitting = true;
41,47c54,62
< 	os.api('admin/accounts/create', {
< 		username: username,
< 		password: password,
< 	}).then(res => {
< 		return login(res.token);
< 	}).catch(() => {
< 		submitting = false;
---
>   os.api("admin/accounts/create", {
>     username: username,
>     password: password,
>   })
>     .then((res) => {
>       return login(res.token);
>     })
>     .catch(() => {
>       submitting = false;
49,53c64,68
< 		os.alert({
< 			type: 'error',
< 			text: i18n.ts.somethingHappened,
< 		});
< 	});
---
>       os.alert({
>         type: "error",
>         text: i18n.ts.somethingHappened,
>       });
>     });
59,63c74,78
< 	border-radius: var(--radius);
< 	box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
< 	overflow: hidden;
< 	max-width: 500px;
< 	margin: 32px auto;
---
>   border-radius: var(--radius);
>   box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
>   overflow: hidden;
>   max-width: 500px;
>   margin: 32px auto;
65,72c80,87
< 	> h1 {
< 		margin: 0;
< 		font-size: 1.5em;
< 		text-align: center;
< 		padding: 32px;
< 		background: var(--accent);
< 		color: #fff;
< 	}
---
>   > h1 {
>     margin: 0;
>     font-size: 1.5em;
>     text-align: center;
>     padding: 32px;
>     background: var(--accent);
>     color: #fff;
>   }
74,76c89,91
< 	> div {
< 		padding: 32px;
< 		background: var(--panel);
---
>   > div {
>     padding: 32px;
>     background: var(--panel);
78,80c93,95
< 		> p {
< 			margin-top: 0;
< 		}
---
>     > p {
>       margin-top: 0;
>     }
82,87c97,102
< 		> .bottom {
< 			> * {
< 				margin: 0 auto;
< 			}
< 		}
< 	}
---
>     > .bottom {
>       > * {
>         margin: 0 auto;
>       }
>     }
>   }
Only in misskeyV13/packages/frontend/src/pages: welcome.timeline.vue
diff --color=auto -r misskeyV13/packages/frontend/src/pages/welcome.vue RiricaV13/pages/welcome.vue
2,4c2,3
< <div v-if="meta">
< 	<XSetup v-if="meta.requireSetup"/>
< 	<XEntrance v-else/>
---
> <div>
> 	<XEntrance/>
9,14c8
< import { computed } from 'vue';
< import XSetup from './welcome.setup.vue';
< import XEntrance from './welcome.entrance.a.vue';
< import { instanceName } from '@/config';
< import * as os from '@/os';
< import { definePageMetadata } from '@/scripts/page-metadata';
---
> import XEntrance from "./welcome.entrance.a.vue";
16d9
< let meta = $ref(null);
18,29d10
< os.api('meta', { detail: true }).then(res => {
< 	meta = res;
< });
< 
< const headerActions = $computed(() => []);
< 
< const headerTabs = $computed(() => []);
< 
< definePageMetadata(computed(() => ({
< 	title: instanceName,
< 	icon: null,
< })));
diff --color=auto -r misskeyV13/packages/frontend/src/pizzax.ts RiricaV13/pizzax.ts
3,6c3,6
< import { onUnmounted, Ref, ref, watch } from 'vue';
< import { $i } from './account';
< import { api } from './os';
< import { stream } from './stream';
---
> import { onUnmounted, Ref, ref, watch } from "vue";
> import { $i } from "./account";
> import { api } from "./os";
> import { stream } from "./stream";
8,11c8,14
< type StateDef = Record<string, {
< 	where: 'account' | 'device' | 'deviceAccount';
< 	default: any;
< }>;
---
> type StateDef = Record<
>   string,
>   {
>     where: "account" | "device" | "deviceAccount";
>     default: any;
>   }
> >;
15c18
< const connection = $i && stream.useChannel('main');
---
> const connection = $i && stream.useChannel("main");
18,19c21,22
< 	public readonly key: string;
< 	public readonly keyForLocalStorage: string;
---
>   public readonly key: string;
>   public readonly keyForLocalStorage: string;
21c24
< 	public readonly def: T;
---
>   public readonly def: T;
23,27c26,28
< 	// TODO: これが実装されたらreadonlyにしたい: https://github.com/microsoft/TypeScript/issues/37487
< 	public readonly state: { [K in keyof T]: T[K]['default'] };
< 	public readonly reactiveState: { [K in keyof T]: Ref<T[K]['default']> };
< 	public readonly ready: Promise<void>;
< 	private markAsReady: () => void = () => {};
---
>   // TODO: これが実装されたらreadonlyにしたい: https://github.com/microsoft/TypeScript/issues/37487
>   public readonly state: { [K in keyof T]: T[K]["default"] };
>   public readonly reactiveState: { [K in keyof T]: Ref<T[K]["default"]> };
29,35c30,33
< 	constructor(key: string, def: T) {
< 		this.ready = new Promise((res) => {
< 			this.markAsReady = res;
< 		});
< 		this.key = key;
< 		this.keyForLocalStorage = 'pizzax::' + key;
< 		this.def = def;
---
>   constructor(key: string, def: T) {
>     this.key = key;
>     this.keyForLocalStorage = "pizzax::" + key;
>     this.def = def;
37,40c35,49
< 		// TODO: indexedDBにする
< 		const deviceState = JSON.parse(localStorage.getItem(this.keyForLocalStorage) || '{}');
< 		const deviceAccountState = $i ? JSON.parse(localStorage.getItem(this.keyForLocalStorage + '::' + $i.id) || '{}') : {};
< 		const registryCache = $i ? JSON.parse(localStorage.getItem(this.keyForLocalStorage + '::cache::' + $i.id) || '{}') : {};
---
>     // TODO: indexedDBにする
>     const deviceState = JSON.parse(
>       localStorage.getItem(this.keyForLocalStorage) || "{}"
>     );
>     const deviceAccountState = $i
>       ? JSON.parse(
>           localStorage.getItem(this.keyForLocalStorage + "::" + $i.id) || "{}"
>         )
>       : {};
>     const registryCache = $i
>       ? JSON.parse(
>           localStorage.getItem(this.keyForLocalStorage + "::cache::" + $i.id) ||
>             "{}"
>         )
>       : {};
42,85c51,79
< 		const state = {};
< 		const reactiveState = {};
< 		for (const [k, v] of Object.entries(def)) {
< 			if (v.where === 'device' && Object.prototype.hasOwnProperty.call(deviceState, k)) {
< 				state[k] = deviceState[k];
< 			} else if (v.where === 'account' && $i && Object.prototype.hasOwnProperty.call(registryCache, k)) {
< 				state[k] = registryCache[k];
< 			} else if (v.where === 'deviceAccount' && Object.prototype.hasOwnProperty.call(deviceAccountState, k)) {
< 				state[k] = deviceAccountState[k];
< 			} else {
< 				state[k] = v.default;
< 				if (_DEV_) console.log('Use default value', k, v.default);
< 			}
< 		}
< 		for (const [k, v] of Object.entries(state)) {
< 			reactiveState[k] = ref(v);
< 		}
< 		this.state = state as any;
< 		this.reactiveState = reactiveState as any;
< 	
< 		if ($i) {
< 			// なぜかsetTimeoutしないとapi関数内でエラーになる(おそらく循環参照してることに原因がありそう)
< 			window.setTimeout(() => {
< 				api('i/registry/get-all', { scope: ['client', this.key] }).then(kvs => {
< 					const cache = {};
< 					for (const [k, v] of Object.entries(def)) {
< 						if (v.where === 'account') {
< 							if (Object.prototype.hasOwnProperty.call(kvs, k)) {
< 								state[k] = kvs[k];
< 								reactiveState[k].value = kvs[k];
< 								cache[k] = kvs[k];
< 							} else {
< 								state[k] = v.default;
< 								reactiveState[k].value = v.default;
< 							}
< 						}
< 					}
< 					localStorage.setItem(this.keyForLocalStorage + '::cache::' + $i.id, JSON.stringify(cache));
< 					this.markAsReady();
< 				});
< 			}, 1);
< 			// streamingのuser storage updateイベントを監視して更新
< 			connection?.on('registryUpdated', ({ scope, key, value }: { scope: string[], key: keyof T, value: T[typeof key]['default'] }) => {
< 				if (scope.length !== 2 || scope[0] !== 'client' || scope[1] !== this.key || this.state[key] === value) return;
---
>     const state = {};
>     const reactiveState = {};
>     for (const [k, v] of Object.entries(def)) {
>       if (
>         v.where === "device" &&
>         Object.prototype.hasOwnProperty.call(deviceState, k)
>       ) {
>         state[k] = deviceState[k];
>       } else if (
>         v.where === "account" &&
>         $i &&
>         Object.prototype.hasOwnProperty.call(registryCache, k)
>       ) {
>         state[k] = registryCache[k];
>       } else if (
>         v.where === "deviceAccount" &&
>         Object.prototype.hasOwnProperty.call(deviceAccountState, k)
>       ) {
>         state[k] = deviceAccountState[k];
>       } else {
>         state[k] = v.default;
>         if (_DEV_) console.log("Use default value", k, v.default);
>       }
>     }
>     for (const [k, v] of Object.entries(state)) {
>       reactiveState[k] = ref(v);
>     }
>     this.state = state as any;
>     this.reactiveState = reactiveState as any;
87,88c81,99
< 				this.state[key] = value;
< 				this.reactiveState[key].value = value;
---
>     if ($i) {
>       connection?.on(
>         "registryUpdated",
>         ({
>           scope,
>           key,
>           value,
>         }: {
>           scope: string[];
>           key: keyof T;
>           value: T[typeof key]["default"];
>         }) => {
>           if (
>             scope.length !== 2 ||
>             scope[0] !== "client" ||
>             scope[1] !== this.key ||
>             this.state[key] === value
>           )
>             return;
90,99c101,102
< 				const cache = JSON.parse(localStorage.getItem(this.keyForLocalStorage + '::cache::' + $i.id) || '{}');
< 				if (cache[key] !== value) {
< 					cache[key] = value;
< 					localStorage.setItem(this.keyForLocalStorage + '::cache::' + $i.id, JSON.stringify(cache));
< 				}
< 			});
< 		} else {
< 			this.markAsReady();
< 		}
< 	}
---
>           this.state[key] = value;
>           this.reactiveState[key].value = value;
101,102c104,119
< 	public set<K extends keyof T>(key: K, value: T[K]['default']): void {
< 		if (_DEV_) console.log('set', key, value);
---
>           const cache = JSON.parse(
>             localStorage.getItem(
>               this.keyForLocalStorage + "::cache::" + $i.id
>             ) || "{}"
>           );
>           if (cache[key] !== value) {
>             cache[key] = value;
>             localStorage.setItem(
>               this.keyForLocalStorage + "::cache::" + $i.id,
>               JSON.stringify(cache)
>             );
>           }
>         }
>       );
>     }
>   }
104,105c121,122
< 		this.state[key] = value;
< 		this.reactiveState[key].value = value;
---
>   public set<K extends keyof T>(key: K, value: T[K]["default"]): void {
>     if (_DEV_) console.log("set", key, value);
107,134c124,125
< 		switch (this.def[key].where) {
< 			case 'device': {
< 				const deviceState = JSON.parse(localStorage.getItem(this.keyForLocalStorage) || '{}');
< 				deviceState[key] = value;
< 				localStorage.setItem(this.keyForLocalStorage, JSON.stringify(deviceState));
< 				break;
< 			}
< 			case 'deviceAccount': {
< 				if ($i == null) break;
< 				const deviceAccountState = JSON.parse(localStorage.getItem(this.keyForLocalStorage + '::' + $i.id) || '{}');
< 				deviceAccountState[key] = value;
< 				localStorage.setItem(this.keyForLocalStorage + '::' + $i.id, JSON.stringify(deviceAccountState));
< 				break;
< 			}
< 			case 'account': {
< 				if ($i == null) break;
< 				const cache = JSON.parse(localStorage.getItem(this.keyForLocalStorage + '::cache::' + $i.id) || '{}');
< 				cache[key] = value;
< 				localStorage.setItem(this.keyForLocalStorage + '::cache::' + $i.id, JSON.stringify(cache));
< 				api('i/registry/set', {
< 					scope: ['client', this.key],
< 					key: key,
< 					value: value,
< 				});
< 				break;
< 			}
< 		}
< 	}
---
>     this.state[key] = value;
>     this.reactiveState[key].value = value;
136,139c127,165
< 	public push<K extends keyof T>(key: K, value: ArrayElement<T[K]['default']>): void {
< 		const currentState = this.state[key];
< 		this.set(key, [...currentState, value]);
< 	}
---
>     switch (this.def[key].where) {
>       case "device": {
>         const deviceState = JSON.parse(
>           localStorage.getItem(this.keyForLocalStorage) || "{}"
>         );
>         deviceState[key] = value;
>         localStorage.setItem(
>           this.keyForLocalStorage,
>           JSON.stringify(deviceState)
>         );
>         break;
>       }
>       case "deviceAccount": {
>         if ($i == null) break;
>         const deviceAccountState = JSON.parse(
>           localStorage.getItem(this.keyForLocalStorage + "::" + $i.id) || "{}"
>         );
>         deviceAccountState[key] = value;
>         localStorage.setItem(
>           this.keyForLocalStorage + "::" + $i.id,
>           JSON.stringify(deviceAccountState)
>         );
>         break;
>       }
>       case "account": {
>         if ($i == null) break;
>         const cache = JSON.parse(
>           localStorage.getItem(this.keyForLocalStorage + "::cache::" + $i.id) ||
>             "{}"
>         );
>         cache[key] = value;
>         localStorage.setItem(
>           this.keyForLocalStorage + "::cache::" + $i.id,
>           JSON.stringify(cache)
>         );
>         break;
>       }
>     }
>   }
141,143c167,173
< 	public reset(key: keyof T) {
< 		this.set(key, this.def[key].default);
< 	}
---
>   public push<K extends keyof T>(
>     key: K,
>     value: ArrayElement<T[K]["default"]>
>   ): void {
>     const currentState = this.state[key];
>     this.set(key, [...currentState, value]);
>   }
145,150c175,177
< 	/**
< 	 * 特定のキーの、簡易的なgetter/setterを作ります
< 	 * 主にvue場で設定コントロールのmodelとして使う用
< 	 */
< 	public makeGetterSetter<K extends keyof T>(key: K, getter?: (v: T[K]) => unknown, setter?: (v: unknown) => T[K]) {
< 		const valueRef = ref(this.state[key]);
---
>   public reset(key: keyof T) {
>     this.set(key, this.def[key].default);
>   }
152,154c179,188
< 		const stop = watch(this.reactiveState[key], val => {
< 			valueRef.value = val;
< 		});
---
>   /**
>    * 特定のキーの、簡易的なgetter/setterを作ります
>    * 主にvue場で設定コントロールのmodelとして使う用
>    */
>   public makeGetterSetter<K extends keyof T>(
>     key: K,
>     getter?: (v: T[K]) => unknown,
>     setter?: (v: unknown) => T[K]
>   ) {
>     const valueRef = ref(this.state[key]);
156,159c190,192
< 		// NOTE: vueコンポーネント内で呼ばれない限りは、onUnmounted は無意味なのでメモリリークする
< 		onUnmounted(() => {
< 			stop();
< 		});
---
>     const stop = watch(this.reactiveState[key], (val) => {
>       valueRef.value = val;
>     });
161,176c194,214
< 		// TODO: VueのcustomRef使うと良い感じになるかも
< 		return {
< 			get: () => {
< 				if (getter) {
< 					return getter(valueRef.value);
< 				} else {
< 					return valueRef.value;
< 				}
< 			},
< 			set: (value: unknown) => {
< 				const val = setter ? setter(value) : value;
< 				this.set(key, val);
< 				valueRef.value = val;
< 			},
< 		};
< 	}
---
>     // NOTE: vueコンポーネント内で呼ばれない限りは、onUnmounted は無意味なのでメモリリークする
>     onUnmounted(() => {
>       stop();
>     });
> 
>     // TODO: VueのcustomRef使うと良い感じになるかも
>     return {
>       get: () => {
>         if (getter) {
>           return getter(valueRef.value);
>         } else {
>           return valueRef.value;
>         }
>       },
>       set: (value: unknown) => {
>         const val = setter ? setter(value) : value;
>         this.set(key, val);
>         valueRef.value = val;
>       },
>     };
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/plugin.ts RiricaV13/plugin.ts
1,4c1,12
< import { Interpreter, Parser, utils, values } from '@syuilo/aiscript';
< import { createAiScriptEnv } from '@/scripts/aiscript/api';
< import { inputText } from '@/os';
< import { noteActions, notePostInterruptors, noteViewInterruptors, postFormActions, userActions } from '@/store';
---
> import { AiScript, utils, values } from "@syuilo/aiscript";
> import { deserialize } from "@syuilo/aiscript/built/serializer";
> import { jsToVal } from "@syuilo/aiscript/built/interpreter/util";
> import { createAiScriptEnv } from "@/scripts/aiscript/api";
> import { inputText } from "@/os";
> import {
>   noteActions,
>   notePostInterruptors,
>   noteViewInterruptors,
>   postFormActions,
>   userActions,
> } from "@/store";
6,7c14
< const parser = new Parser();
< const pluginContexts = new Map<string, Interpreter>();
---
> const pluginContexts = new Map<string, AiScript>();
10,12c17
< 	// 後方互換性のため
< 	if (plugin.src == null) return;
< 	console.info('Plugin installed:', plugin.name, 'v' + plugin.version);
---
>   console.info("Plugin installed:", plugin.name, "v" + plugin.version);
14,32c19,39
< 	const aiscript = new Interpreter(createPluginEnv({
< 		plugin: plugin,
< 		storageKey: 'plugins:' + plugin.id,
< 	}), {
< 		in: (q) => {
< 			return new Promise(ok => {
< 				inputText({
< 					title: q,
< 				}).then(({ canceled, result: a }) => {
< 					ok(a);
< 				});
< 			});
< 		},
< 		out: (value) => {
< 			console.log(value);
< 		},
< 		log: (type, params) => {
< 		},
< 	});
---
>   const aiscript = new AiScript(
>     createPluginEnv({
>       plugin: plugin,
>       storageKey: "plugins:" + plugin.id,
>     }),
>     {
>       in: (q) => {
>         return new Promise((ok) => {
>           inputText({
>             title: q,
>           }).then(({ canceled, result: a }) => {
>             ok(a);
>           });
>         });
>       },
>       out: (value) => {
>         console.log(value);
>       },
>       log: (type, params) => {},
>     }
>   );
34c41
< 	initPlugin({ plugin, aiscript });
---
>   initPlugin({ plugin, aiscript });
36c43
< 	aiscript.exec(parser.parse(plugin.src));
---
>   aiscript.exec(deserialize(plugin.ast));
40,43c47,57
< 	const config = new Map();
< 	for (const [k, v] of Object.entries(opts.plugin.config || {})) {
< 		config.set(k, utils.jsToVal(typeof opts.plugin.configData[k] !== 'undefined' ? opts.plugin.configData[k] : v.default));
< 	}
---
>   const config = new Map();
>   for (const [k, v] of Object.entries(opts.plugin.config || {})) {
>     config.set(
>       k,
>       jsToVal(
>         typeof opts.plugin.configData[k] !== "undefined"
>           ? opts.plugin.configData[k]
>           : v.default
>       )
>     );
>   }
45,77c59,115
< 	return {
< 		...createAiScriptEnv({ ...opts, token: opts.plugin.token }),
< 		//#region Deprecated
< 		'Mk:register_post_form_action': values.FN_NATIVE(([title, handler]) => {
< 			registerPostFormAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		'Mk:register_user_action': values.FN_NATIVE(([title, handler]) => {
< 			registerUserAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		'Mk:register_note_action': values.FN_NATIVE(([title, handler]) => {
< 			registerNoteAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		//#endregion
< 		'Plugin:register_post_form_action': values.FN_NATIVE(([title, handler]) => {
< 			registerPostFormAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		'Plugin:register_user_action': values.FN_NATIVE(([title, handler]) => {
< 			registerUserAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		'Plugin:register_note_action': values.FN_NATIVE(([title, handler]) => {
< 			registerNoteAction({ pluginId: opts.plugin.id, title: title.value, handler });
< 		}),
< 		'Plugin:register_note_view_interruptor': values.FN_NATIVE(([handler]) => {
< 			registerNoteViewInterruptor({ pluginId: opts.plugin.id, handler });
< 		}),
< 		'Plugin:register_note_post_interruptor': values.FN_NATIVE(([handler]) => {
< 			registerNotePostInterruptor({ pluginId: opts.plugin.id, handler });
< 		}),
< 		'Plugin:open_url': values.FN_NATIVE(([url]) => {
< 			window.open(url.value, '_blank');
< 		}),
< 		'Plugin:config': values.OBJ(config),
< 	};
---
>   return {
>     ...createAiScriptEnv({ ...opts, token: opts.plugin.token }),
>     //#region Deprecated
>     "Mk:register_post_form_action": values.FN_NATIVE(([title, handler]) => {
>       registerPostFormAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     "Mk:register_user_action": values.FN_NATIVE(([title, handler]) => {
>       registerUserAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     "Mk:register_note_action": values.FN_NATIVE(([title, handler]) => {
>       registerNoteAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     //#endregion
>     "Plugin:register_post_form_action": values.FN_NATIVE(([title, handler]) => {
>       registerPostFormAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     "Plugin:register_user_action": values.FN_NATIVE(([title, handler]) => {
>       registerUserAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     "Plugin:register_note_action": values.FN_NATIVE(([title, handler]) => {
>       registerNoteAction({
>         pluginId: opts.plugin.id,
>         title: title.value,
>         handler,
>       });
>     }),
>     "Plugin:register_note_view_interruptor": values.FN_NATIVE(([handler]) => {
>       registerNoteViewInterruptor({ pluginId: opts.plugin.id, handler });
>     }),
>     "Plugin:register_note_post_interruptor": values.FN_NATIVE(([handler]) => {
>       registerNotePostInterruptor({ pluginId: opts.plugin.id, handler });
>     }),
>     "Plugin:open_url": values.FN_NATIVE(([url]) => {
>       window.open(url.value, "_blank");
>     }),
>     "Plugin:config": values.OBJ(config),
>   };
81c119
< 	pluginContexts.set(plugin.id, aiscript);
---
>   pluginContexts.set(plugin.id, aiscript);
85,91c123,133
< 	postFormActions.push({
< 		title, handler: (form, update) => {
< 			pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(form), values.FN_NATIVE(([key, value]) => {
< 				update(key.value, value.value);
< 			})]);
< 		},
< 	});
---
>   postFormActions.push({
>     title,
>     handler: (form, update) => {
>       pluginContexts.get(pluginId).execFn(handler, [
>         utils.jsToVal(form),
>         values.FN_NATIVE(([key, value]) => {
>           update(key.value, value.value);
>         }),
>       ]);
>     },
>   });
95,99c137,142
< 	userActions.push({
< 		title, handler: (user) => {
< 			pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(user)]);
< 		},
< 	});
---
>   userActions.push({
>     title,
>     handler: (user) => {
>       pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(user)]);
>     },
>   });
103,107c146,151
< 	noteActions.push({
< 		title, handler: (note) => {
< 			pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(note)]);
< 		},
< 	});
---
>   noteActions.push({
>     title,
>     handler: (note) => {
>       pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(note)]);
>     },
>   });
111,115c155,163
< 	noteViewInterruptors.push({
< 		handler: async (note) => {
< 			return utils.valToJs(await pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(note)]));
< 		},
< 	});
---
>   noteViewInterruptors.push({
>     handler: async (note) => {
>       return utils.valToJs(
>         await pluginContexts
>           .get(pluginId)
>           .execFn(handler, [utils.jsToVal(note)])
>       );
>     },
>   });
119,123c167,175
< 	notePostInterruptors.push({
< 		handler: async (note) => {
< 			return utils.valToJs(await pluginContexts.get(pluginId).execFn(handler, [utils.jsToVal(note)]));
< 		},
< 	});
---
>   notePostInterruptors.push({
>     handler: async (note) => {
>       return utils.valToJs(
>         await pluginContexts
>           .get(pluginId)
>           .execFn(handler, [utils.jsToVal(note)])
>       );
>     },
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/router.ts RiricaV13/router.ts
1,6c1,6
< import { AsyncComponentLoader, defineAsyncComponent, inject } from 'vue';
< import { Router } from '@/nirax';
< import { $i, iAmModerator } from '@/account';
< import MkLoading from '@/pages/_loading_.vue';
< import MkError from '@/pages/_error_.vue';
< import { ui } from '@/config';
---
> import { AsyncComponentLoader, defineAsyncComponent, inject } from "vue";
> import { Router } from "@/nirax";
> import { $i, iAmModerator } from "@/account";
> import MkLoading from "@/pages/_loading_.vue";
> import MkError from "@/pages/_error_.vue";
> import { ui } from "@/config";
8,12c8,13
< const page = (loader: AsyncComponentLoader<any>) => defineAsyncComponent({
< 	loader: loader,
< 	loadingComponent: MkLoading,
< 	errorComponent: MkError,
< });
---
> const page = (loader: AsyncComponentLoader<any>) =>
>   defineAsyncComponent({
>     loader: loader,
>     loadingComponent: MkLoading,
>     errorComponent: MkError,
>   });
14,503c15,583
< export const routes = [{
< 	path: '/@:initUser/pages/:initPageName/view-source',
< 	component: page(() => import('./pages/page-editor/page-editor.vue')),
< }, {
< 	path: '/@:username/pages/:pageName',
< 	component: page(() => import('./pages/page.vue')),
< }, {
< 	path: '/@:acct/following',
< 	component: page(() => import('./pages/user/following.vue')),
< }, {
< 	path: '/@:acct/followers',
< 	component: page(() => import('./pages/user/followers.vue')),
< }, {
< 	name: 'user',
< 	path: '/@:acct/:page?',
< 	component: page(() => import('./pages/user/index.vue')),
< }, {
< 	name: 'note',
< 	path: '/notes/:noteId',
< 	component: page(() => import('./pages/note.vue')),
< }, {
< 	path: '/clips/:clipId',
< 	component: page(() => import('./pages/clip.vue')),
< }, {
< 	path: '/user-info/:userId',
< 	component: page(() => import('./pages/user-info.vue')),
< 	hash: 'initialTab',
< }, {
< 	path: '/instance-info/:host',
< 	component: page(() => import('./pages/instance-info.vue')),
< }, {
< 	name: 'settings',
< 	path: '/settings',
< 	component: page(() => import('./pages/settings/index.vue')),
< 	loginRequired: true,
< 	children: [{
< 		path: '/profile',
< 		name: 'profile',
< 		component: page(() => import('./pages/settings/profile.vue')),
< 	}, {
< 		path: '/privacy',
< 		name: 'privacy',
< 		component: page(() => import('./pages/settings/privacy.vue')),
< 	}, {
< 		path: '/reaction',
< 		name: 'reaction',
< 		component: page(() => import('./pages/settings/reaction.vue')),
< 	}, {
< 		path: '/drive',
< 		name: 'drive',
< 		component: page(() => import('./pages/settings/drive.vue')),
< 	}, {
< 		path: '/notifications',
< 		name: 'notifications',
< 		component: page(() => import('./pages/settings/notifications.vue')),
< 	}, {
< 		path: '/email',
< 		name: 'email',
< 		component: page(() => import('./pages/settings/email.vue')),
< 	}, {
< 		path: '/integration',
< 		name: 'integration',
< 		component: page(() => import('./pages/settings/integration.vue')),
< 	}, {
< 		path: '/security',
< 		name: 'security',
< 		component: page(() => import('./pages/settings/security.vue')),
< 	}, {
< 		path: '/general',
< 		name: 'general',
< 		component: page(() => import('./pages/settings/general.vue')),
< 	}, {
< 		path: '/theme/install',
< 		name: 'theme',
< 		component: page(() => import('./pages/settings/theme.install.vue')),
< 	}, {
< 		path: '/theme/manage',
< 		name: 'theme',
< 		component: page(() => import('./pages/settings/theme.manage.vue')),
< 	}, {
< 		path: '/theme',
< 		name: 'theme',
< 		component: page(() => import('./pages/settings/theme.vue')),
< 	}, {
< 		path: '/navbar',
< 		name: 'navbar',
< 		component: page(() => import('./pages/settings/navbar.vue')),
< 	}, {
< 		path: '/statusbar',
< 		name: 'statusbar',
< 		component: page(() => import('./pages/settings/statusbar.vue')),
< 	}, {
< 		path: '/sounds',
< 		name: 'sounds',
< 		component: page(() => import('./pages/settings/sounds.vue')),
< 	}, {
< 		path: '/plugin/install',
< 		name: 'plugin',
< 		component: page(() => import('./pages/settings/plugin.install.vue')),
< 	}, {
< 		path: '/plugin',
< 		name: 'plugin',
< 		component: page(() => import('./pages/settings/plugin.vue')),
< 	}, {
< 		path: '/import-export',
< 		name: 'import-export',
< 		component: page(() => import('./pages/settings/import-export.vue')),
< 	}, {
< 		path: '/instance-mute',
< 		name: 'instance-mute',
< 		component: page(() => import('./pages/settings/instance-mute.vue')),
< 	}, {
< 		path: '/mute-block',
< 		name: 'mute-block',
< 		component: page(() => import('./pages/settings/mute-block.vue')),
< 	}, {
< 		path: '/word-mute',
< 		name: 'word-mute',
< 		component: page(() => import('./pages/settings/word-mute.vue')),
< 	}, {
< 		path: '/api',
< 		name: 'api',
< 		component: page(() => import('./pages/settings/api.vue')),
< 	}, {
< 		path: '/apps',
< 		name: 'api',
< 		component: page(() => import('./pages/settings/apps.vue')),
< 	}, {
< 		path: '/webhook/edit/:webhookId',
< 		name: 'webhook',
< 		component: page(() => import('./pages/settings/webhook.edit.vue')),
< 	}, {
< 		path: '/webhook/new',
< 		name: 'webhook',
< 		component: page(() => import('./pages/settings/webhook.new.vue')),
< 	}, {
< 		path: '/webhook',
< 		name: 'webhook',
< 		component: page(() => import('./pages/settings/webhook.vue')),
< 	}, {
< 		path: '/deck',
< 		name: 'deck',
< 		component: page(() => import('./pages/settings/deck.vue')),
< 	}, {
< 		path: '/preferences-backups',
< 		name: 'preferences-backups',
< 		component: page(() => import('./pages/settings/preferences-backups.vue')),
< 	}, {
< 		path: '/custom-css',
< 		name: 'general',
< 		component: page(() => import('./pages/settings/custom-css.vue')),
< 	}, {
< 		path: '/accounts',
< 		name: 'profile',
< 		component: page(() => import('./pages/settings/accounts.vue')),
< 	}, {
< 		path: '/account-info',
< 		name: 'other',
< 		component: page(() => import('./pages/settings/account-info.vue')),
< 	}, {
< 		path: '/delete-account',
< 		name: 'other',
< 		component: page(() => import('./pages/settings/delete-account.vue')),
< 	}, {
< 		path: '/other',
< 		name: 'other',
< 		component: page(() => import('./pages/settings/other.vue')),
< 	}, {
< 		path: '/',
< 		component: page(() => import('./pages/_empty_.vue')),
< 	}],
< }, {
< 	path: '/reset-password/:token?',
< 	component: page(() => import('./pages/reset-password.vue')),
< }, {
< 	path: '/signup-complete/:code',
< 	component: page(() => import('./pages/signup-complete.vue')),
< }, {
< 	path: '/announcements',
< 	component: page(() => import('./pages/announcements.vue')),
< }, {
< 	path: '/about',
< 	component: page(() => import('./pages/about.vue')),
< 	hash: 'initialTab',
< }, {
< 	path: '/about-misskey',
< 	component: page(() => import('./pages/about-misskey.vue')),
< }, {
< 	path: '/theme-editor',
< 	component: page(() => import('./pages/theme-editor.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/explore/tags/:tag',
< 	component: page(() => import('./pages/explore.vue')),
< }, {
< 	path: '/explore',
< 	component: page(() => import('./pages/explore.vue')),
< 	hash: 'initialTab',
< }, {
< 	path: '/search',
< 	component: page(() => import('./pages/search.vue')),
< 	query: {
< 		q: 'query',
< 		channel: 'channel',
< 	},
< }, {
< 	path: '/authorize-follow',
< 	component: page(() => import('./pages/follow.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/share',
< 	component: page(() => import('./pages/share.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/api-console',
< 	component: page(() => import('./pages/api-console.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/mfm-cheat-sheet',
< 	component: page(() => import('./pages/mfm-cheat-sheet.vue')),
< }, {
< 	path: '/scratchpad',
< 	component: page(() => import('./pages/scratchpad.vue')),
< }, {
< 	path: '/preview',
< 	component: page(() => import('./pages/preview.vue')),
< }, {
< 	path: '/auth/:token',
< 	component: page(() => import('./pages/auth.vue')),
< }, {
< 	path: '/miauth/:session',
< 	component: page(() => import('./pages/miauth.vue')),
< 	query: {
< 		callback: 'callback',
< 		name: 'name',
< 		icon: 'icon',
< 		permission: 'permission',
< 	},
< }, {
< 	path: '/tags/:tag',
< 	component: page(() => import('./pages/tag.vue')),
< }, {
< 	path: '/pages/new',
< 	component: page(() => import('./pages/page-editor/page-editor.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/pages/edit/:initPageId',
< 	component: page(() => import('./pages/page-editor/page-editor.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/pages',
< 	component: page(() => import('./pages/pages.vue')),
< }, {
< 	path: '/play/:id/edit',
< 	component: page(() => import('./pages/flash/flash-edit.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/play/new',
< 	component: page(() => import('./pages/flash/flash-edit.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/play/:id',
< 	component: page(() => import('./pages/flash/flash.vue')),
< }, {
< 	path: '/play',
< 	component: page(() => import('./pages/flash/flash-index.vue')),
< }, {
< 	path: '/gallery/:postId/edit',
< 	component: page(() => import('./pages/gallery/edit.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/gallery/new',
< 	component: page(() => import('./pages/gallery/edit.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/gallery/:postId',
< 	component: page(() => import('./pages/gallery/post.vue')),
< }, {
< 	path: '/gallery',
< 	component: page(() => import('./pages/gallery/index.vue')),
< }, {
< 	path: '/channels/:channelId/edit',
< 	component: page(() => import('./pages/channel-editor.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/channels/new',
< 	component: page(() => import('./pages/channel-editor.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/channels/:channelId',
< 	component: page(() => import('./pages/channel.vue')),
< }, {
< 	path: '/channels',
< 	component: page(() => import('./pages/channels.vue')),
< }, {
< 	path: '/custom-emojis-manager',
< 	component: page(() => import('./pages/custom-emojis-manager.vue')),
< }, {
< 	path: '/registry/keys/system/:path(*)?',
< 	component: page(() => import('./pages/registry.keys.vue')),
< }, {
< 	path: '/registry/value/system/:path(*)?',
< 	component: page(() => import('./pages/registry.value.vue')),
< }, {
< 	path: '/registry',
< 	component: page(() => import('./pages/registry.vue')),
< }, {
< 	path: '/admin/file/:fileId',
< 	component: iAmModerator ? page(() => import('./pages/admin-file.vue')) : page(() => import('./pages/not-found.vue')),
< }, {
< 	path: '/admin',
< 	component: iAmModerator ? page(() => import('./pages/admin/index.vue')) : page(() => import('./pages/not-found.vue')),
< 	children: [{
< 		path: '/overview',
< 		name: 'overview',
< 		component: page(() => import('./pages/admin/overview.vue')),
< 	}, {
< 		path: '/users',
< 		name: 'users',
< 		component: page(() => import('./pages/admin/users.vue')),
< 	}, {
< 		path: '/emojis',
< 		name: 'emojis',
< 		component: page(() => import('./pages/custom-emojis-manager.vue')),
< 	}, {
< 		path: '/queue',
< 		name: 'queue',
< 		component: page(() => import('./pages/admin/queue.vue')),
< 	}, {
< 		path: '/files',
< 		name: 'files',
< 		component: page(() => import('./pages/admin/files.vue')),
< 	}, {
< 		path: '/federation',
< 		name: 'federation',
< 		component: page(() => import('./pages/admin/federation.vue')),
< 	}, {
< 		path: '/announcements',
< 		name: 'announcements',
< 		component: page(() => import('./pages/admin/announcements.vue')),
< 	}, {
< 		path: '/ads',
< 		name: 'ads',
< 		component: page(() => import('./pages/admin/ads.vue')),
< 	}, {
< 		path: '/roles/:id/edit',
< 		name: 'roles',
< 		component: page(() => import('./pages/admin/roles.edit.vue')),
< 	}, {
< 		path: '/roles/new',
< 		name: 'roles',
< 		component: page(() => import('./pages/admin/roles.edit.vue')),
< 	}, {
< 		path: '/roles/:id',
< 		name: 'roles',
< 		component: page(() => import('./pages/admin/roles.role.vue')),
< 	}, {
< 		path: '/roles',
< 		name: 'roles',
< 		component: page(() => import('./pages/admin/roles.vue')),
< 	}, {
< 		path: '/database',
< 		name: 'database',
< 		component: page(() => import('./pages/admin/database.vue')),
< 	}, {
< 		path: '/abuses',
< 		name: 'abuses',
< 		component: page(() => import('./pages/admin/abuses.vue')),
< 	}, {
< 		path: '/settings',
< 		name: 'settings',
< 		component: page(() => import('./pages/admin/settings.vue')),
< 	}, {
< 		path: '/email-settings',
< 		name: 'email-settings',
< 		component: page(() => import('./pages/admin/email-settings.vue')),
< 	}, {
< 		path: '/object-storage',
< 		name: 'object-storage',
< 		component: page(() => import('./pages/admin/object-storage.vue')),
< 	}, {
< 		path: '/security',
< 		name: 'security',
< 		component: page(() => import('./pages/admin/security.vue')),
< 	}, {
< 		path: '/relays',
< 		name: 'relays',
< 		component: page(() => import('./pages/admin/relays.vue')),
< 	}, {
< 		path: '/integrations',
< 		name: 'integrations',
< 		component: page(() => import('./pages/admin/integrations.vue')),
< 	}, {
< 		path: '/instance-block',
< 		name: 'instance-block',
< 		component: page(() => import('./pages/admin/instance-block.vue')),
< 	}, {
< 		path: '/proxy-account',
< 		name: 'proxy-account',
< 		component: page(() => import('./pages/admin/proxy-account.vue')),
< 	}, {
< 		path: '/other-settings',
< 		name: 'other-settings',
< 		component: page(() => import('./pages/admin/other-settings.vue')),
< 	}, {
< 		path: '/',
< 		component: page(() => import('./pages/_empty_.vue')),
< 	}],
< }, {
< 	path: '/my/notifications',
< 	component: page(() => import('./pages/notifications.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/favorites',
< 	component: page(() => import('./pages/favorites.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/achievements',
< 	component: page(() => import('./pages/achievements.vue')),
< 	loginRequired: true,
< }, {
< 	name: 'messaging',
< 	path: '/my/messaging',
< 	component: page(() => import('./pages/messaging/index.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/messaging/:userAcct',
< 	component: page(() => import('./pages/messaging/messaging-room.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/messaging/group/:groupId',
< 	component: page(() => import('./pages/messaging/messaging-room.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/drive/folder/:folder',
< 	component: page(() => import('./pages/drive.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/drive',
< 	component: page(() => import('./pages/drive.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/follow-requests',
< 	component: page(() => import('./pages/follow-requests.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/lists/:listId',
< 	component: page(() => import('./pages/my-lists/list.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/lists',
< 	component: page(() => import('./pages/my-lists/index.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/clips',
< 	component: page(() => import('./pages/my-clips/index.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/antennas/create',
< 	component: page(() => import('./pages/my-antennas/create.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/antennas/:antennaId',
< 	component: page(() => import('./pages/my-antennas/edit.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/my/antennas',
< 	component: page(() => import('./pages/my-antennas/index.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/timeline/list/:listId',
< 	component: page(() => import('./pages/user-list-timeline.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/timeline/antenna/:antennaId',
< 	component: page(() => import('./pages/antenna-timeline.vue')),
< 	loginRequired: true,
< }, {
< 	path: '/clicker',
< 	component: page(() => import('./pages/clicker.vue')),
< 	loginRequired: true,
< }, {
< 	name: 'index',
< 	path: '/',
< 	component: $i ? page(() => import('./pages/timeline.vue')) : page(() => import('./pages/welcome.vue')),
< 	globalCacheKey: 'index',
< }, {
< 	path: '/:(*)',
< 	component: page(() => import('./pages/not-found.vue')),
< }];
---
> export const routes = [
>   {
>     path: "/@:initUser/pages/:initPageName/view-source",
>     component: page(() => import("./pages/page-editor/page-editor.vue")),
>   },
>   {
>     path: "/@:username/pages/:pageName",
>     component: page(() => import("./pages/page.vue")),
>   },
>   {
>     path: "/@:acct/following",
>     component: page(() => import("./pages/user/following.vue")),
>   },
>   {
>     path: "/@:acct/followers",
>     component: page(() => import("./pages/user/followers.vue")),
>   },
>   {
>     name: "user",
>     path: "/@:acct/:page?",
>     component: page(() => import("./pages/user/index.vue")),
>   },
>   {
>     name: "note",
>     path: "/notes/:noteId",
>     component: page(() => import("./pages/note.vue")),
>   },
>   {
>     path: "/clips/:clipId",
>     component: page(() => import("./pages/clip.vue")),
>   },
>   {
>     path: "/user-info/:userId",
>     component: page(() => import("./pages/user-info.vue")),
>   },
>   {
>     path: "/instance-info/:host",
>     component: page(() => import("./pages/instance-info.vue")),
>   },
>   {
>     name: "settings",
>     path: "/settings",
>     component: page(() => import("./pages/settings/index.vue")),
>     loginRequired: true,
>     children: [
>       {
>         path: "/profile",
>         name: "profile",
>         component: page(() => import("./pages/settings/profile.vue")),
>       },
>       {
>         path: "/privacy",
>         name: "privacy",
>         component: page(() => import("./pages/settings/privacy.vue")),
>       },
>       {
>         path: "/reaction",
>         name: "reaction",
>         component: page(() => import("./pages/settings/reaction.vue")),
>       },
>       {
>         path: "/drive",
>         name: "drive",
>         component: page(() => import("./pages/settings/drive.vue")),
>       },
>       {
>         path: "/notifications",
>         name: "notifications",
>         component: page(() => import("./pages/settings/notifications.vue")),
>       },
>       {
>         path: "/email",
>         name: "email",
>         component: page(() => import("./pages/settings/email.vue")),
>       },
>       {
>         path: "/integration",
>         name: "integration",
>         component: page(() => import("./pages/settings/integration.vue")),
>       },
>       {
>         path: "/security",
>         name: "security",
>         component: page(() => import("./pages/settings/security.vue")),
>       },
>       {
>         path: "/general",
>         name: "general",
>         component: page(() => import("./pages/settings/general.vue")),
>       },
>       {
>         path: "/theme/install",
>         name: "theme",
>         component: page(() => import("./pages/settings/theme.install.vue")),
>       },
>       {
>         path: "/theme/manage",
>         name: "theme",
>         component: page(() => import("./pages/settings/theme.manage.vue")),
>       },
>       {
>         path: "/theme",
>         name: "theme",
>         component: page(() => import("./pages/settings/theme.vue")),
>       },
>       {
>         path: "/navbar",
>         name: "navbar",
>         component: page(() => import("./pages/settings/navbar.vue")),
>       },
>       {
>         path: "/statusbar",
>         name: "statusbar",
>         component: page(() => import("./pages/settings/statusbar.vue")),
>       },
>       {
>         path: "/sounds",
>         name: "sounds",
>         component: page(() => import("./pages/settings/sounds.vue")),
>       },
>       {
>         path: "/plugin/install",
>         name: "plugin",
>         component: page(() => import("./pages/settings/plugin.install.vue")),
>       },
>       {
>         path: "/plugin",
>         name: "plugin",
>         component: page(() => import("./pages/settings/plugin.vue")),
>       },
>       {
>         path: "/import-export",
>         name: "import-export",
>         component: page(() => import("./pages/settings/import-export.vue")),
>       },
>       {
>         path: "/instance-mute",
>         name: "instance-mute",
>         component: page(() => import("./pages/settings/instance-mute.vue")),
>       },
>       {
>         path: "/mute-block",
>         name: "mute-block",
>         component: page(() => import("./pages/settings/mute-block.vue")),
>       },
>       {
>         path: "/word-mute",
>         name: "word-mute",
>         component: page(() => import("./pages/settings/word-mute.vue")),
>       },
>       {
>         path: "/api",
>         name: "api",
>         component: page(() => import("./pages/settings/api.vue")),
>       },
>       {
>         path: "/apps",
>         name: "api",
>         component: page(() => import("./pages/settings/apps.vue")),
>       },
>       {
>         path: "/webhook/edit/:webhookId",
>         name: "webhook",
>         component: page(() => import("./pages/settings/webhook.edit.vue")),
>       },
>       {
>         path: "/webhook/new",
>         name: "webhook",
>         component: page(() => import("./pages/settings/webhook.new.vue")),
>       },
>       {
>         path: "/webhook",
>         name: "webhook",
>         component: page(() => import("./pages/settings/webhook.vue")),
>       },
>       {
>         path: "/deck",
>         name: "deck",
>         component: page(() => import("./pages/settings/deck.vue")),
>       },
>       {
>         path: "/preferences-backups",
>         name: "preferences-backups",
>         component: page(
>           () => import("./pages/settings/preferences-backups.vue")
>         ),
>       },
>       {
>         path: "/custom-css",
>         name: "general",
>         component: page(() => import("./pages/settings/custom-css.vue")),
>       },
>       {
>         path: "/accounts",
>         name: "profile",
>         component: page(() => import("./pages/settings/accounts.vue")),
>       },
>       {
>         path: "/account-info",
>         name: "other",
>         component: page(() => import("./pages/settings/account-info.vue")),
>       },
>       {
>         path: "/delete-account",
>         name: "other",
>         component: page(() => import("./pages/settings/delete-account.vue")),
>       },
>       {
>         path: "/other",
>         name: "other",
>         component: page(() => import("./pages/settings/other.vue")),
>       },
>       {
>         path: "/",
>         component: page(() => import("./pages/_empty_.vue")),
>       },
>     ],
>   },
>   {
>     path: "/reset-password/:token?",
>     component: page(() => import("./pages/reset-password.vue")),
>   },
>   {
>     path: "/signup-complete/:code",
>     component: page(() => import("./pages/signup-complete.vue")),
>   },
>   {
>     path: "/announcements",
>     component: page(() => import("./pages/announcements.vue")),
>   },
>   {
>     path: "/about",
>     component: page(() => import("./pages/about.vue")),
>     hash: "initialTab",
>   },
>   {
>     path: "/about-misskey",
>     component: page(() => import("./pages/about-misskey.vue")),
>   },
>   {
>     path: "/theme-editor",
>     component: page(() => import("./pages/theme-editor.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/explore/tags/:tag",
>     component: page(() => import("./pages/explore.vue")),
>   },
>   {
>     path: "/explore",
>     component: page(() => import("./pages/explore.vue")),
>   },
>   {
>     path: "/search",
>     component: page(() => import("./pages/search.vue")),
>     query: {
>       q: "query",
>       channel: "channel",
>     },
>   },
>   {
>     path: "/authorize-follow",
>     component: page(() => import("./pages/follow.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/share",
>     component: page(() => import("./pages/share.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/api-console",
>     component: page(() => import("./pages/api-console.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/mfm-cheat-sheet",
>     component: page(() => import("./pages/mfm-cheat-sheet.vue")),
>   },
>   {
>     path: "/scratchpad",
>     component: page(() => import("./pages/scratchpad.vue")),
>   },
>   {
>     path: "/preview",
>     component: page(() => import("./pages/preview.vue")),
>   },
>   {
>     path: "/auth/:token",
>     component: page(() => import("./pages/auth.vue")),
>   },
>   {
>     path: "/miauth/:session",
>     component: page(() => import("./pages/miauth.vue")),
>     query: {
>       callback: "callback",
>       name: "name",
>       icon: "icon",
>       permission: "permission",
>     },
>   },
>   {
>     path: "/tags/:tag",
>     component: page(() => import("./pages/tag.vue")),
>   },
>   {
>     path: "/pages/new",
>     component: page(() => import("./pages/page-editor/page-editor.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/pages/edit/:initPageId",
>     component: page(() => import("./pages/page-editor/page-editor.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/pages",
>     component: page(() => import("./pages/pages.vue")),
>   },
>   {
>     path: "/gallery/:postId/edit",
>     component: page(() => import("./pages/gallery/edit.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/gallery/new",
>     component: page(() => import("./pages/gallery/edit.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/gallery/:postId",
>     component: page(() => import("./pages/gallery/post.vue")),
>   },
>   {
>     path: "/gallery",
>     component: page(() => import("./pages/gallery/index.vue")),
>   },
>   {
>     path: "/channels/:channelId/edit",
>     component: page(() => import("./pages/channel-editor.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/channels/new",
>     component: page(() => import("./pages/channel-editor.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/channels/:channelId",
>     component: page(() => import("./pages/channel.vue")),
>   },
>   {
>     path: "/channels",
>     component: page(() => import("./pages/channels.vue")),
>   },
>   {
>     path: "/registry/keys/system/:path(*)?",
>     component: page(() => import("./pages/registry.keys.vue")),
>   },
>   {
>     path: "/registry/value/system/:path(*)?",
>     component: page(() => import("./pages/registry.value.vue")),
>   },
>   {
>     path: "/registry",
>     component: page(() => import("./pages/registry.vue")),
>   },
>   {
>     path: "/admin/file/:fileId",
>     component: iAmModerator
>       ? page(() => import("./pages/admin-file.vue"))
>       : page(() => import("./pages/not-found.vue")),
>   },
>   {
>     path: "/admin",
>     component: iAmModerator
>       ? page(() => import("./pages/admin/index.vue"))
>       : page(() => import("./pages/not-found.vue")),
>     children: [
>       {
>         path: "/overview",
>         name: "overview",
>         component: page(() => import("./pages/admin/overview.vue")),
>       },
>       {
>         path: "/users",
>         name: "users",
>         component: page(() => import("./pages/admin/users.vue")),
>       },
>       {
>         path: "/emojis",
>         name: "emojis",
>         component: page(() => import("./pages/admin/emojis.vue")),
>       },
>       {
>         path: "/queue",
>         name: "queue",
>         component: page(() => import("./pages/admin/queue.vue")),
>       },
>       {
>         path: "/files",
>         name: "files",
>         component: page(() => import("./pages/admin/files.vue")),
>       },
>       {
>         path: "/announcements",
>         name: "announcements",
>         component: page(() => import("./pages/admin/announcements.vue")),
>       },
>       {
>         path: "/ads",
>         name: "ads",
>         component: page(() => import("./pages/admin/ads.vue")),
>       },
>       {
>         path: "/database",
>         name: "database",
>         component: page(() => import("./pages/admin/database.vue")),
>       },
>       {
>         path: "/abuses",
>         name: "abuses",
>         component: page(() => import("./pages/admin/abuses.vue")),
>       },
>       {
>         path: "/settings",
>         name: "settings",
>         component: page(() => import("./pages/admin/settings.vue")),
>       },
>       {
>         path: "/email-settings",
>         name: "email-settings",
>         component: page(() => import("./pages/admin/email-settings.vue")),
>       },
>       {
>         path: "/object-storage",
>         name: "object-storage",
>         component: page(() => import("./pages/admin/object-storage.vue")),
>       },
>       {
>         path: "/security",
>         name: "security",
>         component: page(() => import("./pages/admin/security.vue")),
>       },
>       {
>         path: "/relays",
>         name: "relays",
>         component: page(() => import("./pages/admin/relays.vue")),
>       },
>       {
>         path: "/integrations",
>         name: "integrations",
>         component: page(() => import("./pages/admin/integrations.vue")),
>       },
>       {
>         path: "/instance-block",
>         name: "instance-block",
>         component: page(() => import("./pages/admin/instance-block.vue")),
>       },
>       {
>         path: "/proxy-account",
>         name: "proxy-account",
>         component: page(() => import("./pages/admin/proxy-account.vue")),
>       },
>       {
>         path: "/other-settings",
>         name: "other-settings",
>         component: page(() => import("./pages/admin/other-settings.vue")),
>       },
>       {
>         path: "/",
>         component: page(() => import("./pages/_empty_.vue")),
>       },
>     ],
>   },
>   {
>     path: "/my/notifications",
>     component: page(() => import("./pages/notifications.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/favorites",
>     component: page(() => import("./pages/favorites.vue")),
>     loginRequired: true,
>   },
>   {
>     name: "messaging",
>     path: "/my/messaging",
>     component: page(() => import("./pages/messaging/index.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/messaging/:userAcct",
>     component: page(() => import("./pages/messaging/messaging-room.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/messaging/group/:groupId",
>     component: page(() => import("./pages/messaging/messaging-room.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/drive/folder/:folder",
>     component: page(() => import("./pages/drive.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/drive",
>     component: page(() => import("./pages/drive.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/follow-requests",
>     component: page(() => import("./pages/follow-requests.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/lists/:listId",
>     component: page(() => import("./pages/my-lists/list.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/lists",
>     component: page(() => import("./pages/my-lists/index.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/clips",
>     component: page(() => import("./pages/my-clips/index.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/antennas/create",
>     component: page(() => import("./pages/my-antennas/create.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/antennas/:antennaId",
>     component: page(() => import("./pages/my-antennas/edit.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/my/antennas",
>     component: page(() => import("./pages/my-antennas/index.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/timeline/list/:listId",
>     component: page(() => import("./pages/user-list-timeline.vue")),
>     loginRequired: true,
>   },
>   {
>     path: "/timeline/antenna/:antennaId",
>     component: page(() => import("./pages/antenna-timeline.vue")),
>     loginRequired: true,
>   },
>   {
>     name: "index",
>     path: "/",
>     component: $i
>       ? page(() => import("./pages/timeline.vue"))
>       : page(() => import("./pages/welcome.vue")),
>     globalCacheKey: "index",
>   },
>   {
>     path: "/:(*)",
>     component: page(() => import("./pages/not-found.vue")),
>   },
> ];
505c585,588
< export const mainRouter = new Router(routes, location.pathname + location.search + location.hash);
---
> export const mainRouter = new Router(
>   routes,
>   location.pathname + location.search + location.hash
> );
507c590,594
< window.history.replaceState({ key: mainRouter.getCurrentKey() }, '', location.href);
---
> window.history.replaceState(
>   { key: mainRouter.getCurrentKey() },
>   "",
>   location.href
> );
515c602
< 	scrollPosStore.set(window.history.state?.key, window.scrollY);
---
>   scrollPosStore.set(window.history.state?.key, window.scrollY);
518,526c605,614
< mainRouter.addListener('push', ctx => {
< 	window.history.pushState({ key: ctx.key }, '', ctx.path);
< 	const scrollPos = scrollPosStore.get(ctx.key) ?? 0;
< 	window.scroll({ top: scrollPos, behavior: 'instant' });
< 	if (scrollPos !== 0) {
< 		window.setTimeout(() => { // 遷移直後はタイミングによってはコンポーネントが復元し切ってない可能性も考えられるため少し時間を空けて再度スクロール
< 			window.scroll({ top: scrollPos, behavior: 'instant' });
< 		}, 100);
< 	}
---
> mainRouter.addListener("push", (ctx) => {
>   window.history.pushState({ key: ctx.key }, "", ctx.path);
>   const scrollPos = scrollPosStore.get(ctx.key) ?? 0;
>   window.scroll({ top: scrollPos, behavior: "instant" });
>   if (scrollPos !== 0) {
>     window.setTimeout(() => {
>       // 遷移直後はタイミングによってはコンポーネントが復元し切ってない可能性も考えられるため少し時間を空けて再度スクロール
>       window.scroll({ top: scrollPos, behavior: "instant" });
>     }, 100);
>   }
529,530c617,618
< mainRouter.addListener('replace', ctx => {
< 	window.history.replaceState({ key: ctx.key }, '', ctx.path);
---
> mainRouter.addListener("replace", (ctx) => {
>   window.history.replaceState({ key: ctx.key }, "", ctx.path);
533,534c621,622
< mainRouter.addListener('same', () => {
< 	window.scroll({ top: 0, behavior: 'smooth' });
---
> mainRouter.addListener("same", () => {
>   window.scroll({ top: 0, behavior: "smooth" });
537,543c625,636
< window.addEventListener('popstate', (event) => {
< 	mainRouter.replace(location.pathname + location.search + location.hash, event.state?.key, false);
< 	const scrollPos = scrollPosStore.get(event.state?.key) ?? 0;
< 	window.scroll({ top: scrollPos, behavior: 'instant' });
< 	window.setTimeout(() => { // 遷移直後はタイミングによってはコンポーネントが復元し切ってない可能性も考えられるため少し時間を空けて再度スクロール
< 		window.scroll({ top: scrollPos, behavior: 'instant' });
< 	}, 100);
---
> window.addEventListener("popstate", (event) => {
>   mainRouter.replace(
>     location.pathname + location.search + location.hash,
>     event.state?.key,
>     false
>   );
>   const scrollPos = scrollPosStore.get(event.state?.key) ?? 0;
>   window.scroll({ top: scrollPos, behavior: "instant" });
>   window.setTimeout(() => {
>     // 遷移直後はタイミングによってはコンポーネントが復元し切ってない可能性も考えられるため少し時間を空けて再度スクロール
>     window.scroll({ top: scrollPos, behavior: "instant" });
>   }, 100);
547c640
< 	return inject<Router | null>('router', null) ?? mainRouter;
---
>   return inject<Router | null>("router", null) ?? mainRouter;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/2fa.ts RiricaV13/scripts/2fa.ts
1,20c1,14
< export function byteify(string: string, encoding: 'ascii' | 'base64' | 'hex') {
< 	switch (encoding) {
< 		case 'ascii':
< 			return Uint8Array.from(string, c => c.charCodeAt(0));
< 		case 'base64':
< 			return Uint8Array.from(
< 				atob(
< 					string
< 						.replace(/-/g, '+')
< 						.replace(/_/g, '/'),
< 				),
< 				c => c.charCodeAt(0),
< 			);
< 		case 'hex':
< 			return new Uint8Array(
< 				string
< 					.match(/.{1,2}/g)
< 					.map(byte => parseInt(byte, 16)),
< 			);
< 	}
---
> export function byteify(string: string, encoding: "ascii" | "base64" | "hex") {
>   switch (encoding) {
>     case "ascii":
>       return Uint8Array.from(string, (c) => c.charCodeAt(0));
>     case "base64":
>       return Uint8Array.from(
>         atob(string.replace(/-/g, "+").replace(/_/g, "/")),
>         (c) => c.charCodeAt(0)
>       );
>     case "hex":
>       return new Uint8Array(
>         string.match(/.{1,2}/g).map((byte) => parseInt(byte, 16))
>       );
>   }
24,28c18,21
< 	return Array.from(new Uint8Array(buffer))
< 		.reduce(
< 			(str, byte) => str + byte.toString(16).padStart(2, '0'),
< 			'',
< 		);
---
>   return Array.from(new Uint8Array(buffer)).reduce(
>     (str, byte) => str + byte.toString(16).padStart(2, "0"),
>     ""
>   );
32c25
< 	return String.fromCharCode(... new Uint8Array(buffer));
---
>   return String.fromCharCode(...new Uint8Array(buffer));
Only in misskeyV13/packages/frontend/src/scripts: achievements.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/aiscript/api.ts RiricaV13/scripts/aiscript/api.ts
1,5c1,3
< import { utils, values } from '@syuilo/aiscript';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { miLocalStorage } from '@/local-storage';
< import { customEmojis } from '@/custom-emojis';
---
> import { utils, values } from "@syuilo/aiscript";
> import * as os from "@/os";
> import { $i } from "@/account";
8,45c6,53
< 	let apiRequests = 0;
< 	return {
< 		USER_ID: $i ? values.STR($i.id) : values.NULL,
< 		USER_NAME: $i ? values.STR($i.name) : values.NULL,
< 		USER_USERNAME: $i ? values.STR($i.username) : values.NULL,
< 		CUSTOM_EMOJIS: utils.jsToVal(customEmojis.value),
< 		'Mk:dialog': values.FN_NATIVE(async ([title, text, type]) => {
< 			await os.alert({
< 				type: type ? type.value : 'info',
< 				title: title.value,
< 				text: text.value,
< 			});
< 		}),
< 		'Mk:confirm': values.FN_NATIVE(async ([title, text, type]) => {
< 			const confirm = await os.confirm({
< 				type: type ? type.value : 'question',
< 				title: title.value,
< 				text: text.value,
< 			});
< 			return confirm.canceled ? values.FALSE : values.TRUE;
< 		}),
< 		'Mk:api': values.FN_NATIVE(async ([ep, param, token]) => {
< 			if (token) utils.assertString(token);
< 			apiRequests++;
< 			if (apiRequests > 16) return values.NULL;
< 			const res = await os.api(ep.value, utils.valToJs(param), token ? token.value : (opts.token ?? null));
< 			return utils.jsToVal(res);
< 		}),
< 		'Mk:save': values.FN_NATIVE(([key, value]) => {
< 			utils.assertString(key);
< 			miLocalStorage.setItem(`aiscript:${opts.storageKey}:${key.value}`, JSON.stringify(utils.valToJs(value)));
< 			return values.NULL;
< 		}),
< 		'Mk:load': values.FN_NATIVE(([key]) => {
< 			utils.assertString(key);
< 			return utils.jsToVal(JSON.parse(miLocalStorage.getItem(`aiscript:${opts.storageKey}:${key.value}`)));
< 		}),
< 	};
---
>   let apiRequests = 0;
>   return {
>     USER_ID: $i ? values.STR($i.id) : values.NULL,
>     USER_NAME: $i ? values.STR($i.name) : values.NULL,
>     USER_USERNAME: $i ? values.STR($i.username) : values.NULL,
>     "Mk:dialog": values.FN_NATIVE(async ([title, text, type]) => {
>       await os.alert({
>         type: type ? type.value : "info",
>         title: title.value,
>         text: text.value,
>       });
>     }),
>     "Mk:confirm": values.FN_NATIVE(async ([title, text, type]) => {
>       const confirm = await os.confirm({
>         type: type ? type.value : "question",
>         title: title.value,
>         text: text.value,
>       });
>       return confirm.canceled ? values.FALSE : values.TRUE;
>     }),
>     "Mk:api": values.FN_NATIVE(async ([ep, param, token]) => {
>       if (token) utils.assertString(token);
>       apiRequests++;
>       if (apiRequests > 16) return values.NULL;
>       const res = await os.api(
>         ep.value,
>         utils.valToJs(param),
>         token ? token.value : opts.token ?? null
>       );
>       return utils.jsToVal(res);
>     }),
>     "Mk:save": values.FN_NATIVE(([key, value]) => {
>       utils.assertString(key);
>       localStorage.setItem(
>         "aiscript:" + opts.storageKey + ":" + key.value,
>         JSON.stringify(utils.valToJs(value))
>       );
>       return values.NULL;
>     }),
>     "Mk:load": values.FN_NATIVE(([key]) => {
>       utils.assertString(key);
>       return utils.jsToVal(
>         JSON.parse(
>           localStorage.getItem("aiscript:" + opts.storageKey + ":" + key.value)
>         )
>       );
>     }),
>   };
Only in misskeyV13/packages/frontend/src/scripts/aiscript: ui.ts
Only in misskeyV13/packages/frontend/src/scripts: api.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/array.ts RiricaV13/scripts/array.ts
1c1
< import { EndoRelation, Predicate } from './relation';
---
> import { EndoRelation, Predicate } from "./relation";
8c8
< 	return xs.filter(f).length;
---
>   return xs.filter(f).length;
15c15
< 	return countIf(x => x === a, xs);
---
>   return countIf((x) => x === a, xs);
22c22
< 	return ([] as T[]).concat(...xss);
---
>   return ([] as T[]).concat(...xss);
30c30
< 	return concat(xs.map(x => [sep, x])).slice(1);
---
>   return concat(xs.map((x) => [sep, x])).slice(1);
37c37
< 	return xs.filter(x => x !== a);
---
>   return xs.filter((x) => x !== a);
45c45
< 	return xs.filter(x => !ys.includes(x));
---
>   return xs.filter((x) => !ys.includes(x));
52c52
< 	return [...new Set(xs)];
---
>   return [...new Set(xs)];
55,56c55,59
< export function uniqueBy<TValue, TKey>(values: TValue[], keySelector: (value: TValue) => TKey): TValue[] {
< 	const map = new Map<TKey, TValue>();
---
> export function uniqueBy<TValue, TKey>(
>   values: TValue[],
>   keySelector: (value: TValue) => TKey
> ): TValue[] {
>   const map = new Map<TKey, TValue>();
58,61c61,64
< 	for (const value of values) {
< 		const key = keySelector(value);
< 		if (!map.has(key)) map.set(key, value);
< 	}
---
>   for (const value of values) {
>     const key = keySelector(value);
>     if (!map.has(key)) map.set(key, value);
>   }
63c66
< 	return [...map.values()];
---
>   return [...map.values()];
67c70
< 	return xs.reduce((a, b) => a + b, 0);
---
>   return xs.reduce((a, b) => a + b, 0);
71c74
< 	return Math.max(...xs);
---
>   return Math.max(...xs);
79,87c82,90
< 	const groups = [] as T[][];
< 	for (const x of xs) {
< 		if (groups.length !== 0 && f(groups[groups.length - 1][0], x)) {
< 			groups[groups.length - 1].push(x);
< 		} else {
< 			groups.push([x]);
< 		}
< 	}
< 	return groups;
---
>   const groups = [] as T[][];
>   for (const x of xs) {
>     if (groups.length !== 0 && f(groups[groups.length - 1][0], x)) {
>       groups[groups.length - 1].push(x);
>     } else {
>       groups.push([x]);
>     }
>   }
>   return groups;
95c98
< 	return groupBy((a, b) => f(a) === f(b), xs);
---
>   return groupBy((a, b) => f(a) === f(b), xs);
99,103c102,106
< 	return collections.reduce((obj: Record<string, T[]>, item: T) => {
< 		const key = keySelector(item);
< 		if (typeof obj[key] === 'undefined') {
< 			obj[key] = [];
< 		}
---
>   return collections.reduce((obj: Record<string, T[]>, item: T) => {
>     const key = keySelector(item);
>     if (typeof obj[key] === "undefined") {
>       obj[key] = [];
>     }
105c108
< 		obj[key].push(item);
---
>     obj[key].push(item);
107,108c110,111
< 		return obj;
< 	}, {});
---
>     return obj;
>   }, {});
115,119c118,122
< 	for (let i = 0; i < Math.min(xs.length, ys.length); i++) {
< 		if (xs[i] < ys[i]) return true;
< 		if (xs[i] > ys[i]) return false;
< 	}
< 	return xs.length < ys.length;
---
>   for (let i = 0; i < Math.min(xs.length, ys.length); i++) {
>     if (xs[i] < ys[i]) return true;
>     if (xs[i] > ys[i]) return false;
>   }
>   return xs.length < ys.length;
126,134c129,137
< 	const ys: T[] = [];
< 	for (const x of xs) {
< 		if (f(x)) {
< 			ys.push(x);
< 		} else {
< 			break;
< 		}
< 	}
< 	return ys;
---
>   const ys = [];
>   for (const x of xs) {
>     if (f(x)) {
>       ys.push(x);
>     } else {
>       break;
>     }
>   }
>   return ys;
138,140c141,143
< 	const ys = Array.from(xs); // deep copy
< 	for (let i = 1; i < ys.length; i++) ys[i] += ys[i - 1];
< 	return ys;
---
>   const ys = Array.from(xs); // deep copy
>   for (let i = 1; i < ys.length; i++) ys[i] += ys[i - 1];
>   return ys;
144c147
< 	return Array.isArray(x) ? x : x != null ? [x] : [];
---
>   return Array.isArray(x) ? x : x != null ? [x] : [];
148c151
< 	return Array.isArray(x) ? x[0] : x;
---
>   return Array.isArray(x) ? x[0] : x;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/autocomplete.ts RiricaV13/scripts/autocomplete.ts
1,4c1,4
< import { nextTick, Ref, ref, defineAsyncComponent } from 'vue';
< import getCaretCoordinates from 'textarea-caret';
< import { toASCII } from 'punycode/';
< import { popup } from '@/os';
---
> import { nextTick, Ref, ref, defineAsyncComponent } from "vue";
> import getCaretCoordinates from "textarea-caret";
> import { toASCII } from "punycode/";
> import { popup } from "@/os";
7,16c7,16
< 	private suggestion: {
< 		x: Ref<number>;
< 		y: Ref<number>;
< 		q: Ref<string | null>;
< 		close: () => void;
< 	} | null;
< 	private textarea: HTMLInputElement | HTMLTextAreaElement;
< 	private currentType: string;
< 	private textRef: Ref<string>;
< 	private opening: boolean;
---
>   private suggestion: {
>     x: Ref<number>;
>     y: Ref<number>;
>     q: Ref<string | null>;
>     close: () => void;
>   } | null;
>   private textarea: HTMLInputElement | HTMLTextAreaElement;
>   private currentType: string;
>   private textRef: Ref<string>;
>   private opening: boolean;
18,22c18,20
< 	private get text(): string {
< 		// Use raw .value to get the latest value
< 		// (Because v-model does not update while composition)
< 		return this.textarea.value;
< 	}
---
>   private get text(): string {
>     return this.textRef.value;
>   }
24,28c22,24
< 	private set text(text: string) {
< 		// Use ref value to notify other watchers
< 		// (Because .value setter never fires input/change events)
< 		this.textRef.value = text;
< 	}
---
>   private set text(text: string) {
>     this.textRef.value = text;
>   }
30,38c26,37
< 	/**
< 	 * 対象のテキストエリアを与えてインスタンスを初期化します。
< 	 */
< 	constructor(textarea: HTMLInputElement | HTMLTextAreaElement, textRef: Ref<string>) {
< 		//#region BIND
< 		this.onInput = this.onInput.bind(this);
< 		this.complete = this.complete.bind(this);
< 		this.close = this.close.bind(this);
< 		//#endregion
---
>   /**
>    * 対象のテキストエリアを与えてインスタンスを初期化します。
>    */
>   constructor(
>     textarea: HTMLInputElement | HTMLTextAreaElement,
>     textRef: Ref<string>
>   ) {
>     //#region BIND
>     this.onInput = this.onInput.bind(this);
>     this.complete = this.complete.bind(this);
>     this.close = this.close.bind(this);
>     //#endregion
40,43c39,42
< 		this.suggestion = null;
< 		this.textarea = textarea;
< 		this.textRef = textRef;
< 		this.opening = false;
---
>     this.suggestion = null;
>     this.textarea = textarea;
>     this.textRef = textRef;
>     this.opening = false;
45,46c44,45
< 		this.attach();
< 	}
---
>     this.attach();
>   }
48,53c47,52
< 	/**
< 	 * このインスタンスにあるテキストエリアの入力のキャプチャを開始します。
< 	 */
< 	public attach() {
< 		this.textarea.addEventListener('input', this.onInput);
< 	}
---
>   /**
>    * このインスタンスにあるテキストエリアの入力のキャプチャを開始します。
>    */
>   public attach() {
>     this.textarea.addEventListener("input", this.onInput);
>   }
55,61c54,60
< 	/**
< 	 * このインスタンスにあるテキストエリアの入力のキャプチャを解除します。
< 	 */
< 	public detach() {
< 		this.textarea.removeEventListener('input', this.onInput);
< 		this.close();
< 	}
---
>   /**
>    * このインスタンスにあるテキストエリアの入力のキャプチャを解除します。
>    */
>   public detach() {
>     this.textarea.removeEventListener("input", this.onInput);
>     this.close();
>   }
63,68c62,67
< 	/**
< 	 * テキスト入力時
< 	 */
< 	private onInput() {
< 		const caretPos = this.textarea.selectionStart;
< 		const text = this.text.substr(0, caretPos).split('\n').pop()!;
---
>   /**
>    * テキスト入力時
>    */
>   private onInput() {
>     const caretPos = this.textarea.selectionStart;
>     const text = this.text.substr(0, caretPos).split("\n").pop()!;
70,73c69,72
< 		const mentionIndex = text.lastIndexOf('@');
< 		const hashtagIndex = text.lastIndexOf('#');
< 		const emojiIndex = text.lastIndexOf(':');
< 		const mfmTagIndex = text.lastIndexOf('$');
---
>     const mentionIndex = text.lastIndexOf("@");
>     const hashtagIndex = text.lastIndexOf("#");
>     const emojiIndex = text.lastIndexOf(":");
>     const mfmTagIndex = text.lastIndexOf("$");
75,79c74
< 		const max = Math.max(
< 			mentionIndex,
< 			hashtagIndex,
< 			emojiIndex,
< 			mfmTagIndex);
---
>     const max = Math.max(mentionIndex, hashtagIndex, emojiIndex, mfmTagIndex);
81,84c76,79
< 		if (max === -1) {
< 			this.close();
< 			return;
< 		}
---
>     if (max === -1) {
>       this.close();
>       return;
>     }
86,89c81,89
< 		const isMention = mentionIndex !== -1;
< 		const isHashtag = hashtagIndex !== -1;
< 		const isMfmTag = mfmTagIndex !== -1;
< 		const isEmoji = emojiIndex !== -1 && text.split(/:[a-z0-9_+\-]+:/).pop()!.includes(':');
---
>     const isMention = mentionIndex !== -1;
>     const isHashtag = hashtagIndex !== -1;
>     const isMfmTag = mfmTagIndex !== -1;
>     const isEmoji =
>       emojiIndex !== -1 &&
>       text
>         .split(/:[a-z0-9_+\-]+:/)
>         .pop()!
>         .includes(":");
91c91
< 		let opened = false;
---
>     let opened = false;
93,102c93,102
< 		if (isMention) {
< 			const username = text.substr(mentionIndex + 1);
< 			if (username !== '' && username.match(/^[a-zA-Z0-9_]+$/)) {
< 				this.open('user', username);
< 				opened = true;
< 			} else if (username === '') {
< 				this.open('user', null);
< 				opened = true;
< 			}
< 		}
---
>     if (isMention) {
>       const username = text.substr(mentionIndex + 1);
>       if (username !== "" && username.match(/^[a-zA-Z0-9_]+$/)) {
>         this.open("user", username);
>         opened = true;
>       } else if (username === "") {
>         this.open("user", null);
>         opened = true;
>       }
>     }
104,110c104,110
< 		if (isHashtag && !opened) {
< 			const hashtag = text.substr(hashtagIndex + 1);
< 			if (!hashtag.includes(' ')) {
< 				this.open('hashtag', hashtag);
< 				opened = true;
< 			}
< 		}
---
>     if (isHashtag && !opened) {
>       const hashtag = text.substr(hashtagIndex + 1);
>       if (!hashtag.includes(" ")) {
>         this.open("hashtag", hashtag);
>         opened = true;
>       }
>     }
112,118c112,118
< 		if (isEmoji && !opened) {
< 			const emoji = text.substr(emojiIndex + 1);
< 			if (!emoji.includes(' ')) {
< 				this.open('emoji', emoji);
< 				opened = true;
< 			}
< 		}
---
>     if (isEmoji && !opened) {
>       const emoji = text.substr(emojiIndex + 1);
>       if (!emoji.includes(" ")) {
>         this.open("emoji", emoji);
>         opened = true;
>       }
>     }
120,126c120,126
< 		if (isMfmTag && !opened) {
< 			const mfmTag = text.substr(mfmTagIndex + 1);
< 			if (!mfmTag.includes(' ')) {
< 				this.open('mfmTag', mfmTag.replace('[', ''));
< 				opened = true;
< 			}
< 		}
---
>     if (isMfmTag && !opened) {
>       const mfmTag = text.substr(mfmTagIndex + 1);
>       if (!mfmTag.includes(" ")) {
>         this.open("mfmTag", mfmTag.replace("[", ""));
>         opened = true;
>       }
>     }
128,131c128,131
< 		if (!opened) {
< 			this.close();
< 		}
< 	}
---
>     if (!opened) {
>       this.close();
>     }
>   }
133,142c133,142
< 	/**
< 	 * サジェストを提示します。
< 	 */
< 	private async open(type: string, q: string | null) {
< 		if (type !== this.currentType) {
< 			this.close();
< 		}
< 		if (this.opening) return;
< 		this.opening = true;
< 		this.currentType = type;
---
>   /**
>    * サジェストを提示します。
>    */
>   private async open(type: string, q: string | null) {
>     if (type !== this.currentType) {
>       this.close();
>     }
>     if (this.opening) return;
>     this.opening = true;
>     this.currentType = type;
144,145c144,148
< 		//#region サジェストを表示すべき位置を計算
< 		const caretPosition = getCaretCoordinates(this.textarea, this.textarea.selectionStart);
---
>     //#region サジェストを表示すべき位置を計算
>     const caretPosition = getCaretCoordinates(
>       this.textarea,
>       this.textarea.selectionStart
>     );
147c150
< 		const rect = this.textarea.getBoundingClientRect();
---
>     const rect = this.textarea.getBoundingClientRect();
149,151c152,154
< 		const x = rect.left + caretPosition.left - this.textarea.scrollLeft;
< 		const y = rect.top + caretPosition.top - this.textarea.scrollTop;
< 		//#endregion
---
>     const x = rect.left + caretPosition.left - this.textarea.scrollLeft;
>     const y = rect.top + caretPosition.top - this.textarea.scrollTop;
>     //#endregion
153,156c156,159
< 		if (this.suggestion) {
< 			this.suggestion.x.value = x;
< 			this.suggestion.y.value = y;
< 			this.suggestion.q.value = q;
---
>     if (this.suggestion) {
>       this.suggestion.x.value = x;
>       this.suggestion.y.value = y;
>       this.suggestion.q.value = q;
158,162c161,165
< 			this.opening = false;
< 		} else {
< 			const _x = ref(x);
< 			const _y = ref(y);
< 			const _q = ref(q);
---
>       this.opening = false;
>     } else {
>       const _x = ref(x);
>       const _y = ref(y);
>       const _q = ref(q);
164,175c167,182
< 			const { dispose } = await popup(defineAsyncComponent(() => import('@/components/MkAutocomplete.vue')), {
< 				textarea: this.textarea,
< 				close: this.close,
< 				type: type,
< 				q: _q,
< 				x: _x,
< 				y: _y,
< 			}, {
< 				done: (res) => {
< 					this.complete(res);
< 				},
< 			});
---
>       const { dispose } = await popup(
>         defineAsyncComponent(() => import("@/components/MkAutocomplete.vue")),
>         {
>           textarea: this.textarea,
>           close: this.close,
>           type: type,
>           q: _q,
>           x: _x,
>           y: _y,
>         },
>         {
>           done: (res) => {
>             this.complete(res);
>           },
>         }
>       );
177,182c184,189
< 			this.suggestion = {
< 				q: _q,
< 				x: _x,
< 				y: _y,
< 				close: () => dispose(),
< 			};
---
>       this.suggestion = {
>         q: _q,
>         x: _x,
>         y: _y,
>         close: () => dispose(),
>       };
184,186c191,193
< 			this.opening = false;
< 		}
< 	}
---
>       this.opening = false;
>     }
>   }
188,192c195,199
< 	/**
< 	 * サジェストを閉じます。
< 	 */
< 	private close() {
< 		if (this.suggestion == null) return;
---
>   /**
>    * サジェストを閉じます。
>    */
>   private close() {
>     if (this.suggestion == null) return;
194,195c201,202
< 		this.suggestion.close();
< 		this.suggestion = null;
---
>     this.suggestion.close();
>     this.suggestion = null;
197,198c204,205
< 		this.textarea.focus();
< 	}
---
>     this.textarea.focus();
>   }
200,204c207,211
< 	/**
< 	 * オートコンプリートする
< 	 */
< 	private complete({ type, value }) {
< 		this.close();
---
>   /**
>    * オートコンプリートする
>    */
>   private complete({ type, value }) {
>     this.close();
206c213
< 		const caret = this.textarea.selectionStart;
---
>     const caret = this.textarea.selectionStart;
208,209c215,216
< 		if (type === 'user') {
< 			const source = this.text;
---
>     if (type === "user") {
>       const source = this.text;
211,213c218,220
< 			const before = source.substr(0, caret);
< 			const trimmedBefore = before.substring(0, before.lastIndexOf('@'));
< 			const after = source.substr(caret);
---
>       const before = source.substr(0, caret);
>       const trimmedBefore = before.substring(0, before.lastIndexOf("@"));
>       const after = source.substr(caret);
215c222,225
< 			const acct = value.host === null ? value.username : `${value.username}@${toASCII(value.host)}`;
---
>       const acct =
>         value.host === null
>           ? value.username
>           : `${value.username}@${toASCII(value.host)}`;
217,218c227,228
< 			// 挿入
< 			this.text = `${trimmedBefore}@${acct} ${after}`;
---
>       // 挿入
>       this.text = `${trimmedBefore}@${acct} ${after}`;
220,227c230,237
< 			// キャレットを戻す
< 			nextTick(() => {
< 				this.textarea.focus();
< 				const pos = trimmedBefore.length + (acct.length + 2);
< 				this.textarea.setSelectionRange(pos, pos);
< 			});
< 		} else if (type === 'hashtag') {
< 			const source = this.text;
---
>       // キャレットを戻す
>       nextTick(() => {
>         this.textarea.focus();
>         const pos = trimmedBefore.length + (acct.length + 2);
>         this.textarea.setSelectionRange(pos, pos);
>       });
>     } else if (type === "hashtag") {
>       const source = this.text;
229,231c239,241
< 			const before = source.substr(0, caret);
< 			const trimmedBefore = before.substring(0, before.lastIndexOf('#'));
< 			const after = source.substr(caret);
---
>       const before = source.substr(0, caret);
>       const trimmedBefore = before.substring(0, before.lastIndexOf("#"));
>       const after = source.substr(caret);
233,234c243,244
< 			// 挿入
< 			this.text = `${trimmedBefore}#${value} ${after}`;
---
>       // 挿入
>       this.text = `${trimmedBefore}#${value} ${after}`;
236,243c246,253
< 			// キャレットを戻す
< 			nextTick(() => {
< 				this.textarea.focus();
< 				const pos = trimmedBefore.length + (value.length + 2);
< 				this.textarea.setSelectionRange(pos, pos);
< 			});
< 		} else if (type === 'emoji') {
< 			const source = this.text;
---
>       // キャレットを戻す
>       nextTick(() => {
>         this.textarea.focus();
>         const pos = trimmedBefore.length + (value.length + 2);
>         this.textarea.setSelectionRange(pos, pos);
>       });
>     } else if (type === "emoji") {
>       const source = this.text;
245,247c255,257
< 			const before = source.substr(0, caret);
< 			const trimmedBefore = before.substring(0, before.lastIndexOf(':'));
< 			const after = source.substr(caret);
---
>       const before = source.substr(0, caret);
>       const trimmedBefore = before.substring(0, before.lastIndexOf(":"));
>       const after = source.substr(caret);
249,250c259,260
< 			// 挿入
< 			this.text = trimmedBefore + value + after;
---
>       // 挿入
>       this.text = trimmedBefore + value + after;
252,259c262,269
< 			// キャレットを戻す
< 			nextTick(() => {
< 				this.textarea.focus();
< 				const pos = trimmedBefore.length + value.length;
< 				this.textarea.setSelectionRange(pos, pos);
< 			});
< 		} else if (type === 'mfmTag') {
< 			const source = this.text;
---
>       // キャレットを戻す
>       nextTick(() => {
>         this.textarea.focus();
>         const pos = trimmedBefore.length + value.length;
>         this.textarea.setSelectionRange(pos, pos);
>       });
>     } else if (type === "mfmTag") {
>       const source = this.text;
261,263c271,273
< 			const before = source.substr(0, caret);
< 			const trimmedBefore = before.substring(0, before.lastIndexOf('$'));
< 			const after = source.substr(caret);
---
>       const before = source.substr(0, caret);
>       const trimmedBefore = before.substring(0, before.lastIndexOf("$"));
>       const after = source.substr(caret);
265,266c275,276
< 			// 挿入
< 			this.text = `${trimmedBefore}$[${value} ]${after}`;
---
>       // 挿入
>       this.text = `${trimmedBefore}$[${value} ]${after}`;
268,275c278,285
< 			// キャレットを戻す
< 			nextTick(() => {
< 				this.textarea.focus();
< 				const pos = trimmedBefore.length + (value.length + 3);
< 				this.textarea.setSelectionRange(pos, pos);
< 			});
< 		}
< 	}
---
>       // キャレットを戻す
>       nextTick(() => {
>         this.textarea.focus();
>         const pos = trimmedBefore.length + (value.length + 3);
>         this.textarea.setSelectionRange(pos, pos);
>       });
>     }
>   }
Only in misskeyV13/packages/frontend/src/scripts: chart-legend.ts
Only in misskeyV13/packages/frontend/src/scripts: chart-vline.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/check-word-mute.ts RiricaV13/scripts/check-word-mute.ts
1,3c1,7
< export function checkWordMute(note: Record<string, any>, me: Record<string, any> | null | undefined, mutedWords: Array<string | string[]>): boolean {
< 	// 自分自身
< 	if (me && (note.userId === me.id)) return false;
---
> export function checkWordMute(
>   note: Record<string, any>,
>   me: Record<string, any> | null | undefined,
>   mutedWords: Array<string | string[]>
> ): boolean {
>   // 自分自身
>   if (me && note.userId === me.id) return false;
5,6c9,10
< 	if (mutedWords.length > 0) {
< 		const text = ((note.cw ?? '') + '\n' + (note.text ?? '')).trim();
---
>   if (mutedWords.length > 0) {
>     const text = ((note.cw ?? "") + "\n" + (note.text ?? "")).trim();
8c12
< 		if (text === '') return false;
---
>     if (text === "") return false;
10,14c14,18
< 		const matched = mutedWords.some(filter => {
< 			if (Array.isArray(filter)) {
< 				// Clean up
< 				const filteredFilter = filter.filter(keyword => keyword !== '');
< 				if (filteredFilter.length === 0) return false;
---
>     const matched = mutedWords.some((filter) => {
>       if (Array.isArray(filter)) {
>         // Clean up
>         const filteredFilter = filter.filter((keyword) => keyword !== "");
>         if (filteredFilter.length === 0) return false;
16,19c20,23
< 				return filteredFilter.every(keyword => text.includes(keyword));
< 			} else {
< 				// represents RegExp
< 				const regexp = filter.match(/^\/(.+)\/(.*)$/);
---
>         return filteredFilter.every((keyword) => text.includes(keyword));
>       } else {
>         // represents RegExp
>         const regexp = filter.match(/^\/(.+)\/(.*)$/);
21,22c25,26
< 				// This should never happen due to input sanitisation.
< 				if (!regexp) return false;
---
>         // This should never happen due to input sanitisation.
>         if (!regexp) return false;
24,31c28,35
< 				try {
< 					return new RegExp(regexp[1], regexp[2]).test(text);
< 				} catch (err) {
< 					// This should never happen due to input sanitisation.
< 					return false;
< 				}
< 			}
< 		});
---
>         try {
>           return new RegExp(regexp[1], regexp[2]).test(text);
>         } catch (err) {
>           // This should never happen due to input sanitisation.
>           return false;
>         }
>       }
>     });
33,34c37,38
< 		if (matched) return true;
< 	}
---
>     if (matched) return true;
>   }
36c40
< 	return false;
---
>   return false;
Only in misskeyV13/packages/frontend/src/scripts: clicker-game.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/clone.ts RiricaV13/scripts/clone.ts
4c4,10
< type Cloneable = string | number | boolean | null | { [key: string]: Cloneable } | Cloneable[];
---
> type Cloneable =
>   | string
>   | number
>   | boolean
>   | null
>   | { [key: string]: Cloneable }
>   | Cloneable[];
7,17c13,23
< 	if (typeof x === 'object') {
< 		if (x === null) return x;
< 		if (Array.isArray(x)) return x.map(deepClone) as T;
< 		const obj = {} as Record<string, Cloneable>;
< 		for (const [k, v] of Object.entries(x)) {
< 			obj[k] = deepClone(v);
< 		}
< 		return obj as T;
< 	} else {
< 		return x;
< 	}
---
>   if (typeof x === "object") {
>     if (x === null) return x;
>     if (Array.isArray(x)) return x.map(deepClone) as T;
>     const obj = {} as Record<string, Cloneable>;
>     for (const [k, v] of Object.entries(x)) {
>       obj[k] = deepClone(v);
>     }
>     return obj as T;
>   } else {
>     return x;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/collect-page-vars.ts RiricaV13/scripts/collect-page-vars.ts
1,67c1,47
< interface StringPageVar {
< 	name: string,
< 	type: 'string',
< 	value: string
< }
< 
< interface NumberPageVar {
< 	name: string,
< 	type: 'number',
< 	value: number
< }
< 
< interface BooleanPageVar {
< 	name: string,
< 	type: 'boolean',
< 	value: boolean
< }
< 
< type PageVar = StringPageVar | NumberPageVar | BooleanPageVar;
< 
< export function collectPageVars(content): PageVar[] {
< 	const pageVars: PageVar[] = [];
< 	const collect = (xs: any[]): void => {
< 		for (const x of xs) {
< 			if (x.type === 'textInput') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'string',
< 					value: x.default || '',
< 				});
< 			} else if (x.type === 'textareaInput') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'string',
< 					value: x.default || '',
< 				});
< 			} else if (x.type === 'numberInput') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'number',
< 					value: x.default || 0,
< 				});
< 			} else if (x.type === 'switch') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'boolean',
< 					value: x.default || false,
< 				});
< 			} else if (x.type === 'counter') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'number',
< 					value: 0,
< 				});
< 			} else if (x.type === 'radioButton') {
< 				pageVars.push({
< 					name: x.name,
< 					type: 'string',
< 					value: x.default || '',
< 				});
< 			} else if (x.children) {
< 				collect(x.children);
< 			}
< 		}
< 	};
< 	collect(content);
< 	return pageVars;
---
> export function collectPageVars(content) {
>   const pageVars = [];
>   const collect = (xs: any[]) => {
>     for (const x of xs) {
>       if (x.type === "textInput") {
>         pageVars.push({
>           name: x.name,
>           type: "string",
>           value: x.default || "",
>         });
>       } else if (x.type === "textareaInput") {
>         pageVars.push({
>           name: x.name,
>           type: "string",
>           value: x.default || "",
>         });
>       } else if (x.type === "numberInput") {
>         pageVars.push({
>           name: x.name,
>           type: "number",
>           value: x.default || 0,
>         });
>       } else if (x.type === "switch") {
>         pageVars.push({
>           name: x.name,
>           type: "boolean",
>           value: x.default || false,
>         });
>       } else if (x.type === "counter") {
>         pageVars.push({
>           name: x.name,
>           type: "number",
>           value: 0,
>         });
>       } else if (x.type === "radioButton") {
>         pageVars.push({
>           name: x.name,
>           type: "string",
>           value: x.default || "",
>         });
>       } else if (x.children) {
>         collect(x.children);
>       }
>     }
>   };
>   collect(content);
>   return pageVars;
Only in misskeyV13/packages/frontend/src/scripts: color.ts
Only in misskeyV13/packages/frontend/src/scripts: confetti.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/contains.ts RiricaV13/scripts/contains.ts
2,8c2,8
< 	if (checkSame && parent === child) return true;
< 	let node = child.parentNode;
< 	while (node) {
< 		if (node === parent) return true;
< 		node = node.parentNode;
< 	}
< 	return false;
---
>   if (checkSame && parent === child) return true;
>   let node = child.parentNode;
>   while (node) {
>     if (node === parent) return true;
>     node = node.parentNode;
>   }
>   return false;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/copy-to-clipboard.ts RiricaV13/scripts/copy-to-clipboard.ts
4,8c4,8
< export default val => {
< 	// 空div 生成
< 	const tmp = document.createElement('div');
< 	// 選択用のタグ生成
< 	const pre = document.createElement('pre');
---
> export default (val) => {
>   // 空div 生成
>   const tmp = document.createElement("div");
>   // 選択用のタグ生成
>   const pre = document.createElement("pre");
10,12c10,12
< 	// 親要素のCSSで user-select: none だとコピーできないので書き換える
< 	pre.style.webkitUserSelect = 'auto';
< 	pre.style.userSelect = 'auto';
---
>   // 親要素のCSSで user-select: none だとコピーできないので書き換える
>   pre.style.webkitUserSelect = "auto";
>   pre.style.userSelect = "auto";
14c14
< 	tmp.appendChild(pre).textContent = val;
---
>   tmp.appendChild(pre).textContent = val;
16,19c16,19
< 	// 要素を画面外へ
< 	const s = tmp.style;
< 	s.position = 'fixed';
< 	s.right = '200%';
---
>   // 要素を画面外へ
>   const s = tmp.style;
>   s.position = "fixed";
>   s.right = "200%";
21,24c21,24
< 	// body に追加
< 	document.body.appendChild(tmp);
< 	// 要素を選択
< 	document.getSelection().selectAllChildren(tmp);
---
>   // body に追加
>   document.body.appendChild(tmp);
>   // 要素を選択
>   document.getSelection().selectAllChildren(tmp);
26,27c26,27
< 	// クリップボードにコピー
< 	const result = document.execCommand('copy');
---
>   // クリップボードにコピー
>   const result = document.execCommand("copy");
29,30c29,30
< 	// 要素削除
< 	document.body.removeChild(tmp);
---
>   // 要素削除
>   document.body.removeChild(tmp);
32c32
< 	return result;
---
>   return result;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/device-kind.ts RiricaV13/scripts/device-kind.ts
1c1
< import { defaultStore } from '@/store';
---
> import { defaultStore } from "@/store";
4c4,6
< const isTablet = /ipad/.test(ua) || (/mobile|iphone|android/.test(ua) && window.innerWidth > 700);
---
> const isTablet =
>   /ipad/.test(ua) ||
>   (/mobile|iphone|android/.test(ua) && window.innerWidth > 700);
7,10c9,15
< export const deviceKind = defaultStore.state.overridedDeviceKind ? defaultStore.state.overridedDeviceKind
< 	: isSmartphone ? 'smartphone'
< 	: isTablet ? 'tablet'
< 	: 'desktop';
---
> export const deviceKind = defaultStore.state.overridedDeviceKind
>   ? defaultStore.state.overridedDeviceKind
>   : isSmartphone
>   ? "smartphone"
>   : isTablet
>   ? "tablet"
>   : "desktop";
Only in misskeyV13/packages/frontend/src/scripts: emoji-base.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/emojilist.ts RiricaV13/scripts/emojilist.ts
1c1,11
< export const unicodeEmojiCategories = ['face', 'people', 'animals_and_nature', 'food_and_drink', 'activity', 'travel_and_places', 'objects', 'symbols', 'flags'] as const;
---
> export const unicodeEmojiCategories = [
>   "face",
>   "people",
>   "animals_and_nature",
>   "food_and_drink",
>   "activity",
>   "travel_and_places",
>   "objects",
>   "symbols",
>   "flags",
> ] as const;
4,8c14,18
< 	name: string;
< 	keywords: string[];
< 	char: string;
< 	category: typeof unicodeEmojiCategories[number];
< }
---
>   name: string;
>   keywords: string[];
>   char: string;
>   category: typeof unicodeEmojiCategories[number];
> };
11c21
< import _emojilist from '../emojilist.json';
---
> import _emojilist from "../emojilist.json";
14,17d23
< 
< export function getEmojiName(char: string): string | undefined {
< 	return emojilist.find(emo => emo.char === char)?.name;
< }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/extract-avg-color-from-blurhash.ts RiricaV13/scripts/extract-avg-color-from-blurhash.ts
2,8c2,13
< 	return typeof hash === 'string'
< 		? '#' + [...hash.slice(2, 6)]
< 				.map(x => '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~'.indexOf(x))
< 				.reduce((a, c) => a * 83 + c, 0)
< 				.toString(16)
< 				.padStart(6, '0')
< 		: undefined;
---
>   return typeof hash === "string"
>     ? "#" +
>         [...hash.slice(2, 6)]
>           .map((x) =>
>             "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~".indexOf(
>               x
>             )
>           )
>           .reduce((a, c) => a * 83 + c, 0)
>           .toString(16)
>           .padStart(6, "0")
>     : undefined;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/extract-mentions.ts RiricaV13/scripts/extract-mentions.ts
3c3
< import * as mfm from 'mfm-js';
---
> import * as mfm from "mfm-js";
5,8c5,10
< export function extractMentions(nodes: mfm.MfmNode[]): mfm.MfmMention['props'][] {
< 	// TODO: 重複を削除
< 	const mentionNodes = mfm.extract(nodes, (node) => node.type === 'mention');
< 	const mentions = mentionNodes.map(x => x.props);
---
> export function extractMentions(
>   nodes: mfm.MfmNode[]
> ): mfm.MfmMention["props"][] {
>   // TODO: 重複を削除
>   const mentionNodes = mfm.extract(nodes, (node) => node.type === "mention");
>   const mentions = mentionNodes.map((x) => x.props);
10c12
< 	return mentions;
---
>   return mentions;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/extract-url-from-mfm.ts RiricaV13/scripts/extract-url-from-mfm.ts
1,2c1,2
< import * as mfm from 'mfm-js';
< import { unique } from '@/scripts/array';
---
> import * as mfm from "mfm-js";
> import { unique } from "@/scripts/array";
6c6
< const removeHash = (x: string) => x.replace(/#[^#]*$/, '');
---
> const removeHash = (x: string) => x.replace(/#[^#]*$/, "");
8,12c8,18
< export function extractUrlFromMfm(nodes: mfm.MfmNode[], respectSilentFlag = true): string[] {
< 	const urlNodes = mfm.extract(nodes, (node) => {
< 		return (node.type === 'url') || (node.type === 'link' && (!respectSilentFlag || !node.props.silent));
< 	});
< 	const urls: string[] = unique(urlNodes.map(x => x.props.url));
---
> export function extractUrlFromMfm(
>   nodes: mfm.MfmNode[],
>   respectSilentFlag = true
> ): string[] {
>   const urlNodes = mfm.extract(nodes, (node) => {
>     return (
>       node.type === "url" ||
>       (node.type === "link" && (!respectSilentFlag || !node.props.silent))
>     );
>   });
>   const urls: string[] = unique(urlNodes.map((x) => x.props.url));
14,18c20,25
< 	return urls.reduce((array, url) => {
< 		const urlWithoutHash = removeHash(url);
< 		if (!array.map(x => removeHash(x)).includes(urlWithoutHash)) array.push(url);
< 		return array;
< 	}, [] as string[]);
---
>   return urls.reduce((array, url) => {
>     const urlWithoutHash = removeHash(url);
>     if (!array.map((x) => removeHash(x)).includes(urlWithoutHash))
>       array.push(url);
>     return array;
>   }, [] as string[]);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/focus.ts RiricaV13/scripts/focus.ts
2,12c2,12
< 	if (el == null) return;
< 	if (!self) el = el.previousElementSibling;
< 	if (el) {
< 		if (el.hasAttribute('tabindex')) {
< 			(el as HTMLElement).focus({
< 				preventScroll: !scroll,
< 			});
< 		} else {
< 			focusPrev(el.previousElementSibling, true);
< 		}
< 	}
---
>   if (el == null) return;
>   if (!self) el = el.previousElementSibling;
>   if (el) {
>     if (el.hasAttribute("tabindex")) {
>       (el as HTMLElement).focus({
>         preventScroll: !scroll,
>       });
>     } else {
>       focusPrev(el.previousElementSibling, true);
>     }
>   }
16,26c16,26
< 	if (el == null) return;
< 	if (!self) el = el.nextElementSibling;
< 	if (el) {
< 		if (el.hasAttribute('tabindex')) {
< 			(el as HTMLElement).focus({
< 				preventScroll: !scroll,
< 			});
< 		} else {
< 			focusPrev(el.nextElementSibling, true);
< 		}
< 	}
---
>   if (el == null) return;
>   if (!self) el = el.nextElementSibling;
>   if (el) {
>     if (el.hasAttribute("tabindex")) {
>       (el as HTMLElement).focus({
>         preventScroll: !scroll,
>       });
>     } else {
>       focusPrev(el.nextElementSibling, true);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/form.ts RiricaV13/scripts/form.ts
1,43c1,50
< export type FormItem = {
< 	label?: string;
< 	type: 'string';
< 	default: string | null;
< 	hidden?: boolean;
< 	multiline?: boolean;
< } | {
< 	label?: string;
< 	type: 'number';
< 	default: number | null;
< 	hidden?: boolean;
< 	step?: number;
< } | {
< 	label?: string;
< 	type: 'boolean';
< 	default: boolean | null;
< 	hidden?: boolean;
< } | {
< 	label?: string;
< 	type: 'enum';
< 	default: string | null;
< 	hidden?: boolean;
< 	enum: string[];
< } | {
< 	label?: string;
< 	type: 'radio';
< 	default: unknown | null;
< 	hidden?: boolean;
< 	options: {
< 		label: string;
< 		value: unknown;
< 	}[];
< } | {
< 	label?: string;
< 	type: 'object';
< 	default: Record<string, unknown> | null;
< 	hidden: true;
< } | {
< 	label?: string;
< 	type: 'array';
< 	default: unknown[] | null;
< 	hidden: true;
< };
---
> export type FormItem =
>   | {
>       label?: string;
>       type: "string";
>       default: string | null;
>       hidden?: boolean;
>       multiline?: boolean;
>     }
>   | {
>       label?: string;
>       type: "number";
>       default: number | null;
>       hidden?: boolean;
>       step?: number;
>     }
>   | {
>       label?: string;
>       type: "boolean";
>       default: boolean | null;
>       hidden?: boolean;
>     }
>   | {
>       label?: string;
>       type: "enum";
>       default: string | null;
>       hidden?: boolean;
>       enum: string[];
>     }
>   | {
>       label?: string;
>       type: "radio";
>       default: unknown | null;
>       hidden?: boolean;
>       options: {
>         label: string;
>         value: unknown;
>       }[];
>     }
>   | {
>       label?: string;
>       type: "object";
>       default: Record<string, unknown> | null;
>       hidden: true;
>     }
>   | {
>       label?: string;
>       type: "array";
>       default: unknown[] | null;
>       hidden: true;
>     };
47,55c54,68
< type GetItemType<Item extends FormItem> =
< 	Item['type'] extends 'string' ? string :
< 	Item['type'] extends 'number' ? number :
< 	Item['type'] extends 'boolean' ? boolean :
< 	Item['type'] extends 'radio' ? unknown :
< 	Item['type'] extends 'enum' ? string :
< 	Item['type'] extends 'array' ? unknown[] :
< 	Item['type'] extends 'object' ? Record<string, unknown>
< 	: never;
---
> type GetItemType<Item extends FormItem> = Item["type"] extends "string"
>   ? string
>   : Item["type"] extends "number"
>   ? number
>   : Item["type"] extends "boolean"
>   ? boolean
>   : Item["type"] extends "radio"
>   ? unknown
>   : Item["type"] extends "enum"
>   ? string
>   : Item["type"] extends "array"
>   ? unknown[]
>   : Item["type"] extends "object"
>   ? Record<string, unknown>
>   : never;
58c71
< 	[P in keyof F]: GetItemType<F[P]>;
---
>   [P in keyof F]: GetItemType<F[P]>;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/format-time-string.ts RiricaV13/scripts/format-time-string.ts
1,10c1,10
< const defaultLocaleStringFormats: {[index: string]: string} = {
< 	'weekday': 'narrow',
< 	'era': 'narrow',
< 	'year': 'numeric',
< 	'month': 'numeric',
< 	'day': 'numeric',
< 	'hour': 'numeric',
< 	'minute': 'numeric',
< 	'second': 'numeric',
< 	'timeZoneName': 'short',
---
> const defaultLocaleStringFormats: { [index: string]: string } = {
>   weekday: "narrow",
>   era: "narrow",
>   year: "numeric",
>   month: "numeric",
>   day: "numeric",
>   hour: "numeric",
>   minute: "numeric",
>   second: "numeric",
>   timeZoneName: "short",
14,20c14,37
< 	return format.replace(/\{\{(\w+)(:(\w+))?\}\}/g, (match: string, kind: string, unused?, option?: string) => {
< 		if (['weekday', 'era', 'year', 'month', 'day', 'hour', 'minute', 'second', 'timeZoneName'].includes(kind)) {
< 			return date.toLocaleString(window.navigator.language, { [kind]: option ? option : defaultLocaleStringFormats[kind] });
< 		} else {
< 			return match;
< 		}
< 	});
---
>   return format.replace(
>     /\{\{(\w+)(:(\w+))?\}\}/g,
>     (match: string, kind: string, unused?, option?: string) => {
>       if (
>         [
>           "weekday",
>           "era",
>           "year",
>           "month",
>           "day",
>           "hour",
>           "minute",
>           "second",
>           "timeZoneName",
>         ].includes(kind)
>       ) {
>         return date.toLocaleString(window.navigator.language, {
>           [kind]: option ? option : defaultLocaleStringFormats[kind],
>         });
>       } else {
>         return match;
>       }
>     }
>   );
24,41c41,64
< 	return format
< 		.replace(/yyyy/g, date.getFullYear().toString())
< 		.replace(/yy/g, date.getFullYear().toString().slice(-2))
< 		.replace(/MMMM/g, date.toLocaleString(window.navigator.language, { month: 'long' }))
< 		.replace(/MMM/g, date.toLocaleString(window.navigator.language, { month: 'short' }))
< 		.replace(/MM/g, (`0${date.getMonth() + 1}`).slice(-2))
< 		.replace(/M/g, (date.getMonth() + 1).toString())
< 		.replace(/dd/g, (`0${date.getDate()}`).slice(-2))
< 		.replace(/d/g, date.getDate().toString())
< 		.replace(/HH/g, (`0${date.getHours()}`).slice(-2))
< 		.replace(/H/g, date.getHours().toString())
< 		.replace(/hh/g, (`0${(date.getHours() % 12) || 12}`).slice(-2))
< 		.replace(/h/g, ((date.getHours() % 12) || 12).toString())
< 		.replace(/mm/g, (`0${date.getMinutes()}`).slice(-2))
< 		.replace(/m/g, date.getMinutes().toString())
< 		.replace(/ss/g, (`0${date.getSeconds()}`).slice(-2))
< 		.replace(/s/g, date.getSeconds().toString())
< 		.replace(/tt/g, date.getHours() >= 12 ? 'PM' : 'AM');
---
>   return format
>     .replace(/yyyy/g, date.getFullYear().toString())
>     .replace(/yy/g, date.getFullYear().toString().slice(-2))
>     .replace(
>       /MMMM/g,
>       date.toLocaleString(window.navigator.language, { month: "long" })
>     )
>     .replace(
>       /MMM/g,
>       date.toLocaleString(window.navigator.language, { month: "short" })
>     )
>     .replace(/MM/g, `0${date.getMonth() + 1}`.slice(-2))
>     .replace(/M/g, (date.getMonth() + 1).toString())
>     .replace(/dd/g, `0${date.getDate()}`.slice(-2))
>     .replace(/d/g, date.getDate().toString())
>     .replace(/HH/g, `0${date.getHours()}`.slice(-2))
>     .replace(/H/g, date.getHours().toString())
>     .replace(/hh/g, `0${date.getHours() % 12 || 12}`.slice(-2))
>     .replace(/h/g, (date.getHours() % 12 || 12).toString())
>     .replace(/mm/g, `0${date.getMinutes()}`.slice(-2))
>     .replace(/m/g, date.getMinutes().toString())
>     .replace(/ss/g, `0${date.getSeconds()}`.slice(-2))
>     .replace(/s/g, date.getSeconds().toString())
>     .replace(/tt/g, date.getHours() >= 12 ? "PM" : "AM");
45,49c68,80
< 	return format.replace(/\[(([^\[]|\[\])*)\]|(([yMdHhmst])\4{0,3})/g, (match: string, localeformat?: string, unused?, datetimeformat?: string) => {
< 		if (localeformat) return formatLocaleString(date, localeformat);
< 		if (datetimeformat) return formatDateTimeString(date, datetimeformat);
< 		return match;
< 	});
---
>   return format.replace(
>     /\[(([^\[]|\[\])*)\]|(([yMdHhmst])\4{0,3})/g,
>     (
>       match: string,
>       localeformat?: string,
>       unused?,
>       datetimeformat?: string
>     ) => {
>       if (localeformat) return formatLocaleString(date, localeformat);
>       if (datetimeformat) return formatDateTimeString(date, datetimeformat);
>       return match;
>     }
>   );
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/gen-search-query.ts RiricaV13/scripts/gen-search-query.ts
1,2c1,2
< import * as Acct from 'misskey-js/built/acct';
< import { host as localHost } from '@/config';
---
> import * as Acct from "misskey-js/built/acct";
> import { host as localHost } from "@/config";
5,29c5,37
< 	let host: string;
< 	let userId: string;
< 	if (q.split(' ').some(x => x.startsWith('@'))) {
< 		for (const at of q.split(' ').filter(x => x.startsWith('@')).map(x => x.substr(1))) {
< 			if (at.includes('.')) {
< 				if (at === localHost || at === '.') {
< 					host = null;
< 				} else {
< 					host = at;
< 				}
< 			} else {
< 				const user = await v.os.api('users/show', Acct.parse(at)).catch(x => null);
< 				if (user) {
< 					userId = user.id;
< 				} else {
< 					// todo: show error
< 				}
< 			}
< 		}
< 	}
< 	return {
< 		query: q.split(' ').filter(x => !x.startsWith('/') && !x.startsWith('@')).join(' '),
< 		host: host,
< 		userId: userId,
< 	};
---
>   let host: string;
>   let userId: string;
>   if (q.split(" ").some((x) => x.startsWith("@"))) {
>     for (const at of q
>       .split(" ")
>       .filter((x) => x.startsWith("@"))
>       .map((x) => x.substr(1))) {
>       if (at.includes(".")) {
>         if (at === localHost || at === ".") {
>           host = null;
>         } else {
>           host = at;
>         }
>       } else {
>         const user = await v.os
>           .api("users/show", Acct.parse(at))
>           .catch((x) => null);
>         if (user) {
>           userId = user.id;
>         } else {
>           // todo: show error
>         }
>       }
>     }
>   }
>   return {
>     query: q
>       .split(" ")
>       .filter((x) => !x.startsWith("/") && !x.startsWith("@"))
>       .join(" "),
>     host: host,
>     userId: userId,
>   };
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/get-account-from-id.ts RiricaV13/scripts/get-account-from-id.ts
1c1
< import { get } from '@/scripts/idb-proxy';
---
> import { get } from "@/scripts/idb-proxy";
4,6c4,6
< 	const accounts = await get('accounts') as { token: string; id: string; }[];
< 	if (!accounts) console.log('Accounts are not recorded');
< 	return accounts.find(account => account.id === id);
---
>   const accounts = (await get("accounts")) as { token: string; id: string }[];
>   if (!accounts) console.log("Accounts are not recorded");
>   return accounts.find((account) => account.id === id);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/get-note-menu.ts RiricaV13/scripts/get-note-menu.ts
1,13c1,11
< import { defineAsyncComponent, Ref, inject } from 'vue';
< import * as misskey from 'misskey-js';
< import { pleaseLogin } from './please-login';
< import { claimAchievement } from './achievements';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { instance } from '@/instance';
< import * as os from '@/os';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { url } from '@/config';
< import { noteActions } from '@/store';
< import { notePage } from '@/filters/note';
< import { miLocalStorage } from '@/local-storage';
---
> import { defineAsyncComponent, Ref, inject } from "vue";
> import * as misskey from "misskey-js";
> import { pleaseLogin } from "./please-login";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import * as os from "@/os";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { url } from "@/config";
> import { noteActions } from "@/store";
> import { notePage } from "@/filters/note";
16,21c14,19
< 	note: misskey.entities.Note;
< 	menuButton: Ref<HTMLElement>;
< 	translation: Ref<any>;
< 	translating: Ref<boolean>;
< 	isDeleted: Ref<boolean>;
< 	currentClipPage?: Ref<misskey.entities.Clip>;
---
>   note: misskey.entities.Note;
>   menuButton: Ref<HTMLElement>;
>   translation: Ref<any>;
>   translating: Ref<boolean>;
>   isDeleted: Ref<boolean>;
>   currentClipPage?: Ref<misskey.entities.Clip>;
23,28c21,25
< 	const isRenote = (
< 		props.note.renote != null &&
< 		props.note.text == null &&
< 		props.note.fileIds.length === 0 &&
< 		props.note.poll == null
< 	);
---
>   const isRenote =
>     props.note.renote != null &&
>     props.note.text == null &&
>     props.note.fileIds.length === 0 &&
>     props.note.poll == null;
30c27,29
< 	const appearNote = isRenote ? props.note.renote as misskey.entities.Note : props.note;
---
>   const appearNote = isRenote
>     ? (props.note.renote as misskey.entities.Note)
>     : props.note;
32,37c31,36
< 	function del(): void {
< 		os.confirm({
< 			type: 'warning',
< 			text: i18n.ts.noteDeleteConfirm,
< 		}).then(({ canceled }) => {
< 			if (canceled) return;
---
>   function del(): void {
>     os.confirm({
>       type: "warning",
>       text: i18n.ts.noteDeleteConfirm,
>     }).then(({ canceled }) => {
>       if (canceled) return;
39,41c38,42
< 			os.api('notes/delete', {
< 				noteId: appearNote.id,
< 			});
---
>       os.api("notes/delete", {
>         noteId: appearNote.id,
>       });
>     });
>   }
43,47c44,49
< 			if (Date.now() - new Date(appearNote.createdAt).getTime() < 1000 * 60) {
< 				claimAchievement('noteDeletedWithin1min');
< 			}
< 		});
< 	}
---
>   function delEdit(): void {
>     os.confirm({
>       type: "warning",
>       text: i18n.ts.deleteAndEditConfirm,
>     }).then(({ canceled }) => {
>       if (canceled) return;
49,54c51,53
< 	function delEdit(): void {
< 		os.confirm({
< 			type: 'warning',
< 			text: i18n.ts.deleteAndEditConfirm,
< 		}).then(({ canceled }) => {
< 			if (canceled) return;
---
>       os.api("notes/delete", {
>         noteId: appearNote.id,
>       });
56,58c55,62
< 			os.api('notes/delete', {
< 				noteId: appearNote.id,
< 			});
---
>       os.post({
>         initialNote: appearNote,
>         renote: appearNote.renote,
>         reply: appearNote.reply,
>         channel: appearNote.channel,
>       });
>     });
>   }
60c64,71
< 			os.post({ initialNote: appearNote, renote: appearNote.renote, reply: appearNote.reply, channel: appearNote.channel });
---
>   function toggleFavorite(favorite: boolean): void {
>     os.apiWithDialog(
>       favorite ? "notes/favorites/create" : "notes/favorites/delete",
>       {
>         noteId: appearNote.id,
>       }
>     );
>   }
62,66c73,80
< 			if (Date.now() - new Date(appearNote.createdAt).getTime() < 1000 * 60) {
< 				claimAchievement('noteDeletedWithin1min');
< 			}
< 		});
< 	}
---
>   function toggleThreadMute(mute: boolean): void {
>     os.apiWithDialog(
>       mute ? "notes/thread-muting/create" : "notes/thread-muting/delete",
>       {
>         noteId: appearNote.id,
>       }
>     );
>   }
68,73c82,85
< 	function toggleFavorite(favorite: boolean): void {
< 		claimAchievement('noteFavorited1');
< 		os.apiWithDialog(favorite ? 'notes/favorites/create' : 'notes/favorites/delete', {
< 			noteId: appearNote.id,
< 		});
< 	}
---
>   function copyContent(): void {
>     copyToClipboard(appearNote.text);
>     os.success();
>   }
75,79c87,90
< 	function toggleThreadMute(mute: boolean): void {
< 		os.apiWithDialog(mute ? 'notes/thread-muting/create' : 'notes/thread-muting/delete', {
< 			noteId: appearNote.id,
< 		});
< 	}
---
>   function copyLink(): void {
>     copyToClipboard(`${url}/notes/${appearNote.id}`);
>     os.success();
>   }
81,84c92,109
< 	function copyContent(): void {
< 		copyToClipboard(appearNote.text);
< 		os.success();
< 	}
---
>   function togglePin(pin: boolean): void {
>     os.apiWithDialog(
>       pin ? "i/pin" : "i/unpin",
>       {
>         noteId: appearNote.id,
>       },
>       undefined,
>       null,
>       (res) => {
>         if (res.id === "72dab508-c64d-498f-8740-a8eec1ba385a") {
>           os.alert({
>             type: "error",
>             text: i18n.ts.pinLimitExceeded,
>           });
>         }
>       }
>     );
>   }
86,89c111,136
< 	function copyLink(): void {
< 		copyToClipboard(`${url}/notes/${appearNote.id}`);
< 		os.success();
< 	}
---
>   async function clip(): Promise<void> {
>     const clips = await os.api("clips/list");
>     os.popupMenu(
>       [
>         {
>           icon: "fas fa-plus",
>           text: i18n.ts.createNew,
>           action: async () => {
>             const { canceled, result } = await os.form(i18n.ts.createNewClip, {
>               name: {
>                 type: "string",
>                 label: i18n.ts.name,
>               },
>               description: {
>                 type: "string",
>                 required: false,
>                 multiline: true,
>                 label: i18n.ts.description,
>               },
>               isPublic: {
>                 type: "boolean",
>                 label: i18n.ts.public,
>                 default: false,
>               },
>             });
>             if (canceled) return;
91,102c138
< 	function togglePin(pin: boolean): void {
< 		os.apiWithDialog(pin ? 'i/pin' : 'i/unpin', {
< 			noteId: appearNote.id,
< 		}, undefined, null, res => {
< 			if (res.id === '72dab508-c64d-498f-8740-a8eec1ba385a') {
< 				os.alert({
< 					type: 'error',
< 					text: i18n.ts.pinLimitExceeded,
< 				});
< 			}
< 		});
< 	}
---
>             const clip = await os.apiWithDialog("clips/create", result);
104,127c140,186
< 	async function clip(): Promise<void> {
< 		const clips = await os.api('clips/list');
< 		os.popupMenu([{
< 			icon: 'ti ti-plus',
< 			text: i18n.ts.createNew,
< 			action: async () => {
< 				const { canceled, result } = await os.form(i18n.ts.createNewClip, {
< 					name: {
< 						type: 'string',
< 						label: i18n.ts.name,
< 					},
< 					description: {
< 						type: 'string',
< 						required: false,
< 						multiline: true,
< 						label: i18n.ts.description,
< 					},
< 					isPublic: {
< 						type: 'boolean',
< 						label: i18n.ts.public,
< 						default: false,
< 					},
< 				});
< 				if (canceled) return;
---
>             os.apiWithDialog("clips/add-note", {
>               clipId: clip.id,
>               noteId: appearNote.id,
>             });
>           },
>         },
>         null,
>         ...clips.map((clip) => ({
>           text: clip.name,
>           action: () => {
>             os.promiseDialog(
>               os.api("clips/add-note", {
>                 clipId: clip.id,
>                 noteId: appearNote.id,
>               }),
>               null,
>               async (err) => {
>                 if (err.id === "734806c4-542c-463a-9311-15c512803965") {
>                   const confirm = await os.confirm({
>                     type: "warning",
>                     text: i18n.t("confirmToUnclipAlreadyClippedNote", {
>                       name: clip.name,
>                     }),
>                   });
>                   if (!confirm.canceled) {
>                     os.apiWithDialog("clips/remove-note", {
>                       clipId: clip.id,
>                       noteId: appearNote.id,
>                     });
>                     if (props.currentClipPage?.value.id === clip.id)
>                       props.isDeleted.value = true;
>                   }
>                 } else {
>                   os.alert({
>                     type: "error",
>                     text: err.message + "\n" + err.id,
>                   });
>                 }
>               }
>             );
>           },
>         })),
>       ],
>       props.menuButton.value,
>       {}
>     ).then(focus);
>   }
129c188,194
< 				const clip = await os.apiWithDialog('clips/create', result);
---
>   async function unclip(): Promise<void> {
>     os.apiWithDialog("clips/remove-note", {
>       clipId: props.currentClipPage.value.id,
>       noteId: appearNote.id,
>     });
>     props.isDeleted.value = true;
>   }
131,162c196,199
< 				claimAchievement('noteClipped1');
< 				os.apiWithDialog('clips/add-note', { clipId: clip.id, noteId: appearNote.id });
< 			},
< 		}, null, ...clips.map(clip => ({
< 			text: clip.name,
< 			action: () => {
< 				claimAchievement('noteClipped1');
< 				os.promiseDialog(
< 					os.api('clips/add-note', { clipId: clip.id, noteId: appearNote.id }),
< 					null,
< 					async (err) => {
< 						if (err.id === '734806c4-542c-463a-9311-15c512803965') {
< 							const confirm = await os.confirm({
< 								type: 'warning',
< 								text: i18n.t('confirmToUnclipAlreadyClippedNote', { name: clip.name }),
< 							});
< 							if (!confirm.canceled) {
< 								os.apiWithDialog('clips/remove-note', { clipId: clip.id, noteId: appearNote.id });
< 								if (props.currentClipPage?.value.id === clip.id) props.isDeleted.value = true;
< 							}
< 						} else {
< 							os.alert({
< 								type: 'error',
< 								text: err.message + '\n' + err.id,
< 							});
< 						}
< 					},
< 				);
< 			},
< 		}))], props.menuButton.value, {
< 		}).then(focus);
< 	}
---
>   async function promote(): Promise<void> {
>     const { canceled, result: days } = await os.inputNumber({
>       title: i18n.ts.numberOfDays,
>     });
164,167c201
< 	async function unclip(): Promise<void> {
< 		os.apiWithDialog('clips/remove-note', { clipId: props.currentClipPage.value.id, noteId: appearNote.id });
< 		props.isDeleted.value = true;
< 	}
---
>     if (canceled) return;
169,172c203,207
< 	async function promote(): Promise<void> {
< 		const { canceled, result: days } = await os.inputNumber({
< 			title: i18n.ts.numberOfDays,
< 		});
---
>     os.apiWithDialog("admin/promo/create", {
>       noteId: appearNote.id,
>       expiresAt: Date.now() + 86400000 * days,
>     });
>   }
174c209,228
< 		if (canceled) return;
---
>   function share(): void {
>     navigator.share({
>       title: i18n.t("noteOf", { user: appearNote.user.name }),
>       text: appearNote.text,
>       url: `${url}/notes/${appearNote.id}`,
>     });
>   }
>   function notedetails(): void {
>     os.pageWindow(`/notes/${appearNote.id}`);
>   }
>   async function translate(): Promise<void> {
>     if (props.translation.value != null) return;
>     props.translating.value = true;
>     const res = await os.api("notes/translate", {
>       noteId: appearNote.id,
>       targetLang: localStorage.getItem("lang") || navigator.language,
>     });
>     props.translating.value = false;
>     props.translation.value = res;
>   }
176,180c230,234
< 		os.apiWithDialog('admin/promo/create', {
< 			noteId: appearNote.id,
< 			expiresAt: Date.now() + (86400000 * days),
< 		});
< 	}
---
>   let menu;
>   if ($i) {
>     const statePromise = os.api("notes/state", {
>       noteId: appearNote.id,
>     });
182,291c236,329
< 	function share(): void {
< 		navigator.share({
< 			title: i18n.t('noteOf', { user: appearNote.user.name }),
< 			text: appearNote.text,
< 			url: `${url}/notes/${appearNote.id}`,
< 		});
< 	}
< 
< 	function openDetail(): void {
< 		os.pageWindow(`/notes/${appearNote.id}`);
< 	}
< 
< 	function showReactions(): void {
< 		os.popup(defineAsyncComponent(() => import('@/components/MkReactedUsersDialog.vue')), {
< 			noteId: appearNote.id,
< 		}, {}, 'closed');
< 	}
< 
< 	async function translate(): Promise<void> {
< 		if (props.translation.value != null) return;
< 		props.translating.value = true;
< 		const res = await os.api('notes/translate', {
< 			noteId: appearNote.id,
< 			targetLang: miLocalStorage.getItem('lang') || navigator.language,
< 		});
< 		props.translating.value = false;
< 		props.translation.value = res;
< 	}
< 
< 	let menu;
< 	if ($i) {
< 		const statePromise = os.api('notes/state', {
< 			noteId: appearNote.id,
< 		});
< 
< 		menu = [
< 			...(
< 				props.currentClipPage?.value.userId === $i.id ? [{
< 					icon: 'ti ti-backspace',
< 					text: i18n.ts.unclip,
< 					danger: true,
< 					action: unclip,
< 				}, null] : []
< 			), {
< 				icon: 'ti ti-info-circle',
< 				text: i18n.ts.details,
< 				action: openDetail,
< 			}, {
< 				icon: 'ti ti-users',
< 				text: i18n.ts.reactions,
< 				action: showReactions,
< 			}, {
< 				icon: 'ti ti-copy',
< 				text: i18n.ts.copyContent,
< 				action: copyContent,
< 			}, {
< 				icon: 'ti ti-link',
< 				text: i18n.ts.copyLink,
< 				action: copyLink,
< 			}, (appearNote.url || appearNote.uri) ? {
< 				icon: 'ti ti-external-link',
< 				text: i18n.ts.showOnRemote,
< 				action: () => {
< 					window.open(appearNote.url || appearNote.uri, '_blank');
< 				},
< 			} : undefined,
< 			{
< 				icon: 'ti ti-share',
< 				text: i18n.ts.share,
< 				action: share,
< 			},
< 			instance.translatorAvailable ? {
< 				icon: 'ti ti-language-hiragana',
< 				text: i18n.ts.translate,
< 				action: translate,
< 			} : undefined,
< 			null,
< 			statePromise.then(state => state.isFavorited ? {
< 				icon: 'ti ti-star-off',
< 				text: i18n.ts.unfavorite,
< 				action: () => toggleFavorite(false),
< 			} : {
< 				icon: 'ti ti-star',
< 				text: i18n.ts.favorite,
< 				action: () => toggleFavorite(true),
< 			}),
< 			{
< 				icon: 'ti ti-paperclip',
< 				text: i18n.ts.clip,
< 				action: () => clip(),
< 			},
< 			statePromise.then(state => state.isMutedThread ? {
< 				icon: 'ti ti-message-off',
< 				text: i18n.ts.unmuteThread,
< 				action: () => toggleThreadMute(false),
< 			} : {
< 				icon: 'ti ti-message-off',
< 				text: i18n.ts.muteThread,
< 				action: () => toggleThreadMute(true),
< 			}),
< 			appearNote.userId === $i.id ? ($i.pinnedNoteIds || []).includes(appearNote.id) ? {
< 				icon: 'ti ti-pinned-off',
< 				text: i18n.ts.unpin,
< 				action: () => togglePin(false),
< 			} : {
< 				icon: 'ti ti-pin',
< 				text: i18n.ts.pin,
< 				action: () => togglePin(true),
< 			} : undefined,
< 			/*
---
>     menu = [
>       ...(props.currentClipPage?.value.userId === $i.id
>         ? [
>             {
>               icon: "fas fa-circle-minus",
>               text: i18n.ts.unclip,
>               danger: true,
>               action: unclip,
>             },
>             null,
>           ]
>         : []),
>       {
>         icon: "fas fa-external-link-alt",
>         text: i18n.ts.details,
>         action: notedetails,
>       },
>       {
>         icon: "fas fa-copy",
>         text: i18n.ts.copyContent,
>         action: copyContent,
>       },
>       {
>         icon: "fas fa-link",
>         text: i18n.ts.copyLink,
>         action: copyLink,
>       },
>       appearNote.url || appearNote.uri
>         ? {
>             icon: "fas fa-external-link-square-alt",
>             text: i18n.ts.showOnRemote,
>             action: () => {
>               window.open(appearNote.url || appearNote.uri, "_blank");
>             },
>           }
>         : undefined,
>       {
>         icon: "fas fa-share-alt",
>         text: i18n.ts.share,
>         action: share,
>       },
>       instance.translatorAvailable
>         ? {
>             icon: "fas fa-language",
>             text: i18n.ts.translate,
>             action: translate,
>           }
>         : undefined,
>       null,
>       statePromise.then((state) =>
>         state.isFavorited
>           ? {
>               icon: "fas fa-star",
>               text: i18n.ts.unfavorite,
>               action: () => toggleFavorite(false),
>             }
>           : {
>               icon: "fas fa-star",
>               text: i18n.ts.favorite,
>               action: () => toggleFavorite(true),
>             }
>       ),
>       {
>         icon: "fas fa-paperclip",
>         text: i18n.ts.clip,
>         action: () => clip(),
>       },
>       statePromise.then((state) =>
>         state.isMutedThread
>           ? {
>               icon: "fas fa-comment-slash",
>               text: i18n.ts.unmuteThread,
>               action: () => toggleThreadMute(false),
>             }
>           : {
>               icon: "fas fa-comment-slash",
>               text: i18n.ts.muteThread,
>               action: () => toggleThreadMute(true),
>             }
>       ),
>       appearNote.userId === $i.id
>         ? ($i.pinnedNoteIds || []).includes(appearNote.id)
>           ? {
>               icon: "fas fa-thumbtack",
>               text: i18n.ts.unpin,
>               action: () => togglePin(false),
>             }
>           : {
>               icon: "fas fa-thumbtack",
>               text: i18n.ts.pin,
>               action: () => togglePin(true),
>             }
>         : undefined,
>       /*
301,353c339,411
< 			...(appearNote.userId !== $i.id ? [
< 				null,
< 				{
< 					icon: 'ti ti-exclamation-circle',
< 					text: i18n.ts.reportAbuse,
< 					action: () => {
< 						const u = appearNote.url || appearNote.uri || `${url}/notes/${appearNote.id}`;
< 						os.popup(defineAsyncComponent(() => import('@/components/MkAbuseReportWindow.vue')), {
< 							user: appearNote.user,
< 							initialComment: `Note: ${u}\n-----\n`,
< 						}, {}, 'closed');
< 					},
< 				}]
< 			: []
< 			),
< 			...(appearNote.userId === $i.id || $i.isModerator || $i.isAdmin ? [
< 				null,
< 				appearNote.userId === $i.id ? {
< 					icon: 'ti ti-edit',
< 					text: i18n.ts.deleteAndEdit,
< 					action: delEdit,
< 				} : undefined,
< 				{
< 					icon: 'ti ti-trash',
< 					text: i18n.ts.delete,
< 					danger: true,
< 					action: del,
< 				}]
< 			: []
< 			)]
< 			.filter(x => x !== undefined);
< 	} else {
< 		menu = [{
< 			icon: 'ti ti-external-link',
< 			text: i18n.ts.detailed,
< 			action: openDetail,
< 		}, {
< 			icon: 'ti ti-copy',
< 			text: i18n.ts.copyContent,
< 			action: copyContent,
< 		}, {
< 			icon: 'ti ti-link',
< 			text: i18n.ts.copyLink,
< 			action: copyLink,
< 		}, (appearNote.url || appearNote.uri) ? {
< 			icon: 'ti ti-external-link',
< 			text: i18n.ts.showOnRemote,
< 			action: () => {
< 				window.open(appearNote.url || appearNote.uri, '_blank');
< 			},
< 		} : undefined]
< 			.filter(x => x !== undefined);
< 	}
---
>       ...(appearNote.userId !== $i.id
>         ? [
>             null,
>             {
>               icon: "fas fa-exclamation-circle",
>               text: i18n.ts.reportAbuse,
>               action: () => {
>                 const u =
>                   appearNote.url ||
>                   appearNote.uri ||
>                   `${url}/notes/${appearNote.id}`;
>                 os.popup(
>                   defineAsyncComponent(
>                     () => import("@/components/MkAbuseReportWindow.vue")
>                   ),
>                   {
>                     user: appearNote.user,
>                     initialComment: `Note: ${u}\n-----\n`,
>                   },
>                   {},
>                   "closed"
>                 );
>               },
>             },
>           ]
>         : []),
>       ...(appearNote.userId === $i.id || $i.isModerator || $i.isAdmin
>         ? [
>             null,
>             appearNote.userId === $i.id
>               ? {
>                   icon: "fas fa-edit",
>                   text: i18n.ts.deleteAndEdit,
>                   action: delEdit,
>                 }
>               : undefined,
>             {
>               icon: "fas fa-trash-alt",
>               text: i18n.ts.delete,
>               danger: true,
>               action: del,
>             },
>           ]
>         : []),
>     ].filter((x) => x !== undefined);
>   } else {
>     menu = [
>       {
>         icon: "fas fa-external-link-alt",
>         text: i18n.ts.detailed,
>         action: openDetail,
>       },
>       {
>         icon: "fas fa-copy",
>         text: i18n.ts.copyContent,
>         action: copyContent,
>       },
>       {
>         icon: "fas fa-link",
>         text: i18n.ts.copyLink,
>         action: copyLink,
>       },
>       appearNote.url || appearNote.uri
>         ? {
>             icon: "fas fa-external-link-square-alt",
>             text: i18n.ts.showOnRemote,
>             action: () => {
>               window.open(appearNote.url || appearNote.uri, "_blank");
>             },
>           }
>         : undefined,
>     ].filter((x) => x !== undefined);
>   }
355,363c413,424
< 	if (noteActions.length > 0) {
< 		menu = menu.concat([null, ...noteActions.map(action => ({
< 			icon: 'ti ti-plug',
< 			text: action.title,
< 			action: () => {
< 				action.handler(appearNote);
< 			},
< 		}))]);
< 	}
---
>   if (noteActions.length > 0) {
>     menu = menu.concat([
>       null,
>       ...noteActions.map((action) => ({
>         icon: "fas fa-plug",
>         text: action.title,
>         action: () => {
>           action.handler(appearNote);
>         },
>       })),
>     ]);
>   }
365c426
< 	return menu;
---
>   return menu;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/get-note-summary.ts RiricaV13/scripts/get-note-summary.ts
1,2c1,2
< import * as misskey from 'misskey-js';
< import { i18n } from '@/i18n';
---
> import * as misskey from "misskey-js";
> import { i18n } from "@/i18n";
9,11c9,11
< 	if (note.deletedAt) {
< 		return `(${i18n.ts.deletedNote})`;
< 	}
---
>   if (note.deletedAt) {
>     return `(${i18n.ts.deletedNote})`;
>   }
13,15c13,15
< 	if (note.isHidden) {
< 		return `(${i18n.ts.invisibleNote})`;
< 	}
---
>   if (note.isHidden) {
>     return `(${i18n.ts.invisibleNote})`;
>   }
17c17
< 	let summary = '';
---
>   let summary = "";
19,24c19,24
< 	// 本文
< 	if (note.cw != null) {
< 		summary += note.cw;
< 	} else {
< 		summary += note.text ? note.text : '';
< 	}
---
>   // 本文
>   if (note.cw != null) {
>     summary += note.cw;
>   } else {
>     summary += note.text ? note.text : "";
>   }
26,29c26,29
< 	// ファイルが添付されているとき
< 	if ((note.files || []).length !== 0) {
< 		summary += ` (${i18n.t('withNFiles', { n: note.files.length })})`;
< 	}
---
>   // ファイルが添付されているとき
>   if ((note.files || []).length !== 0) {
>     summary += ` (${i18n.t("withNFiles", { n: note.files.length })})`;
>   }
31,34c31,34
< 	// 投票が添付されているとき
< 	if (note.poll) {
< 		summary += ` (${i18n.ts.poll})`;
< 	}
---
>   // 投票が添付されているとき
>   if (note.poll) {
>     summary += ` (${i18n.ts.poll})`;
>   }
36,43c36,43
< 	// 返信のとき
< 	if (note.replyId) {
< 		if (note.reply) {
< 			summary += `\n\nRE: ${getNoteSummary(note.reply)}`;
< 		} else {
< 			summary += '\n\nRE: ...';
< 		}
< 	}
---
>   // 返信のとき
>   if (note.replyId) {
>     if (note.reply) {
>       summary += `\n\nRE: ${getNoteSummary(note.reply)}`;
>     } else {
>       summary += "\n\nRE: ...";
>     }
>   }
45,52c45,52
< 	// Renoteのとき
< 	if (note.renoteId) {
< 		if (note.renote) {
< 			summary += `\n\nRN: ${getNoteSummary(note.renote)}`;
< 		} else {
< 			summary += '\n\nRN: ...';
< 		}
< 	}
---
>   // Renoteのとき
>   if (note.renoteId) {
>     if (note.renote) {
>       summary += `\n\nRN: ${getNoteSummary(note.renote)}`;
>     } else {
>       summary += "\n\nRN: ...";
>     }
>   }
54c54
< 	return summary.trim();
---
>   return summary.trim();
Only in RiricaV13/scripts: get-static-image-url.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/get-user-menu.ts RiricaV13/scripts/get-user-menu.ts
1,10c1,10
< import * as Acct from 'misskey-js/built/acct';
< import { defineAsyncComponent } from 'vue';
< import { i18n } from '@/i18n';
< import copyToClipboard from '@/scripts/copy-to-clipboard';
< import { host } from '@/config';
< import * as os from '@/os';
< import { userActions } from '@/store';
< import { $i, iAmModerator } from '@/account';
< import { mainRouter } from '@/router';
< import { Router } from '@/nirax';
---
> import * as Acct from "misskey-js/built/acct";
> import { defineAsyncComponent } from "vue";
> import { i18n } from "@/i18n";
> import copyToClipboard from "@/scripts/copy-to-clipboard";
> import { host } from "@/config";
> import * as os from "@/os";
> import { userActions } from "@/store";
> import { $i, iAmModerator } from "@/account";
> import { mainRouter } from "@/router";
> import { Router } from "@/nirax";
13c13
< 	const meId = $i ? $i.id : null;
---
>   const meId = $i ? $i.id : null;
15,36c15,37
< 	async function pushList() {
< 		const t = i18n.ts.selectList; // なぜか後で参照すると null になるので最初にメモリに確保しておく
< 		const lists = await os.api('users/lists/list');
< 		if (lists.length === 0) {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts.youHaveNoLists,
< 			});
< 			return;
< 		}
< 		const { canceled, result: listId } = await os.select({
< 			title: t,
< 			items: lists.map(list => ({
< 				value: list.id, text: list.name,
< 			})),
< 		});
< 		if (canceled) return;
< 		os.apiWithDialog('users/lists/push', {
< 			listId: listId,
< 			userId: user.id,
< 		});
< 	}
---
>   async function pushList() {
>     const t = i18n.ts.selectList; // なぜか後で参照すると null になるので最初にメモリに確保しておく
>     const lists = await os.api("users/lists/list");
>     if (lists.length === 0) {
>       os.alert({
>         type: "error",
>         text: i18n.ts.youHaveNoLists,
>       });
>       return;
>     }
>     const { canceled, result: listId } = await os.select({
>       title: t,
>       items: lists.map((list) => ({
>         value: list.id,
>         text: list.name,
>       })),
>     });
>     if (canceled) return;
>     os.apiWithDialog("users/lists/push", {
>       listId: listId,
>       userId: user.id,
>     });
>   }
38,58c39,60
< 	async function inviteGroup() {
< 		const groups = await os.api('users/groups/owned');
< 		if (groups.length === 0) {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts.youHaveNoGroups,
< 			});
< 			return;
< 		}
< 		const { canceled, result: groupId } = await os.select({
< 			title: i18n.ts.group,
< 			items: groups.map(group => ({
< 				value: group.id, text: group.name,
< 			})),
< 		});
< 		if (canceled) return;
< 		os.apiWithDialog('users/groups/invite', {
< 			groupId: groupId,
< 			userId: user.id,
< 		});
< 	}
---
>   async function inviteGroup() {
>     const groups = await os.api("users/groups/owned");
>     if (groups.length === 0) {
>       os.alert({
>         type: "error",
>         text: i18n.ts.youHaveNoGroups,
>       });
>       return;
>     }
>     const { canceled, result: groupId } = await os.select({
>       title: i18n.ts.group,
>       items: groups.map((group) => ({
>         value: group.id,
>         text: group.name,
>       })),
>     });
>     if (canceled) return;
>     os.apiWithDialog("users/groups/invite", {
>       groupId: groupId,
>       userId: user.id,
>     });
>   }
60,83c62,96
< 	async function toggleMute() {
< 		if (user.isMuted) {
< 			os.apiWithDialog('mute/delete', {
< 				userId: user.id,
< 			}).then(() => {
< 				user.isMuted = false;
< 			});
< 		} else {
< 			const { canceled, result: period } = await os.select({
< 				title: i18n.ts.mutePeriod,
< 				items: [{
< 					value: 'indefinitely', text: i18n.ts.indefinitely,
< 				}, {
< 					value: 'tenMinutes', text: i18n.ts.tenMinutes,
< 				}, {
< 					value: 'oneHour', text: i18n.ts.oneHour,
< 				}, {
< 					value: 'oneDay', text: i18n.ts.oneDay,
< 				}, {
< 					value: 'oneWeek', text: i18n.ts.oneWeek,
< 				}],
< 				default: 'indefinitely',
< 			});
< 			if (canceled) return;
---
>   async function toggleMute() {
>     if (user.isMuted) {
>       os.apiWithDialog("mute/delete", {
>         userId: user.id,
>       }).then(() => {
>         user.isMuted = false;
>       });
>     } else {
>       const { canceled, result: period } = await os.select({
>         title: i18n.ts.mutePeriod,
>         items: [
>           {
>             value: "indefinitely",
>             text: i18n.ts.indefinitely,
>           },
>           {
>             value: "tenMinutes",
>             text: i18n.ts.tenMinutes,
>           },
>           {
>             value: "oneHour",
>             text: i18n.ts.oneHour,
>           },
>           {
>             value: "oneDay",
>             text: i18n.ts.oneDay,
>           },
>           {
>             value: "oneWeek",
>             text: i18n.ts.oneWeek,
>           },
>         ],
>         default: "indefinitely",
>       });
>       if (canceled) return;
85,90c98,109
< 			const expiresAt = period === 'indefinitely' ? null
< 				: period === 'tenMinutes' ? Date.now() + (1000 * 60 * 10)
< 				: period === 'oneHour' ? Date.now() + (1000 * 60 * 60)
< 				: period === 'oneDay' ? Date.now() + (1000 * 60 * 60 * 24)
< 				: period === 'oneWeek' ? Date.now() + (1000 * 60 * 60 * 24 * 7)
< 				: null;
---
>       const expiresAt =
>         period === "indefinitely"
>           ? null
>           : period === "tenMinutes"
>           ? Date.now() + 1000 * 60 * 10
>           : period === "oneHour"
>           ? Date.now() + 1000 * 60 * 60
>           : period === "oneDay"
>           ? Date.now() + 1000 * 60 * 60 * 24
>           : period === "oneWeek"
>           ? Date.now() + 1000 * 60 * 60 * 24 * 7
>           : null;
92,99c111,118
< 			os.apiWithDialog('mute/create', {
< 				userId: user.id,
< 				expiresAt,
< 			}).then(() => {
< 				user.isMuted = true;
< 			});
< 		}
< 	}
---
>       os.apiWithDialog("mute/create", {
>         userId: user.id,
>         expiresAt,
>       }).then(() => {
>         user.isMuted = true;
>       });
>     }
>   }
101,102c120,126
< 	async function toggleBlock() {
< 		if (!await getConfirmed(user.isBlocking ? i18n.ts.unblockConfirm : i18n.ts.blockConfirm)) return;
---
>   async function toggleBlock() {
>     if (
>       !(await getConfirmed(
>         user.isBlocking ? i18n.ts.unblockConfirm : i18n.ts.blockConfirm
>       ))
>     )
>       return;
104,109c128,133
< 		os.apiWithDialog(user.isBlocking ? 'blocking/delete' : 'blocking/create', {
< 			userId: user.id,
< 		}).then(() => {
< 			user.isBlocking = !user.isBlocking;
< 		});
< 	}
---
>     os.apiWithDialog(user.isBlocking ? "blocking/delete" : "blocking/create", {
>       userId: user.id,
>     }).then(() => {
>       user.isBlocking = !user.isBlocking;
>     });
>   }
111,115c135,141
< 	function reportAbuse() {
< 		os.popup(defineAsyncComponent(() => import('@/components/MkAbuseReportWindow.vue')), {
< 			user: user,
< 		}, {}, 'closed');
< 	}
---
>   async function toggleSilence() {
>     if (
>       !(await getConfirmed(
>         i18n.t(user.isSilenced ? "unsilenceConfirm" : "silenceConfirm")
>       ))
>     )
>       return;
117,122c143,151
< 	async function getConfirmed(text: string): Promise<boolean> {
< 		const confirm = await os.confirm({
< 			type: 'warning',
< 			title: 'confirm',
< 			text,
< 		});
---
>     os.apiWithDialog(
>       user.isSilenced ? "admin/unsilence-user" : "admin/silence-user",
>       {
>         userId: user.id,
>       }
>     ).then(() => {
>       user.isSilenced = !user.isSilenced;
>     });
>   }
124,125c153,159
< 		return !confirm.canceled;
< 	}
---
>   async function toggleSuspend() {
>     if (
>       !(await getConfirmed(
>         i18n.t(user.isSuspended ? "unsuspendConfirm" : "suspendConfirm")
>       ))
>     )
>       return;
127,133c161,169
< 	async function invalidateFollow() {
< 		os.apiWithDialog('following/invalidate', {
< 			userId: user.id,
< 		}).then(() => {
< 			user.isFollowed = !user.isFollowed;
< 		});
< 	}
---
>     os.apiWithDialog(
>       user.isSuspended ? "admin/unsuspend-user" : "admin/suspend-user",
>       {
>         userId: user.id,
>       }
>     ).then(() => {
>       user.isSuspended = !user.isSuspended;
>     });
>   }
135,172c171,182
< 	let menu = [{
< 		icon: 'ti ti-at',
< 		text: i18n.ts.copyUsername,
< 		action: () => {
< 			copyToClipboard(`@${user.username}@${user.host || host}`);
< 		},
< 	}, {
< 		icon: 'ti ti-info-circle',
< 		text: i18n.ts.info,
< 		action: () => {
< 			router.push(`/user-info/${user.id}`);
< 		},
< 	}, {
< 		icon: 'ti ti-rss',
< 		text: i18n.ts.copyRSS,
< 		action: () => {
< 			copyToClipboard(`${user.host ?? host}/@${user.username}.atom`);
< 		},
< 	}, {
< 		icon: 'ti ti-mail',
< 		text: i18n.ts.sendMessage,
< 		action: () => {
< 			os.post({ specified: user });
< 		},
< 	}, meId !== user.id ? {
< 		type: 'link',
< 		icon: 'ti ti-messages',
< 		text: i18n.ts.startMessaging,
< 		to: '/my/messaging/' + Acct.toString(user),
< 	} : undefined, null, {
< 		icon: 'ti ti-list',
< 		text: i18n.ts.addToList,
< 		action: pushList,
< 	}, meId !== user.id ? {
< 		icon: 'ti ti-users',
< 		text: i18n.ts.inviteToGroup,
< 		action: inviteGroup,
< 	} : undefined] as any;
---
>   function reportAbuse() {
>     os.popup(
>       defineAsyncComponent(
>         () => import("@/components/MkAbuseReportWindow.vue")
>       ),
>       {
>         user: user,
>       },
>       {},
>       "closed"
>     );
>   }
174,183c184,189
< 	if ($i && meId !== user.id) {
< 		menu = menu.concat([null, {
< 			icon: user.isMuted ? 'ti ti-eye' : 'ti ti-eye-off',
< 			text: user.isMuted ? i18n.ts.unmute : i18n.ts.mute,
< 			action: toggleMute,
< 		}, {
< 			icon: 'ti ti-ban',
< 			text: user.isBlocking ? i18n.ts.unblock : i18n.ts.block,
< 			action: toggleBlock,
< 		}]);
---
>   async function getConfirmed(text: string): Promise<boolean> {
>     const confirm = await os.confirm({
>       type: "warning",
>       title: "confirm",
>       text,
>     });
185,191c191,192
< 		if (user.isFollowed) {
< 			menu = menu.concat([{
< 				icon: 'ti ti-link-off',
< 				text: i18n.ts.breakFollow,
< 				action: invalidateFollow,
< 			}]);
< 		}
---
>     return !confirm.canceled;
>   }
193,197c194,200
< 		menu = menu.concat([null, {
< 			icon: 'ti ti-exclamation-circle',
< 			text: i18n.ts.reportAbuse,
< 			action: reportAbuse,
< 		}]);
---
>   async function invalidateFollow() {
>     os.apiWithDialog("following/invalidate", {
>       userId: user.id,
>     }).then(() => {
>       user.isFollowed = !user.isFollowed;
>     });
>   }
199,208c202,245
< 		if (iAmModerator) {
< 			menu = menu.concat([null, {
< 				icon: 'ti ti-user-exclamation',
< 				text: i18n.ts.moderation,
< 				action: () => {
< 					router.push('/user-info/' + user.id + '#moderation');
< 				},
< 			}]);
< 		}
< 	}
---
>   let menu = [
>     {
>       icon: "fas fa-at",
>       text: i18n.ts.copyUsername,
>       action: () => {
>         copyToClipboard(`@${user.username}@${user.host || host}`);
>       },
>     },
>     {
>       icon: "fas fa-info-circle",
>       text: i18n.ts.info,
>       action: () => {
>         router.push(`/user-info/${user.id}`);
>       },
>     },
>     {
>       icon: "fas fa-envelope",
>       text: i18n.ts.sendMessage,
>       action: () => {
>         os.post({ specified: user });
>       },
>     },
>     meId !== user.id
>       ? {
>           type: "link",
>           icon: "fas fa-comments",
>           text: i18n.ts.startMessaging,
>           to: "/my/messaging/" + Acct.toString(user),
>         }
>       : undefined,
>     null,
>     {
>       icon: "fas fa-list-ul",
>       text: i18n.ts.addToList,
>       action: pushList,
>     },
>     meId !== user.id
>       ? {
>           icon: "fas fa-users",
>           text: i18n.ts.inviteToGroup,
>           action: inviteGroup,
>         }
>       : undefined,
>   ] as any;
210,218c247,260
< 	if ($i && meId === user.id) {
< 		menu = menu.concat([null, {
< 			icon: 'ti ti-pencil',
< 			text: i18n.ts.editProfile,
< 			action: () => {
< 				router.push('/settings/profile');
< 			},
< 		}]);
< 	}
---
>   if ($i && meId !== user.id) {
>     menu = menu.concat([
>       null,
>       {
>         icon: user.isMuted ? "fas fa-eye" : "fas fa-eye-slash",
>         text: user.isMuted ? i18n.ts.unmute : i18n.ts.mute,
>         action: toggleMute,
>       },
>       {
>         icon: "fas fa-ban",
>         text: user.isBlocking ? i18n.ts.unblock : i18n.ts.block,
>         action: toggleBlock,
>       },
>     ]);
220,228c262,270
< 	if (userActions.length > 0) {
< 		menu = menu.concat([null, ...userActions.map(action => ({
< 			icon: 'ti ti-plug',
< 			text: action.title,
< 			action: () => {
< 				action.handler(user);
< 			},
< 		}))]);
< 	}
---
>     if (user.isFollowed) {
>       menu = menu.concat([
>         {
>           icon: "fas fa-unlink",
>           text: i18n.ts.breakFollow,
>           action: invalidateFollow,
>         },
>       ]);
>     }
230c272,324
< 	return menu;
---
>     menu = menu.concat([
>       null,
>       {
>         icon: "fas fa-exclamation-circle",
>         text: i18n.ts.reportAbuse,
>         action: reportAbuse,
>       },
>     ]);
> 
>     if (iAmModerator) {
>       menu = menu.concat([
>         null,
>         {
>           icon: "fas fa-microphone-slash",
>           text: user.isSilenced ? i18n.ts.unsilence : i18n.ts.silence,
>           action: toggleSilence,
>         },
>         {
>           icon: "fas fa-snowflake",
>           text: user.isSuspended ? i18n.ts.unsuspend : i18n.ts.suspend,
>           action: toggleSuspend,
>         },
>       ]);
>     }
>   }
> 
>   if ($i && meId === user.id) {
>     menu = menu.concat([
>       null,
>       {
>         icon: "fas fa-pencil-alt",
>         text: i18n.ts.editProfile,
>         action: () => {
>           router.push("/settings/profile");
>         },
>       },
>     ]);
>   }
> 
>   if (userActions.length > 0) {
>     menu = menu.concat([
>       null,
>       ...userActions.map((action) => ({
>         icon: "fas fa-plug",
>         text: action.title,
>         action: () => {
>           action.handler(user);
>         },
>       })),
>     ]);
>   }
> 
>   return menu;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/get-user-name.ts RiricaV13/scripts/get-user-name.ts
1,2c1,5
< export default function(user: { name?: string | null, username: string }): string {
< 	return user.name || user.username;
---
> export default function (user: {
>   name?: string | null;
>   username: string;
> }): string {
>   return user.name || user.username;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hotkey.ts RiricaV13/scripts/hotkey.ts
1c1
< import keyCode from './keycode';
---
> import keyCode from "./keycode";
8,11c8,11
< 	which: string[];
< 	ctrl?: boolean;
< 	shift?: boolean;
< 	alt?: boolean;
---
>   which: string[];
>   ctrl?: boolean;
>   shift?: boolean;
>   alt?: boolean;
15,17c15,17
< 	patterns: Pattern[];
< 	callback: Callback;
< 	allowRepeat: boolean;
---
>   patterns: Pattern[];
>   callback: Callback;
>   allowRepeat: boolean;
20,25c20,26
< const parseKeymap = (keymap: Keymap) => Object.entries(keymap).map(([patterns, callback]): Action => {
< 	const result = {
< 		patterns: [],
< 		callback,
< 		allowRepeat: true,
< 	} as Action;
---
> const parseKeymap = (keymap: Keymap) =>
>   Object.entries(keymap).map(([patterns, callback]): Action => {
>     const result = {
>       patterns: [],
>       callback,
>       allowRepeat: true,
>     } as Action;
27,30c28,31
< 	if (patterns.match(/^\(.*\)$/) !== null) {
< 		result.allowRepeat = false;
< 		patterns = patterns.slice(1, -1);
< 	}
---
>     if (patterns.match(/^\(.*\)$/) !== null) {
>       result.allowRepeat = false;
>       patterns = patterns.slice(1, -1);
>     }
32,38c33,39
< 	result.patterns = patterns.split('|').map(part => {
< 		const pattern = {
< 			which: [],
< 			ctrl: false,
< 			alt: false,
< 			shift: false,
< 		} as Pattern;
---
>     result.patterns = patterns.split("|").map((part) => {
>       const pattern = {
>         which: [],
>         ctrl: false,
>         alt: false,
>         shift: false,
>       } as Pattern;
40,48c41,59
< 		const keys = part.trim().split('+').map(x => x.trim().toLowerCase());
< 		for (const key of keys) {
< 			switch (key) {
< 				case 'ctrl': pattern.ctrl = true; break;
< 				case 'alt': pattern.alt = true; break;
< 				case 'shift': pattern.shift = true; break;
< 				default: pattern.which = keyCode(key).map(k => k.toLowerCase());
< 			}
< 		}
---
>       const keys = part
>         .trim()
>         .split("+")
>         .map((x) => x.trim().toLowerCase());
>       for (const key of keys) {
>         switch (key) {
>           case "ctrl":
>             pattern.ctrl = true;
>             break;
>           case "alt":
>             pattern.alt = true;
>             break;
>           case "shift":
>             pattern.shift = true;
>             break;
>           default:
>             pattern.which = keyCode(key).map((k) => k.toLowerCase());
>         }
>       }
50,51c61,62
< 		return pattern;
< 	});
---
>       return pattern;
>     });
53,54c64,65
< 	return result;
< });
---
>     return result;
>   });
56c67
< const ignoreElemens = ['input', 'textarea'];
---
> const ignoreElemens = ["input", "textarea"];
58,65c69,78
< function match(ev: KeyboardEvent, patterns: Action['patterns']): boolean {
< 	const key = ev.code.toLowerCase();
< 	return patterns.some(pattern => pattern.which.includes(key) &&
< 		pattern.ctrl === ev.ctrlKey &&
< 		pattern.shift === ev.shiftKey &&
< 		pattern.alt === ev.altKey &&
< 		!ev.metaKey,
< 	);
---
> function match(ev: KeyboardEvent, patterns: Action["patterns"]): boolean {
>   const key = ev.code.toLowerCase();
>   return patterns.some(
>     (pattern) =>
>       pattern.which.includes(key) &&
>       pattern.ctrl === ev.ctrlKey &&
>       pattern.shift === ev.shiftKey &&
>       pattern.alt === ev.altKey &&
>       !ev.metaKey
>   );
69c82
< 	const actions = parseKeymap(keymap);
---
>   const actions = parseKeymap(keymap);
71,75c84,89
< 	return (ev: KeyboardEvent) => {
< 		if (document.activeElement) {
< 			if (ignoreElemens.some(el => document.activeElement!.matches(el))) return;
< 			if (document.activeElement.attributes['contenteditable']) return;
< 		}
---
>   return (ev: KeyboardEvent) => {
>     if (document.activeElement) {
>       if (ignoreElemens.some((el) => document.activeElement!.matches(el)))
>         return;
>       if (document.activeElement.attributes["contenteditable"]) return;
>     }
77,78c91,92
< 		for (const action of actions) {
< 			const matched = match(ev, action.patterns);
---
>     for (const action of actions) {
>       const matched = match(ev, action.patterns);
80,81c94,95
< 			if (matched) {
< 				if (!action.allowRepeat && ev.repeat) return;
---
>       if (matched) {
>         if (!action.allowRepeat && ev.repeat) return;
83,89c97,103
< 				ev.preventDefault();
< 				ev.stopPropagation();
< 				action.callback(ev);
< 				break;
< 			}
< 		}
< 	};
---
>         ev.preventDefault();
>         ev.stopPropagation();
>         action.callback(ev);
>         break;
>       }
>     }
>   };
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/block.ts RiricaV13/scripts/hpml/block.ts
4,5c4,5
< 	id: string;
< 	type: string;
---
>   id: string;
>   type: string;
9,10c9,10
< 	type: 'text';
< 	text: string;
---
>   type: "text";
>   text: string;
14,16c14,16
< 	type: 'section';
< 	title: string;
< 	children: (Block | VarBlock)[];
---
>   type: "section";
>   title: string;
>   children: (Block | VarBlock)[];
20,21c20,21
< 	type: 'image';
< 	fileId: string | null;
---
>   type: "image";
>   fileId: string | null;
25,33c25,33
< 	type: 'button';
< 	text: any;
< 	primary: boolean;
< 	action: string;
< 	content: string;
< 	event: string;
< 	message: string;
< 	var: string;
< 	fn: string;
---
>   type: "button";
>   text: any;
>   primary: boolean;
>   action: string;
>   content: string;
>   event: string;
>   message: string;
>   var: string;
>   fn: string;
37,39c37,39
< 	type: 'if';
< 	var: string;
< 	children: Block[];
---
>   type: "if";
>   var: string;
>   children: Block[];
43,44c43,44
< 	type: 'textarea';
< 	text: string;
---
>   type: "textarea";
>   text: string;
48,51c48,51
< 	type: 'post';
< 	text: string;
< 	attachCanvasImage: boolean;
< 	canvasId: string;
---
>   type: "post";
>   text: string;
>   attachCanvasImage: boolean;
>   canvasId: string;
55,58c55,58
< 	type: 'canvas';
< 	name: string; // canvas id
< 	width: number;
< 	height: number;
---
>   type: "canvas";
>   name: string; // canvas id
>   width: number;
>   height: number;
62,64c62,64
< 	type: 'note';
< 	detailed: boolean;
< 	note: string | null;
---
>   type: "note";
>   detailed: boolean;
>   note: string | null;
68c68,77
< 	TextBlock | SectionBlock | ImageBlock | ButtonBlock | IfBlock | TextareaBlock | PostBlock | CanvasBlock | NoteBlock | VarBlock;
---
>   | TextBlock
>   | SectionBlock
>   | ImageBlock
>   | ButtonBlock
>   | IfBlock
>   | TextareaBlock
>   | PostBlock
>   | CanvasBlock
>   | NoteBlock
>   | VarBlock;
73c82
< 	name: string;
---
>   name: string;
77,78c86,87
< 	type: 'numberInput';
< 	text: string;
---
>   type: "numberInput";
>   text: string;
82,83c91,92
< 	type: 'textInput';
< 	text: string;
---
>   type: "textInput";
>   text: string;
87,88c96,97
< 	type: 'switch';
< 	text: string;
---
>   type: "switch";
>   text: string;
92,94c101,103
< 	type: 'radioButton';
< 	title: string;
< 	values: string[];
---
>   type: "radioButton";
>   title: string;
>   values: string[];
98,100c107,109
< 	type: 'counter';
< 	text: string;
< 	inc: number;
---
>   type: "counter";
>   text: string;
>   inc: number;
104c113,117
< 	NumberInputVarBlock | TextInputVarBlock | SwitchVarBlock | RadioButtonVarBlock | CounterVarBlock;
---
>   | NumberInputVarBlock
>   | TextInputVarBlock
>   | SwitchVarBlock
>   | RadioButtonVarBlock
>   | CounterVarBlock;
106c119,125
< const varBlock = ['numberInput', 'textInput', 'switch', 'radioButton', 'counter'];
---
> const varBlock = [
>   "numberInput",
>   "textInput",
>   "switch",
>   "radioButton",
>   "counter",
> ];
108c127
< 	return varBlock.includes(block.type);
---
>   return varBlock.includes(block.type);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/evaluator.ts RiricaV13/scripts/hpml/evaluator.ts
1,8c1,10
< import autobind from 'autobind-decorator';
< import { markRaw, ref, Ref, unref } from 'vue';
< import { collectPageVars } from '../collect-page-vars';
< import { initHpmlLib, initAiLib } from './lib';
< import { Expr, isLiteralValue, Variable } from './expr';
< import { PageVar, envVarsDef, Fn, HpmlScope, HpmlError } from '.';
< import { version } from '@/config';
< import * as os from '@/os';
---
> import autobind from "autobind-decorator";
> import { PageVar, envVarsDef, Fn, HpmlScope, HpmlError } from ".";
> import { version } from "@/config";
> import { AiScript, utils, values } from "@syuilo/aiscript";
> import { createAiScriptEnv } from "../aiscript/api";
> import { collectPageVars } from "../collect-page-vars";
> import { initHpmlLib, initAiLib } from "./lib";
> import * as os from "@/os";
> import { markRaw, ref, Ref, unref } from "vue";
> import { Expr, isLiteralValue, Variable } from "./expr";
14,20c16,23
< 	private variables: Variable[];
< 	private pageVars: PageVar[];
< 	private envVars: Record<keyof typeof envVarsDef, any>;
< 	public pageVarUpdatedCallback?: values.VFn;
< 	public canvases: Record<string, HTMLCanvasElement> = {};
< 	public vars: Ref<Record<string, any>> = ref({});
< 	public page: Record<string, any>;
---
>   private variables: Variable[];
>   private pageVars: PageVar[];
>   private envVars: Record<keyof typeof envVarsDef, any>;
>   public aiscript?: AiScript;
>   public pageVarUpdatedCallback?: values.VFn;
>   public canvases: Record<string, HTMLCanvasElement> = {};
>   public vars: Ref<Record<string, any>> = ref({});
>   public page: Record<string, any>;
22,24c25,30
< 	private opts: {
< 		randomSeed: string; visitor?: any; url?: string;
< 	};
---
>   private opts: {
>     randomSeed: string;
>     visitor?: any;
>     url?: string;
>     enableAiScript: boolean;
>   };
26,30c32,36
< 	constructor(page: Hpml['page'], opts: Hpml['opts']) {
< 		this.page = page;
< 		this.variables = this.page.variables;
< 		this.pageVars = collectPageVars(this.page.content);
< 		this.opts = opts;
---
>   constructor(page: Hpml["page"], opts: Hpml["opts"]) {
>     this.page = page;
>     this.variables = this.page.variables;
>     this.pageVars = collectPageVars(this.page.content);
>     this.opts = opts;
32c38,63
< 		const date = new Date();
---
>     if (this.opts.enableAiScript) {
>       this.aiscript = markRaw(
>         new AiScript(
>           {
>             ...createAiScriptEnv({
>               storageKey: "pages:" + this.page.id,
>             }),
>             ...initAiLib(this),
>           },
>           {
>             in: (q) => {
>               return new Promise((ok) => {
>                 os.inputText({
>                   title: q,
>                 }).then(({ canceled, result: a }) => {
>                   ok(a);
>                 });
>               });
>             },
>             out: (value) => {
>               console.log(value);
>             },
>             log: (type, params) => {},
>           }
>         )
>       );
34,50c65,68
< 		this.envVars = {
< 			AI: 'kawaii',
< 			VERSION: version,
< 			URL: this.page ? `${opts.url}/@${this.page.user.username}/pages/${this.page.name}` : '',
< 			LOGIN: opts.visitor != null,
< 			NAME: opts.visitor ? opts.visitor.name || opts.visitor.username : '',
< 			USERNAME: opts.visitor ? opts.visitor.username : '',
< 			USERID: opts.visitor ? opts.visitor.id : '',
< 			NOTES_COUNT: opts.visitor ? opts.visitor.notesCount : 0,
< 			FOLLOWERS_COUNT: opts.visitor ? opts.visitor.followersCount : 0,
< 			FOLLOWING_COUNT: opts.visitor ? opts.visitor.followingCount : 0,
< 			IS_CAT: opts.visitor ? opts.visitor.isCat : false,
< 			SEED: opts.randomSeed ? opts.randomSeed : '',
< 			YMD: `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`,
< 			AISCRIPT_DISABLED: true,
< 			NULL: null,
< 		};
---
>       this.aiscript.scope.opts.onUpdated = (name, value) => {
>         this.eval();
>       };
>     }
52,53c70
< 		this.eval();
< 	}
---
>     const date = new Date();
55,62c72,90
< 	@autobind
< 	public eval() {
< 		try {
< 			this.vars.value = this.evaluateVars();
< 		} catch (err) {
< 			//this.onError(e);
< 		}
< 	}
---
>     this.envVars = {
>       AI: "kawaii",
>       VERSION: version,
>       URL: this.page
>         ? `${opts.url}/@${this.page.user.username}/pages/${this.page.name}`
>         : "",
>       LOGIN: opts.visitor != null,
>       NAME: opts.visitor ? opts.visitor.name || opts.visitor.username : "",
>       USERNAME: opts.visitor ? opts.visitor.username : "",
>       USERID: opts.visitor ? opts.visitor.id : "",
>       NOTES_COUNT: opts.visitor ? opts.visitor.notesCount : 0,
>       FOLLOWERS_COUNT: opts.visitor ? opts.visitor.followersCount : 0,
>       FOLLOWING_COUNT: opts.visitor ? opts.visitor.followingCount : 0,
>       IS_CAT: opts.visitor ? opts.visitor.isCat : false,
>       SEED: opts.randomSeed ? opts.randomSeed : "",
>       YMD: `${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`,
>       AISCRIPT_DISABLED: !this.opts.enableAiScript,
>       NULL: null,
>     };
64,71c92,93
< 	@autobind
< 	public interpolate(str: string) {
< 		if (str == null) return null;
< 		return str.replace(/{(.+?)}/g, match => {
< 			const v = unref(this.vars)[match.slice(1, -1).trim()];
< 			return v == null ? 'NULL' : v.toString();
< 		});
< 	}
---
>     this.eval();
>   }
73,76c95,102
< 	@autobind
< 	public registerCanvas(id: string, canvas: any) {
< 		this.canvases[id] = canvas;
< 	}
---
>   @autobind
>   public eval() {
>     try {
>       this.vars.value = this.evaluateVars();
>     } catch (err) {
>       //this.onError(e);
>     }
>   }
78,86c104,111
< 	@autobind
< 	public updatePageVar(name: string, value: any) {
< 		const pageVar = this.pageVars.find(v => v.name === name);
< 		if (pageVar !== undefined) {
< 			pageVar.value = value;
< 		} else {
< 			throw new HpmlError(`No such page var '${name}'`);
< 		}
< 	}
---
>   @autobind
>   public interpolate(str: string) {
>     if (str == null) return null;
>     return str.replace(/{(.+?)}/g, (match) => {
>       const v = unref(this.vars)[match.slice(1, -1).trim()];
>       return v == null ? "NULL" : v.toString();
>     });
>   }
88,92c113,118
< 	@autobind
< 	public updateRandomSeed(seed: string) {
< 		this.opts.randomSeed = seed;
< 		this.envVars.SEED = seed;
< 	}
---
>   @autobind
>   public callAiScript(fn: string) {
>     try {
>       if (this.aiscript) this.aiscript.execFn(this.aiscript.scope.get(fn), []);
>     } catch (err) {}
>   }
94,100c120,123
< 	@autobind
< 	private _interpolateScope(str: string, scope: HpmlScope) {
< 		return str.replace(/{(.+?)}/g, match => {
< 			const v = scope.getState(match.slice(1, -1).trim());
< 			return v == null ? 'NULL' : v.toString();
< 		});
< 	}
---
>   @autobind
>   public registerCanvas(id: string, canvas: any) {
>     this.canvases[id] = canvas;
>   }
102,104c125,140
< 	@autobind
< 	public evaluateVars(): Record<string, any> {
< 		const values: Record<string, any> = {};
---
>   @autobind
>   public updatePageVar(name: string, value: any) {
>     const pageVar = this.pageVars.find((v) => v.name === name);
>     if (pageVar !== undefined) {
>       pageVar.value = value;
>       if (this.pageVarUpdatedCallback) {
>         if (this.aiscript)
>           this.aiscript.execFn(this.pageVarUpdatedCallback, [
>             values.STR(name),
>             utils.jsToVal(value),
>           ]);
>       }
>     } else {
>       throw new HpmlError(`No such page var '${name}'`);
>     }
>   }
106,108c142,146
< 		for (const [k, v] of Object.entries(this.envVars)) {
< 			values[k] = v;
< 		}
---
>   @autobind
>   public updateRandomSeed(seed: string) {
>     this.opts.randomSeed = seed;
>     this.envVars.SEED = seed;
>   }
110,112c148,154
< 		for (const v of this.pageVars) {
< 			values[v.name] = v.value;
< 		}
---
>   @autobind
>   private _interpolateScope(str: string, scope: HpmlScope) {
>     return str.replace(/{(.+?)}/g, (match) => {
>       const v = scope.getState(match.slice(1, -1).trim());
>       return v == null ? "NULL" : v.toString();
>     });
>   }
114,116c156,158
< 		for (const v of this.variables) {
< 			values[v.name] = this.evaluate(v, new HpmlScope([values]));
< 		}
---
>   @autobind
>   public evaluateVars(): Record<string, any> {
>     const values: Record<string, any> = {};
118,119c160,162
< 		return values;
< 	}
---
>     for (const [k, v] of Object.entries(this.envVars)) {
>       values[k] = v;
>     }
121,126c164,166
< 	@autobind
< 	private evaluate(expr: Expr, scope: HpmlScope): any {
< 		if (isLiteralValue(expr)) {
< 			if (expr.type === null) {
< 				return null;
< 			}
---
>     for (const v of this.pageVars) {
>       values[v.name] = v.value;
>     }
128,130c168,170
< 			if (expr.type === 'number') {
< 				return parseInt((expr.value as any), 10);
< 			}
---
>     for (const v of this.variables) {
>       values[v.name] = this.evaluate(v, new HpmlScope([values]));
>     }
132,134c172,173
< 			if (expr.type === 'text' || expr.type === 'multiLineText') {
< 				return this._interpolateScope(expr.value || '', scope);
< 			}
---
>     return values;
>   }
136,138c175,180
< 			if (expr.type === 'textList') {
< 				return this._interpolateScope(expr.value || '', scope).trim().split('\n');
< 			}
---
>   @autobind
>   private evaluate(expr: Expr, scope: HpmlScope): any {
>     if (isLiteralValue(expr)) {
>       if (expr.type === null) {
>         return null;
>       }
140,142c182,184
< 			if (expr.type === 'ref') {
< 				return scope.getState(expr.value);
< 			}
---
>       if (expr.type === "number") {
>         return parseInt(expr.value as any, 10);
>       }
144,154c186,188
< 			// Define user function
< 			if (expr.type === 'fn') {
< 				return {
< 					slots: expr.value.slots.map(x => x.name),
< 					exec: (slotArg: Record<string, any>) => {
< 						return this.evaluate(expr.value.expression, scope.createChildScope(slotArg, expr.id));
< 					},
< 				} as Fn;
< 			}
< 			return;
< 		}
---
>       if (expr.type === "text" || expr.type === "multiLineText") {
>         return this._interpolateScope(expr.value || "", scope);
>       }
156,166c190,194
< 		// Call user function
< 		if (expr.type.startsWith('fn:')) {
< 			const fnName = expr.type.split(':')[1];
< 			const fn = scope.getState(fnName);
< 			const args = {} as Record<string, any>;
< 			for (let i = 0; i < fn.slots.length; i++) {
< 				const name = fn.slots[i];
< 				args[name] = this.evaluate(expr.args[i], scope);
< 			}
< 			return fn.exec(args);
< 		}
---
>       if (expr.type === "textList") {
>         return this._interpolateScope(expr.value || "", scope)
>           .trim()
>           .split("\n");
>       }
168c196,198
< 		if (expr.args === undefined) return null;
---
>       if (expr.type === "ref") {
>         return scope.getState(expr.value);
>       }
170c200,210
< 		const funcs = initHpmlLib(expr, scope, this.opts.randomSeed, this.opts.visitor);
---
>       if (expr.type === "aiScriptVar") {
>         if (this.aiscript) {
>           try {
>             return utils.valToJs(this.aiscript.scope.get(expr.value));
>           } catch (err) {
>             return null;
>           }
>         } else {
>           return null;
>         }
>       }
172,180c212,256
< 		// Call function
< 		const fnName = expr.type;
< 		const fn = (funcs as any)[fnName];
< 		if (fn == null) {
< 			throw new HpmlError(`No such function '${fnName}'`);
< 		} else {
< 			return fn(...expr.args.map(x => this.evaluate(x, scope)));
< 		}
< 	}
---
>       // Define user function
>       if (expr.type === "fn") {
>         return {
>           slots: expr.value.slots.map((x) => x.name),
>           exec: (slotArg: Record<string, any>) => {
>             return this.evaluate(
>               expr.value.expression,
>               scope.createChildScope(slotArg, expr.id)
>             );
>           },
>         } as Fn;
>       }
>       return;
>     }
> 
>     // Call user function
>     if (expr.type.startsWith("fn:")) {
>       const fnName = expr.type.split(":")[1];
>       const fn = scope.getState(fnName);
>       const args = {} as Record<string, any>;
>       for (let i = 0; i < fn.slots.length; i++) {
>         const name = fn.slots[i];
>         args[name] = this.evaluate(expr.args[i], scope);
>       }
>       return fn.exec(args);
>     }
> 
>     if (expr.args === undefined) return null;
> 
>     const funcs = initHpmlLib(
>       expr,
>       scope,
>       this.opts.randomSeed,
>       this.opts.visitor
>     );
> 
>     // Call function
>     const fnName = expr.type;
>     const fn = (funcs as any)[fnName];
>     if (fn == null) {
>       throw new HpmlError(`No such function '${fnName}'`);
>     } else {
>       return fn(...expr.args.map((x) => this.evaluate(x, scope)));
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/expr.ts RiricaV13/scripts/hpml/expr.ts
1c1
< import { literalDefs, Type } from '.';
---
> import { literalDefs, Type } from ".";
4c4
< 	id: string;
---
>   id: string;
10,11c10,11
< 	type: null;
< 	value: null;
---
>   type: null;
>   value: null;
15,16c15,16
< 	type: 'text';
< 	value: string;
---
>   type: "text";
>   value: string;
20,21c20,21
< 	type: 'multiLineText';
< 	value: string;
---
>   type: "multiLineText";
>   value: string;
25,26c25,26
< 	type: 'textList';
< 	value: string;
---
>   type: "textList";
>   value: string;
30,31c30,31
< 	type: 'number';
< 	value: number;
---
>   type: "number";
>   value: number;
35,36c35,36
< 	type: 'ref';
< 	value: string; // value is variable name
---
>   type: "ref";
>   value: string; // value is variable name
40,41c40,41
< 	type: 'aiScriptVar';
< 	value: string; // value is variable name
---
>   type: "aiScriptVar";
>   value: string; // value is variable name
45,46c45,46
< 	type: 'fn';
< 	value: UserFnInnerValue;
---
>   type: "fn";
>   value: UserFnInnerValue;
49,53c49,53
< 	slots: {
< 		name: string;
< 		type: Type;
< 	}[];
< 	expression: Expr;
---
>   slots: {
>     name: string;
>     type: Type;
>   }[];
>   expression: Expr;
57c57,64
< 	EmptyValue | TextValue | MultiLineTextValue | TextListValue | NumberValue | RefValue | AiScriptRefValue | UserFnValue;
---
>   | EmptyValue
>   | TextValue
>   | MultiLineTextValue
>   | TextListValue
>   | NumberValue
>   | RefValue
>   | AiScriptRefValue
>   | UserFnValue;
60,62c67,69
< 	if (expr.type == null) return true;
< 	if (literalDefs[expr.type]) return true;
< 	return false;
---
>   if (expr.type == null) return true;
>   if (literalDefs[expr.type]) return true;
>   return false;
67,70c74,78
< export type CallFn = ExprBase & { // "fn:hoge" or string
< 	type: string;
< 	args: Expr[];
< 	value: null;
---
> export type CallFn = ExprBase & {
>   // "fn:hoge" or string
>   type: string;
>   args: Expr[];
>   value: null;
75c83
< 	name: string;
---
>   name: string;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/index.ts RiricaV13/scripts/hpml/index.ts
5,7c5,7
< import autobind from 'autobind-decorator';
< import { Hpml } from './evaluator';
< import { funcDefs } from './lib';
---
> import autobind from "autobind-decorator";
> import { Hpml } from "./evaluator";
> import { funcDefs } from "./lib";
10,11c10,11
< 	slots: string[];
< 	exec: (args: Record<string, any>) => ReturnType<Hpml['evaluate']>;
---
>   slots: string[];
>   exec: (args: Record<string, any>) => ReturnType<Hpml["evaluate"]>;
14c14
< export type Type = 'string' | 'number' | 'boolean' | 'stringArray' | null;
---
> export type Type = "string" | "number" | "boolean" | "stringArray" | null;
16,23c16,30
< export const literalDefs: Record<string, { out: any; category: string; icon: any; }> = {
< 	text: { out: 'string', category: 'value', icon: 'ti ti-quote' },
< 	multiLineText: { out: 'string', category: 'value', icon: 'fas fa-align-left' },
< 	textList: { out: 'stringArray', category: 'value', icon: 'fas fa-list' },
< 	number: { out: 'number', category: 'value', icon: 'fas fa-sort-numeric-up' },
< 	ref: { out: null, category: 'value', icon: 'fas fa-magic' },
< 	aiScriptVar: { out: null, category: 'value', icon: 'fas fa-magic' },
< 	fn: { out: 'function', category: 'value', icon: 'fas fa-square-root-alt' },
---
> export const literalDefs: Record<
>   string,
>   { out: any; category: string; icon: any }
> > = {
>   text: { out: "string", category: "value", icon: "fas fa-quote-right" },
>   multiLineText: {
>     out: "string",
>     category: "value",
>     icon: "fas fa-align-left",
>   },
>   textList: { out: "stringArray", category: "value", icon: "fas fa-list" },
>   number: { out: "number", category: "value", icon: "fas fa-sort-numeric-up" },
>   ref: { out: null, category: "value", icon: "fas fa-magic" },
>   aiScriptVar: { out: null, category: "value", icon: "fas fa-magic" },
>   fn: { out: "function", category: "value", icon: "fas fa-square-root-alt" },
27,32c34,45
< 	...Object.entries(literalDefs).map(([k, v]) => ({
< 		type: k, out: v.out, category: v.category, icon: v.icon,
< 	})),
< 	...Object.entries(funcDefs).map(([k, v]) => ({
< 		type: k, out: v.out, category: v.category, icon: v.icon,
< 	})),
---
>   ...Object.entries(literalDefs).map(([k, v]) => ({
>     type: k,
>     out: v.out,
>     category: v.category,
>     icon: v.icon,
>   })),
>   ...Object.entries(funcDefs).map(([k, v]) => ({
>     type: k,
>     out: v.out,
>     category: v.category,
>     icon: v.icon,
>   })),
35c48
< export type PageVar = { name: string; value: any; type: Type; };
---
> export type PageVar = { name: string; value: any; type: Type };
38,52c51,65
< 	AI: 'string',
< 	URL: 'string',
< 	VERSION: 'string',
< 	LOGIN: 'boolean',
< 	NAME: 'string',
< 	USERNAME: 'string',
< 	USERID: 'string',
< 	NOTES_COUNT: 'number',
< 	FOLLOWERS_COUNT: 'number',
< 	FOLLOWING_COUNT: 'number',
< 	IS_CAT: 'boolean',
< 	SEED: null,
< 	YMD: 'string',
< 	AISCRIPT_DISABLED: 'boolean',
< 	NULL: null,
---
>   AI: "string",
>   URL: "string",
>   VERSION: "string",
>   LOGIN: "boolean",
>   NAME: "string",
>   USERNAME: "string",
>   USERID: "string",
>   NOTES_COUNT: "number",
>   FOLLOWERS_COUNT: "number",
>   FOLLOWING_COUNT: "number",
>   IS_CAT: "boolean",
>   SEED: null,
>   YMD: "string",
>   AISCRIPT_DISABLED: "boolean",
>   NULL: null,
56,57c69,70
< 	private layerdStates: Record<string, any>[];
< 	public name: string;
---
>   private layerdStates: Record<string, any>[];
>   public name: string;
59,62c72,78
< 	constructor(layerdStates: HpmlScope['layerdStates'], name?: HpmlScope['name']) {
< 		this.layerdStates = layerdStates;
< 		this.name = name || 'anonymous';
< 	}
---
>   constructor(
>     layerdStates: HpmlScope["layerdStates"],
>     name?: HpmlScope["name"]
>   ) {
>     this.layerdStates = layerdStates;
>     this.name = name || "anonymous";
>   }
64,68c80,87
< 	@autobind
< 	public createChildScope(states: Record<string, any>, name?: HpmlScope['name']): HpmlScope {
< 		const layer = [states, ...this.layerdStates];
< 		return new HpmlScope(layer, name);
< 	}
---
>   @autobind
>   public createChildScope(
>     states: Record<string, any>,
>     name?: HpmlScope["name"]
>   ): HpmlScope {
>     const layer = [states, ...this.layerdStates];
>     return new HpmlScope(layer, name);
>   }
70,81c89,100
< 	/**
< 	 * 指定した名前の変数の値を取得します
< 	 * @param name 変数名
< 	 */
< 	@autobind
< 	public getState(name: string): any {
< 		for (const later of this.layerdStates) {
< 			const state = later[name];
< 			if (state !== undefined) {
< 				return state;
< 			}
< 		}
---
>   /**
>    * 指定した名前の変数の値を取得します
>    * @param name 変数名
>    */
>   @autobind
>   public getState(name: string): any {
>     for (const later of this.layerdStates) {
>       const state = later[name];
>       if (state !== undefined) {
>         return state;
>       }
>     }
83,87c102,105
< 		throw new HpmlError(
< 			`No such variable '${name}' in scope '${this.name}'`, {
< 				scope: this.layerdStates,
< 			});
< 	}
---
>     throw new HpmlError(`No such variable '${name}' in scope '${this.name}'`, {
>       scope: this.layerdStates,
>     });
>   }
91c109
< 	public info?: any;
---
>   public info?: any;
93,94c111,112
< 	constructor(message: string, info?: any) {
< 		super(message);
---
>   constructor(message: string, info?: any) {
>     super(message);
96c114
< 		this.info = info;
---
>     this.info = info;
98,102c116,120
< 		// Maintains proper stack trace for where our error was thrown (only available on V8)
< 		if (Error.captureStackTrace) {
< 			Error.captureStackTrace(this, HpmlError);
< 		}
< 	}
---
>     // Maintains proper stack trace for where our error was thrown (only available on V8)
>     if (Error.captureStackTrace) {
>       Error.captureStackTrace(this, HpmlError);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/lib.ts RiricaV13/scripts/hpml/lib.ts
1,5c1,6
< import tinycolor from 'tinycolor2';
< import seedrandom from 'seedrandom';
< import { Hpml } from './evaluator';
< import { Expr } from './expr';
< import { Fn, HpmlScope } from '.';
---
> import tinycolor from "tinycolor2";
> import { Hpml } from "./evaluator";
> import { values, utils } from "@syuilo/aiscript";
> import { Fn, HpmlScope } from ".";
> import { Expr } from "./expr";
> import seedrandom from "seedrandom";
23,27c24,156
< 	return {
< 		'MkPages:updated': values.FN_NATIVE(([callback]) => {
< 			hpml.pageVarUpdatedCallback = (callback as values.VFn);
< 		}),
< 		'MkPages:get_canvas': values.FN_NATIVE(([id]) => {
---
>   return {
>     "MkPages:updated": values.FN_NATIVE(([callback]) => {
>       hpml.pageVarUpdatedCallback = callback as values.VFn;
>     }),
>     "MkPages:get_canvas": values.FN_NATIVE(([id]) => {
>       utils.assertString(id);
>       const canvas = hpml.canvases[id.value];
>       const ctx = canvas.getContext("2d");
>       return values.OBJ(
>         new Map([
>           [
>             "clear_rect",
>             values.FN_NATIVE(([x, y, width, height]) => {
>               ctx.clearRect(x.value, y.value, width.value, height.value);
>             }),
>           ],
>           [
>             "fill_rect",
>             values.FN_NATIVE(([x, y, width, height]) => {
>               ctx.fillRect(x.value, y.value, width.value, height.value);
>             }),
>           ],
>           [
>             "stroke_rect",
>             values.FN_NATIVE(([x, y, width, height]) => {
>               ctx.strokeRect(x.value, y.value, width.value, height.value);
>             }),
>           ],
>           [
>             "fill_text",
>             values.FN_NATIVE(([text, x, y, width]) => {
>               ctx.fillText(
>                 text.value,
>                 x.value,
>                 y.value,
>                 width ? width.value : undefined
>               );
>             }),
>           ],
>           [
>             "stroke_text",
>             values.FN_NATIVE(([text, x, y, width]) => {
>               ctx.strokeText(
>                 text.value,
>                 x.value,
>                 y.value,
>                 width ? width.value : undefined
>               );
>             }),
>           ],
>           [
>             "set_line_width",
>             values.FN_NATIVE(([width]) => {
>               ctx.lineWidth = width.value;
>             }),
>           ],
>           [
>             "set_font",
>             values.FN_NATIVE(([font]) => {
>               ctx.font = font.value;
>             }),
>           ],
>           [
>             "set_fill_style",
>             values.FN_NATIVE(([style]) => {
>               ctx.fillStyle = style.value;
>             }),
>           ],
>           [
>             "set_stroke_style",
>             values.FN_NATIVE(([style]) => {
>               ctx.strokeStyle = style.value;
>             }),
>           ],
>           [
>             "begin_path",
>             values.FN_NATIVE(() => {
>               ctx.beginPath();
>             }),
>           ],
>           [
>             "close_path",
>             values.FN_NATIVE(() => {
>               ctx.closePath();
>             }),
>           ],
>           [
>             "move_to",
>             values.FN_NATIVE(([x, y]) => {
>               ctx.moveTo(x.value, y.value);
>             }),
>           ],
>           [
>             "line_to",
>             values.FN_NATIVE(([x, y]) => {
>               ctx.lineTo(x.value, y.value);
>             }),
>           ],
>           [
>             "arc",
>             values.FN_NATIVE(([x, y, radius, startAngle, endAngle]) => {
>               ctx.arc(
>                 x.value,
>                 y.value,
>                 radius.value,
>                 startAngle.value,
>                 endAngle.value
>               );
>             }),
>           ],
>           [
>             "rect",
>             values.FN_NATIVE(([x, y, width, height]) => {
>               ctx.rect(x.value, y.value, width.value, height.value);
>             }),
>           ],
>           [
>             "fill",
>             values.FN_NATIVE(() => {
>               ctx.fill();
>             }),
>           ],
>           [
>             "stroke",
>             values.FN_NATIVE(() => {
>               ctx.stroke();
>             }),
>           ],
>         ])
>       );
>     }),
>     "MkPages:chart": values.FN_NATIVE(([id, opts]) => {
>       /* TODO
29,53d157
< 			const canvas = hpml.canvases[id.value];
< 			const ctx = canvas.getContext('2d');
< 			return values.OBJ(new Map([
< 				['clear_rect', values.FN_NATIVE(([x, y, width, height]) => { ctx.clearRect(x.value, y.value, width.value, height.value); })],
< 				['fill_rect', values.FN_NATIVE(([x, y, width, height]) => { ctx.fillRect(x.value, y.value, width.value, height.value); })],
< 				['stroke_rect', values.FN_NATIVE(([x, y, width, height]) => { ctx.strokeRect(x.value, y.value, width.value, height.value); })],
< 				['fill_text', values.FN_NATIVE(([text, x, y, width]) => { ctx.fillText(text.value, x.value, y.value, width ? width.value : undefined); })],
< 				['stroke_text', values.FN_NATIVE(([text, x, y, width]) => { ctx.strokeText(text.value, x.value, y.value, width ? width.value : undefined); })],
< 				['set_line_width', values.FN_NATIVE(([width]) => { ctx.lineWidth = width.value; })],
< 				['set_font', values.FN_NATIVE(([font]) => { ctx.font = font.value; })],
< 				['set_fill_style', values.FN_NATIVE(([style]) => { ctx.fillStyle = style.value; })],
< 				['set_stroke_style', values.FN_NATIVE(([style]) => { ctx.strokeStyle = style.value; })],
< 				['begin_path', values.FN_NATIVE(() => { ctx.beginPath(); })],
< 				['close_path', values.FN_NATIVE(() => { ctx.closePath(); })],
< 				['move_to', values.FN_NATIVE(([x, y]) => { ctx.moveTo(x.value, y.value); })],
< 				['line_to', values.FN_NATIVE(([x, y]) => { ctx.lineTo(x.value, y.value); })],
< 				['arc', values.FN_NATIVE(([x, y, radius, startAngle, endAngle]) => { ctx.arc(x.value, y.value, radius.value, startAngle.value, endAngle.value); })],
< 				['rect', values.FN_NATIVE(([x, y, width, height]) => { ctx.rect(x.value, y.value, width.value, height.value); })],
< 				['fill', values.FN_NATIVE(() => { ctx.fill(); })],
< 				['stroke', values.FN_NATIVE(() => { ctx.stroke(); })],
< 			]));
< 		}),
< 		'MkPages:chart': values.FN_NATIVE(([id, opts]) => {
< 			/* TODO
< 			utils.assertString(id);
127,128c231,232
< 		}),
< 	};
---
>     }),
>   };
131,168c235,450
< export const funcDefs: Record<string, { in: any[]; out: any; category: string; icon: any; }> = {
< 	if: { in: ['boolean', 0, 0], out: 0, category: 'flow', icon: 'ti ti-share' },
< 	for: { in: ['number', 'function'], out: null, category: 'flow', icon: 'fas fa-recycle' },
< 	not: { in: ['boolean'], out: 'boolean', category: 'logical', icon: 'fas fa-flag' },
< 	or: { in: ['boolean', 'boolean'], out: 'boolean', category: 'logical', icon: 'fas fa-flag' },
< 	and: { in: ['boolean', 'boolean'], out: 'boolean', category: 'logical', icon: 'fas fa-flag' },
< 	add: { in: ['number', 'number'], out: 'number', category: 'operation', icon: 'ti ti-plus' },
< 	subtract: { in: ['number', 'number'], out: 'number', category: 'operation', icon: 'ti ti-minus' },
< 	multiply: { in: ['number', 'number'], out: 'number', category: 'operation', icon: 'ti ti-x' },
< 	divide: { in: ['number', 'number'], out: 'number', category: 'operation', icon: 'fas fa-divide' },
< 	mod: { in: ['number', 'number'], out: 'number', category: 'operation', icon: 'fas fa-divide' },
< 	round: { in: ['number'], out: 'number', category: 'operation', icon: 'fas fa-calculator' },
< 	eq: { in: [0, 0], out: 'boolean', category: 'comparison', icon: 'fas fa-equals' },
< 	notEq: { in: [0, 0], out: 'boolean', category: 'comparison', icon: 'fas fa-not-equal' },
< 	gt: { in: ['number', 'number'], out: 'boolean', category: 'comparison', icon: 'fas fa-greater-than' },
< 	lt: { in: ['number', 'number'], out: 'boolean', category: 'comparison', icon: 'fas fa-less-than' },
< 	gtEq: { in: ['number', 'number'], out: 'boolean', category: 'comparison', icon: 'fas fa-greater-than-equal' },
< 	ltEq: { in: ['number', 'number'], out: 'boolean', category: 'comparison', icon: 'fas fa-less-than-equal' },
< 	strLen: { in: ['string'], out: 'number', category: 'text', icon: 'ti ti-quote' },
< 	strPick: { in: ['string', 'number'], out: 'string', category: 'text', icon: 'ti ti-quote' },
< 	strReplace: { in: ['string', 'string', 'string'], out: 'string', category: 'text', icon: 'ti ti-quote' },
< 	strReverse: { in: ['string'], out: 'string', category: 'text', icon: 'ti ti-quote' },
< 	join: { in: ['stringArray', 'string'], out: 'string', category: 'text', icon: 'ti ti-quote' },
< 	stringToNumber: { in: ['string'], out: 'number', category: 'convert', icon: 'fas fa-exchange-alt' },
< 	numberToString: { in: ['number'], out: 'string', category: 'convert', icon: 'fas fa-exchange-alt' },
< 	splitStrByLine: { in: ['string'], out: 'stringArray', category: 'convert', icon: 'fas fa-exchange-alt' },
< 	pick: { in: [null, 'number'], out: null, category: 'list', icon: 'fas fa-indent' },
< 	listLen: { in: [null], out: 'number', category: 'list', icon: 'fas fa-indent' },
< 	rannum: { in: ['number', 'number'], out: 'number', category: 'random', icon: 'fas fa-dice' },
< 	dailyRannum: { in: ['number', 'number'], out: 'number', category: 'random', icon: 'fas fa-dice' },
< 	seedRannum: { in: [null, 'number', 'number'], out: 'number', category: 'random', icon: 'fas fa-dice' },
< 	random: { in: ['number'], out: 'boolean', category: 'random', icon: 'fas fa-dice' },
< 	dailyRandom: { in: ['number'], out: 'boolean', category: 'random', icon: 'fas fa-dice' },
< 	seedRandom: { in: [null, 'number'], out: 'boolean', category: 'random', icon: 'fas fa-dice' },
< 	randomPick: { in: [0], out: 0, category: 'random', icon: 'fas fa-dice' },
< 	dailyRandomPick: { in: [0], out: 0, category: 'random', icon: 'fas fa-dice' },
< 	seedRandomPick: { in: [null, 0], out: 0, category: 'random', icon: 'fas fa-dice' },
< 	DRPWPM: { in: ['stringArray'], out: 'string', category: 'random', icon: 'fas fa-dice' }, // dailyRandomPickWithProbabilityMapping
---
> export const funcDefs: Record<
>   string,
>   { in: any[]; out: any; category: string; icon: any }
> > = {
>   if: {
>     in: ["boolean", 0, 0],
>     out: 0,
>     category: "flow",
>     icon: "fas fa-share-alt",
>   },
>   for: {
>     in: ["number", "function"],
>     out: null,
>     category: "flow",
>     icon: "fas fa-recycle",
>   },
>   not: {
>     in: ["boolean"],
>     out: "boolean",
>     category: "logical",
>     icon: "fas fa-flag",
>   },
>   or: {
>     in: ["boolean", "boolean"],
>     out: "boolean",
>     category: "logical",
>     icon: "fas fa-flag",
>   },
>   and: {
>     in: ["boolean", "boolean"],
>     out: "boolean",
>     category: "logical",
>     icon: "fas fa-flag",
>   },
>   add: {
>     in: ["number", "number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-plus",
>   },
>   subtract: {
>     in: ["number", "number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-minus",
>   },
>   multiply: {
>     in: ["number", "number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-times",
>   },
>   divide: {
>     in: ["number", "number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-divide",
>   },
>   mod: {
>     in: ["number", "number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-divide",
>   },
>   round: {
>     in: ["number"],
>     out: "number",
>     category: "operation",
>     icon: "fas fa-calculator",
>   },
>   eq: {
>     in: [0, 0],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-equals",
>   },
>   notEq: {
>     in: [0, 0],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-not-equal",
>   },
>   gt: {
>     in: ["number", "number"],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-greater-than",
>   },
>   lt: {
>     in: ["number", "number"],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-less-than",
>   },
>   gtEq: {
>     in: ["number", "number"],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-greater-than-equal",
>   },
>   ltEq: {
>     in: ["number", "number"],
>     out: "boolean",
>     category: "comparison",
>     icon: "fas fa-less-than-equal",
>   },
>   strLen: {
>     in: ["string"],
>     out: "number",
>     category: "text",
>     icon: "fas fa-quote-right",
>   },
>   strPick: {
>     in: ["string", "number"],
>     out: "string",
>     category: "text",
>     icon: "fas fa-quote-right",
>   },
>   strReplace: {
>     in: ["string", "string", "string"],
>     out: "string",
>     category: "text",
>     icon: "fas fa-quote-right",
>   },
>   strReverse: {
>     in: ["string"],
>     out: "string",
>     category: "text",
>     icon: "fas fa-quote-right",
>   },
>   join: {
>     in: ["stringArray", "string"],
>     out: "string",
>     category: "text",
>     icon: "fas fa-quote-right",
>   },
>   stringToNumber: {
>     in: ["string"],
>     out: "number",
>     category: "convert",
>     icon: "fas fa-exchange-alt",
>   },
>   numberToString: {
>     in: ["number"],
>     out: "string",
>     category: "convert",
>     icon: "fas fa-exchange-alt",
>   },
>   splitStrByLine: {
>     in: ["string"],
>     out: "stringArray",
>     category: "convert",
>     icon: "fas fa-exchange-alt",
>   },
>   pick: {
>     in: [null, "number"],
>     out: null,
>     category: "list",
>     icon: "fas fa-indent",
>   },
>   listLen: {
>     in: [null],
>     out: "number",
>     category: "list",
>     icon: "fas fa-indent",
>   },
>   rannum: {
>     in: ["number", "number"],
>     out: "number",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   dailyRannum: {
>     in: ["number", "number"],
>     out: "number",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   seedRannum: {
>     in: [null, "number", "number"],
>     out: "number",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   random: {
>     in: ["number"],
>     out: "boolean",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   dailyRandom: {
>     in: ["number"],
>     out: "boolean",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   seedRandom: {
>     in: [null, "number"],
>     out: "boolean",
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   randomPick: { in: [0], out: 0, category: "random", icon: "fas fa-dice" },
>   dailyRandomPick: { in: [0], out: 0, category: "random", icon: "fas fa-dice" },
>   seedRandomPick: {
>     in: [null, 0],
>     out: 0,
>     category: "random",
>     icon: "fas fa-dice",
>   },
>   DRPWPM: {
>     in: ["stringArray"],
>     out: "string",
>     category: "random",
>     icon: "fas fa-dice",
>   }, // dailyRandomPickWithProbabilityMapping
171,173c453,462
< export function initHpmlLib(expr: Expr, scope: HpmlScope, randomSeed: string, visitor?: any) {
< 	const date = new Date();
< 	const day = `${visitor ? visitor.id : ''} ${date.getFullYear()}/${date.getMonth() + 1}/${date.getDate()}`;
---
> export function initHpmlLib(
>   expr: Expr,
>   scope: HpmlScope,
>   randomSeed: string,
>   visitor?: any
> ) {
>   const date = new Date();
>   const day = `${visitor ? visitor.id : ""} ${date.getFullYear()}/${
>     date.getMonth() + 1
>   }/${date.getDate()}`;
175,243c464,544
< 	// SHOULD be fine to ignore since it's intended + function shape isn't defined
< 	// eslint-disable-next-line @typescript-eslint/ban-types
< 	const funcs: Record<string, Function> = {
< 		not: (a: boolean) => !a,
< 		or: (a: boolean, b: boolean) => a || b,
< 		and: (a: boolean, b: boolean) => a && b,
< 		eq: (a: any, b: any) => a === b,
< 		notEq: (a: any, b: any) => a !== b,
< 		gt: (a: number, b: number) => a > b,
< 		lt: (a: number, b: number) => a < b,
< 		gtEq: (a: number, b: number) => a >= b,
< 		ltEq: (a: number, b: number) => a <= b,
< 		if: (bool: boolean, a: any, b: any) => bool ? a : b,
< 		for: (times: number, fn: Fn) => {
< 			const result: any[] = [];
< 			for (let i = 0; i < times; i++) {
< 				result.push(fn.exec({
< 					[fn.slots[0]]: i + 1,
< 				}));
< 			}
< 			return result;
< 		},
< 		add: (a: number, b: number) => a + b,
< 		subtract: (a: number, b: number) => a - b,
< 		multiply: (a: number, b: number) => a * b,
< 		divide: (a: number, b: number) => a / b,
< 		mod: (a: number, b: number) => a % b,
< 		round: (a: number) => Math.round(a),
< 		strLen: (a: string) => a.length,
< 		strPick: (a: string, b: number) => a[b - 1],
< 		strReplace: (a: string, b: string, c: string) => a.split(b).join(c),
< 		strReverse: (a: string) => a.split('').reverse().join(''),
< 		join: (texts: string[], separator: string) => texts.join(separator || ''),
< 		stringToNumber: (a: string) => parseInt(a),
< 		numberToString: (a: number) => a.toString(),
< 		splitStrByLine: (a: string) => a.split('\n'),
< 		pick: (list: any[], i: number) => list[i - 1],
< 		listLen: (list: any[]) => list.length,
< 		random: (probability: number) => Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * 100) < probability,
< 		rannum: (min: number, max: number) => min + Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * (max - min + 1)),
< 		randomPick: (list: any[]) => list[Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * list.length)],
< 		dailyRandom: (probability: number) => Math.floor(seedrandom(`${day}:${expr.id}`)() * 100) < probability,
< 		dailyRannum: (min: number, max: number) => min + Math.floor(seedrandom(`${day}:${expr.id}`)() * (max - min + 1)),
< 		dailyRandomPick: (list: any[]) => list[Math.floor(seedrandom(`${day}:${expr.id}`)() * list.length)],
< 		seedRandom: (seed: any, probability: number) => Math.floor(seedrandom(seed)() * 100) < probability,
< 		seedRannum: (seed: any, min: number, max: number) => min + Math.floor(seedrandom(seed)() * (max - min + 1)),
< 		seedRandomPick: (seed: any, list: any[]) => list[Math.floor(seedrandom(seed)() * list.length)],
< 		DRPWPM: (list: string[]) => {
< 			const xs: any[] = [];
< 			let totalFactor = 0;
< 			for (const x of list) {
< 				const parts = x.split(' ');
< 				const factor = parseInt(parts.pop()!, 10);
< 				const text = parts.join(' ');
< 				totalFactor += factor;
< 				xs.push({ factor, text });
< 			}
< 			const r = seedrandom(`${day}:${expr.id}`)() * totalFactor;
< 			let stackedFactor = 0;
< 			for (const x of xs) {
< 				if (r >= stackedFactor && r <= stackedFactor + x.factor) {
< 					return x.text;
< 				} else {
< 					stackedFactor += x.factor;
< 				}
< 			}
< 			return xs[0].text;
< 		},
< 	};
---
>   // SHOULD be fine to ignore since it's intended + function shape isn't defined
>   // eslint-disable-next-line @typescript-eslint/ban-types
>   const funcs: Record<string, Function> = {
>     not: (a: boolean) => !a,
>     or: (a: boolean, b: boolean) => a || b,
>     and: (a: boolean, b: boolean) => a && b,
>     eq: (a: any, b: any) => a === b,
>     notEq: (a: any, b: any) => a !== b,
>     gt: (a: number, b: number) => a > b,
>     lt: (a: number, b: number) => a < b,
>     gtEq: (a: number, b: number) => a >= b,
>     ltEq: (a: number, b: number) => a <= b,
>     if: (bool: boolean, a: any, b: any) => (bool ? a : b),
>     for: (times: number, fn: Fn) => {
>       const result: any[] = [];
>       for (let i = 0; i < times; i++) {
>         result.push(
>           fn.exec({
>             [fn.slots[0]]: i + 1,
>           })
>         );
>       }
>       return result;
>     },
>     add: (a: number, b: number) => a + b,
>     subtract: (a: number, b: number) => a - b,
>     multiply: (a: number, b: number) => a * b,
>     divide: (a: number, b: number) => a / b,
>     mod: (a: number, b: number) => a % b,
>     round: (a: number) => Math.round(a),
>     strLen: (a: string) => a.length,
>     strPick: (a: string, b: number) => a[b - 1],
>     strReplace: (a: string, b: string, c: string) => a.split(b).join(c),
>     strReverse: (a: string) => a.split("").reverse().join(""),
>     join: (texts: string[], separator: string) => texts.join(separator || ""),
>     stringToNumber: (a: string) => parseInt(a),
>     numberToString: (a: number) => a.toString(),
>     splitStrByLine: (a: string) => a.split("\n"),
>     pick: (list: any[], i: number) => list[i - 1],
>     listLen: (list: any[]) => list.length,
>     random: (probability: number) =>
>       Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * 100) < probability,
>     rannum: (min: number, max: number) =>
>       min +
>       Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * (max - min + 1)),
>     randomPick: (list: any[]) =>
>       list[Math.floor(seedrandom(`${randomSeed}:${expr.id}`)() * list.length)],
>     dailyRandom: (probability: number) =>
>       Math.floor(seedrandom(`${day}:${expr.id}`)() * 100) < probability,
>     dailyRannum: (min: number, max: number) =>
>       min + Math.floor(seedrandom(`${day}:${expr.id}`)() * (max - min + 1)),
>     dailyRandomPick: (list: any[]) =>
>       list[Math.floor(seedrandom(`${day}:${expr.id}`)() * list.length)],
>     seedRandom: (seed: any, probability: number) =>
>       Math.floor(seedrandom(seed)() * 100) < probability,
>     seedRannum: (seed: any, min: number, max: number) =>
>       min + Math.floor(seedrandom(seed)() * (max - min + 1)),
>     seedRandomPick: (seed: any, list: any[]) =>
>       list[Math.floor(seedrandom(seed)() * list.length)],
>     DRPWPM: (list: string[]) => {
>       const xs: any[] = [];
>       let totalFactor = 0;
>       for (const x of list) {
>         const parts = x.split(" ");
>         const factor = parseInt(parts.pop()!, 10);
>         const text = parts.join(" ");
>         totalFactor += factor;
>         xs.push({ factor, text });
>       }
>       const r = seedrandom(`${day}:${expr.id}`)() * totalFactor;
>       let stackedFactor = 0;
>       for (const x of xs) {
>         if (r >= stackedFactor && r <= stackedFactor + x.factor) {
>           return x.text;
>         } else {
>           stackedFactor += x.factor;
>         }
>       }
>       return xs[0].text;
>     },
>   };
245c546
< 	return funcs;
---
>   return funcs;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/hpml/type-checker.ts RiricaV13/scripts/hpml/type-checker.ts
1,6c1,6
< import autobind from 'autobind-decorator';
< import { isLiteralValue } from './expr';
< import { funcDefs } from './lib';
< import { envVarsDef } from '.';
< import type { Type, PageVar } from '.';
< import type { Expr, Variable } from './expr';
---
> import autobind from "autobind-decorator";
> import { isLiteralValue } from "./expr";
> import { funcDefs } from "./lib";
> import { envVarsDef } from ".";
> import type { Type, PageVar } from ".";
> import type { Expr, Variable } from "./expr";
9,11c9,11
< 	arg: number;
< 	expect: Type;
< 	actual: Type;
---
>   arg: number;
>   expect: Type;
>   actual: Type;
18,19c18,19
< 	public variables: Variable[];
< 	public pageVars: PageVar[];
---
>   public variables: Variable[];
>   public pageVars: PageVar[];
21,24c21,27
< 	constructor(variables: HpmlTypeChecker['variables'] = [], pageVars: HpmlTypeChecker['pageVars'] = []) {
< 		this.variables = variables;
< 		this.pageVars = pageVars;
< 	}
---
>   constructor(
>     variables: HpmlTypeChecker["variables"] = [],
>     pageVars: HpmlTypeChecker["pageVars"] = []
>   ) {
>     this.variables = variables;
>     this.pageVars = pageVars;
>   }
26,28c29,31
< 	@autobind
< 	public typeCheck(v: Expr): TypeError | null {
< 		if (isLiteralValue(v)) return null;
---
>   @autobind
>   public typeCheck(v: Expr): TypeError | null {
>     if (isLiteralValue(v)) return null;
30,33c33,36
< 		const def = funcDefs[v.type || ''];
< 		if (def == null) {
< 			throw new Error('Unknown type: ' + v.type);
< 		}
---
>     const def = funcDefs[v.type || ""];
>     if (def == null) {
>       throw new Error("Unknown type: " + v.type);
>     }
35c38
< 		const generic: Type[] = [];
---
>     const generic: Type[] = [];
37,40c40,43
< 		for (let i = 0; i < def.in.length; i++) {
< 			const arg = def.in[i];
< 			const type = this.infer(v.args[i]);
< 			if (type === null) continue;
---
>     for (let i = 0; i < def.in.length; i++) {
>       const arg = def.in[i];
>       const type = this.infer(v.args[i]);
>       if (type === null) continue;
42,59c45,62
< 			if (typeof arg === 'number') {
< 				if (generic[arg] === undefined) {
< 					generic[arg] = type;
< 				} else if (type !== generic[arg]) {
< 					return {
< 						arg: i,
< 						expect: generic[arg],
< 						actual: type,
< 					};
< 				}
< 			} else if (type !== arg) {
< 				return {
< 					arg: i,
< 					expect: arg,
< 					actual: type,
< 				};
< 			}
< 		}
---
>       if (typeof arg === "number") {
>         if (generic[arg] === undefined) {
>           generic[arg] = type;
>         } else if (type !== generic[arg]) {
>           return {
>             arg: i,
>             expect: generic[arg],
>             actual: type,
>           };
>         }
>       } else if (type !== arg) {
>         return {
>           arg: i,
>           expect: arg,
>           actual: type,
>         };
>       }
>     }
61,62c64,65
< 		return null;
< 	}
---
>     return null;
>   }
64,69c67,72
< 	@autobind
< 	public getExpectedType(v: Expr, slot: number): Type {
< 		const def = funcDefs[v.type || ''];
< 		if (def == null) {
< 			throw new Error('Unknown type: ' + v.type);
< 		}
---
>   @autobind
>   public getExpectedType(v: Expr, slot: number): Type {
>     const def = funcDefs[v.type || ""];
>     if (def == null) {
>       throw new Error("Unknown type: " + v.type);
>     }
71c74
< 		const generic: Type[] = [];
---
>     const generic: Type[] = [];
73,76c76,79
< 		for (let i = 0; i < def.in.length; i++) {
< 			const arg = def.in[i];
< 			const type = this.infer(v.args[i]);
< 			if (type === null) continue;
---
>     for (let i = 0; i < def.in.length; i++) {
>       const arg = def.in[i];
>       const type = this.infer(v.args[i]);
>       if (type === null) continue;
78,83c81,86
< 			if (typeof arg === 'number') {
< 				if (generic[arg] === undefined) {
< 					generic[arg] = type;
< 				}
< 			}
< 		}
---
>       if (typeof arg === "number") {
>         if (generic[arg] === undefined) {
>           generic[arg] = type;
>         }
>       }
>     }
85,90c88,93
< 		if (typeof def.in[slot] === 'number') {
< 			return generic[def.in[slot]] ?? null;
< 		} else {
< 			return def.in[slot];
< 		}
< 	}
---
>     if (typeof def.in[slot] === "number") {
>       return generic[def.in[slot]] ?? null;
>     } else {
>       return def.in[slot];
>     }
>   }
92,103c95,106
< 	@autobind
< 	public infer(v: Expr): Type {
< 		if (v.type === null) return null;
< 		if (v.type === 'text') return 'string';
< 		if (v.type === 'multiLineText') return 'string';
< 		if (v.type === 'textList') return 'stringArray';
< 		if (v.type === 'number') return 'number';
< 		if (v.type === 'ref') {
< 			const variable = this.variables.find(va => va.name === v.value);
< 			if (variable) {
< 				return this.infer(variable);
< 			}
---
>   @autobind
>   public infer(v: Expr): Type {
>     if (v.type === null) return null;
>     if (v.type === "text") return "string";
>     if (v.type === "multiLineText") return "string";
>     if (v.type === "textList") return "stringArray";
>     if (v.type === "number") return "number";
>     if (v.type === "ref") {
>       const variable = this.variables.find((va) => va.name === v.value);
>       if (variable) {
>         return this.infer(variable);
>       }
105,108c108,111
< 			const pageVar = this.pageVars.find(va => va.name === v.value);
< 			if (pageVar) {
< 				return pageVar.type;
< 			}
---
>       const pageVar = this.pageVars.find((va) => va.name === v.value);
>       if (pageVar) {
>         return pageVar.type;
>       }
110,113c113,116
< 			const envVar = envVarsDef[v.value || ''];
< 			if (envVar !== undefined) {
< 				return envVar;
< 			}
---
>       const envVar = envVarsDef[v.value || ""];
>       if (envVar !== undefined) {
>         return envVar;
>       }
115,119c118,122
< 			return null;
< 		}
< 		if (v.type === 'aiScriptVar') return null;
< 		if (v.type === 'fn') return null; // todo
< 		if (v.type.startsWith('fn:')) return null; // todo
---
>       return null;
>     }
>     if (v.type === "aiScriptVar") return null;
>     if (v.type === "fn") return null; // todo
>     if (v.type.startsWith("fn:")) return null; // todo
121c124
< 		const generic: Type[] = [];
---
>     const generic: Type[] = [];
123c126
< 		const def = funcDefs[v.type];
---
>     const def = funcDefs[v.type];
125,128c128,131
< 		for (let i = 0; i < def.in.length; i++) {
< 			const arg = def.in[i];
< 			if (typeof arg === 'number') {
< 				const type = this.infer(v.args[i]);
---
>     for (let i = 0; i < def.in.length; i++) {
>       const arg = def.in[i];
>       if (typeof arg === "number") {
>         const type = this.infer(v.args[i]);
130,138c133,141
< 				if (generic[arg] === undefined) {
< 					generic[arg] = type;
< 				} else {
< 					if (type !== generic[arg]) {
< 						generic[arg] = null;
< 					}
< 				}
< 			}
< 		}
---
>         if (generic[arg] === undefined) {
>           generic[arg] = type;
>         } else {
>           if (type !== generic[arg]) {
>             generic[arg] = null;
>           }
>         }
>       }
>     }
140,145c143,148
< 		if (typeof def.out === 'number') {
< 			return generic[def.out];
< 		} else {
< 			return def.out;
< 		}
< 	}
---
>     if (typeof def.out === "number") {
>       return generic[def.out];
>     } else {
>       return def.out;
>     }
>   }
147,155c150,158
< 	@autobind
< 	public getVarByName(name: string): Variable {
< 		const v = this.variables.find(x => x.name === name);
< 		if (v !== undefined) {
< 			return v;
< 		} else {
< 			throw new Error(`No such variable '${name}'`);
< 		}
< 	}
---
>   @autobind
>   public getVarByName(name: string): Variable {
>     const v = this.variables.find((x) => x.name === name);
>     if (v !== undefined) {
>       return v;
>     } else {
>       throw new Error(`No such variable '${name}'`);
>     }
>   }
157,161c160,166
< 	@autobind
< 	public getVarsByType(type: Type): Variable[] {
< 		if (type == null) return this.variables;
< 		return this.variables.filter(x => (this.infer(x) === null) || (this.infer(x) === type));
< 	}
---
>   @autobind
>   public getVarsByType(type: Type): Variable[] {
>     if (type == null) return this.variables;
>     return this.variables.filter(
>       (x) => this.infer(x) === null || this.infer(x) === type
>     );
>   }
163,167c168,174
< 	@autobind
< 	public getEnvVarsByType(type: Type): string[] {
< 		if (type == null) return Object.keys(envVarsDef);
< 		return Object.entries(envVarsDef).filter(([k, v]) => v === null || type === v).map(([k, v]) => k);
< 	}
---
>   @autobind
>   public getEnvVarsByType(type: Type): string[] {
>     if (type == null) return Object.keys(envVarsDef);
>     return Object.entries(envVarsDef)
>       .filter(([k, v]) => v === null || type === v)
>       .map(([k, v]) => k);
>   }
169,173c176,180
< 	@autobind
< 	public getPageVarsByType(type: Type): string[] {
< 		if (type == null) return this.pageVars.map(v => v.name);
< 		return this.pageVars.filter(v => type === v.type).map(v => v.name);
< 	}
---
>   @autobind
>   public getPageVarsByType(type: Type): string[] {
>     if (type == null) return this.pageVars.map((v) => v.name);
>     return this.pageVars.filter((v) => type === v.type).map((v) => v.name);
>   }
175,179c182,186
< 	@autobind
< 	public isUsedName(name: string) {
< 		if (this.variables.some(v => v.name === name)) {
< 			return true;
< 		}
---
>   @autobind
>   public isUsedName(name: string) {
>     if (this.variables.some((v) => v.name === name)) {
>       return true;
>     }
181,183c188,190
< 		if (this.pageVars.some(v => v.name === name)) {
< 			return true;
< 		}
---
>     if (this.pageVars.some((v) => v.name === name)) {
>       return true;
>     }
185,187c192,194
< 		if (envVarsDef[name]) {
< 			return true;
< 		}
---
>     if (envVarsDef[name]) {
>       return true;
>     }
189,190c196,197
< 		return false;
< 	}
---
>     return false;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/i18n.ts RiricaV13/scripts/i18n.ts
2c2
< 	public ts: T;
---
>   public ts: T;
4,5c4,5
< 	constructor(locale: T) {
< 		this.ts = locale;
---
>   constructor(locale: T) {
>     this.ts = locale;
7,10c7,10
< 		//#region BIND
< 		this.t = this.t.bind(this);
< 		//#endregion
< 	}
---
>     //#region BIND
>     this.t = this.t.bind(this);
>     //#endregion
>   }
12,16c12,18
< 	// string にしているのは、ドット区切りでのパス指定を許可するため
< 	// なるべくこのメソッド使うよりもlocale直接参照の方がvueのキャッシュ効いてパフォーマンスが良いかも
< 	public t(key: string, args?: Record<string, string | number>): string {
< 		try {
< 			let str = key.split('.').reduce((o, i) => o[i], this.ts) as unknown as string;
---
>   // string にしているのは、ドット区切りでのパス指定を許可するため
>   // なるべくこのメソッド使うよりもlocale直接参照の方がvueのキャッシュ効いてパフォーマンスが良いかも
>   public t(key: string, args?: Record<string, string | number>): string {
>     try {
>       let str = key
>         .split(".")
>         .reduce((o, i) => o[i], this.ts) as unknown as string;
18,28c20,30
< 			if (args) {
< 				for (const [k, v] of Object.entries(args)) {
< 					str = str.replace(`{${k}}`, v.toString());
< 				}
< 			}
< 			return str;
< 		} catch (err) {
< 			console.warn(`missing localization '${key}'`);
< 			return key;
< 		}
< 	}
---
>       if (args) {
>         for (const [k, v] of Object.entries(args)) {
>           str = str.replace(`{${k}}`, v.toString());
>         }
>       }
>       return str;
>     } catch (err) {
>       console.warn(`missing localization '${key}'`);
>       return key;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/idb-proxy.ts RiricaV13/scripts/idb-proxy.ts
3,7c3
< import {
< 	get as iget,
< 	set as iset,
< 	del as idel,
< } from 'idb-keyval';
---
> import { get as iget, set as iset, del as idel } from "idb-keyval";
11c7
< let idbAvailable = typeof window !== 'undefined' ? !!window.indexedDB : true;
---
> let idbAvailable = typeof window !== "undefined" ? !!window.indexedDB : true;
14,18c10,14
< 	iset('idb-test', 'test').catch(err => {
< 		console.error('idb error', err);
< 		console.error('indexedDB is unavailable. It will use localStorage.');
< 		idbAvailable = false;
< 	});
---
>   iset("idb-test", "test").catch((err) => {
>     console.error("idb error", err);
>     console.error("indexedDB is unavailable. It will use localStorage.");
>     idbAvailable = false;
>   });
20c16
< 	console.error('indexedDB is unavailable. It will use localStorage.');
---
>   console.error("indexedDB is unavailable. It will use localStorage.");
24,25c20,21
< 	if (idbAvailable) return iget(key);
< 	return JSON.parse(window.localStorage.getItem(fallbackName(key)));
---
>   if (idbAvailable) return iget(key);
>   return JSON.parse(window.localStorage.getItem(fallbackName(key)));
29,30c25,26
< 	if (idbAvailable) return iset(key, val);
< 	return window.localStorage.setItem(fallbackName(key), JSON.stringify(val));
---
>   if (idbAvailable) return iset(key, val);
>   return localStorage.setItem(fallbackName(key), JSON.stringify(val));
34,35c30,31
< 	if (idbAvailable) return idel(key);
< 	return window.localStorage.removeItem(fallbackName(key));
---
>   if (idbAvailable) return idel(key);
>   return localStorage.removeItem(fallbackName(key));
Only in misskeyV13/packages/frontend/src/scripts: init-chart.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/initialize-sw.ts RiricaV13/scripts/initialize-sw.ts
1c1,4
< import { lang } from '@/config';
---
> import { instance } from "@/instance";
> import { $i } from "@/account";
> import { api } from "@/os";
> import { lang } from "@/config";
4c7
< 	if (!('serviceWorker' in navigator)) return;
---
>   if (!("serviceWorker" in navigator)) return;
6,12c9,68
< 	navigator.serviceWorker.register(`/sw.js`, { scope: '/', type: 'classic' });
< 	navigator.serviceWorker.ready.then(registration => {
< 		registration.active?.postMessage({
< 			msg: 'initialize',
< 			lang,
< 		});
< 	});
---
>   navigator.serviceWorker.register(`/sw.js`, { scope: "/", type: "classic" });
>   navigator.serviceWorker.ready.then((registration) => {
>     registration.active?.postMessage({
>       msg: "initialize",
>       lang,
>     });
> 
>     if (instance.swPublickey && "PushManager" in window && $i && $i.token) {
>       // SEE: https://developer.mozilla.org/en-US/docs/Web/API/PushManager/subscribe#Parameters
>       registration.pushManager
>         .subscribe({
>           userVisibleOnly: true,
>           applicationServerKey: urlBase64ToUint8Array(instance.swPublickey),
>         })
>         .then((subscription) => {
>           function encode(buffer: ArrayBuffer | null) {
>             return btoa(
>               String.fromCharCode.apply(null, new Uint8Array(buffer))
>             );
>           }
> 
>           // Register
>           api("sw/register", {
>             endpoint: subscription.endpoint,
>             auth: encode(subscription.getKey("auth")),
>             publickey: encode(subscription.getKey("p256dh")),
>           });
>         })
>         // When subscribe failed
>         .catch(async (err: Error) => {
>           // 通知が許可されていなかったとき
>           if (err.name === "NotAllowedError") {
>             return;
>           }
> 
>           // 違うapplicationServerKey (または gcm_sender_id)のサブスクリプションが
>           // 既に存在していることが原因でエラーになった可能性があるので、
>           // そのサブスクリプションを解除しておく
>           const subscription = await registration.pushManager.getSubscription();
>           if (subscription) subscription.unsubscribe();
>         });
>     }
>   });
> }
> 
> /**
>  * Convert the URL safe base64 string to a Uint8Array
>  * @param base64String base64 string
>  */
> function urlBase64ToUint8Array(base64String: string): Uint8Array {
>   const padding = "=".repeat((4 - (base64String.length % 4)) % 4);
>   const base64 = (base64String + padding).replace(/-/g, "+").replace(/_/g, "/");
> 
>   const rawData = window.atob(base64);
>   const outputArray = new Uint8Array(rawData.length);
> 
>   for (let i = 0; i < rawData.length; ++i) {
>     outputArray[i] = rawData.charCodeAt(i);
>   }
>   return outputArray;
Only in misskeyV13/packages/frontend/src/scripts: intl-const.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/is-device-darkmode.ts RiricaV13/scripts/is-device-darkmode.ts
2c2
< 	return window.matchMedia('(prefers-color-scheme: dark)').matches;
---
>   return window.matchMedia("(prefers-color-scheme: dark)").matches;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/keycode.ts RiricaV13/scripts/keycode.ts
2,7c2,9
< 	if (Object.keys(aliases).some(a => a.toLowerCase() === input.toLowerCase())) {
< 		const codes = aliases[input];
< 		return Array.isArray(codes) ? codes : [codes];
< 	} else {
< 		return [input];
< 	}
---
>   if (
>     Object.keys(aliases).some((a) => a.toLowerCase() === input.toLowerCase())
>   ) {
>     const codes = aliases[input];
>     return Array.isArray(codes) ? codes : [codes];
>   } else {
>     return [input];
>   }
11,17c13,19
< 	'esc': 'Escape',
< 	'enter': ['Enter', 'NumpadEnter'],
< 	'up': 'ArrowUp',
< 	'down': 'ArrowDown',
< 	'left': 'ArrowLeft',
< 	'right': 'ArrowRight',
< 	'plus': ['NumpadAdd', 'Semicolon'],
---
>   esc: "Escape",
>   enter: ["Enter", "NumpadEnter"],
>   up: "ArrowUp",
>   down: "ArrowDown",
>   left: "ArrowLeft",
>   right: "ArrowRight",
>   plus: ["NumpadAdd", "Semicolon"],
21,22c23,24
< * Programmatically add the following
< */
---
>  * Programmatically add the following
>  */
26,27c28,29
< 	const char = String.fromCharCode(i);
< 	aliases[char] = `Key${char.toUpperCase()}`;
---
>   const char = String.fromCharCode(i);
>   aliases[char] = `Key${char.toUpperCase()}`;
32c34
< 	aliases[i] = [`Numpad${i}`, `Digit${i}`];
---
>   aliases[i] = [`Numpad${i}`, `Digit${i}`];
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/langmap.ts RiricaV13/scripts/langmap.ts
3,665c3,665
< 	'ach': {
< 		nativeName: 'Lwo',
< 	},
< 	'ady': {
< 		nativeName: 'Адыгэбзэ',
< 	},
< 	'af': {
< 		nativeName: 'Afrikaans',
< 	},
< 	'af-NA': {
< 		nativeName: 'Afrikaans (Namibia)',
< 	},
< 	'af-ZA': {
< 		nativeName: 'Afrikaans (South Africa)',
< 	},
< 	'ak': {
< 		nativeName: 'Tɕɥi',
< 	},
< 	'ar': {
< 		nativeName: 'العربية',
< 	},
< 	'ar-AR': {
< 		nativeName: 'العربية',
< 	},
< 	'ar-MA': {
< 		nativeName: 'العربية',
< 	},
< 	'ar-SA': {
< 		nativeName: 'العربية (السعودية)',
< 	},
< 	'ay-BO': {
< 		nativeName: 'Aymar aru',
< 	},
< 	'az': {
< 		nativeName: 'Azərbaycan dili',
< 	},
< 	'az-AZ': {
< 		nativeName: 'Azərbaycan dili',
< 	},
< 	'be-BY': {
< 		nativeName: 'Беларуская',
< 	},
< 	'bg': {
< 		nativeName: 'Български',
< 	},
< 	'bg-BG': {
< 		nativeName: 'Български',
< 	},
< 	'bn': {
< 		nativeName: 'বাংলা',
< 	},
< 	'bn-IN': {
< 		nativeName: 'বাংলা (ভারত)',
< 	},
< 	'bn-BD': {
< 		nativeName: 'বাংলা(বাংলাদেশ)',
< 	},
< 	'br': {
< 		nativeName: 'Brezhoneg',
< 	},
< 	'bs-BA': {
< 		nativeName: 'Bosanski',
< 	},
< 	'ca': {
< 		nativeName: 'Català',
< 	},
< 	'ca-ES': {
< 		nativeName: 'Català',
< 	},
< 	'cak': {
< 		nativeName: 'Maya Kaqchikel',
< 	},
< 	'ck-US': {
< 		nativeName: 'ᏣᎳᎩ (tsalagi)',
< 	},
< 	'cs': {
< 		nativeName: 'Čeština',
< 	},
< 	'cs-CZ': {
< 		nativeName: 'Čeština',
< 	},
< 	'cy': {
< 		nativeName: 'Cymraeg',
< 	},
< 	'cy-GB': {
< 		nativeName: 'Cymraeg',
< 	},
< 	'da': {
< 		nativeName: 'Dansk',
< 	},
< 	'da-DK': {
< 		nativeName: 'Dansk',
< 	},
< 	'de': {
< 		nativeName: 'Deutsch',
< 	},
< 	'de-AT': {
< 		nativeName: 'Deutsch (Österreich)',
< 	},
< 	'de-DE': {
< 		nativeName: 'Deutsch (Deutschland)',
< 	},
< 	'de-CH': {
< 		nativeName: 'Deutsch (Schweiz)',
< 	},
< 	'dsb': {
< 		nativeName: 'Dolnoserbšćina',
< 	},
< 	'el': {
< 		nativeName: 'Ελληνικά',
< 	},
< 	'el-GR': {
< 		nativeName: 'Ελληνικά',
< 	},
< 	'en': {
< 		nativeName: 'English',
< 	},
< 	'en-GB': {
< 		nativeName: 'English (UK)',
< 	},
< 	'en-AU': {
< 		nativeName: 'English (Australia)',
< 	},
< 	'en-CA': {
< 		nativeName: 'English (Canada)',
< 	},
< 	'en-IE': {
< 		nativeName: 'English (Ireland)',
< 	},
< 	'en-IN': {
< 		nativeName: 'English (India)',
< 	},
< 	'en-PI': {
< 		nativeName: 'English (Pirate)',
< 	},
< 	'en-SG': {
< 		nativeName: 'English (Singapore)',
< 	},
< 	'en-UD': {
< 		nativeName: 'English (Upside Down)',
< 	},
< 	'en-US': {
< 		nativeName: 'English (US)',
< 	},
< 	'en-ZA': {
< 		nativeName: 'English (South Africa)',
< 	},
< 	'en@pirate': {
< 		nativeName: 'English (Pirate)',
< 	},
< 	'eo': {
< 		nativeName: 'Esperanto',
< 	},
< 	'eo-EO': {
< 		nativeName: 'Esperanto',
< 	},
< 	'es': {
< 		nativeName: 'Español',
< 	},
< 	'es-AR': {
< 		nativeName: 'Español (Argentine)',
< 	},
< 	'es-419': {
< 		nativeName: 'Español (Latinoamérica)',
< 	},
< 	'es-CL': {
< 		nativeName: 'Español (Chile)',
< 	},
< 	'es-CO': {
< 		nativeName: 'Español (Colombia)',
< 	},
< 	'es-EC': {
< 		nativeName: 'Español (Ecuador)',
< 	},
< 	'es-ES': {
< 		nativeName: 'Español (España)',
< 	},
< 	'es-LA': {
< 		nativeName: 'Español (Latinoamérica)',
< 	},
< 	'es-NI': {
< 		nativeName: 'Español (Nicaragua)',
< 	},
< 	'es-MX': {
< 		nativeName: 'Español (México)',
< 	},
< 	'es-US': {
< 		nativeName: 'Español (Estados Unidos)',
< 	},
< 	'es-VE': {
< 		nativeName: 'Español (Venezuela)',
< 	},
< 	'et': {
< 		nativeName: 'eesti keel',
< 	},
< 	'et-EE': {
< 		nativeName: 'Eesti (Estonia)',
< 	},
< 	'eu': {
< 		nativeName: 'Euskara',
< 	},
< 	'eu-ES': {
< 		nativeName: 'Euskara',
< 	},
< 	'fa': {
< 		nativeName: 'فارسی',
< 	},
< 	'fa-IR': {
< 		nativeName: 'فارسی',
< 	},
< 	'fb-LT': {
< 		nativeName: 'Leet Speak',
< 	},
< 	'ff': {
< 		nativeName: 'Fulah',
< 	},
< 	'fi': {
< 		nativeName: 'Suomi',
< 	},
< 	'fi-FI': {
< 		nativeName: 'Suomi',
< 	},
< 	'fo': {
< 		nativeName: 'Føroyskt',
< 	},
< 	'fo-FO': {
< 		nativeName: 'Føroyskt (Færeyjar)',
< 	},
< 	'fr': {
< 		nativeName: 'Français',
< 	},
< 	'fr-CA': {
< 		nativeName: 'Français (Canada)',
< 	},
< 	'fr-FR': {
< 		nativeName: 'Français (France)',
< 	},
< 	'fr-BE': {
< 		nativeName: 'Français (Belgique)',
< 	},
< 	'fr-CH': {
< 		nativeName: 'Français (Suisse)',
< 	},
< 	'fy-NL': {
< 		nativeName: 'Frysk',
< 	},
< 	'ga': {
< 		nativeName: 'Gaeilge',
< 	},
< 	'ga-IE': {
< 		nativeName: 'Gaeilge',
< 	},
< 	'gd': {
< 		nativeName: 'Gàidhlig',
< 	},
< 	'gl': {
< 		nativeName: 'Galego',
< 	},
< 	'gl-ES': {
< 		nativeName: 'Galego',
< 	},
< 	'gn-PY': {
< 		nativeName: 'Avañe\'ẽ',
< 	},
< 	'gu-IN': {
< 		nativeName: 'ગુજરાતી',
< 	},
< 	'gv': {
< 		nativeName: 'Gaelg',
< 	},
< 	'gx-GR': {
< 		nativeName: 'Ἑλληνική ἀρχαία',
< 	},
< 	'he': {
< 		nativeName: 'עברית‏',
< 	},
< 	'he-IL': {
< 		nativeName: 'עברית‏',
< 	},
< 	'hi': {
< 		nativeName: 'हिन्दी',
< 	},
< 	'hi-IN': {
< 		nativeName: 'हिन्दी',
< 	},
< 	'hr': {
< 		nativeName: 'Hrvatski',
< 	},
< 	'hr-HR': {
< 		nativeName: 'Hrvatski',
< 	},
< 	'hsb': {
< 		nativeName: 'Hornjoserbšćina',
< 	},
< 	'ht': {
< 		nativeName: 'Kreyòl',
< 	},
< 	'hu': {
< 		nativeName: 'Magyar',
< 	},
< 	'hu-HU': {
< 		nativeName: 'Magyar',
< 	},
< 	'hy': {
< 		nativeName: 'Հայերեն',
< 	},
< 	'hy-AM': {
< 		nativeName: 'Հայերեն (Հայաստան)',
< 	},
< 	'id': {
< 		nativeName: 'Bahasa Indonesia',
< 	},
< 	'id-ID': {
< 		nativeName: 'Bahasa Indonesia',
< 	},
< 	'is': {
< 		nativeName: 'Íslenska',
< 	},
< 	'is-IS': {
< 		nativeName: 'Íslenska (Iceland)',
< 	},
< 	'it': {
< 		nativeName: 'Italiano',
< 	},
< 	'it-IT': {
< 		nativeName: 'Italiano',
< 	},
< 	'ja': {
< 		nativeName: '日本語',
< 	},
< 	'ja-JP': {
< 		nativeName: '日本語 (日本)',
< 	},
< 	'jv-ID': {
< 		nativeName: 'Basa Jawa',
< 	},
< 	'ka-GE': {
< 		nativeName: 'ქართული',
< 	},
< 	'kk-KZ': {
< 		nativeName: 'Қазақша',
< 	},
< 	'km': {
< 		nativeName: 'ភាសាខ្មែរ',
< 	},
< 	'kl': {
< 		nativeName: 'kalaallisut',
< 	},
< 	'km-KH': {
< 		nativeName: 'ភាសាខ្មែរ',
< 	},
< 	'kab': {
< 		nativeName: 'Taqbaylit',
< 	},
< 	'kn': {
< 		nativeName: 'ಕನ್ನಡ',
< 	},
< 	'kn-IN': {
< 		nativeName: 'ಕನ್ನಡ (India)',
< 	},
< 	'ko': {
< 		nativeName: '한국어',
< 	},
< 	'ko-KR': {
< 		nativeName: '한국어 (한국)',
< 	},
< 	'ku-TR': {
< 		nativeName: 'Kurdî',
< 	},
< 	'kw': {
< 		nativeName: 'Kernewek',
< 	},
< 	'la': {
< 		nativeName: 'Latin',
< 	},
< 	'la-VA': {
< 		nativeName: 'Latin',
< 	},
< 	'lb': {
< 		nativeName: 'Lëtzebuergesch',
< 	},
< 	'li-NL': {
< 		nativeName: 'Lèmbörgs',
< 	},
< 	'lt': {
< 		nativeName: 'Lietuvių',
< 	},
< 	'lt-LT': {
< 		nativeName: 'Lietuvių',
< 	},
< 	'lv': {
< 		nativeName: 'Latviešu',
< 	},
< 	'lv-LV': {
< 		nativeName: 'Latviešu',
< 	},
< 	'mai': {
< 		nativeName: 'मैथिली, মৈথিলী',
< 	},
< 	'mg-MG': {
< 		nativeName: 'Malagasy',
< 	},
< 	'mk': {
< 		nativeName: 'Македонски',
< 	},
< 	'mk-MK': {
< 		nativeName: 'Македонски (Македонски)',
< 	},
< 	'ml': {
< 		nativeName: 'മലയാളം',
< 	},
< 	'ml-IN': {
< 		nativeName: 'മലയാളം',
< 	},
< 	'mn-MN': {
< 		nativeName: 'Монгол',
< 	},
< 	'mr': {
< 		nativeName: 'मराठी',
< 	},
< 	'mr-IN': {
< 		nativeName: 'मराठी',
< 	},
< 	'ms': {
< 		nativeName: 'Bahasa Melayu',
< 	},
< 	'ms-MY': {
< 		nativeName: 'Bahasa Melayu',
< 	},
< 	'mt': {
< 		nativeName: 'Malti',
< 	},
< 	'mt-MT': {
< 		nativeName: 'Malti',
< 	},
< 	'my': {
< 		nativeName: 'ဗမာစကာ',
< 	},
< 	'no': {
< 		nativeName: 'Norsk',
< 	},
< 	'nb': {
< 		nativeName: 'Norsk (bokmål)',
< 	},
< 	'nb-NO': {
< 		nativeName: 'Norsk (bokmål)',
< 	},
< 	'ne': {
< 		nativeName: 'नेपाली',
< 	},
< 	'ne-NP': {
< 		nativeName: 'नेपाली',
< 	},
< 	'nl': {
< 		nativeName: 'Nederlands',
< 	},
< 	'nl-BE': {
< 		nativeName: 'Nederlands (België)',
< 	},
< 	'nl-NL': {
< 		nativeName: 'Nederlands (Nederland)',
< 	},
< 	'nn-NO': {
< 		nativeName: 'Norsk (nynorsk)',
< 	},
< 	'oc': {
< 		nativeName: 'Occitan',
< 	},
< 	'or-IN': {
< 		nativeName: 'ଓଡ଼ିଆ',
< 	},
< 	'pa': {
< 		nativeName: 'ਪੰਜਾਬੀ',
< 	},
< 	'pa-IN': {
< 		nativeName: 'ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)',
< 	},
< 	'pl': {
< 		nativeName: 'Polski',
< 	},
< 	'pl-PL': {
< 		nativeName: 'Polski',
< 	},
< 	'ps-AF': {
< 		nativeName: 'پښتو',
< 	},
< 	'pt': {
< 		nativeName: 'Português',
< 	},
< 	'pt-BR': {
< 		nativeName: 'Português (Brasil)',
< 	},
< 	'pt-PT': {
< 		nativeName: 'Português (Portugal)',
< 	},
< 	'qu-PE': {
< 		nativeName: 'Qhichwa',
< 	},
< 	'rm-CH': {
< 		nativeName: 'Rumantsch',
< 	},
< 	'ro': {
< 		nativeName: 'Română',
< 	},
< 	'ro-RO': {
< 		nativeName: 'Română',
< 	},
< 	'ru': {
< 		nativeName: 'Русский',
< 	},
< 	'ru-RU': {
< 		nativeName: 'Русский',
< 	},
< 	'sa-IN': {
< 		nativeName: 'संस्कृतम्',
< 	},
< 	'se-NO': {
< 		nativeName: 'Davvisámegiella',
< 	},
< 	'sh': {
< 		nativeName: 'српскохрватски',
< 	},
< 	'si-LK': {
< 		nativeName: 'සිංහල',
< 	},
< 	'sk': {
< 		nativeName: 'Slovenčina',
< 	},
< 	'sk-SK': {
< 		nativeName: 'Slovenčina (Slovakia)',
< 	},
< 	'sl': {
< 		nativeName: 'Slovenščina',
< 	},
< 	'sl-SI': {
< 		nativeName: 'Slovenščina',
< 	},
< 	'so-SO': {
< 		nativeName: 'Soomaaliga',
< 	},
< 	'sq': {
< 		nativeName: 'Shqip',
< 	},
< 	'sq-AL': {
< 		nativeName: 'Shqip',
< 	},
< 	'sr': {
< 		nativeName: 'Српски',
< 	},
< 	'sr-RS': {
< 		nativeName: 'Српски (Serbia)',
< 	},
< 	'su': {
< 		nativeName: 'Basa Sunda',
< 	},
< 	'sv': {
< 		nativeName: 'Svenska',
< 	},
< 	'sv-SE': {
< 		nativeName: 'Svenska',
< 	},
< 	'sw': {
< 		nativeName: 'Kiswahili',
< 	},
< 	'sw-KE': {
< 		nativeName: 'Kiswahili',
< 	},
< 	'ta': {
< 		nativeName: 'தமிழ்',
< 	},
< 	'ta-IN': {
< 		nativeName: 'தமிழ்',
< 	},
< 	'te': {
< 		nativeName: 'తెలుగు',
< 	},
< 	'te-IN': {
< 		nativeName: 'తెలుగు',
< 	},
< 	'tg': {
< 		nativeName: 'забо́ни тоҷикӣ́',
< 	},
< 	'tg-TJ': {
< 		nativeName: 'тоҷикӣ',
< 	},
< 	'th': {
< 		nativeName: 'ภาษาไทย',
< 	},
< 	'th-TH': {
< 		nativeName: 'ภาษาไทย (ประเทศไทย)',
< 	},
< 	'fil': {
< 		nativeName: 'Filipino',
< 	},
< 	'tlh': {
< 		nativeName: 'tlhIngan-Hol',
< 	},
< 	'tr': {
< 		nativeName: 'Türkçe',
< 	},
< 	'tr-TR': {
< 		nativeName: 'Türkçe',
< 	},
< 	'tt-RU': {
< 		nativeName: 'татарча',
< 	},
< 	'uk': {
< 		nativeName: 'Українська',
< 	},
< 	'uk-UA': {
< 		nativeName: 'Українська',
< 	},
< 	'ur': {
< 		nativeName: 'اردو',
< 	},
< 	'ur-PK': {
< 		nativeName: 'اردو',
< 	},
< 	'uz': {
< 		nativeName: 'O\'zbek',
< 	},
< 	'uz-UZ': {
< 		nativeName: 'O\'zbek',
< 	},
< 	'vi': {
< 		nativeName: 'Tiếng Việt',
< 	},
< 	'vi-VN': {
< 		nativeName: 'Tiếng Việt',
< 	},
< 	'xh-ZA': {
< 		nativeName: 'isiXhosa',
< 	},
< 	'yi': {
< 		nativeName: 'ייִדיש',
< 	},
< 	'yi-DE': {
< 		nativeName: 'ייִדיש (German)',
< 	},
< 	'zh': {
< 		nativeName: '中文',
< 	},
< 	'zh-Hans': {
< 		nativeName: '中文简体',
< 	},
< 	'zh-Hant': {
< 		nativeName: '中文繁體',
< 	},
< 	'zh-CN': {
< 		nativeName: '中文（中国大陆）',
< 	},
< 	'zh-HK': {
< 		nativeName: '中文（香港）',
< 	},
< 	'zh-SG': {
< 		nativeName: '中文（新加坡）',
< 	},
< 	'zh-TW': {
< 		nativeName: '中文（台灣）',
< 	},
< 	'zu-ZA': {
< 		nativeName: 'isiZulu',
< 	},
---
>   ach: {
>     nativeName: "Lwo",
>   },
>   ady: {
>     nativeName: "Адыгэбзэ",
>   },
>   af: {
>     nativeName: "Afrikaans",
>   },
>   "af-NA": {
>     nativeName: "Afrikaans (Namibia)",
>   },
>   "af-ZA": {
>     nativeName: "Afrikaans (South Africa)",
>   },
>   ak: {
>     nativeName: "Tɕɥi",
>   },
>   ar: {
>     nativeName: "العربية",
>   },
>   "ar-AR": {
>     nativeName: "العربية",
>   },
>   "ar-MA": {
>     nativeName: "العربية",
>   },
>   "ar-SA": {
>     nativeName: "العربية (السعودية)",
>   },
>   "ay-BO": {
>     nativeName: "Aymar aru",
>   },
>   az: {
>     nativeName: "Azərbaycan dili",
>   },
>   "az-AZ": {
>     nativeName: "Azərbaycan dili",
>   },
>   "be-BY": {
>     nativeName: "Беларуская",
>   },
>   bg: {
>     nativeName: "Български",
>   },
>   "bg-BG": {
>     nativeName: "Български",
>   },
>   bn: {
>     nativeName: "বাংলা",
>   },
>   "bn-IN": {
>     nativeName: "বাংলা (ভারত)",
>   },
>   "bn-BD": {
>     nativeName: "বাংলা(বাংলাদেশ)",
>   },
>   br: {
>     nativeName: "Brezhoneg",
>   },
>   "bs-BA": {
>     nativeName: "Bosanski",
>   },
>   ca: {
>     nativeName: "Català",
>   },
>   "ca-ES": {
>     nativeName: "Català",
>   },
>   cak: {
>     nativeName: "Maya Kaqchikel",
>   },
>   "ck-US": {
>     nativeName: "ᏣᎳᎩ (tsalagi)",
>   },
>   cs: {
>     nativeName: "Čeština",
>   },
>   "cs-CZ": {
>     nativeName: "Čeština",
>   },
>   cy: {
>     nativeName: "Cymraeg",
>   },
>   "cy-GB": {
>     nativeName: "Cymraeg",
>   },
>   da: {
>     nativeName: "Dansk",
>   },
>   "da-DK": {
>     nativeName: "Dansk",
>   },
>   de: {
>     nativeName: "Deutsch",
>   },
>   "de-AT": {
>     nativeName: "Deutsch (Österreich)",
>   },
>   "de-DE": {
>     nativeName: "Deutsch (Deutschland)",
>   },
>   "de-CH": {
>     nativeName: "Deutsch (Schweiz)",
>   },
>   dsb: {
>     nativeName: "Dolnoserbšćina",
>   },
>   el: {
>     nativeName: "Ελληνικά",
>   },
>   "el-GR": {
>     nativeName: "Ελληνικά",
>   },
>   en: {
>     nativeName: "English",
>   },
>   "en-GB": {
>     nativeName: "English (UK)",
>   },
>   "en-AU": {
>     nativeName: "English (Australia)",
>   },
>   "en-CA": {
>     nativeName: "English (Canada)",
>   },
>   "en-IE": {
>     nativeName: "English (Ireland)",
>   },
>   "en-IN": {
>     nativeName: "English (India)",
>   },
>   "en-PI": {
>     nativeName: "English (Pirate)",
>   },
>   "en-SG": {
>     nativeName: "English (Singapore)",
>   },
>   "en-UD": {
>     nativeName: "English (Upside Down)",
>   },
>   "en-US": {
>     nativeName: "English (US)",
>   },
>   "en-ZA": {
>     nativeName: "English (South Africa)",
>   },
>   "en@pirate": {
>     nativeName: "English (Pirate)",
>   },
>   eo: {
>     nativeName: "Esperanto",
>   },
>   "eo-EO": {
>     nativeName: "Esperanto",
>   },
>   es: {
>     nativeName: "Español",
>   },
>   "es-AR": {
>     nativeName: "Español (Argentine)",
>   },
>   "es-419": {
>     nativeName: "Español (Latinoamérica)",
>   },
>   "es-CL": {
>     nativeName: "Español (Chile)",
>   },
>   "es-CO": {
>     nativeName: "Español (Colombia)",
>   },
>   "es-EC": {
>     nativeName: "Español (Ecuador)",
>   },
>   "es-ES": {
>     nativeName: "Español (España)",
>   },
>   "es-LA": {
>     nativeName: "Español (Latinoamérica)",
>   },
>   "es-NI": {
>     nativeName: "Español (Nicaragua)",
>   },
>   "es-MX": {
>     nativeName: "Español (México)",
>   },
>   "es-US": {
>     nativeName: "Español (Estados Unidos)",
>   },
>   "es-VE": {
>     nativeName: "Español (Venezuela)",
>   },
>   et: {
>     nativeName: "eesti keel",
>   },
>   "et-EE": {
>     nativeName: "Eesti (Estonia)",
>   },
>   eu: {
>     nativeName: "Euskara",
>   },
>   "eu-ES": {
>     nativeName: "Euskara",
>   },
>   fa: {
>     nativeName: "فارسی",
>   },
>   "fa-IR": {
>     nativeName: "فارسی",
>   },
>   "fb-LT": {
>     nativeName: "Leet Speak",
>   },
>   ff: {
>     nativeName: "Fulah",
>   },
>   fi: {
>     nativeName: "Suomi",
>   },
>   "fi-FI": {
>     nativeName: "Suomi",
>   },
>   fo: {
>     nativeName: "Føroyskt",
>   },
>   "fo-FO": {
>     nativeName: "Føroyskt (Færeyjar)",
>   },
>   fr: {
>     nativeName: "Français",
>   },
>   "fr-CA": {
>     nativeName: "Français (Canada)",
>   },
>   "fr-FR": {
>     nativeName: "Français (France)",
>   },
>   "fr-BE": {
>     nativeName: "Français (Belgique)",
>   },
>   "fr-CH": {
>     nativeName: "Français (Suisse)",
>   },
>   "fy-NL": {
>     nativeName: "Frysk",
>   },
>   ga: {
>     nativeName: "Gaeilge",
>   },
>   "ga-IE": {
>     nativeName: "Gaeilge",
>   },
>   gd: {
>     nativeName: "Gàidhlig",
>   },
>   gl: {
>     nativeName: "Galego",
>   },
>   "gl-ES": {
>     nativeName: "Galego",
>   },
>   "gn-PY": {
>     nativeName: "Avañe'ẽ",
>   },
>   "gu-IN": {
>     nativeName: "ગુજરાતી",
>   },
>   gv: {
>     nativeName: "Gaelg",
>   },
>   "gx-GR": {
>     nativeName: "Ἑλληνική ἀρχαία",
>   },
>   he: {
>     nativeName: "עברית‏",
>   },
>   "he-IL": {
>     nativeName: "עברית‏",
>   },
>   hi: {
>     nativeName: "हिन्दी",
>   },
>   "hi-IN": {
>     nativeName: "हिन्दी",
>   },
>   hr: {
>     nativeName: "Hrvatski",
>   },
>   "hr-HR": {
>     nativeName: "Hrvatski",
>   },
>   hsb: {
>     nativeName: "Hornjoserbšćina",
>   },
>   ht: {
>     nativeName: "Kreyòl",
>   },
>   hu: {
>     nativeName: "Magyar",
>   },
>   "hu-HU": {
>     nativeName: "Magyar",
>   },
>   hy: {
>     nativeName: "Հայերեն",
>   },
>   "hy-AM": {
>     nativeName: "Հայերեն (Հայաստան)",
>   },
>   id: {
>     nativeName: "Bahasa Indonesia",
>   },
>   "id-ID": {
>     nativeName: "Bahasa Indonesia",
>   },
>   is: {
>     nativeName: "Íslenska",
>   },
>   "is-IS": {
>     nativeName: "Íslenska (Iceland)",
>   },
>   it: {
>     nativeName: "Italiano",
>   },
>   "it-IT": {
>     nativeName: "Italiano",
>   },
>   ja: {
>     nativeName: "日本語",
>   },
>   "ja-JP": {
>     nativeName: "日本語 (日本)",
>   },
>   "jv-ID": {
>     nativeName: "Basa Jawa",
>   },
>   "ka-GE": {
>     nativeName: "ქართული",
>   },
>   "kk-KZ": {
>     nativeName: "Қазақша",
>   },
>   km: {
>     nativeName: "ភាសាខ្មែរ",
>   },
>   kl: {
>     nativeName: "kalaallisut",
>   },
>   "km-KH": {
>     nativeName: "ភាសាខ្មែរ",
>   },
>   kab: {
>     nativeName: "Taqbaylit",
>   },
>   kn: {
>     nativeName: "ಕನ್ನಡ",
>   },
>   "kn-IN": {
>     nativeName: "ಕನ್ನಡ (India)",
>   },
>   ko: {
>     nativeName: "한국어",
>   },
>   "ko-KR": {
>     nativeName: "한국어 (한국)",
>   },
>   "ku-TR": {
>     nativeName: "Kurdî",
>   },
>   kw: {
>     nativeName: "Kernewek",
>   },
>   la: {
>     nativeName: "Latin",
>   },
>   "la-VA": {
>     nativeName: "Latin",
>   },
>   lb: {
>     nativeName: "Lëtzebuergesch",
>   },
>   "li-NL": {
>     nativeName: "Lèmbörgs",
>   },
>   lt: {
>     nativeName: "Lietuvių",
>   },
>   "lt-LT": {
>     nativeName: "Lietuvių",
>   },
>   lv: {
>     nativeName: "Latviešu",
>   },
>   "lv-LV": {
>     nativeName: "Latviešu",
>   },
>   mai: {
>     nativeName: "मैथिली, মৈথিলী",
>   },
>   "mg-MG": {
>     nativeName: "Malagasy",
>   },
>   mk: {
>     nativeName: "Македонски",
>   },
>   "mk-MK": {
>     nativeName: "Македонски (Македонски)",
>   },
>   ml: {
>     nativeName: "മലയാളം",
>   },
>   "ml-IN": {
>     nativeName: "മലയാളം",
>   },
>   "mn-MN": {
>     nativeName: "Монгол",
>   },
>   mr: {
>     nativeName: "मराठी",
>   },
>   "mr-IN": {
>     nativeName: "मराठी",
>   },
>   ms: {
>     nativeName: "Bahasa Melayu",
>   },
>   "ms-MY": {
>     nativeName: "Bahasa Melayu",
>   },
>   mt: {
>     nativeName: "Malti",
>   },
>   "mt-MT": {
>     nativeName: "Malti",
>   },
>   my: {
>     nativeName: "ဗမာစကာ",
>   },
>   no: {
>     nativeName: "Norsk",
>   },
>   nb: {
>     nativeName: "Norsk (bokmål)",
>   },
>   "nb-NO": {
>     nativeName: "Norsk (bokmål)",
>   },
>   ne: {
>     nativeName: "नेपाली",
>   },
>   "ne-NP": {
>     nativeName: "नेपाली",
>   },
>   nl: {
>     nativeName: "Nederlands",
>   },
>   "nl-BE": {
>     nativeName: "Nederlands (België)",
>   },
>   "nl-NL": {
>     nativeName: "Nederlands (Nederland)",
>   },
>   "nn-NO": {
>     nativeName: "Norsk (nynorsk)",
>   },
>   oc: {
>     nativeName: "Occitan",
>   },
>   "or-IN": {
>     nativeName: "ଓଡ଼ିଆ",
>   },
>   pa: {
>     nativeName: "ਪੰਜਾਬੀ",
>   },
>   "pa-IN": {
>     nativeName: "ਪੰਜਾਬੀ (ਭਾਰਤ ਨੂੰ)",
>   },
>   pl: {
>     nativeName: "Polski",
>   },
>   "pl-PL": {
>     nativeName: "Polski",
>   },
>   "ps-AF": {
>     nativeName: "پښتو",
>   },
>   pt: {
>     nativeName: "Português",
>   },
>   "pt-BR": {
>     nativeName: "Português (Brasil)",
>   },
>   "pt-PT": {
>     nativeName: "Português (Portugal)",
>   },
>   "qu-PE": {
>     nativeName: "Qhichwa",
>   },
>   "rm-CH": {
>     nativeName: "Rumantsch",
>   },
>   ro: {
>     nativeName: "Română",
>   },
>   "ro-RO": {
>     nativeName: "Română",
>   },
>   ru: {
>     nativeName: "Русский",
>   },
>   "ru-RU": {
>     nativeName: "Русский",
>   },
>   "sa-IN": {
>     nativeName: "संस्कृतम्",
>   },
>   "se-NO": {
>     nativeName: "Davvisámegiella",
>   },
>   sh: {
>     nativeName: "српскохрватски",
>   },
>   "si-LK": {
>     nativeName: "සිංහල",
>   },
>   sk: {
>     nativeName: "Slovenčina",
>   },
>   "sk-SK": {
>     nativeName: "Slovenčina (Slovakia)",
>   },
>   sl: {
>     nativeName: "Slovenščina",
>   },
>   "sl-SI": {
>     nativeName: "Slovenščina",
>   },
>   "so-SO": {
>     nativeName: "Soomaaliga",
>   },
>   sq: {
>     nativeName: "Shqip",
>   },
>   "sq-AL": {
>     nativeName: "Shqip",
>   },
>   sr: {
>     nativeName: "Српски",
>   },
>   "sr-RS": {
>     nativeName: "Српски (Serbia)",
>   },
>   su: {
>     nativeName: "Basa Sunda",
>   },
>   sv: {
>     nativeName: "Svenska",
>   },
>   "sv-SE": {
>     nativeName: "Svenska",
>   },
>   sw: {
>     nativeName: "Kiswahili",
>   },
>   "sw-KE": {
>     nativeName: "Kiswahili",
>   },
>   ta: {
>     nativeName: "தமிழ்",
>   },
>   "ta-IN": {
>     nativeName: "தமிழ்",
>   },
>   te: {
>     nativeName: "తెలుగు",
>   },
>   "te-IN": {
>     nativeName: "తెలుగు",
>   },
>   tg: {
>     nativeName: "забо́ни тоҷикӣ́",
>   },
>   "tg-TJ": {
>     nativeName: "тоҷикӣ",
>   },
>   th: {
>     nativeName: "ภาษาไทย",
>   },
>   "th-TH": {
>     nativeName: "ภาษาไทย (ประเทศไทย)",
>   },
>   fil: {
>     nativeName: "Filipino",
>   },
>   tlh: {
>     nativeName: "tlhIngan-Hol",
>   },
>   tr: {
>     nativeName: "Türkçe",
>   },
>   "tr-TR": {
>     nativeName: "Türkçe",
>   },
>   "tt-RU": {
>     nativeName: "татарча",
>   },
>   uk: {
>     nativeName: "Українська",
>   },
>   "uk-UA": {
>     nativeName: "Українська",
>   },
>   ur: {
>     nativeName: "اردو",
>   },
>   "ur-PK": {
>     nativeName: "اردو",
>   },
>   uz: {
>     nativeName: "O'zbek",
>   },
>   "uz-UZ": {
>     nativeName: "O'zbek",
>   },
>   vi: {
>     nativeName: "Tiếng Việt",
>   },
>   "vi-VN": {
>     nativeName: "Tiếng Việt",
>   },
>   "xh-ZA": {
>     nativeName: "isiXhosa",
>   },
>   yi: {
>     nativeName: "ייִדיש",
>   },
>   "yi-DE": {
>     nativeName: "ייִדיש (German)",
>   },
>   zh: {
>     nativeName: "中文",
>   },
>   "zh-Hans": {
>     nativeName: "中文简体",
>   },
>   "zh-Hant": {
>     nativeName: "中文繁體",
>   },
>   "zh-CN": {
>     nativeName: "中文（中国大陆）",
>   },
>   "zh-HK": {
>     nativeName: "中文（香港）",
>   },
>   "zh-SG": {
>     nativeName: "中文（新加坡）",
>   },
>   "zh-TW": {
>     nativeName: "中文（台灣）",
>   },
>   "zu-ZA": {
>     nativeName: "isiZulu",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/login-id.ts RiricaV13/scripts/login-id.ts
2,4c2,4
< 	const u = new URL(url, origin);
< 	u.searchParams.append('loginId', loginId);
< 	return u.toString();
---
>   const u = new URL(url, origin);
>   u.searchParams.append("loginId", loginId);
>   return u.toString();
8,10c8,10
< 	const u = new URL(url);
< 	u.searchParams.delete('loginId');
< 	return u.toString();
---
>   const u = new URL(url);
>   u.searchParams.delete("loginId");
>   return u.toString();
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/lookup-user.ts RiricaV13/scripts/lookup-user.ts
1,3c1,3
< import * as Acct from 'misskey-js/built/acct';
< import { i18n } from '@/i18n';
< import * as os from '@/os';
---
> import * as Acct from "misskey-js/built/acct";
> import { i18n } from "@/i18n";
> import * as os from "@/os";
6,9c6,9
< 	const { canceled, result } = await os.inputText({
< 		title: i18n.ts.usernameOrUserId,
< 	});
< 	if (canceled) return;
---
>   const { canceled, result } = await os.inputText({
>     title: i18n.ts.usernameOrUserId,
>   });
>   if (canceled) return;
11,13c11,13
< 	const show = (user) => {
< 		os.pageWindow(`/user-info/${user.id}`);
< 	};
---
>   const show = (user) => {
>     os.pageWindow(`/user-info/${user.id}`);
>   };
15,35c15,35
< 	const usernamePromise = os.api('users/show', Acct.parse(result));
< 	const idPromise = os.api('users/show', { userId: result });
< 	let _notFound = false;
< 	const notFound = () => {
< 		if (_notFound) {
< 			os.alert({
< 				type: 'error',
< 				text: i18n.ts.noSuchUser,
< 			});
< 		} else {
< 			_notFound = true;
< 		}
< 	};
< 	usernamePromise.then(show).catch(err => {
< 		if (err.code === 'NO_SUCH_USER') {
< 			notFound();
< 		}
< 	});
< 	idPromise.then(show).catch(err => {
< 		notFound();
< 	});
---
>   const usernamePromise = os.api("users/show", Acct.parse(result));
>   const idPromise = os.api("users/show", { userId: result });
>   let _notFound = false;
>   const notFound = () => {
>     if (_notFound) {
>       os.alert({
>         type: "error",
>         text: i18n.ts.noSuchUser,
>       });
>     } else {
>       _notFound = true;
>     }
>   };
>   usernamePromise.then(show).catch((err) => {
>     if (err.code === "NO_SUCH_USER") {
>       notFound();
>     }
>   });
>   idPromise.then(show).catch((err) => {
>     notFound();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/media-proxy.ts RiricaV13/scripts/media-proxy.ts
1,2c1,2
< import { query, appendQuery } from '@/scripts/url';
< import { url } from '@/config';
---
> import { query } from "@/scripts/url";
> import { url } from "@/config";
4,17c4,8
< export function getProxiedImageUrl(imageUrl: string, type?: 'preview'): string {
< 	if (imageUrl.startsWith(`${url}/proxy/`) || imageUrl.startsWith('/proxy/')) {
< 		// もう既にproxyっぽそうだったらsearchParams付けるだけ
< 		return appendQuery(imageUrl, query({
< 			fallback: '1',
< 			...(type ? { [type]: '1' } : {}),
< 		}));
< 	}
< 
< 	return `${url}/proxy/image.webp?${query({
< 		url: imageUrl,
< 		fallback: '1',
< 		...(type ? { [type]: '1' } : {}),
< 	})}`;
---
> export function getProxiedImageUrl(imageUrl: string, type?: "preview"): string {
>   return `${url}/proxy/image.webp?${query({
>     url: imageUrl,
>     ...(type ? { [type]: "1" } : {}),
>   })}`;
20,46c11,16
< export function getProxiedImageUrlNullable(imageUrl: string | null | undefined, type?: 'preview'): string | null {
< 	if (imageUrl == null) return null;
< 	return getProxiedImageUrl(imageUrl, type);
< }
< 
< export function getStaticImageUrl(baseUrl: string): string {
< 	const u = baseUrl.startsWith('http') ? new URL(baseUrl) : new URL(baseUrl, url);
< 
< 	if (u.href.startsWith(`${url}/proxy/`)) {
< 		// もう既にproxyっぽそうだったらsearchParams付けるだけ
< 		u.searchParams.set('static', '1');
< 		return u.href;
< 	}
< 
< 	if (u.href.startsWith(`${url}/emoji/`)) {
< 		// もう既にemojiっぽそうだったらsearchParams付けるだけ
< 		u.searchParams.set('static', '1');
< 		return u.href;
< 	}
< 
< 	// 拡張子がないとキャッシュしてくれないCDNがあるのでダミーの名前を指定する
< 	const dummy = `${encodeURIComponent(`${u.host}${u.pathname}`)}.webp`;
< 
< 	return `${url}/proxy/${dummy}?${query({
< 		url: u.href,
< 		static: '1',
< 	})}`;
---
> export function getProxiedImageUrlNullable(
>   imageUrl: string | null | undefined,
>   type?: "preview"
> ): string | null {
>   if (imageUrl == null) return null;
>   return getProxiedImageUrl(imageUrl, type);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/mfm-tags.ts RiricaV13/scripts/mfm-tags.ts
1c1,18
< export const MFM_TAGS = ['tada', 'jelly', 'twitch', 'shake', 'spin', 'jump', 'bounce', 'flip', 'x2', 'x3', 'x4', 'scale', 'position', 'fg', 'bg', 'font', 'blur', 'rainbow', 'sparkle', 'rotate'];
---
> export const MFM_TAGS = [
>   "tada",
>   "jelly",
>   "twitch",
>   "shake",
>   "spin",
>   "jump",
>   "bounce",
>   "flip",
>   "x2",
>   "x3",
>   "x4",
>   "font",
>   "blur",
>   "rainbow",
>   "sparkle",
>   "rotate",
> ];
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/page-metadata.ts RiricaV13/scripts/page-metadata.ts
1,2c1,11
< import * as misskey from 'misskey-js';
< import { ComputedRef, inject, isRef, onActivated, onMounted, provide, ref, Ref } from 'vue';
---
> import * as misskey from "misskey-js";
> import {
>   ComputedRef,
>   inject,
>   isRef,
>   onActivated,
>   onMounted,
>   provide,
>   ref,
>   Ref,
> } from "vue";
4,5c13,14
< export const setPageMetadata = Symbol('setPageMetadata');
< export const pageMetadataProvider = Symbol('pageMetadataProvider');
---
> export const setPageMetadata = Symbol("setPageMetadata");
> export const pageMetadataProvider = Symbol("pageMetadataProvider");
8,13c17,22
< 	title: string;
< 	subtitle?: string;
< 	icon?: string | null;
< 	avatar?: misskey.entities.User | null;
< 	userName?: misskey.entities.User | null;
< 	bg?: string;
---
>   title: string;
>   subtitle?: string;
>   icon?: string | null;
>   avatar?: misskey.entities.User | null;
>   userName?: misskey.entities.User | null;
>   bg?: string;
16,17c25,32
< export function definePageMetadata(metadata: PageMetadata | null | Ref<PageMetadata | null> | ComputedRef<PageMetadata | null>): void {
< 	const _metadata = isRef(metadata) ? metadata : ref(metadata);
---
> export function definePageMetadata(
>   metadata:
>     | PageMetadata
>     | null
>     | Ref<PageMetadata | null>
>     | ComputedRef<PageMetadata | null>
> ): void {
>   const _metadata = isRef(metadata) ? metadata : ref(metadata);
19c34
< 	provide(pageMetadataProvider, _metadata);
---
>   provide(pageMetadataProvider, _metadata);
21,23c36,38
< 	const set = inject(setPageMetadata) as any;
< 	if (set) {
< 		set(_metadata);
---
>   const set = inject(setPageMetadata) as any;
>   if (set) {
>     set(_metadata);
25,27c40,42
< 		onMounted(() => {
< 			set(_metadata);
< 		});
---
>     onMounted(() => {
>       set(_metadata);
>     });
29,32c44,47
< 		onActivated(() => {
< 			set(_metadata);
< 		});
< 	}
---
>     onActivated(() => {
>       set(_metadata);
>     });
>   }
35,36c50,53
< export function provideMetadataReceiver(callback: (info: ComputedRef<PageMetadata>) => void): void {
< 	provide(setPageMetadata, callback);
---
> export function provideMetadataReceiver(
>   callback: (info: ComputedRef<PageMetadata>) => void
> ): void {
>   provide(setPageMetadata, callback);
40c57
< 	return inject(pageMetadataProvider);
---
>   return inject(pageMetadataProvider);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/physics.ts RiricaV13/scripts/physics.ts
1c1
< import * as Matter from 'matter-js';
---
> import * as Matter from "matter-js";
4,6c4,6
< 	const containerWidth = container.offsetWidth;
< 	const containerHeight = container.offsetHeight;
< 	const containerCenterX = containerWidth / 2;
---
>   const containerWidth = container.offsetWidth;
>   const containerHeight = container.offsetHeight;
>   const containerCenterX = containerWidth / 2;
8,12c8,12
< 	// サイズ固定化(要らないかも？)
< 	container.style.position = 'relative';
< 	container.style.boxSizing = 'border-box';
< 	container.style.width = `${containerWidth}px`;
< 	container.style.height = `${containerHeight}px`;
---
>   // サイズ固定化(要らないかも？)
>   container.style.position = "relative";
>   container.style.boxSizing = "border-box";
>   container.style.width = `${containerWidth}px`;
>   container.style.height = `${containerHeight}px`;
14,19c14,19
< 	// create engine
< 	const engine = Matter.Engine.create({
< 		constraintIterations: 4,
< 		positionIterations: 8,
< 		velocityIterations: 8,
< 	});
---
>   // create engine
>   const engine = Matter.Engine.create({
>     constraintIterations: 4,
>     positionIterations: 8,
>     velocityIterations: 8,
>   });
21c21
< 	const world = engine.world;
---
>   const world = engine.world;
23,33c23,33
< 	// create renderer
< 	const render = Matter.Render.create({
< 		engine: engine,
< 		//element: document.getElementById('debug'),
< 		options: {
< 			width: containerWidth,
< 			height: containerHeight,
< 			background: 'transparent', // transparent to hide
< 			wireframeBackground: 'transparent', // transparent to hide
< 		},
< 	});
---
>   // create renderer
>   const render = Matter.Render.create({
>     engine: engine,
>     //element: document.getElementById('debug'),
>     options: {
>       width: containerWidth,
>       height: containerHeight,
>       background: "transparent", // transparent to hide
>       wireframeBackground: "transparent", // transparent to hide
>     },
>   });
35,36c35,36
< 	// Disable to hide debug
< 	Matter.Render.run(render);
---
>   // Disable to hide debug
>   Matter.Render.run(render);
38,40c38,40
< 	// create runner
< 	const runner = Matter.Runner.create();
< 	Matter.Runner.run(runner, engine);
---
>   // create runner
>   const runner = Matter.Runner.create();
>   Matter.Runner.run(runner, engine);
42,47c42,53
< 	const groundThickness = 1024;
< 	const ground = Matter.Bodies.rectangle(containerCenterX, containerHeight + (groundThickness / 2), containerWidth, groundThickness, {
< 		isStatic: true,
< 		restitution: 0.1,
< 		friction: 2,
< 	});
---
>   const groundThickness = 1024;
>   const ground = Matter.Bodies.rectangle(
>     containerCenterX,
>     containerHeight + groundThickness / 2,
>     containerWidth,
>     groundThickness,
>     {
>       isStatic: true,
>       restitution: 0.1,
>       friction: 2,
>     }
>   );
49,50c55,56
< 	//const wallRight = Matter.Bodies.rectangle(window.innerWidth+50, window.innerHeight/2, 100, window.innerHeight, wallopts);
< 	//const wallLeft = Matter.Bodies.rectangle(-50, window.innerHeight/2, 100, window.innerHeight, wallopts);
---
>   //const wallRight = Matter.Bodies.rectangle(window.innerWidth+50, window.innerHeight/2, 100, window.innerHeight, wallopts);
>   //const wallLeft = Matter.Bodies.rectangle(-50, window.innerHeight/2, 100, window.innerHeight, wallopts);
52,56c58,62
< 	Matter.World.add(world, [
< 		ground,
< 		//wallRight,
< 		//wallLeft,
< 	]);
---
>   Matter.World.add(world, [
>     ground,
>     //wallRight,
>     //wallLeft,
>   ]);
58,62c64,72
< 	const objEls = Array.from(container.children) as HTMLElement[];
< 	const objs: Matter.Body[] = [];
< 	for (const objEl of objEls) {
< 		const left = objEl.dataset.physicsX ? parseInt(objEl.dataset.physicsX) : objEl.offsetLeft;
< 		const top = objEl.dataset.physicsY ? parseInt(objEl.dataset.physicsY) : objEl.offsetTop;
---
>   const objEls = Array.from(container.children);
>   const objs = [];
>   for (const objEl of objEls) {
>     const left = objEl.dataset.physicsX
>       ? parseInt(objEl.dataset.physicsX)
>       : objEl.offsetLeft;
>     const top = objEl.dataset.physicsY
>       ? parseInt(objEl.dataset.physicsY)
>       : objEl.offsetTop;
64,89c74,99
< 		let obj: Matter.Body;
< 		if (objEl.classList.contains('_physics_circle_')) {
< 			obj = Matter.Bodies.circle(
< 				left + (objEl.offsetWidth / 2),
< 				top + (objEl.offsetHeight / 2),
< 				Math.max(objEl.offsetWidth, objEl.offsetHeight) / 2,
< 				{
< 					restitution: 0.5,
< 				},
< 			);
< 		} else {
< 			const style = window.getComputedStyle(objEl);
< 			obj = Matter.Bodies.rectangle(
< 				left + (objEl.offsetWidth / 2),
< 				top + (objEl.offsetHeight / 2),
< 				objEl.offsetWidth,
< 				objEl.offsetHeight,
< 				{
< 					chamfer: { radius: parseInt(style.borderRadius || '0', 10) },
< 					restitution: 0.5,
< 				},
< 			);
< 		}
< 		objEl.id = obj.id.toString();
< 		objs.push(obj);
< 	}
---
>     let obj;
>     if (objEl.classList.contains("_physics_circle_")) {
>       obj = Matter.Bodies.circle(
>         left + objEl.offsetWidth / 2,
>         top + objEl.offsetHeight / 2,
>         Math.max(objEl.offsetWidth, objEl.offsetHeight) / 2,
>         {
>           restitution: 0.5,
>         }
>       );
>     } else {
>       const style = window.getComputedStyle(objEl);
>       obj = Matter.Bodies.rectangle(
>         left + objEl.offsetWidth / 2,
>         top + objEl.offsetHeight / 2,
>         objEl.offsetWidth,
>         objEl.offsetHeight,
>         {
>           chamfer: { radius: parseInt(style.borderRadius || "0", 10) },
>           restitution: 0.5,
>         }
>       );
>     }
>     objEl.id = obj.id;
>     objs.push(obj);
>   }
91c101
< 	Matter.World.add(engine.world, objs);
---
>   Matter.World.add(engine.world, objs);
93c103
< 	// Add mouse control
---
>   // Add mouse control
95,104c105,114
< 	const mouse = Matter.Mouse.create(container);
< 	const mouseConstraint = Matter.MouseConstraint.create(engine, {
< 		mouse: mouse,
< 		constraint: {
< 			stiffness: 0.1,
< 			render: {
< 				visible: false,
< 			},
< 		},
< 	});
---
>   const mouse = Matter.Mouse.create(container);
>   const mouseConstraint = Matter.MouseConstraint.create(engine, {
>     mouse: mouse,
>     constraint: {
>       stiffness: 0.1,
>       render: {
>         visible: false,
>       },
>     },
>   });
106c116
< 	Matter.World.add(engine.world, mouseConstraint);
---
>   Matter.World.add(engine.world, mouseConstraint);
108,109c118,119
< 	// keep the mouse in sync with rendering
< 	render.mouse = mouse;
---
>   // keep the mouse in sync with rendering
>   render.mouse = mouse;
111,116c121,126
< 	for (const objEl of objEls) {
< 		objEl.style.position = 'absolute';
< 		objEl.style.top = '0';
< 		objEl.style.left = '0';
< 		objEl.style.margin = '0';
< 	}
---
>   for (const objEl of objEls) {
>     objEl.style.position = `absolute`;
>     objEl.style.top = 0;
>     objEl.style.left = 0;
>     objEl.style.margin = 0;
>   }
118c128
< 	window.requestAnimationFrame(update);
---
>   window.requestAnimationFrame(update);
120c130
< 	let stop = false;
---
>   let stop = false;
122,125c132,135
< 	function update() {
< 		for (const objEl of objEls) {
< 			const obj = objs.find(obj => obj.id.toString() === objEl.id.toString());
< 			if (obj == null) continue;
---
>   function update() {
>     for (const objEl of objEls) {
>       const obj = objs.find((obj) => obj.id.toString() === objEl.id.toString());
>       if (obj == null) continue;
127,131c137,141
< 			const x = (obj.position.x - objEl.offsetWidth / 2);
< 			const y = (obj.position.y - objEl.offsetHeight / 2);
< 			const angle = obj.angle;
< 			objEl.style.transform = `translate(${x}px, ${y}px) rotate(${angle}rad)`;
< 		}
---
>       const x = obj.position.x - objEl.offsetWidth / 2;
>       const y = obj.position.y - objEl.offsetHeight / 2;
>       const angle = obj.angle;
>       objEl.style.transform = `translate(${x}px, ${y}px) rotate(${angle}rad)`;
>     }
133,136c143,146
< 		if (!stop) {
< 			window.requestAnimationFrame(update);
< 		}
< 	}
---
>     if (!stop) {
>       window.requestAnimationFrame(update);
>     }
>   }
138,143c148,154
< 	// 奈落に落ちたオブジェクトは消す
< 	const intervalId = window.setInterval(() => {
< 		for (const obj of objs) {
< 			if (obj.position.y > (containerHeight + 1024)) Matter.World.remove(world, obj);
< 		}
< 	}, 1000 * 10);
---
>   // 奈落に落ちたオブジェクトは消す
>   const intervalId = window.setInterval(() => {
>     for (const obj of objs) {
>       if (obj.position.y > containerHeight + 1024)
>         Matter.World.remove(world, obj);
>     }
>   }, 1000 * 10);
145,151c156,162
< 	return {
< 		stop: () => {
< 			stop = true;
< 			Matter.Runner.stop(runner);
< 			window.clearInterval(intervalId);
< 		},
< 	};
---
>   return {
>     stop: () => {
>       stop = true;
>       Matter.Runner.stop(runner);
>       window.clearInterval(intervalId);
>     },
>   };
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/please-login.ts RiricaV13/scripts/please-login.ts
1,4c1,4
< import { defineAsyncComponent } from 'vue';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { popup } from '@/os';
---
> import { defineAsyncComponent } from "vue";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { popup } from "@/os";
7c7
< 	if ($i) return;
---
>   if ($i) return;
9,18c9,23
< 	popup(defineAsyncComponent(() => import('@/components/MkSigninDialog.vue')), {
< 		autoSet: true,
< 		message: i18n.ts.signinRequired,
< 	}, {
< 		cancelled: () => {
< 			if (path) {
< 				window.location.href = path;
< 			}
< 		},
< 	}, 'closed');
---
>   popup(
>     defineAsyncComponent(() => import("@/components/MkSigninDialog.vue")),
>     {
>       autoSet: true,
>       message: i18n.ts.signinRequired,
>     },
>     {
>       cancelled: () => {
>         if (path) {
>           window.location.href = path;
>         }
>       },
>     },
>     "closed"
>   );
20c25
< 	if (!path) throw new Error('signin required');
---
>   if (!path) throw new Error("signin required");
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/popout.ts RiricaV13/scripts/popout.ts
1,2c1,2
< import * as config from '@/config';
< import { appendQuery } from './url';
---
> import * as config from "@/config";
> import { appendQuery } from "./url";
5,22c5,31
< 	let url = path.startsWith('http://') || path.startsWith('https://') ? path : config.url + path;
< 	url = appendQuery(url, 'zen');
< 	if (w) {
< 		const position = w.getBoundingClientRect();
< 		const width = parseInt(getComputedStyle(w, '').width, 10);
< 		const height = parseInt(getComputedStyle(w, '').height, 10);
< 		const x = window.screenX + position.left;
< 		const y = window.screenY + position.top;
< 		window.open(url, url,
< 			`width=${width}, height=${height}, top=${y}, left=${x}`);
< 	} else {
< 		const width = 400;
< 		const height = 500;
< 		const x = window.top.outerHeight / 2 + window.top.screenY - (height / 2);
< 		const y = window.top.outerWidth / 2 + window.top.screenX - (width / 2);
< 		window.open(url, url,
< 			`width=${width}, height=${height}, top=${x}, left=${y}`);
< 	}
---
>   let url =
>     path.startsWith("http://") || path.startsWith("https://")
>       ? path
>       : config.url + path;
>   url = appendQuery(url, "zen");
>   if (w) {
>     const position = w.getBoundingClientRect();
>     const width = parseInt(getComputedStyle(w, "").width, 10);
>     const height = parseInt(getComputedStyle(w, "").height, 10);
>     const x = window.screenX + position.left;
>     const y = window.screenY + position.top;
>     window.open(
>       url,
>       url,
>       `width=${width}, height=${height}, top=${y}, left=${x}`
>     );
>   } else {
>     const width = 400;
>     const height = 500;
>     const x = window.top.outerHeight / 2 + window.top.screenY - height / 2;
>     const y = window.top.outerWidth / 2 + window.top.screenX - width / 2;
>     window.open(
>       url,
>       url,
>       `width=${width}, height=${height}, top=${x}, left=${y}`
>     );
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/popup-position.ts RiricaV13/scripts/popup-position.ts
1c1
< import { Ref } from 'vue';
---
> import { Ref } from "vue";
3,13c3,16
< export function calcPopupPosition(el: HTMLElement, props: {
< 	anchorElement: HTMLElement | null;
< 	innerMargin: number;
< 	direction: 'top' | 'bottom' | 'left' | 'right';
< 	align: 'top' | 'bottom' | 'left' | 'right' | 'center';
< 	alignOffset?: number;
< 	x?: number;
< 	y?: number;
< }): { top: number; left: number; transformOrigin: string; } {
< 	const contentWidth = el.offsetWidth;
< 	const contentHeight = el.offsetHeight;
---
> export function calcPopupPosition(
>   el: HTMLElement,
>   props: {
>     anchorElement: HTMLElement | null;
>     innerMargin: number;
>     direction: "top" | "bottom" | "left" | "right";
>     align: "top" | "bottom" | "left" | "right" | "center";
>     alignOffset?: number;
>     x?: number;
>     y?: number;
>   }
> ): { top: number; left: number; transformOrigin: string } {
>   const contentWidth = el.offsetWidth;
>   const contentHeight = el.offsetHeight;
15c18
< 	let rect: DOMRect;
---
>   let rect: DOMRect;
17,19c20,22
< 	if (props.anchorElement) {
< 		rect = props.anchorElement.getBoundingClientRect();
< 	}
---
>   if (props.anchorElement) {
>     rect = props.anchorElement.getBoundingClientRect();
>   }
21,23c24,26
< 	const calcPosWhenTop = () => {
< 		let left: number;
< 		let top: number;
---
>   const calcPosWhenTop = () => {
>     let left: number;
>     let top: number;
25,31c28,35
< 		if (props.anchorElement) {
< 			left = rect.left + window.pageXOffset + (props.anchorElement.offsetWidth / 2);
< 			top = (rect.top + window.pageYOffset - contentHeight) - props.innerMargin;
< 		} else {
< 			left = props.x;
< 			top = (props.y - contentHeight) - props.innerMargin;
< 		}
---
>     if (props.anchorElement) {
>       left =
>         rect.left + window.pageXOffset + props.anchorElement.offsetWidth / 2;
>       top = rect.top + window.pageYOffset - contentHeight - props.innerMargin;
>     } else {
>       left = props.x;
>       top = props.y - contentHeight - props.innerMargin;
>     }
33c37
< 		left -= (el.offsetWidth / 2);
---
>     left -= el.offsetWidth / 2;
35,37c39,41
< 		if (left + contentWidth - window.pageXOffset > window.innerWidth) {
< 			left = window.innerWidth - contentWidth + window.pageXOffset - 1;
< 		}
---
>     if (left + contentWidth - window.pageXOffset > window.innerWidth) {
>       left = window.innerWidth - contentWidth + window.pageXOffset - 1;
>     }
39,40c43,44
< 		return [left, top];
< 	};
---
>     return [left, top];
>   };
42,44c46,48
< 	const calcPosWhenBottom = () => {
< 		let left: number;
< 		let top: number;
---
>   const calcPosWhenBottom = () => {
>     let left: number;
>     let top: number;
46,52c50,61
< 		if (props.anchorElement) {
< 			left = rect.left + window.pageXOffset + (props.anchorElement.offsetWidth / 2);
< 			top = (rect.top + window.pageYOffset + props.anchorElement.offsetHeight) + props.innerMargin;
< 		} else {
< 			left = props.x;
< 			top = (props.y) + props.innerMargin;
< 		}
---
>     if (props.anchorElement) {
>       left =
>         rect.left + window.pageXOffset + props.anchorElement.offsetWidth / 2;
>       top =
>         rect.top +
>         window.pageYOffset +
>         props.anchorElement.offsetHeight +
>         props.innerMargin;
>     } else {
>       left = props.x;
>       top = props.y + props.innerMargin;
>     }
54c63
< 		left -= (el.offsetWidth / 2);
---
>     left -= el.offsetWidth / 2;
56,58c65,67
< 		if (left + contentWidth - window.pageXOffset > window.innerWidth) {
< 			left = window.innerWidth - contentWidth + window.pageXOffset - 1;
< 		}
---
>     if (left + contentWidth - window.pageXOffset > window.innerWidth) {
>       left = window.innerWidth - contentWidth + window.pageXOffset - 1;
>     }
60,61c69,70
< 		return [left, top];
< 	};
---
>     return [left, top];
>   };
63,65c72,74
< 	const calcPosWhenLeft = () => {
< 		let left: number;
< 		let top: number;
---
>   const calcPosWhenLeft = () => {
>     let left: number;
>     let top: number;
67,73c76,83
< 		if (props.anchorElement) {
< 			left = (rect.left + window.pageXOffset - contentWidth) - props.innerMargin;
< 			top = rect.top + window.pageYOffset + (props.anchorElement.offsetHeight / 2);
< 		} else {
< 			left = (props.x - contentWidth) - props.innerMargin;
< 			top = props.y;
< 		}
---
>     if (props.anchorElement) {
>       left = rect.left + window.pageXOffset - contentWidth - props.innerMargin;
>       top =
>         rect.top + window.pageYOffset + props.anchorElement.offsetHeight / 2;
>     } else {
>       left = props.x - contentWidth - props.innerMargin;
>       top = props.y;
>     }
75c85
< 		top -= (el.offsetHeight / 2);
---
>     top -= el.offsetHeight / 2;
77,79c87,89
< 		if (top + contentHeight - window.pageYOffset > window.innerHeight) {
< 			top = window.innerHeight - contentHeight + window.pageYOffset - 1;
< 		}
---
>     if (top + contentHeight - window.pageYOffset > window.innerHeight) {
>       top = window.innerHeight - contentHeight + window.pageYOffset - 1;
>     }
81,82c91,92
< 		return [left, top];
< 	};
---
>     return [left, top];
>   };
84,86c94,96
< 	const calcPosWhenRight = () => {
< 		let left: number;
< 		let top: number;
---
>   const calcPosWhenRight = () => {
>     let left: number;
>     let top: number;
88,89c98,103
< 		if (props.anchorElement) {
< 			left = (rect.left + props.anchorElement.offsetWidth + window.pageXOffset) + props.innerMargin;
---
>     if (props.anchorElement) {
>       left =
>         rect.left +
>         props.anchorElement.offsetWidth +
>         window.pageXOffset +
>         props.innerMargin;
91,104c105,120
< 			if (props.align === 'top') {
< 				top = rect.top + window.pageYOffset;
< 				if (props.alignOffset != null) top += props.alignOffset;
< 			} else if (props.align === 'bottom') {
< 				// TODO
< 			} else { // center
< 				top = rect.top + window.pageYOffset + (props.anchorElement.offsetHeight / 2);
< 				top -= (el.offsetHeight / 2);
< 			}
< 		} else {
< 			left = props.x + props.innerMargin;
< 			top = props.y;
< 			top -= (el.offsetHeight / 2);
< 		}
---
>       if (props.align === "top") {
>         top = rect.top + window.pageYOffset;
>         if (props.alignOffset != null) top += props.alignOffset;
>       } else if (props.align === "bottom") {
>         // TODO
>       } else {
>         // center
>         top =
>           rect.top + window.pageYOffset + props.anchorElement.offsetHeight / 2;
>         top -= el.offsetHeight / 2;
>       }
>     } else {
>       left = props.x + props.innerMargin;
>       top = props.y;
>       top -= el.offsetHeight / 2;
>     }
106,108c122,124
< 		if (top + contentHeight - window.pageYOffset > window.innerHeight) {
< 			top = window.innerHeight - contentHeight + window.pageYOffset - 1;
< 		}
---
>     if (top + contentHeight - window.pageYOffset > window.innerHeight) {
>       top = window.innerHeight - contentHeight + window.pageYOffset - 1;
>     }
110,111c126,127
< 		return [left, top];
< 	};
---
>     return [left, top];
>   };
113,120c129,136
< 	const calc = (): {
< 		left: number;
< 		top: number;
< 		transformOrigin: string;
< 	} => {
< 		switch (props.direction) {
< 			case 'top': {
< 				const [left, top] = calcPosWhenTop();
---
>   const calc = (): {
>     left: number;
>     top: number;
>     transformOrigin: string;
>   } => {
>     switch (props.direction) {
>       case "top": {
>         const [left, top] = calcPosWhenTop();
122,126c138,142
< 				// ツールチップを上に向かって表示するスペースがなければ下に向かって出す
< 				if (top - window.pageYOffset < 0) {
< 					const [left, top] = calcPosWhenBottom();
< 					return { left, top, transformOrigin: 'center top' };
< 				}
---
>         // ツールチップを上に向かって表示するスペースがなければ下に向かって出す
>         if (top - window.pageYOffset < 0) {
>           const [left, top] = calcPosWhenBottom();
>           return { left, top, transformOrigin: "center top" };
>         }
128,129c144,145
< 				return { left, top, transformOrigin: 'center bottom' };
< 			}
---
>         return { left, top, transformOrigin: "center bottom" };
>       }
131,135c147,151
< 			case 'bottom': {
< 				const [left, top] = calcPosWhenBottom();
< 				// TODO: ツールチップを下に向かって表示するスペースがなければ上に向かって出す
< 				return { left, top, transformOrigin: 'center top' };
< 			}
---
>       case "bottom": {
>         const [left, top] = calcPosWhenBottom();
>         // TODO: ツールチップを下に向かって表示するスペースがなければ上に向かって出す
>         return { left, top, transformOrigin: "center top" };
>       }
137,138c153,154
< 			case 'left': {
< 				const [left, top] = calcPosWhenLeft();
---
>       case "left": {
>         const [left, top] = calcPosWhenLeft();
140,144c156,160
< 				// ツールチップを左に向かって表示するスペースがなければ右に向かって出す
< 				if (left - window.pageXOffset < 0) {
< 					const [left, top] = calcPosWhenRight();
< 					return { left, top, transformOrigin: 'left center' };
< 				}
---
>         // ツールチップを左に向かって表示するスペースがなければ右に向かって出す
>         if (left - window.pageXOffset < 0) {
>           const [left, top] = calcPosWhenRight();
>           return { left, top, transformOrigin: "left center" };
>         }
146,147c162,163
< 				return { left, top, transformOrigin: 'right center' };
< 			}
---
>         return { left, top, transformOrigin: "right center" };
>       }
149,155c165,171
< 			case 'right': {
< 				const [left, top] = calcPosWhenRight();
< 				// TODO: ツールチップを右に向かって表示するスペースがなければ左に向かって出す
< 				return { left, top, transformOrigin: 'left center' };
< 			}
< 		}
< 	};
---
>       case "right": {
>         const [left, top] = calcPosWhenRight();
>         // TODO: ツールチップを右に向かって表示するスペースがなければ左に向かって出す
>         return { left, top, transformOrigin: "left center" };
>       }
>     }
>   };
157c173
< 	return calc();
---
>   return calc();
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/reaction-picker.ts RiricaV13/scripts/reaction-picker.ts
1,2c1,2
< import { defineAsyncComponent, Ref, ref } from 'vue';
< import { popup } from '@/os';
---
> import { defineAsyncComponent, Ref, ref } from "vue";
> import { popup } from "@/os";
5,8c5,8
< 	private src: Ref<HTMLElement | null> = ref(null);
< 	private manualShowing = ref(false);
< 	private onChosen?: (reaction: string) => void;
< 	private onClosed?: () => void;
---
>   private src: Ref<HTMLElement | null> = ref(null);
>   private manualShowing = ref(false);
>   private onChosen?: (reaction: string) => void;
>   private onClosed?: () => void;
10,12c10,12
< 	constructor() {
< 		// nop
< 	}
---
>   constructor() {
>     // nop
>   }
14,31c14,37
< 	public async init() {
< 		await popup(defineAsyncComponent(() => import('@/components/MkEmojiPickerDialog.vue')), {
< 			src: this.src,
< 			asReactionPicker: true,
< 			manualShowing: this.manualShowing,
< 		}, {
< 			done: reaction => {
< 				this.onChosen!(reaction);
< 			},
< 			close: () => {
< 				this.manualShowing.value = false;
< 			},
< 			closed: () => {
< 				this.src.value = null;
< 				this.onClosed!();
< 			},
< 		});
< 	}
---
>   public async init() {
>     await popup(
>       defineAsyncComponent(
>         () => import("@/components/MkEmojiPickerDialog.vue")
>       ),
>       {
>         src: this.src,
>         asReactionPicker: true,
>         manualShowing: this.manualShowing,
>       },
>       {
>         done: (reaction) => {
>           this.onChosen!(reaction);
>         },
>         close: () => {
>           this.manualShowing.value = false;
>         },
>         closed: () => {
>           this.src.value = null;
>           this.onClosed!();
>         },
>       }
>     );
>   }
33,38c39,48
< 	public show(src: HTMLElement, onChosen: ReactionPicker['onChosen'], onClosed: ReactionPicker['onClosed']) {
< 		this.src.value = src;
< 		this.manualShowing.value = true;
< 		this.onChosen = onChosen;
< 		this.onClosed = onClosed;
< 	}
---
>   public show(
>     src: HTMLElement,
>     onChosen: ReactionPicker["onChosen"],
>     onClosed: ReactionPicker["onClosed"]
>   ) {
>     this.src.value = src;
>     this.manualShowing.value = true;
>     this.onChosen = onChosen;
>     this.onClosed = onClosed;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/safe-uri-decode.ts RiricaV13/scripts/safe-uri-decode.ts
2,6c2,6
< 	try {
< 		return decodeURIComponent(str);
< 	} catch {
< 		return str;
< 	}
---
>   try {
>     return decodeURIComponent(str);
>   } catch {
>     return str;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/scroll.ts RiricaV13/scripts/scroll.ts
1c1
< type ScrollBehavior = 'auto' | 'smooth' | 'instant';
---
> type ScrollBehavior = "auto" | "smooth" | "instant";
4,10c4,10
< 	if (el == null || el.tagName === 'HTML') return null;
< 	const overflow = window.getComputedStyle(el).getPropertyValue('overflow-y');
< 	if (overflow === 'scroll' || overflow === 'auto') {
< 		return el;
< 	} else {
< 		return getScrollContainer(el.parentElement);
< 	}
---
>   if (el == null || el.tagName === "HTML") return null;
>   const overflow = window.getComputedStyle(el).getPropertyValue("overflow-y");
>   if (overflow === "scroll" || overflow === "auto") {
>     return el;
>   } else {
>     return getScrollContainer(el.parentElement);
>   }
13,18c13,15
< export function getStickyTop(el: HTMLElement, container: HTMLElement | null = null, top: number = 0) {
< 	if (!el.parentElement) return top;
< 	const data = el.dataset.stickyContainerHeaderHeight;
< 	const newTop = data ? Number(data) + top : top;
< 	if (el === container) return newTop;
< 	return getStickyTop(el.parentElement, container, newTop);
---
> export function getScrollPosition(el: Element | null): number {
>   const container = getScrollContainer(el);
>   return container == null ? window.scrollY : container.scrollTop;
21,24c18,20
< export function getScrollPosition(el: HTMLElement | null): number {
< 	const container = getScrollContainer(el);
< 	return container == null ? window.scrollY : container.scrollTop;
< }
---
> export function isTopVisible(el: Element | null): boolean {
>   const scrollTop = getScrollPosition(el);
>   const topPosition = el.offsetTop; // TODO: container内でのelの相対位置を取得できればより正確になる
26,45c22
< export function onScrollTop(el: HTMLElement, cb: () => unknown, tolerance: number = 1, once: boolean = false) {
< 	// とりあえず評価してみる
< 	if (isTopVisible(el)) {
< 		cb();
< 		if (once) return null;
< 	}
< 
< 	const container = getScrollContainer(el) || window;
< 
< 	const onScroll = ev => {
< 		if (!document.body.contains(el)) return;
< 		if (isTopVisible(el, tolerance)) {
< 			cb();
< 			if (once) removeListener();
< 		}
< 	};
< 
< 	function removeListener() { container.removeEventListener('scroll', onScroll); }
< 	container.addEventListener('scroll', onScroll, { passive: true });
< 	return removeListener;
---
>   return scrollTop <= topPosition;
48,70c25,35
< export function onScrollBottom(el: HTMLElement, cb: () => unknown, tolerance: number = 1, once: boolean = false) {
< 	const container = getScrollContainer(el);
< 
< 	// とりあえず評価してみる
< 	if (isBottomVisible(el, tolerance, container)) {
< 		cb();
< 		if (once) return null;
< 	}
< 
< 	const containerOrWindow = container || window;
< 	const onScroll = ev => {
< 		if (!document.body.contains(el)) return;
< 		if (isBottomVisible(el, 1, container)) {
< 			cb();
< 			if (once) removeListener();
< 		}
< 	};
< 
< 	function removeListener() {
< 		containerOrWindow.removeEventListener('scroll', onScroll);
< 	}
< 	containerOrWindow.addEventListener('scroll', onScroll, { passive: true });
< 	return removeListener;
---
> export function isBottomVisible(
>   el: HTMLElement,
>   tolerance = 1,
>   container = getScrollContainer(el)
> ) {
>   if (container)
>     return (
>       el.scrollHeight <=
>       container.clientHeight + Math.abs(container.scrollTop) + tolerance
>     );
>   return el.scrollHeight <= window.innerHeight + window.scrollY + tolerance;
73,79c38,47
< export function scroll(el: HTMLElement, options: ScrollToOptions | undefined) {
< 	const container = getScrollContainer(el);
< 	if (container == null) {
< 		window.scroll(options);
< 	} else {
< 		container.scroll(options);
< 	}
---
> export function onScrollTop(el: Element, cb) {
>   const container = getScrollContainer(el) || window;
>   const onScroll = (ev) => {
>     if (!document.body.contains(el)) return;
>     if (isTopVisible(el)) {
>       cb();
>       container.removeEventListener("scroll", onScroll);
>     }
>   };
>   container.addEventListener("scroll", onScroll, { passive: true });
82,88c50,60
< /**
<  * Scroll to Top
<  * @param el Scroll container element
<  * @param options Scroll options
<  */
< export function scrollToTop(el: HTMLElement, options: { behavior?: ScrollBehavior; } = {}) {
< 	scroll(el, { top: 0, ...options });
---
> export function onScrollBottom(el: Element, cb) {
>   const container = getScrollContainer(el) || window;
>   const onScroll = (ev) => {
>     if (!document.body.contains(el)) return;
>     const pos = getScrollPosition(el);
>     if (pos + el.clientHeight > el.scrollHeight - 1) {
>       cb();
>       container.removeEventListener("scroll", onScroll);
>     }
>   };
>   container.addEventListener("scroll", onScroll, { passive: true });
91,100c63,69
< /**
<  * Scroll to Bottom
<  * @param el Content element
<  * @param options Scroll options
<  * @param container Scroll container element
<  */
< export function scrollToBottom(
< 	el: HTMLElement,
< 	options: ScrollToOptions = {},
< 	container = getScrollContainer(el),
---
> export function scroll(
>   el: Element,
>   options: {
>     top?: number;
>     left?: number;
>     behavior?: ScrollBehavior;
>   }
102,109c71,76
< 	if (container) {
< 		container.scroll({ top: el.scrollHeight - container.clientHeight + getStickyTop(el, container) || 0, ...options });
< 	} else {
< 		window.scroll({
< 			top: (el.scrollHeight - window.innerHeight + getStickyTop(el, container) + (window.innerWidth <= 500 ? 96 : 0)) || 0,
< 			...options
< 		});
< 	}
---
>   const container = getScrollContainer(el);
>   if (container == null) {
>     window.scroll(options);
>   } else {
>     container.scroll(options);
>   }
112,114c79,83
< export function isTopVisible(el: HTMLElement, tolerance: number = 1): boolean {
< 	const scrollTop = getScrollPosition(el);
< 	return scrollTop <= tolerance;
---
> export function scrollToTop(
>   el: Element,
>   options: { behavior?: ScrollBehavior } = {}
> ) {
>   scroll(el, { top: 0, ...options });
117,119c86,90
< export function isBottomVisible(el: HTMLElement, tolerance = 1, container = getScrollContainer(el)) {
< 	if (container) return el.scrollHeight <= container.clientHeight + Math.abs(container.scrollTop) + tolerance;
< 	return el.scrollHeight <= window.innerHeight + window.scrollY + tolerance;
---
> export function scrollToBottom(
>   el: Element,
>   options: { behavior?: ScrollBehavior } = {}
> ) {
>   scroll(el, { top: 99999, ...options }); // TODO: ちゃんと計算する
122,128c93,99
< // https://ja.javascript.info/size-and-scroll-window#ref-932
< export function getBodyScrollHeight() {
< 	return Math.max(
< 		document.body.scrollHeight, document.documentElement.scrollHeight,
< 		document.body.offsetHeight, document.documentElement.offsetHeight,
< 		document.body.clientHeight, document.documentElement.clientHeight
< 	);
---
> export function isBottom(el: Element, asobi = 0) {
>   const container = getScrollContainer(el);
>   const current = container
>     ? el.scrollTop + el.offsetHeight
>     : window.scrollY + window.innerHeight;
>   const max = container ? el.scrollHeight : document.body.offsetHeight;
>   return current >= max - asobi;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/search.ts RiricaV13/scripts/search.ts
1,3c1,3
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { mainRouter } from '@/router';
---
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { mainRouter } from "@/router";
6,9c6,9
< 	const { canceled, result: query } = await os.inputText({
< 		title: i18n.ts.search,
< 	});
< 	if (canceled || query == null || query === '') return;
---
>   const { canceled, result: query } = await os.inputText({
>     title: i18n.ts.search,
>   });
>   if (canceled || query == null || query === "") return;
11c11
< 	const q = query.trim();
---
>   const q = query.trim();
13,16c13,16
< 	if (q.startsWith('@') && !q.includes(' ')) {
< 		mainRouter.push(`/${q}`);
< 		return;
< 	}
---
>   if (q.startsWith("@") && !q.includes(" ")) {
>     mainRouter.push(`/${q}`);
>     return;
>   }
18,21c18,21
< 	if (q.startsWith('#')) {
< 		mainRouter.push(`/tags/${encodeURIComponent(q.substr(1))}`);
< 		return;
< 	}
---
>   if (q.startsWith("#")) {
>     mainRouter.push(`/tags/${encodeURIComponent(q.substr(1))}`);
>     return;
>   }
23,25c23,25
< 	// like 2018/03/12
< 	if (/^[0-9]{4}\/[0-9]{2}\/[0-9]{2}/.test(q.replace(/-/g, '/'))) {
< 		const date = new Date(q.replace(/-/g, '/'));
---
>   // like 2018/03/12
>   if (/^[0-9]{4}\/[0-9]{2}\/[0-9]{2}/.test(q.replace(/-/g, "/"))) {
>     const date = new Date(q.replace(/-/g, "/"));
27,33c27,33
< 		// 日付しか指定されてない場合、例えば 2018/03/12 ならユーザーは
< 		// 2018/03/12 のコンテンツを「含む」結果になることを期待するはずなので
< 		// 23時間59分進める(そのままだと 2018/03/12 00:00:00 「まで」の
< 		// 結果になってしまい、2018/03/12 のコンテンツは含まれない)
< 		if (q.replace(/-/g, '/').match(/^[0-9]{4}\/[0-9]{2}\/[0-9]{2}$/)) {
< 			date.setHours(23, 59, 59, 999);
< 		}
---
>     // 日付しか指定されてない場合、例えば 2018/03/12 ならユーザーは
>     // 2018/03/12 のコンテンツを「含む」結果になることを期待するはずなので
>     // 23時間59分進める(そのままだと 2018/03/12 00:00:00 「まで」の
>     // 結果になってしまい、2018/03/12 のコンテンツは含まれない)
>     if (q.replace(/-/g, "/").match(/^[0-9]{4}\/[0-9]{2}\/[0-9]{2}$/)) {
>       date.setHours(23, 59, 59, 999);
>     }
35,42c35,43
< 		// TODO
< 		//v.$root.$emit('warp', date);
< 		os.alert({
< 			icon: 'fas fa-history',
< 			iconOnly: true, autoClose: true,
< 		});
< 		return;
< 	}
---
>     // TODO
>     //v.$root.$emit('warp', date);
>     os.alert({
>       icon: "fas fa-history",
>       iconOnly: true,
>       autoClose: true,
>     });
>     return;
>   }
44,47c45,48
< 	if (q.startsWith('https://')) {
< 		const promise = os.api('ap/show', {
< 			uri: q,
< 		});
---
>   if (q.startsWith("https://")) {
>     const promise = os.api("ap/show", {
>       uri: q,
>     });
49c50
< 		os.promiseDialog(promise, null, null, i18n.ts.fetchingAsApObject);
---
>     os.promiseDialog(promise, null, null, i18n.ts.fetchingAsApObject);
51c52
< 		const res = await promise;
---
>     const res = await promise;
53,57c54,58
< 		if (res.type === 'User') {
< 			mainRouter.push(`/@${res.object.username}@${res.object.host}`);
< 		} else if (res.type === 'Note') {
< 			mainRouter.push(`/notes/${res.object.id}`);
< 		}
---
>     if (res.type === "User") {
>       mainRouter.push(`/@${res.object.username}@${res.object.host}`);
>     } else if (res.type === "Note") {
>       mainRouter.push(`/notes/${res.object.id}`);
>     }
59,60c60,61
< 		return;
< 	}
---
>     return;
>   }
62c63
< 	mainRouter.push(`/search?q=${encodeURIComponent(q)}`);
---
>   mainRouter.push(`/search?q=${encodeURIComponent(q)}`);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/select-file.ts RiricaV13/scripts/select-file.ts
1,7c1,7
< import { ref } from 'vue';
< import { DriveFile } from 'misskey-js/built/entities';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
< import { uploadFile } from '@/scripts/upload';
---
> import { ref } from "vue";
> import { DriveFile } from "misskey-js/built/entities";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
> import { uploadFile } from "@/scripts/upload";
9,11c9,15
< function select(src: any, label: string | null, multiple: boolean): Promise<DriveFile | DriveFile[]> {
< 	return new Promise((res, rej) => {
< 		const keepOriginal = ref(defaultStore.state.keepOriginalUploading);
---
> function select(
>   src: any,
>   label: string | null,
>   multiple: boolean
> ): Promise<DriveFile | DriveFile[]> {
>   return new Promise((res, rej) => {
>     const keepOriginal = ref(defaultStore.state.keepOriginalUploading);
13,18c17,29
< 		const chooseFileFromPc = () => {
< 			const input = document.createElement('input');
< 			input.type = 'file';
< 			input.multiple = multiple;
< 			input.onchange = () => {
< 				const promises = Array.from(input.files).map(file => uploadFile(file, defaultStore.state.uploadFolder, undefined, keepOriginal.value));
---
>     const chooseFileFromPc = () => {
>       const input = document.createElement("input");
>       input.type = "file";
>       input.multiple = multiple;
>       input.onchange = () => {
>         const promises = Array.from(input.files).map((file) =>
>           uploadFile(
>             file,
>             defaultStore.state.uploadFolder,
>             undefined,
>             keepOriginal.value
>           )
>         );
20,24c31,37
< 				Promise.all(promises).then(driveFiles => {
< 					res(multiple ? driveFiles : driveFiles[0]);
< 				}).catch(err => {
< 					// アップロードのエラーは uploadFile 内でハンドリングされているためアラートダイアログを出したりはしてはいけない
< 				});
---
>         Promise.all(promises)
>           .then((driveFiles) => {
>             res(multiple ? driveFiles : driveFiles[0]);
>           })
>           .catch((err) => {
>             // アップロードのエラーは uploadFile 内でハンドリングされているためアラートダイアログを出したりはしてはいけない
>           });
26,28c39,41
< 				// 一応廃棄
< 				(window as any).__misskey_input_ref__ = null;
< 			};
---
>         // 一応廃棄
>         (window as any).__misskey_input_ref__ = null;
>       };
30,32c43,45
< 			// https://qiita.com/fukasawah/items/b9dc732d95d99551013d
< 			// iOS Safari で正常に動かす為のおまじない
< 			(window as any).__misskey_input_ref__ = input;
---
>       // https://qiita.com/fukasawah/items/b9dc732d95d99551013d
>       // iOS Safari で正常に動かす為のおまじない
>       (window as any).__misskey_input_ref__ = input;
34,35c47,48
< 			input.click();
< 		};
---
>       input.click();
>     };
37,41c50,54
< 		const chooseFileFromDrive = () => {
< 			os.selectDriveFile(multiple).then(files => {
< 				res(files);
< 			});
< 		};
---
>     const chooseFileFromDrive = () => {
>       os.selectDriveFile(multiple).then((files) => {
>         res(files);
>       });
>     };
43,49c56,62
< 		const chooseFileFromUrl = () => {
< 			os.inputText({
< 				title: i18n.ts.uploadFromUrl,
< 				type: 'url',
< 				placeholder: i18n.ts.uploadFromUrlDescription,
< 			}).then(({ canceled, result: url }) => {
< 				if (canceled) return;
---
>     const chooseFileFromUrl = () => {
>       os.inputText({
>         title: i18n.ts.uploadFromUrl,
>         type: "url",
>         placeholder: i18n.ts.uploadFromUrlDescription,
>       }).then(({ canceled, result: url }) => {
>         if (canceled) return;
51c64
< 				const marker = Math.random().toString(); // TODO: UUIDとか使う
---
>         const marker = Math.random().toString(); // TODO: UUIDとか使う
53,59c66,72
< 				const connection = stream.useChannel('main');
< 				connection.on('urlUploadFinished', urlResponse => {
< 					if (urlResponse.marker === marker) {
< 						res(multiple ? [urlResponse.file] : urlResponse.file);
< 						connection.dispose();
< 					}
< 				});
---
>         const connection = stream.useChannel("main");
>         connection.on("urlUploadFinished", (urlResponse) => {
>           if (urlResponse.marker === marker) {
>             res(multiple ? [urlResponse.file] : urlResponse.file);
>             connection.dispose();
>           }
>         });
61,65c74,78
< 				os.api('drive/files/upload-from-url', {
< 					url: url,
< 					folderId: defaultStore.state.uploadFolder,
< 					marker,
< 				});
---
>         os.api("drive/files/upload-from-url", {
>           url: url,
>           folderId: defaultStore.state.uploadFolder,
>           marker,
>         });
67,72c80,85
< 				os.alert({
< 					title: i18n.ts.uploadFromUrlRequested,
< 					text: i18n.ts.uploadFromUrlMayTakeTime,
< 				});
< 			});
< 		};
---
>         os.alert({
>           title: i18n.ts.uploadFromUrlRequested,
>           text: i18n.ts.uploadFromUrlMayTakeTime,
>         });
>       });
>     };
74,94c87,118
< 		os.popupMenu([label ? {
< 			text: label,
< 			type: 'label',
< 		} : undefined, {
< 			type: 'switch',
< 			text: i18n.ts.keepOriginalUploading,
< 			ref: keepOriginal,
< 		}, {
< 			text: i18n.ts.upload,
< 			icon: 'ti ti-upload',
< 			action: chooseFileFromPc,
< 		}, {
< 			text: i18n.ts.fromDrive,
< 			icon: 'ti ti-cloud',
< 			action: chooseFileFromDrive,
< 		}, {
< 			text: i18n.ts.fromUrl,
< 			icon: 'ti ti-link',
< 			action: chooseFileFromUrl,
< 		}], src);
< 	});
---
>     os.popupMenu(
>       [
>         label
>           ? {
>               text: label,
>               type: "label",
>             }
>           : undefined,
>         {
>           type: "switch",
>           text: i18n.ts.keepOriginalUploading,
>           ref: keepOriginal,
>         },
>         {
>           text: i18n.ts.upload,
>           icon: "fas fa-upload",
>           action: chooseFileFromPc,
>         },
>         {
>           text: i18n.ts.fromDrive,
>           icon: "fas fa-cloud",
>           action: chooseFileFromDrive,
>         },
>         {
>           text: i18n.ts.fromUrl,
>           icon: "fas fa-link",
>           action: chooseFileFromUrl,
>         },
>       ],
>       src
>     );
>   });
97,98c121,125
< export function selectFile(src: any, label: string | null = null): Promise<DriveFile> {
< 	return select(src, label, false) as Promise<DriveFile>;
---
> export function selectFile(
>   src: any,
>   label: string | null = null
> ): Promise<DriveFile> {
>   return select(src, label, false) as Promise<DriveFile>;
101,102c128,132
< export function selectFiles(src: any, label: string | null = null): Promise<DriveFile[]> {
< 	return select(src, label, true) as Promise<DriveFile[]>;
---
> export function selectFiles(
>   src: any,
>   label: string | null = null
> ): Promise<DriveFile[]> {
>   return select(src, label, true) as Promise<DriveFile[]>;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/show-suspended-dialog.ts RiricaV13/scripts/show-suspended-dialog.ts
1,2c1,2
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import * as os from "@/os";
> import { i18n } from "@/i18n";
5,9c5,9
< 	return os.alert({
< 		type: 'error',
< 		title: i18n.ts.yourAccountSuspendedTitle,
< 		text: i18n.ts.yourAccountSuspendedDescription,
< 	});
---
>   return os.alert({
>     type: "error",
>     title: i18n.ts.yourAccountSuspendedTitle,
>     text: i18n.ts.yourAccountSuspendedDescription,
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/shuffle.ts RiricaV13/scripts/shuffle.ts
5c5,6
< 	let currentIndex = array.length, randomIndex;
---
>   let currentIndex = array.length,
>     randomIndex;
7,11c8,12
< 	// While there remain elements to shuffle.
< 	while (currentIndex !== 0) {
< 		// Pick a remaining element.
< 		randomIndex = Math.floor(Math.random() * currentIndex);
< 		currentIndex--;
---
>   // While there remain elements to shuffle.
>   while (currentIndex !== 0) {
>     // Pick a remaining element.
>     randomIndex = Math.floor(Math.random() * currentIndex);
>     currentIndex--;
13,16c14,19
< 		// And swap it with the current element.
< 		[array[currentIndex], array[randomIndex]] = [
< 			array[randomIndex], array[currentIndex]];
< 	}
---
>     // And swap it with the current element.
>     [array[currentIndex], array[randomIndex]] = [
>       array[randomIndex],
>       array[currentIndex],
>     ];
>   }
18c21
< 	return array;
---
>   return array;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/sound.ts RiricaV13/scripts/sound.ts
1c1
< import { ColdDeviceStorage } from '@/store';
---
> import { ColdDeviceStorage } from "@/store";
3c3
< const cache = new Map<string, HTMLAudioElement>();
---
> const cache = new Map<string,  AudioBuffer>();
5,35c5
< export const soundsTypes = [
< 	null,
< 	'syuilo/up',
< 	'syuilo/down',
< 	'syuilo/pope1',
< 	'syuilo/pope2',
< 	'syuilo/waon',
< 	'syuilo/popo',
< 	'syuilo/triple',
< 	'syuilo/poi1',
< 	'syuilo/poi2',
< 	'syuilo/pirori',
< 	'syuilo/pirori-wet',
< 	'syuilo/pirori-square-wet',
< 	'syuilo/square-pico',
< 	'syuilo/reverved',
< 	'syuilo/ryukyu',
< 	'syuilo/kick',
< 	'syuilo/snare',
< 	'syuilo/queue-jammed',
< 	'aisha/1',
< 	'aisha/2',
< 	'aisha/3',
< 	'noizenecio/kick_gaba1',
< 	'noizenecio/kick_gaba2',
< 	'noizenecio/kick_gaba3',
< 	'noizenecio/kick_gaba4',
< 	'noizenecio/kick_gaba5',
< 	'noizenecio/kick_gaba6',
< 	'noizenecio/kick_gaba7',
< ] as const;
---
> const ctx = new AudioContext()
37,45c7,17
< export function getAudio(file: string, useCache = true): HTMLAudioElement {
< 	let audio: HTMLAudioElement;
< 	if (useCache && cache.has(file)) {
< 		audio = cache.get(file);
< 	} else {
< 		audio = new Audio(`/client-assets/sounds/${file}.mp3`);
< 		if (useCache) cache.set(file, audio);
< 	}
< 	return audio;
---
> 
> export async function getAudio(file: string, useCache = true) {
>   if (useCache && cache.has(file)) {
>     return cache.get(file);
>   }
> 
>   const response = await fetch(`/client-assets/sounds/${file}.mp3`);
>   const arrayBuffer = await response.arrayBuffer()
>   const audioBuffer = await ctx.decodeAudioData(arrayBuffer)
>   if (useCache) cache.set(file, audioBuffer);
>   return audioBuffer;
48,51c20,27
< export function setVolume(audio: HTMLAudioElement, volume: number): HTMLAudioElement {
< 	const masterVolume = ColdDeviceStorage.get('sound_masterVolume');
< 	audio.volume = masterVolume - ((1 - volume) * masterVolume);
< 	return audio;
---
> export function setVolume(
>   audio: HTMLAudioElement,
>   volume: number
> ): HTMLAudioElement {
>   const masterVolume = ColdDeviceStorage.get("sound_masterVolume");
> 
>   audio.volume = masterVolume - (1 - volume) * masterVolume;
>   return audio;
55,57c31,33
< 	const sound = ColdDeviceStorage.get('sound_' + type as any);
< 	if (sound.type == null) return;
< 	playFile(sound.type, sound.volume);
---
>   const sound = ColdDeviceStorage.get(("sound_" + type) as any);
>   if (sound.type == null) return;
>   playFile(sound.type, sound.volume);
60,62c36,38
< export function playFile(file: string, volume: number) {
< 	const masterVolume = ColdDeviceStorage.get('sound_masterVolume');
< 	if (masterVolume === 0) return;
---
> export async function playFile(file: string, volume: number) {
>   const masterVolume = ColdDeviceStorage.get("sound_masterVolume");
>   if (masterVolume === 0) return;
64,65c40,44
< 	const audio = setVolume(getAudio(file), volume);
< 	audio.play();
---
>   const soundSource = ctx.createBufferSource()
>   soundSource.buffer = await getAudio(file)
>   soundSource.connect(ctx.destination)
>   soundSource.start()
> 
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/sticky-sidebar.ts RiricaV13/scripts/sticky-sidebar.ts
2,10c2,10
< 	private lastScrollTop = 0;
< 	private container: HTMLElement;
< 	private el: HTMLElement;
< 	private spacer: HTMLElement;
< 	private marginTop: number;
< 	private isTop = false;
< 	private isBottom = false;
< 	private offsetTop: number;
< 	private globalHeaderHeight = 59;
---
>   private lastScrollTop = 0;
>   private container: HTMLElement;
>   private el: HTMLElement;
>   private spacer: HTMLElement;
>   private marginTop: number;
>   private isTop = false;
>   private isBottom = false;
>   private offsetTop: number;
>   private globalHeaderHeight: number = 59;
12,21c12,25
< 	constructor(container: StickySidebar['container'], marginTop = 0, globalHeaderHeight = 0) {
< 		this.container = container;
< 		this.el = this.container.children[0] as HTMLElement;
< 		this.el.style.position = 'sticky';
< 		this.spacer = document.createElement('div');
< 		this.container.prepend(this.spacer);
< 		this.marginTop = marginTop;
< 		this.offsetTop = this.container.getBoundingClientRect().top;
< 		this.globalHeaderHeight = globalHeaderHeight;
< 	}
---
>   constructor(
>     container: StickySidebar["container"],
>     marginTop = 0,
>     globalHeaderHeight = 0
>   ) {
>     this.container = container;
>     this.el = this.container.children[0] as HTMLElement;
>     this.el.style.position = "sticky";
>     this.spacer = document.createElement("div");
>     this.container.prepend(this.spacer);
>     this.marginTop = marginTop;
>     this.offsetTop = this.container.getBoundingClientRect().top;
>     this.globalHeaderHeight = globalHeaderHeight;
>   }
23,27c27,39
< 	public calc(scrollTop: number) {
< 		if (scrollTop > this.lastScrollTop) { // downscroll
< 			const overflow = Math.max(0, this.globalHeaderHeight + (this.el.clientHeight + this.marginTop) - window.innerHeight);
< 			this.el.style.bottom = null;
< 			this.el.style.top = `${-overflow + this.marginTop + this.globalHeaderHeight}px`;
---
>   public calc(scrollTop: number) {
>     if (scrollTop > this.lastScrollTop) {
>       // downscroll
>       const overflow = Math.max(
>         0,
>         this.globalHeaderHeight +
>           (this.el.clientHeight + this.marginTop) -
>           window.innerHeight
>       );
>       this.el.style.bottom = null;
>       this.el.style.top = `${
>         -overflow + this.marginTop + this.globalHeaderHeight
>       }px`;
29c41,43
< 			this.isBottom = (scrollTop + window.innerHeight) >= (this.el.offsetTop + this.el.clientHeight);
---
>       this.isBottom =
>         scrollTop + window.innerHeight >=
>         this.el.offsetTop + this.el.clientHeight;
31,38c45,62
< 			if (this.isTop) {
< 				this.isTop = false;
< 				this.spacer.style.marginTop = `${Math.max(0, this.globalHeaderHeight + this.lastScrollTop + this.marginTop - this.offsetTop)}px`;
< 			}
< 		} else { // upscroll
< 			const overflow = this.globalHeaderHeight + (this.el.clientHeight + this.marginTop) - window.innerHeight;
< 			this.el.style.top = null;
< 			this.el.style.bottom = `${-overflow}px`;
---
>       if (this.isTop) {
>         this.isTop = false;
>         this.spacer.style.marginTop = `${Math.max(
>           0,
>           this.globalHeaderHeight +
>             this.lastScrollTop +
>             this.marginTop -
>             this.offsetTop
>         )}px`;
>       }
>     } else {
>       // upscroll
>       const overflow =
>         this.globalHeaderHeight +
>         (this.el.clientHeight + this.marginTop) -
>         window.innerHeight;
>       this.el.style.top = null;
>       this.el.style.bottom = `${-overflow}px`;
40c64,66
< 			this.isTop = scrollTop + this.marginTop + this.globalHeaderHeight <= this.el.offsetTop;
---
>       this.isTop =
>         scrollTop + this.marginTop + this.globalHeaderHeight <=
>         this.el.offsetTop;
42,46c68,78
< 			if (this.isBottom) {
< 				this.isBottom = false;
< 				this.spacer.style.marginTop = `${this.globalHeaderHeight + this.lastScrollTop + this.marginTop - this.offsetTop - overflow}px`;
< 			}
< 		}
---
>       if (this.isBottom) {
>         this.isBottom = false;
>         this.spacer.style.marginTop = `${
>           this.globalHeaderHeight +
>           this.lastScrollTop +
>           this.marginTop -
>           this.offsetTop -
>           overflow
>         }px`;
>       }
>     }
48,49c80,81
< 		this.lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
< 	}
---
>     this.lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/theme-editor.ts RiricaV13/scripts/theme-editor.ts
1c1
< import { v4 as uuid } from 'uuid';
---
> import { v4 as uuid } from "uuid";
3c3
< import { themeProps, Theme } from './theme';
---
> import { themeProps, Theme } from "./theme";
7,11c7,11
< export type FuncName = 'alpha' | 'darken' | 'lighten';
< export type Func = { type: 'func'; name: FuncName; arg: number; value: string; };
< export type RefProp = { type: 'refProp'; key: string; };
< export type RefConst = { type: 'refConst'; key: string; };
< export type Css = { type: 'css'; value: string; };
---
> export type FuncName = "alpha" | "darken" | "lighten";
> export type Func = { type: "func"; name: FuncName; arg: number; value: string };
> export type RefProp = { type: "refProp"; key: string };
> export type RefConst = { type: "refConst"; key: string };
> export type Css = { type: "css"; value: string };
15c15
< export type ThemeViewModel = [ string, ThemeValue ][];
---
> export type ThemeViewModel = [string, ThemeValue][];
17,42c17,42
< export const fromThemeString = (str?: string) : ThemeValue => {
< 	if (!str) return null;
< 	if (str.startsWith(':')) {
< 		const parts = str.slice(1).split('<');
< 		const name = parts[0] as FuncName;
< 		const arg = parseFloat(parts[1]);
< 		const value = parts[2].startsWith('@') ? parts[2].slice(1) : '';
< 		return { type: 'func', name, arg, value };
< 	} else if (str.startsWith('@')) {
< 		return {
< 			type: 'refProp',
< 			key: str.slice(1),
< 		};
< 	} else if (str.startsWith('$')) {
< 		return {
< 			type: 'refConst',
< 			key: str.slice(1),
< 		};
< 	} else if (str.startsWith('"')) {
< 		return {
< 			type: 'css',
< 			value: str.substr(1).trim(),
< 		};
< 	} else {
< 		return str;
< 	}
---
> export const fromThemeString = (str?: string): ThemeValue => {
>   if (!str) return null;
>   if (str.startsWith(":")) {
>     const parts = str.slice(1).split("<");
>     const name = parts[0] as FuncName;
>     const arg = parseFloat(parts[1]);
>     const value = parts[2].startsWith("@") ? parts[2].slice(1) : "";
>     return { type: "func", name, arg, value };
>   } else if (str.startsWith("@")) {
>     return {
>       type: "refProp",
>       key: str.slice(1),
>     };
>   } else if (str.startsWith("$")) {
>     return {
>       type: "refConst",
>       key: str.slice(1),
>     };
>   } else if (str.startsWith('"')) {
>     return {
>       type: "css",
>       value: str.substr(1).trim(),
>     };
>   } else {
>     return str;
>   }
45,52c45,58
< export const toThemeString = (value: Color | Func | RefProp | RefConst | Css) => {
< 	if (typeof value === 'string') return value;
< 	switch (value.type) {
< 		case 'func': return `:${value.name}<${value.arg}<@${value.value}`;
< 		case 'refProp': return `@${value.key}`;
< 		case 'refConst': return `$${value.key}`;
< 		case 'css': return `" ${value.value}`;
< 	}
---
> export const toThemeString = (
>   value: Color | Func | RefProp | RefConst | Css
> ) => {
>   if (typeof value === "string") return value;
>   switch (value.type) {
>     case "func":
>       return `:${value.name}<${value.arg}<@${value.value}`;
>     case "refProp":
>       return `@${value.key}`;
>     case "refConst":
>       return `$${value.key}`;
>     case "css":
>       return `" ${value.value}`;
>   }
55,60c61,72
< export const convertToMisskeyTheme = (vm: ThemeViewModel, name: string, desc: string, author: string, base: 'dark' | 'light'): Theme => {
< 	const props = { } as { [key: string]: string };
< 	for (const [key, value] of vm) {
< 		if (value === null) continue;
< 		props[key] = toThemeString(value);
< 	}
---
> export const convertToMisskeyTheme = (
>   vm: ThemeViewModel,
>   name: string,
>   desc: string,
>   author: string,
>   base: "dark" | "light"
> ): Theme => {
>   const props = {} as { [key: string]: string };
>   for (const [key, value] of vm) {
>     if (value === null) continue;
>     props[key] = toThemeString(value);
>   }
62,65c74,81
< 	return {
< 		id: uuid(),
< 		name, desc, author, props, base,
< 	};
---
>   return {
>     id: uuid(),
>     name,
>     desc,
>     author,
>     props,
>     base,
>   };
69,71c85,91
< 	const vm: ThemeViewModel = [];
< 	// プロパティの登録
< 	vm.push(...themeProps.map(key => [key, fromThemeString(theme.props[key])] as [ string, ThemeValue ]));
---
>   const vm: ThemeViewModel = [];
>   // プロパティの登録
>   vm.push(
>     ...themeProps.map(
>       (key) => [key, fromThemeString(theme.props[key])] as [string, ThemeValue]
>     )
>   );
73,77c93,96
< 	// 定数の登録
< 	const consts = Object
< 		.keys(theme.props)
< 		.filter(k => k.startsWith('$'))
< 		.map(k => [k, fromThemeString(theme.props[k])] as [ string, ThemeValue ]);
---
>   // 定数の登録
>   const consts = Object.keys(theme.props)
>     .filter((k) => k.startsWith("$"))
>     .map((k) => [k, fromThemeString(theme.props[k])] as [string, ThemeValue]);
79,80c98,99
< 		vm.push(...consts);
< 	return vm;
---
>   vm.push(...consts);
>   return vm;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/theme.ts RiricaV13/scripts/theme.ts
1,3c1,4
< import { ref } from 'vue';
< import tinycolor from 'tinycolor2';
< import { globalEvents } from '@/events';
---
> import { ref } from "vue";
> import tinycolor from "tinycolor2";
> import { globalEvents } from "@/events";
> import { StatusBar, Style } from "@capacitor/status-bar";
6,11c7,12
< 	id: string;
< 	name: string;
< 	author: string;
< 	desc?: string;
< 	base?: 'dark' | 'light';
< 	props: Record<string, string>;
---
>   id: string;
>   name: string;
>   author: string;
>   desc?: string;
>   base?: "dark" | "light";
>   props: Record<string, string>;
14,17c15,18
< import lightTheme from '@/themes/_light.json5';
< import darkTheme from '@/themes/_dark.json5';
< import { deepClone } from './clone';
< import { miLocalStorage } from '@/local-storage';
---
> import lightTheme from "@/themes/_light.json5";
> import darkTheme from "@/themes/_dark.json5";
> import { deepClone } from "./clone";
> import { storedDeviceInfo } from "@/main";
19c20,22
< export const themeProps = Object.keys(lightTheme.props).filter(key => !key.startsWith('X'));
---
> export const themeProps = Object.keys(lightTheme.props).filter(
>   (key) => !key.startsWith("X")
> );
21,31c24,34
< export const getBuiltinThemes = () => Promise.all(
< 	[
< 		'l-light',
< 		'l-coffee',
< 		'l-apricot',
< 		'l-rainy',
< 		'l-botanical',
< 		'l-vivid',
< 		'l-cherry',
< 		'l-sushi',
< 		'l-u0',
---
> export const getBuiltinThemes = () =>
>   Promise.all(
>     [
>       "l-light",
>       "l-coffee",
>       "l-apricot",
>       "l-rainy",
>       "l-vivid",
>       "l-cherry",
>       "l-sushi",
>       "l-u0",
33,44c36,51
< 		'd-dark',
< 		'd-persimmon',
< 		'd-astro',
< 		'd-future',
< 		'd-botanical',
< 		'd-green-lime',
< 		'd-green-orange',
< 		'd-cherry',
< 		'd-ice',
< 		'd-u0',
< 	].map(name => import(`../themes/${name}.json5`).then(({ default: _default }): Theme => _default)),
< );
---
>       "d-dark",
>       "d-persimmon",
>       "d-astro",
>       "d-future",
>       "d-botanical",
>       "d-green-lime",
>       "d-green-orange",
>       "d-cherry",
>       "d-ice",
>       "d-u0",
>     ].map((name) =>
>       import(`../themes/${name}.json5`).then(
>         ({ default: _default }): Theme => _default
>       )
>     )
>   );
47,49c54,56
< 	const builtinThemes = ref<Theme[]>([]);
< 	getBuiltinThemes().then(themes => builtinThemes.value = themes);
< 	return builtinThemes;
---
>   const builtinThemes = ref<Theme[]>([]);
>   getBuiltinThemes().then((themes) => (builtinThemes.value = themes));
>   return builtinThemes;
55c62,63
< 	if (timeout) window.clearTimeout(timeout);
---
>   if (timeout) window.clearTimeout(timeout);
>   document.documentElement.classList.add("_themeChanging_");
57c65,67
< 	document.documentElement.classList.add('_themeChanging_');
---
>   timeout = window.setTimeout(() => {
>     document.documentElement.classList.remove("_themeChanging_");
>   }, 1000);
59,61c69,72
< 	timeout = window.setTimeout(() => {
< 		document.documentElement.classList.remove('_themeChanging_');
< 	}, 1000);
---
>   const colorSchema = theme.base === "dark" ? "dark" : "light";
>   if (storedDeviceInfo.platform == "ios") {
>     StatusBar.setStyle({ style: theme.base ===  "dark" ? Style.Dark  : Style.Light  })
>   }
63c74,75
< 	const colorSchema = theme.base === 'dark' ? 'dark' : 'light';
---
>   // Deep copy
>   const _theme = deepClone(theme);
65,66c77,80
< 	// Deep copy
< 	const _theme = deepClone(theme);
---
>   if (_theme.base) {
>     const base = [lightTheme, darkTheme].find((x) => x.id === _theme.base);
>     if (base) _theme.props = Object.assign({}, base.props, _theme.props);
>   }
68,71c82
< 	if (_theme.base) {
< 		const base = [lightTheme, darkTheme].find(x => x.id === _theme.base);
< 		if (base) _theme.props = Object.assign({}, base.props, _theme.props);
< 	}
---
>   const props = compile(_theme);
73c84,89
< 	const props = compile(_theme);
---
>   for (const tag of document.head.children) {
>     if (tag.tagName === "META" && tag.getAttribute("name") === "theme-color") {
>       tag.setAttribute("content", props["htmlThemeColor"]);
>       break;
>     }
>   }
75,80c91,93
< 	for (const tag of document.head.children) {
< 		if (tag.tagName === 'META' && tag.getAttribute('name') === 'theme-color') {
< 			tag.setAttribute('content', props['htmlThemeColor']);
< 			break;
< 		}
< 	}
---
>   for (const [k, v] of Object.entries(props)) {
>     document.documentElement.style.setProperty(`--${k}`, v.toString());
>   }
82,84c95
< 	for (const [k, v] of Object.entries(props)) {
< 		document.documentElement.style.setProperty(`--${k}`, v.toString());
< 	}
---
>   document.documentElement.style.setProperty("color-schema", colorSchema);
86c97,100
< 	document.documentElement.style.setProperty('color-schema', colorSchema);
---
>   // if (persist) {
>   localStorage.setItem("theme", JSON.stringify(props));
>   localStorage.setItem("colorSchema", colorSchema);
>   // }
88,94c102,103
< 	if (persist) {
< 		miLocalStorage.setItem('theme', JSON.stringify(props));
< 		miLocalStorage.setItem('colorSchema', colorSchema);
< 	}
< 
< 	// 色計算など再度行えるようにクライアント全体に通知
< 	globalEvents.emit('themeChanged');
---
>   // 色計算など再度行えるようにクライアント全体に通知
>   globalEvents.emit("themeChanged");
98,102c107,111
< 	function getColor(val: string): tinycolor.Instance {
< 		// ref (prop)
< 		if (val[0] === '@') {
< 			return getColor(theme.props[val.substr(1)]);
< 		}
---
>   function getColor(val: string): tinycolor.Instance {
>     // ref (prop)
>     if (val[0] === "@") {
>       return getColor(theme.props[val.substr(1)]);
>     }
104,107c113,116
< 		// ref (const)
< 		else if (val[0] === '$') {
< 			return getColor(theme.props[val]);
< 		}
---
>     // ref (const)
>     else if (val[0] === "$") {
>       return getColor(theme.props[val]);
>     }
109,114c118,123
< 		// func
< 		else if (val[0] === ':') {
< 			const parts = val.split('<');
< 			const func = parts.shift().substr(1);
< 			const arg = parseFloat(parts.shift());
< 			const color = getColor(parts.join('<'));
---
>     // func
>     else if (val[0] === ":") {
>       const parts = val.split("<");
>       const func = parts.shift().substr(1);
>       const arg = parseFloat(parts.shift());
>       const color = getColor(parts.join("<"));
116,123c125,137
< 			switch (func) {
< 				case 'darken': return color.darken(arg);
< 				case 'lighten': return color.lighten(arg);
< 				case 'alpha': return color.setAlpha(arg);
< 				case 'hue': return color.spin(arg);
< 				case 'saturate': return color.saturate(arg);
< 			}
< 		}
---
>       switch (func) {
>         case "darken":
>           return color.darken(arg);
>         case "lighten":
>           return color.lighten(arg);
>         case "alpha":
>           return color.setAlpha(arg);
>         case "hue":
>           return color.spin(arg);
>         case "saturate":
>           return color.saturate(arg);
>       }
>     }
125,127c139,141
< 		// other case
< 		return tinycolor(val);
< 	}
---
>     // other case
>     return tinycolor(val);
>   }
129c143
< 	const props = {};
---
>   const props = {};
131,132c145,146
< 	for (const [k, v] of Object.entries(theme.props)) {
< 		if (k.startsWith('$')) continue; // ignore const
---
>   for (const [k, v] of Object.entries(theme.props)) {
>     if (k.startsWith("$")) continue; // ignore const
134,135c148,151
< 		props[k] = v.startsWith('"') ? v.replace(/^"\s*/, '') : genValue(getColor(v));
< 	}
---
>     props[k] = v.startsWith('"')
>       ? v.replace(/^"\s*/, "")
>       : genValue(getColor(v));
>   }
137c153
< 	return props;
---
>   return props;
141c157
< 	return c.toRgbString();
---
>   return c.toRgbString();
145,149c161,166
< 	if (theme.id == null || typeof theme.id !== 'string') return false;
< 	if (theme.name == null || typeof theme.name !== 'string') return false;
< 	if (theme.base == null || !['light', 'dark'].includes(theme.base)) return false;
< 	if (theme.props == null || typeof theme.props !== 'object') return false;
< 	return true;
---
>   if (theme.id == null || typeof theme.id !== "string") return false;
>   if (theme.name == null || typeof theme.name !== "string") return false;
>   if (theme.base == null || !["light", "dark"].includes(theme.base))
>     return false;
>   if (theme.props == null || typeof theme.props !== "object") return false;
>   return true;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/time.ts RiricaV13/scripts/time.ts
2,4c2,4
< 	'day': 86400000,
< 	'hour': 3600000,
< 	'ms': 1,
---
>   day: 86400000,
>   hour: 3600000,
>   ms: 1,
8,14c8,21
< 	const d = time.length === 2 ? Date.UTC(time[0], time[1])
< 					: time.length === 3 ? Date.UTC(time[0], time[1], time[2])
< 					: time.length === 4 ? Date.UTC(time[0], time[1], time[2], time[3])
< 					: time.length === 5 ? Date.UTC(time[0], time[1], time[2], time[3], time[4])
< 					: time.length === 6 ? Date.UTC(time[0], time[1], time[2], time[3], time[4], time[5])
< 					: time.length === 7 ? Date.UTC(time[0], time[1], time[2], time[3], time[4], time[5], time[6])
< 					: null;
---
>   const d =
>     time.length === 2
>       ? Date.UTC(time[0], time[1])
>       : time.length === 3
>       ? Date.UTC(time[0], time[1], time[2])
>       : time.length === 4
>       ? Date.UTC(time[0], time[1], time[2], time[3])
>       : time.length === 5
>       ? Date.UTC(time[0], time[1], time[2], time[3], time[4])
>       : time.length === 6
>       ? Date.UTC(time[0], time[1], time[2], time[3], time[4], time[5])
>       : time.length === 7
>       ? Date.UTC(time[0], time[1], time[2], time[3], time[4], time[5], time[6])
>       : null;
16c23
< 	if (!d) throw 'wrong number of arguments';
---
>   if (!d) throw "wrong number of arguments";
18c25
< 	return new Date(d);
---
>   return new Date(d);
22c29
< 	return a.getTime() === b.getTime();
---
>   return a.getTime() === b.getTime();
26c33
< 	return (a.getTime() - b.getTime()) < 0;
---
>   return a.getTime() - b.getTime() < 0;
30c37
< 	return (a.getTime() - b.getTime()) > 0;
---
>   return a.getTime() - b.getTime() > 0;
33,34c40,45
< export function addTime(x: Date, value: number, span: keyof typeof dateTimeIntervals = 'ms'): Date {
< 	return new Date(x.getTime() + (value * dateTimeIntervals[span]));
---
> export function addTime(
>   x: Date,
>   value: number,
>   span: keyof typeof dateTimeIntervals = "ms"
> ): Date {
>   return new Date(x.getTime() + value * dateTimeIntervals[span]);
37,38c48,53
< export function subtractTime(x: Date, value: number, span: keyof typeof dateTimeIntervals = 'ms'): Date {
< 	return new Date(x.getTime() - (value * dateTimeIntervals[span]));
---
> export function subtractTime(
>   x: Date,
>   value: number,
>   span: keyof typeof dateTimeIntervals = "ms"
> ): Date {
>   return new Date(x.getTime() - value * dateTimeIntervals[span]);
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/timezones.ts RiricaV13/scripts/timezones.ts
1,49c1,62
< export const timezones = [{
< 	name: 'UTC',
< 	abbrev: 'UTC',
< 	offset: 0,
< }, {
< 	name: 'Europe/Berlin',
< 	abbrev: 'CET',
< 	offset: 60,
< }, {
< 	name: 'Asia/Tokyo',
< 	abbrev: 'JST',
< 	offset: 540,
< }, {
< 	name: 'Asia/Seoul',
< 	abbrev: 'KST',
< 	offset: 540,
< }, {
< 	name: 'Asia/Shanghai',
< 	abbrev: 'CST',
< 	offset: 480,
< }, {
< 	name: 'Australia/Sydney',
< 	abbrev: 'AEST',
< 	offset: 600,
< }, {
< 	name: 'Australia/Darwin',
< 	abbrev: 'ACST',
< 	offset: 570,
< }, {
< 	name: 'Australia/Perth',
< 	abbrev: 'AWST',
< 	offset: 480,
< }, {
< 	name: 'America/New_York',
< 	abbrev: 'EST',
< 	offset: -300,
< }, {
< 	name: 'America/Mexico_City',
< 	abbrev: 'CST',
< 	offset: -360,
< }, {
< 	name: 'America/Phoenix',
< 	abbrev: 'MST',
< 	offset: -420,
< }, {
< 	name: 'America/Los_Angeles',
< 	abbrev: 'PST',
< 	offset: -480,
< }];
---
> export const timezones = [
>   {
>     name: "UTC",
>     abbrev: "UTC",
>     offset: 0,
>   },
>   {
>     name: "Europe/Berlin",
>     abbrev: "CET",
>     offset: 60,
>   },
>   {
>     name: "Asia/Tokyo",
>     abbrev: "JST",
>     offset: 540,
>   },
>   {
>     name: "Asia/Seoul",
>     abbrev: "KST",
>     offset: 540,
>   },
>   {
>     name: "Asia/Shanghai",
>     abbrev: "CST",
>     offset: 480,
>   },
>   {
>     name: "Australia/Sydney",
>     abbrev: "AEST",
>     offset: 600,
>   },
>   {
>     name: "Australia/Darwin",
>     abbrev: "ACST",
>     offset: 570,
>   },
>   {
>     name: "Australia/Perth",
>     abbrev: "AWST",
>     offset: 480,
>   },
>   {
>     name: "America/New_York",
>     abbrev: "EST",
>     offset: -300,
>   },
>   {
>     name: "America/Mexico_City",
>     abbrev: "CST",
>     offset: -360,
>   },
>   {
>     name: "America/Phoenix",
>     abbrev: "MST",
>     offset: -420,
>   },
>   {
>     name: "America/Los_Angeles",
>     abbrev: "PST",
>     offset: -480,
>   },
> ];
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/touch.ts RiricaV13/scripts/touch.ts
1c1,2
< import { deviceKind } from '@/scripts/device-kind';
---
> const isTouchSupported =
>   "maxTouchPoints" in navigator && navigator.maxTouchPoints > 0;
3c4
< const isTouchSupported = 'maxTouchPoints' in navigator && navigator.maxTouchPoints > 0;
---
> export let isTouchUsing = false;
5c6
< export let isTouchUsing = deviceKind === 'tablet' || deviceKind === 'smartphone';
---
> export let isScreenTouching = false;
7,12c8,31
< if (isTouchSupported && !isTouchUsing) {
< 	window.addEventListener('touchstart', () => {
< 		// maxTouchPointsなどでの判定だけだと、「タッチ機能付きディスプレイを使っているがマウスでしか操作しない」場合にも
< 		// タッチで使っていると判定されてしまうため、実際に一度でもタッチされたらtrueにする
< 		isTouchUsing = true;
< 	}, { passive: true });
---
> if (isTouchSupported) {
>   window.addEventListener(
>     "touchstart",
>     () => {
>       // maxTouchPointsなどでの判定だけだと、「タッチ機能付きディスプレイを使っているがマウスでしか操作しない」場合にも
>       // タッチで使っていると判定されてしまうため、実際に一度でもタッチされたらtrueにする
>       isTouchUsing = true;
> 
>       isScreenTouching = true;
>     },
>     { passive: true }
>   );
> 
>   window.addEventListener(
>     "touchend",
>     () => {
>       // 子要素のtouchstartイベントでstopPropagation()が呼ばれると親要素に伝搬されずタッチされたと判定されないため、
>       // touchendイベントでもtouchstartイベントと同様にtrueにする
>       isTouchUsing = true;
> 
>       isScreenTouching = false;
>     },
>     { passive: true }
>   );
Only in RiricaV13/scripts: twemoji-base.ts
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/unison-reload.ts RiricaV13/scripts/unison-reload.ts
2c2
< import { BroadcastChannel } from 'broadcast-channel';
---
> import { BroadcastChannel } from "broadcast-channel";
4c4
< export const reloadChannel = new BroadcastChannel<string | null>('reload');
---
> export const reloadChannel = new BroadcastChannel<string | null>("reload");
8,14c8,14
< 	if (path !== undefined) {
< 		reloadChannel.postMessage(path);
< 		location.href = path;
< 	} else {
< 		reloadChannel.postMessage(null);
< 		location.reload();
< 	}
---
>   if (path !== undefined) {
>     reloadChannel.postMessage(path);
>     location.href = path;
>   } else {
>     reloadChannel.postMessage(null);
>     location.reload();
>   }
Only in misskeyV13/packages/frontend/src/scripts: upload
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/upload.ts RiricaV13/scripts/upload.ts
1,9c1,9
< import { reactive, ref } from 'vue';
< import * as Misskey from 'misskey-js';
< import { readAndCompressImage } from 'browser-image-resizer';
< import { getCompressionConfig } from './upload/compress-config';
< import { defaultStore } from '@/store';
< import { apiUrl } from '@/config';
< import { $i } from '@/account';
< import { alert } from '@/os';
< import { i18n } from '@/i18n';
---
> import { reactive, ref } from "vue";
> import * as Misskey from "misskey-js";
> import { readAndCompressImage } from "browser-image-resizer";
> import * as loadImage from "blueimp-load-image"
> import { defaultStore } from "@/store";
> import { apiUrl } from "@/config";
> import { $i } from "@/account";
> import { alert } from "@/os";
> import { i18n } from "@/i18n";
12,16c12,16
< 	id: string;
< 	name: string;
< 	progressMax: number | undefined;
< 	progressValue: number | undefined;
< 	img: string;
---
>   id: string;
>   name: string;
>   progressMax: number | undefined;
>   progressValue: number | undefined;
>   img: string;
19a20,25
> const compressTypeMap = {
>   "image/jpeg": { quality: 0.85, mimeType: "image/jpeg" },
>   "image/webp": { quality: 0.85, mimeType: "image/jpeg" },
>   "image/svg+xml": { quality: 1, mimeType: "image/png" },
> } as const;
> 
21,23c27,29
< 	'image/webp': 'webp',
< 	'image/jpeg': 'jpg',
< 	'image/png': 'png',
---
>   "image/webp": "webp",
>   "image/jpeg": "jpg",
>   "image/png": "png",
27,30c33,36
< 	file: File,
< 	folder?: any,
< 	name?: string,
< 	keepOriginal: boolean = defaultStore.state.keepOriginalUploading,
---
>   file: File,
>   folder?: any,
>   name?: string,
>   keepOriginal: boolean = defaultStore.state.keepOriginalUploading
32c38
< 	if ($i == null) throw new Error('Not logged in');
---
>   if (folder && typeof folder === "object") folder = folder.id;
34c40,41
< 	if (folder && typeof folder === 'object') folder = folder.id;
---
>   return new Promise((resolve, reject) => {
>     const id = Math.random().toString();
36,37c43,51
< 	return new Promise((resolve, reject) => {
< 		const id = Math.random().toString();
---
>     const reader = new FileReader();
>     reader.onload = async (ev) => {
>       const ctx = reactive<Uploading>({
>         id: id,
>         name: name || file.name || "untitled",
>         progressMax: undefined,
>         progressValue: undefined,
>         img: window.URL.createObjectURL(file),
>       });
39,47c53
< 		const reader = new FileReader();
< 		reader.onload = async (): Promise<void> => {
< 			const ctx = reactive<Uploading>({
< 				id: id,
< 				name: name ?? file.name ?? 'untitled',
< 				progressMax: undefined,
< 				progressValue: undefined,
< 				img: window.URL.createObjectURL(file),
< 			});
---
>       uploads.value.push(ctx);
49c55,57
< 			uploads.value.push(ctx);
---
>       let resizedImage: any;
>       if (!keepOriginal && file.type in compressTypeMap) {
>         const imgConfig = compressTypeMap[file.type];
51,64c59,64
< 			const config = !keepOriginal ? await getCompressionConfig(file) : undefined;
< 			let resizedImage: Blob | undefined;
< 			if (config) {
< 				try {
< 					const resized = await readAndCompressImage(file, config);
< 					if (resized.size < file.size || file.type === 'image/webp') {
< 						// The compression may not always reduce the file size
< 						// (and WebP is not browser safe yet)
< 						resizedImage = resized;
< 					}
< 					if (_DEV_) {
< 						const saved = ((1 - resized.size / file.size) * 100).toFixed(2);
< 						console.log(`Image compression: before ${file.size} bytes, after ${resized.size} bytes, saved ${saved}%`);
< 					}
---
>         const config = {
>           maxWidth: 2048,
>           maxHeight: 2048,
>           debug: true,
>           ...imgConfig,
>         };
66,70c66,77
< 					ctx.name = file.type !== config.mimeType ? `${ctx.name}.${mimeTypeMap[config.mimeType]}` : ctx.name;
< 				} catch (err) {
< 					console.error('Failed to resize image', err);
< 				}
< 			}
---
>         try {
>           resizedImage = await loadImage.scale(file, config);
>           ctx.name =
>             file.type !== imgConfig.mimeType
>               ? `${ctx.name}.${
>                   mimeTypeMap[compressTypeMap[file.type].mimeType]
>                 }`
>               : ctx.name;
>         } catch (err) {
>           console.error("Failed to resize image", err);
>         }
>       }
72,77c79,84
< 			const formData = new FormData();
< 			formData.append('i', $i.token);
< 			formData.append('force', 'true');
< 			formData.append('file', resizedImage ?? file);
< 			formData.append('name', ctx.name);
< 			if (folder) formData.append('folderId', folder);
---
>       const formData = new FormData();
>       formData.append("i", $i.token);
>       formData.append("force", "true");
>       formData.append("file", resizedImage || file);
>       formData.append("name", ctx.name);
>       if (folder) formData.append("folderId", folder);
79,84c86,95
< 			const xhr = new XMLHttpRequest();
< 			xhr.open('POST', apiUrl + '/drive/files/create', true);
< 			xhr.onload = ((ev: ProgressEvent<XMLHttpRequest>) => {
< 				if (xhr.status !== 200 || ev.target == null || ev.target.response == null) {
< 					// TODO: 消すのではなくて(ネットワーク的なエラーなら)再送できるようにしたい
< 					uploads.value = uploads.value.filter(x => x.id !== id);
---
>       const xhr = new XMLHttpRequest();
>       xhr.open("POST", $i.instanceUrl + "/api/drive/files/create", true);
>       xhr.onload = (ev) => {
>         if (
>           xhr.status !== 200 ||
>           ev.target == null ||
>           ev.target.response == null
>         ) {
>           // TODO: 消すのではなくて(ネットワーク的なエラーなら)再送できるようにしたい
>           uploads.value = uploads.value.filter((x) => x.id !== id);
86,113c97,128
< 					if (ev.target?.response) {
< 						const res = JSON.parse(ev.target.response);
< 						if (res.error?.id === 'bec5bd69-fba3-43c9-b4fb-2894b66ad5d2') {
< 							alert({
< 								type: 'error',
< 								title: i18n.ts.failedToUpload,
< 								text: i18n.ts.cannotUploadBecauseInappropriate,
< 							});
< 						} else if (res.error?.id === 'd08dbc37-a6a9-463a-8c47-96c32ab5f064') {
< 							alert({
< 								type: 'error',
< 								title: i18n.ts.failedToUpload,
< 								text: i18n.ts.cannotUploadBecauseNoFreeSpace,
< 							});
< 						} else {
< 							alert({
< 								type: 'error',
< 								title: i18n.ts.failedToUpload,
< 								text: `${res.error?.message}\n${res.error?.code}\n${res.error?.id}`,
< 							});
< 						}
< 					} else {
< 						alert({
< 							type: 'error',
< 							title: 'Failed to upload',
< 							text: `${JSON.stringify(ev.target?.response)}, ${JSON.stringify(xhr.response)}`,
< 						});
< 					}
---
>           if (ev.target?.response) {
>             const res = JSON.parse(ev.target.response);
>             if (res.error?.id === "bec5bd69-fba3-43c9-b4fb-2894b66ad5d2") {
>               alert({
>                 type: "error",
>                 title: i18n.ts.failedToUpload,
>                 text: i18n.ts.cannotUploadBecauseInappropriate,
>               });
>             } else if (
>               res.error?.id === "d08dbc37-a6a9-463a-8c47-96c32ab5f064"
>             ) {
>               alert({
>                 type: "error",
>                 title: i18n.ts.failedToUpload,
>                 text: i18n.ts.cannotUploadBecauseNoFreeSpace,
>               });
>             } else {
>               alert({
>                 type: "error",
>                 title: i18n.ts.failedToUpload,
>                 text: `${res.error?.message}\n${res.error?.code}\n${res.error?.id}`,
>               });
>             }
>           } else {
>             alert({
>               type: "error",
>               title: "Failed to upload",
>               text: `${JSON.stringify(ev.target?.response)}, ${JSON.stringify(
>                 xhr.response
>               )}`,
>             });
>           }
115,117c130,132
< 					reject();
< 					return;
< 				}
---
>           reject();
>           return;
>         }
119c134
< 				const driveFile = JSON.parse(ev.target.response);
---
>         const driveFile = JSON.parse(ev.target.response);
121c136
< 				resolve(driveFile);
---
>         resolve(driveFile);
123,124c138,139
< 				uploads.value = uploads.value.filter(x => x.id !== id);
< 			}) as (ev: ProgressEvent<EventTarget>) => any;
---
>         uploads.value = uploads.value.filter((x) => x.id !== id);
>       };
126,131c141,146
< 			xhr.upload.onprogress = ev => {
< 				if (ev.lengthComputable) {
< 					ctx.progressMax = ev.total;
< 					ctx.progressValue = ev.loaded;
< 				}
< 			};
---
>       xhr.upload.onprogress = (ev) => {
>         if (ev.lengthComputable) {
>           ctx.progressMax = ev.total;
>           ctx.progressValue = ev.loaded;
>         }
>       };
133,136c148,151
< 			xhr.send(formData);
< 		};
< 		reader.readAsArrayBuffer(file);
< 	});
---
>       xhr.send(formData);
>     };
>     reader.readAsArrayBuffer(file);
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/url.ts RiricaV13/scripts/url.ts
1,5d0
< /* objを検査して
<  * 1. 配列に何も入っていない時はクエリを付けない
<  * 2. プロパティがundefinedの時はクエリを付けない
<  * （new URLSearchParams(obj)ではそこまで丁寧なことをしてくれない）
<  */ 
7,9c2,4
< 	const params = Object.entries(obj)
< 		.filter(([, v]) => Array.isArray(v) ? v.length : v !== undefined)
< 		.reduce((a, [k, v]) => (a[k] = v, a), {} as Record<string, any>);
---
>   const params = Object.entries(obj)
>     .filter(([, v]) => (Array.isArray(v) ? v.length : v !== undefined))
>     .reduce((a, [k, v]) => ((a[k] = v), a), {} as Record<string, any>);
11,13c6,8
< 	return Object.entries(params)
< 		.map((p) => `${p[0]}=${encodeURIComponent(p[1])}`)
< 		.join('&');
---
>   return Object.entries(params)
>     .map((p) => `${p[0]}=${encodeURIComponent(p[1])}`)
>     .join("&");
17c12,14
< 	return `${url}${/\?/.test(url) ? url.endsWith('?') ? '' : '&' : '?'}${query}`;
---
>   return `${url}${
>     /\?/.test(url) ? (url.endsWith("?") ? "" : "&") : "?"
>   }${query}`;
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/use-chart-tooltip.ts RiricaV13/scripts/use-chart-tooltip.ts
1,3c1,3
< import { onUnmounted, onDeactivated, ref } from 'vue';
< import * as os from '@/os';
< import MkChartTooltip from '@/components/MkChartTooltip.vue';
---
> import { onUnmounted, ref } from "vue";
> import * as os from "@/os";
> import MkChartTooltip from "@/components/MkChartTooltip.vue";
5,11c5,11
< export function useChartTooltip(opts: { position: 'top' | 'middle' } = { position: 'top' }) {
< 	const tooltipShowing = ref(false);
< 	const tooltipX = ref(0);
< 	const tooltipY = ref(0);
< 	const tooltipTitle = ref(null);
< 	const tooltipSeries = ref(null);
< 	let disposeTooltipComponent;
---
> export function useChartTooltip() {
>   const tooltipShowing = ref(false);
>   const tooltipX = ref(0);
>   const tooltipY = ref(0);
>   const tooltipTitle = ref(null);
>   const tooltipSeries = ref(null);
>   let disposeTooltipComponent;
13,21c13,25
< 	os.popup(MkChartTooltip, {
< 		showing: tooltipShowing,
< 		x: tooltipX,
< 		y: tooltipY,
< 		title: tooltipTitle,
< 		series: tooltipSeries,
< 	}, {}).then(({ dispose }) => {
< 		disposeTooltipComponent = dispose;
< 	});
---
>   os.popup(
>     MkChartTooltip,
>     {
>       showing: tooltipShowing,
>       x: tooltipX,
>       y: tooltipY,
>       title: tooltipTitle,
>       series: tooltipSeries,
>     },
>     {}
>   ).then(({ dispose }) => {
>     disposeTooltipComponent = dispose;
>   });
23,25c27,29
< 	onUnmounted(() => {
< 		if (disposeTooltipComponent) disposeTooltipComponent();
< 	});
---
>   onUnmounted(() => {
>     if (disposeTooltipComponent) disposeTooltipComponent();
>   });
27,29c31,35
< 	onDeactivated(() => {
< 		tooltipShowing.value = false;
< 	});
---
>   function handler(context) {
>     if (context.tooltip.opacity === 0) {
>       tooltipShowing.value = false;
>       return;
>     }
31,35c37,42
< 	function handler(context) {
< 		if (context.tooltip.opacity === 0) {
< 			tooltipShowing.value = false;
< 			return;
< 		}
---
>     tooltipTitle.value = context.tooltip.title[0];
>     tooltipSeries.value = context.tooltip.body.map((b, i) => ({
>       backgroundColor: context.tooltip.labelColors[i].backgroundColor,
>       borderColor: context.tooltip.labelColors[i].borderColor,
>       text: b.lines[0],
>     }));
37,42c44
< 		tooltipTitle.value = context.tooltip.title[0];
< 		tooltipSeries.value = context.tooltip.body.map((b, i) => ({
< 			backgroundColor: context.tooltip.labelColors[i].backgroundColor,
< 			borderColor: context.tooltip.labelColors[i].borderColor,
< 			text: b.lines[0],
< 		}));
---
>     const rect = context.chart.canvas.getBoundingClientRect();
44c46,49
< 		const rect = context.chart.canvas.getBoundingClientRect();
---
>     tooltipShowing.value = true;
>     tooltipX.value = rect.left + window.pageXOffset + context.tooltip.caretX;
>     tooltipY.value = rect.top + window.pageYOffset + context.tooltip.caretY;
>   }
46,57c51,53
< 		tooltipShowing.value = true;
< 		tooltipX.value = rect.left + window.pageXOffset + context.tooltip.caretX;
< 		if (opts.position === 'top') {
< 			tooltipY.value = rect.top + window.pageYOffset;
< 		} else if (opts.position === 'middle') {
< 			tooltipY.value = rect.top + window.pageYOffset + context.tooltip.caretY;
< 		}
< 	}
< 
< 	return {
< 		handler,
< 	};
---
>   return {
>     handler,
>   };
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/use-interval.ts RiricaV13/scripts/use-interval.ts
1c1
< import { onMounted, onUnmounted } from 'vue';
---
> import { onMounted, onUnmounted } from "vue";
3,7c3,11
< export function useInterval(fn: () => void, interval: number, options: {
< 	immediate: boolean;
< 	afterMounted: boolean;
< }): (() => void) | undefined {
< 	if (Number.isNaN(interval)) return;
---
> export function useInterval(
>   fn: () => void,
>   interval: number,
>   options: {
>     immediate: boolean;
>     afterMounted: boolean;
>   }
> ): void {
>   if (Number.isNaN(interval)) return;
9c13
< 	let intervalId: number | null = null;
---
>   let intervalId: number | null = null;
11,19c15,23
< 	if (options.afterMounted) {
< 		onMounted(() => {
< 			if (options.immediate) fn();
< 			intervalId = window.setInterval(fn, interval);
< 		});
< 	} else {
< 		if (options.immediate) fn();
< 		intervalId = window.setInterval(fn, interval);
< 	}
---
>   if (options.afterMounted) {
>     onMounted(() => {
>       if (options.immediate) fn();
>       intervalId = window.setInterval(fn, interval);
>     });
>   } else {
>     if (options.immediate) fn();
>     intervalId = window.setInterval(fn, interval);
>   }
21,30c25,27
< 	const clear = () => {
< 		if (intervalId) window.clearInterval(intervalId);
< 		intervalId = null;
< 	};
< 
< 	onUnmounted(() => {
< 		clear();
< 	});
< 
< 	return clear;
---
>   onUnmounted(() => {
>     if (intervalId) window.clearInterval(intervalId);
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/use-leave-guard.ts RiricaV13/scripts/use-leave-guard.ts
1,3c1,3
< import { inject, onUnmounted, Ref } from 'vue';
< import { i18n } from '@/i18n';
< import * as os from '@/os';
---
> import { inject, onUnmounted, Ref } from "vue";
> import { i18n } from "@/i18n";
> import * as os from "@/os";
6c6
< 	/* TODO
---
>   /* TODO
33,34c33
< 
< 	/*
---
>   /*
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/use-note-capture.ts RiricaV13/scripts/use-note-capture.ts
1,4c1,4
< import { onUnmounted, Ref } from 'vue';
< import * as misskey from 'misskey-js';
< import { stream } from '@/stream';
< import { $i } from '@/account';
---
> import { onUnmounted, Ref } from "vue";
> import * as misskey from "misskey-js";
> import { stream } from "@/stream";
> import { $i } from "@/account";
7,9c7,9
< 	rootEl: Ref<HTMLElement>;
< 	note: Ref<misskey.entities.Note>;
< 	isDeletedRef: Ref<boolean>;
---
>   rootEl: Ref<HTMLElement>;
>   note: Ref<misskey.entities.Note>;
>   isDeletedRef: Ref<boolean>;
11,12c11,12
< 	const note = props.note;
< 	const connection = $i ? stream : null;
---
>   const note = props.note;
>   const connection = $i ? stream : null;
14,15c14,15
< 	function onStreamNoteUpdated(noteData): void {
< 		const { type, id, body } = noteData;
---
>   function onStreamNoteUpdated(noteData): void {
>     const { type, id, body } = noteData;
17c17
< 		if (id !== note.value.id) return;
---
>     if (id !== note.value.id) return;
19,21c19,21
< 		switch (type) {
< 			case 'reacted': {
< 				const reaction = body.reaction;
---
>     switch (type) {
>       case "reacted": {
>         const reaction = body.reaction;
23,28c23,28
< 				if (body.emoji) {
< 					const emojis = note.value.emojis || [];
< 					if (!emojis.includes(body.emoji)) {
< 						note.value.emojis = [...emojis, body.emoji];
< 					}
< 				}
---
>         if (body.emoji) {
>           const emojis = note.value.emojis || [];
>           if (!emojis.includes(body.emoji)) {
>             note.value.emojis = [...emojis, body.emoji];
>           }
>         }
30,31c30,31
< 				// TODO: reactionsプロパティがない場合ってあったっけ？ なければ || {} は消せる
< 				const currentCount = (note.value.reactions || {})[reaction] || 0;
---
>         // TODO: reactionsプロパティがない場合ってあったっけ？ なければ || {} は消せる
>         const currentCount = (note.value.reactions || {})[reaction] || 0;
33c33
< 				note.value.reactions[reaction] = currentCount + 1;
---
>         note.value.reactions[reaction] = currentCount + 1;
35,39c35,39
< 				if ($i && (body.userId === $i.id)) {
< 					note.value.myReaction = reaction;
< 				}
< 				break;
< 			}
---
>         if ($i && body.userId === $i.id) {
>           note.value.myReaction = reaction;
>         }
>         break;
>       }
41,42c41,42
< 			case 'unreacted': {
< 				const reaction = body.reaction;
---
>       case "unreacted": {
>         const reaction = body.reaction;
44,45c44,45
< 				// TODO: reactionsプロパティがない場合ってあったっけ？ なければ || {} は消せる
< 				const currentCount = (note.value.reactions || {})[reaction] || 0;
---
>         // TODO: reactionsプロパティがない場合ってあったっけ？ なければ || {} は消せる
>         const currentCount = (note.value.reactions || {})[reaction] || 0;
47,48c47
< 				note.value.reactions[reaction] = Math.max(0, currentCount - 1);
< 				if (note.value.reactions[reaction] === 0) delete note.value.reactions[reaction];
---
>         note.value.reactions[reaction] = Math.max(0, currentCount - 1);
50,54c49,53
< 				if ($i && (body.userId === $i.id)) {
< 					note.value.myReaction = null;
< 				}
< 				break;
< 			}
---
>         if ($i && body.userId === $i.id) {
>           note.value.myReaction = null;
>         }
>         break;
>       }
56,57c55,56
< 			case 'pollVoted': {
< 				const choice = body.choice;
---
>       case "pollVoted": {
>         const choice = body.choice;
59,66c58,67
< 				const choices = [...note.value.poll.choices];
< 				choices[choice] = {
< 					...choices[choice],
< 					votes: choices[choice].votes + 1,
< 					...($i && (body.userId === $i.id) ? {
< 						isVoted: true,
< 					} : {}),
< 				};
---
>         const choices = [...note.value.poll.choices];
>         choices[choice] = {
>           ...choices[choice],
>           votes: choices[choice].votes + 1,
>           ...($i && body.userId === $i.id
>             ? {
>                 isVoted: true,
>               }
>             : {}),
>         };
68,70c69,71
< 				note.value.poll.choices = choices;
< 				break;
< 			}
---
>         note.value.poll.choices = choices;
>         break;
>       }
72,77c73,78
< 			case 'deleted': {
< 				props.isDeletedRef.value = true;
< 				break;
< 			}
< 		}
< 	}
---
>       case "deleted": {
>         props.isDeletedRef.value = true;
>         break;
>       }
>     }
>   }
79,85c80,88
< 	function capture(withHandler = false): void {
< 		if (connection) {
< 			// TODO: このノートがストリーミング経由で流れてきた場合のみ sr する
< 			connection.send(document.body.contains(props.rootEl.value) ? 'sr' : 's', { id: note.value.id });
< 			if (withHandler) connection.on('noteUpdated', onStreamNoteUpdated);
< 		}
< 	}
---
>   function capture(withHandler = false): void {
>     if (connection) {
>       // TODO: このノートがストリーミング経由で流れてきた場合のみ sr する
>       connection.send(document.body.contains(props.rootEl.value) ? "sr" : "s", {
>         id: note.value.id,
>       });
>       if (withHandler) connection.on("noteUpdated", onStreamNoteUpdated);
>     }
>   }
87,94c90,97
< 	function decapture(withHandler = false): void {
< 		if (connection) {
< 			connection.send('un', {
< 				id: note.value.id,
< 			});
< 			if (withHandler) connection.off('noteUpdated', onStreamNoteUpdated);
< 		}
< 	}
---
>   function decapture(withHandler = false): void {
>     if (connection) {
>       connection.send("un", {
>         id: note.value.id,
>       });
>       if (withHandler) connection.off("noteUpdated", onStreamNoteUpdated);
>     }
>   }
96,110c99,113
< 	function onStreamConnected() {
< 		capture(false);
< 	}
< 	
< 	capture(true);
< 	if (connection) {
< 		connection.on('_connected_', onStreamConnected);
< 	}
< 	
< 	onUnmounted(() => {
< 		decapture(true);
< 		if (connection) {
< 			connection.off('_connected_', onStreamConnected);
< 		}
< 	});
---
>   function onStreamConnected() {
>     capture(false);
>   }
> 
>   capture(true);
>   if (connection) {
>     connection.on("_connected_", onStreamConnected);
>   }
> 
>   onUnmounted(() => {
>     decapture(true);
>     if (connection) {
>       connection.off("_connected_", onStreamConnected);
>     }
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/scripts/use-tooltip.ts RiricaV13/scripts/use-tooltip.ts
1c1
< import { Ref, ref, watch, onUnmounted } from 'vue';
---
> import { Ref, ref, watch, onUnmounted } from "vue";
4,6c4,6
< 	elRef: Ref<HTMLElement | { $el: HTMLElement } | null | undefined>,
< 	onShow: (showing: Ref<boolean>) => void,
< 	delay = 300,
---
>   elRef: Ref<HTMLElement | { $el: HTMLElement } | null | undefined>,
>   onShow: (showing: Ref<boolean>) => void,
>   delay = 300
8c8
< 	let isHovering = false;
---
>   let isHovering = false;
10,13c10,13
< 	// iOS(Androidも？)では、要素をタップした直後に(おせっかいで)mouseoverイベントを発火させたりするため、それを無視するためのフラグ
< 	// 無視しないと、画面に触れてないのにツールチップが出たりし、ユーザビリティが損なわれる
< 	// TODO: 一度でもタップすると二度とマウスでツールチップ出せなくなるのをどうにかする 定期的にfalseに戻すとか...？
< 	let shouldIgnoreMouseover = false;
---
>   // iOS(Androidも？)では、要素をタップした直後に(おせっかいで)mouseoverイベントを発火させたりするため、それを無視するためのフラグ
>   // 無視しないと、画面に触れてないのにツールチップが出たりし、ユーザビリティが損なわれる
>   // TODO: 一度でもタップすると二度とマウスでツールチップ出せなくなるのをどうにかする 定期的にfalseに戻すとか...？
>   let shouldIgnoreMouseover = false;
15c15
< 	let timeoutId: number;
---
>   let timeoutId: number;
17c17
< 	let changeShowingState: (() => void) | null;
---
>   let changeShowingState: (() => void) | null;
19,24c19,24
< 	const open = () => {
< 		close();
< 		if (!isHovering) return;
< 		if (elRef.value == null) return;
< 		const el = elRef.value instanceof Element ? elRef.value : elRef.value.$el;
< 		if (!document.body.contains(el)) return; // openしようとしたときに既に元要素がDOMから消えている場合があるため
---
>   const open = () => {
>     close();
>     if (!isHovering) return;
>     if (elRef.value == null) return;
>     const el = elRef.value instanceof Element ? elRef.value : elRef.value.$el;
>     if (!document.body.contains(el)) return; // openしようとしたときに既に元要素がDOMから消えている場合があるため
26,31c26,31
< 		const showing = ref(true);
< 		onShow(showing);
< 		changeShowingState = () => {
< 			showing.value = false;
< 		};
< 	};
---
>     const showing = ref(true);
>     onShow(showing);
>     changeShowingState = () => {
>       showing.value = false;
>     };
>   };
33,38c33,38
< 	const close = () => {
< 		if (changeShowingState != null) {
< 			changeShowingState();
< 			changeShowingState = null;
< 		}
< 	};
---
>   const close = () => {
>     if (changeShowingState != null) {
>       changeShowingState();
>       changeShowingState = null;
>     }
>   };
40,45c40,45
< 	const onMouseover = () => {
< 		if (isHovering) return;
< 		if (shouldIgnoreMouseover) return;
< 		isHovering = true;
< 		timeoutId = window.setTimeout(open, delay);
< 	};
---
>   const onMouseover = () => {
>     if (isHovering) return;
>     if (shouldIgnoreMouseover) return;
>     isHovering = true;
>     timeoutId = window.setTimeout(open, delay);
>   };
47,52c47,52
< 	const onMouseleave = () => {
< 		if (!isHovering) return;
< 		isHovering = false;
< 		window.clearTimeout(timeoutId);
< 		close();
< 	};
---
>   const onMouseleave = () => {
>     if (!isHovering) return;
>     isHovering = false;
>     window.clearTimeout(timeoutId);
>     close();
>   };
54,59c54,59
< 	const onTouchstart = () => {
< 		shouldIgnoreMouseover = true;
< 		if (isHovering) return;
< 		isHovering = true;
< 		timeoutId = window.setTimeout(open, delay);
< 	};
---
>   const onTouchstart = () => {
>     shouldIgnoreMouseover = true;
>     if (isHovering) return;
>     isHovering = true;
>     timeoutId = window.setTimeout(open, delay);
>   };
61,66c61,66
< 	const onTouchend = () => {
< 		if (!isHovering) return;
< 		isHovering = false;
< 		window.clearTimeout(timeoutId);
< 		close();
< 	};
---
>   const onTouchend = () => {
>     if (!isHovering) return;
>     isHovering = false;
>     window.clearTimeout(timeoutId);
>     close();
>   };
68,81c68,86
< 	const stop = watch(elRef, () => {
< 		if (elRef.value) {
< 			stop();
< 			const el = elRef.value instanceof Element ? elRef.value : elRef.value.$el;
< 			el.addEventListener('mouseover', onMouseover, { passive: true });
< 			el.addEventListener('mouseleave', onMouseleave, { passive: true });
< 			el.addEventListener('touchstart', onTouchstart, { passive: true });
< 			el.addEventListener('touchend', onTouchend, { passive: true });
< 			el.addEventListener('click', close, { passive: true });
< 		}
< 	}, {
< 		immediate: true,
< 		flush: 'post',
< 	});
---
>   const stop = watch(
>     elRef,
>     () => {
>       if (elRef.value) {
>         stop();
>         const el =
>           elRef.value instanceof Element ? elRef.value : elRef.value.$el;
>         el.addEventListener("mouseover", onMouseover, { passive: true });
>         el.addEventListener("mouseleave", onMouseleave, { passive: true });
>         el.addEventListener("touchstart", onTouchstart, { passive: true });
>         el.addEventListener("touchend", onTouchend, { passive: true });
>         el.addEventListener("click", close, { passive: true });
>       }
>     },
>     {
>       immediate: true,
>       flush: "post",
>     }
>   );
83,85c88,90
< 	onUnmounted(() => {
< 		close();
< 	});
---
>   onUnmounted(() => {
>     close();
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/store.ts RiricaV13/store.ts
1,3c1,3
< import { markRaw, ref } from 'vue';
< import { Storage } from './pizzax';
< import { Theme } from './scripts/theme';
---
> import { markRaw, ref } from "vue";
> import { Storage } from "./pizzax";
> import { Theme } from "./scripts/theme";
5,8c5,9
< interface PostFormAction {
< 	title: string,
< 	handler: <T>(form: T, update: (key: unknown, value: unknown) => void) => void;
< }
---
> export const postFormActions = [];
> export const userActions = [];
> export const noteActions = [];
> export const noteViewInterruptors = [];
> export const notePostInterruptors = [];
10,33d10
< interface UserAction {
< 	title: string,
< 	handler: (user: UserDetailed) => void;
< }
< 
< interface NoteAction {
< 	title: string,
< 	handler: (note: Note) => void;
< }
< 
< interface NoteViewInterruptor {
< 	handler: (note: Note) => unknown;
< }
< 
< interface NotePostInterruptor {
< 	handler: (note: FIXME) => unknown;
< }
< 
< export const postFormActions: PostFormAction[] = [];
< export const userActions: UserAction[] = [];
< export const noteActions: NoteAction[] = [];
< export const noteViewInterruptors: NoteViewInterruptor[] = [];
< export const notePostInterruptors: NotePostInterruptor[] = [];
< 
36,92c13,66
< export const defaultStore = markRaw(new Storage('base', {
< 	tutorial: {
< 		where: 'account',
< 		default: 0,
< 	},
< 	keepCw: {
< 		where: 'account',
< 		default: true,
< 	},
< 	showFullAcct: {
< 		where: 'account',
< 		default: false,
< 	},
< 	rememberNoteVisibility: {
< 		where: 'account',
< 		default: false,
< 	},
< 	defaultNoteVisibility: {
< 		where: 'account',
< 		default: 'public',
< 	},
< 	defaultNoteLocalOnly: {
< 		where: 'account',
< 		default: false,
< 	},
< 	uploadFolder: {
< 		where: 'account',
< 		default: null as string | null,
< 	},
< 	pastedFileName: {
< 		where: 'account',
< 		default: 'yyyy-MM-dd HH-mm-ss [{{number}}]',
< 	},
< 	keepOriginalUploading: {
< 		where: 'account',
< 		default: false,
< 	},
< 	memo: {
< 		where: 'account',
< 		default: null,
< 	},
< 	reactions: {
< 		where: 'account',
< 		default: ['👍', '❤️', '😆', '🤔', '😮', '🎉', '💢', '😥', '😇', '🍮'],
< 	},
< 	mutedWords: {
< 		where: 'account',
< 		default: [],
< 	},
< 	mutedAds: {
< 		where: 'account',
< 		default: [] as string[],
< 	},
< 	hiddenAds: {
< 		where: 'account',
< 		default: [] as string[],
< 	},
---
> export const defaultStore = markRaw(
>   new Storage("base", {
>     tutorial: {
>       where: "account",
>       default: 0,
>     },
>     keepCw: {
>       where: "account",
>       default: true,
>     },
>     showFullAcct: {
>       where: "account",
>       default: false,
>     },
>     rememberNoteVisibility: {
>       where: "account",
>       default: false,
>     },
>     defaultNoteVisibility: {
>       where: "account",
>       default: "public",
>     },
>     defaultNoteLocalOnly: {
>       where: "account",
>       default: false,
>     },
>     uploadFolder: {
>       where: "account",
>       default: null as string | null,
>     },
>     pastedFileName: {
>       where: "account",
>       default: "yyyy-MM-dd HH-mm-ss [{{number}}]",
>     },
>     keepOriginalUploading: {
>       where: "account",
>       default: false,
>     },
>     memo: {
>       where: "account",
>       default: null,
>     },
>     reactions: {
>       where: "account",
>       default: ["👍", "❤️", "😆", "🤔", "😮", "🎉", "💢", "😥", "😇", "🍮"],
>     },
>     mutedWords: {
>       where: "account",
>       default: [],
>     },
>     mutedAds: {
>       where: "account",
>       default: [] as string[],
>     },
94,143c68,117
< 	menu: {
< 		where: 'deviceAccount',
< 		default: [
< 			'notifications',
< 			'favorites',
< 			'drive',
< 			'followRequests',
< 			'-',
< 			'explore',
< 			'announcements',
< 			'search',
< 			'-',
< 			'ui',
< 		],
< 	},
< 	visibility: {
< 		where: 'deviceAccount',
< 		default: 'public' as 'public' | 'home' | 'followers' | 'specified',
< 	},
< 	localOnly: {
< 		where: 'deviceAccount',
< 		default: false,
< 	},
< 	statusbars: {
< 		where: 'deviceAccount',
< 		default: [] as {
< 			name: string;
< 			id: string;
< 			type: string;
< 			size: 'verySmall' | 'small' | 'medium' | 'large' | 'veryLarge';
< 			black: boolean;
< 			props: Record<string, any>;
< 		}[],
< 	},
< 	widgets: {
< 		where: 'account',
< 		default: [] as {
< 			name: string;
< 			id: string;
< 			place: string | null;
< 			data: Record<string, any>;
< 		}[],
< 	},
< 	tl: {
< 		where: 'deviceAccount',
< 		default: {
< 			src: 'home' as 'home' | 'local' | 'social' | 'global',
< 			arg: null,
< 		},
< 	},
---
>     menu: {
>       where: "deviceAccount",
>       default: [
>         "notifications",
>         "favorites",
>         "drive",
>         "followRequests",
>         "-",
>         "explore",
>         "announcements",
>         "search",
>         "-",
>         "ui",
>       ],
>     },
>     visibility: {
>       where: "deviceAccount",
>       default: "public" as "public" | "home" | "followers" | "specified",
>     },
>     localOnly: {
>       where: "deviceAccount",
>       default: false,
>     },
>     statusbars: {
>       where: "deviceAccount",
>       default: [] as {
>         name: string;
>         id: string;
>         type: string;
>         size: "verySmall" | "small" | "medium" | "large" | "veryLarge";
>         black: boolean;
>         props: Record<string, any>;
>       }[],
>     },
>     widgets: {
>       where: "deviceAccount",
>       default: [] as {
>         name: string;
>         id: string;
>         place: string | null;
>         data: Record<string, any>;
>       }[],
>     },
>     tl: {
>       where: "deviceAccount",
>       default: {
>         src: "home" as "home" | "local" | "social" | "global",
>         arg: null,
>       },
>     },
145,277c119,256
< 	overridedDeviceKind: {
< 		where: 'device',
< 		default: null as null | 'smartphone' | 'tablet' | 'desktop',
< 	},
< 	serverDisconnectedBehavior: {
< 		where: 'device',
< 		default: 'quiet' as 'quiet' | 'reload' | 'dialog',
< 	},
< 	nsfw: {
< 		where: 'device',
< 		default: 'respect' as 'respect' | 'force' | 'ignore',
< 	},
< 	animation: {
< 		where: 'device',
< 		default: true,
< 	},
< 	animatedMfm: {
< 		where: 'device',
< 		default: false,
< 	},
< 	loadRawImages: {
< 		where: 'device',
< 		default: false,
< 	},
< 	imageNewTab: {
< 		where: 'device',
< 		default: false,
< 	},
< 	disableShowingAnimatedImages: {
< 		where: 'device',
< 		default: false,
< 	},
< 	emojiStyle: {
< 		where: 'device',
< 		default: 'twemoji', // twemoji / fluentEmoji / native
< 	},
< 	disableDrawer: {
< 		where: 'device',
< 		default: false,
< 	},
< 	useBlurEffectForModal: {
< 		where: 'device',
< 		default: true,
< 	},
< 	useBlurEffect: {
< 		where: 'device',
< 		default: true,
< 	},
< 	showFixedPostForm: {
< 		where: 'device',
< 		default: false,
< 	},
< 	enableInfiniteScroll: {
< 		where: 'device',
< 		default: true,
< 	},
< 	useReactionPickerForContextMenu: {
< 		where: 'device',
< 		default: false,
< 	},
< 	showGapBetweenNotesInTimeline: {
< 		where: 'device',
< 		default: false,
< 	},
< 	darkMode: {
< 		where: 'device',
< 		default: false,
< 	},
< 	instanceTicker: {
< 		where: 'device',
< 		default: 'remote' as 'none' | 'remote' | 'always',
< 	},
< 	reactionPickerSize: {
< 		where: 'device',
< 		default: 1,
< 	},
< 	reactionPickerWidth: {
< 		where: 'device',
< 		default: 1,
< 	},
< 	reactionPickerHeight: {
< 		where: 'device',
< 		default: 2,
< 	},
< 	reactionPickerUseDrawerForMobile: {
< 		where: 'device',
< 		default: true,
< 	},
< 	recentlyUsedEmojis: {
< 		where: 'device',
< 		default: [] as string[],
< 	},
< 	recentlyUsedUsers: {
< 		where: 'device',
< 		default: [] as string[],
< 	},
< 	defaultSideView: {
< 		where: 'device',
< 		default: false,
< 	},
< 	menuDisplay: {
< 		where: 'device',
< 		default: 'sideFull' as 'sideFull' | 'sideIcon' | 'top',
< 	},
< 	reportError: {
< 		where: 'device',
< 		default: false,
< 	},
< 	squareAvatars: {
< 		where: 'device',
< 		default: false,
< 	},
< 	postFormWithHashtags: {
< 		where: 'device',
< 		default: false,
< 	},
< 	postFormHashtags: {
< 		where: 'device',
< 		default: '',
< 	},
< 	themeInitial: {
< 		where: 'device',
< 		default: true,
< 	},
< 	numberOfPageCache: {
< 		where: 'device',
< 		default: 5,
< 	},
< 	aiChanMode: {
< 		where: 'device',
< 		default: false,
< 	},
< }));
---
>     overridedDeviceKind: {
>       where: "device",
>       default: null as null | "smartphone" | "tablet" | "desktop",
>     },
>     serverDisconnectedBehavior: {
>       where: "device",
>       default: "quiet" as "quiet" | "reload" | "dialog",
>     },
>     nsfw: {
>       where: "device",
>       default: "respect" as "respect" | "force" | "ignore",
>     },
>     animation: {
>       where: "device",
>       default: true,
>     },
>     animatedMfm: {
>       where: "device",
>       default: true,
>     },
>     loadRawImages: {
>       where: "device",
>       default: false,
>     },
>     imageNewTab: {
>       where: "device",
>       default: false,
>     },
>     disableShowingAnimatedImages: {
>       where: "device",
>       default: false,
>     },
>     disablePagesScript: {
>       where: "device",
>       default: false,
>     },
>     useOsNativeEmojis: {
>       where: "device",
>       default: false,
>     },
>     disableDrawer: {
>       where: "device",
>       default: false,
>     },
>     useBlurEffectForModal: {
>       where: "device",
>       default: true,
>     },
>     useBlurEffect: {
>       where: "device",
>       default: true,
>     },
>     showFixedPostForm: {
>       where: "device",
>       default: false,
>     },
>     enableInfiniteScroll: {
>       where: "device",
>       default: true,
>     },
>     useReactionPickerForContextMenu: {
>       where: "device",
>       default: false,
>     },
>     showGapBetweenNotesInTimeline: {
>       where: "device",
>       default: false,
>     },
>     darkMode: {
>       where: "device",
>       default: false,
>     },
>     instanceTicker: {
>       where: "device",
>       default: "remote" as "none" | "remote" | "always",
>     },
>     reactionPickerSize: {
>       where: "device",
>       default: 1,
>     },
>     reactionPickerWidth: {
>       where: "device",
>       default: 1,
>     },
>     reactionPickerHeight: {
>       where: "device",
>       default: 2,
>     },
>     reactionPickerUseDrawerForMobile: {
>       where: "device",
>       default: true,
>     },
>     recentlyUsedEmojis: {
>       where: "device",
>       default: [] as string[],
>     },
>     recentlyUsedUsers: {
>       where: "device",
>       default: [] as string[],
>     },
>     defaultSideView: {
>       where: "device",
>       default: false,
>     },
>     menuDisplay: {
>       where: "device",
>       default: "sideFull" as "sideFull" | "sideIcon" | "top",
>     },
>     reportError: {
>       where: "device",
>       default: false,
>     },
>     squareAvatars: {
>       where: "device",
>       default: false,
>     },
>     postFormWithHashtags: {
>       where: "device",
>       default: false,
>     },
>     postFormHashtags: {
>       where: "device",
>       default: "",
>     },
>     themeInitial: {
>       where: "device",
>       default: true,
>     },
>     numberOfPageCache: {
>       where: "device",
>       default: 5,
>     },
>     aiChanMode: {
>       where: "device",
>       default: false,
>     },
>   })
> );
281c260
< const PREFIX = 'miux:' as const;
---
> const PREFIX = "miux:";
284,289c263,268
< 	id: string;
< 	name: string;
< 	active: boolean;
< 	configData: Record<string, any>;
< 	token: string;
< 	ast: any[];
---
>   id: string;
>   name: string;
>   active: boolean;
>   configData: Record<string, any>;
>   token: string;
>   ast: any[];
292,296d270
< interface Watcher {
< 	key: string;
< 	callback: (value: unknown) => void;
< }
< 
300,303c274,275
< import { miLocalStorage } from './local-storage';
< import lightTheme from '@/themes/l-light.json5';
< import darkTheme from '@/themes/d-green-lime.json5';
< import { Note, UserDetailed } from 'misskey-js/built/entities';
---
> import lightTheme from "@/themes/l-light.json5";
> import darkTheme from "@/themes/d-green-lime.json5";
306,320c278,292
< 	public static default = {
< 		lightTheme,
< 		darkTheme,
< 		syncDeviceDarkMode: true,
< 		plugins: [] as Plugin[],
< 		mediaVolume: 0.5,
< 		sound_masterVolume: 0.3,
< 		sound_note: { type: 'syuilo/down', volume: 1 },
< 		sound_noteMy: { type: 'syuilo/up', volume: 1 },
< 		sound_notification: { type: 'syuilo/pope2', volume: 1 },
< 		sound_chat: { type: 'syuilo/pope1', volume: 1 },
< 		sound_chatBg: { type: 'syuilo/waon', volume: 1 },
< 		sound_antenna: { type: 'syuilo/triple', volume: 1 },
< 		sound_channel: { type: 'syuilo/square-pico', volume: 1 },
< 	};
---
>   public static default = {
>     lightTheme,
>     darkTheme,
>     syncDeviceDarkMode: true,
>     plugins: [] as Plugin[],
>     mediaVolume: 0.5,
>     sound_masterVolume: 0.3,
>     sound_note: { type: "syuilo/down", volume: 1 },
>     sound_noteMy: { type: "syuilo/up", volume: 1 },
>     sound_notification: { type: "syuilo/pope2", volume: 1 },
>     sound_chat: { type: "syuilo/pope1", volume: 1 },
>     sound_chatBg: { type: "syuilo/waon", volume: 1 },
>     sound_antenna: { type: "syuilo/triple", volume: 1 },
>     sound_channel: { type: "syuilo/square-pico", volume: 1 },
>   };
322c294
< 	public static watchers: Watcher[] = [];
---
>   public static watchers = [];
324,334c296,308
< 	public static get<T extends keyof typeof ColdDeviceStorage.default>(key: T): typeof ColdDeviceStorage.default[T] {
< 		// TODO: indexedDBにする
< 		//       ただしその際はnullチェックではなくキー存在チェックにしないとダメ
< 		//       (indexedDBはnullを保存できるため、ユーザーが意図してnullを格納した可能性がある)
< 		const value = miLocalStorage.getItem(`${PREFIX}${key}`);
< 		if (value == null) {
< 			return ColdDeviceStorage.default[key];
< 		} else {
< 			return JSON.parse(value);
< 		}
< 	}
---
>   public static get<T extends keyof typeof ColdDeviceStorage.default>(
>     key: T
>   ): typeof ColdDeviceStorage.default[T] {
>     // TODO: indexedDBにする
>     //       ただしその際はnullチェックではなくキー存在チェックにしないとダメ
>     //       (indexedDBはnullを保存できるため、ユーザーが意図してnullを格納した可能性がある)
>     const value = localStorage.getItem(PREFIX + key);
>     if (value == null) {
>       return ColdDeviceStorage.default[key];
>     } else {
>       return JSON.parse(value);
>     }
>   }
336,343c310,320
< 	public static set<T extends keyof typeof ColdDeviceStorage.default>(key: T, value: typeof ColdDeviceStorage.default[T]): void {
< 		// 呼び出し側のバグ等で undefined が来ることがある
< 		// undefined を文字列として miLocalStorage に入れると参照する際の JSON.parse でコケて不具合の元になるため無視
< 		// eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
< 		if (value === undefined) {
< 			console.error(`attempt to store undefined value for key '${key}'`);
< 			return;
< 		}
---
>   public static set<T extends keyof typeof ColdDeviceStorage.default>(
>     key: T,
>     value: typeof ColdDeviceStorage.default[T]
>   ): void {
>     // 呼び出し側のバグ等で undefined が来ることがある
>     // undefined を文字列として localStorage に入れると参照する際の JSON.parse でコケて不具合の元になるため無視
>     // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition
>     if (value === undefined) {
>       console.error(`attempt to store undefined value for key '${key}'`);
>       return;
>     }
345c322
< 		miLocalStorage.setItem(`${PREFIX}${key}`, JSON.stringify(value));
---
>     localStorage.setItem(PREFIX + key, JSON.stringify(value));
347,350c324,327
< 		for (const watcher of this.watchers) {
< 			if (watcher.key === key) watcher.callback(value);
< 		}
< 	}
---
>     for (const watcher of this.watchers) {
>       if (watcher.key === key) watcher.callback(value);
>     }
>   }
352,354c329,331
< 	public static watch(key, callback) {
< 		this.watchers.push({ key, callback });
< 	}
---
>   public static watch(key, callback) {
>     this.watchers.push({ key, callback });
>   }
356,365c333,342
< 	// TODO: VueのcustomRef使うと良い感じになるかも
< 	public static ref<T extends keyof typeof ColdDeviceStorage.default>(key: T) {
< 		const v = ColdDeviceStorage.get(key);
< 		const r = ref(v);
< 		// TODO: このままではwatcherがリークするので開放する方法を考える
< 		this.watch(key, v => {
< 			r.value = v;
< 		});
< 		return r;
< 	}
---
>   // TODO: VueのcustomRef使うと良い感じになるかも
>   public static ref<T extends keyof typeof ColdDeviceStorage.default>(key: T) {
>     const v = ColdDeviceStorage.get(key);
>     const r = ref(v);
>     // TODO: このままではwatcherがリークするので開放する方法を考える
>     this.watch(key, (v) => {
>       r.value = v;
>     });
>     return r;
>   }
367,383c344,369
< 	/**
< 	 * 特定のキーの、簡易的なgetter/setterを作ります
< 	 * 主にvue場で設定コントロールのmodelとして使う用
< 	 */
< 	public static makeGetterSetter<K extends keyof typeof ColdDeviceStorage.default>(key: K) {
< 		// TODO: VueのcustomRef使うと良い感じになるかも
< 		const valueRef = ColdDeviceStorage.ref(key);
< 		return {
< 			get: () => {
< 				return valueRef.value;
< 			},
< 			set: (value: unknown) => {
< 				const val = value;
< 				ColdDeviceStorage.set(key, val);
< 			},
< 		};
< 	}
---
>   /**
>    * 特定のキーの、簡易的なgetter/setterを作ります
>    * 主にvue場で設定コントロールのmodelとして使う用
>    */
>   public static makeGetterSetter<
>     K extends keyof typeof ColdDeviceStorage.default
>   >(key: K) {
>     // TODO: VueのcustomRef使うと良い感じになるかも
>     const valueRef = ColdDeviceStorage.ref(key);
>     return {
>       get: () => {
>         return valueRef.value;
>       },
>       set: (value: unknown) => {
>         const val = value;
>         ColdDeviceStorage.set(key, val);
>       },
>     };
>   }
> }
> 
> // このファイルに書きたくないけどここに書かないと何故かVeturが認識しない
> declare module "@vue/runtime-core" {
>   interface ComponentCustomProperties {
>     $store: typeof defaultStore;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/stream.ts RiricaV13/stream.ts
1,4c1,3
< import * as Misskey from 'misskey-js';
< import { markRaw } from 'vue';
< import { $i } from '@/account';
< import { url } from '@/config';
---
> import * as Misskey from "misskey-js";
> import { markRaw } from "vue";
> import { $i } from "@/account";
6,8c5,14
< export const stream = markRaw(new Misskey.Stream(url, $i ? {
< 	token: $i.token,
< } : null));
---
> export const stream = markRaw(
>   new Misskey.Stream(
>     $i ? $i.instanceUrl : "https://misskey.io",
>     $i
>       ? {
>           token: $i.token,
>         }
>       : null
>   )
> );
Only in RiricaV13: style.css
diff --color=auto -r misskeyV13/packages/frontend/src/style.scss RiricaV13/style.scss
4,6c4,6
< 	--radius: 12px;
< 	--marginFull: 16px;
< 	--marginHalf: 10px;
---
>   --radius: 12px;
>   --marginFull: 16px;
>   --marginHalf: 10px;
8,14c8
< 	--margin: var(--marginFull);
< 	--minBottomSpacing: 0px;
< 	
< 	@media (max-width: 500px) {
< 		--margin: var(--marginHalf);
< 		--minBottomSpacing: calc(72px + max(12px, env(safe-area-inset-bottom, 0px)));
< 	}
---
>   --margin: var(--marginFull);
16c10,14
< 	//--ad: rgb(255 169 0 / 10%);
---
>   @media (max-width: 500px) {
>     --margin: var(--marginHalf);
>   }
> 
>   //--ad: rgb(255 169 0 / 10%);
20,22c18,20
< 	color: var(--fgOnAccent);
< 	background-color: var(--accent);
< } 
---
>   color: #fff;
>   background-color: var(--accent);
> }
25,38c23,37
< 	touch-action: manipulation;
< 	background-color: var(--bg);
< 	background-attachment: fixed;
< 	background-size: cover;
< 	background-position: center;
< 	color: var(--fg);
< 	accent-color: var(--accent);
< 	overflow: auto;
< 	overflow-wrap: break-word;
< 	font-family: 'Hiragino Maru Gothic Pro', "BIZ UDGothic", Roboto, HelveticaNeue, Arial, sans-serif;
< 	font-size: 14px;
< 	line-height: 1.35;
< 	text-size-adjust: 100%;
< 	tab-size: 2;
---
>   touch-action: manipulation;
>   background-color: var(--bg);
>   background-attachment: fixed;
>   background-size: cover;
>   background-position: center;
>   color: var(--fg);
>   accent-color: var(--accent);
>   overflow: auto;
>   overflow-wrap: break-word;
>   font-family: "Hiragino Maru Gothic Pro", "BIZ UDGothic", Roboto, HelveticaNeue,
>     Arial, sans-serif;
>   font-size: 14px;
>   line-height: 1.35;
>   text-size-adjust: 100%;
>   tab-size: 2;
40,42c39,42
< 	&, * {
< 		scrollbar-color: var(--scrollbarHandle) inherit;
< 		scrollbar-width: thin;
---
>   &,
>   * {
>     scrollbar-color: var(--scrollbarHandle) inherit;
>     scrollbar-width: thin;
44,47c44,47
< 		&::-webkit-scrollbar {
< 			width: 6px;
< 			height: 6px;
< 		}
---
>     &::-webkit-scrollbar {
>       width: 6px;
>       height: 6px;
>     }
49,51c49,51
< 		&::-webkit-scrollbar-track {
< 			background: inherit;
< 		}
---
>     &::-webkit-scrollbar-track {
>       background: inherit;
>     }
53,54c53,54
< 		&::-webkit-scrollbar-thumb {
< 			background: var(--scrollbarHandle);
---
>     &::-webkit-scrollbar-thumb {
>       background: var(--scrollbarHandle);
56,58c56,58
< 			&:hover {
< 				background: var(--scrollbarHandleHover);
< 			}
---
>       &:hover {
>         background: var(--scrollbarHandleHover);
>       }
60,64c60,64
< 			&:active {
< 				background: var(--accent);
< 			}
< 		}
< 	}
---
>       &:active {
>         background: var(--accent);
>       }
>     }
>   }
66,68c66,68
< 	&.f-1 {
< 		font-size: 15px;
< 	}
---
>   &.f-1 {
>     font-size: 15px;
>   }
70,72c70,72
< 	&.f-2 {
< 		font-size: 16px;
< 	}
---
>   &.f-2 {
>     font-size: 16px;
>   }
74,76c74,76
< 	&.f-3 {
< 		font-size: 17px;
< 	}
---
>   &.f-3 {
>     font-size: 17px;
>   }
78,80c78,80
< 	&.useSystemFont {
< 		font-family: 'Hiragino Maru Gothic Pro', sans-serif;
< 	}
---
>   &.useSystemFont {
>     font-family: "Hiragino Maru Gothic Pro", sans-serif;
>   }
84,86c84,87
< 	&, * {
< 		transition: background 1s ease, border 1s ease !important;
< 	}
---
>   &,
>   * {
>     transition: background 1s ease, border 1s ease !important;
>   }
89,92c90,94
< html, body {
< 	margin: 0;
< 	padding: 0;
< 	scroll-behavior: smooth;
---
> html,
> body {
>   margin: 0;
>   padding: 0;
>   scroll-behavior: smooth;
96,101c98,102
< 	text-decoration: none;
< 	cursor: pointer;
< 	color: inherit;
< 	tap-highlight-color: transparent;
< 	-webkit-tap-highlight-color: transparent;
< 	-webkit-touch-callout: none;
---
>   text-decoration: none;
>   cursor: pointer;
>   color: inherit;
>   tap-highlight-color: transparent;
>   -webkit-tap-highlight-color: transparent;
103,109c104,106
< 	&:hover {
< 		text-decoration: underline;
< 	}
< 
< 	&[target="_blank"] {
< 		-webkit-touch-callout: default;
< 	}
---
>   &:hover {
>     text-decoration: underline;
>   }
112,114c109,112
< textarea, input {
< 	tap-highlight-color: transparent;
< 	-webkit-tap-highlight-color: transparent;
---
> textarea,
> input {
>   tap-highlight-color: transparent;
>   -webkit-tap-highlight-color: transparent;
117,119c115,118
< optgroup, option {
< 	background: var(--panel);
< 	color: var(--fg);
---
> optgroup,
> option {
>   background: var(--panel);
>   color: var(--fg);
123,126c122,125
< 	margin: var(--margin) 0 var(--margin) 0;
< 	border: none;
< 	height: 1px;
< 	background: var(--divider);
---
>   margin: var(--margin) 0 var(--margin) 0;
>   border: none;
>   height: 1px;
>   background: var(--divider);
129,152d127
< .ti {
< 	vertical-align: -40%;
< 	line-height: 1em;
< 
< 	&:before {
< 		display: inline-block;
< 		font-size: 165%;
< 		width: 0.74em;
< 	}
< }
< 
< .ti-fw {
< 	display: inline-block;
< 	text-align: center;
< }
< 
< ._indicatorCircle {
< 	display: inline-block;
< 	width: 1em;
< 	height: 1em;
< 	border-radius: 100%;
< 	background: currentColor;
< }
< 
154,156c129,131
< 	user-select: none;
< 	-webkit-user-select: none;
< 	-webkit-touch-callout: none;
---
>   user-select: none;
>   -webkit-user-select: none;
>   -webkit-touch-callout: none;
160,161c135,139
< 	@extend ._noSelect;
< 	pointer-events: none;
---
>   &,
>   * {
>     @extend ._noSelect;
>     pointer-events: none;
>   }
165,172c143,150
< 	position: fixed;
< 	top: 0;
< 	left: 0;
< 	width: 100%;
< 	height: 100%;
< 	background: var(--modalBg);
< 	-webkit-backdrop-filter: var(--modalBgFilter);
< 	backdrop-filter: var(--modalBgFilter);
---
>   position: fixed;
>   top: 0;
>   left: 0;
>   width: 100%;
>   height: 100%;
>   background: var(--modalBg);
>   -webkit-backdrop-filter: var(--modalBgFilter);
>   backdrop-filter: var(--modalBgFilter);
176c154
< 	box-shadow: 0px 4px 32px var(--shadow) !important;
---
>   box-shadow: 0px 4px 32px var(--shadow) !important;
180,195c158,171
< 	@extend ._noSelect;
< 	appearance: none;
< 	display: inline-block;
< 	padding: 0;
< 	margin: 0; // for Safari
< 	background: none;
< 	border: none;
< 	cursor: pointer;
< 	color: inherit;
< 	touch-action: manipulation;
< 	tap-highlight-color: transparent;
< 	-webkit-tap-highlight-color: transparent;
< 	font-size: 1em;
< 	font-family: inherit;
< 	line-height: inherit;
< 	max-width: 100%;
---
>   appearance: none;
>   display: inline-block;
>   padding: 0;
>   margin: 0; // for Safari
>   background: none;
>   border: none;
>   cursor: pointer;
>   color: inherit;
>   touch-action: manipulation;
>   tap-highlight-color: transparent;
>   -webkit-tap-highlight-color: transparent;
>   font-size: 1em;
>   font-family: inherit;
>   line-height: inherit;
197,199c173,176
< 	&:focus-visible {
< 		outline: none;
< 	}
---
>   &,
>   * {
>     @extend ._noSelect;
>   }
201,204c178,189
< 	&:disabled {
< 		opacity: 0.5;
< 		cursor: default;
< 	}
---
>   * {
>     pointer-events: none;
>   }
> 
>   &:focus-visible {
>     outline: none;
>   }
> 
>   &:disabled {
>     opacity: 0.5;
>     cursor: default;
>   }
208,210c193,195
< 	@extend ._button;
< 	color: var(--fgOnAccent);
< 	background: var(--accent);
---
>   @extend ._button;
>   color: var(--fgOnAccent);
>   background: var(--accent);
212,214c197,199
< 	&:not(:disabled):hover {
< 		background: var(--X8);
< 	}
---
>   &:not(:disabled):hover {
>     background: var(--X8);
>   }
216,218c201,203
< 	&:not(:disabled):active {
< 		background: var(--X9);
< 	}
---
>   &:not(:disabled):active {
>     background: var(--X9);
>   }
222,224c207,213
< 	@extend ._buttonPrimary;
< 	color: var(--fgOnAccent);
< 	background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
---
>   @extend ._buttonPrimary;
>   color: var(--fgOnAccent);
>   background: linear-gradient(
>     90deg,
>     var(--buttonGradateA),
>     var(--buttonGradateB)
>   );
226,228c215,217
< 	&:not(:disabled):hover {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
---
>   &:not(:disabled):hover {
>     background: linear-gradient(90deg, var(--X8), var(--X8));
>   }
230,232c219,221
< 	&:not(:disabled):active {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
---
>   &:not(:disabled):active {
>     background: linear-gradient(90deg, var(--X8), var(--X8));
>   }
236,237c225,226
< 	color: var(--accent);
< 	cursor: help
---
>   color: var(--accent);
>   cursor: help;
241,242c230,231
< 	@extend ._button;
< 	color: var(--accent);
---
>   @extend ._button;
>   color: var(--accent);
244,246c233,235
< 	&:not(:disabled):hover {
< 		text-decoration: underline;
< 	}
---
>   &:not(:disabled):hover {
>     text-decoration: underline;
>   }
249,253c238,240
< ._panel {
< 	background: var(--panel);
< 	border-radius: var(--radius);
< 	overflow: clip;
< }
---
> ._inputs {
>   display: flex;
>   margin: 32px 0;
255,256c242,261
< ._margin {
< 	margin: var(--margin) 0;
---
>   &:first-child {
>     margin-top: 8px;
>   }
> 
>   &:last-child {
>     margin-bottom: 8px;
>   }
> 
>   > * {
>     flex: 1;
>     margin: 0 !important;
> 
>     &:not(:first-child) {
>       margin-left: 8px !important;
>     }
> 
>     &:not(:last-child) {
>       margin-right: 8px !important;
>     }
>   }
259,262c264,267
< ._gaps_m {
< 	display: flex;
< 	flex-direction: column;
< 	gap: 1.5em;
---
> ._panel {
>   background: var(--panel);
>   border-radius: var(--radius);
>   overflow: clip;
265,268c270,275
< ._gaps_s {
< 	display: flex;
< 	flex-direction: column;
< 	gap: 0.75em;
---
> ._block {
>   @extend ._panel;
> 
>   & + ._block {
>     margin-top: var(--margin);
>   }
271,274c278,279
< ._gaps {
< 	display: flex;
< 	flex-direction: column;
< 	gap: var(--margin);
---
> ._gap {
>   margin: var(--margin) 0;
277,280c282,327
< ._buttons {
< 	display: flex;
< 	gap: 8px;
< 	flex-wrap: wrap;
---
> // TODO: 廃止
> ._card {
>   @extend ._panel;
> 
>   // TODO: _cardTitle に
>   > ._title {
>     margin: 0;
>     padding: 22px 32px;
>     font-size: 1em;
>     border-bottom: solid 1px var(--panelHeaderDivider);
>     font-weight: bold;
>     background: var(--panelHeaderBg);
>     color: var(--panelHeaderFg);
> 
>     @media (max-width: 500px) {
>       padding: 16px;
>       font-size: 1em;
>     }
>   }
> 
>   // TODO: _cardContent に
>   > ._content {
>     padding: 32px;
> 
>     @media (max-width: 500px) {
>       padding: 16px;
>     }
> 
>     &._noPad {
>       padding: 0 !important;
>     }
> 
>     & + ._content {
>       border-top: solid 0.5px var(--divider);
>     }
>   }
> 
>   // TODO: _cardFooter に
>   > ._footer {
>     border-top: solid 0.5px var(--divider);
>     padding: 24px 32px;
> 
>     @media (max-width: 500px) {
>       padding: 16px;
>     }
>   }
284,291c331,338
< 	@extend ._button;
< 	display: block;
< 	width: 100%;
< 	padding: 10px;
< 	box-sizing: border-box;
< 	text-align: center;
< 	border: solid 0.5px var(--divider);
< 	border-radius: var(--radius);
---
>   @extend ._button;
>   display: block;
>   width: 100%;
>   padding: 10px;
>   box-sizing: border-box;
>   text-align: center;
>   border: solid 0.5px var(--divider);
>   border-radius: var(--radius);
293,295c340,342
< 	&:active {
< 		border-color: var(--accent);
< 	}
---
>   &:active {
>     border-color: var(--accent);
>   }
299,301c346,348
< 	background: var(--popup);
< 	border-radius: var(--radius);
< 	contain: content;
---
>   background: var(--popup);
>   border-radius: var(--radius);
>   contain: content;
303a351,381
> // TODO: 廃止
> ._monolithic_ {
>   ._section:not(:empty) {
>     box-sizing: border-box;
>     padding: var(--root-margin, 32px);
> 
>     @media (max-width: 500px) {
>       --root-margin: 10px;
>     }
> 
>     & + ._section:not(:empty) {
>       border-top: solid 0.5px var(--divider);
>     }
>   }
> }
> 
> ._narrow_ ._card {
>   > ._title {
>     padding: 16px;
>     font-size: 1em;
>   }
> 
>   > ._content {
>     padding: 16px;
>   }
> 
>   > ._footer {
>     padding: 16px;
>   }
> }
> 
305,307c383,385
< 	background: var(--acrylicPanel);
< 	-webkit-backdrop-filter: var(--blur, blur(15px));
< 	backdrop-filter: var(--blur, blur(15px));
---
>   background: var(--acrylicPanel);
>   -webkit-backdrop-filter: var(--blur, blur(15px));
>   backdrop-filter: var(--blur, blur(15px));
309a388,401
> ._formBlock {
>   margin: 1.5em 0;
> }
> 
> ._formRoot {
>   > ._formBlock:first-child {
>     margin-top: 0;
>   }
> 
>   > ._formBlock:last-child {
>     margin-bottom: 0;
>   }
> }
> 
311,313c403,405
< 	display: grid;
< 	grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
< 	grid-gap: 12px;
---
>   display: grid;
>   grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
>   grid-gap: 12px;
317,319c409,411
< 	> *:not(:last-child) {
< 		margin-bottom: 8px;
< 	}
---
>   > *:not(:last-child) {
>     margin-bottom: 8px;
>   }
323,329c415,421
< 	margin-left: 0.7em;
< 	font-size: 65%;
< 	padding: 2px 3px;
< 	color: var(--accent);
< 	border: solid 1px var(--accent);
< 	border-radius: 4px;
< 	vertical-align: top;
---
>   margin-left: 0.7em;
>   font-size: 65%;
>   padding: 2px 3px;
>   color: var(--accent);
>   border: solid 1px var(--accent);
>   border-radius: 4px;
>   vertical-align: top;
333,334c425,426
< 	> ._row {
< 		display: flex;
---
>   > ._row {
>     display: flex;
336,337c428,429
< 		&:not(:last-child) {
< 			margin-bottom: 16px;
---
>     &:not(:last-child) {
>       margin-bottom: 16px;
339,342c431,434
< 			@media (max-width: 500px) {
< 				margin-bottom: 8px;
< 			}
< 		}
---
>       @media (max-width: 500px) {
>         margin-bottom: 8px;
>       }
>     }
344,345c436,437
< 		> ._cell {
< 			flex: 1;
---
>     > ._cell {
>       flex: 1;
347,349c439,441
< 			> ._label {
< 				font-size: 80%;
< 				opacity: 0.7;
---
>       > ._label {
>         font-size: 80%;
>         opacity: 0.7;
351,357c443,449
< 				> ._icon {
< 					margin-right: 4px;
< 					display: none;
< 				}
< 			}
< 		}
< 	}
---
>         > ._icon {
>           margin-right: 4px;
>           display: none;
>         }
>       }
>     }
>   }
361,362c453,454
< 	padding: 64px 32px;
< 	text-align: center;
---
>   padding: 64px 32px;
>   text-align: center;
364,369c456,461
< 	> img {
< 		vertical-align: bottom;
< 		height: 128px;
< 		margin-bottom: 16px;
< 		border-radius: 16px;
< 	}
---
>   > img {
>     vertical-align: bottom;
>     height: 128px;
>     margin-bottom: 16px;
>     border-radius: 16px;
>   }
371a464,471
> ._keyValue {
>   display: flex;
> 
>   > * {
>     flex: 1;
>   }
> }
> 
373c473
< 	color: var(--link);
---
>   color: var(--link);
377,378c477,478
< 	font-size: 0.8em;
< 	opacity: 0.7;
---
>   font-size: 0.8em;
>   opacity: 0.7;
382c482
< 	font-family: Fira code, Fira Mono, Consolas, Menlo, Courier, monospace !important;
---
>   font-family: Fira code, Fira Mono, Consolas, Menlo, Courier, monospace !important;
386,391c486,491
< 	@extend ._monospace;
< 	background: #2d2d2d;
< 	color: #ccc;
< 	font-size: 14px;
< 	line-height: 1.5;
< 	padding: 5px;
---
>   @extend ._monospace;
>   background: #2d2d2d;
>   color: #ccc;
>   font-size: 14px;
>   line-height: 1.5;
>   padding: 5px;
395c495
< 	outline: none;
---
>   outline: none;
399,401c499,501
< 	transition-duration: 0.5s, 0.5s;
< 	transition-property: opacity, transform;
< 	transition-timing-function: cubic-bezier(0,.5,.5,1);
---
>   transition-duration: 0.5s, 0.5s;
>   transition-property: opacity, transform;
>   transition-timing-function: cubic-bezier(0, 0.5, 0.5, 1);
404,405c504,506
< ._transition_zoom-enter-active, ._transition_zoom-leave-active {
< 	transition: opacity 0.5s, transform 0.5s !important;
---
> .zoom-enter-active,
> .zoom-leave-active {
>   transition: opacity 0.5s, transform 0.5s !important;
407,409c508,511
< ._transition_zoom-enter-from, ._transition_zoom-leave-to {
< 	opacity: 0;
< 	transform: scale(0.9);
---
> .zoom-enter-from,
> .zoom-leave-to {
>   opacity: 0;
>   transform: scale(0.9);
413,415c515,526
< 	0% { opacity: 1; transform: scale(1); }
< 	30% { opacity: 1; transform: scale(1); }
< 	90% { opacity: 0; transform: scale(0.5); }
---
>   0% {
>     opacity: 1;
>     transform: scale(1);
>   }
>   30% {
>     opacity: 1;
>     transform: scale(1);
>   }
>   90% {
>     opacity: 0;
>     transform: scale(0.5);
>   }
419,421c530,532
< 	from {
< 		transform: scale3d(1, 1, 1);
< 	}
---
>   from {
>     transform: scale3d(1, 1, 1);
>   }
423,426c534,537
< 	10%,
< 	20% {
< 		transform: scale3d(0.9, 0.9, 0.9) rotate3d(0, 0, 1, -3deg);
< 	}
---
>   10%,
>   20% {
>     transform: scale3d(0.9, 0.9, 0.9) rotate3d(0, 0, 1, -3deg);
>   }
428,433c539,544
< 	30%,
< 	50%,
< 	70%,
< 	90% {
< 		transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg);
< 	}
---
>   30%,
>   50%,
>   70%,
>   90% {
>     transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg);
>   }
435,439c546,550
< 	40%,
< 	60%,
< 	80% {
< 		transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg);
< 	}
---
>   40%,
>   60%,
>   80% {
>     transform: scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg);
>   }
441,443c552,554
< 	to {
< 		transform: scale3d(1, 1, 1);
< 	}
---
>   to {
>     transform: scale3d(1, 1, 1);
>   }
447c558
< 	will-change: transform;
---
>   will-change: transform;
453,454c564,565
< 	will-change: transform;
< 	transform:  scaleX(0.90) scaleY(0.90) ;
---
>   will-change: transform;
>   transform: scaleX(0.9) scaleY(0.9);
457c568
< 	transition: transform 0.1s ease;
---
>   transition: transform 0.1s ease;
462c573
<     transform:  scaleX(0.90) scaleY(0.90) ;
---
>     transform: scaleX(0.9) scaleY(0.9);
465c576
<     transform:  scaleX(1.10) scaleY(1.10) ;
---
>     transform: scaleX(1.1) scaleY(1.1);
468c579
<     transform:  scaleX(0.95) scaleY(0.95) ;
---
>     transform: scaleX(0.95) scaleY(0.95);
471c582
<     transform:  scaleX(1.00) scaleY(1.00) ;
---
>     transform: scaleX(1) scaleY(1);
diff --color=auto -r misskeyV13/packages/frontend/src/theme-store.ts RiricaV13/theme-store.ts
1,4c1,3
< import { api } from '@/os';
< import { $i } from '@/account';
< import { Theme } from './scripts/theme';
< import { miLocalStorage } from './local-storage';
---
> import { api } from "@/os";
> import { $i } from "@/account";
> import { Theme } from "./scripts/theme";
6c5
< const lsCacheKey = $i ? `themes:${$i.id}` as const : null;
---
> const lsCacheKey = $i ? `themes:${$i.id}` : "";
9,10c8
< 	if ($i == null) return [];
< 	return JSON.parse(miLocalStorage.getItem(lsCacheKey!) || '[]');
---
>   return JSON.parse(localStorage.getItem(lsCacheKey) || "[]");
14c12
< 	if ($i == null) return;
---
>   if ($i == null) return;
16,22c14,107
< 	try {
< 		const themes = await api('i/registry/get', { scope: ['client'], key: 'themes' });
< 		miLocalStorage.setItem(lsCacheKey!, JSON.stringify(themes));
< 	} catch (err) {
< 		if (err.code === 'NO_SUCH_KEY') return;
< 		throw err;
< 	}
---
>   // const themes = await api('i/registry/get', { scope: ['client'], key: 'themes' });
>   localStorage.setItem(
>     lsCacheKey,
>     JSON.stringify([
>       {
>         accent: "rgb(134, 179, 0)",
>         accentDarken: "rgb(96, 128, 0)",
>         accentLighten: "rgb(172, 230, 0)",
>         accentedBg: "rgba(134, 179, 0, 0.15)",
>         focus: "rgba(134, 179, 0, 0.3)",
>         bg: "rgb(249, 249, 249)",
>         acrylicBg: "rgba(249, 249, 249, 0.5)",
>         fg: "rgb(103, 103, 103)",
>         fgTransparentWeak: "rgba(103, 103, 103, 0.75)",
>         fgTransparent: "rgba(103, 103, 103, 0.5)",
>         fgHighlighted: "rgb(95, 95, 95)",
>         fgOnAccent: "rgb(255, 255, 255)",
>         divider: "rgb(232, 232, 232)",
>         indicator: "rgb(134, 179, 0)",
>         panel: "rgb(255, 255, 255)",
>         panelHighlight: "rgb(247, 247, 247)",
>         panelHeaderBg: "rgb(255, 255, 255)",
>         panelHeaderFg: "rgb(103, 103, 103)",
>         panelHeaderDivider: "rgb(232, 232, 232)",
>         panelBorder: "solid 1px var(--divider)",
>         acrylicPanel: "rgba(255, 255, 255, 0.5)",
>         windowHeader: "rgba(255, 255, 255, 0.85)",
>         popup: "rgb(255, 255, 255)",
>         shadow: "rgba(0, 0, 0, 0.1)",
>         header: "rgba(255, 255, 255, 0.95)",
>         navBg: "rgb(255, 255, 255)",
>         navFg: "rgb(103, 103, 103)",
>         navHoverFg: "rgb(60, 60, 60)",
>         navActive: "rgb(134, 179, 0)",
>         navIndicator: "rgb(134, 179, 0)",
>         link: "rgb(68, 164, 193)",
>         hashtag: "rgb(255, 145, 86)",
>         mention: "rgb(134, 179, 0)",
>         mentionMe: "rgb(0, 179, 70)",
>         renote: "rgb(34, 158, 130)",
>         modalBg: "rgba(0, 0, 0, 0.3)",
>         scrollbarHandle: "rgba(0, 0, 0, 0.2)",
>         scrollbarHandleHover: "rgba(0, 0, 0, 0.4)",
>         dateLabelFg: "rgb(103, 103, 103)",
>         infoBg: "rgb(229, 245, 255)",
>         infoFg: "rgb(114, 129, 138)",
>         infoWarnBg: "rgb(255, 240, 219)",
>         infoWarnFg: "rgb(143, 110, 49)",
>         switchBg: "rgba(0, 0, 0, 0.15)",
>         cwBg: "rgb(177, 185, 193)",
>         cwFg: "rgb(255, 255, 255)",
>         cwHoverBg: "rgb(187, 196, 206)",
>         buttonBg: "rgba(0, 0, 0, 0.05)",
>         buttonHoverBg: "rgba(0, 0, 0, 0.1)",
>         buttonGradateA: "rgb(134, 179, 0)",
>         buttonGradateB: "rgb(74, 179, 0)",
>         swutchOffBg: "rgba(0, 0, 0, 0.1)",
>         swutchOffFg: "rgb(255, 255, 255)",
>         swutchOnBg: "rgb(134, 179, 0)",
>         swutchOnFg: "rgb(255, 255, 255)",
>         inputBorder: "rgba(0, 0, 0, 0.1)",
>         inputBorderHover: "rgba(0, 0, 0, 0.2)",
>         listItemHoverBg: "rgba(0, 0, 0, 0.03)",
>         driveFolderBg: "rgba(134, 179, 0, 0.3)",
>         wallpaperOverlay: "rgba(255, 255, 255, 0.5)",
>         badge: "rgb(49, 177, 206)",
>         messageBg: "rgb(249, 249, 249)",
>         success: "rgb(134, 179, 0)",
>         error: "rgb(236, 65, 55)",
>         warn: "rgb(236, 182, 55)",
>         codeString: "rgb(185, 135, 16)",
>         codeNumber: "rgb(15, 187, 187)",
>         codeBoolean: "rgb(98, 183, 12)",
>         deckDivider: "rgb(241, 241, 241)",
>         htmlThemeColor: "rgb(249, 249, 249)",
>         X2: "rgb(250, 250, 250)",
>         X3: "rgba(0, 0, 0, 0.05)",
>         X4: "rgba(0, 0, 0, 0.1)",
>         X5: "rgba(0, 0, 0, 0.05)",
>         X6: "rgba(0, 0, 0, 0.25)",
>         X7: "rgba(0, 0, 0, 0.05)",
>         X8: "rgb(153, 204, 0)",
>         X9: "rgb(115, 153, 0)",
>         X10: "rgba(134, 179, 0, 0.4)",
>         X11: "rgba(0, 0, 0, 0.1)",
>         X12: "rgba(0, 0, 0, 0.1)",
>         X13: "rgba(0, 0, 0, 0.15)",
>         X14: "rgba(255, 255, 255, 0.95)",
>         X15: "rgba(255, 255, 255, 0)",
>         X16: "rgba(255, 255, 255, 0.7)",
>         X17: "rgba(249, 249, 249, 0.8)",
>       },
>     ])
>   );
26,30c111,118
< 	if ($i == null) return;
< 	await fetchThemes();
< 	const themes = getThemes().concat(theme);
< 	await api('i/registry/set', { scope: ['client'], key: 'themes', value: themes });
< 	miLocalStorage.setItem(lsCacheKey!, JSON.stringify(themes));
---
>   await fetchThemes();
>   const themes = getThemes().concat(theme);
>   // await api("i/registry/set", {
>   //   scope: ["client"],
>   //   key: "themes",
>   //   value: themes,
>   // });
>   localStorage.setItem(lsCacheKey, JSON.stringify(themes));
34,37c122,128
< 	if ($i == null) return;
< 	const themes = getThemes().filter(t => t.id !== theme.id);
< 	await api('i/registry/set', { scope: ['client'], key: 'themes', value: themes });
< 	miLocalStorage.setItem(lsCacheKey!, JSON.stringify(themes));
---
>   const themes = getThemes().filter((t) => t.id !== theme.id);
>   // await api("i/registry/set", {
>   //   scope: ["client"],
>   //   key: "themes",
>   //   value: themes,
>   // });
>   localStorage.setItem(lsCacheKey, JSON.stringify(themes));
diff --color=auto -r misskeyV13/packages/frontend/src/themes/_dark.json5 RiricaV13/themes/_dark.json5
4c4
< 	id: 'dark',
---
>   id: "dark",
6,9c6,9
< 	name: 'Dark',
< 	author: 'syuilo',
< 	desc: 'Default dark theme',
< 	kind: 'dark',
---
>   name: "Dark",
>   author: "syuilo",
>   desc: "Default dark theme",
>   kind: "dark",
11,98c11,98
< 	props: {
< 		accent: '#86b300',
< 		accentDarken: ':darken<10<@accent',
< 		accentLighten: ':lighten<10<@accent',
< 		accentedBg: ':alpha<0.15<@accent',
< 		focus: ':alpha<0.3<@accent',
< 		bg: '#000',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		fg: '#dadada',
< 		fgTransparentWeak: ':alpha<0.75<@fg',
< 		fgTransparent: ':alpha<0.5<@fg',
< 		fgHighlighted: ':lighten<3<@fg',
< 		fgOnAccent: '#fff',
< 		divider: 'rgba(255, 255, 255, 0.1)',
< 		indicator: '@accent',
< 		panel: ':lighten<3<@bg',
< 		panelHighlight: ':lighten<3<@panel',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		panelHeaderDivider: 'rgba(0, 0, 0, 0)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		windowHeader: ':alpha<0.85<@panel',
< 		popup: ':lighten<3<@panel',
< 		shadow: 'rgba(0, 0, 0, 0.3)',
< 		header: ':alpha<0.7<@panel',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		navHoverFg: ':lighten<17<@fg',
< 		navActive: '@accent',
< 		navIndicator: '@indicator',
< 		link: '#44a4c1',
< 		hashtag: '#ff9156',
< 		mention: '@accent',
< 		mentionMe: '@mention',
< 		renote: '#229e82',
< 		modalBg: 'rgba(0, 0, 0, 0.5)',
< 		scrollbarHandle: 'rgba(255, 255, 255, 0.2)',
< 		scrollbarHandleHover: 'rgba(255, 255, 255, 0.4)',
< 		dateLabelFg: '@fg',
< 		infoBg: '#253142',
< 		infoFg: '#fff',
< 		infoWarnBg: '#42321c',
< 		infoWarnFg: '#ffbd3e',
< 		switchBg: 'rgba(255, 255, 255, 0.15)',
< 		cwBg: '#687390',
< 		cwFg: '#393f4f',
< 		cwHoverBg: '#707b97',
< 		buttonBg: 'rgba(255, 255, 255, 0.05)',
< 		buttonHoverBg: 'rgba(255, 255, 255, 0.1)',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':hue<20<@accent',
< 		switchOffBg: 'rgba(255, 255, 255, 0.1)',
< 		switchOffFg: ':alpha<0.8<@fg',
< 		switchOnBg: '@accentedBg',
< 		switchOnFg: '@accent',
< 		inputBorder: 'rgba(255, 255, 255, 0.1)',
< 		inputBorderHover: 'rgba(255, 255, 255, 0.2)',
< 		listItemHoverBg: 'rgba(255, 255, 255, 0.03)',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		wallpaperOverlay: 'rgba(0, 0, 0, 0.5)',
< 		badge: '#31b1ce',
< 		messageBg: '@bg',
< 		success: '#86b300',
< 		error: '#ec4137',
< 		warn: '#ecb637',
< 		codeString: '#ffb675',
< 		codeNumber: '#cfff9e',
< 		codeBoolean: '#c59eff',
< 		deckDivider: '#000',
< 		htmlThemeColor: '@bg',
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(255, 255, 255, 0.05)',
< 		X4: 'rgba(255, 255, 255, 0.1)',
< 		X5: 'rgba(255, 255, 255, 0.05)',
< 		X6: 'rgba(255, 255, 255, 0.15)',
< 		X7: 'rgba(255, 255, 255, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.3)',
< 		X12: 'rgba(255, 255, 255, 0.1)',
< 		X13: 'rgba(255, 255, 255, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 		X17: ':alpha<0.8<@bg',
< 	},
---
>   props: {
>     accent: "#86b300",
>     accentDarken: ":darken<10<@accent",
>     accentLighten: ":lighten<10<@accent",
>     accentedBg: ":alpha<0.15<@accent",
>     focus: ":alpha<0.3<@accent",
>     bg: "#000",
>     acrylicBg: ":alpha<0.5<@bg",
>     fg: "#dadada",
>     fgTransparentWeak: ":alpha<0.75<@fg",
>     fgTransparent: ":alpha<0.5<@fg",
>     fgHighlighted: ":lighten<3<@fg",
>     fgOnAccent: "#fff",
>     divider: "rgba(255, 255, 255, 0.1)",
>     indicator: "@accent",
>     panel: ":lighten<3<@bg",
>     panelHighlight: ":lighten<3<@panel",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     panelHeaderDivider: "rgba(0, 0, 0, 0)",
>     panelBorder: '" solid 1px var(--divider)',
>     acrylicPanel: ":alpha<0.5<@panel",
>     windowHeader: ":alpha<0.85<@panel",
>     popup: ":lighten<3<@panel",
>     shadow: "rgba(0, 0, 0, 0.3)",
>     header: ":alpha<0.7<@panel",
>     navBg: "@panel",
>     navFg: "@fg",
>     navHoverFg: ":lighten<17<@fg",
>     navActive: "@accent",
>     navIndicator: "@indicator",
>     link: "#44a4c1",
>     hashtag: "#ff9156",
>     mention: "@accent",
>     mentionMe: "@mention",
>     renote: "#229e82",
>     modalBg: "rgba(0, 0, 0, 0.5)",
>     scrollbarHandle: "rgba(255, 255, 255, 0.2)",
>     scrollbarHandleHover: "rgba(255, 255, 255, 0.4)",
>     dateLabelFg: "@fg",
>     infoBg: "#253142",
>     infoFg: "#fff",
>     infoWarnBg: "#42321c",
>     infoWarnFg: "#ffbd3e",
>     switchBg: "rgba(255, 255, 255, 0.15)",
>     cwBg: "#687390",
>     cwFg: "#393f4f",
>     cwHoverBg: "#707b97",
>     buttonBg: "rgba(255, 255, 255, 0.05)",
>     buttonHoverBg: "rgba(255, 255, 255, 0.1)",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":hue<20<@accent",
>     swutchOffBg: "rgba(255, 255, 255, 0.1)",
>     swutchOffFg: "@fg",
>     swutchOnBg: "@accentedBg",
>     swutchOnFg: "@accent",
>     inputBorder: "rgba(255, 255, 255, 0.1)",
>     inputBorderHover: "rgba(255, 255, 255, 0.2)",
>     listItemHoverBg: "rgba(255, 255, 255, 0.03)",
>     driveFolderBg: ":alpha<0.3<@accent",
>     wallpaperOverlay: "rgba(0, 0, 0, 0.5)",
>     badge: "#31b1ce",
>     messageBg: "@bg",
>     success: "#86b300",
>     error: "#ec4137",
>     warn: "#ecb637",
>     codeString: "#ffb675",
>     codeNumber: "#cfff9e",
>     codeBoolean: "#c59eff",
>     deckDivider: "#000",
>     htmlThemeColor: "@bg",
>     X2: ":darken<2<@panel",
>     X3: "rgba(255, 255, 255, 0.05)",
>     X4: "rgba(255, 255, 255, 0.1)",
>     X5: "rgba(255, 255, 255, 0.05)",
>     X6: "rgba(255, 255, 255, 0.15)",
>     X7: "rgba(255, 255, 255, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.3)",
>     X12: "rgba(255, 255, 255, 0.1)",
>     X13: "rgba(255, 255, 255, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>     X17: ":alpha<0.8<@bg",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/_light.json5 RiricaV13/themes/_light.json5
4c4
< 	id: 'light',
---
>   id: "light",
6,9c6,9
< 	name: 'Light',
< 	author: 'syuilo',
< 	desc: 'Default light theme',
< 	kind: 'light',
---
>   name: "Light",
>   author: "syuilo",
>   desc: "Default light theme",
>   kind: "light",
11,98c11,98
< 	props: {
< 		accent: '#86b300',
< 		accentDarken: ':darken<10<@accent',
< 		accentLighten: ':lighten<10<@accent',
< 		accentedBg: ':alpha<0.15<@accent',
< 		focus: ':alpha<0.3<@accent',
< 		bg: '#fff',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		fg: '#5f5f5f',
< 		fgTransparentWeak: ':alpha<0.75<@fg',
< 		fgTransparent: ':alpha<0.5<@fg',
< 		fgHighlighted: ':darken<3<@fg',
< 		fgOnAccent: '#fff',
< 		divider: 'rgba(0, 0, 0, 0.1)',
< 		indicator: '@accent',
< 		panel: ':lighten<3<@bg',
< 		panelHighlight: ':darken<3<@panel',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		panelHeaderDivider: 'rgba(0, 0, 0, 0)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		windowHeader: ':alpha<0.85<@panel',
< 		popup: ':lighten<3<@panel',
< 		shadow: 'rgba(0, 0, 0, 0.1)',
< 		header: ':alpha<0.7<@panel',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		navHoverFg: ':darken<17<@fg',
< 		navActive: '@accent',
< 		navIndicator: '@indicator',
< 		link: '#44a4c1',
< 		hashtag: '#ff9156',
< 		mention: '@accent',
< 		mentionMe: '@mention',
< 		renote: '#229e82',
< 		modalBg: 'rgba(0, 0, 0, 0.3)',
< 		scrollbarHandle: 'rgba(0, 0, 0, 0.2)',
< 		scrollbarHandleHover: 'rgba(0, 0, 0, 0.4)',
< 		dateLabelFg: '@fg',
< 		infoBg: '#e5f5ff',
< 		infoFg: '#72818a',
< 		infoWarnBg: '#fff0db',
< 		infoWarnFg: '#8f6e31',
< 		switchBg: 'rgba(0, 0, 0, 0.15)',
< 		cwBg: '#b1b9c1',
< 		cwFg: '#fff',
< 		cwHoverBg: '#bbc4ce',
< 		buttonBg: 'rgba(0, 0, 0, 0.05)',
< 		buttonHoverBg: 'rgba(0, 0, 0, 0.1)',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':hue<20<@accent',
< 		switchOffBg: 'rgba(0, 0, 0, 0.1)',
< 		switchOffFg: '@panel',
< 		switchOnBg: '@accent',
< 		switchOnFg: '@fgOnAccent',
< 		inputBorder: 'rgba(0, 0, 0, 0.1)',
< 		inputBorderHover: 'rgba(0, 0, 0, 0.2)',
< 		listItemHoverBg: 'rgba(0, 0, 0, 0.03)',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		wallpaperOverlay: 'rgba(255, 255, 255, 0.5)',
< 		badge: '#31b1ce',
< 		messageBg: '@bg',
< 		success: '#86b300',
< 		error: '#ec4137',
< 		warn: '#ecb637',
< 		codeString: '#b98710',
< 		codeNumber: '#0fbbbb',
< 		codeBoolean: '#62b70c',
< 		deckDivider: ':darken<3<@bg',
< 		htmlThemeColor: '@bg',
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(0, 0, 0, 0.05)',
< 		X4: 'rgba(0, 0, 0, 0.1)',
< 		X5: 'rgba(0, 0, 0, 0.05)',
< 		X6: 'rgba(0, 0, 0, 0.25)',
< 		X7: 'rgba(0, 0, 0, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.1)',
< 		X12: 'rgba(0, 0, 0, 0.1)',
< 		X13: 'rgba(0, 0, 0, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 		X17: ':alpha<0.8<@bg',
< 	},
---
>   props: {
>     accent: "#86b300",
>     accentDarken: ":darken<10<@accent",
>     accentLighten: ":lighten<10<@accent",
>     accentedBg: ":alpha<0.15<@accent",
>     focus: ":alpha<0.3<@accent",
>     bg: "#fff",
>     acrylicBg: ":alpha<0.5<@bg",
>     fg: "#5f5f5f",
>     fgTransparentWeak: ":alpha<0.75<@fg",
>     fgTransparent: ":alpha<0.5<@fg",
>     fgHighlighted: ":darken<3<@fg",
>     fgOnAccent: "#fff",
>     divider: "rgba(0, 0, 0, 0.1)",
>     indicator: "@accent",
>     panel: ":lighten<3<@bg",
>     panelHighlight: ":darken<3<@panel",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     panelHeaderDivider: "rgba(0, 0, 0, 0)",
>     panelBorder: '" solid 1px var(--divider)',
>     acrylicPanel: ":alpha<0.5<@panel",
>     windowHeader: ":alpha<0.85<@panel",
>     popup: ":lighten<3<@panel",
>     shadow: "rgba(0, 0, 0, 0.1)",
>     header: ":alpha<0.7<@panel",
>     navBg: "@panel",
>     navFg: "@fg",
>     navHoverFg: ":darken<17<@fg",
>     navActive: "@accent",
>     navIndicator: "@indicator",
>     link: "#44a4c1",
>     hashtag: "#ff9156",
>     mention: "@accent",
>     mentionMe: "@mention",
>     renote: "#229e82",
>     modalBg: "rgba(0, 0, 0, 0.3)",
>     scrollbarHandle: "rgba(0, 0, 0, 0.2)",
>     scrollbarHandleHover: "rgba(0, 0, 0, 0.4)",
>     dateLabelFg: "@fg",
>     infoBg: "#e5f5ff",
>     infoFg: "#72818a",
>     infoWarnBg: "#fff0db",
>     infoWarnFg: "#8f6e31",
>     switchBg: "rgba(0, 0, 0, 0.15)",
>     cwBg: "#b1b9c1",
>     cwFg: "#fff",
>     cwHoverBg: "#bbc4ce",
>     buttonBg: "rgba(0, 0, 0, 0.05)",
>     buttonHoverBg: "rgba(0, 0, 0, 0.1)",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":hue<20<@accent",
>     swutchOffBg: "rgba(0, 0, 0, 0.1)",
>     swutchOffFg: "@panel",
>     swutchOnBg: "@accent",
>     swutchOnFg: "@fgOnAccent",
>     inputBorder: "rgba(0, 0, 0, 0.1)",
>     inputBorderHover: "rgba(0, 0, 0, 0.2)",
>     listItemHoverBg: "rgba(0, 0, 0, 0.03)",
>     driveFolderBg: ":alpha<0.3<@accent",
>     wallpaperOverlay: "rgba(255, 255, 255, 0.5)",
>     badge: "#31b1ce",
>     messageBg: "@bg",
>     success: "#86b300",
>     error: "#ec4137",
>     warn: "#ecb637",
>     codeString: "#b98710",
>     codeNumber: "#0fbbbb",
>     codeBoolean: "#62b70c",
>     deckDivider: ":darken<3<@bg",
>     htmlThemeColor: "@bg",
>     X2: ":darken<2<@panel",
>     X3: "rgba(0, 0, 0, 0.05)",
>     X4: "rgba(0, 0, 0, 0.1)",
>     X5: "rgba(0, 0, 0, 0.05)",
>     X6: "rgba(0, 0, 0, 0.25)",
>     X7: "rgba(0, 0, 0, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.1)",
>     X12: "rgba(0, 0, 0, 0.1)",
>     X13: "rgba(0, 0, 0, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>     X17: ":alpha<0.8<@bg",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-astro.json5 RiricaV13/themes/d-astro.json5
2,77c2,77
< 	id: '080a01c5-377d-4fbb-88cc-6bb5d04977ea',
< 	base: 'dark',
< 	name: 'Mi Astro Dark',
< 	author: 'syuilo',
< 	props: {
< 		bg: '#232125',
< 		fg: '#efdab9',
< 		cwBg: '#687390',
< 		cwFg: '#393f4f',
< 		link: '#78b0a0',
< 		warn: '#ecb637',
< 		badge: '#31b1ce',
< 		error: '#ec4137',
< 		focus: ':alpha<0.3<@accent',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		panel: '#2a272b',
< 		accent: '#81c08b',
< 		header: ':alpha<0.7<@bg',
< 		infoBg: '#253142',
< 		infoFg: '#fff',
< 		renote: '#659CC8',
< 		shadow: 'rgba(0, 0, 0, 0.3)',
< 		divider: 'rgba(255, 255, 255, 0.1)',
< 		hashtag: '#ff9156',
< 		mention: '#ffd152',
< 		modalBg: 'rgba(0, 0, 0, 0.5)',
< 		success: '#86b300',
< 		buttonBg: 'rgba(255, 255, 255, 0.05)',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		cwHoverBg: '#707b97',
< 		indicator: '@accent',
< 		mentionMe: '#fb5d38',
< 		messageBg: '@bg',
< 		navActive: '@accent',
< 		infoWarnBg: '#42321c',
< 		infoWarnFg: '#ffbd3e',
< 		navHoverFg: ':lighten<17<@fg',
< 		dateLabelFg: '@fg',
< 		inputBorder: 'rgba(255, 255, 255, 0.1)',
< 		inputBorderHover: 'rgba(255, 255, 255, 0.2)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		accentDarken: ':darken<10<@accent',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		navIndicator: '@accent',
< 		accentLighten: ':lighten<10<@accent',
< 		buttonHoverBg: 'rgba(255, 255, 255, 0.1)',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':hue<-20<@accent',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		fgHighlighted: ':lighten<3<@fg',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		htmlThemeColor: '@bg',
< 		panelHighlight: ':lighten<3<@panel',
< 		listItemHoverBg: 'rgba(255, 255, 255, 0.03)',
< 		scrollbarHandle: 'rgba(255, 255, 255, 0.2)',
< 		wallpaperOverlay: 'rgba(0, 0, 0, 0.5)',
< 		panelHeaderDivider: 'rgba(0, 0, 0, 0)',
< 		scrollbarHandleHover: 'rgba(255, 255, 255, 0.4)',
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(255, 255, 255, 0.05)',
< 		X4: 'rgba(255, 255, 255, 0.1)',
< 		X5: 'rgba(255, 255, 255, 0.05)',
< 		X6: 'rgba(255, 255, 255, 0.15)',
< 		X7: 'rgba(255, 255, 255, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.3)',
< 		X12: 'rgba(255, 255, 255, 0.1)',
< 		X13: 'rgba(255, 255, 255, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 	},
---
>   id: "080a01c5-377d-4fbb-88cc-6bb5d04977ea",
>   base: "dark",
>   name: "Mi Astro Dark",
>   author: "syuilo",
>   props: {
>     bg: "#232125",
>     fg: "#efdab9",
>     cwBg: "#687390",
>     cwFg: "#393f4f",
>     link: "#78b0a0",
>     warn: "#ecb637",
>     badge: "#31b1ce",
>     error: "#ec4137",
>     focus: ":alpha<0.3<@accent",
>     navBg: "@panel",
>     navFg: "@fg",
>     panel: "#2a272b",
>     accent: "#81c08b",
>     header: ":alpha<0.7<@bg",
>     infoBg: "#253142",
>     infoFg: "#fff",
>     renote: "#659CC8",
>     shadow: "rgba(0, 0, 0, 0.3)",
>     divider: "rgba(255, 255, 255, 0.1)",
>     hashtag: "#ff9156",
>     mention: "#ffd152",
>     modalBg: "rgba(0, 0, 0, 0.5)",
>     success: "#86b300",
>     buttonBg: "rgba(255, 255, 255, 0.05)",
>     acrylicBg: ":alpha<0.5<@bg",
>     cwHoverBg: "#707b97",
>     indicator: "@accent",
>     mentionMe: "#fb5d38",
>     messageBg: "@bg",
>     navActive: "@accent",
>     infoWarnBg: "#42321c",
>     infoWarnFg: "#ffbd3e",
>     navHoverFg: ":lighten<17<@fg",
>     dateLabelFg: "@fg",
>     inputBorder: "rgba(255, 255, 255, 0.1)",
>     inputBorderHover: "rgba(255, 255, 255, 0.2)",
>     panelBorder: '" solid 1px var(--divider)',
>     accentDarken: ":darken<10<@accent",
>     acrylicPanel: ":alpha<0.5<@panel",
>     navIndicator: "@accent",
>     accentLighten: ":lighten<10<@accent",
>     buttonHoverBg: "rgba(255, 255, 255, 0.1)",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":hue<-20<@accent",
>     driveFolderBg: ":alpha<0.3<@accent",
>     fgHighlighted: ":lighten<3<@fg",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     htmlThemeColor: "@bg",
>     panelHighlight: ":lighten<3<@panel",
>     listItemHoverBg: "rgba(255, 255, 255, 0.03)",
>     scrollbarHandle: "rgba(255, 255, 255, 0.2)",
>     wallpaperOverlay: "rgba(0, 0, 0, 0.5)",
>     panelHeaderDivider: "rgba(0, 0, 0, 0)",
>     scrollbarHandleHover: "rgba(255, 255, 255, 0.4)",
>     X2: ":darken<2<@panel",
>     X3: "rgba(255, 255, 255, 0.05)",
>     X4: "rgba(255, 255, 255, 0.1)",
>     X5: "rgba(255, 255, 255, 0.05)",
>     X6: "rgba(255, 255, 255, 0.15)",
>     X7: "rgba(255, 255, 255, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.3)",
>     X12: "rgba(255, 255, 255, 0.1)",
>     X13: "rgba(255, 255, 255, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-botanical.json5 RiricaV13/themes/d-botanical.json5
2c2
< 	id: '504debaf-4912-6a4c-5059-1db08a76b737',
---
>   id: "504debaf-4912-6a4c-5059-1db08a76b737",
4,5c4,5
< 	name: 'Mi Botanical Dark',
< 	author: 'syuilo',
---
>   name: "Mi Botanical Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,25c9,25
< 	props: {
< 		accent: 'rgb(148, 179, 0)',
< 		bg: 'rgb(37, 38, 36)',
< 		fg: 'rgb(216, 212, 199)',
< 		fgHighlighted: '#fff',
< 		divider: 'rgba(255, 255, 255, 0.14)',
< 		panel: 'rgb(47, 47, 44)',
< 		panelHeaderBg: '@panel',
< 		panelHeaderDivider: '@divider',
< 		header: ':alpha<0.7<@panel',
< 		navBg: '#363636',
< 		renote: '@accent',
< 		mention: 'rgb(212, 153, 76)',
< 		mentionMe: 'rgb(212, 210, 76)',
< 		hashtag: '#5bcbb0',
< 		link: '@accent',
< 	},
---
>   props: {
>     accent: "rgb(148, 179, 0)",
>     bg: "rgb(37, 38, 36)",
>     fg: "rgb(216, 212, 199)",
>     fgHighlighted: "#fff",
>     divider: "rgba(255, 255, 255, 0.14)",
>     panel: "rgb(47, 47, 44)",
>     panelHeaderBg: "@panel",
>     panelHeaderDivider: "@divider",
>     header: ":alpha<0.7<@panel",
>     navBg: "#363636",
>     renote: "@accent",
>     mention: "rgb(212, 153, 76)",
>     mentionMe: "rgb(212, 210, 76)",
>     hashtag: "#5bcbb0",
>     link: "@accent",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-cherry.json5 RiricaV13/themes/d-cherry.json5
2c2
< 	id: '679b3b87-a4e9-4789-8696-b56c15cc33b0',
---
>   id: "679b3b87-a4e9-4789-8696-b56c15cc33b0",
4,5c4,5
< 	name: 'Mi Cherry Dark',
< 	author: 'syuilo',
---
>   name: "Mi Cherry Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,19c9,19
< 	props: {
< 		accent: 'rgb(255, 89, 117)',
< 		bg: 'rgb(28, 28, 37)',
< 		fg: 'rgb(236, 239, 244)',
< 		panel: 'rgb(35, 35, 47)',
< 		renote: '@accent',
< 		link: '@accent',
< 		mention: '@accent',
< 		hashtag: '@accent',
< 		divider: 'rgb(63, 63, 80)',
< 	},
---
>   props: {
>     accent: "rgb(255, 89, 117)",
>     bg: "rgb(28, 28, 37)",
>     fg: "rgb(236, 239, 244)",
>     panel: "rgb(35, 35, 47)",
>     renote: "@accent",
>     link: "@accent",
>     mention: "@accent",
>     hashtag: "@accent",
>     divider: "rgb(63, 63, 80)",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-dark.json5 RiricaV13/themes/d-dark.json5
2c2
< 	id: '8050783a-7f63-445a-b270-36d0f6ba1677',
---
>   id: "8050783a-7f63-445a-b270-36d0f6ba1677",
4,6c4,6
< 	name: 'Mi Dark',
< 	author: 'syuilo',
< 	desc: 'Default light theme',
---
>   name: "Mi Dark",
>   author: "syuilo",
>   desc: "Default light theme",
8c8
< 	base: 'dark',
---
>   base: "dark",
10,25c10,25
< 	props: {
< 		bg: '#232323',
< 		fg: 'rgb(199, 209, 216)',
< 		fgHighlighted: '#fff',
< 		divider: 'rgba(255, 255, 255, 0.14)',
< 		panel: '#2d2d2d',
< 		panelHeaderBg: '@panel',
< 		panelHeaderDivider: '@divider',
< 		header: ':alpha<0.7<@panel',
< 		navBg: '#363636',
< 		renote: '@accent',
< 		mention: '#da6d35',
< 		mentionMe: '#d44c4c',
< 		hashtag: '#4cb8d4',
< 		link: '@accent',
< 	},
---
>   props: {
>     bg: "#232323",
>     fg: "rgb(199, 209, 216)",
>     fgHighlighted: "#fff",
>     divider: "rgba(255, 255, 255, 0.14)",
>     panel: "#2d2d2d",
>     panelHeaderBg: "@panel",
>     panelHeaderDivider: "@divider",
>     header: ":alpha<0.7<@panel",
>     navBg: "#363636",
>     renote: "@accent",
>     mention: "#da6d35",
>     mentionMe: "#d44c4c",
>     hashtag: "#4cb8d4",
>     link: "@accent",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-future.json5 RiricaV13/themes/d-future.json5
2c2
< 	id: '32a637ef-b47a-4775-bb7b-bacbb823f865',
---
>   id: "32a637ef-b47a-4775-bb7b-bacbb823f865",
4,5c4,5
< 	name: 'Mi Future Dark',
< 	author: 'syuilo',
---
>   name: "Mi Future Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,26c9,26
< 	props: {
< 		accent: '#63e2b7',
< 		bg: '#101014',
< 		fg: '#D5D5D6',
< 		fgHighlighted: '#fff',
< 		fgOnAccent: '#000',
< 		divider: 'rgba(255, 255, 255, 0.1)',
< 		panel: '#18181c',
< 		panelHeaderBg: '@panel',
< 		panelHeaderDivider: '@divider',
< 		renote: '@accent',
< 		mention: '#f2c97d',
< 		mentionMe: '@accent',
< 		hashtag: '#70c0e8',
< 		link: '#e88080',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':saturate<30<:hue<30<@accent',
< 	},
---
>   props: {
>     accent: "#63e2b7",
>     bg: "#101014",
>     fg: "#D5D5D6",
>     fgHighlighted: "#fff",
>     fgOnAccent: "#000",
>     divider: "rgba(255, 255, 255, 0.1)",
>     panel: "#18181c",
>     panelHeaderBg: "@panel",
>     panelHeaderDivider: "@divider",
>     renote: "@accent",
>     mention: "#f2c97d",
>     mentionMe: "@accent",
>     hashtag: "#70c0e8",
>     link: "#e88080",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":saturate<30<:hue<30<@accent",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-green-lime.json5 RiricaV13/themes/d-green-lime.json5
2c2
< 	id: '02816013-8107-440f-877e-865083ffe194',
---
>   id: "02816013-8107-440f-877e-865083ffe194",
4,5c4,5
< 	name: 'Mi Green+Lime Dark',
< 	author: 'syuilo',
---
>   name: "Mi Green+Lime Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,23c9,23
< 	props: {
< 		accent: '#b4e900',
< 		bg: '#0C1210',
< 		fg: '#dee7e4',
< 		fgHighlighted: '#fff',
< 		fgOnAccent: '#192320',
< 		divider: '#e7fffb24',
< 		panel: '#192320',
< 		panelHeaderBg: '@panel',
< 		panelHeaderDivider: '@divider',
< 		popup: '#293330',
< 		renote: '@accent',
< 		mentionMe: '#ffaa00',
< 		link: '#24d7ce',
< 	},
---
>   props: {
>     accent: "#b4e900",
>     bg: "#0C1210",
>     fg: "#dee7e4",
>     fgHighlighted: "#fff",
>     fgOnAccent: "#192320",
>     divider: "#e7fffb24",
>     panel: "#192320",
>     panelHeaderBg: "@panel",
>     panelHeaderDivider: "@divider",
>     popup: "#293330",
>     renote: "@accent",
>     mentionMe: "#ffaa00",
>     link: "#24d7ce",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-green-orange.json5 RiricaV13/themes/d-green-orange.json5
2c2
< 	id: 'dc489603-27b5-424a-9b25-1ff6aec9824a',
---
>   id: "dc489603-27b5-424a-9b25-1ff6aec9824a",
4,5c4,5
< 	name: 'Mi Green+Orange Dark',
< 	author: 'syuilo',
---
>   name: "Mi Green+Orange Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,23c9,23
< 	props: {
< 		accent: '#e97f00',
< 		bg: '#0C1210',
< 		fg: '#dee7e4',
< 		fgHighlighted: '#fff',
< 		fgOnAccent: '#192320',
< 		divider: '#e7fffb24',
< 		panel: '#192320',
< 		panelHeaderBg: '@panel',
< 		panelHeaderDivider: '@divider',
< 		popup: '#293330',
< 		renote: '@accent',
< 		mentionMe: '#b4e900',
< 		link: '#24d7ce',
< 	},
---
>   props: {
>     accent: "#e97f00",
>     bg: "#0C1210",
>     fg: "#dee7e4",
>     fgHighlighted: "#fff",
>     fgOnAccent: "#192320",
>     divider: "#e7fffb24",
>     panel: "#192320",
>     panelHeaderBg: "@panel",
>     panelHeaderDivider: "@divider",
>     popup: "#293330",
>     renote: "@accent",
>     mentionMe: "#b4e900",
>     link: "#24d7ce",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-ice.json5 RiricaV13/themes/d-ice.json5
2c2
< 	id: '66e7e5a9-cd43-42cd-837d-12f47841fa34',
---
>   id: "66e7e5a9-cd43-42cd-837d-12f47841fa34",
4,5c4,5
< 	name: 'Mi Ice Dark',
< 	author: 'syuilo',
---
>   name: "Mi Ice Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,12c9,12
< 	props: {
< 		accent: '#47BFE8',
< 		bg: '#212526',
< 	},
---
>   props: {
>     accent: "#47BFE8",
>     bg: "#212526",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-persimmon.json5 RiricaV13/themes/d-persimmon.json5
2c2
< 	id: 'c503d768-7c70-4db2-a4e6-08264304bc8d',
---
>   id: "c503d768-7c70-4db2-a4e6-08264304bc8d",
4,5c4,5
< 	name: 'Mi Persimmon Dark',
< 	author: 'syuilo',
---
>   name: "Mi Persimmon Dark",
>   author: "syuilo",
7c7
< 	base: 'dark',
---
>   base: "dark",
9,24c9,24
< 	props: {
< 		accent: 'rgb(206, 102, 65)',
< 		bg: 'rgb(31, 33, 31)',
< 		fg: '#cdd8c7',
< 		fgHighlighted: '#fff',
< 		divider: 'rgba(255, 255, 255, 0.14)',
< 		panel: 'rgb(41, 43, 41)',
< 		infoFg: '@fg',
< 		infoBg: '#333c3b',
< 		navBg: '#141714',
< 		renote: '@accent',
< 		mention: '@accent',
< 		mentionMe: '#de6161',
< 		hashtag: '#68bad0',
< 		link: '#a1c758',
< 	},
---
>   props: {
>     accent: "rgb(206, 102, 65)",
>     bg: "rgb(31, 33, 31)",
>     fg: "#cdd8c7",
>     fgHighlighted: "#fff",
>     divider: "rgba(255, 255, 255, 0.14)",
>     panel: "rgb(41, 43, 41)",
>     infoFg: "@fg",
>     infoBg: "#333c3b",
>     navBg: "#141714",
>     renote: "@accent",
>     mention: "@accent",
>     mentionMe: "#de6161",
>     hashtag: "#68bad0",
>     link: "#a1c758",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/d-u0.json5 RiricaV13/themes/d-u0.json5
2,87c2,87
< 	id: '7a5bc13b-df8f-4d44-8e94-4452f0c634bb',
< 	base: 'dark',
< 	name: 'Mi U0 Dark',
< 	props: {
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(255, 255, 255, 0.05)',
< 		X4: 'rgba(255, 255, 255, 0.1)',
< 		X5: 'rgba(255, 255, 255, 0.05)',
< 		X6: 'rgba(255, 255, 255, 0.15)',
< 		X7: 'rgba(255, 255, 255, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		bg: '#172426',
< 		fg: '#dadada',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.3)',
< 		X12: 'rgba(255, 255, 255, 0.1)',
< 		X13: 'rgba(255, 255, 255, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 		X17: ':alpha<0.8<@bg',
< 		cwBg: '#687390',
< 		cwFg: '#393f4f',
< 		link: '@accent',
< 		warn: '#ecb637',
< 		badge: '#31b1ce',
< 		error: '#ec4137',
< 		focus: ':alpha<0.3<@accent',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		panel: ':lighten<3<@bg',
< 		popup: ':lighten<3<@panel',
< 		accent: '#00a497',
< 		header: ':alpha<0.7<@panel',
< 		infoBg: '#253142',
< 		infoFg: '#fff',
< 		renote: '@accent',
< 		shadow: 'rgba(0, 0, 0, 0.3)',
< 		divider: 'rgba(255, 255, 255, 0.1)',
< 		hashtag: '#e6b422',
< 		mention: '@accent',
< 		modalBg: 'rgba(0, 0, 0, 0.5)',
< 		success: '#86b300',
< 		buttonBg: 'rgba(255, 255, 255, 0.05)',
< 		switchBg: 'rgba(255, 255, 255, 0.15)',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		cwHoverBg: '#707b97',
< 		indicator: '@accent',
< 		mentionMe: '@mention',
< 		messageBg: '@bg',
< 		navActive: '@accent',
< 		accentedBg: ':alpha<0.15<@accent',
< 		codeNumber: '#cfff9e',
< 		codeString: '#ffb675',
< 		fgOnAccent: '#fff',
< 		infoWarnBg: '#42321c',
< 		infoWarnFg: '#ffbd3e',
< 		navHoverFg: ':lighten<17<@fg',
< 		codeBoolean: '#c59eff',
< 		dateLabelFg: '@fg',
< 		inputBorder: 'rgba(255, 255, 255, 0.1)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		accentDarken: ':darken<10<@accent',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		navIndicator: '@indicator',
< 		accentLighten: ':lighten<10<@accent',
< 		buttonHoverBg: 'rgba(255, 255, 255, 0.1)',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		fgHighlighted: ':lighten<3<@fg',
< 		fgTransparent: ':alpha<0.5<@fg',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':hue<20<@accent',
< 		htmlThemeColor: '@bg',
< 		panelHighlight: ':lighten<3<@panel',
< 		listItemHoverBg: 'rgba(255, 255, 255, 0.03)',
< 		scrollbarHandle: 'rgba(255, 255, 255, 0.2)',
< 		inputBorderHover: 'rgba(255, 255, 255, 0.2)',
< 		wallpaperOverlay: 'rgba(0, 0, 0, 0.5)',
< 		fgTransparentWeak: ':alpha<0.75<@fg',
< 		panelHeaderDivider: 'rgba(0, 0, 0, 0)',
< 		scrollbarHandleHover: 'rgba(255, 255, 255, 0.4)',
< 		deckDivider: '#142022',
< 	},
---
>   id: "7a5bc13b-df8f-4d44-8e94-4452f0c634bb",
>   base: "dark",
>   name: "Mi U0 Dark",
>   props: {
>     X2: ":darken<2<@panel",
>     X3: "rgba(255, 255, 255, 0.05)",
>     X4: "rgba(255, 255, 255, 0.1)",
>     X5: "rgba(255, 255, 255, 0.05)",
>     X6: "rgba(255, 255, 255, 0.15)",
>     X7: "rgba(255, 255, 255, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     bg: "#172426",
>     fg: "#dadada",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.3)",
>     X12: "rgba(255, 255, 255, 0.1)",
>     X13: "rgba(255, 255, 255, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>     X17: ":alpha<0.8<@bg",
>     cwBg: "#687390",
>     cwFg: "#393f4f",
>     link: "@accent",
>     warn: "#ecb637",
>     badge: "#31b1ce",
>     error: "#ec4137",
>     focus: ":alpha<0.3<@accent",
>     navBg: "@panel",
>     navFg: "@fg",
>     panel: ":lighten<3<@bg",
>     popup: ":lighten<3<@panel",
>     accent: "#00a497",
>     header: ":alpha<0.7<@panel",
>     infoBg: "#253142",
>     infoFg: "#fff",
>     renote: "@accent",
>     shadow: "rgba(0, 0, 0, 0.3)",
>     divider: "rgba(255, 255, 255, 0.1)",
>     hashtag: "#e6b422",
>     mention: "@accent",
>     modalBg: "rgba(0, 0, 0, 0.5)",
>     success: "#86b300",
>     buttonBg: "rgba(255, 255, 255, 0.05)",
>     switchBg: "rgba(255, 255, 255, 0.15)",
>     acrylicBg: ":alpha<0.5<@bg",
>     cwHoverBg: "#707b97",
>     indicator: "@accent",
>     mentionMe: "@mention",
>     messageBg: "@bg",
>     navActive: "@accent",
>     accentedBg: ":alpha<0.15<@accent",
>     codeNumber: "#cfff9e",
>     codeString: "#ffb675",
>     fgOnAccent: "#fff",
>     infoWarnBg: "#42321c",
>     infoWarnFg: "#ffbd3e",
>     navHoverFg: ":lighten<17<@fg",
>     codeBoolean: "#c59eff",
>     dateLabelFg: "@fg",
>     inputBorder: "rgba(255, 255, 255, 0.1)",
>     panelBorder: '" solid 1px var(--divider)',
>     accentDarken: ":darken<10<@accent",
>     acrylicPanel: ":alpha<0.5<@panel",
>     navIndicator: "@indicator",
>     accentLighten: ":lighten<10<@accent",
>     buttonHoverBg: "rgba(255, 255, 255, 0.1)",
>     driveFolderBg: ":alpha<0.3<@accent",
>     fgHighlighted: ":lighten<3<@fg",
>     fgTransparent: ":alpha<0.5<@fg",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":hue<20<@accent",
>     htmlThemeColor: "@bg",
>     panelHighlight: ":lighten<3<@panel",
>     listItemHoverBg: "rgba(255, 255, 255, 0.03)",
>     scrollbarHandle: "rgba(255, 255, 255, 0.2)",
>     inputBorderHover: "rgba(255, 255, 255, 0.2)",
>     wallpaperOverlay: "rgba(0, 0, 0, 0.5)",
>     fgTransparentWeak: ":alpha<0.75<@fg",
>     panelHeaderDivider: "rgba(0, 0, 0, 0)",
>     scrollbarHandleHover: "rgba(255, 255, 255, 0.4)",
>     deckDivider: "#142022",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-apricot.json5 RiricaV13/themes/l-apricot.json5
2c2
< 	id: '0ff48d43-aab3-46e7-ab12-8492110d2e2b',
---
>   id: "0ff48d43-aab3-46e7-ab12-8492110d2e2b",
4,5c4,5
< 	name: 'Mi Apricot Light',
< 	author: 'syuilo',
---
>   name: "Mi Apricot Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,21c9,21
< 	props: {
< 		accent: 'rgb(234, 154, 82)',
< 		bg: '#e6e5e2',
< 		fg: 'rgb(149, 143, 139)',
< 		panel: '#EEECE8',
< 		renote: '@accent',
< 		link: '@accent',
< 		mention: '@accent',
< 		hashtag: '@accent',
< 		inputBorder: 'rgba(0, 0, 0, 0.1)',
< 		inputBorderHover: 'rgba(0, 0, 0, 0.2)',
< 		infoBg: 'rgb(226, 235, 241)',
< 	},
---
>   props: {
>     accent: "rgb(234, 154, 82)",
>     bg: "#e6e5e2",
>     fg: "rgb(149, 143, 139)",
>     panel: "#EEECE8",
>     renote: "@accent",
>     link: "@accent",
>     mention: "@accent",
>     hashtag: "@accent",
>     inputBorder: "rgba(0, 0, 0, 0.1)",
>     inputBorderHover: "rgba(0, 0, 0, 0.2)",
>     infoBg: "rgb(226, 235, 241)",
>   },
Only in misskeyV13/packages/frontend/src/themes: l-botanical.json5
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-cherry.json5 RiricaV13/themes/l-cherry.json5
2c2
< 	id: 'ac168876-f737-4074-a3fc-a370c732ef48',
---
>   id: "ac168876-f737-4074-a3fc-a370c732ef48",
4,5c4,5
< 	name: 'Mi Cherry Light',
< 	author: 'syuilo',
---
>   name: "Mi Cherry Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,20c9,20
< 	props: {
< 		accent: 'rgb(219, 96, 114)',
< 		bg: 'rgb(254, 248, 249)',
< 		fg: 'rgb(152, 13, 26)',
< 		panel: 'rgb(255, 255, 255)',
< 		renote: '@accent',
< 		link: 'rgb(156, 187, 5)',
< 		mention: '@accent',
< 		hashtag: '@accent',
< 		divider: 'rgba(134, 51, 51, 0.1)',
< 		inputBorderHover: 'rgb(238, 221, 222)',
< 	},
---
>   props: {
>     accent: "rgb(219, 96, 114)",
>     bg: "rgb(254, 248, 249)",
>     fg: "rgb(152, 13, 26)",
>     panel: "rgb(255, 255, 255)",
>     renote: "@accent",
>     link: "rgb(156, 187, 5)",
>     mention: "@accent",
>     hashtag: "@accent",
>     divider: "rgba(134, 51, 51, 0.1)",
>     inputBorderHover: "rgb(238, 221, 222)",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-coffee.json5 RiricaV13/themes/l-coffee.json5
2c2
< 	id: '6ed80faa-74f0-42c2-98e4-a64d9e138eab',
---
>   id: "6ed80faa-74f0-42c2-98e4-a64d9e138eab",
4,5c4,5
< 	name: 'Mi Coffee Light',
< 	author: 'syuilo',
---
>   name: "Mi Coffee Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,20c9,20
< 	props: {
< 		accent: '#9f8989',
< 		bg: '#f5f3f3',
< 		fg: '#7f6666',
< 		panel: '#fff',
< 		divider: 'rgba(87, 68, 68, 0.1)',
< 		renote: 'rgb(160, 172, 125)',
< 		link: 'rgb(137, 151, 159)',
< 		mention: '@accent',
< 		mentionMe: 'rgb(170, 149, 98)',
< 		hashtag: '@accent',
< 	},
---
>   props: {
>     accent: "#9f8989",
>     bg: "#f5f3f3",
>     fg: "#7f6666",
>     panel: "#fff",
>     divider: "rgba(87, 68, 68, 0.1)",
>     renote: "rgb(160, 172, 125)",
>     link: "rgb(137, 151, 159)",
>     mention: "@accent",
>     mentionMe: "rgb(170, 149, 98)",
>     hashtag: "@accent",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-light.json5 RiricaV13/themes/l-light.json5
2c2
< 	id: '4eea646f-7afa-4645-83e9-83af0333cd37',
---
>   id: "4eea646f-7afa-4645-83e9-83af0333cd37",
4,6c4,6
< 	name: 'Mi Light',
< 	author: 'syuilo',
< 	desc: 'Default light theme',
---
>   name: "Mi Light",
>   author: "syuilo",
>   desc: "Default light theme",
8c8
< 	base: 'light',
---
>   base: "light",
10,19c10,19
< 	props: {
< 		bg: '#f9f9f9',
< 		fg: '#676767',
< 		divider: '#e8e8e8',
< 		header: ':alpha<0.7<@panel',
< 		navBg: '#fff',
< 		panel: '#fff',
< 		panelHeaderDivider: '@divider',
< 		mentionMe: 'rgb(0, 179, 70)',
< 	},
---
>   props: {
>     bg: "#f9f9f9",
>     fg: "#676767",
>     divider: "#e8e8e8",
>     header: ":alpha<0.7<@panel",
>     navBg: "#fff",
>     panel: "#fff",
>     panelHeaderDivider: "@divider",
>     mentionMe: "rgb(0, 179, 70)",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-rainy.json5 RiricaV13/themes/l-rainy.json5
2c2
< 	id: 'a58a0abb-ff8c-476a-8dec-0ad7837e7e96',
---
>   id: "a58a0abb-ff8c-476a-8dec-0ad7837e7e96",
4,5c4,5
< 	name: 'Mi Rainy Light',
< 	author: 'syuilo',
---
>   name: "Mi Rainy Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,20c9,20
< 	props: {
< 		accent: '#5db0da',
< 		bg: 'rgb(246 248 249)',
< 		fg: '#636b71',
< 		panel: '#fff',
< 		divider: 'rgb(230 233 234)',
< 		panelHeaderDivider: '@divider',
< 		renote: '@accent',
< 		link: '@accent',
< 		mention: '@accent',
< 		hashtag: '@accent',
< 	},
---
>   props: {
>     accent: "#5db0da",
>     bg: "rgb(246 248 249)",
>     fg: "#636b71",
>     panel: "#fff",
>     divider: "rgb(230 233 234)",
>     panelHeaderDivider: "@divider",
>     renote: "@accent",
>     link: "@accent",
>     mention: "@accent",
>     hashtag: "@accent",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-sushi.json5 RiricaV13/themes/l-sushi.json5
2c2
< 	id: '213273e5-7d20-d5f0-6e36-1b6a4f67115c',
---
>   id: "213273e5-7d20-d5f0-6e36-1b6a4f67115c",
4,5c4,5
< 	name: 'Mi Sushi Light',
< 	author: 'syuilo',
---
>   name: "Mi Sushi Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,17c9,17
< 	props: {
< 		accent: '#e36749',
< 		bg: '#f0eee9',
< 		fg: '#5f5f5f',
< 		renote: '@accent',
< 		link: '@accent',
< 		mention: '@accent',
< 		hashtag: '#229e82',
< 	},
---
>   props: {
>     accent: "#e36749",
>     bg: "#f0eee9",
>     fg: "#5f5f5f",
>     renote: "@accent",
>     link: "@accent",
>     mention: "@accent",
>     hashtag: "#229e82",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-u0.json5 RiricaV13/themes/l-u0.json5
2,86c2,86
< 	id: 'e2c940b5-6e9a-4c03-b738-261c720c426d',
< 	base: 'light',
< 	name: 'Mi U0 Light',
< 	props: {
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(255, 255, 255, 0.05)',
< 		X4: 'rgba(255, 255, 255, 0.1)',
< 		X5: 'rgba(255, 255, 255, 0.05)',
< 		X6: 'rgba(255, 255, 255, 0.15)',
< 		X7: 'rgba(255, 255, 255, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		bg: '#e7e7eb',
< 		fg: '#5f5f5f',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.3)',
< 		X12: 'rgba(255, 255, 255, 0.1)',
< 		X13: 'rgba(255, 255, 255, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 		X17: ':alpha<0.8<@bg',
< 		cwBg: '#687390',
< 		cwFg: '#393f4f',
< 		link: '@accent',
< 		warn: '#ecb637',
< 		badge: '#31b1ce',
< 		error: '#ec4137',
< 		focus: ':alpha<0.3<@accent',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		panel: ':lighten<3<@bg',
< 		popup: ':lighten<3<@panel',
< 		accent: '#478384',
< 		header: ':alpha<0.7<@panel',
< 		infoBg: '#253142',
< 		infoFg: '#fff',
< 		renote: '@accent',
< 		shadow: 'rgba(0, 0, 0, 0.3)',
< 		divider: '#4646461a',
< 		hashtag: '#1f3134',
< 		mention: '@accent',
< 		modalBg: 'rgba(0, 0, 0, 0.5)',
< 		success: '#86b300',
< 		buttonBg: '#0000000d',
< 		switchBg: 'rgba(255, 255, 255, 0.15)',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		cwHoverBg: '#707b97',
< 		indicator: '@accent',
< 		mentionMe: '@mention',
< 		messageBg: '@bg',
< 		navActive: '@accent',
< 		accentedBg: ':alpha<0.15<@accent',
< 		codeNumber: '#cfff9e',
< 		codeString: '#ffb675',
< 		fgOnAccent: '#fff',
< 		infoWarnBg: '#42321c',
< 		infoWarnFg: '#ffbd3e',
< 		navHoverFg: ':lighten<17<@fg',
< 		codeBoolean: '#c59eff',
< 		dateLabelFg: '@fg',
< 		inputBorder: 'rgba(255, 255, 255, 0.1)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		accentDarken: ':darken<10<@accent',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		navIndicator: '@indicator',
< 		accentLighten: ':lighten<10<@accent',
< 		buttonHoverBg: '#0000001a',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		fgHighlighted: ':lighten<3<@fg',
< 		fgTransparent: ':alpha<0.5<@fg',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		buttonGradateA: '@accent',
< 		buttonGradateB: ':hue<20<@accent',
< 		htmlThemeColor: '@bg',
< 		panelHighlight: ':lighten<3<@panel',
< 		listItemHoverBg: 'rgba(255, 255, 255, 0.03)',
< 		scrollbarHandle: '#74747433',
< 		inputBorderHover: 'rgba(255, 255, 255, 0.2)',
< 		wallpaperOverlay: 'rgba(0, 0, 0, 0.5)',
< 		fgTransparentWeak: ':alpha<0.75<@fg',
< 		panelHeaderDivider: 'rgba(0, 0, 0, 0)',
< 		scrollbarHandleHover: 'rgba(255, 255, 255, 0.4)',
< 	},
---
>   id: "e2c940b5-6e9a-4c03-b738-261c720c426d",
>   base: "light",
>   name: "Mi U0 Light",
>   props: {
>     X2: ":darken<2<@panel",
>     X3: "rgba(255, 255, 255, 0.05)",
>     X4: "rgba(255, 255, 255, 0.1)",
>     X5: "rgba(255, 255, 255, 0.05)",
>     X6: "rgba(255, 255, 255, 0.15)",
>     X7: "rgba(255, 255, 255, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     bg: "#e7e7eb",
>     fg: "#5f5f5f",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.3)",
>     X12: "rgba(255, 255, 255, 0.1)",
>     X13: "rgba(255, 255, 255, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>     X17: ":alpha<0.8<@bg",
>     cwBg: "#687390",
>     cwFg: "#393f4f",
>     link: "@accent",
>     warn: "#ecb637",
>     badge: "#31b1ce",
>     error: "#ec4137",
>     focus: ":alpha<0.3<@accent",
>     navBg: "@panel",
>     navFg: "@fg",
>     panel: ":lighten<3<@bg",
>     popup: ":lighten<3<@panel",
>     accent: "#478384",
>     header: ":alpha<0.7<@panel",
>     infoBg: "#253142",
>     infoFg: "#fff",
>     renote: "@accent",
>     shadow: "rgba(0, 0, 0, 0.3)",
>     divider: "#4646461a",
>     hashtag: "#1f3134",
>     mention: "@accent",
>     modalBg: "rgba(0, 0, 0, 0.5)",
>     success: "#86b300",
>     buttonBg: "#0000000d",
>     switchBg: "rgba(255, 255, 255, 0.15)",
>     acrylicBg: ":alpha<0.5<@bg",
>     cwHoverBg: "#707b97",
>     indicator: "@accent",
>     mentionMe: "@mention",
>     messageBg: "@bg",
>     navActive: "@accent",
>     accentedBg: ":alpha<0.15<@accent",
>     codeNumber: "#cfff9e",
>     codeString: "#ffb675",
>     fgOnAccent: "#fff",
>     infoWarnBg: "#42321c",
>     infoWarnFg: "#ffbd3e",
>     navHoverFg: ":lighten<17<@fg",
>     codeBoolean: "#c59eff",
>     dateLabelFg: "@fg",
>     inputBorder: "rgba(255, 255, 255, 0.1)",
>     panelBorder: '" solid 1px var(--divider)',
>     accentDarken: ":darken<10<@accent",
>     acrylicPanel: ":alpha<0.5<@panel",
>     navIndicator: "@indicator",
>     accentLighten: ":lighten<10<@accent",
>     buttonHoverBg: "#0000001a",
>     driveFolderBg: ":alpha<0.3<@accent",
>     fgHighlighted: ":lighten<3<@fg",
>     fgTransparent: ":alpha<0.5<@fg",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     buttonGradateA: "@accent",
>     buttonGradateB: ":hue<20<@accent",
>     htmlThemeColor: "@bg",
>     panelHighlight: ":lighten<3<@panel",
>     listItemHoverBg: "rgba(255, 255, 255, 0.03)",
>     scrollbarHandle: "#74747433",
>     inputBorderHover: "rgba(255, 255, 255, 0.2)",
>     wallpaperOverlay: "rgba(0, 0, 0, 0.5)",
>     fgTransparentWeak: ":alpha<0.75<@fg",
>     panelHeaderDivider: "rgba(0, 0, 0, 0)",
>     scrollbarHandleHover: "rgba(255, 255, 255, 0.4)",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/themes/l-vivid.json5 RiricaV13/themes/l-vivid.json5
2c2
< 	id: '6128c2a9-5c54-43fe-a47d-17942356470b',
---
>   id: "6128c2a9-5c54-43fe-a47d-17942356470b",
4,5c4,5
< 	name: 'Mi Vivid Light',
< 	author: 'syuilo',
---
>   name: "Mi Vivid Light",
>   author: "syuilo",
7c7
< 	base: 'light',
---
>   base: "light",
9,81c9,81
< 	props: {
< 		bg: '#fafafa',
< 		fg: '#444',
< 		cwBg: '#b1b9c1',
< 		cwFg: '#fff',
< 		link: '#ff9400',
< 		warn: '#ecb637',
< 		badge: '#31b1ce',
< 		error: '#ec4137',
< 		focus: ':alpha<0.3<@accent',
< 		navBg: '@panel',
< 		navFg: '@fg',
< 		panel: '#fff',
< 		accent: '#008cff',
< 		header: ':alpha<0.7<@panel',
< 		infoBg: '#e5f5ff',
< 		infoFg: '#72818a',
< 		renote: '@accent',
< 		shadow: 'rgba(0, 0, 0, 0.1)',
< 		divider: 'rgba(0, 0, 0, 0.08)',
< 		hashtag: '#92d400',
< 		mention: '@accent',
< 		modalBg: 'rgba(0, 0, 0, 0.3)',
< 		success: '#86b300',
< 		buttonBg: 'rgba(0, 0, 0, 0.05)',
< 		acrylicBg: ':alpha<0.5<@bg',
< 		cwHoverBg: '#bbc4ce',
< 		indicator: '@accent',
< 		mentionMe: '@mention',
< 		messageBg: '@bg',
< 		navActive: '@accent',
< 		infoWarnBg: '#fff0db',
< 		infoWarnFg: '#8f6e31',
< 		navHoverFg: ':darken<17<@fg',
< 		dateLabelFg: '@fg',
< 		inputBorder: 'rgba(0, 0, 0, 0.1)',
< 		inputBorderHover: 'rgba(0, 0, 0, 0.2)',
< 		panelBorder: '" solid 1px var(--divider)',
< 		accentDarken: ':darken<10<@accent',
< 		acrylicPanel: ':alpha<0.5<@panel',
< 		navIndicator: '@accent',
< 		accentLighten: ':lighten<10<@accent',
< 		buttonHoverBg: 'rgba(0, 0, 0, 0.1)',
< 		driveFolderBg: ':alpha<0.3<@accent',
< 		fgHighlighted: ':darken<3<@fg',
< 		fgTransparent: ':alpha<0.5<@fg',
< 		panelHeaderBg: ':lighten<3<@panel',
< 		panelHeaderFg: '@fg',
< 		htmlThemeColor: '@bg',
< 		panelHighlight: ':darken<3<@panel',
< 		listItemHoverBg: 'rgba(0, 0, 0, 0.03)',
< 		scrollbarHandle: 'rgba(0, 0, 0, 0.2)',
< 		wallpaperOverlay: 'rgba(255, 255, 255, 0.5)',
< 		fgTransparentWeak: ':alpha<0.75<@fg',
< 		panelHeaderDivider: '@divider',
< 		scrollbarHandleHover: 'rgba(0, 0, 0, 0.4)',
< 		X2: ':darken<2<@panel',
< 		X3: 'rgba(0, 0, 0, 0.05)',
< 		X4: 'rgba(0, 0, 0, 0.1)',
< 		X5: 'rgba(0, 0, 0, 0.05)',
< 		X6: 'rgba(0, 0, 0, 0.25)',
< 		X7: 'rgba(0, 0, 0, 0.05)',
< 		X8: ':lighten<5<@accent',
< 		X9: ':darken<5<@accent',
< 		X10: ':alpha<0.4<@accent',
< 		X11: 'rgba(0, 0, 0, 0.1)',
< 		X12: 'rgba(0, 0, 0, 0.1)',
< 		X13: 'rgba(0, 0, 0, 0.15)',
< 		X14: ':alpha<0.5<@navBg',
< 		X15: ':alpha<0<@panel',
< 		X16: ':alpha<0.7<@panel',
< 		X17: ':alpha<0.8<@bg',
< 	},
---
>   props: {
>     bg: "#fafafa",
>     fg: "#444",
>     cwBg: "#b1b9c1",
>     cwFg: "#fff",
>     link: "#ff9400",
>     warn: "#ecb637",
>     badge: "#31b1ce",
>     error: "#ec4137",
>     focus: ":alpha<0.3<@accent",
>     navBg: "@panel",
>     navFg: "@fg",
>     panel: "#fff",
>     accent: "#008cff",
>     header: ":alpha<0.7<@panel",
>     infoBg: "#e5f5ff",
>     infoFg: "#72818a",
>     renote: "@accent",
>     shadow: "rgba(0, 0, 0, 0.1)",
>     divider: "rgba(0, 0, 0, 0.08)",
>     hashtag: "#92d400",
>     mention: "@accent",
>     modalBg: "rgba(0, 0, 0, 0.3)",
>     success: "#86b300",
>     buttonBg: "rgba(0, 0, 0, 0.05)",
>     acrylicBg: ":alpha<0.5<@bg",
>     cwHoverBg: "#bbc4ce",
>     indicator: "@accent",
>     mentionMe: "@mention",
>     messageBg: "@bg",
>     navActive: "@accent",
>     infoWarnBg: "#fff0db",
>     infoWarnFg: "#8f6e31",
>     navHoverFg: ":darken<17<@fg",
>     dateLabelFg: "@fg",
>     inputBorder: "rgba(0, 0, 0, 0.1)",
>     inputBorderHover: "rgba(0, 0, 0, 0.2)",
>     panelBorder: '" solid 1px var(--divider)',
>     accentDarken: ":darken<10<@accent",
>     acrylicPanel: ":alpha<0.5<@panel",
>     navIndicator: "@accent",
>     accentLighten: ":lighten<10<@accent",
>     buttonHoverBg: "rgba(0, 0, 0, 0.1)",
>     driveFolderBg: ":alpha<0.3<@accent",
>     fgHighlighted: ":darken<3<@fg",
>     fgTransparent: ":alpha<0.5<@fg",
>     panelHeaderBg: ":lighten<3<@panel",
>     panelHeaderFg: "@fg",
>     htmlThemeColor: "@bg",
>     panelHighlight: ":darken<3<@panel",
>     listItemHoverBg: "rgba(0, 0, 0, 0.03)",
>     scrollbarHandle: "rgba(0, 0, 0, 0.2)",
>     wallpaperOverlay: "rgba(255, 255, 255, 0.5)",
>     fgTransparentWeak: ":alpha<0.75<@fg",
>     panelHeaderDivider: "@divider",
>     scrollbarHandleHover: "rgba(0, 0, 0, 0.4)",
>     X2: ":darken<2<@panel",
>     X3: "rgba(0, 0, 0, 0.05)",
>     X4: "rgba(0, 0, 0, 0.1)",
>     X5: "rgba(0, 0, 0, 0.05)",
>     X6: "rgba(0, 0, 0, 0.25)",
>     X7: "rgba(0, 0, 0, 0.05)",
>     X8: ":lighten<5<@accent",
>     X9: ":darken<5<@accent",
>     X10: ":alpha<0.4<@accent",
>     X11: "rgba(0, 0, 0, 0.1)",
>     X12: "rgba(0, 0, 0, 0.1)",
>     X13: "rgba(0, 0, 0, 0.15)",
>     X14: ":alpha<0.5<@navBg",
>     X15: ":alpha<0<@panel",
>     X16: ":alpha<0.7<@panel",
>     X17: ":alpha<0.8<@bg",
>   },
Only in misskeyV13/packages/frontend/src/types: date-separated-list.ts
diff --color=auto -r misskeyV13/packages/frontend/src/types/menu.ts RiricaV13/types/menu.ts
1,2c1,2
< import * as Misskey from 'misskey-js';
< import { Ref } from 'vue';
---
> import * as Misskey from "misskey-js";
> import { Ref } from "vue";
8,14c8,54
< export type MenuLabel = { type: 'label', text: string };
< export type MenuLink = { type: 'link', to: string, text: string, icon?: string, indicate?: boolean, avatar?: Misskey.entities.User };
< export type MenuA = { type: 'a', href: string, target?: string, download?: string, text: string, icon?: string, indicate?: boolean };
< export type MenuUser = { type: 'user', user: Misskey.entities.User, active?: boolean, indicate?: boolean, action: MenuAction };
< export type MenuSwitch = { type: 'switch', ref: Ref<boolean>, text: string, disabled?: boolean };
< export type MenuButton = { type?: 'button', text: string, icon?: string, indicate?: boolean, danger?: boolean, active?: boolean, avatar?: Misskey.entities.User; action: MenuAction };
< export type MenuParent = { type: 'parent', text: string, icon?: string, children: OuterMenuItem[] };
---
> export type MenuLabel = { type: "label"; text: string };
> export type MenuLink = {
>   type: "link";
>   to: string;
>   text: string;
>   icon?: string;
>   indicate?: boolean;
>   avatar?: Misskey.entities.User;
> };
> export type MenuA = {
>   type: "a";
>   href: string;
>   target?: string;
>   download?: string;
>   text: string;
>   icon?: string;
>   indicate?: boolean;
> };
> export type MenuUser = {
>   type: "user";
>   user: Misskey.entities.User;
>   active?: boolean;
>   indicate?: boolean;
>   action: MenuAction;
> };
> export type MenuSwitch = {
>   type: "switch";
>   ref: Ref<boolean>;
>   text: string;
>   disabled?: boolean;
> };
> export type MenuButton = {
>   type?: "button";
>   text: string;
>   icon?: string;
>   indicate?: boolean;
>   danger?: boolean;
>   active?: boolean;
>   avatar?: Misskey.entities.User;
>   action: MenuAction;
> };
> export type MenuParent = {
>   type: "parent";
>   text: string;
>   icon?: string;
>   children: OuterMenuItem[];
> };
16c56
< export type MenuPending = { type: 'pending' };
---
> export type MenuPending = { type: "pending" };
18,19c58,70
< type OuterMenuItem = MenuDivider | MenuNull | MenuLabel | MenuLink | MenuA | MenuUser | MenuSwitch | MenuButton | MenuParent;
< type OuterPromiseMenuItem = Promise<MenuLabel | MenuLink | MenuA | MenuUser | MenuSwitch | MenuButton | MenuParent>;
---
> type OuterMenuItem =
>   | MenuDivider
>   | MenuNull
>   | MenuLabel
>   | MenuLink
>   | MenuA
>   | MenuUser
>   | MenuSwitch
>   | MenuButton
>   | MenuParent;
> type OuterPromiseMenuItem = Promise<
>   MenuLabel | MenuLink | MenuA | MenuUser | MenuSwitch | MenuButton | MenuParent
> >;
21c72,81
< export type InnerMenuItem = MenuDivider | MenuPending | MenuLabel | MenuLink | MenuA | MenuUser | MenuSwitch | MenuButton | MenuParent;
---
> export type InnerMenuItem =
>   | MenuDivider
>   | MenuPending
>   | MenuLabel
>   | MenuLink
>   | MenuA
>   | MenuUser
>   | MenuSwitch
>   | MenuButton
>   | MenuParent;
Only in misskeyV13/packages/frontend/src/ui/_common_: common.ts
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/common.vue RiricaV13/ui/_common_/common.vue
12,21d11
< <TransitionGroup
< 	tag="div" :class="$style.notifications"
< 	:move-class="$store.state.animation ? $style.transition_notification_move : ''"
< 	:enter-active-class="$store.state.animation ? $style.transition_notification_enterActive : ''"
< 	:leave-active-class="$store.state.animation ? $style.transition_notification_leaveActive : ''"
< 	:enter-from-class="$store.state.animation ? $style.transition_notification_enterFrom : ''"
< 	:leave-to-class="$store.state.animation ? $style.transition_notification_leaveTo : ''"
< >
< 	<XNotification v-for="notification in notifications" :key="notification.id" :notification="notification" :class="$style.notification"/>
< </TransitionGroup>
23,24d12
< <XStreamIndicator/>
< 
28,29d15
< 
< <div v-if="$i && $i.isBot" id="botWarn"><span>{{ i18n.ts.loggedInAsBot }}</span></div>
33,42c19,25
< import { defineAsyncComponent, nextTick } from 'vue';
< import * as misskey from 'misskey-js';
< import { swInject } from './sw-inject';
< import XNotification from './notification.vue';
< import { popup, popups, pendingApiRequestsCount } from '@/os';
< import { uploads } from '@/scripts/upload';
< import * as sound from '@/scripts/sound';
< import { $i } from '@/account';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
---
> import { defineAsyncComponent } from "vue";
> import { swInject } from "./sw-inject";
> import { popup, popups, pendingApiRequestsCount } from "@/os";
> import { uploads } from "@/scripts/upload";
> import * as sound from "@/scripts/sound";
> import { $i } from "@/account";
> import { stream } from "@/stream";
44,45c27,30
< const XStreamIndicator = defineAsyncComponent(() => import('./stream-indicator.vue'));
< const XUpload = defineAsyncComponent(() => import('./upload.vue'));
---
> const XStreamIndicator = defineAsyncComponent(
>   () => import("./stream-indicator.vue")
> );
> const XUpload = defineAsyncComponent(() => import("./upload.vue"));
49c34,35
< let notifications = $ref<misskey.entities.Notification[]>([]);
---
> const onNotification = (notification) => {
>   if ($i.mutingNotificationTypes.includes(notification.type)) return;
51,52c37,40
< function onNotification(notification) {
< 	if ($i.mutingNotificationTypes.includes(notification.type)) return;
---
>   if (document.visibilityState === "visible") {
>     stream.send("readNotification", {
>       id: notification.id,
>     });
54,57c42,52
< 	if (document.visibilityState === 'visible') {
< 		stream.send('readNotification', {
< 			id: notification.id,
< 		});
---
>     popup(
>       defineAsyncComponent(
>         () => import("@/components/MkNotificationToast.vue")
>       ),
>       {
>         notification,
>       },
>       {},
>       "closed"
>     );
>   }
59,62c54,55
< 		notifications.unshift(notification);
< 		window.setTimeout(() => {
< 			if (notifications.length > 3) notifications.pop();
< 		}, 500);
---
>   sound.play("notification");
> };
64,71d56
< 		window.setTimeout(() => {
< 			notifications = notifications.filter(x => x.id !== notification.id);
< 		}, 6000);
< 	}
< 
< 	sound.play('notification');
< }
< 
73,74c58,59
< 	const connection = stream.useChannel('main', null, 'UI');
< 	connection.on('notification', onNotification);
---
>   const connection = stream.useChannel("main", null, "UI");
>   connection.on("notification", onNotification);
76,79c61,64
< 	//#region Listen message from SW
< 	if ('serviceWorker' in navigator) {
< 		swInject();
< 	}
---
>   //#region Listen message from SW
>   if ("serviceWorker" in navigator) {
>     swInject();
>   }
83,129d67
< <style lang="scss" module>
< .transition_notification_move,
< .transition_notification_enterActive,
< .transition_notification_leaveActive {
< 	transition: opacity 0.3s, transform 0.3s !important;
< }
< .transition_notification_enterFrom,
< .transition_notification_leaveTo {
< 	opacity: 0;
< 	transform: translateX(-250px);
< }
< 
< .notifications {
< 	position: fixed;
< 	z-index: 3900000;
< 	left: 0;
< 	width: 250px;
< 	top: 32px;
< 	padding: 0 32px;
< 	pointer-events: none;
< 	container-type: inline-size;
< }
< 
< .notification {
< 	& + .notification {
< 		margin-top: 8px;
< 	}
< }
< 
< @media (max-width: 500px) {
< 	.notifications {
< 		top: initial;
< 		bottom: calc(var(--minBottomSpacing) + var(--margin));
< 		padding: 0 var(--margin);
< 		display: flex;
< 		flex-direction: column-reverse;
< 	}
< 
< 	.notification {
< 		& + .notification {
< 			margin-top: 0;
< 			margin-bottom: 8px;
< 		}
< 	}
< }
< </style>
< 
132,134c70,78
< 	0% { opacity: 1; }
< 	50% { opacity: 0; }
< 	100% { opacity: 1; }
---
>   0% {
>     opacity: 1;
>   }
>   50% {
>     opacity: 0;
>   }
>   100% {
>     opacity: 1;
>   }
138,143c82,87
< 	0% {
< 		transform: rotate(0deg);
< 	}
< 	100% {
< 		transform: rotate(360deg);
< 	}
---
>   0% {
>     transform: rotate(0deg);
>   }
>   100% {
>     transform: rotate(360deg);
>   }
147,152c91,95
< 	display: block;
< 	position: fixed;
< 	z-index: 4000000;
< 	top: 15px;
< 	right: 15px;
< 	pointer-events: none;
---
>   display: block;
>   position: fixed;
>   z-index: 4000000;
>   top: 15px;
>   right: 15px;
154,165c97,108
< 	&:before {
< 		content: "";
< 		display: block;
< 		width: 18px;
< 		height: 18px;
< 		box-sizing: border-box;
< 		border: solid 2px transparent;
< 		border-top-color: var(--accent);
< 		border-left-color: var(--accent);
< 		border-radius: 50%;
< 		animation: progress-spinner 400ms linear infinite;
< 	}
---
>   &:before {
>     content: "";
>     display: block;
>     width: 18px;
>     height: 18px;
>     box-sizing: border-box;
>     border: solid 2px transparent;
>     border-top-color: var(--accent);
>     border-left-color: var(--accent);
>     border-radius: 50%;
>     animation: progress-spinner 400ms linear infinite;
>   }
168,190d110
< #botWarn {
< 	position: fixed;
< 	top: 0;
< 	left: 0;
< 	right: 0;
< 	bottom: 0;
< 	margin: auto;
< 	width: 100%;
< 	height: max-content;
< 	text-align: center;
< 	z-index: 2147483647;
< 	color: #ff0;
< 	background: rgba(0, 0, 0, 0.5);
< 	padding: 4px 7px;
< 	font-size: 14px;
< 	pointer-events: none;
< 	user-select: none;
< 
< 	> span {
< 		animation: dev-ticker-blink 2s infinite;
< 	}
< }
< 
192,201c112,121
< 	position: fixed;
< 	top: 0;
< 	left: 0;
< 	z-index: 2147483647;
< 	color: #ff0;
< 	background: rgba(0, 0, 0, 0.5);
< 	padding: 4px 5px;
< 	font-size: 14px;
< 	pointer-events: none;
< 	user-select: none;
---
>   position: fixed;
>   top: 0;
>   left: 0;
>   z-index: 2147483647;
>   color: #ff0;
>   background: rgba(0, 0, 0, 0.5);
>   padding: 4px 5px;
>   font-size: 14px;
>   pointer-events: none;
>   user-select: none;
203,205c123,125
< 	> span {
< 		animation: dev-ticker-blink 2s infinite;
< 	}
---
>   > span {
>     animation: dev-ticker-blink 2s infinite;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/navbar-for-mobile.vue RiricaV13/ui/_common_/navbar-for-mobile.vue
2,42c2,101
< <div class="kmwsukvl">
< 	<div class="body">
< 		<div class="top">
< 			<div class="banner" :style="{ backgroundImage: `url(${ $instance.bannerUrl })` }"></div>
< 			<button v-click-anime class="item _button instance" @click="openInstanceMenu">
< 				<img :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'" alt="" class="icon"/>
< 			</button>
< 		</div>
< 		<div class="middle">
< 			<MkA v-click-anime class="item index" active-class="active" to="/" exact>
< 				<i class="icon ti ti-home ti-fw"></i><span class="text">{{ i18n.ts.timeline }}</span>
< 			</MkA>
< 			<template v-for="item in menu">
< 				<div v-if="item === '-'" class="divider"></div>
< 				<component :is="navbarItemDef[item].to ? 'MkA' : 'button'" v-else-if="navbarItemDef[item] && (navbarItemDef[item].show !== false)" v-click-anime class="item _button" :class="[item, { active: navbarItemDef[item].active }]" active-class="active" :to="navbarItemDef[item].to" v-on="navbarItemDef[item].action ? { click: navbarItemDef[item].action } : {}">
< 					<i class="icon ti-fw" :class="navbarItemDef[item].icon"></i><span class="text">{{ navbarItemDef[item].title }}</span>
< 					<span v-if="navbarItemDef[item].indicated" class="indicator"><i class="icon _indicatorCircle"></i></span>
< 				</component>
< 			</template>
< 			<div class="divider"></div>
< 			<MkA v-if="$i.isAdmin || $i.isModerator" v-click-anime class="item" active-class="active" to="/admin">
< 				<i class="icon ti ti-dashboard ti-fw"></i><span class="text">{{ i18n.ts.controlPanel }}</span>
< 			</MkA>
< 			<button v-click-anime class="item _button" @click="more">
< 				<i class="icon ti ti-grid-dots ti-fw"></i><span class="text">{{ i18n.ts.more }}</span>
< 				<span v-if="otherMenuItemIndicated" class="indicator"><i class="icon _indicatorCircle"></i></span>
< 			</button>
< 			<MkA v-click-anime class="item" active-class="active" to="/settings">
< 				<i class="icon ti ti-settings ti-fw"></i><span class="text">{{ i18n.ts.settings }}</span>
< 			</MkA>
< 		</div>
< 		<div class="bottom">
< 			<button class="item _button post" data-cy-open-post-form @click="os.post">
< 				<i class="icon ti ti-pencil ti-fw"></i><span class="text">{{ i18n.ts.note }}</span>
< 			</button>
< 			<button v-click-anime class="item _button account" @click="openAccountMenu">
< 				<MkAvatar :user="$i" class="avatar"/><MkAcct class="text" :user="$i"/>
< 			</button>
< 		</div>
< 	</div>
< </div>
---
>   <div class="kmwsukvl">
>     <div class="body">
>       <div class="top">
>         <div
>           class="banner"
>           :style="{ backgroundImage: `url(${$instance.bannerUrl})` }"
>         ></div>
>         <button
>           v-click-anime
>           class="item _button instance"
>           @click="openInstanceMenu"
>         >
>           <img
>             :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'"
>             alt=""
>             class="icon"
>           />
>         </button>
>       </div>
>       <div class="middle">
>         <MkA
>           v-click-anime
>           class="item index"
>           active-class="active"
>           to="/"
>           exact
>         >
>           <i class="icon fas fa-home fa-fw"></i
>           ><span class="text">{{ i18n.ts.timeline }}</span>
>         </MkA>
>         <template v-for="item in menu">
>           <div v-if="item === '-'" class="divider"></div>
>           <component
>             :is="navbarItemDef[item].to ? 'MkA' : 'button'"
>             v-else-if="
>               navbarItemDef[item] && navbarItemDef[item].show !== false
>             "
>             v-click-anime
>             class="item _button"
>             :class="[item, { active: navbarItemDef[item].active }]"
>             active-class="active"
>             :to="navbarItemDef[item].to"
>             v-on="
>               navbarItemDef[item].action
>                 ? { click: navbarItemDef[item].action }
>                 : {}
>             "
>           >
>             <i class="icon fa-fw" :class="navbarItemDef[item].icon"></i
>             ><span class="text">{{ i18n.ts[navbarItemDef[item].title] }}</span>
>             <span v-if="navbarItemDef[item].indicated" class="indicator"
>               ><i class="icon fas fa-circle"></i
>             ></span>
>           </component>
>         </template>
>         <div class="divider"></div>
>         <MkA
>           v-if="$i.isAdmin || $i.isModerator"
>           v-click-anime
>           class="item"
>           active-class="active"
>           to="/admin"
>         >
>           <i class="icon fas fa-door-open fa-fw"></i
>           ><span class="text">{{ i18n.ts.controlPanel }}</span>
>         </MkA>
>         <button v-click-anime class="item _button" @click="more">
>           <i class="icon fa fa-ellipsis-h fa-fw"></i
>           ><span class="text">{{ i18n.ts.more }}</span>
>           <span v-if="otherMenuItemIndicated" class="indicator"
>             ><i class="icon fas fa-circle"></i
>           ></span>
>         </button>
>         <MkA v-click-anime class="item" active-class="active" to="/settings">
>           <i class="icon fas fa-cog fa-fw"></i
>           ><span class="text">{{ i18n.ts.settings }}</span>
>         </MkA>
>       </div>
>       <div class="bottom">
>         <button
>           class="item _button post"
>           data-cy-open-post-form
>           @click="os.post"
>         >
>           <i class="icon fas fa-pencil-alt fa-fw"></i
>           ><span class="text">{{ i18n.ts.note }}</span>
>         </button>
>         <button
>           v-click-anime
>           class="item _button account"
>           @click="openAccountMenu"
>         >
>           <MkAvatar :user="$i" class="avatar" /><MkAcct
>             class="text"
>             :user="$i"
>           />
>         </button>
>       </div>
>     </div>
>   </div>
46,52c105,120
< import { computed, defineAsyncComponent, ref, toRef, watch } from 'vue';
< import { openInstanceMenu } from './common';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { openAccountMenu as openAccountMenu_ } from '@/account';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
---
> import {
>   computed,
>   defineAsyncComponent,
>   defineComponent,
>   ref,
>   toRef,
>   watch,
> } from "vue";
> import { host } from "@/config";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { openAccountMenu as openAccountMenu_ } from "@/account";
> import { defaultStore } from "@/store";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
54c122
< const menu = toRef(defaultStore.state, 'menu');
---
> const menu = toRef(defaultStore.state, "menu");
56,60c124,128
< 	for (const def in navbarItemDef) {
< 		if (menu.value.includes(def)) continue;
< 		if (navbarItemDef[def].indicated) return true;
< 	}
< 	return false;
---
>   for (const def in navbarItemDef) {
>     if (menu.value.includes(def)) continue;
>     if (navbarItemDef[def].indicated) return true;
>   }
>   return false;
64,66c132,137
< 	openAccountMenu_({
< 		withExtraOperation: true,
< 	}, ev);
---
>   openAccountMenu_(
>     {
>       withExtraOperation: true,
>     },
>     ev
>   );
68a140,211
> function openInstanceMenu(ev: MouseEvent) {
>   os.popupMenu(
>     [
>       {
>         text: instance.name ?? host,
>         type: "label",
>       },
>       {
>         type: "link",
>         text: i18n.ts.instanceInfo,
>         icon: "fas fa-info-circle",
>         to: "/about",
>       },
>       {
>         type: "link",
>         text: i18n.ts.customEmojis,
>         icon: "fas fa-laugh",
>         to: "/about#emojis",
>       },
>       {
>         type: "link",
>         text: i18n.ts.federation,
>         icon: "fas fa-globe",
>         to: "/about#federation",
>       },
>       null,
>       {
>         type: "parent",
>         text: i18n.ts.help,
>         icon: "fas fa-question-circle",
>         children: [
>           {
>             type: "link",
>             to: "/mfm-cheat-sheet",
>             text: i18n.ts._mfm.cheatSheet,
>             icon: "fas fa-code",
>           },
>           {
>             type: "link",
>             to: "/scratchpad",
>             text: i18n.ts.scratchpad,
>             icon: "fas fa-terminal",
>           },
>           {
>             type: "link",
>             to: "/api-console",
>             text: "API Console",
>             icon: "fas fa-terminal",
>           },
>           null,
>           {
>             text: i18n.ts.document,
>             icon: "fas fa-question-circle",
>             action: () => {
>               window.open("https://misskey-hub.net/help.html", "_blank");
>             },
>           },
>         ],
>       },
>       {
>         type: "link",
>         text: i18n.ts.aboutMisskey,
>         to: "/about-misskey",
>       },
>     ],
>     ev.currentTarget ?? ev.target,
>     {
>       align: "left",
>     }
>   );
> }
> 
70,71c213,218
< 	os.popup(defineAsyncComponent(() => import('@/components/MkLaunchPad.vue')), {}, {
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkLaunchPad.vue")),
>     {},
>     {},
>     "closed"
>   );
77,79c224,226
< 	> .body {
< 		display: flex;
< 		flex-direction: column;
---
>   > .body {
>     display: flex;
>     flex-direction: column;
81,88c228,235
< 		> .top {
< 			position: sticky;
< 			top: 0;
< 			z-index: 1;
< 			padding: 20px 0;
< 			background: var(--X14);
< 			-webkit-backdrop-filter: var(--blur, blur(8px));
< 			backdrop-filter: var(--blur, blur(8px));
---
>     > .top {
>       position: sticky;
>       top: 0;
>       z-index: 1;
>       padding: 20px 0;
>       background: var(--X14);
>       -webkit-backdrop-filter: var(--blur, blur(8px));
>       backdrop-filter: var(--blur, blur(8px));
90,100c237,255
< 			> .banner {
< 				position: absolute;
< 				top: 0;
< 				left: 0;
< 				width: 100%;
< 				height: 100%;
< 				background-size: cover;
< 				background-position: center center;
< 				-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 15%, rgba(0,0,0,0.75) 100%);
< 				mask-image: linear-gradient(0deg, rgba(0,0,0,0) 15%, rgba(0,0,0,0.75) 100%);
< 			}
---
>       > .banner {
>         position: absolute;
>         top: 0;
>         left: 0;
>         width: 100%;
>         height: 100%;
>         background-size: cover;
>         background-position: center center;
>         -webkit-mask-image: linear-gradient(
>           0deg,
>           rgba(0, 0, 0, 0) 15%,
>           rgba(0, 0, 0, 0.75) 100%
>         );
>         mask-image: linear-gradient(
>           0deg,
>           rgba(0, 0, 0, 0) 15%,
>           rgba(0, 0, 0, 0.75) 100%
>         );
>       }
102,106c257,261
< 			> .instance {
< 				position: relative;
< 				display: block;
< 				text-align: center;
< 				width: 100%;
---
>       > .instance {
>         position: relative;
>         display: block;
>         text-align: center;
>         width: 100%;
108,114c263,269
< 				> .icon {
< 					display: inline-block;
< 					width: 38px;
< 					aspect-ratio: 1;
< 				}
< 			}
< 		}
---
>         > .icon {
>           display: inline-block;
>           width: 38px;
>           aspect-ratio: 1;
>         }
>       }
>     }
116,122c271,277
< 		> .bottom {
< 			position: sticky;
< 			bottom: 0;
< 			padding: 20px 0;
< 			background: var(--X14);
< 			-webkit-backdrop-filter: var(--blur, blur(8px));
< 			backdrop-filter: var(--blur, blur(8px));
---
>     > .bottom {
>       position: sticky;
>       bottom: 0;
>       padding: 20px 0;
>       background: var(--X14);
>       -webkit-backdrop-filter: var(--blur, blur(8px));
>       backdrop-filter: var(--blur, blur(8px));
124,131c279,286
< 			> .post {
< 				position: relative;
< 				display: block;
< 				width: 100%;
< 				height: 40px;
< 				color: var(--fgOnAccent);
< 				font-weight: bold;
< 				text-align: left;
---
>       > .post {
>         position: relative;
>         display: block;
>         width: 100%;
>         height: 40px;
>         color: var(--fgOnAccent);
>         font-weight: bold;
>         text-align: left;
133,146c288,305
< 				&:before {
< 					content: "";
< 					display: block;
< 					width: calc(100% - 38px);
< 					height: 100%;
< 					margin: auto;
< 					position: absolute;
< 					top: 0;
< 					left: 0;
< 					right: 0;
< 					bottom: 0;
< 					border-radius: 999px;
< 					background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< 				}
---
>         &:before {
>           content: "";
>           display: block;
>           width: calc(100% - 38px);
>           height: 100%;
>           margin: auto;
>           position: absolute;
>           top: 0;
>           left: 0;
>           right: 0;
>           bottom: 0;
>           border-radius: 999px;
>           background: linear-gradient(
>             90deg,
>             var(--buttonGradateA),
>             var(--buttonGradateB)
>           );
>         }
148,152c307,312
< 				&:hover, &.active {
< 					&:before {
< 						background: var(--accentLighten);
< 					}
< 				}
---
>         &:hover,
>         &.active {
>           &:before {
>             background: var(--accentLighten);
>           }
>         }
154,159c314,319
< 				> .icon {
< 					position: relative;
< 					margin-left: 30px;
< 					margin-right: 8px;
< 					width: 32px;
< 				}
---
>         > .icon {
>           position: relative;
>           margin-left: 30px;
>           margin-right: 8px;
>           width: 32px;
>         }
161,164c321,324
< 				> .text {
< 					position: relative;
< 				}
< 			}
---
>         > .text {
>           position: relative;
>         }
>       }
166,177c326,337
< 			> .account {
< 				position: relative;
< 				display: flex;
< 				align-items: center;
< 				padding-left: 30px;
< 				text-overflow: ellipsis;
< 				overflow: hidden;
< 				white-space: nowrap;
< 				width: 100%;
< 				text-align: left;
< 				box-sizing: border-box;
< 				margin-top: 16px;
---
>       > .account {
>         position: relative;
>         display: flex;
>         align-items: center;
>         padding-left: 30px;
>         text-overflow: ellipsis;
>         overflow: hidden;
>         white-space: nowrap;
>         width: 100%;
>         text-align: left;
>         box-sizing: border-box;
>         margin-top: 16px;
179,186c339,346
< 				> .avatar {
< 					position: relative;
< 					width: 32px;
< 					aspect-ratio: 1;
< 					margin-right: 8px;
< 				}
< 			}
< 		}
---
>         > .avatar {
>           position: relative;
>           width: 32px;
>           aspect-ratio: 1;
>           margin-right: 8px;
>         }
>       }
>     }
188,189c348,349
< 		> .middle {
< 			flex: 1;
---
>     > .middle {
>       flex: 1;
191,194c351,354
< 			> .divider {
< 				margin: 16px 16px;
< 				border-top: solid 0.5px var(--divider);
< 			}
---
>       > .divider {
>         margin: 16px 16px;
>         border-top: solid 0.5px var(--divider);
>       }
196,207c356,367
< 			> .item {
< 				position: relative;
< 				display: block;
< 				padding-left: 24px;
< 				line-height: 2.85rem;
< 				text-overflow: ellipsis;
< 				overflow: hidden;
< 				white-space: nowrap;
< 				width: 100%;
< 				text-align: left;
< 				box-sizing: border-box;
< 				color: var(--navFg);
---
>       > .item {
>         position: relative;
>         display: block;
>         padding-left: 24px;
>         line-height: 2.85rem;
>         text-overflow: ellipsis;
>         overflow: hidden;
>         white-space: nowrap;
>         width: 100%;
>         text-align: left;
>         box-sizing: border-box;
>         color: var(--navFg);
209,213c369,373
< 				> .icon {
< 					position: relative;
< 					width: 32px;
< 					margin-right: 8px;
< 				}
---
>         > .icon {
>           position: relative;
>           width: 32px;
>           margin-right: 8px;
>         }
215,222c375,382
< 				> .indicator {
< 					position: absolute;
< 					top: 0;
< 					left: 20px;
< 					color: var(--navIndicator);
< 					font-size: 8px;
< 					animation: blink 1s infinite;
< 				}
---
>         > .indicator {
>           position: absolute;
>           top: 0;
>           left: 20px;
>           color: var(--navIndicator);
>           font-size: 8px;
>           animation: blink 1s infinite;
>         }
224,227c384,387
< 				> .text {
< 					position: relative;
< 					font-size: 0.9em;
< 				}
---
>         > .text {
>           position: relative;
>           font-size: 0.9em;
>         }
229,232c389,392
< 				&:hover {
< 					text-decoration: none;
< 					color: var(--navHoverFg);
< 				}
---
>         &:hover {
>           text-decoration: none;
>           color: var(--navHoverFg);
>         }
234,236c394,396
< 				&.active {
< 					color: var(--navActive);
< 				}
---
>         &.active {
>           color: var(--navActive);
>         }
238,256c398,417
< 				&:hover, &.active {
< 					&:before {
< 						content: "";
< 						display: block;
< 						width: calc(100% - 24px);
< 						height: 100%;
< 						margin: auto;
< 						position: absolute;
< 						top: 0;
< 						left: 0;
< 						right: 0;
< 						bottom: 0;
< 						border-radius: 999px;
< 						background: var(--accentedBg);
< 					}
< 				}
< 			}
< 		}
< 	}
---
>         &:hover,
>         &.active {
>           &:before {
>             content: "";
>             display: block;
>             width: calc(100% - 24px);
>             height: 100%;
>             margin: auto;
>             position: absolute;
>             top: 0;
>             left: 0;
>             right: 0;
>             bottom: 0;
>             border-radius: 999px;
>             background: var(--accentedBg);
>           }
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/navbar.vue RiricaV13/ui/_common_/navbar.vue
2,52c2,113
< <div class="mvcprjjd" :class="{ iconOnly }">
< 	<div class="body">
< 		<div class="top">
< 			<div class="banner" :style="{ backgroundImage: `url(${ $instance.bannerUrl })` }"></div>
< 			<button v-click-anime v-tooltip.noDelay.right="$instance.name ?? i18n.ts.instance" class="item _button instance" @click="openInstanceMenu">
< 				<img :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'" alt="" class="icon"/>
< 			</button>
< 		</div>
< 		<div class="middle">
< 			<MkA v-click-anime v-tooltip.noDelay.right="i18n.ts.timeline" class="item index" active-class="active" to="/" exact>
< 				<i class="icon ti ti-home ti-fw"></i><span class="text">{{ i18n.ts.timeline }}</span>
< 			</MkA>
< 			<template v-for="item in menu">
< 				<div v-if="item === '-'" class="divider"></div>
< 				<component
< 					:is="navbarItemDef[item].to ? 'MkA' : 'button'"
< 					v-else-if="navbarItemDef[item] && (navbarItemDef[item].show !== false)"
< 					v-click-anime
< 					v-tooltip.noDelay.right="navbarItemDef[item].title"
< 					class="item _button"
< 					:class="[item, { active: navbarItemDef[item].active }]"
< 					active-class="active"
< 					:to="navbarItemDef[item].to"
< 					v-on="navbarItemDef[item].action ? { click: navbarItemDef[item].action } : {}"
< 				>
< 					<i class="icon ti-fw" :class="navbarItemDef[item].icon"></i><span class="text">{{ navbarItemDef[item].title }}</span>
< 					<span v-if="navbarItemDef[item].indicated" class="indicator"><i class="icon _indicatorCircle"></i></span>
< 				</component>
< 			</template>
< 			<div class="divider"></div>
< 			<MkA v-if="$i.isAdmin || $i.isModerator" v-click-anime v-tooltip.noDelay.right="i18n.ts.controlPanel" class="item" active-class="active" to="/admin">
< 				<i class="icon ti ti-dashboard ti-fw"></i><span class="text">{{ i18n.ts.controlPanel }}</span>
< 			</MkA>
< 			<button v-click-anime class="item _button" @click="more">
< 				<i class="icon ti ti-grid-dots ti-fw"></i><span class="text">{{ i18n.ts.more }}</span>
< 				<span v-if="otherMenuItemIndicated" class="indicator"><i class="icon _indicatorCircle"></i></span>
< 			</button>
< 			<MkA v-click-anime v-tooltip.noDelay.right="i18n.ts.settings" class="item" active-class="active" to="/settings">
< 				<i class="icon ti ti-settings ti-fw"></i><span class="text">{{ i18n.ts.settings }}</span>
< 			</MkA>
< 		</div>
< 		<div class="bottom">
< 			<button v-tooltip.noDelay.right="i18n.ts.note" class="item _button post" data-cy-open-post-form @click="os.post">
< 				<i class="icon ti ti-pencil ti-fw"></i><span class="text">{{ i18n.ts.note }}</span>
< 			</button>
< 			<button v-click-anime v-tooltip.noDelay.right="`${i18n.ts.account}: @${$i.username}`" class="item _button account" @click="openAccountMenu">
< 				<MkAvatar :user="$i" class="avatar"/><MkAcct class="text" :user="$i"/>
< 			</button>
< 		</div>
< 	</div>
< </div>
---
>   <div class="mvcprjjd" :class="{ iconOnly }">
>     <div class="body">
>       <div class="top">
>         <div
>           class="banner"
>           :style="{ backgroundImage: `url(${$instance.bannerUrl})` }"
>         ></div>
>         <button
>           v-click-anime
>           v-tooltip.noDelay.right="$instance.name ?? i18n.ts.instance"
>           class="item _button instance"
>           @click="openInstanceMenu"
>         >
>           <img
>             :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'"
>             alt=""
>             class="icon"
>           />
>         </button>
>       </div>
>       <div class="middle">
>         <MkA
>           v-click-anime
>           v-tooltip.noDelay.right="i18n.ts.timeline"
>           class="item index"
>           active-class="active"
>           to="/"
>           exact
>         >
>           <i class="icon fas fa-home fa-fw"></i
>           ><span class="text">{{ i18n.ts.timeline }}</span>
>         </MkA>
>         <template v-for="item in menu">
>           <div v-if="item === '-'" class="divider"></div>
>           <component
>             :is="navbarItemDef[item].to ? 'MkA' : 'button'"
>             v-else-if="
>               navbarItemDef[item] && navbarItemDef[item].show !== false
>             "
>             v-click-anime
>             v-tooltip.noDelay.right="i18n.ts[navbarItemDef[item].title]"
>             class="item _button"
>             :class="[item, { active: navbarItemDef[item].active }]"
>             active-class="active"
>             :to="navbarItemDef[item].to"
>             v-on="
>               navbarItemDef[item].action
>                 ? { click: navbarItemDef[item].action }
>                 : {}
>             "
>           >
>             <i class="icon fa-fw" :class="navbarItemDef[item].icon"></i
>             ><span class="text">{{ i18n.ts[navbarItemDef[item].title] }}</span>
>             <span v-if="navbarItemDef[item].indicated" class="indicator"
>               ><i class="icon fas fa-circle"></i
>             ></span>
>           </component>
>         </template>
>         <div class="divider"></div>
>         <MkA
>           v-if="$i.isAdmin || $i.isModerator"
>           v-click-anime
>           v-tooltip.noDelay.right="i18n.ts.controlPanel"
>           class="item"
>           active-class="active"
>           to="/admin"
>         >
>           <i class="icon fas fa-door-open fa-fw"></i
>           ><span class="text">{{ i18n.ts.controlPanel }}</span>
>         </MkA>
>         <button v-click-anime class="item _button" @click="more">
>           <i class="icon fa fa-ellipsis-h fa-fw"></i
>           ><span class="text">{{ i18n.ts.more }}</span>
>           <span v-if="otherMenuItemIndicated" class="indicator"
>             ><i class="icon fas fa-circle"></i
>           ></span>
>         </button>
>         <MkA
>           v-click-anime
>           v-tooltip.noDelay.right="i18n.ts.settings"
>           class="item"
>           active-class="active"
>           to="/settings"
>         >
>           <i class="icon fas fa-cog fa-fw"></i
>           ><span class="text">{{ i18n.ts.settings }}</span>
>         </MkA>
>       </div>
>       <div class="bottom">
>         <button
>           v-tooltip.noDelay.right="i18n.ts.note"
>           class="item _button post"
>           data-cy-open-post-form
>           @click="os.post"
>         >
>           <i class="icon fas fa-pencil-alt fa-fw"></i
>           ><span class="text">{{ i18n.ts.note }}</span>
>         </button>
>         <button
>           v-click-anime
>           v-tooltip.noDelay.right="`${i18n.ts.account}: @${$i.username}`"
>           class="item _button account"
>           @click="openAccountMenu"
>         >
>           <MkAvatar :user="$i" class="avatar" /><MkAcct
>             class="text"
>             :user="$i"
>           />
>         </button>
>       </div>
>     </div>
>   </div>
56,62c117,124
< import { computed, defineAsyncComponent, ref, watch } from 'vue';
< import { openInstanceMenu } from './common';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { $i, openAccountMenu as openAccountMenu_ } from '@/account';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
---
> import { computed, defineAsyncComponent, ref, watch } from "vue";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { $i, openAccountMenu as openAccountMenu_ } from "@/account";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> import { instance } from "@/instance";
> import { host } from "@/config";
68,72c130,134
< 	for (const def in navbarItemDef) {
< 		if (menu.value.includes(def)) continue;
< 		if (navbarItemDef[def].indicated) return true;
< 	}
< 	return false;
---
>   for (const def in navbarItemDef) {
>     if (menu.value.includes(def)) continue;
>     if (navbarItemDef[def].indicated) return true;
>   }
>   return false;
76c138,139
< 	iconOnly.value = (window.innerWidth <= 1279) || (defaultStore.state.menuDisplay === 'sideIcon');
---
>   iconOnly.value =
>     window.innerWidth <= 1279 || defaultStore.state.menuDisplay === "sideIcon";
81c144
< window.addEventListener('resize', calcViewState);
---
> window.addEventListener("resize", calcViewState);
84c147
< 	calcViewState();
---
>   calcViewState();
88,90c151,156
< 	openAccountMenu_({
< 		withExtraOperation: true,
< 	}, ev);
---
>   openAccountMenu_(
>     {
>       withExtraOperation: true,
>     },
>     ev
>   );
92a159,230
> function openInstanceMenu(ev: MouseEvent) {
>   os.popupMenu(
>     [
>       {
>         text: instance.name ?? host,
>         type: "label",
>       },
>       {
>         type: "link",
>         text: i18n.ts.instanceInfo,
>         icon: "fas fa-info-circle",
>         to: "/about",
>       },
>       {
>         type: "link",
>         text: i18n.ts.customEmojis,
>         icon: "fas fa-laugh",
>         to: "/about#emojis",
>       },
>       {
>         type: "link",
>         text: i18n.ts.federation,
>         icon: "fas fa-globe",
>         to: "/about#federation",
>       },
>       null,
>       {
>         type: "parent",
>         text: i18n.ts.help,
>         icon: "fas fa-question-circle",
>         children: [
>           {
>             type: "link",
>             to: "/mfm-cheat-sheet",
>             text: i18n.ts._mfm.cheatSheet,
>             icon: "fas fa-code",
>           },
>           {
>             type: "link",
>             to: "/scratchpad",
>             text: i18n.ts.scratchpad,
>             icon: "fas fa-terminal",
>           },
>           {
>             type: "link",
>             to: "/api-console",
>             text: "API Console",
>             icon: "fas fa-terminal",
>           },
>           null,
>           {
>             text: i18n.ts.document,
>             icon: "fas fa-question-circle",
>             action: () => {
>               window.open("https://misskey-hub.net/help.html", "_blank");
>             },
>           },
>         ],
>       },
>       {
>         type: "link",
>         text: i18n.ts.aboutMisskey,
>         to: "/about-misskey",
>       },
>     ],
>     ev.currentTarget ?? ev.target,
>     {
>       align: "left",
>     }
>   );
> }
> 
94,97c232,239
< 	os.popup(defineAsyncComponent(() => import('@/components/MkLaunchPad.vue')), {
< 		src: ev.currentTarget ?? ev.target,
< 	}, {
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(() => import("@/components/MkLaunchPad.vue")),
>     {
>       src: ev.currentTarget ?? ev.target,
>     },
>     {},
>     "closed"
>   );
103,104c245,246
< 	$nav-width: 250px;
< 	$nav-icon-only-width: 80px;
---
>   $nav-width: 250px;
>   $nav-icon-only-width: 80px;
106,108c248,250
< 	flex: 0 0 $nav-width;
< 	width: $nav-width;
< 	box-sizing: border-box;
---
>   flex: 0 0 $nav-width;
>   width: $nav-width;
>   box-sizing: border-box;
110,124c252,266
< 	> .body {
< 		position: fixed;
< 		top: 0;
< 		left: 0;
< 		z-index: 1001;
< 		width: $nav-icon-only-width;
< 		height: 100dvh;
< 		box-sizing: border-box;
< 		overflow: auto;
< 		overflow-x: clip;
< 		background: var(--navBg);
< 		contain: strict;
< 		display: flex;
< 		flex-direction: column;
< 	}
---
>   > .body {
>     position: fixed;
>     top: 0;
>     left: 0;
>     z-index: 1001;
>     width: $nav-icon-only-width;
>     height: 100dvh;
>     box-sizing: border-box;
>     overflow: auto;
>     overflow-x: clip;
>     background: var(--navBg);
>     contain: strict;
>     display: flex;
>     flex-direction: column;
>   }
126,128c268,270
< 	&:not(.iconOnly) {
< 		> .body {
< 			width: $nav-width;
---
>   &:not(.iconOnly) {
>     > .body {
>       width: $nav-width;
130,137c272,279
< 			> .top {
< 				position: sticky;
< 				top: 0;
< 				z-index: 1;
< 				padding: 20px 0;
< 				background: var(--X14);
< 				-webkit-backdrop-filter: var(--blur, blur(8px));
< 				backdrop-filter: var(--blur, blur(8px));
---
>       > .top {
>         position: sticky;
>         top: 0;
>         z-index: 1;
>         padding: 20px 0;
>         background: var(--X14);
>         -webkit-backdrop-filter: var(--blur, blur(8px));
>         backdrop-filter: var(--blur, blur(8px));
139,149c281,299
< 				> .banner {
< 					position: absolute;
< 					top: 0;
< 					left: 0;
< 					width: 100%;
< 					height: 100%;
< 					background-size: cover;
< 					background-position: center center;
< 					-webkit-mask-image: linear-gradient(0deg, rgba(0,0,0,0) 15%, rgba(0,0,0,0.75) 100%);
< 					mask-image: linear-gradient(0deg, rgba(0,0,0,0) 15%, rgba(0,0,0,0.75) 100%);
< 				}
---
>         > .banner {
>           position: absolute;
>           top: 0;
>           left: 0;
>           width: 100%;
>           height: 100%;
>           background-size: cover;
>           background-position: center center;
>           -webkit-mask-image: linear-gradient(
>             0deg,
>             rgba(0, 0, 0, 0) 15%,
>             rgba(0, 0, 0, 0.75) 100%
>           );
>           mask-image: linear-gradient(
>             0deg,
>             rgba(0, 0, 0, 0) 15%,
>             rgba(0, 0, 0, 0.75) 100%
>           );
>         }
151,155c301,305
< 				> .instance {
< 					position: relative;
< 					display: block;
< 					text-align: center;
< 					width: 100%;
---
>         > .instance {
>           position: relative;
>           display: block;
>           text-align: center;
>           width: 100%;
157,163c307,313
< 					> .icon {
< 						display: inline-block;
< 						width: 38px;
< 						aspect-ratio: 1;
< 					}
< 				}
< 			}
---
>           > .icon {
>             display: inline-block;
>             width: 38px;
>             aspect-ratio: 1;
>           }
>         }
>       }
165,171c315,321
< 			> .bottom {
< 				position: sticky;
< 				bottom: 0;
< 				padding: 20px 0;
< 				background: var(--X14);
< 				-webkit-backdrop-filter: var(--blur, blur(8px));
< 				backdrop-filter: var(--blur, blur(8px));
---
>       > .bottom {
>         position: sticky;
>         bottom: 0;
>         padding: 20px 0;
>         background: var(--X14);
>         -webkit-backdrop-filter: var(--blur, blur(8px));
>         backdrop-filter: var(--blur, blur(8px));
173,180c323,330
< 				> .post {
< 					position: relative;
< 					display: block;
< 					width: 100%;
< 					height: 40px;
< 					color: var(--fgOnAccent);
< 					font-weight: bold;
< 					text-align: left;
---
>         > .post {
>           position: relative;
>           display: block;
>           width: 100%;
>           height: 40px;
>           color: var(--fgOnAccent);
>           font-weight: bold;
>           text-align: left;
182,195c332,349
< 					&:before {
< 						content: "";
< 						display: block;
< 						width: calc(100% - 38px);
< 						height: 100%;
< 						margin: auto;
< 						position: absolute;
< 						top: 0;
< 						left: 0;
< 						right: 0;
< 						bottom: 0;
< 						border-radius: 999px;
< 						background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< 					}
---
>           &:before {
>             content: "";
>             display: block;
>             width: calc(100% - 38px);
>             height: 100%;
>             margin: auto;
>             position: absolute;
>             top: 0;
>             left: 0;
>             right: 0;
>             bottom: 0;
>             border-radius: 999px;
>             background: linear-gradient(
>               90deg,
>               var(--buttonGradateA),
>               var(--buttonGradateB)
>             );
>           }
197,201c351,356
< 					&:hover, &.active {
< 						&:before {
< 							background: var(--accentLighten);
< 						}
< 					}
---
>           &:hover,
>           &.active {
>             &:before {
>               background: var(--accentLighten);
>             }
>           }
203,208c358,363
< 					> .icon {
< 						position: relative;
< 						margin-left: 30px;
< 						margin-right: 8px;
< 						width: 32px;
< 					}
---
>           > .icon {
>             position: relative;
>             margin-left: 30px;
>             margin-right: 8px;
>             width: 32px;
>           }
210,213c365,368
< 					> .text {
< 						position: relative;
< 					}
< 				}
---
>           > .text {
>             position: relative;
>           }
>         }
215,226c370,381
< 				> .account {
< 					position: relative;
< 					display: flex;
< 					align-items: center;
< 					padding-left: 30px;
< 					text-overflow: ellipsis;
< 					overflow: hidden;
< 					white-space: nowrap;
< 					width: 100%;
< 					text-align: left;
< 					box-sizing: border-box;
< 					margin-top: 16px;
---
>         > .account {
>           position: relative;
>           display: flex;
>           align-items: center;
>           padding-left: 30px;
>           text-overflow: ellipsis;
>           overflow: hidden;
>           white-space: nowrap;
>           width: 100%;
>           text-align: left;
>           box-sizing: border-box;
>           margin-top: 16px;
228,235c383,390
< 					> .avatar {
< 						position: relative;
< 						width: 32px;
< 						aspect-ratio: 1;
< 						margin-right: 8px;
< 					}
< 				}
< 			}
---
>           > .avatar {
>             position: relative;
>             width: 32px;
>             aspect-ratio: 1;
>             margin-right: 8px;
>           }
>         }
>       }
237,238c392,393
< 			> .middle {
< 				flex: 1;
---
>       > .middle {
>         flex: 1;
240,243c395,398
< 				> .divider {
< 					margin: 16px 16px;
< 					border-top: solid 0.5px var(--divider);
< 				}
---
>         > .divider {
>           margin: 16px 16px;
>           border-top: solid 0.5px var(--divider);
>         }
245,256c400,411
< 				> .item {
< 					position: relative;
< 					display: block;
< 					padding-left: 30px;
< 					line-height: 2.85rem;
< 					text-overflow: ellipsis;
< 					overflow: hidden;
< 					white-space: nowrap;
< 					width: 100%;
< 					text-align: left;
< 					box-sizing: border-box;
< 					color: var(--navFg);
---
>         > .item {
>           position: relative;
>           display: block;
>           padding-left: 30px;
>           line-height: 2.85rem;
>           text-overflow: ellipsis;
>           overflow: hidden;
>           white-space: nowrap;
>           width: 100%;
>           text-align: left;
>           box-sizing: border-box;
>           color: var(--navFg);
258,262c413,417
< 					> .icon {
< 						position: relative;
< 						width: 32px;
< 						margin-right: 8px;
< 					}
---
>           > .icon {
>             position: relative;
>             width: 32px;
>             margin-right: 8px;
>           }
264,271c419,426
< 					> .indicator {
< 						position: absolute;
< 						top: 0;
< 						left: 20px;
< 						color: var(--navIndicator);
< 						font-size: 8px;
< 						animation: blink 1s infinite;
< 					}
---
>           > .indicator {
>             position: absolute;
>             top: 0;
>             left: 20px;
>             color: var(--navIndicator);
>             font-size: 8px;
>             animation: blink 1s infinite;
>           }
273,276c428,431
< 					> .text {
< 						position: relative;
< 						font-size: 0.9em;
< 					}
---
>           > .text {
>             position: relative;
>             font-size: 0.9em;
>           }
278,281c433,436
< 					&:hover {
< 						text-decoration: none;
< 						color: var(--navHoverFg);
< 					}
---
>           &:hover {
>             text-decoration: none;
>             color: var(--navHoverFg);
>           }
283,285c438,440
< 					&.active {
< 						color: var(--navActive);
< 					}
---
>           &.active {
>             color: var(--navActive);
>           }
287,288c442,444
< 					&:hover, &.active {
< 						color: var(--accent);
---
>           &:hover,
>           &.active {
>             color: var(--accent);
290,308c446,464
< 						&:before {
< 							content: "";
< 							display: block;
< 							width: calc(100% - 34px);
< 							height: 100%;
< 							margin: auto;
< 							position: absolute;
< 							top: 0;
< 							left: 0;
< 							right: 0;
< 							bottom: 0;
< 							border-radius: 999px;
< 							background: var(--accentedBg);
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
---
>             &:before {
>               content: "";
>               display: block;
>               width: calc(100% - 34px);
>               height: 100%;
>               margin: auto;
>               position: absolute;
>               top: 0;
>               left: 0;
>               right: 0;
>               bottom: 0;
>               border-radius: 999px;
>               background: var(--accentedBg);
>             }
>           }
>         }
>       }
>     }
>   }
310,312c466,468
< 	&.iconOnly {
< 		flex: 0 0 $nav-icon-only-width;
< 		width: $nav-icon-only-width;
---
>   &.iconOnly {
>     flex: 0 0 $nav-icon-only-width;
>     width: $nav-icon-only-width;
314,315c470,471
< 		> .body {
< 			width: $nav-icon-only-width;
---
>     > .body {
>       width: $nav-icon-only-width;
317,324c473,480
< 			> .top {
< 				position: sticky;
< 				top: 0;
< 				z-index: 1;
< 				padding: 20px 0;
< 				background: var(--X14);
< 				-webkit-backdrop-filter: var(--blur, blur(8px));
< 				backdrop-filter: var(--blur, blur(8px));
---
>       > .top {
>         position: sticky;
>         top: 0;
>         z-index: 1;
>         padding: 20px 0;
>         background: var(--X14);
>         -webkit-backdrop-filter: var(--blur, blur(8px));
>         backdrop-filter: var(--blur, blur(8px));
326,329c482,485
< 				> .instance {
< 					display: block;
< 					text-align: center;
< 					width: 100%;
---
>         > .instance {
>           display: block;
>           text-align: center;
>           width: 100%;
331,337c487,493
< 					> .icon {
< 						display: inline-block;
< 						width: 30px;
< 						aspect-ratio: 1;
< 					}
< 				}
< 			}
---
>           > .icon {
>             display: inline-block;
>             width: 30px;
>             aspect-ratio: 1;
>           }
>         }
>       }
339,345c495,501
< 			> .bottom {
< 				position: sticky;
< 				bottom: 0;
< 				padding: 20px 0;
< 				background: var(--X14);
< 				-webkit-backdrop-filter: var(--blur, blur(8px));
< 				backdrop-filter: var(--blur, blur(8px));
---
>       > .bottom {
>         position: sticky;
>         bottom: 0;
>         padding: 20px 0;
>         background: var(--X14);
>         -webkit-backdrop-filter: var(--blur, blur(8px));
>         backdrop-filter: var(--blur, blur(8px));
347,353c503,509
< 				> .post {
< 					display: block;
< 					position: relative;
< 					width: 100%;
< 					height: 52px;
< 					margin-bottom: 16px;
< 					text-align: center;
---
>         > .post {
>           display: block;
>           position: relative;
>           width: 100%;
>           height: 52px;
>           margin-bottom: 16px;
>           text-align: center;
355,368c511,528
< 					&:before {
< 						content: "";
< 						display: block;
< 						position: absolute;
< 						top: 0;
< 						left: 0;
< 						right: 0;
< 						bottom: 0;
< 						margin: auto;
< 						width: 52px;
< 						aspect-ratio: 1/1;
< 						border-radius: 100%;
< 						background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< 					}
---
>           &:before {
>             content: "";
>             display: block;
>             position: absolute;
>             top: 0;
>             left: 0;
>             right: 0;
>             bottom: 0;
>             margin: auto;
>             width: 52px;
>             aspect-ratio: 1/1;
>             border-radius: 100%;
>             background: linear-gradient(
>               90deg,
>               var(--buttonGradateA),
>               var(--buttonGradateB)
>             );
>           }
370,374c530,535
< 					&:hover, &.active {
< 						&:before {
< 							background: var(--accentLighten);
< 						}
< 					}
---
>           &:hover,
>           &.active {
>             &:before {
>               background: var(--accentLighten);
>             }
>           }
376,379c537,540
< 					> .icon {
< 						position: relative;
< 						color: var(--fgOnAccent);
< 					}
---
>           > .icon {
>             position: relative;
>             color: var(--fgOnAccent);
>           }
381,384c542,545
< 					> .text {
< 						display: none;
< 					}
< 				}
---
>           > .text {
>             display: none;
>           }
>         }
386,389c547,550
< 				> .account {
< 					display: block;
< 					text-align: center;
< 					width: 100%;
---
>         > .account {
>           display: block;
>           text-align: center;
>           width: 100%;
391,395c552,556
< 					> .avatar {
< 						display: inline-block;
< 						width: 38px;
< 						aspect-ratio: 1;
< 					}
---
>           > .avatar {
>             display: inline-block;
>             width: 38px;
>             aspect-ratio: 1;
>           }
397,401c558,562
< 					> .text {
< 						display: none;
< 					}
< 				}
< 			}
---
>           > .text {
>             display: none;
>           }
>         }
>       }
403,404c564,565
< 			> .middle {
< 				flex: 1;
---
>       > .middle {
>         flex: 1;
406,410c567,571
< 				> .divider {
< 					margin: 8px auto;
< 					width: calc(100% - 32px);
< 					border-top: solid 0.5px var(--divider);
< 				}
---
>         > .divider {
>           margin: 8px auto;
>           width: calc(100% - 32px);
>           border-top: solid 0.5px var(--divider);
>         }
412,417c573,578
< 				> .item {
< 					display: block;
< 					position: relative;
< 					padding: 18px 0;
< 					width: 100%;
< 					text-align: center;
---
>         > .item {
>           display: block;
>           position: relative;
>           padding: 18px 0;
>           width: 100%;
>           text-align: center;
419,423c580,584
< 					> .icon {
< 						display: block;
< 						margin: 0 auto;
< 						opacity: 0.7;
< 					}
---
>           > .icon {
>             display: block;
>             margin: 0 auto;
>             opacity: 0.7;
>           }
425,427c586,588
< 					> .text {
< 						display: none;
< 					}
---
>           > .text {
>             display: none;
>           }
429,436c590,597
< 					> .indicator {
< 						position: absolute;
< 						top: 6px;
< 						left: 24px;
< 						color: var(--navIndicator);
< 						font-size: 8px;
< 						animation: blink 1s infinite;
< 					}
---
>           > .indicator {
>             position: absolute;
>             top: 6px;
>             left: 24px;
>             color: var(--navIndicator);
>             font-size: 8px;
>             animation: blink 1s infinite;
>           }
438,440c599,602
< 					&:hover, &.active {
< 						text-decoration: none;
< 						color: var(--accent);
---
>           &:hover,
>           &.active {
>             text-decoration: none;
>             color: var(--accent);
442,455c604,617
< 						&:before {
< 							content: "";
< 							display: block;
< 							height: 100%;
< 							aspect-ratio: 1;
< 							margin: auto;
< 							position: absolute;
< 							top: 0;
< 							left: 0;
< 							right: 0;
< 							bottom: 0;
< 							border-radius: 999px;
< 							background: var(--accentedBg);
< 						}
---
>             &:before {
>               content: "";
>               display: block;
>               height: 100%;
>               aspect-ratio: 1;
>               margin: auto;
>               position: absolute;
>               top: 0;
>               left: 0;
>               right: 0;
>               bottom: 0;
>               border-radius: 999px;
>               background: var(--accentedBg);
>             }
457,464c619,627
< 						> .icon, > .text {
< 							opacity: 1;
< 						}
< 					}
< 				}
< 			}
< 		}
< 	}
---
>             > .icon,
>             > .text {
>               opacity: 1;
>             }
>           }
>         }
>       }
>     }
>   }
Only in misskeyV13/packages/frontend/src/ui/_common_: notification.vue
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/statusbar-federation.vue RiricaV13/ui/_common_/statusbar-federation.vue
2,19c2,37
< <span v-if="!fetching" class="nmidsaqw">
< 	<template v-if="display === 'marquee'">
< 		<Transition name="change" mode="default">
< 			<MarqueeText :key="key" :duration="marqueeDuration" :reverse="marqueeReverse">
< 				<span v-for="instance in instances" :key="instance.id" class="item" :class="{ colored }" :style="{ background: colored ? instance.themeColor : null }">
< 					<img class="icon" :src="getInstanceIcon(instance)" alt=""/>
< 					<MkA :to="`/instance-info/${instance.host}`" class="host _monospace">
< 						{{ instance.host }}
< 					</MkA>
< 					<span class="divider"></span>
< 				</span>
< 			</MarqueeText>
< 		</Transition>
< 	</template>
< 	<template v-else-if="display === 'oneByOne'">
< 		<!-- TODO -->
< 	</template>
< </span>
---
>   <span v-if="!fetching" class="nmidsaqw">
>     <template v-if="display === 'marquee'">
>       <transition name="change" mode="default">
>         <MarqueeText
>           :key="key"
>           :duration="marqueeDuration"
>           :reverse="marqueeReverse"
>         >
>           <span
>             v-for="instance in instances"
>             :key="instance.id"
>             class="item"
>             :class="{ colored }"
>             :style="{ background: colored ? instance.themeColor : null }"
>           >
>             <img
>               v-if="instance.iconUrl"
>               class="icon"
>               :src="instance.iconUrl"
>               alt=""
>             />
>             <MkA
>               :to="`/instance-info/${instance.host}`"
>               class="host _monospace"
>             >
>               {{ instance.host }}
>             </MkA>
>             <span class="divider"></span>
>           </span>
>         </MarqueeText>
>       </transition>
>     </template>
>     <template v-else-if="display === 'oneByOne'">
>       <!-- TODO -->
>     </template>
>   </span>
23,30c41,47
< import { computed, defineAsyncComponent, ref, toRef, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import MarqueeText from '@/components/MkMarquee.vue';
< import * as os from '@/os';
< import { useInterval } from '@/scripts/use-interval';
< import { getNoteSummary } from '@/scripts/get-note-summary';
< import { notePage } from '@/filters/note';
< import { getProxiedImageUrlNullable } from '@/scripts/media-proxy';
---
> import { computed, defineAsyncComponent, ref, toRef, watch } from "vue";
> import * as misskey from "misskey-js";
> import MarqueeText from "@/components/MkMarquee.vue";
> import * as os from "@/os";
> import { useInterval } from "@/scripts/use-interval";
> import { getNoteSummary } from "@/scripts/get-note-summary";
> import { notePage } from "@/filters/note";
33,38c50,55
< 	display?: 'marquee' | 'oneByOne';
< 	colored?: boolean;
< 	marqueeDuration?: number;
< 	marqueeReverse?: boolean;
< 	oneByOneInterval?: number;
< 	refreshIntervalSec?: number;
---
>   display?: "marquee" | "oneByOne";
>   colored?: boolean;
>   marqueeDuration?: number;
>   marqueeReverse?: boolean;
>   oneByOneInterval?: number;
>   refreshIntervalSec?: number;
46,53c63,70
< 	os.api('federation/instances', {
< 		sort: '+latestRequestReceivedAt',
< 		limit: 30,
< 	}).then(res => {
< 		instances.value = res;
< 		fetching.value = false;
< 		key++;
< 	});
---
>   os.api("federation/instances", {
>     sort: "+lastCommunicatedAt",
>     limit: 30,
>   }).then((res) => {
>     instances.value = res;
>     fetching.value = false;
>     key++;
>   });
57,58c74,75
< 	immediate: true,
< 	afterMounted: true,
---
>   immediate: true,
>   afterMounted: true,
60,63d76
< 
< function getInstanceIcon(instance): string {
< 	return getProxiedImageUrlNullable(instance.iconUrl, 'preview') ?? getProxiedImageUrlNullable(instance.faviconUrl, 'preview') ?? '/client-assets/dummy.png';
< }
67,69c80,83
< .change-enter-active, .change-leave-active {
< 	position: absolute;
< 	top: 0;
---
> .change-enter-active,
> .change-leave-active {
>   position: absolute;
>   top: 0;
74c88
< 	transform: translateY(-100%);
---
>   transform: translateY(-100%);
78c92
< 	transform: translateY(100%);
---
>   transform: translateY(100%);
82,83c96,97
< 	display: inline-block;
< 	position: relative;
---
>   display: inline-block;
>   position: relative;
85,88c99,102
< 	::v-deep(.item) {
< 		display: inline-block;
< 		vertical-align: bottom;
< 		margin-right: 5em;
---
>   ::v-deep(.item) {
>     display: inline-block;
>     vertical-align: bottom;
>     margin-right: 5em;
90,96c104,110
< 		> .icon {
< 			display: inline-block;
< 			height: var(--height);
< 			aspect-ratio: 1;
< 			vertical-align: bottom;
< 			margin-right: 1em;
< 		}
---
>     > .icon {
>       display: inline-block;
>       height: var(--height);
>       aspect-ratio: 1;
>       vertical-align: bottom;
>       margin-right: 1em;
>     }
98,100c112,114
< 		> .host {
< 			vertical-align: bottom;
< 		}
---
>     > .host {
>       vertical-align: bottom;
>     }
102,106c116,120
< 		&.colored {
< 			padding-right: 1em;
< 			color: #fff;
< 		}
< 	}
---
>     &.colored {
>       padding-right: 1em;
>       color: #fff;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/statusbar-rss.vue RiricaV13/ui/_common_/statusbar-rss.vue
2,15c2,26
< <span v-if="!fetching" class="xbhtxfms">
< 	<template v-if="display === 'marquee'">
< 		<Transition name="change" mode="default">
< 			<MarqueeText :key="key" :duration="marqueeDuration" :reverse="marqueeReverse">
< 				<span v-for="item in items" class="item">
< 					<a class="link" :href="item.link" rel="nofollow noopener" target="_blank" :title="item.title">{{ item.title }}</a><span class="divider"></span>
< 				</span>
< 			</MarqueeText>
< 		</Transition>
< 	</template>
< 	<template v-else-if="display === 'oneByOne'">
< 		<!-- TODO -->
< 	</template>
< </span>
---
>   <span v-if="!fetching" class="xbhtxfms">
>     <template v-if="display === 'marquee'">
>       <transition name="change" mode="default">
>         <MarqueeText
>           :key="key"
>           :duration="marqueeDuration"
>           :reverse="marqueeReverse"
>         >
>           <span v-for="item in items" class="item">
>             <a
>               class="link"
>               :href="item.link"
>               rel="nofollow noopener"
>               target="_blank"
>               :title="item.title"
>               >{{ item.title }}</a
>             ><span class="divider"></span>
>           </span>
>         </MarqueeText>
>       </transition>
>     </template>
>     <template v-else-if="display === 'oneByOne'">
>       <!-- TODO -->
>     </template>
>   </span>
19,23c30,34
< import { computed, defineAsyncComponent, ref, toRef, watch } from 'vue';
< import MarqueeText from '@/components/MkMarquee.vue';
< import * as os from '@/os';
< import { useInterval } from '@/scripts/use-interval';
< import { shuffle } from '@/scripts/shuffle';
---
> import { computed, defineAsyncComponent, ref, toRef, watch } from "vue";
> import MarqueeText from "@/components/MkMarquee.vue";
> import * as os from "@/os";
> import { useInterval } from "@/scripts/use-interval";
> import { shuffle } from "@/scripts/shuffle";
26,32c37,43
< 	url?: string;
< 	shuffle?: boolean;
< 	display?: 'marquee' | 'oneByOne';
< 	marqueeDuration?: number;
< 	marqueeReverse?: boolean;
< 	oneByOneInterval?: number;
< 	refreshIntervalSec?: number;
---
>   url?: string;
>   shuffle?: boolean;
>   display?: "marquee" | "oneByOne";
>   marqueeDuration?: number;
>   marqueeReverse?: boolean;
>   oneByOneInterval?: number;
>   refreshIntervalSec?: number;
40,49c51,60
< 	window.fetch(`/api/fetch-rss?url=${props.url}`, {}).then(res => {
< 		res.json().then(feed => {
< 			if (props.shuffle) {
< 				shuffle(feed.items);
< 			}
< 			items.value = feed.items;
< 			fetching.value = false;
< 			key++;
< 		});
< 	});
---
>   window.fetch(`/api/fetch-rss?url=${props.url}`, {}).then((res) => {
>     res.json().then((feed) => {
>       if (props.shuffle) {
>         shuffle(feed.items);
>       }
>       items.value = feed.items;
>       fetching.value = false;
>       key++;
>     });
>   });
53,54c64,65
< 	immediate: true,
< 	afterMounted: true,
---
>   immediate: true,
>   afterMounted: true,
59,61c70,73
< .change-enter-active, .change-leave-active {
< 	position: absolute;
< 	top: 0;
---
> .change-enter-active,
> .change-leave-active {
>   position: absolute;
>   top: 0;
66c78
< 	transform: translateY(-100%);
---
>   transform: translateY(-100%);
70c82
< 	transform: translateY(100%);
---
>   transform: translateY(100%);
74,75c86,87
< 	display: inline-block;
< 	position: relative;
---
>   display: inline-block;
>   position: relative;
77,81c89,93
< 	::v-deep(.item) {
< 		display: inline-flex;
< 		align-items: center;
< 		vertical-align: bottom;
< 		margin: 0;
---
>   ::v-deep(.item) {
>     display: inline-flex;
>     align-items: center;
>     vertical-align: bottom;
>     margin: 0;
83,91c95,103
< 		> .divider {
< 			display: inline-block;
< 			width: 0.5px;
< 			height: var(--height);
< 			margin: 0 3em;
< 			background: currentColor;
< 			opacity: 0.3;
< 		}
< 	}
---
>     > .divider {
>       display: inline-block;
>       width: 0.5px;
>       height: var(--height);
>       margin: 0 3em;
>       background: currentColor;
>       opacity: 0.3;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/statusbar-user-list.vue RiricaV13/ui/_common_/statusbar-user-list.vue
2,19c2,29
< <span v-if="!fetching" class="osdsvwzy">
< 	<template v-if="display === 'marquee'">
< 		<Transition name="change" mode="default">
< 			<MarqueeText :key="key" :duration="marqueeDuration" :reverse="marqueeReverse">
< 				<span v-for="note in notes" :key="note.id" class="item">
< 					<img class="avatar" :src="note.user.avatarUrl" decoding="async"/>
< 					<MkA class="text" :to="notePage(note)">
< 						<Mfm class="text" :text="getNoteSummary(note)" :plain="true" :nowrap="true"/>
< 					</MkA>
< 					<span class="divider"></span>
< 				</span>
< 			</MarqueeText>
< 		</Transition>
< 	</template>
< 	<template v-else-if="display === 'oneByOne'">
< 		<!-- TODO -->
< 	</template>
< </span>
---
>   <span v-if="!fetching" class="osdsvwzy">
>     <template v-if="display === 'marquee'">
>       <transition name="change" mode="default">
>         <MarqueeText
>           :key="key"
>           :duration="marqueeDuration"
>           :reverse="marqueeReverse"
>         >
>           <span v-for="note in notes" :key="note.id" class="item">
>             <img class="avatar" :src="note.user.avatarUrl" decoding="async" />
>             <MkA class="text" :to="notePage(note)">
>               <Mfm
>                 class="text"
>                 :text="getNoteSummary(note)"
>                 :plain="true"
>                 :nowrap="true"
>                 :custom-emojis="note.emojis"
>               />
>             </MkA>
>             <span class="divider"></span>
>           </span>
>         </MarqueeText>
>       </transition>
>     </template>
>     <template v-else-if="display === 'oneByOne'">
>       <!-- TODO -->
>     </template>
>   </span>
23,29c33,39
< import { computed, defineAsyncComponent, ref, toRef, watch } from 'vue';
< import * as misskey from 'misskey-js';
< import MarqueeText from '@/components/MkMarquee.vue';
< import * as os from '@/os';
< import { useInterval } from '@/scripts/use-interval';
< import { getNoteSummary } from '@/scripts/get-note-summary';
< import { notePage } from '@/filters/note';
---
> import { computed, defineAsyncComponent, ref, toRef, watch } from "vue";
> import * as misskey from "misskey-js";
> import MarqueeText from "@/components/MkMarquee.vue";
> import * as os from "@/os";
> import { useInterval } from "@/scripts/use-interval";
> import { getNoteSummary } from "@/scripts/get-note-summary";
> import { notePage } from "@/filters/note";
32,37c42,47
< 	userListId?: string;
< 	display?: 'marquee' | 'oneByOne';
< 	marqueeDuration?: number;
< 	marqueeReverse?: boolean;
< 	oneByOneInterval?: number;
< 	refreshIntervalSec?: number;
---
>   userListId?: string;
>   display?: "marquee" | "oneByOne";
>   marqueeDuration?: number;
>   marqueeReverse?: boolean;
>   oneByOneInterval?: number;
>   refreshIntervalSec?: number;
45,52c55,62
< 	if (props.userListId == null) return;
< 	os.api('notes/user-list-timeline', {
< 		listId: props.userListId,
< 	}).then(res => {
< 		notes.value = res;
< 		fetching.value = false;
< 		key++;
< 	});
---
>   if (props.userListId == null) return;
>   os.api("notes/user-list-timeline", {
>     listId: props.userListId,
>   }).then((res) => {
>     notes.value = res;
>     fetching.value = false;
>     key++;
>   });
58,59c68,69
< 	immediate: true,
< 	afterMounted: true,
---
>   immediate: true,
>   afterMounted: true,
64,66c74,77
< .change-enter-active, .change-leave-active {
< 	position: absolute;
< 	top: 0;
---
> .change-enter-active,
> .change-leave-active {
>   position: absolute;
>   top: 0;
71c82
< 	transform: translateY(-100%);
---
>   transform: translateY(-100%);
75c86
< 	transform: translateY(100%);
---
>   transform: translateY(100%);
79,80c90,91
< 	display: inline-block;
< 	position: relative;
---
>   display: inline-block;
>   position: relative;
82,86c93,97
< 	::v-deep(.item) {
< 		display: inline-flex;
< 		align-items: center;
< 		vertical-align: bottom;
< 		margin: 0;
---
>   ::v-deep(.item) {
>     display: inline-flex;
>     align-items: center;
>     vertical-align: bottom;
>     margin: 0;
88,94c99,105
< 		> .avatar {
< 			display: inline-block;
< 			height: var(--height);
< 			aspect-ratio: 1;
< 			vertical-align: bottom;
< 			margin-right: 8px;
< 		}
---
>     > .avatar {
>       display: inline-block;
>       height: var(--height);
>       aspect-ratio: 1;
>       vertical-align: bottom;
>       margin-right: 8px;
>     }
96,101c107,112
< 		> .text {
< 			> .text {
< 				display: inline-block;
< 				vertical-align: bottom;
< 			}
< 		}
---
>     > .text {
>       > .text {
>         display: inline-block;
>         vertical-align: bottom;
>       }
>     }
103,111c114,122
< 		> .divider {
< 			display: inline-block;
< 			width: 0.5px;
< 			height: 16px;
< 			margin: 0 3em;
< 			background: currentColor;
< 			opacity: 0;
< 		}
< 	}
---
>     > .divider {
>       display: inline-block;
>       width: 0.5px;
>       height: 16px;
>       margin: 0 3em;
>       background: currentColor;
>       opacity: 0;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/statusbars.vue RiricaV13/ui/_common_/statusbars.vue
2,17c2,48
< <div class="dlrsnxqu">
< 	<div
< 		v-for="x in defaultStore.reactiveState.statusbars.value" :key="x.id" class="item" :class="[{ black: x.black }, {
< 			verySmall: x.size === 'verySmall',
< 			small: x.size === 'small',
< 			medium: x.size === 'medium',
< 			large: x.size === 'large',
< 			veryLarge: x.size === 'veryLarge',
< 		}]"
< 	>
< 		<span class="name">{{ x.name }}</span>
< 		<XRss v-if="x.type === 'rss'" class="body" :refresh-interval-sec="x.props.refreshIntervalSec" :marquee-duration="x.props.marqueeDuration" :marquee-reverse="x.props.marqueeReverse" :display="x.props.display" :url="x.props.url" :shuffle="x.props.shuffle"/>
< 		<XFederation v-else-if="x.type === 'federation'" class="body" :refresh-interval-sec="x.props.refreshIntervalSec" :marquee-duration="x.props.marqueeDuration" :marquee-reverse="x.props.marqueeReverse" :display="x.props.display" :colored="x.props.colored"/>
< 		<XUserList v-else-if="x.type === 'userList'" class="body" :refresh-interval-sec="x.props.refreshIntervalSec" :marquee-duration="x.props.marqueeDuration" :marquee-reverse="x.props.marqueeReverse" :display="x.props.display" :user-list-id="x.props.userListId"/>
< 	</div>
< </div>
---
>   <div class="dlrsnxqu">
>     <div
>       v-for="x in defaultStore.reactiveState.statusbars.value"
>       :key="x.id"
>       class="item"
>       :class="[
>         { black: x.black },
>         {
>           verySmall: x.size === 'verySmall',
>           small: x.size === 'small',
>           medium: x.size === 'medium',
>           large: x.size === 'large',
>           veryLarge: x.size === 'veryLarge',
>         },
>       ]"
>     >
>       <span class="name">{{ x.name }}</span>
>       <XRss
>         v-if="x.type === 'rss'"
>         class="body"
>         :refresh-interval-sec="x.props.refreshIntervalSec"
>         :marquee-duration="x.props.marqueeDuration"
>         :marquee-reverse="x.props.marqueeReverse"
>         :display="x.props.display"
>         :url="x.props.url"
>         :shuffle="x.props.shuffle"
>       />
>       <XFederation
>         v-else-if="x.type === 'federation'"
>         class="body"
>         :refresh-interval-sec="x.props.refreshIntervalSec"
>         :marquee-duration="x.props.marqueeDuration"
>         :marquee-reverse="x.props.marqueeReverse"
>         :display="x.props.display"
>         :colored="x.props.colored"
>       />
>       <XUserList
>         v-else-if="x.type === 'userList'"
>         class="body"
>         :refresh-interval-sec="x.props.refreshIntervalSec"
>         :marquee-duration="x.props.marqueeDuration"
>         :marquee-reverse="x.props.marqueeReverse"
>         :display="x.props.display"
>         :user-list-id="x.props.userListId"
>       />
>     </div>
>   </div>
21,26c52,61
< import { computed, defineAsyncComponent, ref, toRef, watch } from 'vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< const XRss = defineAsyncComponent(() => import('./statusbar-rss.vue'));
< const XFederation = defineAsyncComponent(() => import('./statusbar-federation.vue'));
< const XUserList = defineAsyncComponent(() => import('./statusbar-user-list.vue'));
---
> import { computed, defineAsyncComponent, ref, toRef, watch } from "vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> const XRss = defineAsyncComponent(() => import("./statusbar-rss.vue"));
> const XFederation = defineAsyncComponent(
>   () => import("./statusbar-federation.vue")
> );
> const XUserList = defineAsyncComponent(
>   () => import("./statusbar-user-list.vue")
> );
31,32c66,67
< 	font-size: 15px;
< 	background: var(--panel);
---
>   font-size: 15px;
>   background: var(--panel);
34,37c69,72
< 	> .item {
< 		--height: 24px;
< 		--nameMargin: 10px;
< 		font-size: 0.85em;
---
>   > .item {
>     --height: 24px;
>     --nameMargin: 10px;
>     font-size: 0.85em;
39,43c74,78
< 		&.verySmall {
< 			--nameMargin: 7px;
< 			--height: 16px;
< 			font-size: 0.75em;
< 		}
---
>     &.verySmall {
>       --nameMargin: 7px;
>       --height: 16px;
>       font-size: 0.75em;
>     }
45,49c80,84
< 		&.small {
< 			--nameMargin: 8px;
< 			--height: 20px;
< 			font-size: 0.8em;
< 		}
---
>     &.small {
>       --nameMargin: 8px;
>       --height: 20px;
>       font-size: 0.8em;
>     }
51,55c86,90
< 		&.large {
< 			--nameMargin: 12px;
< 			--height: 26px;
< 			font-size: 0.875em;
< 		}
---
>     &.large {
>       --nameMargin: 12px;
>       --height: 26px;
>       font-size: 0.875em;
>     }
57,61c92,96
< 		&.veryLarge {
< 			--nameMargin: 14px;
< 			--height: 30px;
< 			font-size: 0.9em;
< 		}
---
>     &.veryLarge {
>       --nameMargin: 14px;
>       --height: 30px;
>       font-size: 0.9em;
>     }
63,69c98,104
< 		display: flex;
< 		vertical-align: bottom;
< 		width: 100%;
< 		line-height: var(--height);
< 		height: var(--height);
< 		overflow: clip;
< 		contain: strict;
---
>     display: flex;
>     vertical-align: bottom;
>     width: 100%;
>     line-height: var(--height);
>     height: var(--height);
>     overflow: clip;
>     contain: strict;
71,74c106,109
< 		> .name {
< 			padding: 0 var(--nameMargin);
< 			font-weight: bold;
< 			color: var(--accent);
---
>     > .name {
>       padding: 0 var(--nameMargin);
>       font-weight: bold;
>       color: var(--accent);
76,79c111,114
< 			&:empty {
< 				display: none;
< 			}
< 		}
---
>       &:empty {
>         display: none;
>       }
>     }
81,84c116,119
< 		> .body {
< 			min-width: 0;
< 			flex: 1;
< 		}
---
>     > .body {
>       min-width: 0;
>       flex: 1;
>     }
86,90c121,125
< 		&.black {
< 			background: #000;
< 			color: #fff;
< 		}
< 	}
---
>     &.black {
>       background: #000;
>       color: #fff;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/stream-indicator.vue RiricaV13/ui/_common_/stream-indicator.vue
2,8c2,14
< <div v-if="hasDisconnected && $store.state.serverDisconnectedBehavior === 'quiet'" :class="$style.root" class="_panel _shadow" @click="resetDisconnected">
< 	<div><i class="ti ti-alert-triangle"></i> {{ i18n.ts.disconnectedFromServer }}</div>
< 	<div :class="$style.command" class="_buttons">
< 		<MkButton :class="$style.commandButton" small primary @click="reload">{{ i18n.ts.reload }}</MkButton>
< 		<MkButton :class="$style.commandButton" small>{{ i18n.ts.doNothing }}</MkButton>
< 	</div>
< </div>
---
>   <div
>     v-if="
>       hasDisconnected && $store.state.serverDisconnectedBehavior === 'quiet'
>     "
>     class="nsbbhtug"
>     @click="resetDisconnected"
>   >
>     <div>{{ i18n.ts.disconnectedFromServer }}</div>
>     <div class="command">
>       <button class="_textButton" @click="reload">{{ i18n.ts.reload }}</button>
>       <button class="_textButton">{{ i18n.ts.doNothing }}</button>
>     </div>
>   </div>
12,16c18,20
< import { onUnmounted } from 'vue';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
< import MkButton from '@/components/MkButton.vue';
< import * as os from '@/os';
---
> import { onUnmounted } from "vue";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
18,19d21
< const zIndex = os.claimZIndex('high');
< 
23c25
< 	hasDisconnected = true;
---
>   hasDisconnected = true;
27c29
< 	hasDisconnected = false;
---
>   hasDisconnected = false;
31c33
< 	location.reload();
---
>   location.reload();
34c36
< stream.on('_disconnected_', onDisconnected);
---
> stream.on("_disconnected_", onDisconnected);
37c39
< 	stream.off('_disconnected_', onDisconnected);
---
>   stream.off("_disconnected_", onDisconnected);
41,51c43,56
< <style lang="scss" module>
< .root {
< 	position: fixed;
< 	z-index: v-bind(zIndex);
< 	bottom: calc(var(--minBottomSpacing) + var(--margin));
< 	right: var(--margin);
< 	margin: 0;
< 	padding: 12px;
< 	font-size: 0.9em;
< 	max-width: 320px;
< }
---
> <style lang="scss" scoped>
> .nsbbhtug {
>   position: fixed;
>   z-index: 16385;
>   bottom: 8px;
>   right: 8px;
>   margin: 0;
>   padding: 6px 12px;
>   font-size: 0.9em;
>   color: #fff;
>   background: #000;
>   opacity: 0.8;
>   border-radius: 4px;
>   max-width: 320px;
53,55c58,60
< .command {
< 	margin-top: 8px;
< }
---
>   > .command {
>     display: flex;
>     justify-content: space-around;
57c62,65
< .commandButton {
---
>     > button {
>       padding: 0.7em;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/sw-inject.ts RiricaV13/ui/_common_/sw-inject.ts
1,6c1,6
< import { inject } from 'vue';
< import { post } from '@/os';
< import { $i, login } from '@/account';
< import { defaultStore } from '@/store';
< import { getAccountFromId } from '@/scripts/get-account-from-id';
< import { mainRouter } from '@/router';
---
> import { inject } from "vue";
> import { post } from "@/os";
> import { $i, login } from "@/account";
> import { defaultStore } from "@/store";
> import { getAccountFromId } from "@/scripts/get-account-from-id";
> import { mainRouter } from "@/router";
9,12c9,12
< 	navigator.serviceWorker.addEventListener('message', ev => {
< 		if (_DEV_) {
< 			console.log('sw msg', ev.data);
< 		}
---
>   navigator.serviceWorker.addEventListener("message", (ev) => {
>     if (_DEV_) {
>       console.log("sw msg", ev.data);
>     }
14c14
< 		if (ev.data.type !== 'order') return;
---
>     if (ev.data.type !== "order") return;
16,21c16,21
< 		if (ev.data.loginId !== $i?.id) {
< 			return getAccountFromId(ev.data.loginId).then(account => {
< 				if (!account) return;
< 				return login(account.token, ev.data.url);
< 			});
< 		}
---
>     if (ev.data.loginId !== $i?.id) {
>       return getAccountFromId(ev.data.loginId).then((account) => {
>         if (!account) return;
>         return login(account.token, ev.data.url);
>       });
>     }
23,34c23,34
< 		switch (ev.data.order) {
< 			case 'post':
< 				return post(ev.data.options);
< 			case 'push':
< 				if (mainRouter.currentRoute.value.path === ev.data.url) {
< 					return window.scroll({ top: 0, behavior: 'smooth' });
< 				}
< 				return mainRouter.push(ev.data.url);
< 			default:
< 				return;
< 		}
< 	});
---
>     switch (ev.data.order) {
>       case "post":
>         return post(ev.data.options);
>       case "push":
>         if (mainRouter.currentRoute.value.path === ev.data.url) {
>           return window.scroll({ top: 0, behavior: "smooth" });
>         }
>         return mainRouter.push(ev.data.url);
>       default:
>         return;
>     }
>   });
diff --color=auto -r misskeyV13/packages/frontend/src/ui/_common_/upload.vue RiricaV13/ui/_common_/upload.vue
2,17c2,45
< <div class="mk-uploader _acrylic" :style="{ zIndex }">
< 	<ol v-if="uploads.length > 0">
< 		<li v-for="ctx in uploads" :key="ctx.id">
< 			<div class="img" :style="{ backgroundImage: `url(${ ctx.img })` }"></div>
< 			<div class="top">
< 				<p class="name"><MkLoading :em="true"/>{{ ctx.name }}</p>
< 				<p class="status">
< 					<span v-if="ctx.progressValue === undefined" class="initing">{{ i18n.ts.waiting }}<MkEllipsis/></span>
< 					<span v-if="ctx.progressValue !== undefined" class="kb">{{ String(Math.floor(ctx.progressValue / 1024)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') }}<i>KB</i> / {{ String(Math.floor(ctx.progressMax / 1024)).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') }}<i>KB</i></span>
< 					<span v-if="ctx.progressValue !== undefined" class="percentage">{{ Math.floor((ctx.progressValue / ctx.progressMax) * 100) }}</span>
< 				</p>
< 			</div>
< 			<progress :value="ctx.progressValue || 0" :max="ctx.progressMax || 0" :class="{ initing: ctx.progressValue === undefined, waiting: ctx.progressValue !== undefined && ctx.progressValue === ctx.progressMax }"></progress>
< 		</li>
< 	</ol>
< </div>
---
>   <div class="mk-uploader _acrylic" :style="{ zIndex }">
>     <ol v-if="uploads.length > 0">
>       <li v-for="ctx in uploads" :key="ctx.id">
>         <div class="img" :style="{ backgroundImage: `url(${ctx.img})` }"></div>
>         <div class="top">
>           <p class="name">
>             <i class="fas fa-spinner fa-pulse"></i>{{ ctx.name }}
>           </p>
>           <p class="status">
>             <span v-if="ctx.progressValue === undefined" class="initing"
>               >{{ i18n.ts.waiting }}<MkEllipsis
>             /></span>
>             <span v-if="ctx.progressValue !== undefined" class="kb"
>               >{{
>                 String(Math.floor(ctx.progressValue / 1024)).replace(
>                   /(\d)(?=(\d\d\d)+(?!\d))/g,
>                   "$1,"
>                 )
>               }}<i>KB</i> /
>               {{
>                 String(Math.floor(ctx.progressMax / 1024)).replace(
>                   /(\d)(?=(\d\d\d)+(?!\d))/g,
>                   "$1,"
>                 )
>               }}<i>KB</i></span
>             >
>             <span v-if="ctx.progressValue !== undefined" class="percentage">{{
>               Math.floor((ctx.progressValue / ctx.progressMax) * 100)
>             }}</span>
>           </p>
>         </div>
>         <progress
>           :value="ctx.progressValue || 0"
>           :max="ctx.progressMax || 0"
>           :class="{
>             initing: ctx.progressValue === undefined,
>             waiting:
>               ctx.progressValue !== undefined &&
>               ctx.progressValue === ctx.progressMax,
>           }"
>         ></progress>
>       </li>
>     </ol>
>   </div>
21,24c49,52
< import { } from 'vue';
< import * as os from '@/os';
< import { uploads } from '@/scripts/upload';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import * as os from "@/os";
> import { uploads } from "@/scripts/upload";
> import { i18n } from "@/i18n";
26c54
< const zIndex = os.claimZIndex('high');
---
> const zIndex = os.claimZIndex("high");
31,38c59,66
< 	position: fixed;
< 	right: 16px;
< 	width: 260px;
< 	top: 32px;
< 	padding: 16px 20px;
< 	pointer-events: none;
< 	box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
< 	border-radius: 8px;
---
>   position: fixed;
>   right: 16px;
>   width: 260px;
>   top: 32px;
>   padding: 16px 20px;
>   pointer-events: none;
>   box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
>   border-radius: 8px;
108c136
<   content: '%';
---
>   content: "%";
119,120c147,148
< 	width: 100%;
< 	height: 8px;
---
>   width: 100%;
>   height: 8px;
127c155
< 	background: transparent;
---
>   background: transparent;
diff --color=auto -r misskeyV13/packages/frontend/src/ui/classic.header.vue RiricaV13/ui/classic.header.vue
2,41c2,87
< <div class="azykntjl">
< 	<div class="body">
< 		<div class="left">
< 			<button v-click-anime class="item _button instance" @click="openInstanceMenu">
< 				<img :src="$instance.iconUrl ?? $instance.faviconUrl ?? '/favicon.ico'" class="_ghost"/>
< 			</button>
< 			<MkA v-click-anime v-tooltip="$ts.timeline" class="item index" active-class="active" to="/" exact>
< 				<i class="ti ti-home ti-fw"></i>
< 			</MkA>
< 			<template v-for="item in menu">
< 				<div v-if="item === '-'" class="divider"></div>
< 				<component :is="navbarItemDef[item].to ? 'MkA' : 'button'" v-else-if="navbarItemDef[item] && (navbarItemDef[item].show !== false)" v-click-anime v-tooltip="navbarItemDef[item].title" class="item _button" :class="item" active-class="active" :to="navbarItemDef[item].to" v-on="navbarItemDef[item].action ? { click: navbarItemDef[item].action } : {}">
< 					<i class="ti-fw" :class="navbarItemDef[item].icon"></i>
< 					<span v-if="navbarItemDef[item].indicated" class="indicator"><i class="_indicatorCircle"></i></span>
< 				</component>
< 			</template>
< 			<div class="divider"></div>
< 			<MkA v-if="$i.isAdmin || $i.isModerator" v-click-anime v-tooltip="$ts.controlPanel" class="item" active-class="active" to="/admin" :behavior="settingsWindowed ? 'modalWindow' : null">
< 				<i class="ti ti-dashboard ti-fw"></i>
< 			</MkA>
< 			<button v-click-anime class="item _button" @click="more">
< 				<i class="ti ti-dots ti-fw"></i>
< 				<span v-if="otherNavItemIndicated" class="indicator"><i class="_indicatorCircle"></i></span>
< 			</button>
< 		</div>
< 		<div class="right">
< 			<MkA v-click-anime v-tooltip="$ts.settings" class="item" active-class="active" to="/settings" :behavior="settingsWindowed ? 'modalWindow' : null">
< 				<i class="ti ti-settings ti-fw"></i>
< 			</MkA>
< 			<button v-click-anime class="item _button account" @click="openAccountMenu">
< 				<MkAvatar :user="$i" class="avatar"/><MkAcct class="acct" :user="$i"/>
< 			</button>
< 			<div class="post" @click="post">
< 				<MkButton class="button" gradate full rounded>
< 					<i class="ti ti-pencil ti-fw"></i>
< 				</MkButton>
< 			</div>
< 		</div>
< 	</div>
< </div>
---
>   <div class="azykntjl">
>     <div class="body">
>       <div class="left">
>         <MkA
>           v-click-anime
>           v-tooltip="$ts.timeline"
>           class="item index"
>           active-class="active"
>           to="/"
>           exact
>         >
>           <i class="fas fa-home fa-fw"></i>
>         </MkA>
>         <template v-for="item in menu">
>           <div v-if="item === '-'" class="divider"></div>
>           <component
>             :is="navbarItemDef[item].to ? 'MkA' : 'button'"
>             v-else-if="
>               navbarItemDef[item] && navbarItemDef[item].show !== false
>             "
>             v-click-anime
>             v-tooltip="$ts[navbarItemDef[item].title]"
>             class="item _button"
>             :class="item"
>             active-class="active"
>             :to="navbarItemDef[item].to"
>             v-on="
>               navbarItemDef[item].action
>                 ? { click: navbarItemDef[item].action }
>                 : {}
>             "
>           >
>             <i class="fa-fw" :class="navbarItemDef[item].icon"></i>
>             <span v-if="navbarItemDef[item].indicated" class="indicator"
>               ><i class="fas fa-circle"></i
>             ></span>
>           </component>
>         </template>
>         <div class="divider"></div>
>         <MkA
>           v-if="$i.isAdmin || $i.isModerator"
>           v-click-anime
>           v-tooltip="$ts.controlPanel"
>           class="item"
>           active-class="active"
>           to="/admin"
>           :behavior="settingsWindowed ? 'modalWindow' : null"
>         >
>           <i class="fas fa-door-open fa-fw"></i>
>         </MkA>
>         <button v-click-anime class="item _button" @click="more">
>           <i class="fas fa-ellipsis-h fa-fw"></i>
>           <span v-if="otherNavItemIndicated" class="indicator"
>             ><i class="fas fa-circle"></i
>           ></span>
>         </button>
>       </div>
>       <div class="right">
>         <MkA
>           v-click-anime
>           v-tooltip="$ts.settings"
>           class="item"
>           active-class="active"
>           to="/settings"
>           :behavior="settingsWindowed ? 'modalWindow' : null"
>         >
>           <i class="fas fa-cog fa-fw"></i>
>         </MkA>
>         <button
>           v-click-anime
>           class="item _button account"
>           @click="openAccountMenu"
>         >
>           <MkAvatar :user="$i" class="avatar" /><MkAcct
>             class="acct"
>             :user="$i"
>           />
>         </button>
>         <div class="post" @click="post">
>           <MkButton class="button" gradate full rounded>
>             <i class="fas fa-pencil-alt fa-fw"></i>
>           </MkButton>
>         </div>
>       </div>
>     </div>
>   </div>
45,52c91,97
< import { defineAsyncComponent, defineComponent } from 'vue';
< import { openInstanceMenu } from './_common_/common';
< import { host } from '@/config';
< import { search } from '@/scripts/search';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { openAccountMenu } from '@/account';
< import MkButton from '@/components/MkButton.vue';
---
> import { defineAsyncComponent, defineComponent } from "vue";
> import { host } from "@/config";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { openAccountMenu } from "@/account";
> import MkButton from "@/components/MkButton.vue";
55,57c100,102
< 	components: {
< 		MkButton,
< 	},
---
>   components: {
>     MkButton,
>   },
59,67c104,112
< 	data() {
< 		return {
< 			host: host,
< 			accounts: [],
< 			connection: null,
< 			navbarItemDef: navbarItemDef,
< 			settingsWindowed: false,
< 		};
< 	},
---
>   data() {
>     return {
>       host: host,
>       accounts: [],
>       connection: null,
>       navbarItemDef: navbarItemDef,
>       settingsWindowed: false,
>     };
>   },
69,72c114,117
< 	computed: {
< 		menu(): string[] {
< 			return this.$store.state.menu;
< 		},
---
>   computed: {
>     menu(): string[] {
>       return this.$store.state.menu;
>     },
74,81c119,126
< 		otherNavItemIndicated(): boolean {
< 			for (const def in this.navbarItemDef) {
< 				if (this.menu.includes(def)) continue;
< 				if (this.navbarItemDef[def].indicated) return true;
< 			}
< 			return false;
< 		},
< 	},
---
>     otherNavItemIndicated(): boolean {
>       for (const def in this.navbarItemDef) {
>         if (this.menu.includes(def)) continue;
>         if (this.navbarItemDef[def].indicated) return true;
>       }
>       return false;
>     },
>   },
83,87c128,132
< 	watch: {
< 		'$store.reactiveState.menuDisplay.value'() {
< 			this.calcViewState();
< 		},
< 	},
---
>   watch: {
>     "$store.reactiveState.menuDisplay.value"() {
>       this.calcViewState();
>     },
>   },
89,92c134,137
< 	created() {
< 		window.addEventListener('resize', this.calcViewState);
< 		this.calcViewState();
< 	},
---
>   created() {
>     window.addEventListener("resize", this.calcViewState);
>     this.calcViewState();
>   },
94,95c139,142
< 	methods: {
< 		openInstanceMenu,
---
>   methods: {
>     calcViewState() {
>       this.settingsWindowed = window.innerWidth > 1400;
>     },
97,99c144,146
< 		calcViewState() {
< 			this.settingsWindowed = (window.innerWidth > 1400);
< 		},
---
>     post() {
>       os.post();
>     },
101,103c148,150
< 		post() {
< 			os.post();
< 		},
---
>     search() {
>       search();
>     },
105,107c152,162
< 		search() {
< 			search();
< 		},
---
>     more(ev) {
>       os.popup(
>         defineAsyncComponent(() => import("@/components/MkLaunchPad.vue")),
>         {
>           src: ev.currentTarget ?? ev.target,
>           anchor: { x: "center", y: "bottom" },
>         },
>         {},
>         "closed"
>       );
>     },
109,122c164,172
< 		more(ev) {
< 			os.popup(defineAsyncComponent(() => import('@/components/MkLaunchPad.vue')), {
< 				src: ev.currentTarget ?? ev.target,
< 				anchor: { x: 'center', y: 'bottom' },
< 			}, {
< 			}, 'closed');
< 		},
< 
< 		openAccountMenu: (ev) => {
< 			openAccountMenu({
< 				withExtraOperation: true,
< 			}, ev);
< 		},
< 	},
---
>     openAccountMenu: (ev) => {
>       openAccountMenu(
>         {
>           withExtraOperation: true,
>         },
>         ev
>       );
>     },
>   },
128,130c178,180
< 	$height: 60px;
< 	$avatar-size: 32px;
< 	$avatar-margin: 8px;
---
>   $height: 60px;
>   $avatar-size: 32px;
>   $avatar-margin: 8px;
132,137c182,187
< 	position: sticky;
< 	top: 0;
< 	z-index: 1000;
< 	width: 100%;
< 	height: $height;
< 	background-color: var(--bg);
---
>   position: sticky;
>   top: 0;
>   z-index: 1000;
>   width: 100%;
>   height: $height;
>   background-color: var(--bg);
139,142c189,192
< 	> .body {
< 		max-width: 1380px;
< 		margin: 0 auto;
< 		display: flex;
---
>   > .body {
>     max-width: 1380px;
>     margin: 0 auto;
>     display: flex;
144,145c194,201
< 		> .right,
< 		> .left {
---
>     > .right,
>     > .left {
>       > .item {
>         position: relative;
>         font-size: 0.9em;
>         display: inline-block;
>         padding: 0 12px;
>         line-height: $height;
147,152c203,206
< 			> .item {
< 				position: relative;
< 				font-size: 0.9em;
< 				display: inline-block;
< 				padding: 0 12px;
< 				line-height: $height;
---
>         > i,
>         > .avatar {
>           margin-right: 0;
>         }
154,157c208,210
< 				> i,
< 				> .avatar {
< 					margin-right: 0;
< 				}
---
>         > i {
>           left: 10px;
>         }
159,161c212,216
< 				> i {
< 					left: 10px;
< 				}
---
>         > .avatar {
>           width: $avatar-size;
>           height: $avatar-size;
>           vertical-align: middle;
>         }
163,167c218,225
< 				> .avatar {
< 					width: $avatar-size;
< 					height: $avatar-size;
< 					vertical-align: middle;
< 				}
---
>         > .indicator {
>           position: absolute;
>           top: 0;
>           left: 0;
>           color: var(--navIndicator);
>           font-size: 8px;
>           animation: blink 1s infinite;
>         }
169,176c227,230
< 				> .indicator {
< 					position: absolute;
< 					top: 0;
< 					left: 0;
< 					color: var(--navIndicator);
< 					font-size: 8px;
< 					animation: blink 1s infinite;
< 				}
---
>         &:hover {
>           text-decoration: none;
>           color: var(--navHoverFg);
>         }
178,181c232,235
< 				&:hover {
< 					text-decoration: none;
< 					color: var(--navHoverFg);
< 				}
---
>         &.active {
>           color: var(--navActive);
>         }
>       }
183,186c237,242
< 				&.active {
< 					color: var(--navActive);
< 				}
< 			}
---
>       > .divider {
>         display: inline-block;
>         height: 16px;
>         margin: 0 10px;
>         border-right: solid 0.5px var(--divider);
>       }
188,193c244,245
< 			> .divider {
< 				display: inline-block;
< 				height: 16px;
< 				margin: 0 10px;
< 				border-right: solid 0.5px var(--divider);
< 			}
---
>       > .post {
>         display: inline-block;
195,200c247,253
< 			> .instance {
< 				display: inline-block;
< 				position: relative;
< 				width: 56px;
< 				height: 100%;
< 				vertical-align: bottom;
---
>         > .button {
>           width: 40px;
>           height: 40px;
>           padding: 0;
>           min-width: 0;
>         }
>       }
202,212c255,259
< 				> img {
< 					display: inline-block;
< 					width: 24px;
< 					position: absolute;
< 					top: 0;
< 					right: 0;
< 					bottom: 0;
< 					left: 0;
< 					margin: auto;
< 				}
< 			}
---
>       > .account {
>         display: inline-flex;
>         align-items: center;
>         vertical-align: top;
>         margin-right: 8px;
214,223c261,265
< 			> .post {
< 				display: inline-block;
< 			
< 				> .button {
< 					width: 40px;
< 					height: 40px;
< 					padding: 0;
< 					min-width: 0;
< 				}
< 			}
---
>         > .acct {
>           margin-left: 8px;
>         }
>       }
>     }
225,240c267,270
< 			> .account {
< 				display: inline-flex;
< 				align-items: center;
< 				vertical-align: top;
< 				margin-right: 8px;
< 
< 				> .acct {
< 					margin-left: 8px;
< 				}
< 			}
< 		}
< 
< 		> .right {
< 			margin-left: auto;
< 		}
< 	}
---
>     > .right {
>       margin-left: auto;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/classic.sidebar.vue RiricaV13/ui/classic.sidebar.vue
2,40c2,79
< <div class="npcljfve" :class="{ iconOnly }">
< 	<button v-click-anime class="item _button account" @click="openAccountMenu">
< 		<MkAvatar :user="$i" class="avatar"/><MkAcct class="text" :user="$i"/>
< 	</button>
< 	<div class="post" data-cy-open-post-form @click="post">
< 		<MkButton class="button" gradate full rounded>
< 			<i class="ti ti-pencil ti-fw"></i><span v-if="!iconOnly" class="text">{{ $ts.note }}</span>
< 		</MkButton>
< 	</div>
< 	<div class="divider"></div>
< 	<MkA v-click-anime class="item index" active-class="active" to="/" exact>
< 		<i class="ti ti-home ti-fw"></i><span class="text">{{ $ts.timeline }}</span>
< 	</MkA>
< 	<template v-for="item in menu">
< 		<div v-if="item === '-'" class="divider"></div>
< 		<component :is="navbarItemDef[item].to ? 'MkA' : 'button'" v-else-if="navbarItemDef[item] && (navbarItemDef[item].show !== false)" v-click-anime class="item _button" :class="item" active-class="active" :to="navbarItemDef[item].to" v-on="navbarItemDef[item].action ? { click: navbarItemDef[item].action } : {}">
< 			<i class="ti-fw" :class="navbarItemDef[item].icon"></i><span class="text">{{ navbarItemDef[item].title }}</span>
< 			<span v-if="navbarItemDef[item].indicated" class="indicator"><i class="_indicatorCircle"></i></span>
< 		</component>
< 	</template>
< 	<div class="divider"></div>
< 	<MkA v-if="$i.isAdmin || $i.isModerator" v-click-anime class="item" active-class="active" to="/admin" :behavior="settingsWindowed ? 'modalWindow' : null">
< 		<i class="ti ti-dashboard ti-fw"></i><span class="text">{{ $ts.controlPanel }}</span>
< 	</MkA>
< 	<button v-click-anime class="item _button" @click="more">
< 		<i class="ti ti-dots ti-fw"></i><span class="text">{{ $ts.more }}</span>
< 		<span v-if="otherNavItemIndicated" class="indicator"><i class="_indicatorCircle"></i></span>
< 	</button>
< 	<MkA v-click-anime class="item" active-class="active" to="/settings" :behavior="settingsWindowed ? 'modalWindow' : null">
< 		<i class="ti ti-settings ti-fw"></i><span class="text">{{ $ts.settings }}</span>
< 	</MkA>
< 	<div class="divider"></div>
< 	<div class="about">
< 		<button v-click-anime class="item _button" @click="openInstanceMenu">
< 			<img :src="$instance.iconUrl ?? $instance.faviconUrl ?? '/favicon.ico'" class="_ghost"/>
< 		</button>
< 	</div>
< 	<!--<MisskeyLogo class="misskey"/>-->
< </div>
---
>   <div class="npcljfve" :class="{ iconOnly }">
>     <button v-click-anime class="item _button account" @click="openAccountMenu">
>       <MkAvatar :user="$i" class="avatar" /><MkAcct class="text" :user="$i" />
>     </button>
>     <div class="post" data-cy-open-post-form @click="post">
>       <MkButton class="button" gradate full rounded>
>         <i class="fas fa-pencil-alt fa-fw"></i
>         ><span v-if="!iconOnly" class="text">{{ $ts.note }}</span>
>       </MkButton>
>     </div>
>     <div class="divider"></div>
>     <MkA v-click-anime class="item index" active-class="active" to="/" exact>
>       <i class="fas fa-home fa-fw"></i
>       ><span class="text">{{ $ts.timeline }}</span>
>     </MkA>
>     <template v-for="item in menu">
>       <div v-if="item === '-'" class="divider"></div>
>       <component
>         :is="navbarItemDef[item].to ? 'MkA' : 'button'"
>         v-else-if="navbarItemDef[item] && navbarItemDef[item].show !== false"
>         v-click-anime
>         class="item _button"
>         :class="item"
>         active-class="active"
>         :to="navbarItemDef[item].to"
>         v-on="
>           navbarItemDef[item].action
>             ? { click: navbarItemDef[item].action }
>             : {}
>         "
>       >
>         <i class="fa-fw" :class="navbarItemDef[item].icon"></i
>         ><span class="text">{{ $ts[navbarItemDef[item].title] }}</span>
>         <span v-if="navbarItemDef[item].indicated" class="indicator"
>           ><i class="fas fa-circle"></i
>         ></span>
>       </component>
>     </template>
>     <div class="divider"></div>
>     <MkA
>       v-if="$i.isAdmin || $i.isModerator"
>       v-click-anime
>       class="item"
>       active-class="active"
>       to="/admin"
>       :behavior="settingsWindowed ? 'modalWindow' : null"
>     >
>       <i class="fas fa-door-open fa-fw"></i
>       ><span class="text">{{ $ts.controlPanel }}</span>
>     </MkA>
>     <button v-click-anime class="item _button" @click="more">
>       <i class="fas fa-ellipsis-h fa-fw"></i
>       ><span class="text">{{ $ts.more }}</span>
>       <span v-if="otherNavItemIndicated" class="indicator"
>         ><i class="fas fa-circle"></i
>       ></span>
>     </button>
>     <MkA
>       v-click-anime
>       class="item"
>       active-class="active"
>       to="/settings"
>       :behavior="settingsWindowed ? 'modalWindow' : null"
>     >
>       <i class="fas fa-cog fa-fw"></i
>       ><span class="text">{{ $ts.settings }}</span>
>     </MkA>
>     <div class="divider"></div>
>     <div class="about">
>       <MkA v-click-anime class="link" to="/about">
>         <img
>           :src="$instance.iconUrl || $instance.faviconUrl || '/favicon.ico'"
>           class="_ghost"
>         />
>       </MkA>
>     </div>
>     <!--<MisskeyLogo class="misskey"/>-->
>   </div>
44,52c83,90
< import { defineAsyncComponent, defineComponent } from 'vue';
< import { openInstanceMenu } from './_common_/common';
< import { host } from '@/config';
< import { search } from '@/scripts/search';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { openAccountMenu } from '@/account';
< import MkButton from '@/components/MkButton.vue';
< import { StickySidebar } from '@/scripts/sticky-sidebar';
---
> import { defineAsyncComponent, defineComponent } from "vue";
> import { host } from "@/config";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { openAccountMenu } from "@/account";
> import MkButton from "@/components/MkButton.vue";
> import { StickySidebar } from "@/scripts/sticky-sidebar";
56,59c94,97
< 	components: {
< 		MkButton,
< 		//MisskeyLogo,
< 	},
---
>   components: {
>     MkButton,
>     //MisskeyLogo,
>   },
61,70c99,108
< 	data() {
< 		return {
< 			host: host,
< 			accounts: [],
< 			connection: null,
< 			navbarItemDef: navbarItemDef,
< 			iconOnly: false,
< 			settingsWindowed: false,
< 		};
< 	},
---
>   data() {
>     return {
>       host: host,
>       accounts: [],
>       connection: null,
>       navbarItemDef: navbarItemDef,
>       iconOnly: false,
>       settingsWindowed: false,
>     };
>   },
72,75c110,113
< 	computed: {
< 		menu(): string[] {
< 			return this.$store.state.menu;
< 		},
---
>   computed: {
>     menu(): string[] {
>       return this.$store.state.menu;
>     },
77,84c115,122
< 		otherNavItemIndicated(): boolean {
< 			for (const def in this.navbarItemDef) {
< 				if (this.menu.includes(def)) continue;
< 				if (this.navbarItemDef[def].indicated) return true;
< 			}
< 			return false;
< 		},
< 	},
---
>     otherNavItemIndicated(): boolean {
>       for (const def in this.navbarItemDef) {
>         if (this.menu.includes(def)) continue;
>         if (this.navbarItemDef[def].indicated) return true;
>       }
>       return false;
>     },
>   },
86,89c124,127
< 	watch: {
< 		'$store.reactiveState.menuDisplay.value'() {
< 			this.calcViewState();
< 		},
---
>   watch: {
>     "$store.reactiveState.menuDisplay.value"() {
>       this.calcViewState();
>     },
91,96c129,134
< 		iconOnly() {
< 			this.$nextTick(() => {
< 				this.$emit('change-view-mode');
< 			});
< 		},
< 	},
---
>     iconOnly() {
>       this.$nextTick(() => {
>         this.$emit("change-view-mode");
>       });
>     },
>   },
98,101c136,139
< 	created() {
< 		window.addEventListener('resize', this.calcViewState);
< 		this.calcViewState();
< 	},
---
>   created() {
>     window.addEventListener("resize", this.calcViewState);
>     this.calcViewState();
>   },
103,108c141,150
< 	mounted() {
< 		const sticky = new StickySidebar(this.$el.parentElement, 16);
< 		window.addEventListener('scroll', () => {
< 			sticky.calc(window.scrollY);
< 		}, { passive: true });
< 	},
---
>   mounted() {
>     const sticky = new StickySidebar(this.$el.parentElement, 16);
>     window.addEventListener(
>       "scroll",
>       () => {
>         sticky.calc(window.scrollY);
>       },
>       { passive: true }
>     );
>   },
110,111c152,158
< 	methods: {
< 		openInstanceMenu,
---
>   methods: {
>     calcViewState() {
>       this.iconOnly =
>         window.innerWidth <= 1400 ||
>         this.$store.state.menuDisplay === "sideIcon";
>       this.settingsWindowed = window.innerWidth > 1400;
>     },
113,116c160,162
< 		calcViewState() {
< 			this.iconOnly = (window.innerWidth <= 1400) || (this.$store.state.menuDisplay === 'sideIcon');
< 			this.settingsWindowed = (window.innerWidth > 1400);
< 		},
---
>     post() {
>       os.post();
>     },
118,120c164,166
< 		post() {
< 			os.post();
< 		},
---
>     search() {
>       search();
>     },
122,124c168,177
< 		search() {
< 			search();
< 		},
---
>     more(ev) {
>       os.popup(
>         defineAsyncComponent(() => import("@/components/MkLaunchPad.vue")),
>         {
>           src: ev.currentTarget ?? ev.target,
>         },
>         {},
>         "closed"
>       );
>     },
126,137c179,187
< 		more(ev) {
< 			os.popup(defineAsyncComponent(() => import('@/components/MkLaunchPad.vue')), {
< 				src: ev.currentTarget ?? ev.target,
< 			}, {}, 'closed');
< 		},
< 
< 		openAccountMenu: (ev) => {
< 			openAccountMenu({
< 				withExtraOperation: true,
< 			}, ev);
< 		},
< 	},
---
>     openAccountMenu: (ev) => {
>       openAccountMenu(
>         {
>           withExtraOperation: true,
>         },
>         ev
>       );
>     },
>   },
143,146c193,196
< 	$ui-font-size: 1em; // TODO: どこかに集約したい
< 	$nav-icon-only-width: 78px; // TODO: どこかに集約したい
< 	$avatar-size: 32px;
< 	$avatar-margin: 8px;
---
>   $ui-font-size: 1em; // TODO: どこかに集約したい
>   $nav-icon-only-width: 78px; // TODO: どこかに集約したい
>   $avatar-size: 32px;
>   $avatar-margin: 8px;
148,150c198,200
< 	padding: 0 16px;
< 	box-sizing: border-box;
< 	width: 260px;
---
>   padding: 0 16px;
>   box-sizing: border-box;
>   width: 260px;
152,154c202,204
< 	&.iconOnly {
< 		flex: 0 0 $nav-icon-only-width;
< 		width: $nav-icon-only-width !important;
---
>   &.iconOnly {
>     flex: 0 0 $nav-icon-only-width;
>     width: $nav-icon-only-width !important;
156,159c206,209
< 		> .divider {
< 			margin: 8px auto;
< 			width: calc(100% - 32px);
< 		}
---
>     > .divider {
>       margin: 8px auto;
>       width: calc(100% - 32px);
>     }
161,167c211,217
< 		> .post {
< 			> .button {
< 				width: 46px;
< 				height: 46px;
< 				padding: 0;
< 			}
< 		}
---
>     > .post {
>       > .button {
>         width: 46px;
>         height: 46px;
>         padding: 0;
>       }
>     }
169,174c219,224
< 		> .item {
< 			padding-left: 0;
< 			width: 100%;
< 			text-align: center;
< 			font-size: $ui-font-size * 1.1;
< 			line-height: 3.7rem;
---
>     > .item {
>       padding-left: 0;
>       width: 100%;
>       text-align: center;
>       font-size: $ui-font-size * 1.1;
>       line-height: 3.7rem;
176,179c226,229
< 			> i,
< 			> .avatar {
< 				margin-right: 0;
< 			}
---
>       > i,
>       > .avatar {
>         margin-right: 0;
>       }
181,183c231,233
< 			> i {
< 				left: 10px;
< 			}
---
>       > i {
>         left: 10px;
>       }
185,189c235,239
< 			> .text {
< 				display: none;
< 			}
< 		}
< 	}
---
>       > .text {
>         display: none;
>       }
>     }
>   }
191,194c241,244
< 	> .divider {
< 		margin: 10px 0;
< 		border-top: solid 0.5px var(--divider);
< 	}
---
>   > .divider {
>     margin: 10px 0;
>     border-top: solid 0.5px var(--divider);
>   }
196,201c246,251
< 	> .post {
< 		position: sticky;
< 		top: 0;
< 		z-index: 1;
< 		padding: 16px 0;
< 		background: var(--bg);
---
>   > .post {
>     position: sticky;
>     top: 0;
>     z-index: 1;
>     padding: 16px 0;
>     background: var(--bg);
203,206c253,256
< 		> .button {
< 			min-width: 0;
< 		}
< 	}
---
>     > .button {
>       min-width: 0;
>     }
>   }
208,211c258,261
< 	> .about {
< 		fill: currentColor;
< 		padding: 8px 0 16px 0;
< 		text-align: center;
---
>   > .about {
>     fill: currentColor;
>     padding: 8px 0 16px 0;
>     text-align: center;
213,216c263,266
< 		> .item {
< 			display: block;
< 			width: 32px;
< 			margin: 0 auto;
---
>     > .link {
>       display: block;
>       width: 32px;
>       margin: 0 auto;
218,223c268,273
< 			img {
< 				display: block;
< 				width: 100%;
< 			}
< 		}
< 	}
---
>       img {
>         display: block;
>         width: 100%;
>       }
>     }
>   }
225,235c275,285
< 	> .item {
< 		position: relative;
< 		display: block;
< 		font-size: $ui-font-size;
< 		line-height: 2.6rem;
< 		text-overflow: ellipsis;
< 		overflow: hidden;
< 		white-space: nowrap;
< 		width: 100%;
< 		text-align: left;
< 		box-sizing: border-box;
---
>   > .item {
>     position: relative;
>     display: block;
>     font-size: $ui-font-size;
>     line-height: 2.6rem;
>     text-overflow: ellipsis;
>     overflow: hidden;
>     white-space: nowrap;
>     width: 100%;
>     text-align: left;
>     box-sizing: border-box;
237,239c287,289
< 		> i {
< 			width: 32px;
< 		}
---
>     > i {
>       width: 32px;
>     }
241,244c291,294
< 		> i,
< 		> .avatar {
< 			margin-right: $avatar-margin;
< 		}
---
>     > i,
>     > .avatar {
>       margin-right: $avatar-margin;
>     }
246,250c296,300
< 		> .avatar {
< 			width: $avatar-size;
< 			height: $avatar-size;
< 			vertical-align: middle;
< 		}
---
>     > .avatar {
>       width: $avatar-size;
>       height: $avatar-size;
>       vertical-align: middle;
>     }
252,259c302,309
< 		> .indicator {
< 			position: absolute;
< 			top: 0;
< 			left: 0;
< 			color: var(--navIndicator);
< 			font-size: 8px;
< 			animation: blink 1s infinite;
< 		}
---
>     > .indicator {
>       position: absolute;
>       top: 0;
>       left: 0;
>       color: var(--navIndicator);
>       font-size: 8px;
>       animation: blink 1s infinite;
>     }
261,264c311,314
< 		&:hover {
< 			text-decoration: none;
< 			color: var(--navHoverFg);
< 		}
---
>     &:hover {
>       text-decoration: none;
>       color: var(--navHoverFg);
>     }
266,269c316,319
< 		&.active {
< 			color: var(--navActive);
< 		}
< 	}
---
>     &.active {
>       color: var(--navActive);
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/classic.vue RiricaV13/ui/classic.vue
2,3c2,10
< <div class="gbhvwtnk" :class="{ wallpaper }" :style="`--globalHeaderHeight:${globalHeaderHeight}px`">
< 	<XHeaderMenu v-if="showMenuOnTop" v-get-size="(w, h) => globalHeaderHeight = h"/>
---
>   <div
>     class="gbhvwtnk"
>     :class="{ wallpaper }"
>     :style="`--globalHeaderHeight:${globalHeaderHeight}px`"
>   >
>     <XHeaderMenu
>       v-if="showMenuOnTop"
>       v-get-size="(w, h) => (globalHeaderHeight = h)"
>     />
5,11c12,18
< 	<div class="columns" :class="{ fullView, withGlobalHeader: showMenuOnTop }">
< 		<div v-if="!showMenuOnTop" class="sidebar">
< 			<XSidebar/>
< 		</div>
< 		<div v-else ref="widgetsLeft" class="widgets left">
< 			<XWidgets place="left" :margin-top="'var(--margin)'" @mounted="attachSticky(widgetsLeft)"/>
< 		</div>
---
>     <div class="columns" :class="{ fullView, withGlobalHeader: showMenuOnTop }">
>       <div v-if="!showMenuOnTop" class="sidebar">
>         <XSidebar />
>       </div>
>       <div v-else ref="widgetsLeft" class="widgets left">
>         <XWidgets :place="'left'" @mounted="attachSticky(widgetsLeft)" />
>       </div>
13,17c20,28
< 		<main class="main" :style="{ background: pageMetadata?.value?.bg }" @contextmenu.stop="onContextmenu">
< 			<div class="content" style="container-type: inline-size;">
< 				<RouterView/>
< 			</div>
< 		</main>
---
>       <main
>         class="main"
>         :style="{ background: pageMetadata?.value?.bg }"
>         @contextmenu.stop="onContextmenu"
>       >
>         <div class="content">
>           <RouterView />
>         </div>
>       </main>
19,22c30,33
< 		<div v-if="isDesktop" ref="widgetsRight" class="widgets right">
< 			<XWidgets :place="showMenuOnTop ? 'right' : null" :margin-top="showMenuOnTop ? '0' : 'var(--margin)'" @mounted="attachSticky(widgetsRight)"/>
< 		</div>
< 	</div>
---
>       <div v-if="isDesktop" ref="widgetsRight" class="widgets right">
>         <XWidgets :place="null" @mounted="attachSticky(widgetsRight)" />
>       </div>
>     </div>
24,31c35,42
< 	<Transition :name="$store.state.animation ? 'tray-back' : ''">
< 		<div
< 			v-if="widgetsShowing"
< 			class="tray-back _modalBg"
< 			@click="widgetsShowing = false"
< 			@touchstart.passive="widgetsShowing = false"
< 		></div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'tray-back' : ''">
>       <div
>         v-if="widgetsShowing"
>         class="tray-back _modalBg"
>         @click="widgetsShowing = false"
>         @touchstart.passive="widgetsShowing = false"
>       ></div>
>     </transition>
33,35c44,46
< 	<Transition :name="$store.state.animation ? 'tray' : ''">
< 		<XWidgets v-if="widgetsShowing" class="tray"/>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'tray' : ''">
>       <XWidgets v-if="widgetsShowing" class="tray" />
>     </transition>
37c48,53
< 	<iframe v-if="$store.state.aiChanMode" ref="live2d" class="ivnzpscs" src="https://misskey-dev.github.io/mascot-web/?scale=2&y=1.4"></iframe>
---
>     <iframe
>       v-if="$store.state.aiChanMode"
>       ref="live2d"
>       class="ivnzpscs"
>       src="https://misskey-dev.github.io/mascot-web/?scale=2&y=1.4"
>     ></iframe>
39,40c55,56
< 	<XCommon/>
< </div>
---
>     <XCommon />
>   </div>
44,56c60,82
< import { defineAsyncComponent, markRaw, ComputedRef, ref, onMounted, provide } from 'vue';
< import XSidebar from './classic.sidebar.vue';
< import XCommon from './_common_/common.vue';
< import { instanceName } from '@/config';
< import { StickySidebar } from '@/scripts/sticky-sidebar';
< import * as os from '@/os';
< import { mainRouter } from '@/router';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import { defaultStore } from '@/store';
< import { i18n } from '@/i18n';
< import { miLocalStorage } from '@/local-storage';
< const XHeaderMenu = defineAsyncComponent(() => import('./classic.header.vue'));
< const XWidgets = defineAsyncComponent(() => import('./universal.widgets.vue'));
---
> import {
>   defineAsyncComponent,
>   markRaw,
>   ComputedRef,
>   ref,
>   onMounted,
>   provide,
> } from "vue";
> import XSidebar from "./classic.sidebar.vue";
> import XCommon from "./_common_/common.vue";
> import { instanceName } from "@/config";
> import { StickySidebar } from "@/scripts/sticky-sidebar";
> import * as os from "@/os";
> import { mainRouter } from "@/router";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
> import { defaultStore } from "@/store";
> import { i18n } from "@/i18n";
> const XHeaderMenu = defineAsyncComponent(() => import("./classic.header.vue"));
> const XWidgets = defineAsyncComponent(() => import("./classic.widgets.vue"));
66,68c92,94
< const wallpaper = miLocalStorage.getItem('wallpaper') != null;
< const showMenuOnTop = $computed(() => defaultStore.state.menuDisplay === 'top');
< let live2d = $shallowRef<HTMLIFrameElement>();
---
> const wallpaper = localStorage.getItem("wallpaper") != null;
> const showMenuOnTop = $computed(() => defaultStore.state.menuDisplay === "top");
> let live2d = $ref<HTMLIFrameElement>();
72c98
< provide('router', mainRouter);
---
> provide("router", mainRouter);
74,77c100,103
< 	pageMetadata = info;
< 	if (pageMetadata.value) {
< 		document.title = `${pageMetadata.value.title} | ${instanceName}`;
< 	}
---
>   pageMetadata = info;
>   if (pageMetadata.value) {
>     document.title = `${pageMetadata.value.title} | ${instanceName}`;
>   }
79,80c105,106
< provide('shouldHeaderThin', showMenuOnTop);
< provide('forceSpacerMin', true);
---
> provide("shouldHeaderThin", showMenuOnTop);
> provide("shouldSpacerMin", true);
83,86c109,120
< 	const sticky = new StickySidebar(el, 0, defaultStore.state.menuDisplay === 'top' ? 60 : 0); // TODO: ヘッダーの高さを60pxと決め打ちしているのを直す
< 	window.addEventListener('scroll', () => {
< 		sticky.calc(window.scrollY);
< 	}, { passive: true });
---
>   const sticky = new StickySidebar(
>     el,
>     defaultStore.state.menuDisplay === "top" ? 0 : 16,
>     defaultStore.state.menuDisplay === "top" ? 60 : 0
>   ); // TODO: ヘッダーの高さを60pxと決め打ちしているのを直す
>   window.addEventListener(
>     "scroll",
>     () => {
>       sticky.calc(window.scrollY);
>     },
>     { passive: true }
>   );
90c124
< 	window.scroll({ top: 0, behavior: 'smooth' });
---
>   window.scroll({ top: 0, behavior: "smooth" });
94,119c128,166
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target)) return;
< 	if (['INPUT', 'TEXTAREA', 'IMG', 'VIDEO', 'CANVAS'].includes(ev.target.tagName) || ev.target.attributes['contenteditable']) return;
< 	if (window.getSelection().toString() !== '') return;
< 	const path = mainRouter.getCurrentPath();
< 	os.contextMenu([{
< 		type: 'label',
< 		text: path,
< 	}, {
< 		icon: fullView ? 'fas fa-compress' : 'fas fa-expand',
< 		text: fullView ? i18n.ts.quitFullView : i18n.ts.fullView,
< 		action: () => {
< 			fullView = !fullView;
< 		},
< 	}, {
< 		icon: 'ti ti-window-maximize',
< 		text: i18n.ts.openInWindow,
< 		action: () => {
< 			os.pageWindow(path);
< 		},
< 	}], ev);
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target)) return;
>   if (
>     ["INPUT", "TEXTAREA", "IMG", "VIDEO", "CANVAS"].includes(
>       ev.target.tagName
>     ) ||
>     ev.target.attributes["contenteditable"]
>   )
>     return;
>   if (window.getSelection().toString() !== "") return;
>   const path = mainRouter.getCurrentPath();
>   os.contextMenu(
>     [
>       {
>         type: "label",
>         text: path,
>       },
>       {
>         icon: fullView ? "fas fa-compress" : "fas fa-expand",
>         text: fullView ? i18n.ts.quitFullView : i18n.ts.fullView,
>         action: () => {
>           fullView = !fullView;
>         },
>       },
>       {
>         icon: "fas fa-window-maximize",
>         text: i18n.ts.openInWindow,
>         action: () => {
>           os.pageWindow(path);
>         },
>       },
>     ],
>     ev
>   );
123c170
< 	//if (this.live2d) this.live2d.click(ev);
---
>   //if (this.live2d) this.live2d.click(ev);
127,128c174,175
< 	miLocalStorage.setItem('ui', 'default');
< 	location.reload();
---
>   localStorage.setItem("ui", "default");
>   location.reload();
131c178
< document.documentElement.style.overflowY = 'scroll';
---
> document.documentElement.style.overflowY = "scroll";
133,146c180,201
< defaultStore.ready.then(() => {
< 	if (defaultStore.state.widgets.length === 0) {
< 		defaultStore.set('widgets', [{
< 			name: 'calendar',
< 			id: 'a', place: null, data: {},
< 		}, {
< 			name: 'notifications',
< 			id: 'b', place: null, data: {},
< 		}, {
< 			name: 'trends',
< 			id: 'c', place: null, data: {},
< 		}]);
< 	}
< });
---
> if (defaultStore.state.widgets.length === 0) {
>   defaultStore.set("widgets", [
>     {
>       name: "calendar",
>       id: "a",
>       place: null,
>       data: {},
>     },
>     {
>       name: "notifications",
>       id: "b",
>       place: null,
>       data: {},
>     },
>     {
>       name: "trends",
>       id: "c",
>       place: null,
>       data: {},
>     },
>   ]);
> }
149,151c204,210
< 	window.addEventListener('resize', () => {
< 		isDesktop = (window.innerWidth >= DESKTOP_THRESHOLD);
< 	}, { passive: true });
---
>   window.addEventListener(
>     "resize",
>     () => {
>       isDesktop = window.innerWidth >= DESKTOP_THRESHOLD;
>     },
>     { passive: true }
>   );
153,173c212,246
< 	if (defaultStore.state.aiChanMode) {
< 		const iframeRect = live2d.getBoundingClientRect();
< 		window.addEventListener('mousemove', ev => {
< 			live2d.contentWindow.postMessage({
< 				type: 'moveCursor',
< 				body: {
< 					x: ev.clientX - iframeRect.left,
< 					y: ev.clientY - iframeRect.top,
< 				},
< 			}, '*');
< 		}, { passive: true });
< 		window.addEventListener('touchmove', ev => {
< 			live2d.contentWindow.postMessage({
< 				type: 'moveCursor',
< 				body: {
< 					x: ev.touches[0].clientX - iframeRect.left,
< 					y: ev.touches[0].clientY - iframeRect.top,
< 				},
< 			}, '*');
< 		}, { passive: true });
< 	}
---
>   if (defaultStore.state.aiChanMode) {
>     const iframeRect = live2d.getBoundingClientRect();
>     window.addEventListener(
>       "mousemove",
>       (ev) => {
>         live2d.contentWindow.postMessage(
>           {
>             type: "moveCursor",
>             body: {
>               x: ev.clientX - iframeRect.left,
>               y: ev.clientY - iframeRect.top,
>             },
>           },
>           "*"
>         );
>       },
>       { passive: true }
>     );
>     window.addEventListener(
>       "touchmove",
>       (ev) => {
>         live2d.contentWindow.postMessage(
>           {
>             type: "moveCursor",
>             body: {
>               x: ev.touches[0].clientX - iframeRect.left,
>               y: ev.touches[0].clientY - iframeRect.top,
>             },
>           },
>           "*"
>         );
>       },
>       { passive: true }
>     );
>   }
180,182c253,256
< 	opacity: 1;
< 	transform: translateX(0);
< 	transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1), opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
>   opacity: 1;
>   transform: translateX(0);
>   transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
186,187c260,261
< 	opacity: 0;
< 	transform: translateX(240px);
---
>   opacity: 0;
>   transform: translateX(240px);
192,193c266,267
< 	opacity: 1;
< 	transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
>   opacity: 1;
>   transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
197c271
< 	opacity: 0;
---
>   opacity: 0;
201,202c275,276
< 	$ui-font-size: 1em;
< 	$widgets-hide-threshold: 1200px;
---
>   $ui-font-size: 1em;
>   $widgets-hide-threshold: 1200px;
204,205c278,279
< 	min-height: 100dvh;
< 	box-sizing: border-box;
---
>   min-height: 100dvh;
>   box-sizing: border-box;
207,210c281,284
< 	&.wallpaper {
< 		background: var(--wallpaperOverlay);
< 		//backdrop-filter: var(--blur, blur(4px));
< 	}
---
>   &.wallpaper {
>     background: var(--wallpaperOverlay);
>     //backdrop-filter: var(--blur, blur(4px));
>   }
212,216c286,290
< 	> .columns {
< 		display: flex;
< 		justify-content: center;
< 		max-width: 100%;
< 		//margin: 32px 0;
---
>   > .columns {
>     display: flex;
>     justify-content: center;
>     max-width: 100%;
>     //margin: 32px 0;
218,223c292,293
< 		&.fullView {
< 			margin: 0;
< 		
< 			> .sidebar {
< 				display: none;
< 			}
---
>     &.fullView {
>       margin: 0;
225,227c295,297
< 			> .widgets {
< 				display: none;
< 			}
---
>       > .sidebar {
>         display: none;
>       }
229,235c299,301
< 			> .main {
< 				margin: 0;
< 				border-radius: 0;
< 				box-shadow: none;
< 				width: 100%;
< 			}
< 		}
---
>       > .widgets {
>         display: none;
>       }
237,246c303,309
< 		> .main {
< 			min-width: 0;
< 			width: 750px;
< 			margin: 0 16px 0 0;
< 			border-left: solid 1px var(--divider);
< 			border-right: solid 1px var(--divider);
< 			border-radius: 0;
< 			overflow: clip;
< 			--margin: 12px;
< 		}
---
>       > .main {
>         margin: 0;
>         border-radius: 0;
>         box-shadow: none;
>         width: 100%;
>       }
>     }
248,250c311,321
< 		> .widgets {
< 			//--panelBorder: none;
< 			width: 300px;
---
>     > .main {
>       min-width: 0;
>       width: 750px;
>       margin: 0 16px 0 0;
>       background: var(--panel);
>       border-left: solid 1px var(--divider);
>       border-right: solid 1px var(--divider);
>       border-radius: 0;
>       overflow: clip;
>       --margin: 12px;
>     }
252,254c323,326
< 			@media (max-width: $widgets-hide-threshold) {
< 				display: none;
< 			}
---
>     > .widgets {
>       //--panelBorder: none;
>       width: 300px;
>       margin-top: 16px;
256,259c328,330
< 			&.left {
< 				margin-right: 16px;
< 			}
< 		}
---
>       @media (max-width: $widgets-hide-threshold) {
>         display: none;
>       }
261,263c332,335
< 		> .sidebar {
< 			margin-top: 16px;
< 		}
---
>       &.left {
>         margin-right: 16px;
>       }
>     }
265,271c337,339
< 		&.withGlobalHeader {
< 			> .main {
< 				margin-top: 0;
< 				border: solid 1px var(--divider);
< 				border-radius: var(--radius);
< 				--stickyTop: var(--globalHeaderHeight);
< 			}
---
>     > .sidebar {
>       margin-top: 16px;
>     }
273,277c341,347
< 			> .widgets {
< 				--stickyTop: var(--globalHeaderHeight);
< 				margin-top: 0;
< 			}
< 		}
---
>     &.withGlobalHeader {
>       > .main {
>         margin-top: 0;
>         border: solid 1px var(--divider);
>         border-radius: var(--radius);
>         --stickyTop: var(--globalHeaderHeight);
>       }
279,280c349,353
< 		@media (max-width: 850px) {
< 			margin: 0;
---
>       > .widgets {
>         --stickyTop: var(--globalHeaderHeight);
>         margin-top: 0;
>       }
>     }
282,284c355,356
< 			> .sidebar {
< 				border-right: solid 0.5px var(--divider);
< 			}
---
>     @media (max-width: 850px) {
>       margin: 0;
286,293c358,360
< 			> .main {
< 				margin: 0;
< 				border-radius: 0;
< 				box-shadow: none;
< 				width: 100%;
< 			}
< 		}
< 	}
---
>       > .sidebar {
>         border-right: solid 0.5px var(--divider);
>       }
295,297c362,369
< 	> .tray-back {
< 		z-index: 1001;
< 	}
---
>       > .main {
>         margin: 0;
>         border-radius: 0;
>         box-shadow: none;
>         width: 100%;
>       }
>     }
>   }
299,309c371,373
< 	> .tray {
< 		position: fixed;
< 		top: 0;
< 		right: 0;
< 		z-index: 1001;
< 		height: 100dvh;
< 		padding: var(--margin);
< 		box-sizing: border-box;
< 		overflow: auto;
< 		background: var(--bg);
< 	}
---
>   > .tray-back {
>     z-index: 1001;
>   }
311,319c375,395
< 	> .ivnzpscs {
< 		position: fixed;
< 		bottom: 0;
< 		right: 0;
< 		width: 300px;
< 		height: 600px;
< 		border: none;
< 		pointer-events: none;
< 	}
---
>   > .tray {
>     position: fixed;
>     top: 0;
>     right: 0;
>     z-index: 1001;
>     height: 100dvh;
>     padding: var(--margin);
>     box-sizing: border-box;
>     overflow: auto;
>     background: var(--bg);
>   }
> 
>   > .ivnzpscs {
>     position: fixed;
>     bottom: 0;
>     right: 0;
>     width: 300px;
>     height: 600px;
>     border: none;
>     pointer-events: none;
>   }
Only in RiricaV13/ui: classic.widgets.vue
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/antenna-column.vue RiricaV13/ui/deck/antenna-column.vue
2,5c2,11
< <XColumn :menu="menu" :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header>
< 		<i class="ti ti-antenna"></i><span style="margin-left: 8px;">{{ column.name }}</span>
< 	</template>
---
>   <XColumn
>     :menu="menu"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header>
>       <i class="fas fa-satellite"></i
>       ><span style="margin-left: 8px">{{ column.name }}</span>
>     </template>
7,8c13,20
< 	<XTimeline v-if="column.antennaId" ref="timeline" src="antenna" :antenna="column.antennaId" @after="() => emit('loaded')"/>
< </XColumn>
---
>     <XTimeline
>       v-if="column.antennaId"
>       ref="timeline"
>       src="antenna"
>       :antenna="column.antennaId"
>       @after="() => emit('loaded')"
>     />
>   </XColumn>
12,17c24,29
< import { onMounted } from 'vue';
< import XColumn from './column.vue';
< import { updateColumn, Column } from './deck-store';
< import XTimeline from '@/components/MkTimeline.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { onMounted } from "vue";
> import XColumn from "./column.vue";
> import { updateColumn, Column } from "./deck-store";
> import XTimeline from "@/components/MkTimeline.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
20,21c32,33
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
25,26c37,38
< 	(ev: 'loaded'): void;
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "loaded"): void;
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
29c41
< let timeline = $shallowRef<InstanceType<typeof XTimeline>>();
---
> let timeline = $ref<InstanceType<typeof XTimeline>>();
32,34c44,46
< 	if (props.column.antennaId == null) {
< 		setAntenna();
< 	}
---
>   if (props.column.antennaId == null) {
>     setAntenna();
>   }
38,49c50,62
< 	const antennas = await os.api('antennas/list');
< 	const { canceled, result: antenna } = await os.select({
< 		title: i18n.ts.selectAntenna,
< 		items: antennas.map(x => ({
< 			value: x, text: x.name,
< 		})),
< 		default: props.column.antennaId,
< 	});
< 	if (canceled) return;
< 	updateColumn(props.column.id, {
< 		antennaId: antenna.id,
< 	});
---
>   const antennas = await os.api("antennas/list");
>   const { canceled, result: antenna } = await os.select({
>     title: i18n.ts.selectAntenna,
>     items: antennas.map((x) => ({
>       value: x,
>       text: x.name,
>     })),
>     default: props.column.antennaId,
>   });
>   if (canceled) return;
>   updateColumn(props.column.id, {
>     antennaId: antenna.id,
>   });
52,56c65,71
< const menu = [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.selectAntenna,
< 	action: setAntenna,
< }];
---
> const menu = [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.selectAntenna,
>     action: setAntenna,
>   },
> ];
67a83,84
> 
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/column-core.vue RiricaV13/ui/deck/column-core.vue
2,11c2,51
< <!-- TODO: リファクタの余地がありそう -->
< <div v-if="!column">たぶん見えちゃいけないやつ</div>
< <XMainColumn v-else-if="column.type === 'main'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XWidgetsColumn v-else-if="column.type === 'widgets'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XNotificationsColumn v-else-if="column.type === 'notifications'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XTlColumn v-else-if="column.type === 'tl'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XListColumn v-else-if="column.type === 'list'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XAntennaColumn v-else-if="column.type === 'antenna'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XMentionsColumn v-else-if="column.type === 'mentions'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
< <XDirectColumn v-else-if="column.type === 'direct'" :column="column" :is-stacked="isStacked" @parent-focus="emit('parent-focus', $event)"/>
---
>   <!-- TODO: リファクタの余地がありそう -->
>   <div v-if="!column">たぶん見えちゃいけないやつ</div>
>   <XMainColumn
>     v-else-if="column.type === 'main'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XWidgetsColumn
>     v-else-if="column.type === 'widgets'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XNotificationsColumn
>     v-else-if="column.type === 'notifications'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XTlColumn
>     v-else-if="column.type === 'tl'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XListColumn
>     v-else-if="column.type === 'list'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XAntennaColumn
>     v-else-if="column.type === 'antenna'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XMentionsColumn
>     v-else-if="column.type === 'mentions'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
>   <XDirectColumn
>     v-else-if="column.type === 'direct'"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="emit('parent-focus', $event)"
>   />
15,24c55,64
< import { } from 'vue';
< import XMainColumn from './main-column.vue';
< import XTlColumn from './tl-column.vue';
< import XAntennaColumn from './antenna-column.vue';
< import XListColumn from './list-column.vue';
< import XNotificationsColumn from './notifications-column.vue';
< import XWidgetsColumn from './widgets-column.vue';
< import XMentionsColumn from './mentions-column.vue';
< import XDirectColumn from './direct-column.vue';
< import { Column } from './deck-store';
---
> import {} from "vue";
> import XMainColumn from "./main-column.vue";
> import XTlColumn from "./tl-column.vue";
> import XAntennaColumn from "./antenna-column.vue";
> import XListColumn from "./list-column.vue";
> import XNotificationsColumn from "./notifications-column.vue";
> import XWidgetsColumn from "./widgets-column.vue";
> import XMentionsColumn from "./mentions-column.vue";
> import XDirectColumn from "./direct-column.vue";
> import { Column } from "./deck-store";
27,28c67,68
< 	column?: Column;
< 	isStacked: boolean;
---
>   column?: Column;
>   isStacked: boolean;
32c72
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/column.vue RiricaV13/ui/deck/column.vue
2,28c2,50
< <!-- sectionを利用しているのは、deck.vue側でcolumnに対してfirst-of-typeを効かせるため -->
< <section
< 	v-hotkey="keymap"
< 	:class="[$style.root, { [$style.paged]: isMainColumn, [$style.naked]: naked, [$style.active]: active, [$style.isStacked]: isStacked, [$style.draghover]: draghover, [$style.dragging]: dragging, [$style.dropready]: dropready }]"
< 	@dragover.prevent.stop="onDragover"
< 	@dragleave="onDragleave"
< 	@drop.prevent.stop="onDrop"
< >
< 	<header
< 		:class="[$style.header]"
< 		draggable="true"
< 		@click="goTop"
< 		@dragstart="onDragstart"
< 		@dragend="onDragend"
< 		@contextmenu.prevent.stop="onContextmenu"
< 	>
< 		<button v-if="isStacked && !isMainColumn" :class="$style.toggleActive" class="_button" @click="toggleActive">
< 			<template v-if="active"><i class="ti ti-chevron-up"></i></template>
< 			<template v-else><i class="ti ti-chevron-down"></i></template>
< 		</button>
< 		<span :class="$style.title"><slot name="header"></slot></span>
< 		<button v-tooltip="i18n.ts.settings" :class="$style.menu" class="_button" @click.stop="showSettingsMenu"><i class="ti ti-dots"></i></button>
< 	</header>
< 	<div v-show="active" ref="body" :class="$style.body">
< 		<slot></slot>
< 	</div>
< </section>
---
>   <!-- sectionを利用しているのは、deck.vue側でcolumnに対してfirst-of-typeを効かせるため -->
>   <section
>     v-hotkey="keymap"
>     class="dnpfarvg _narrow_"
>     :class="{
>       paged: isMainColumn,
>       naked,
>       active,
>       isStacked,
>       draghover,
>       dragging,
>       dropready,
>     }"
>     @dragover.prevent.stop="onDragover"
>     @dragleave="onDragleave"
>     @drop.prevent.stop="onDrop"
>   >
>     <header
>       :class="{ indicated }"
>       draggable="true"
>       @click="goTop"
>       @dragstart="onDragstart"
>       @dragend="onDragend"
>       @contextmenu.prevent.stop="onContextmenu"
>     >
>       <button
>         v-if="isStacked && !isMainColumn"
>         class="toggleActive _button"
>         @click="toggleActive"
>       >
>         <template v-if="active"><i class="fas fa-angle-up"></i></template>
>         <template v-else><i class="fas fa-angle-down"></i></template>
>       </button>
>       <div class="action">
>         <slot name="action"></slot>
>       </div>
>       <span class="header"><slot name="header"></slot></span>
>       <button
>         v-tooltip="i18n.ts.settings"
>         class="menu _button"
>         @click.stop="showSettingsMenu"
>       >
>         <i class="fas fa-ellipsis"></i>
>       </button>
>     </header>
>     <div v-show="active" ref="body">
>       <slot></slot>
>     </div>
>   </section>
32,36c54,70
< import { onBeforeUnmount, onMounted, provide, Ref, watch } from 'vue';
< import { updateColumn, swapLeftColumn, swapRightColumn, swapUpColumn, swapDownColumn, stackLeftColumn, popRightColumn, removeColumn, swapColumn, Column, deckStore } from './deck-store';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { MenuItem } from '@/types/menu';
---
> import { onBeforeUnmount, onMounted, provide, Ref, watch } from "vue";
> import {
>   updateColumn,
>   swapLeftColumn,
>   swapRightColumn,
>   swapUpColumn,
>   swapDownColumn,
>   stackLeftColumn,
>   popRightColumn,
>   removeColumn,
>   swapColumn,
>   Column,
>   deckStore,
> } from "./deck-store";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { MenuItem } from "@/types/menu";
38,40c72,74
< provide('shouldHeaderThin', true);
< provide('shouldOmitHeaderTitle', true);
< provide('forceSpacerMin', true);
---
> provide("shouldHeaderThin", true);
> provide("shouldOmitHeaderTitle", true);
> provide("shouldSpacerMin", true);
42,50c76,89
< const props = withDefaults(defineProps<{
< 	column: Column;
< 	isStacked?: boolean;
< 	naked?: boolean;
< 	menu?: MenuItem[];
< }>(), {
< 	isStacked: false,
< 	naked: false,
< });
---
> const props = withDefaults(
>   defineProps<{
>     column: Column;
>     isStacked?: boolean;
>     naked?: boolean;
>     indicated?: boolean;
>     menu?: MenuItem[];
>   }>(),
>   {
>     isStacked: false,
>     naked: false,
>     indicated: false,
>   }
> );
53,54c92,93
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
< 	(ev: 'change-active-state', v: boolean): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
>   (ev: "change-active-state", v: boolean): void;
57c96
< let body = $shallowRef<HTMLDivElement>();
---
> let body = $ref<HTMLDivElement>();
60c99,101
< watch($$(dragging), v => os.deckGlobalEvents.emit(v ? 'column.dragStart' : 'column.dragEnd'));
---
> watch($$(dragging), (v) =>
>   os.deckGlobalEvents.emit(v ? "column.dragStart" : "column.dragEnd")
> );
65c106
< const isMainColumn = $computed(() => props.column.type === 'main');
---
> const isMainColumn = $computed(() => props.column.type === "main");
67c108
< watch($$(active), v => emit('change-active-state', v));
---
> watch($$(active), (v) => emit("change-active-state", v));
70,73c111,114
< 	'shift+up': () => emit('parent-focus', 'up'),
< 	'shift+down': () => emit('parent-focus', 'down'),
< 	'shift+left': () => emit('parent-focus', 'left'),
< 	'shift+right': () => emit('parent-focus', 'right'),
---
>   "shift+up": () => emit("parent-focus", "up"),
>   "shift+down": () => emit("parent-focus", "down"),
>   "shift+left": () => emit("parent-focus", "left"),
>   "shift+right": () => emit("parent-focus", "right"),
77,78c118,119
< 	os.deckGlobalEvents.on('column.dragStart', onOtherDragStart);
< 	os.deckGlobalEvents.on('column.dragEnd', onOtherDragEnd);
---
>   os.deckGlobalEvents.on("column.dragStart", onOtherDragStart);
>   os.deckGlobalEvents.on("column.dragEnd", onOtherDragEnd);
82,83c123,124
< 	os.deckGlobalEvents.off('column.dragStart', onOtherDragStart);
< 	os.deckGlobalEvents.off('column.dragEnd', onOtherDragEnd);
---
>   os.deckGlobalEvents.off("column.dragStart", onOtherDragStart);
>   os.deckGlobalEvents.off("column.dragEnd", onOtherDragEnd);
87c128
< 	dropready = true;
---
>   dropready = true;
91c132
< 	dropready = false;
---
>   dropready = false;
95,98c136,139
< 	if (!props.isStacked) return;
< 	updateColumn(props.column.id, {
< 		active: !props.column.active,
< 	});
---
>   if (!props.isStacked) return;
>   updateColumn(props.column.id, {
>     active: !props.column.active,
>   });
102,174c143,233
< 	let items = [{
< 		icon: 'ti ti-settings',
< 		text: i18n.ts._deck.configureColumn,
< 		action: async () => {
< 			const { canceled, result } = await os.form(props.column.name, {
< 				name: {
< 					type: 'string',
< 					label: i18n.ts.name,
< 					default: props.column.name,
< 				},
< 				width: {
< 					type: 'number',
< 					label: i18n.ts.width,
< 					default: props.column.width,
< 				},
< 				flexible: {
< 					type: 'boolean',
< 					label: i18n.ts.flexible,
< 					default: props.column.flexible,
< 				},
< 			});
< 			if (canceled) return;
< 			updateColumn(props.column.id, result);
< 		},
< 	}, {
< 		type: 'parent',
< 		text: i18n.ts.move + '...',
< 		icon: 'ti ti-arrows-move',
< 		children: [{
< 			icon: 'ti ti-arrow-left',
< 			text: i18n.ts._deck.swapLeft,
< 			action: () => {
< 				swapLeftColumn(props.column.id);
< 			},
< 		}, {
< 			icon: 'ti ti-arrow-right',
< 			text: i18n.ts._deck.swapRight,
< 			action: () => {
< 				swapRightColumn(props.column.id);
< 			},
< 		}, props.isStacked ? {
< 			icon: 'ti ti-arrow-up',
< 			text: i18n.ts._deck.swapUp,
< 			action: () => {
< 				swapUpColumn(props.column.id);
< 			},
< 		} : undefined, props.isStacked ? {
< 			icon: 'ti ti-arrow-down',
< 			text: i18n.ts._deck.swapDown,
< 			action: () => {
< 				swapDownColumn(props.column.id);
< 			},
< 		} : undefined],
< 	}, {
< 		icon: 'ti ti-stack-2',
< 		text: i18n.ts._deck.stackLeft,
< 		action: () => {
< 			stackLeftColumn(props.column.id);
< 		},
< 	}, props.isStacked ? {
< 		icon: 'ti ti-window-maximize',
< 		text: i18n.ts._deck.popRight,
< 		action: () => {
< 			popRightColumn(props.column.id);
< 		},
< 	} : undefined, null, {
< 		icon: 'ti ti-trash',
< 		text: i18n.ts.remove,
< 		danger: true,
< 		action: () => {
< 			removeColumn(props.column.id);
< 		},
< 	}];
---
>   let items = [
>     {
>       icon: "fas fa-cog",
>       text: i18n.ts._deck.configureColumn,
>       action: async () => {
>         const { canceled, result } = await os.form(props.column.name, {
>           name: {
>             type: "string",
>             label: i18n.ts.name,
>             default: props.column.name,
>           },
>           width: {
>             type: "number",
>             label: i18n.ts.width,
>             default: props.column.width,
>           },
>           flexible: {
>             type: "boolean",
>             label: i18n.ts.flexible,
>             default: props.column.flexible,
>           },
>         });
>         if (canceled) return;
>         updateColumn(props.column.id, result);
>       },
>     },
>     {
>       type: "parent",
>       text: i18n.ts.move + "...",
>       icon: "fas fa-arrows-up-down-left-right",
>       children: [
>         {
>           icon: "fas fa-arrow-left",
>           text: i18n.ts._deck.swapLeft,
>           action: () => {
>             swapLeftColumn(props.column.id);
>           },
>         },
>         {
>           icon: "fas fa-arrow-right",
>           text: i18n.ts._deck.swapRight,
>           action: () => {
>             swapRightColumn(props.column.id);
>           },
>         },
>         props.isStacked
>           ? {
>               icon: "fas fa-arrow-up",
>               text: i18n.ts._deck.swapUp,
>               action: () => {
>                 swapUpColumn(props.column.id);
>               },
>             }
>           : undefined,
>         props.isStacked
>           ? {
>               icon: "fas fa-arrow-down",
>               text: i18n.ts._deck.swapDown,
>               action: () => {
>                 swapDownColumn(props.column.id);
>               },
>             }
>           : undefined,
>       ],
>     },
>     {
>       icon: "fas fa-window-restore",
>       text: i18n.ts._deck.stackLeft,
>       action: () => {
>         stackLeftColumn(props.column.id);
>       },
>     },
>     props.isStacked
>       ? {
>           icon: "fas fa-window-maximize",
>           text: i18n.ts._deck.popRight,
>           action: () => {
>             popRightColumn(props.column.id);
>           },
>         }
>       : undefined,
>     null,
>     {
>       icon: "fas fa-trash-alt",
>       text: i18n.ts.remove,
>       danger: true,
>       action: () => {
>         removeColumn(props.column.id);
>       },
>     },
>   ];
176,179c235,238
< 	if (props.menu) {
< 		items.unshift(null);
< 		items = props.menu.concat(items);
< 	}
---
>   if (props.menu) {
>     items.unshift(null);
>     items = props.menu.concat(items);
>   }
181c240
< 	return items;
---
>   return items;
185c244
< 	os.popupMenu(getMenu(), ev.currentTarget ?? ev.target);
---
>   os.popupMenu(getMenu(), ev.currentTarget ?? ev.target);
189c248
< 	os.contextMenu(getMenu(), ev);
---
>   os.contextMenu(getMenu(), ev);
193,196c252,255
< 	body.scrollTo({
< 		top: 0,
< 		behavior: 'smooth',
< 	});
---
>   body.scrollTo({
>     top: 0,
>     behavior: "smooth",
>   });
200,201c259,260
< 	ev.dataTransfer.effectAllowed = 'move';
< 	ev.dataTransfer.setData(_DATA_TRANSFER_DECK_COLUMN_, props.column.id);
---
>   ev.dataTransfer.effectAllowed = "move";
>   ev.dataTransfer.setData(_DATA_TRANSFER_DECK_COLUMN_, props.column.id);
203,207c262,266
< 	// Chromeのバグで、Dragstartハンドラ内ですぐにDOMを変更する(=リアクティブなプロパティを変更する)とDragが終了してしまう
< 	// SEE: https://stackoverflow.com/questions/19639969/html5-dragend-event-firing-immediately
< 	window.setTimeout(() => {
< 		dragging = true;
< 	}, 10);
---
>   // Chromeのバグで、Dragstartハンドラ内ですぐにDOMを変更する(=リアクティブなプロパティを変更する)とDragが終了してしまう
>   // SEE: https://stackoverflow.com/questions/19639969/html5-dragend-event-firing-immediately
>   window.setTimeout(() => {
>     dragging = true;
>   }, 10);
211c270
< 	dragging = false;
---
>   dragging = false;
215,220c274,280
< 	// 自分自身がドラッグされている場合
< 	if (dragging) {
< 		// 自分自身にはドロップさせない
< 		ev.dataTransfer.dropEffect = 'none';
< 	} else {
< 		const isDeckColumn = ev.dataTransfer.types[0] === _DATA_TRANSFER_DECK_COLUMN_;
---
>   // 自分自身がドラッグされている場合
>   if (dragging) {
>     // 自分自身にはドロップさせない
>     ev.dataTransfer.dropEffect = "none";
>   } else {
>     const isDeckColumn =
>       ev.dataTransfer.types[0] === _DATA_TRANSFER_DECK_COLUMN_;
222c282
< 		ev.dataTransfer.dropEffect = isDeckColumn ? 'move' : 'none';
---
>     ev.dataTransfer.dropEffect = isDeckColumn ? "move" : "none";
224,225c284,285
< 		if (isDeckColumn) draghover = true;
< 	}
---
>     if (isDeckColumn) draghover = true;
>   }
229c289
< 	draghover = false;
---
>   draghover = false;
233,234c293,294
< 	draghover = false;
< 	os.deckGlobalEvents.emit('column.dragEnd');
---
>   draghover = false;
>   os.deckGlobalEvents.emit("column.dragEnd");
236,239c296,299
< 	const id = ev.dataTransfer.getData(_DATA_TRANSFER_DECK_COLUMN_);
< 	if (id != null && id !== '') {
< 		swapColumn(props.column.id, id);
< 	}
---
>   const id = ev.dataTransfer.getData(_DATA_TRANSFER_DECK_COLUMN_);
>   if (id != null && id !== "") {
>     swapColumn(props.column.id, id);
>   }
243,246c303,306
< <style lang="scss" module>
< .root {
< 	--root-margin: 10px;
< 	--deckColumnHeaderHeight: 40px;
---
> <style lang="scss" scoped>
> .dnpfarvg {
>   --root-margin: 10px;
>   --deckColumnHeaderHeight: 42px;
248,250c308,310
< 	height: 100%;
< 	overflow: clip;
< 	contain: strict;
---
>   height: 100%;
>   overflow: hidden;
>   contain: strict;
252,264c312,324
< 	&.draghover {
< 		&:after {
< 			content: "";
< 			display: block;
< 			position: absolute;
< 			z-index: 1000;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: var(--focus);
< 		}
< 	}
---
>   &.draghover {
>     &:after {
>       content: "";
>       display: block;
>       position: absolute;
>       z-index: 1000;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: var(--focus);
>     }
>   }
266,279c326,339
< 	&.dragging {
< 		&:after {
< 			content: "";
< 			display: block;
< 			position: absolute;
< 			z-index: 1000;
< 			top: 0;
< 			left: 0;
< 			width: 100%;
< 			height: 100%;
< 			background: var(--focus);
< 			opacity: 0.5;
< 		}
< 	}
---
>   &.dragging {
>     &:after {
>       content: "";
>       display: block;
>       position: absolute;
>       z-index: 1000;
>       top: 0;
>       left: 0;
>       width: 100%;
>       height: 100%;
>       background: var(--focus);
>       opacity: 0.5;
>     }
>   }
281,285c341,345
< 	&.dropready {
< 		* {
< 			pointer-events: none;
< 		}
< 	}
---
>   &.dropready {
>     * {
>       pointer-events: none;
>     }
>   }
287,290c347,349
< 	&:not(.active) {
< 		flex-basis: var(--deckColumnHeaderHeight);
< 		min-height: var(--deckColumnHeaderHeight);
< 	}
---
>   &:not(.active) {
>     flex-basis: var(--deckColumnHeaderHeight);
>     min-height: var(--deckColumnHeaderHeight);
292,295c351,354
< 	&.naked {
< 		background: var(--acrylicBg) !important;
< 		-webkit-backdrop-filter: var(--blur, blur(10px));
< 		backdrop-filter: var(--blur, blur(10px));
---
>     > header.indicated {
>       box-shadow: 4px 0px var(--accent) inset;
>     }
>   }
297,302c356,359
< 		> .header {
< 			background: transparent;
< 			box-shadow: none;
< 			color: var(--fg);
< 		}
< 	}
---
>   &.naked {
>     background: var(--acrylicBg) !important;
>     -webkit-backdrop-filter: var(--blur, blur(10px));
>     backdrop-filter: var(--blur, blur(10px));
304,307c361,363
< 	&.paged {
< 		background: var(--bg) !important;
< 	}
< }
---
>     > header {
>       background: transparent;
>       box-shadow: none;
309,320c365,369
< .header {
< 	position: relative;
< 	display: flex;
< 	z-index: 2;
< 	line-height: var(--deckColumnHeaderHeight);
< 	height: var(--deckColumnHeaderHeight);
< 	padding: 0 16px;
< 	font-size: 0.9em;
< 	color: var(--panelHeaderFg);
< 	background: var(--panelHeaderBg);
< 	box-shadow: 0 1px 0 0 var(--panelHeaderDivider);
< 	cursor: pointer;
---
>       > button {
>         color: var(--fg);
>       }
>     }
>   }
322,325c371,373
< 	&, * {
< 		user-select: none;
< 	}
< }
---
>   &.paged {
>     background: var(--bg) !important;
>   }
327,334c375,386
< .title {
< 	display: inline-block;
< 	align-items: center;
< 	overflow: hidden;
< 	text-overflow: ellipsis;
< 	white-space: nowrap;
< 	width: 100%;
< }
---
>   > header {
>     position: relative;
>     display: flex;
>     z-index: 2;
>     line-height: var(--deckColumnHeaderHeight);
>     height: var(--deckColumnHeaderHeight);
>     padding: 0 16px;
>     font-size: 0.9em;
>     color: var(--panelHeaderFg);
>     background: var(--panelHeaderBg);
>     box-shadow: 0 1px 0 0 var(--panelHeaderDivider);
>     cursor: pointer;
336,341c388,391
< .toggleActive,
< .menu {
< 	z-index: 1;
< 	width: var(--deckColumnHeaderHeight);
< 	line-height: var(--deckColumnHeaderHeight);
< 	color: var(--faceTextButton);
---
>     &,
>     * {
>       user-select: none;
>     }
343,345c393,395
< 	&:hover {
< 		color: var(--faceTextButtonHover);
< 	}
---
>     &.indicated {
>       box-shadow: 0 3px 0 0 var(--accent);
>     }
347,350c397,403
< 	&:active {
< 		color: var(--faceTextButtonActive);
< 	}
< }
---
>     > .header {
>       display: inline-block;
>       align-items: center;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       white-space: nowrap;
>     }
352,354c405,407
< .toggleActive {
< 	margin-left: -16px;
< }
---
>     > span:only-of-type {
>       width: 100%;
>     }
356,359c409,415
< .menu {
< 	margin-left: auto;
< 	margin-right: -16px;
< }
---
>     > .toggleActive,
>     > .action > ::v-deep(*),
>     > .menu {
>       z-index: 1;
>       width: var(--deckColumnHeaderHeight);
>       line-height: var(--deckColumnHeaderHeight);
>       color: var(--faceTextButton);
361,369c417,452
< .body {
< 	height: calc(100% - var(--deckColumnHeaderHeight));
< 	overflow-y: auto;
< 	overflow-x: hidden; // Safari does not supports clip
< 	overflow-x: clip;
< 	-webkit-overflow-scrolling: touch;
< 	box-sizing: border-box;
< 	container-type: inline-size;
< 	background-color: var(--bg);
---
>       &:hover {
>         color: var(--faceTextButtonHover);
>       }
> 
>       &:active {
>         color: var(--faceTextButtonActive);
>       }
>     }
> 
>     > .toggleActive,
>     > .action {
>       margin-left: -16px;
>     }
> 
>     > .action {
>       z-index: 1;
>     }
> 
>     > .action:empty {
>       display: none;
>     }
> 
>     > .menu {
>       margin-left: auto;
>       margin-right: -16px;
>     }
>   }
> 
>   > div {
>     height: calc(100% - var(--deckColumnHeaderHeight));
>     overflow-y: auto;
>     overflow-x: hidden; // Safari does not supports clip
>     overflow-x: clip;
>     -webkit-overflow-scrolling: touch;
>     box-sizing: border-box;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/deck-store.ts RiricaV13/ui/deck/deck-store.ts
1,7c1,7
< import { throttle } from 'throttle-debounce';
< import { markRaw } from 'vue';
< import { notificationTypes } from 'misskey-js';
< import { Storage } from '../../pizzax';
< import { i18n } from '@/i18n';
< import { api } from '@/os';
< import { deepClone } from '@/scripts/clone';
---
> import { throttle } from "throttle-debounce";
> import { markRaw } from "vue";
> import { notificationTypes } from "misskey-js";
> import { Storage } from "../../pizzax";
> import { i18n } from "@/i18n";
> import { api } from "@/os";
> import { deepClone } from "@/scripts/clone";
10,12c10,12
< 	name: string;
< 	id: string;
< 	data: Record<string, any>;
---
>   name: string;
>   id: string;
>   data: Record<string, any>;
16,26c16,34
< 	id: string;
< 	type: 'main' | 'widgets' | 'notifications' | 'tl' | 'antenna' | 'list' | 'mentions' | 'direct';
< 	name: string | null;
< 	width: number;
< 	widgets?: ColumnWidget[];
< 	active?: boolean;
< 	flexible?: boolean;
< 	antennaId?: string;
< 	listId?: string;
< 	includingTypes?: typeof notificationTypes[number][];
< 	tl?: 'home' | 'local' | 'social' | 'global';
---
>   id: string;
>   type:
>     | "main"
>     | "widgets"
>     | "notifications"
>     | "tl"
>     | "antenna"
>     | "list"
>     | "mentions"
>     | "direct";
>   name: string | null;
>   width: number;
>   widgets?: ColumnWidget[];
>   active?: boolean;
>   flexible?: boolean;
>   antennaId?: string;
>   listId?: string;
>   includingTypes?: typeof notificationTypes[number][];
>   tl?: "home" | "local" | "social" | "global";
29,54c37,64
< export const deckStore = markRaw(new Storage('deck', {
< 	profile: {
< 		where: 'deviceAccount',
< 		default: 'default',
< 	},
< 	columns: {
< 		where: 'deviceAccount',
< 		default: [] as Column[],
< 	},
< 	layout: {
< 		where: 'deviceAccount',
< 		default: [] as Column['id'][][],
< 	},
< 	columnAlign: {
< 		where: 'deviceAccount',
< 		default: 'left' as 'left' | 'right' | 'center',
< 	},
< 	alwaysShowMainColumn: {
< 		where: 'deviceAccount',
< 		default: true,
< 	},
< 	navWindow: {
< 		where: 'deviceAccount',
< 		default: true,
< 	},
< }));
---
> export const deckStore = markRaw(
>   new Storage("deck", {
>     profile: {
>       where: "deviceAccount",
>       default: "default",
>     },
>     columns: {
>       where: "deviceAccount",
>       default: [] as Column[],
>     },
>     layout: {
>       where: "deviceAccount",
>       default: [] as Column["id"][][],
>     },
>     columnAlign: {
>       where: "deviceAccount",
>       default: "left" as "left" | "right" | "center",
>     },
>     alwaysShowMainColumn: {
>       where: "deviceAccount",
>       default: true,
>     },
>     navWindow: {
>       where: "deviceAccount",
>       default: true,
>     },
>   })
> );
57c67
< 	let deck;
---
>   let deck;
59,70c69,80
< 	try {
< 		deck = await api('i/registry/get', {
< 			scope: ['client', 'deck', 'profiles'],
< 			key: deckStore.state.profile,
< 		});
< 	} catch (err) {
< 		if (err.code === 'NO_SUCH_KEY') {
< 			// 後方互換性のため
< 			if (deckStore.state.profile === 'default') {
< 				saveDeck();
< 				return;
< 			}
---
>   try {
>     deck = await api("i/registry/get", {
>       scope: ["client", "deck", "profiles"],
>       key: deckStore.state.profile,
>     });
>   } catch (err) {
>     if (err.code === "NO_SUCH_KEY") {
>       // 後方互換性のため
>       if (deckStore.state.profile === "default") {
>         saveDeck();
>         return;
>       }
72,77c82,87
< 			deckStore.set('columns', []);
< 			deckStore.set('layout', []);
< 			return;
< 		}
< 		throw err;
< 	}
---
>       deckStore.set("columns", []);
>       deckStore.set("layout", []);
>       return;
>     }
>     throw err;
>   }
79,80c89,90
< 	deckStore.set('columns', deck.columns);
< 	deckStore.set('layout', deck.layout);
---
>   deckStore.set("columns", deck.columns);
>   deckStore.set("layout", deck.layout);
85,92c95,102
< 	api('i/registry/set', {
< 		scope: ['client', 'deck', 'profiles'],
< 		key: deckStore.state.profile,
< 		value: {
< 			columns: deckStore.reactiveState.columns.value,
< 			layout: deckStore.reactiveState.layout.value,
< 		},
< 	});
---
>   api("i/registry/set", {
>     scope: ["client", "deck", "profiles"],
>     key: deckStore.state.profile,
>     value: {
>       columns: deckStore.reactiveState.columns.value,
>       layout: deckStore.reactiveState.layout.value,
>     },
>   });
96,98c106,108
< 	return await api('i/registry/keys', {
< 		scope: ['client', 'deck', 'profiles'],
< 	});
---
>   return await api("i/registry/keys", {
>     scope: ["client", "deck", "profiles"],
>   });
102,105c112,115
< 	return await api('i/registry/remove', {
< 		scope: ['client', 'deck', 'profiles'],
< 		key: key,
< 	});
---
>   return await api("i/registry/remove", {
>     scope: ["client", "deck", "profiles"],
>     key: key,
>   });
109,112c119,122
< 	if (column.name === undefined) column.name = null;
< 	deckStore.push('columns', column);
< 	deckStore.push('layout', [column.id]);
< 	saveDeck();
---
>   if (column.name === undefined) column.name = null;
>   deckStore.push("columns", column);
>   deckStore.push("layout", [column.id]);
>   saveDeck();
115,120c125,136
< export function removeColumn(id: Column['id']) {
< 	deckStore.set('columns', deckStore.state.columns.filter(c => c.id !== id));
< 	deckStore.set('layout', deckStore.state.layout
< 		.map(ids => ids.filter(_id => _id !== id))
< 		.filter(ids => ids.length > 0));
< 	saveDeck();
---
> export function removeColumn(id: Column["id"]) {
>   deckStore.set(
>     "columns",
>     deckStore.state.columns.filter((c) => c.id !== id)
>   );
>   deckStore.set(
>     "layout",
>     deckStore.state.layout
>       .map((ids) => ids.filter((_id) => _id !== id))
>       .filter((ids) => ids.length > 0)
>   );
>   saveDeck();
123,132c139,148
< export function swapColumn(a: Column['id'], b: Column['id']) {
< 	const aX = deckStore.state.layout.findIndex(ids => ids.indexOf(a) !== -1);
< 	const aY = deckStore.state.layout[aX].findIndex(id => id === a);
< 	const bX = deckStore.state.layout.findIndex(ids => ids.indexOf(b) !== -1);
< 	const bY = deckStore.state.layout[bX].findIndex(id => id === b);
< 	const layout = deepClone(deckStore.state.layout);
< 	layout[aX][aY] = b;
< 	layout[bX][bY] = a;
< 	deckStore.set('layout', layout);
< 	saveDeck();
---
> export function swapColumn(a: Column["id"], b: Column["id"]) {
>   const aX = deckStore.state.layout.findIndex((ids) => ids.indexOf(a) !== -1);
>   const aY = deckStore.state.layout[aX].findIndex((id) => id === a);
>   const bX = deckStore.state.layout.findIndex((ids) => ids.indexOf(b) !== -1);
>   const bY = deckStore.state.layout[bX].findIndex((id) => id === b);
>   const layout = deepClone(deckStore.state.layout);
>   layout[aX][aY] = b;
>   layout[bX][bY] = a;
>   deckStore.set("layout", layout);
>   saveDeck();
135,148c151,164
< export function swapLeftColumn(id: Column['id']) {
< 	const layout = deepClone(deckStore.state.layout);
< 	deckStore.state.layout.some((ids, i) => {
< 		if (ids.includes(id)) {
< 			const left = deckStore.state.layout[i - 1];
< 			if (left) {
< 				layout[i - 1] = deckStore.state.layout[i];
< 				layout[i] = left;
< 				deckStore.set('layout', layout);
< 			}
< 			return true;
< 		}
< 	});
< 	saveDeck();
---
> export function swapLeftColumn(id: Column["id"]) {
>   const layout = deepClone(deckStore.state.layout);
>   deckStore.state.layout.some((ids, i) => {
>     if (ids.includes(id)) {
>       const left = deckStore.state.layout[i - 1];
>       if (left) {
>         layout[i - 1] = deckStore.state.layout[i];
>         layout[i] = left;
>         deckStore.set("layout", layout);
>       }
>       return true;
>     }
>   });
>   saveDeck();
151,164c167,180
< export function swapRightColumn(id: Column['id']) {
< 	const layout = deepClone(deckStore.state.layout);
< 	deckStore.state.layout.some((ids, i) => {
< 		if (ids.includes(id)) {
< 			const right = deckStore.state.layout[i + 1];
< 			if (right) {
< 				layout[i + 1] = deckStore.state.layout[i];
< 				layout[i] = right;
< 				deckStore.set('layout', layout);
< 			}
< 			return true;
< 		}
< 	});
< 	saveDeck();
---
> export function swapRightColumn(id: Column["id"]) {
>   const layout = deepClone(deckStore.state.layout);
>   deckStore.state.layout.some((ids, i) => {
>     if (ids.includes(id)) {
>       const right = deckStore.state.layout[i + 1];
>       if (right) {
>         layout[i + 1] = deckStore.state.layout[i];
>         layout[i] = right;
>         deckStore.set("layout", layout);
>       }
>       return true;
>     }
>   });
>   saveDeck();
167,176c183,192
< export function swapUpColumn(id: Column['id']) {
< 	const layout = deepClone(deckStore.state.layout);
< 	const idsIndex = deckStore.state.layout.findIndex(ids => ids.includes(id));
< 	const ids = deepClone(deckStore.state.layout[idsIndex]);
< 	ids.some((x, i) => {
< 		if (x === id) {
< 			const up = ids[i - 1];
< 			if (up) {
< 				ids[i - 1] = id;
< 				ids[i] = up;
---
> export function swapUpColumn(id: Column["id"]) {
>   const layout = deepClone(deckStore.state.layout);
>   const idsIndex = deckStore.state.layout.findIndex((ids) => ids.includes(id));
>   const ids = deepClone(deckStore.state.layout[idsIndex]);
>   ids.some((x, i) => {
>     if (x === id) {
>       const up = ids[i - 1];
>       if (up) {
>         ids[i - 1] = id;
>         ids[i] = up;
178,184c194,200
< 				layout[idsIndex] = ids;
< 				deckStore.set('layout', layout);
< 			}
< 			return true;
< 		}
< 	});
< 	saveDeck();
---
>         layout[idsIndex] = ids;
>         deckStore.set("layout", layout);
>       }
>       return true;
>     }
>   });
>   saveDeck();
187,196c203,212
< export function swapDownColumn(id: Column['id']) {
< 	const layout = deepClone(deckStore.state.layout);
< 	const idsIndex = deckStore.state.layout.findIndex(ids => ids.includes(id));
< 	const ids = deepClone(deckStore.state.layout[idsIndex]);
< 	ids.some((x, i) => {
< 		if (x === id) {
< 			const down = ids[i + 1];
< 			if (down) {
< 				ids[i + 1] = id;
< 				ids[i] = down;
---
> export function swapDownColumn(id: Column["id"]) {
>   const layout = deepClone(deckStore.state.layout);
>   const idsIndex = deckStore.state.layout.findIndex((ids) => ids.includes(id));
>   const ids = deepClone(deckStore.state.layout[idsIndex]);
>   ids.some((x, i) => {
>     if (x === id) {
>       const down = ids[i + 1];
>       if (down) {
>         ids[i + 1] = id;
>         ids[i] = down;
198,204c214,220
< 				layout[idsIndex] = ids;
< 				deckStore.set('layout', layout);
< 			}
< 			return true;
< 		}
< 	});
< 	saveDeck();
---
>         layout[idsIndex] = ids;
>         deckStore.set("layout", layout);
>       }
>       return true;
>     }
>   });
>   saveDeck();
207,214c223,230
< export function stackLeftColumn(id: Column['id']) {
< 	let layout = deepClone(deckStore.state.layout);
< 	const i = deckStore.state.layout.findIndex(ids => ids.includes(id));
< 	layout = layout.map(ids => ids.filter(_id => _id !== id));
< 	layout[i - 1].push(id);
< 	layout = layout.filter(ids => ids.length > 0);
< 	deckStore.set('layout', layout);
< 	saveDeck();
---
> export function stackLeftColumn(id: Column["id"]) {
>   let layout = deepClone(deckStore.state.layout);
>   const i = deckStore.state.layout.findIndex((ids) => ids.includes(id));
>   layout = layout.map((ids) => ids.filter((_id) => _id !== id));
>   layout[i - 1].push(id);
>   layout = layout.filter((ids) => ids.length > 0);
>   deckStore.set("layout", layout);
>   saveDeck();
217,224c233,240
< export function popRightColumn(id: Column['id']) {
< 	let layout = deepClone(deckStore.state.layout);
< 	const i = deckStore.state.layout.findIndex(ids => ids.includes(id));
< 	const affected = layout[i];
< 	layout = layout.map(ids => ids.filter(_id => _id !== id));
< 	layout.splice(i + 1, 0, [id]);
< 	layout = layout.filter(ids => ids.length > 0);
< 	deckStore.set('layout', layout);
---
> export function popRightColumn(id: Column["id"]) {
>   let layout = deepClone(deckStore.state.layout);
>   const i = deckStore.state.layout.findIndex((ids) => ids.includes(id));
>   const affected = layout[i];
>   layout = layout.map((ids) => ids.filter((_id) => _id !== id));
>   layout.splice(i + 1, 0, [id]);
>   layout = layout.filter((ids) => ids.length > 0);
>   deckStore.set("layout", layout);
226,232c242,248
< 	const columns = deepClone(deckStore.state.columns);
< 	for (const column of columns) {
< 		if (affected.includes(column.id)) {
< 			column.active = true;
< 		}
< 	}
< 	deckStore.set('columns', columns);
---
>   const columns = deepClone(deckStore.state.columns);
>   for (const column of columns) {
>     if (affected.includes(column.id)) {
>       column.active = true;
>     }
>   }
>   deckStore.set("columns", columns);
234c250
< 	saveDeck();
---
>   saveDeck();
237,246c253,262
< export function addColumnWidget(id: Column['id'], widget: ColumnWidget) {
< 	const columns = deepClone(deckStore.state.columns);
< 	const columnIndex = deckStore.state.columns.findIndex(c => c.id === id);
< 	const column = deepClone(deckStore.state.columns[columnIndex]);
< 	if (column == null) return;
< 	if (column.widgets == null) column.widgets = [];
< 	column.widgets.unshift(widget);
< 	columns[columnIndex] = column;
< 	deckStore.set('columns', columns);
< 	saveDeck();
---
> export function addColumnWidget(id: Column["id"], widget: ColumnWidget) {
>   const columns = deepClone(deckStore.state.columns);
>   const columnIndex = deckStore.state.columns.findIndex((c) => c.id === id);
>   const column = deepClone(deckStore.state.columns[columnIndex]);
>   if (column == null) return;
>   if (column.widgets == null) column.widgets = [];
>   column.widgets.unshift(widget);
>   columns[columnIndex] = column;
>   deckStore.set("columns", columns);
>   saveDeck();
249,257c265,273
< export function removeColumnWidget(id: Column['id'], widget: ColumnWidget) {
< 	const columns = deepClone(deckStore.state.columns);
< 	const columnIndex = deckStore.state.columns.findIndex(c => c.id === id);
< 	const column = deepClone(deckStore.state.columns[columnIndex]);
< 	if (column == null) return;
< 	column.widgets = column.widgets.filter(w => w.id !== widget.id);
< 	columns[columnIndex] = column;
< 	deckStore.set('columns', columns);
< 	saveDeck();
---
> export function removeColumnWidget(id: Column["id"], widget: ColumnWidget) {
>   const columns = deepClone(deckStore.state.columns);
>   const columnIndex = deckStore.state.columns.findIndex((c) => c.id === id);
>   const column = deepClone(deckStore.state.columns[columnIndex]);
>   if (column == null) return;
>   column.widgets = column.widgets.filter((w) => w.id !== widget.id);
>   columns[columnIndex] = column;
>   deckStore.set("columns", columns);
>   saveDeck();
260,268c276,284
< export function setColumnWidgets(id: Column['id'], widgets: ColumnWidget[]) {
< 	const columns = deepClone(deckStore.state.columns);
< 	const columnIndex = deckStore.state.columns.findIndex(c => c.id === id);
< 	const column = deepClone(deckStore.state.columns[columnIndex]);
< 	if (column == null) return;
< 	column.widgets = widgets;
< 	columns[columnIndex] = column;
< 	deckStore.set('columns', columns);
< 	saveDeck();
---
> export function setColumnWidgets(id: Column["id"], widgets: ColumnWidget[]) {
>   const columns = deepClone(deckStore.state.columns);
>   const columnIndex = deckStore.state.columns.findIndex((c) => c.id === id);
>   const column = deepClone(deckStore.state.columns[columnIndex]);
>   if (column == null) return;
>   column.widgets = widgets;
>   columns[columnIndex] = column;
>   deckStore.set("columns", columns);
>   saveDeck();
271,282c287,306
< export function updateColumnWidget(id: Column['id'], widgetId: string, widgetData: any) {
< 	const columns = deepClone(deckStore.state.columns);
< 	const columnIndex = deckStore.state.columns.findIndex(c => c.id === id);
< 	const column = deepClone(deckStore.state.columns[columnIndex]);
< 	if (column == null) return;
< 	column.widgets = column.widgets.map(w => w.id === widgetId ? {
< 		...w,
< 		data: widgetData,
< 	} : w);
< 	columns[columnIndex] = column;
< 	deckStore.set('columns', columns);
< 	saveDeck();
---
> export function updateColumnWidget(
>   id: Column["id"],
>   widgetId: string,
>   widgetData: any
> ) {
>   const columns = deepClone(deckStore.state.columns);
>   const columnIndex = deckStore.state.columns.findIndex((c) => c.id === id);
>   const column = deepClone(deckStore.state.columns[columnIndex]);
>   if (column == null) return;
>   column.widgets = column.widgets.map((w) =>
>     w.id === widgetId
>       ? {
>           ...w,
>           data: widgetData,
>         }
>       : w
>   );
>   columns[columnIndex] = column;
>   deckStore.set("columns", columns);
>   saveDeck();
285,295c309,319
< export function updateColumn(id: Column['id'], column: Partial<Column>) {
< 	const columns = deepClone(deckStore.state.columns);
< 	const columnIndex = deckStore.state.columns.findIndex(c => c.id === id);
< 	const currentColumn = deepClone(deckStore.state.columns[columnIndex]);
< 	if (currentColumn == null) return;
< 	for (const [k, v] of Object.entries(column)) {
< 		currentColumn[k] = v;
< 	}
< 	columns[columnIndex] = currentColumn;
< 	deckStore.set('columns', columns);
< 	saveDeck();
---
> export function updateColumn(id: Column["id"], column: Partial<Column>) {
>   const columns = deepClone(deckStore.state.columns);
>   const columnIndex = deckStore.state.columns.findIndex((c) => c.id === id);
>   const currentColumn = deepClone(deckStore.state.columns[columnIndex]);
>   if (currentColumn == null) return;
>   for (const [k, v] of Object.entries(column)) {
>     currentColumn[k] = v;
>   }
>   columns[columnIndex] = currentColumn;
>   deckStore.set("columns", columns);
>   saveDeck();
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/direct-column.vue RiricaV13/ui/deck/direct-column.vue
2,3c2,10
< <XColumn :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header><i class="ti ti-mail" style="margin-right: 8px;"></i>{{ column.name }}</template>
---
>   <XColumn
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header
>       ><i class="fas fa-envelope" style="margin-right: 8px"></i
>       >{{ column.name }}</template
>     >
5,6c12,13
< 	<XNotes :pagination="pagination"/>
< </XColumn>
---
>     <XNotes :pagination="pagination" />
>   </XColumn>
10,13c17,20
< import { } from 'vue';
< import XColumn from './column.vue';
< import XNotes from '@/components/MkNotes.vue';
< import { Column } from './deck-store';
---
> import {} from "vue";
> import XColumn from "./column.vue";
> import XNotes from "@/components/MkNotes.vue";
> import { Column } from "./deck-store";
16,17c23,24
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
21c28
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
25,29c32,36
< 	endpoint: 'notes/mentions' as const,
< 	limit: 10,
< 	params: {
< 		visibility: 'specified',
< 	},
---
>   endpoint: "notes/mentions" as const,
>   limit: 10,
>   params: {
>     visibility: "specified",
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/list-column.vue RiricaV13/ui/deck/list-column.vue
2,5c2,11
< <XColumn :menu="menu" :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header>
< 		<i class="ti ti-list"></i><span style="margin-left: 8px;">{{ column.name }}</span>
< 	</template>
---
>   <XColumn
>     :menu="menu"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header>
>       <i class="fas fa-list-ul"></i
>       ><span style="margin-left: 8px">{{ column.name }}</span>
>     </template>
7,8c13,20
< 	<XTimeline v-if="column.listId" ref="timeline" src="list" :list="column.listId" @after="() => emit('loaded')"/>
< </XColumn>
---
>     <XTimeline
>       v-if="column.listId"
>       ref="timeline"
>       src="list"
>       :list="column.listId"
>       @after="() => emit('loaded')"
>     />
>   </XColumn>
12,17c24,29
< import { } from 'vue';
< import XColumn from './column.vue';
< import { updateColumn, Column } from './deck-store';
< import XTimeline from '@/components/MkTimeline.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import XColumn from "./column.vue";
> import { updateColumn, Column } from "./deck-store";
> import XTimeline from "@/components/MkTimeline.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
20,21c32,33
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
25,26c37,38
< 	(ev: 'loaded'): void;
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "loaded"): void;
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
29c41
< let timeline = $shallowRef<InstanceType<typeof XTimeline>>();
---
> let timeline = $ref<InstanceType<typeof XTimeline>>();
32c44
< 	setList();
---
>   setList();
36,47c48,60
< 	const lists = await os.api('users/lists/list');
< 	const { canceled, result: list } = await os.select({
< 		title: i18n.ts.selectList,
< 		items: lists.map(x => ({
< 			value: x, text: x.name,
< 		})),
< 		default: props.column.listId,
< 	});
< 	if (canceled) return;
< 	updateColumn(props.column.id, {
< 		listId: list.id,
< 	});
---
>   const lists = await os.api("users/lists/list");
>   const { canceled, result: list } = await os.select({
>     title: i18n.ts.selectList,
>     items: lists.map((x) => ({
>       value: x,
>       text: x.name,
>     })),
>     default: props.column.listId,
>   });
>   if (canceled) return;
>   updateColumn(props.column.id, {
>     listId: list.id,
>   });
50,54c63,69
< const menu = [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.selectList,
< 	action: setList,
< }];
---
> const menu = [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.selectList,
>     action: setList,
>   },
> ];
55a71,72
> 
> <style lang="scss" scoped></style>
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/main-column.vue RiricaV13/ui/deck/main-column.vue
2,8c2,16
< <XColumn v-if="deckStore.state.alwaysShowMainColumn || mainRouter.currentRoute.value.name !== 'index'" :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header>
< 		<template v-if="pageMetadata?.value">
< 			<i :class="pageMetadata?.value.icon"></i>
< 			{{ pageMetadata?.value.title }}
< 		</template>
< 	</template>
---
>   <XColumn
>     v-if="
>       deckStore.state.alwaysShowMainColumn ||
>       mainRouter.currentRoute.value.name !== 'index'
>     "
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header>
>       <template v-if="pageMetadata?.value">
>         <i :class="pageMetadata?.value.icon"></i>
>         {{ pageMetadata?.value.title }}
>       </template>
>     </template>
10,11c18,19
< 	<RouterView @contextmenu.stop="onContextmenu"/>
< </XColumn>
---
>     <RouterView @contextmenu.stop="onContextmenu" />
>   </XColumn>
15,21c23,33
< import { ComputedRef, provide } from 'vue';
< import XColumn from './column.vue';
< import { deckStore, Column } from '@/ui/deck/deck-store';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
< import { mainRouter } from '@/router';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
---
> import { ComputedRef, provide } from "vue";
> import XColumn from "./column.vue";
> import { deckStore, Column } from "@/ui/deck/deck-store";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
> import { mainRouter } from "@/router";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
24,25c36,37
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
29c41
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
34c46
< provide('router', mainRouter);
---
> provide("router", mainRouter);
36c48
< 	pageMetadata = info;
---
>   pageMetadata = info;
45c57
< 	if (!ev.target) return;
---
>   if (!ev.target) return;
47,66c59,90
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target as HTMLElement)) return;
< 	if (['INPUT', 'TEXTAREA', 'IMG', 'VIDEO', 'CANVAS'].includes((ev.target as HTMLElement).tagName) || (ev.target as HTMLElement).attributes['contenteditable']) return;
< 	if (window.getSelection()?.toString() !== '') return;
< 	const path = mainRouter.currentRoute.value.path;
< 	os.contextMenu([{
< 		type: 'label',
< 		text: path,
< 	}, {
< 		icon: 'ti ti-window-maximize',
< 		text: i18n.ts.openInWindow,
< 		action: () => {
< 			os.pageWindow(path);
< 		},
< 	}], ev);
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target as HTMLElement)) return;
>   if (
>     ["INPUT", "TEXTAREA", "IMG", "VIDEO", "CANVAS"].includes(
>       (ev.target as HTMLElement).tagName
>     ) ||
>     (ev.target as HTMLElement).attributes["contenteditable"]
>   )
>     return;
>   if (window.getSelection()?.toString() !== "") return;
>   const path = mainRouter.currentRoute.value.path;
>   os.contextMenu(
>     [
>       {
>         type: "label",
>         text: path,
>       },
>       {
>         icon: "fas fa-window-maximize",
>         text: i18n.ts.openInWindow,
>         action: () => {
>           os.pageWindow(path);
>         },
>       },
>     ],
>     ev
>   );
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/mentions-column.vue RiricaV13/ui/deck/mentions-column.vue
2,3c2,10
< <XColumn :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header><i class="ti ti-at" style="margin-right: 8px;"></i>{{ column.name }}</template>
---
>   <XColumn
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header
>       ><i class="fas fa-at" style="margin-right: 8px"></i
>       >{{ column.name }}</template
>     >
5,6c12,13
< 	<XNotes :pagination="pagination"/>
< </XColumn>
---
>     <XNotes :pagination="pagination" />
>   </XColumn>
10,13c17,20
< import { } from 'vue';
< import XColumn from './column.vue';
< import XNotes from '@/components/MkNotes.vue';
< import { Column } from './deck-store';
---
> import {} from "vue";
> import XColumn from "./column.vue";
> import XNotes from "@/components/MkNotes.vue";
> import { Column } from "./deck-store";
16,17c23,24
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
21c28
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
25,26c32,33
< 	endpoint: 'notes/mentions' as const,
< 	limit: 10,
---
>   endpoint: "notes/mentions" as const,
>   limit: 10,
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/notifications-column.vue RiricaV13/ui/deck/notifications-column.vue
2,3c2,11
< <XColumn :column="column" :is-stacked="isStacked" :menu="menu" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header><i class="ti ti-bell" style="margin-right: 8px;"></i>{{ column.name }}</template>
---
>   <XColumn
>     :column="column"
>     :is-stacked="isStacked"
>     :menu="menu"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header
>       ><i class="fas fa-bell" style="margin-right: 8px"></i
>       >{{ column.name }}</template
>     >
5,6c13,14
< 	<XNotifications :include-types="column.includingTypes"/>
< </XColumn>
---
>     <XNotifications :include-types="column.includingTypes" />
>   </XColumn>
10,15c18,23
< import { defineAsyncComponent } from 'vue';
< import XColumn from './column.vue';
< import { updateColumn, Column } from './deck-store';
< import XNotifications from '@/components/MkNotifications.vue';
< import * as os from '@/os';
< import { i18n } from '@/i18n';
---
> import { defineAsyncComponent } from "vue";
> import XColumn from "./column.vue";
> import { updateColumn, Column } from "./deck-store";
> import XNotifications from "@/components/MkNotifications.vue";
> import * as os from "@/os";
> import { i18n } from "@/i18n";
18,19c26,27
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
23c31
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
27,36c35,51
< 	os.popup(defineAsyncComponent(() => import('@/components/MkNotificationSettingWindow.vue')), {
< 		includingTypes: props.column.includingTypes,
< 	}, {
< 		done: async (res) => {
< 			const { includingTypes } = res;
< 			updateColumn(props.column.id, {
< 				includingTypes: includingTypes,
< 			});
< 		},
< 	}, 'closed');
---
>   os.popup(
>     defineAsyncComponent(
>       () => import("@/components/MkNotificationSettingWindow.vue")
>     ),
>     {
>       includingTypes: props.column.includingTypes,
>     },
>     {
>       done: async (res) => {
>         const { includingTypes } = res;
>         updateColumn(props.column.id, {
>           includingTypes: includingTypes,
>         });
>       },
>     },
>     "closed"
>   );
39,43c54,60
< const menu = [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.notificationSetting,
< 	action: func,
< }];
---
> const menu = [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.notificationSetting,
>     action: func,
>   },
> ];
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/tl-column.vue RiricaV13/ui/deck/tl-column.vue
2,9c2,16
< <XColumn :menu="menu" :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header>
< 		<i v-if="column.tl === 'home'" class="ti ti-home"></i>
< 		<i v-else-if="column.tl === 'local'" class="ti ti-planet"></i>
< 		<i v-else-if="column.tl === 'social'" class="ti ti-rocket"></i>
< 		<i v-else-if="column.tl === 'global'" class="ti ti-whirl"></i>
< 		<span style="margin-left: 8px;">{{ column.name }}</span>
< 	</template>
---
>   <XColumn
>     :menu="menu"
>     :column="column"
>     :is-stacked="isStacked"
>     :indicated="indicated"
>     @change-active-state="onChangeActiveState"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header>
>       <i v-if="column.tl === 'home'" class="fas fa-home"></i>
>       <i v-else-if="column.tl === 'local'" class="fas fa-comments"></i>
>       <i v-else-if="column.tl === 'social'" class="fas fa-share-alt"></i>
>       <i v-else-if="column.tl === 'global'" class="fas fa-globe"></i>
>       <span style="margin-left: 8px">{{ column.name }}</span>
>     </template>
11,19c18,34
< 	<div v-if="disabled" :class="$style.disabled">
< 		<p :class="$style.disabledTitle">
< 			<i class="ti ti-minus-circle"></i>
< 			{{ $t('disabled-timeline.title') }}
< 		</p>
< 		<p :class="$style.disabledDescription">{{ $t('disabled-timeline.description') }}</p>
< 	</div>
< 	<XTimeline v-else-if="column.tl" ref="timeline" :key="column.tl" :src="column.tl" @after="() => emit('loaded')"/>
< </XColumn>
---
>     <div v-if="disabled" class="iwaalbte">
>       <p>
>         <i class="fas fa-minus-circle"></i>
>         {{ $t("disabled-timeline.title") }}
>       </p>
>       <p class="desc">{{ $t("disabled-timeline.description") }}</p>
>     </div>
>     <XTimeline
>       v-else-if="column.tl"
>       ref="timeline"
>       :key="column.tl"
>       :src="column.tl"
>       @after="() => emit('loaded')"
>       @queue="queueUpdated"
>       @note="onNote"
>     />
>   </XColumn>
23,30c38,45
< import { onMounted } from 'vue';
< import XColumn from './column.vue';
< import { removeColumn, updateColumn, Column } from './deck-store';
< import XTimeline from '@/components/MkTimeline.vue';
< import * as os from '@/os';
< import { $i } from '@/account';
< import { instance } from '@/instance';
< import { i18n } from '@/i18n';
---
> import { onMounted } from "vue";
> import XColumn from "./column.vue";
> import { removeColumn, updateColumn, Column } from "./deck-store";
> import XTimeline from "@/components/MkTimeline.vue";
> import * as os from "@/os";
> import { $i } from "@/account";
> import { instance } from "@/instance";
> import { i18n } from "@/i18n";
33,34c48,49
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
38,39c53,54
< 	(ev: 'loaded'): void;
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "loaded"): void;
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
42a58,59
> let indicated = $ref(false);
> let columnActive = $ref(true);
45,49c62,72
< 	if (props.column.tl == null) {
< 		setType();
< 	} else if ($i) {
< 		disabled = false; // TODO
< 	}
---
>   if (props.column.tl == null) {
>     setType();
>   } else if ($i) {
>     disabled =
>       !$i.isModerator &&
>       !$i.isAdmin &&
>       ((instance.disableLocalTimeline &&
>         ["local", "social"].includes(props.column.tl)) ||
>         (instance.disableGlobalTimeline &&
>           ["global"].includes(props.column.tl)));
>   }
53,73c76,105
< 	const { canceled, result: src } = await os.select({
< 		title: i18n.ts.timeline,
< 		items: [{
< 			value: 'home' as const, text: i18n.ts._timelines.home,
< 		}, {
< 			value: 'local' as const, text: i18n.ts._timelines.local,
< 		}, {
< 			value: 'social' as const, text: i18n.ts._timelines.social,
< 		}, {
< 			value: 'global' as const, text: i18n.ts._timelines.global,
< 		}],
< 	});
< 	if (canceled) {
< 		if (props.column.tl == null) {
< 			removeColumn(props.column.id);
< 		}
< 		return;
< 	}
< 	updateColumn(props.column.id, {
< 		tl: src,
< 	});
---
>   const { canceled, result: src } = await os.select({
>     title: i18n.ts.timeline,
>     items: [
>       {
>         value: "home" as const,
>         text: i18n.ts._timelines.home,
>       },
>       {
>         value: "local" as const,
>         text: i18n.ts._timelines.local,
>       },
>       {
>         value: "social" as const,
>         text: i18n.ts._timelines.social,
>       },
>       {
>         value: "global" as const,
>         text: i18n.ts._timelines.global,
>       },
>     ],
>   });
>   if (canceled) {
>     if (props.column.tl == null) {
>       removeColumn(props.column.id);
>     }
>     return;
>   }
>   updateColumn(props.column.id, {
>     tl: src,
>   });
76,81c108,112
< const menu = [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.timeline,
< 	action: setType,
< }];
< </script>
---
> function queueUpdated(q) {
>   if (columnActive) {
>     indicated = q !== 0;
>   }
> }
83,85c114,117
< <style lang="scss" module>
< .disabled {
< 	text-align: center;
---
> function onNote() {
>   if (!columnActive) {
>     indicated = true;
>   }
88,89c120,125
< .disabledTitle {
< 	margin: 16px;
---
> function onChangeActiveState(state) {
>   columnActive = state;
> 
>   if (columnActive) {
>     indicated = false;
>   }
92,93c128,147
< .disabledDescription {
< 	font-size: 90%;
---
> const menu = [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.timeline,
>     action: setType,
>   },
> ];
> </script>
> 
> <style lang="scss" scoped>
> .iwaalbte {
>   text-align: center;
> 
>   > p {
>     margin: 16px;
> 
>     &.desc {
>       font-size: 14px;
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck/widgets-column.vue RiricaV13/ui/deck/widgets-column.vue
2,3c2,12
< <XColumn :menu="menu" :naked="true" :column="column" :is-stacked="isStacked" @parent-focus="$event => emit('parent-focus', $event)">
< 	<template #header><i class="ti ti-apps" style="margin-right: 8px;"></i>{{ column.name }}</template>
---
>   <XColumn
>     :menu="menu"
>     :naked="true"
>     :column="column"
>     :is-stacked="isStacked"
>     @parent-focus="($event) => emit('parent-focus', $event)"
>   >
>     <template #header
>       ><i class="fas fa-window-maximize" style="margin-right: 8px"></i
>       >{{ column.name }}</template
>     >
5,9c14,31
< 	<div :class="$style.root">
< 		<div v-if="!(column.widgets && column.widgets.length > 0) && !edit" :class="$style.intro">{{ i18n.ts._deck.widgetsIntroduction }}</div>
< 		<XWidgets :edit="edit" :widgets="column.widgets ?? []" @add-widget="addWidget" @remove-widget="removeWidget" @update-widget="updateWidget" @update-widgets="updateWidgets" @exit="edit = false"/>
< 	</div>
< </XColumn>
---
>     <div class="wtdtxvec">
>       <div
>         v-if="!(column.widgets && column.widgets.length > 0) && !edit"
>         class="intro"
>       >
>         {{ i18n.ts._deck.widgetsIntroduction }}
>       </div>
>       <XWidgets
>         :edit="edit"
>         :widgets="column.widgets"
>         @add-widget="addWidget"
>         @remove-widget="removeWidget"
>         @update-widget="updateWidget"
>         @update-widgets="updateWidgets"
>         @exit="edit = false"
>       />
>     </div>
>   </XColumn>
13,17c35,45
< import { } from 'vue';
< import XColumn from './column.vue';
< import { addColumnWidget, Column, removeColumnWidget, setColumnWidgets, updateColumnWidget } from './deck-store';
< import XWidgets from '@/components/MkWidgets.vue';
< import { i18n } from '@/i18n';
---
> import {} from "vue";
> import XColumn from "./column.vue";
> import {
>   addColumnWidget,
>   Column,
>   removeColumnWidget,
>   setColumnWidgets,
>   updateColumnWidget,
> } from "./deck-store";
> import XWidgets from "@/components/MkWidgets.vue";
> import { i18n } from "@/i18n";
20,21c48,49
< 	column: Column;
< 	isStacked: boolean;
---
>   column: Column;
>   isStacked: boolean;
25c53
< 	(ev: 'parent-focus', direction: 'up' | 'down' | 'left' | 'right'): void;
---
>   (ev: "parent-focus", direction: "up" | "down" | "left" | "right"): void;
31c59
< 	addColumnWidget(props.column.id, widget);
---
>   addColumnWidget(props.column.id, widget);
35c63
< 	removeColumnWidget(props.column.id, widget);
---
>   removeColumnWidget(props.column.id, widget);
39c67
< 	updateColumnWidget(props.column.id, id, data);
---
>   updateColumnWidget(props.column.id, id, data);
43c71
< 	setColumnWidgets(props.column.id, widgets);
---
>   setColumnWidgets(props.column.id, widgets);
47c75
< 	edit = !edit;
---
>   edit = !edit;
50,54c78,84
< const menu = [{
< 	icon: 'ti ti-pencil',
< 	text: i18n.ts.editWidgets,
< 	action: func,
< }];
---
> const menu = [
>   {
>     icon: "fas fa-pencil-alt",
>     text: i18n.ts.editWidgets,
>     action: func,
>   },
> ];
57,60c87,90
< <style lang="scss" module>
< .root {
< 	--margin: 8px;
< 	--panelBorder: none;
---
> <style lang="scss" scoped>
> .wtdtxvec {
>   --margin: 8px;
>   --panelBorder: none;
62,63c92
< 	padding: 0 var(--margin);
< }
---
>   padding: 0 var(--margin);
65,67c94,97
< .intro {
< 	padding: 16px;
< 	text-align: center;
---
>   > .intro {
>     padding: 16px;
>     text-align: center;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/deck.vue RiricaV13/ui/deck.vue
2,3c2,3
< <div :class="[$style.root, { [$style.rootIsMobile]: isMobile }]">
< 	<XSidebar v-if="!isMobile"/>
---
>   <div class="mk-deck" :class="[{ isMobile }]">
>     <XSidebar v-if="!isMobile" />
5,46c5,97
< 	<div :class="$style.main">
< 		<XStatusBars/>
< 		<div ref="columnsEl" :class="[$style.columns, deckStore.reactiveState.columnAlign.value]" @contextmenu.self.prevent="onContextmenu">
< 			<template v-for="ids in layout">
< 				<!-- sectionを利用しているのは、deck.vue側でcolumnに対してfirst-of-typeを効かせるため -->
< 				<section
< 					v-if="ids.length > 1"
< 					:class="$style.folder"
< 					:style="columns.filter(c => ids.includes(c.id)).some(c => c.flexible) ? { flex: 1, minWidth: '350px' } : { width: Math.max(...columns.filter(c => ids.includes(c.id)).map(c => c.width)) + 'px' }"
< 				>
< 					<DeckColumnCore v-for="id in ids" :ref="id" :key="id" :column="columns.find(c => c.id === id)" :is-stacked="true" @parent-focus="moveFocus(id, $event)"/>
< 				</section>
< 				<DeckColumnCore
< 					v-else
< 					:ref="ids[0]"
< 					:key="ids[0]"
< 					:class="$style.column"
< 					:column="columns.find(c => c.id === ids[0])"
< 					:is-stacked="false"
< 					:style="columns.find(c => c.id === ids[0])!.flexible ? { flex: 1, minWidth: '350px' } : { width: columns.find(c => c.id === ids[0])!.width + 'px' }"
< 					@parent-focus="moveFocus(ids[0], $event)"
< 				/>
< 			</template>
< 			<div v-if="layout.length === 0" class="_panel" :class="$style.onboarding">
< 				<div>{{ i18n.ts._deck.introduction }}</div>
< 				<MkButton primary style="margin: 1em auto;" @click="addColumn">{{ i18n.ts._deck.addColumn }}</MkButton>
< 				<div>{{ i18n.ts._deck.introduction2 }}</div>
< 			</div>
< 			<div :class="$style.sideMenu">
< 				<div :class="$style.sideMenuTop">
< 					<button v-tooltip.noDelay.left="`${i18n.ts._deck.profile}: ${deckStore.state.profile}`" :class="$style.sideMenuButton" class="_button" @click="changeProfile"><i class="ti ti-caret-down"></i></button>
< 					<button v-tooltip.noDelay.left="i18n.ts._deck.deleteProfile" :class="$style.sideMenuButton" class="_button" @click="deleteProfile"><i class="ti ti-trash"></i></button>
< 				</div>
< 				<div :class="$style.sideMenuMiddle">
< 					<button v-tooltip.noDelay.left="i18n.ts._deck.addColumn" :class="$style.sideMenuButton" class="_button" @click="addColumn"><i class="ti ti-plus"></i></button>
< 				</div>
< 				<div :class="$style.sideMenuBottom">
< 					<button v-tooltip.noDelay.left="i18n.ts.settings" :class="$style.sideMenuButton" class="_button" @click="showSettings"><i class="ti ti-settings"></i></button>
< 				</div>
< 			</div>
< 		</div>
< 	</div>
---
>     <div class="main">
>       <XStatusBars class="statusbars" />
>       <div
>         ref="columnsEl"
>         class="columns"
>         :class="deckStore.reactiveState.columnAlign.value"
>         @contextmenu.self.prevent="onContextmenu"
>       >
>         <template v-for="ids in layout">
>           <!-- sectionを利用しているのは、deck.vue側でcolumnに対してfirst-of-typeを効かせるため -->
>           <section
>             v-if="ids.length > 1"
>             class="folder column"
>             :style="
>               columns.filter((c) => ids.includes(c.id)).some((c) => c.flexible)
>                 ? { flex: 1, minWidth: '350px' }
>                 : {
>                     width:
>                       Math.max(
>                         ...columns
>                           .filter((c) => ids.includes(c.id))
>                           .map((c) => c.width)
>                       ) + 'px',
>                   }
>             "
>           >
>             <DeckColumnCore
>               v-for="id in ids"
>               :ref="id"
>               :key="id"
>               :column="columns.find((c) => c.id === id)"
>               :is-stacked="true"
>               @parent-focus="moveFocus(id, $event)"
>             />
>           </section>
>           <DeckColumnCore
>             v-else
>             :ref="ids[0]"
>             :key="ids[0]"
>             class="column"
>             :column="columns.find((c) => c.id === ids[0])"
>             :is-stacked="false"
>             :style="columns.find(c => c.id === ids[0])!.flexible ? { flex: 1, minWidth: '350px' } : { width: columns.find(c => c.id === ids[0])!.width + 'px' }"
>             @parent-focus="moveFocus(ids[0], $event)"
>           />
>         </template>
>         <div v-if="layout.length === 0" class="intro _panel">
>           <div>{{ i18n.ts._deck.introduction }}</div>
>           <MkButton primary class="add" @click="addColumn">{{
>             i18n.ts._deck.addColumn
>           }}</MkButton>
>           <div>{{ i18n.ts._deck.introduction2 }}</div>
>         </div>
>         <div class="sideMenu">
>           <div class="top">
>             <button
>               v-tooltip.noDelay.left="
>                 `${i18n.ts._deck.profile}: ${deckStore.state.profile}`
>               "
>               class="_button button"
>               @click="changeProfile"
>             >
>               <i class="fas fa-caret-down"></i>
>             </button>
>             <button
>               v-tooltip.noDelay.left="i18n.ts._deck.deleteProfile"
>               class="_button button"
>               @click="deleteProfile"
>             >
>               <i class="fas fa-trash-can"></i>
>             </button>
>           </div>
>           <div class="middle">
>             <button
>               v-tooltip.noDelay.left="i18n.ts._deck.addColumn"
>               class="_button button"
>               @click="addColumn"
>             >
>               <i class="fas fa-plus"></i>
>             </button>
>           </div>
>           <div class="bottom">
>             <button
>               v-tooltip.noDelay.left="i18n.ts.settings"
>               class="_button button settings"
>               @click="showSettings"
>             >
>               <i class="fas fa-cog"></i>
>             </button>
>           </div>
>         </div>
>       </div>
>     </div>
48,53c99,121
< 	<div v-if="isMobile" :class="$style.nav">
< 		<button :class="$style.navButton" class="_button" @click="drawerMenuShowing = true"><i :class="$style.navButtonIcon" class="ti ti-menu-2"></i><span v-if="menuIndicated" :class="$style.navButtonIndicator"><i class="_indicatorCircle"></i></span></button>
< 		<button :class="$style.navButton" class="_button" @click="mainRouter.push('/')"><i :class="$style.navButtonIcon" class="ti ti-home"></i></button>
< 		<button :class="$style.navButton" class="_button" @click="mainRouter.push('/my/notifications')"><i :class="$style.navButtonIcon" class="ti ti-bell"></i><span v-if="$i?.hasUnreadNotification" :class="$style.navButtonIndicator"><i class="_indicatorCircle"></i></span></button>
< 		<button :class="$style.postButton" class="_button" @click="os.post()"><i :class="$style.navButtonIcon" class="ti ti-pencil"></i></button>
< 	</div>
---
>     <div v-if="isMobile" class="buttons">
>       <button class="button nav _button" @click="drawerMenuShowing = true">
>         <i class="fas fa-bars"></i
>         ><span v-if="menuIndicated" class="indicator"
>           ><i class="fas fa-circle"></i
>         ></span>
>       </button>
>       <button class="button home _button" @click="mainRouter.push('/')">
>         <i class="fas fa-home"></i>
>       </button>
>       <button
>         class="button notifications _button"
>         @click="mainRouter.push('/my/notifications')"
>       >
>         <i class="fas fa-bell"></i
>         ><span v-if="$i?.hasUnreadNotification" class="indicator"
>           ><i class="fas fa-circle"></i
>         ></span>
>       </button>
>       <button class="button post _button" @click="os.post()">
>         <i class="fas fa-pencil-alt"></i>
>       </button>
>     </div>
55,68c123,130
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_menuDrawerBg_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_menuDrawerBg_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_menuDrawerBg_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_menuDrawerBg_leaveTo : ''"
< 	>
< 		<div
< 			v-if="drawerMenuShowing"
< 			:class="$style.menuBg"
< 			class="_modalBg"
< 			@click="drawerMenuShowing = false"
< 			@touchstart.passive="drawerMenuShowing = false"
< 		></div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'menu-back' : ''">
>       <div
>         v-if="drawerMenuShowing"
>         class="menu-back _modalBg"
>         @click="drawerMenuShowing = false"
>         @touchstart.passive="drawerMenuShowing = false"
>       ></div>
>     </transition>
70,79c132,134
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_menuDrawer_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_menuDrawer_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_menuDrawer_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_menuDrawer_leaveTo : ''"
< 	>
< 		<div v-if="drawerMenuShowing" :class="$style.menu">
< 			<XDrawerMenu/>
< 		</div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'menu' : ''">
>       <XDrawerMenu v-if="drawerMenuShowing" class="menu" />
>     </transition>
81,82c136,137
< 	<XCommon/>
< </div>
---
>     <XCommon />
>   </div>
86,101c141,171
< import { computed, defineAsyncComponent, onMounted, provide, ref, watch } from 'vue';
< import { v4 as uuid } from 'uuid';
< import XCommon from './_common_/common.vue';
< import { deckStore, addColumn as addColumnToStore, loadDeck, getProfiles, deleteProfile as deleteProfile_ } from './deck/deck-store';
< import DeckColumnCore from '@/ui/deck/column-core.vue';
< import XSidebar from '@/ui/_common_/navbar.vue';
< import XDrawerMenu from '@/ui/_common_/navbar-for-mobile.vue';
< import MkButton from '@/components/MkButton.vue';
< import { getScrollContainer } from '@/scripts/scroll';
< import * as os from '@/os';
< import { navbarItemDef } from '@/navbar';
< import { $i } from '@/account';
< import { i18n } from '@/i18n';
< import { mainRouter } from '@/router';
< import { unisonReload } from '@/scripts/unison-reload';
< const XStatusBars = defineAsyncComponent(() => import('@/ui/_common_/statusbars.vue'));
---
> import {
>   computed,
>   defineAsyncComponent,
>   onMounted,
>   provide,
>   ref,
>   watch,
> } from "vue";
> import { v4 as uuid } from "uuid";
> import XCommon from "./_common_/common.vue";
> import {
>   deckStore,
>   addColumn as addColumnToStore,
>   loadDeck,
>   getProfiles,
>   deleteProfile as deleteProfile_,
> } from "./deck/deck-store";
> import DeckColumnCore from "@/ui/deck/column-core.vue";
> import XSidebar from "@/ui/_common_/navbar.vue";
> import XDrawerMenu from "@/ui/_common_/navbar-for-mobile.vue";
> import MkButton from "@/components/MkButton.vue";
> import { getScrollContainer } from "@/scripts/scroll";
> import * as os from "@/os";
> import { navbarItemDef } from "@/navbar";
> import { $i } from "@/account";
> import { i18n } from "@/i18n";
> import { mainRouter } from "@/router";
> import { unisonReload } from "@/scripts/unison-reload";
> const XStatusBars = defineAsyncComponent(
>   () => import("@/ui/_common_/statusbars.vue")
> );
104,110c174,180
< 	if (flag === 'forcePage') return false;
< 	const noMainColumn = !deckStore.state.columns.some(x => x.type === 'main');
< 	if (deckStore.state.navWindow || noMainColumn) {
< 		os.pageWindow(path);
< 		return true;
< 	}
< 	return false;
---
>   if (flag === "forcePage") return false;
>   const noMainColumn = !deckStore.state.columns.some((x) => x.type === "main");
>   if (deckStore.state.navWindow || noMainColumn) {
>     os.pageWindow(path);
>     return true;
>   }
>   return false;
114,115c184,185
< window.addEventListener('resize', () => {
< 	isMobile.value = window.innerWidth <= 500;
---
> window.addEventListener("resize", () => {
>   isMobile.value = window.innerWidth <= 500;
120c190
< const route = 'TODO';
---
> const route = "TODO";
122c192
< 	drawerMenuShowing.value = false;
---
>   drawerMenuShowing.value = false;
128,132c198,202
< 	if ($i == null) return false;
< 	for (const def in navbarItemDef) {
< 		if (navbarItemDef[def].indicated) return true;
< 	}
< 	return false;
---
>   if ($i == null) return false;
>   for (const def in navbarItemDef) {
>     if (navbarItemDef[def].indicated) return true;
>   }
>   return false;
136c206
< 	os.pageWindow('/settings/deck');
---
>   os.pageWindow("/settings/deck");
139c209
< let columnsEl = $shallowRef<HTMLElement>();
---
> let columnsEl = $ref<HTMLElement>();
142,151c212,221
< 	const columns = [
< 		'main',
< 		'widgets',
< 		'notifications',
< 		'tl',
< 		'antenna',
< 		'list',
< 		'mentions',
< 		'direct',
< 	];
---
>   const columns = [
>     "main",
>     "widgets",
>     "notifications",
>     "tl",
>     "antenna",
>     "list",
>     "mentions",
>     "direct",
>   ];
153,159c223,230
< 	const { canceled, result: column } = await os.select({
< 		title: i18n.ts._deck.addColumn,
< 		items: columns.map(column => ({
< 			value: column, text: i18n.t('_deck._columns.' + column),
< 		})),
< 	});
< 	if (canceled) return;
---
>   const { canceled, result: column } = await os.select({
>     title: i18n.ts._deck.addColumn,
>     items: columns.map((column) => ({
>       value: column,
>       text: i18n.t("_deck._columns." + column),
>     })),
>   });
>   if (canceled) return;
161,166c232,237
< 	addColumnToStore({
< 		type: column,
< 		id: uuid(),
< 		name: i18n.t('_deck._columns.' + column),
< 		width: 330,
< 	});
---
>   addColumnToStore({
>     type: column,
>     id: uuid(),
>     name: i18n.t("_deck._columns." + column),
>     width: 330,
>   });
170,173c241,249
< 	os.contextMenu([{
< 		text: i18n.ts._deck.addColumn,
< 		action: addColumn,
< 	}], ev);
---
>   os.contextMenu(
>     [
>       {
>         text: i18n.ts._deck.addColumn,
>         action: addColumn,
>       },
>     ],
>     ev
>   );
176,183c252,262
< document.documentElement.style.overflowY = 'hidden';
< document.documentElement.style.scrollBehavior = 'auto';
< window.addEventListener('wheel', (ev) => {
< 	if (ev.target === columnsEl && ev.deltaX === 0) {
< 		columnsEl.scrollLeft += ev.deltaY;
< 	} else if (getScrollContainer(ev.target as HTMLElement) == null && ev.deltaX === 0) {
< 		columnsEl.scrollLeft += ev.deltaY;
< 	}
---
> document.documentElement.style.overflowY = "hidden";
> document.documentElement.style.scrollBehavior = "auto";
> window.addEventListener("wheel", (ev) => {
>   if (ev.target === columnsEl && ev.deltaX === 0) {
>     columnsEl.scrollLeft += ev.deltaY;
>   } else if (
>     getScrollContainer(ev.target as HTMLElement) == null &&
>     ev.deltaX === 0
>   ) {
>     columnsEl.scrollLeft += ev.deltaY;
>   }
187,188c266,267
< function moveFocus(id: string, direction: 'up' | 'down' | 'left' | 'right') {
< 	// TODO??
---
> function moveFocus(id: string, direction: "up" | "down" | "left" | "right") {
>   // TODO??
192,214c271,301
< 	const items = ref([{
< 		text: deckStore.state.profile,
< 		active: true.valueOf,
< 	}]);
< 	getProfiles().then(profiles => {
< 		items.value = [{
< 			text: deckStore.state.profile,
< 			active: true.valueOf,
< 		}, ...(profiles.filter(k => k !== deckStore.state.profile).map(k => ({
< 			text: k,
< 			action: () => {
< 				deckStore.set('profile', k);
< 				unisonReload();
< 			},
< 		}))), null, {
< 			text: i18n.ts._deck.newProfile,
< 			icon: 'ti ti-plus',
< 			action: async () => {
< 				const { canceled, result: name } = await os.inputText({
< 					title: i18n.ts._deck.profile,
< 					allowEmpty: false,
< 				});
< 				if (canceled) return;
---
>   const items = ref([
>     {
>       text: deckStore.state.profile,
>       active: true.valueOf,
>     },
>   ]);
>   getProfiles().then((profiles) => {
>     items.value = [
>       {
>         text: deckStore.state.profile,
>         active: true.valueOf,
>       },
>       ...profiles
>         .filter((k) => k !== deckStore.state.profile)
>         .map((k) => ({
>           text: k,
>           action: () => {
>             deckStore.set("profile", k);
>             unisonReload();
>           },
>         })),
>       null,
>       {
>         text: i18n.ts._deck.newProfile,
>         icon: "fas fa-plus",
>         action: async () => {
>           const { canceled, result: name } = await os.inputText({
>             title: i18n.ts._deck.profile,
>             allowEmpty: false,
>           });
>           if (canceled) return;
216,221c303,309
< 				deckStore.set('profile', name);
< 				unisonReload();
< 			},
< 		}];
< 	});
< 	os.popupMenu(items, ev.currentTarget ?? ev.target);
---
>           deckStore.set("profile", name);
>           unisonReload();
>         },
>       },
>     ];
>   });
>   os.popupMenu(items, ev.currentTarget ?? ev.target);
225,229c313,317
< 	const { canceled } = await os.confirm({
< 		type: 'warning',
< 		text: i18n.t('deleteAreYouSure', { x: deckStore.state.profile }),
< 	});
< 	if (canceled) return;
---
>   const { canceled } = await os.confirm({
>     type: "warning",
>     text: i18n.t("deleteAreYouSure", { x: deckStore.state.profile }),
>   });
>   if (canceled) return;
231,233c319,321
< 	deleteProfile_(deckStore.state.profile);
< 	deckStore.set('profile', 'default');
< 	unisonReload();
---
>   deleteProfile_(deckStore.state.profile);
>   deckStore.set("profile", "default");
>   unisonReload();
237,241c325,331
< <style lang="scss" module>
< .transition_menuDrawerBg_enterActive,
< .transition_menuDrawerBg_leaveActive {
< 	opacity: 1;
< 	transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> <style lang="scss" scoped>
> .menu-enter-active,
> .menu-leave-active {
>   opacity: 1;
>   transform: translateX(0);
>   transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
243,245c333,336
< .transition_menuDrawerBg_enterFrom,
< .transition_menuDrawerBg_leaveTo {
< 	opacity: 0;
---
> .menu-enter-from,
> .menu-leave-active {
>   opacity: 0;
>   transform: translateX(-240px);
248,252c339,342
< .transition_menuDrawer_enterActive,
< .transition_menuDrawer_leaveActive {
< 	opacity: 1;
< 	transform: translateX(0);
< 	transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1), opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> .menu-back-enter-active,
> .menu-back-leave-active {
>   opacity: 1;
>   transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
254,257c344,346
< .transition_menuDrawer_enterFrom,
< .transition_menuDrawer_leaveTo {
< 	opacity: 0;
< 	transform: translateX(-240px);
---
> .menu-back-enter-from,
> .menu-back-leave-active {
>   opacity: 0;
260,261c349,350
< .root {
< 	$nav-hide-threshold: 650px; // TODO: どこかに集約したい
---
> .mk-deck {
>   $nav-hide-threshold: 650px; // TODO: どこかに集約したい
263c352,353
< 	--margin: var(--marginHalf);
---
>   // TODO: ここではなくて、各カラムで自身の幅に応じて上書きするようにしたい
>   --margin: var(--marginHalf);
265c355
< 	--deckDividerThickness: 5px;
---
>   --deckDividerThickness: 5px;
267,271c357,360
< 	display: flex;
< 	height: 100dvh;
< 	box-sizing: border-box;
< 	flex: 1;
< }
---
>   display: flex;
>   height: 100dvh;
>   box-sizing: border-box;
>   flex: 1;
273,275c362,364
< .rootIsMobile {
< 	padding-bottom: 100px;
< }
---
>   &.isMobile {
>     padding-bottom: 100px;
>   }
277,282c366,370
< .main {
< 	flex: 1;
< 	min-width: 0;
< 	display: flex;
< 	flex-direction: column;
< }
---
>   > .main {
>     flex: 1;
>     min-width: 0;
>     display: flex;
>     flex-direction: column;
284,288c372,376
< .columns {
< 	flex: 1;
< 	display: flex;
< 	overflow-x: auto;
< 	overflow-y: clip;
---
>     > .columns {
>       flex: 1;
>       display: flex;
>       overflow-x: auto;
>       overflow-y: clip;
290,293c378,381
< 	&.center {
< 		> .column:first-of-type {
< 			margin-left: auto;
< 		}
---
>       &.center {
>         > .column:first-of-type {
>           margin-left: auto;
>         }
295,299c383,386
< 		> .column:last-of-type {
< 			margin-right: auto;
< 		}
< 	}
< }
---
>         > .column:last-of-type {
>           margin-right: auto;
>         }
>       }
301,303c388,390
< .column {
< 	flex-shrink: 0;
< 	border-right: solid var(--deckDividerThickness) var(--deckDivider);
---
>       > .column {
>         flex-shrink: 0;
>         border-right: solid var(--deckDividerThickness) var(--deckDivider);
305,308c392,394
< 	&:first-of-type {
< 		border-left: solid var(--deckDividerThickness) var(--deckDivider);
< 	}
< }
---
>         &:first-of-type {
>           border-left: solid var(--deckDividerThickness) var(--deckDivider);
>         }
310,313c396,398
< .folder {
< 	composes: column;
< 	display: flex;
< 	flex-direction: column;
---
>         &.folder {
>           display: flex;
>           flex-direction: column;
315,318c400,404
< 	> *:not(:last-of-type) {
< 		border-bottom: solid var(--deckDividerThickness) var(--deckDivider);
< 	}
< }
---
>           > *:not(:last-of-type) {
>             border-bottom: solid var(--deckDividerThickness) var(--deckDivider);
>           }
>         }
>       }
320,325c406,410
< .onboarding {
< 	padding: 32px;
< 	height: min-content;
< 	text-align: center;
< 	margin: auto;
< }
---
>       > .intro {
>         padding: 32px;
>         height: min-content;
>         text-align: center;
>         margin: auto;
327,335c412,415
< .sideMenu {
< 	flex-shrink: 0;
< 	margin-right: 0;
< 	margin-left: auto;
< 	display: flex;
< 	flex-direction: column;
< 	justify-content: center;
< 	width: 32px;
< }
---
>         > .add {
>           margin: 1em auto;
>         }
>       }
337,341c417,424
< .sideMenuButton {
< 	display: block;
< 	width: 100%;
< 	aspect-ratio: 1;
< }
---
>       > .sideMenu {
>         flex-shrink: 0;
>         margin-right: 0;
>         margin-left: auto;
>         display: flex;
>         flex-direction: column;
>         justify-content: center;
>         width: 32px;
343,345c426,434
< .sideMenuTop {
< 	margin-bottom: auto;
< }
---
>         > .top,
>         > .middle,
>         > .bottom {
>           > .button {
>             display: block;
>             width: 100%;
>             aspect-ratio: 1;
>           }
>         }
347,350c436,438
< .sideMenuMiddle {
< 	margin-top: auto;
< 	margin-bottom: auto;
< }
---
>         > .top {
>           margin-bottom: auto;
>         }
352,354c440,443
< .sideMenuBottom {
< 	margin-top: auto;
< }
---
>         > .middle {
>           margin-top: auto;
>           margin-bottom: auto;
>         }
356,358c445,450
< .menuBg {
< 	z-index: 1001;
< }
---
>         > .bottom {
>           margin-top: auto;
>         }
>       }
>     }
>   }
360,372c452,460
< .menu {
< 	position: fixed;
< 	top: 0;
< 	left: 0;
< 	z-index: 1001;
< 	height: 100dvh;
< 	width: 240px;
< 	box-sizing: border-box;
< 	contain: strict;
< 	overflow: auto;
< 	overscroll-behavior: contain;
< 	background: var(--navBg);
< }
---
>   > .buttons {
>     position: fixed;
>     z-index: 1000;
>     bottom: 0;
>     left: 0;
>     padding: 16px;
>     display: flex;
>     width: 100%;
>     box-sizing: border-box;
374,389c462,470
< .nav {
< 	position: fixed;
< 	z-index: 1000;
< 	bottom: 0;
< 	left: 0;
< 	padding: 12px 12px max(12px, env(safe-area-inset-bottom, 0px)) 12px;
< 	display: grid;
< 	grid-template-columns: 1fr 1fr 1fr 1fr;
< 	grid-gap: 8px;
< 	width: 100%;
< 	box-sizing: border-box;
< 	-webkit-backdrop-filter: var(--blur, blur(32px));
< 	backdrop-filter: var(--blur, blur(32px));
< 	background-color: var(--header);
< 	border-top: solid 0.5px var(--divider);
< }
---
>     > .button {
>       position: relative;
>       flex: 1;
>       padding: 0;
>       margin: auto;
>       height: 64px;
>       border-radius: 8px;
>       background: var(--panel);
>       color: var(--fg);
391,400c472,474
< .navButton {
< 	position: relative;
< 	padding: 0;
< 	aspect-ratio: 1;
< 	width: 100%;
< 	max-width: 60px;
< 	margin: auto;
< 	border-radius: 100%;
< 	background: var(--panel);
< 	color: var(--fg);
---
>       &:not(:last-child) {
>         margin-right: 12px;
>       }
402,404c476,477
< 	&:hover {
< 		background: var(--panelHighlight);
< 	}
---
>       @media (max-width: 400px) {
>         height: 60px;
406,409c479,482
< 	&:active {
< 		background: var(--X2);
< 	}
< }
---
>         &:not(:last-child) {
>           margin-right: 8px;
>         }
>       }
411,414c484,486
< .postButton {
< 	composes: navButton;
< 	background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< 	color: var(--fgOnAccent);
---
>       &:hover {
>         background: var(--X2);
>       }
416,418c488,495
< 	&:hover {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
---
>       > .indicator {
>         position: absolute;
>         top: 0;
>         left: 0;
>         color: var(--indicator);
>         font-size: 16px;
>         animation: blink 1s infinite;
>       }
420,423c497,499
< 	&:active {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
< }
---
>       &:first-child {
>         margin-left: 0;
>       }
425,428c501,503
< .navButtonIcon {
< 	font-size: 18px;
< 	vertical-align: middle;
< }
---
>       &:last-child {
>         margin-right: 0;
>       }
430,436c505,535
< .navButtonIndicator {
< 	position: absolute;
< 	top: 0;
< 	left: 0;
< 	color: var(--indicator);
< 	font-size: 16px;
< 	animation: blink 1s infinite;
---
>       > * {
>         font-size: 20px;
>       }
> 
>       &:disabled {
>         cursor: default;
> 
>         > * {
>           opacity: 0.5;
>         }
>       }
>     }
>   }
> 
>   > .menu-back {
>     z-index: 1001;
>   }
> 
>   > .menu {
>     position: fixed;
>     top: 0;
>     left: 0;
>     z-index: 1001;
>     height: 100dvh;
>     width: 240px;
>     box-sizing: border-box;
>     contain: strict;
>     overflow: auto;
>     overscroll-behavior: contain;
>     background: var(--navBg);
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/universal.vue RiricaV13/ui/universal.vue
2,3c2,3
< <div :class="[$style.root, { [$style.withWallpaper]: wallpaper }]">
< 	<XSidebar v-if="!isMobile" :class="$style.sidebar"/>
---
>   <div class="dkgtipfy" :class="{ wallpaper }">
>     <XSidebar v-if="!isMobile" class="sidebar" />
5,13c5,17
< 	<MkStickyContainer :class="$style.contents">
< 		<template #header><XStatusBars :class="$style.statusbars"/></template>
< 		<main style="min-width: 0;" :style="{ background: pageMetadata?.value?.bg }" @contextmenu.stop="onContextmenu">
< 			<div :class="$style.content" style="container-type: inline-size;">
< 				<RouterView/>
< 			</div>
< 			<div :class="$style.spacer"></div>
< 		</main>
< 	</MkStickyContainer>
---
>     <MkStickyContainer class="contents">
>       <template #header><XStatusBars :class="$style.statusbars" /></template>
>       <main
>         style="min-width: 0"
>         :style="{ background: pageMetadata?.value?.bg }"
>         @contextmenu.stop="onContextmenu"
>       >
>         <div :class="$style.content">
>           <RouterView />
>         </div>
>         <div :class="$style.spacer"></div>
>       </main>
>     </MkStickyContainer>
15,17c19,21
< 	<div v-if="isDesktop" ref="widgetsEl" :class="$style.widgets">
< 		<XWidgets :margin-top="'var(--margin)'" @mounted="attachSticky"/>
< 	</div>
---
>     <div v-if="isDesktop" ref="widgetsEl" class="widgets">
>       <XWidgets @mounted="attachSticky" />
>     </div>
19c23,29
< 	<button v-if="!isDesktop && !isMobile" :class="$style.widgetButton" class="_button" @click="widgetsShowing = true"><i class="ti ti-apps"></i></button>
---
>     <button
>       v-if="!isDesktop && !isMobile"
>       class="widgetButton _button"
>       @click="widgetsShowing = true"
>     >
>       <i class="fas fa-layer-group"></i>
>     </button>
21,27c31,63
< 	<div v-if="isMobile" :class="$style.nav">
< 		<button :class="$style.navButton" class="_button" @click="drawerMenuShowing = true"><i :class="$style.navButtonIcon" class="ti ti-menu-2"></i><span v-if="menuIndicated" :class="$style.navButtonIndicator"><i class="_indicatorCircle"></i></span></button>
< 		<button :class="$style.navButton" class="_button" @click="mainRouter.currentRoute.value.name === 'index' ? top() : mainRouter.push('/')"><i :class="$style.navButtonIcon" class="ti ti-home"></i></button>
< 		<button :class="$style.navButton" class="_button" @click="mainRouter.push('/my/notifications')"><i :class="$style.navButtonIcon" class="ti ti-bell"></i><span v-if="$i?.hasUnreadNotification" :class="$style.navButtonIndicator"><i class="_indicatorCircle"></i></span></button>
< 		<button :class="$style.navButton" class="_button" @click="widgetsShowing = true"><i :class="$style.navButtonIcon" class="ti ti-apps"></i></button>
< 		<button :class="$style.postButton" class="_button" @click="os.post()"><i :class="$style.navButtonIcon" class="ti ti-pencil"></i></button>
< 	</div>
---
>     <div v-if="isMobile" class="buttons">
>       <button class="button nav _button" @click="drawerMenuShowing = true">
>         <i class="fas fa-bars"></i
>         ><span v-if="menuIndicated" class="indicator"
>           ><i class="fas fa-circle"></i
>         ></span>
>       </button>
>       <button
>         class="button home _button"
>         @click="
>           mainRouter.currentRoute.value.name === 'index'
>             ? top()
>             : mainRouter.push('/')
>         "
>       >
>         <i class="fas fa-home"></i>
>       </button>
>       <button
>         class="button notifications _button"
>         @click="mainRouter.push('/my/notifications')"
>       >
>         <i class="fas fa-bell"></i
>         ><span v-if="$i?.hasUnreadNotification" class="indicator"
>           ><i class="fas fa-circle"></i
>         ></span>
>       </button>
>       <button class="button widget _button" @click="widgetsShowing = true">
>         <i class="fas fa-layer-group"></i>
>       </button>
>       <button class="button post _button" @click="os.post()">
>         <i class="fas fa-pencil-alt"></i>
>       </button>
>     </div>
29,42c65,72
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_menuDrawerBg_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_menuDrawerBg_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_menuDrawerBg_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_menuDrawerBg_leaveTo : ''"
< 	>
< 		<div
< 			v-if="drawerMenuShowing"
< 			:class="$style.menuDrawerBg"
< 			class="_modalBg"
< 			@click="drawerMenuShowing = false"
< 			@touchstart.passive="drawerMenuShowing = false"
< 		></div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'menuDrawer-back' : ''">
>       <div
>         v-if="drawerMenuShowing"
>         class="menuDrawer-back _modalBg"
>         @click="drawerMenuShowing = false"
>         @touchstart.passive="drawerMenuShowing = false"
>       ></div>
>     </transition>
44,53c74,76
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_menuDrawer_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_menuDrawer_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_menuDrawer_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_menuDrawer_leaveTo : ''"
< 	>
< 		<div v-if="drawerMenuShowing" :class="$style.menuDrawer">
< 			<XDrawerMenu/>
< 		</div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'menuDrawer' : ''">
>       <XDrawerMenu v-if="drawerMenuShowing" class="menuDrawer" />
>     </transition>
55,68c78,85
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_widgetsDrawerBg_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_widgetsDrawerBg_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_widgetsDrawerBg_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_widgetsDrawerBg_leaveTo : ''"
< 	>
< 		<div
< 			v-if="widgetsShowing"
< 			:class="$style.widgetsDrawerBg"
< 			class="_modalBg"
< 			@click="widgetsShowing = false"
< 			@touchstart.passive="widgetsShowing = false"
< 		></div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'widgetsDrawer-back' : ''">
>       <div
>         v-if="widgetsShowing"
>         class="widgetsDrawer-back _modalBg"
>         @click="widgetsShowing = false"
>         @touchstart.passive="widgetsShowing = false"
>       ></div>
>     </transition>
70,80c87,89
< 	<Transition
< 		:enter-active-class="$store.state.animation ? $style.transition_widgetsDrawer_enterActive : ''"
< 		:leave-active-class="$store.state.animation ? $style.transition_widgetsDrawer_leaveActive : ''"
< 		:enter-from-class="$store.state.animation ? $style.transition_widgetsDrawer_enterFrom : ''"
< 		:leave-to-class="$store.state.animation ? $style.transition_widgetsDrawer_leaveTo : ''"
< 	>
< 		<div v-if="widgetsShowing" :class="$style.widgetsDrawer">
< 			<button class="_button" :class="$style.widgetsCloseButton" @click="widgetsShowing = false"><i class="ti ti-x"></i></button>
< 			<XWidgets/>
< 		</div>
< 	</Transition>
---
>     <transition :name="$store.state.animation ? 'widgetsDrawer' : ''">
>       <XWidgets v-if="widgetsShowing" class="widgetsDrawer" />
>     </transition>
82,83c91,92
< 	<XCommon/>
< </div>
---
>     <XCommon />
>   </div>
87,104c96,126
< import { defineAsyncComponent, provide, onMounted, computed, ref, watch, ComputedRef } from 'vue';
< import XCommon from './_common_/common.vue';
< import { instanceName } from '@/config';
< import { StickySidebar } from '@/scripts/sticky-sidebar';
< import XDrawerMenu from '@/ui/_common_/navbar-for-mobile.vue';
< import * as os from '@/os';
< import { defaultStore } from '@/store';
< import { navbarItemDef } from '@/navbar';
< import { i18n } from '@/i18n';
< import { $i } from '@/account';
< import { Router } from '@/nirax';
< import { mainRouter } from '@/router';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import { deviceKind } from '@/scripts/device-kind';
< import { miLocalStorage } from '@/local-storage';
< const XWidgets = defineAsyncComponent(() => import('./universal.widgets.vue'));
< const XSidebar = defineAsyncComponent(() => import('@/ui/_common_/navbar.vue'));
< const XStatusBars = defineAsyncComponent(() => import('@/ui/_common_/statusbars.vue'));
---
> import {
>   defineAsyncComponent,
>   provide,
>   onMounted,
>   computed,
>   ref,
>   watch,
>   ComputedRef,
> } from "vue";
> import XCommon from "./_common_/common.vue";
> import { instanceName } from "@/config";
> import { StickySidebar } from "@/scripts/sticky-sidebar";
> import XDrawerMenu from "@/ui/_common_/navbar-for-mobile.vue";
> import * as os from "@/os";
> import { defaultStore } from "@/store";
> import { navbarItemDef } from "@/navbar";
> import { i18n } from "@/i18n";
> import { $i } from "@/account";
> import { Router } from "@/nirax";
> import { mainRouter } from "@/router";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
> import { deviceKind } from "@/scripts/device-kind";
> const XWidgets = defineAsyncComponent(() => import("./universal.widgets.vue"));
> const XSidebar = defineAsyncComponent(() => import("@/ui/_common_/navbar.vue"));
> const XStatusBars = defineAsyncComponent(
>   () => import("@/ui/_common_/statusbars.vue")
> );
111,113c133,138
< const isMobile = ref(deviceKind === 'smartphone' || window.innerWidth <= MOBILE_THRESHOLD);
< window.addEventListener('resize', () => {
< 	isMobile.value = deviceKind === 'smartphone' || window.innerWidth <= MOBILE_THRESHOLD;
---
> const isMobile = ref(
>   deviceKind === "smartphone" || window.innerWidth <= MOBILE_THRESHOLD
> );
> window.addEventListener("resize", () => {
>   isMobile.value =
>     deviceKind === "smartphone" || window.innerWidth <= MOBILE_THRESHOLD;
117c142
< const widgetsEl = $shallowRef<HTMLElement>();
---
> const widgetsEl = $ref<HTMLElement>();
120c145
< provide('router', mainRouter);
---
> provide("router", mainRouter);
122,125c147,150
< 	pageMetadata = info;
< 	if (pageMetadata.value) {
< 		document.title = `${pageMetadata.value.title} | ${instanceName}`;
< 	}
---
>   pageMetadata = info;
>   if (pageMetadata.value) {
>     document.title = `${pageMetadata.value.title} | ${instanceName}`;
>   }
129,133c154,158
< 	for (const def in navbarItemDef) {
< 		if (def === 'notifications') continue; // 通知は下にボタンとして表示されてるから
< 		if (navbarItemDef[def].indicated) return true;
< 	}
< 	return false;
---
>   for (const def in navbarItemDef) {
>     if (def === "notifications") continue; // 通知は下にボタンとして表示されてるから
>     if (navbarItemDef[def].indicated) return true;
>   }
>   return false;
138,139c163,164
< mainRouter.on('change', () => {
< 	drawerMenuShowing.value = false;
---
> mainRouter.on("change", () => {
>   drawerMenuShowing.value = false;
142c167
< document.documentElement.style.overflowY = 'scroll';
---
> document.documentElement.style.overflowY = "scroll";
144,157c169,190
< defaultStore.ready.then(() => {
< 	if (defaultStore.state.widgets.length === 0) {
< 		defaultStore.set('widgets', [{
< 			name: 'calendar',
< 			id: 'a', place: 'right', data: {},
< 		}, {
< 			name: 'notifications',
< 			id: 'b', place: 'right', data: {},
< 		}, {
< 			name: 'trends',
< 			id: 'c', place: 'right', data: {},
< 		}]);
< 	}
< });
---
> if (defaultStore.state.widgets.length === 0) {
>   defaultStore.set("widgets", [
>     {
>       name: "calendar",
>       id: "a",
>       place: "right",
>       data: {},
>     },
>     {
>       name: "notifications",
>       id: "b",
>       place: "right",
>       data: {},
>     },
>     {
>       name: "trends",
>       id: "c",
>       place: "right",
>       data: {},
>     },
>   ]);
> }
160,164c193,201
< 	if (!isDesktop.value) {
< 		window.addEventListener('resize', () => {
< 			if (window.innerWidth >= DESKTOP_THRESHOLD) isDesktop.value = true;
< 		}, { passive: true });
< 	}
---
>   if (!isDesktop.value) {
>     window.addEventListener(
>       "resize",
>       () => {
>         if (window.innerWidth >= DESKTOP_THRESHOLD) isDesktop.value = true;
>       },
>       { passive: true }
>     );
>   }
168,187c205,236
< 	const isLink = (el: HTMLElement) => {
< 		if (el.tagName === 'A') return true;
< 		if (el.parentElement) {
< 			return isLink(el.parentElement);
< 		}
< 	};
< 	if (isLink(ev.target)) return;
< 	if (['INPUT', 'TEXTAREA', 'IMG', 'VIDEO', 'CANVAS'].includes(ev.target.tagName) || ev.target.attributes['contenteditable']) return;
< 	if (window.getSelection()?.toString() !== '') return;
< 	const path = mainRouter.getCurrentPath();
< 	os.contextMenu([{
< 		type: 'label',
< 		text: path,
< 	}, {
< 		icon: 'ti ti-window-maximize',
< 		text: i18n.ts.openInWindow,
< 		action: () => {
< 			os.pageWindow(path);
< 		},
< 	}], ev);
---
>   const isLink = (el: HTMLElement) => {
>     if (el.tagName === "A") return true;
>     if (el.parentElement) {
>       return isLink(el.parentElement);
>     }
>   };
>   if (isLink(ev.target)) return;
>   if (
>     ["INPUT", "TEXTAREA", "IMG", "VIDEO", "CANVAS"].includes(
>       ev.target.tagName
>     ) ||
>     ev.target.attributes["contenteditable"]
>   )
>     return;
>   if (window.getSelection()?.toString() !== "") return;
>   const path = mainRouter.getCurrentPath();
>   os.contextMenu(
>     [
>       {
>         type: "label",
>         text: path,
>       },
>       {
>         icon: "fas fa-window-maximize",
>         text: i18n.ts.openInWindow,
>         action: () => {
>           os.pageWindow(path);
>         },
>       },
>     ],
>     ev
>   );
191,194c240,247
< 	const sticky = new StickySidebar(widgetsEl);
< 	window.addEventListener('scroll', () => {
< 		sticky.calc(window.scrollY);
< 	}, { passive: true });
---
>   const sticky = new StickySidebar(widgetsEl);
>   window.addEventListener(
>     "scroll",
>     () => {
>       sticky.calc(window.scrollY);
>     },
>     { passive: true }
>   );
198c251
< 	window.scroll({ top: 0, behavior: 'smooth' });
---
>   window.scroll({ top: 0, behavior: "smooth" });
201c254
< const wallpaper = miLocalStorage.getItem('wallpaper') != null;
---
> const wallpaper = localStorage.getItem("wallpaper") != null;
204,206c257,264
< <style lang="scss" module>
< $ui-font-size: 1em; // TODO: どこかに集約したい
< $widgets-hide-threshold: 1090px;
---
> <style lang="scss">
> .ios .efzpzdvf.widgetsDrawer {
>   padding-top: calc(env(safe-area-inset-top) + var(--margin) ) !important;
>   @supports (bottom: env(safe-area-inset-bottom)) {
>     padding-top: calc(20px + var(--margin) ) !important;
>   }
> }
> </style>
208,211c266,272
< .transition_menuDrawerBg_enterActive,
< .transition_menuDrawerBg_leaveActive {
< 	opacity: 1;
< 	transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> <style lang="scss" scoped>
> .widgetsDrawer-enter-active,
> .widgetsDrawer-leave-active {
>   opacity: 1;
>   transform: translateX(0);
>   transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
213,215c274,277
< .transition_menuDrawerBg_enterFrom,
< .transition_menuDrawerBg_leaveTo {
< 	opacity: 0;
---
> .widgetsDrawer-enter-from,
> .widgetsDrawer-leave-active {
>   opacity: 0;
>   transform: translateX(240px);
218,222c280,283
< .transition_menuDrawer_enterActive,
< .transition_menuDrawer_leaveActive {
< 	opacity: 1;
< 	transform: translateX(0);
< 	transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1), opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> .widgetsDrawer-back-enter-active,
> .widgetsDrawer-back-leave-active {
>   opacity: 1;
>   transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
224,227c285,287
< .transition_menuDrawer_enterFrom,
< .transition_menuDrawer_leaveTo {
< 	opacity: 0;
< 	transform: translateX(-240px);
---
> .widgetsDrawer-back-enter-from,
> .widgetsDrawer-back-leave-active {
>   opacity: 0;
230,233c290,295
< .transition_widgetsDrawerBg_enterActive,
< .transition_widgetsDrawerBg_leaveActive {
< 	opacity: 1;
< 	transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> .menuDrawer-enter-active,
> .menuDrawer-leave-active {
>   opacity: 1;
>   transform: translateX(0);
>   transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
235,237c297,300
< .transition_widgetsDrawerBg_enterFrom,
< .transition_widgetsDrawerBg_leaveTo {
< 	opacity: 0;
---
> .menuDrawer-enter-from,
> .menuDrawer-leave-active {
>   opacity: 0;
>   transform: translateX(-240px);
240,244c303,306
< .transition_widgetsDrawer_enterActive,
< .transition_widgetsDrawer_leaveActive {
< 	opacity: 1;
< 	transform: translateX(0);
< 	transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1), opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
> .menuDrawer-back-enter-active,
> .menuDrawer-back-leave-active {
>   opacity: 1;
>   transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
246,249c308,310
< .transition_widgetsDrawer_enterFrom,
< .transition_widgetsDrawer_leaveTo {
< 	opacity: 0;
< 	transform: translateX(240px);
---
> .menuDrawer-back-enter-from,
> .menuDrawer-back-leave-active {
>   opacity: 0;
252,256c313,315
< .root {
< 	min-height: 100dvh;
< 	box-sizing: border-box;
< 	display: flex;
< }
---
> .dkgtipfy {
>   $ui-font-size: 1em; // TODO: どこかに集約したい
>   $widgets-hide-threshold: 1090px;
258,261d316
< .withWallpaper {
< 	background: var(--wallpaperOverlay);
< 	//backdrop-filter: var(--blur, blur(4px));
< }
263,265c318,320
< .sidebar {
< 	border-right: solid 0.5px var(--divider);
< }
---
>   min-height: 100dvh;
>   box-sizing: border-box;
>   display: flex;
267,271c322,325
< .contents {
< 	width: 100%;
< 	min-width: 0;
< 	background: var(--bg);
< }
---
>   &.wallpaper {
>     background: var(--wallpaperOverlay);
>     //backdrop-filter: var(--blur, blur(4px));
>   }
273,276c327,329
< .widgets {
< 	padding: 0 var(--margin);
< 	border-left: solid 0.5px var(--divider);
< 	background: var(--bg);
---
>   > .sidebar {
>     border-right: solid 0.5px var(--divider);
>   }
278,281c331,335
< 	@media (max-width: $widgets-hide-threshold) {
< 		display: none;
< 	}
< }
---
>   > .contents {
>     width: 100%;
>     min-width: 0;
>     background: var(--bg);
>   }
283,295c337,340
< .widgetButton {
< 	display: block;
< 	position: fixed;
< 	z-index: 1000;
< 	bottom: 32px;
< 	right: 32px;
< 	width: 64px;
< 	height: 64px;
< 	border-radius: 100%;
< 	box-shadow: 0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);
< 	font-size: 22px;
< 	background: var(--panel);
< }
---
>   > .widgets {
>     padding: 0 var(--margin);
>     border-left: solid 0.5px var(--divider);
>     background: var(--bg);
297,299c342,345
< .widgetsDrawerBg {
< 	z-index: 1001;
< }
---
>     @media (max-width: $widgets-hide-threshold) {
>       display: none;
>     }
>   }
301,312c347,360
< .widgetsDrawer {
< 	position: fixed;
< 	top: 0;
< 	right: 0;
< 	z-index: 1001;
< 	height: 100dvh;
< 	padding: var(--margin) !important;
< 	box-sizing: border-box;
< 	overflow: auto;
< 	overscroll-behavior: contain;
< 	background: var(--bg);
< }
---
>   > .widgetButton {
>     display: block;
>     position: fixed;
>     z-index: 1000;
>     bottom: 32px;
>     right: 32px;
>     width: 64px;
>     height: 64px;
>     border-radius: 100%;
>     box-shadow: 0 3px 5px -1px rgba(0, 0, 0, 0.2),
>       0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);
>     font-size: 22px;
>     background: var(--panel);
>   }
314,318c362,364
< .widgetsCloseButton {
< 	padding: 8px;
< 	display: block;
< 	margin: 0 auto;
< }
---
>   > .widgetsDrawer-back {
>     z-index: 1001;
>   }
320,324c366,372
< @media (min-width: 370px) {
< 	.widgetsCloseButton {
< 		display: none;
< 	}
< }
---
>   > .widgetsDrawer {
>     position: fixed;
>     top: 0;
>     right: 0;
>     z-index: 1001;
>     height: 100dvh;
>     padding: var(--margin);
326,341c374,377
< .nav {
< 	position: fixed;
< 	z-index: 1000;
< 	bottom: 0;
< 	left: 0;
< 	padding: 12px 12px max(12px, env(safe-area-inset-bottom, 0px)) 12px;
< 	display: grid;
< 	grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
< 	grid-gap: 8px;
< 	width: 100%;
< 	box-sizing: border-box;
< 	-webkit-backdrop-filter: var(--blur, blur(32px));
< 	backdrop-filter: var(--blur, blur(32px));
< 	background-color: var(--header);
< 	border-top: solid 0.5px var(--divider);
< }
---
>     box-sizing: border-box;
>     overflow: auto;
>     overscroll-behavior: contain;
>     background: var(--bg);
343,352c379
< .navButton {
< 	position: relative;
< 	padding: 0;
< 	aspect-ratio: 1;
< 	width: 100%;
< 	max-width: 60px;
< 	margin: auto;
< 	border-radius: 100%;
< 	background: var(--panel);
< 	color: var(--fg);
---
>   }
354,356d380
< 	&:hover {
< 		background: var(--panelHighlight);
< 	}
358,361c382,394
< 	&:active {
< 		background: var(--X2);
< 	}
< }
---
>   > .buttons {
>     position: fixed;
>     z-index: 1000;
>     bottom: 0;
>     left: 0;
>     padding: 16px 16px calc(env(safe-area-inset-bottom, 0px) + 16px) 16px;
>     display: flex;
>     width: 100%;
>     box-sizing: border-box;
>     -webkit-backdrop-filter: var(--blur, blur(32px));
>     backdrop-filter: var(--blur, blur(32px));
>     background-color: var(--header);
>     border-top: solid 0.5px var(--divider);
363,366c396,404
< .postButton {
< 	composes: navButton;
< 	background: linear-gradient(90deg, var(--buttonGradateA), var(--buttonGradateB));
< 	color: var(--fgOnAccent);
---
>     > .button {
>       position: relative;
>       flex: 1;
>       padding: 0;
>       margin: auto;
>       height: 64px;
>       border-radius: 8px;
>       background: var(--panel);
>       color: var(--fg);
368,370c406,408
< 	&:hover {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
---
>       &:not(:last-child) {
>         margin-right: 12px;
>       }
372,375c410,411
< 	&:active {
< 		background: linear-gradient(90deg, var(--X8), var(--X8));
< 	}
< }
---
>       @media (max-width: 400px) {
>         height: 60px;
377,380c413,416
< .navButtonIcon {
< 	font-size: 18px;
< 	vertical-align: middle;
< }
---
>         &:not(:last-child) {
>           margin-right: 8px;
>         }
>       }
382,389c418,420
< .navButtonIndicator {
< 	position: absolute;
< 	top: 0;
< 	left: 0;
< 	color: var(--indicator);
< 	font-size: 16px;
< 	animation: blink 1s infinite;
< }
---
>       &:hover {
>         background: var(--X2);
>       }
391,393c422,429
< .menuDrawerBg {
< 	z-index: 1001;
< }
---
>       > .indicator {
>         position: absolute;
>         top: 0;
>         left: 0;
>         color: var(--indicator);
>         font-size: 16px;
>         animation: blink 1s infinite;
>       }
395,406c431,469
< .menuDrawer {
< 	position: fixed;
< 	top: 0;
< 	left: 0;
< 	z-index: 1001;
< 	height: 100dvh;
< 	width: 240px;
< 	box-sizing: border-box;
< 	contain: strict;
< 	overflow: auto;
< 	overscroll-behavior: contain;
< 	background: var(--navBg);
---
>       &:first-child {
>         margin-left: 0;
>       }
> 
>       &:last-child {
>         margin-right: 0;
>       }
> 
>       > * {
>         font-size: 20px;
>       }
> 
>       &:disabled {
>         cursor: default;
> 
>         > * {
>           opacity: 0.5;
>         }
>       }
>     }
>   }
> 
>   > .menuDrawer-back {
>     z-index: 1001;
>   }
> 
>   > .menuDrawer {
>     position: fixed;
>     top: 0;
>     left: 0;
>     z-index: 1001;
>     height: 100dvh;
>     width: 240px;
>     box-sizing: border-box;
>     contain: strict;
>     overflow: auto;
>     overscroll-behavior: contain;
>     background: var(--navBg);
>   }
407a471
> </style>
408a473
> <style lang="scss" module>
410,412c475,477
< 	position: sticky;
< 	top: 0;
< 	left: 0;
---
>   position: sticky;
>   top: 0;
>   left: 0;
416c481,487
< 	height: calc(var(--minBottomSpacing));
---
>   $widgets-hide-threshold: 1090px;
> 
>   height: calc(env(safe-area-inset-bottom, 0px) + 96px);
> 
>   @media (min-width: ($widgets-hide-threshold + 1px)) {
>     display: none;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/universal.widgets.vue RiricaV13/ui/universal.widgets.vue
2,3c2,11
< <div :class="$style.root" :style="{ paddingTop: marginTop }">
< 	<XWidgets :class="$style.widgets" :edit="editMode" :widgets="widgets" @add-widget="addWidget" @remove-widget="removeWidget" @update-widget="updateWidget" @update-widgets="updateWidgets" @exit="editMode = false"/>
---
> <div class="efzpzdvf">
> 	<XWidgets
> 		:edit="editMode"
> 		:widgets="defaultStore.reactiveState.widgets.value"
> 		@add-widget="addWidget"
> 		@remove-widget="removeWidget"
> 		@update-widget="updateWidget"
> 		@update-widgets="updateWidgets"
> 		@exit="editMode = false"
> 	/>
5,6c13,28
< 	<button v-if="editMode" class="_textButton" style="font-size: 0.9em;" @click="editMode = false"><i class="ti ti-check"></i> {{ i18n.ts.editWidgetsExit }}</button>
< 	<button v-else class="_textButton mk-widget-edit" style="font-size: 0.9em;" @click="editMode = true"><i class="ti ti-pencil"></i> {{ i18n.ts.editWidgets }}</button>
---
> 	<button
> 		v-if="editMode"
> 		class="_textButton"
> 		style="font-size: 0.9em"
> 		@click="editMode = false"
> 	>
> 		<i class="fas fa-check"></i> {{ i18n.ts.editWidgetsExit }}
> 	</button>
> 	<button
> 		v-else
> 		class="_textButton mk-widget-edit"
> 		style="font-size: 0.9em"
> 		@click="editMode = true"
> 	>
> 		<i class="fas fa-pencil-alt"></i> {{ i18n.ts.editWidgets }}
> 	</button>
10,12d31
< <script lang="ts">
< let editMode = $ref(false);
< </script>
14,17c33,36
< import { onMounted } from 'vue';
< import XWidgets from '@/components/MkWidgets.vue';
< import { i18n } from '@/i18n';
< import { defaultStore } from '@/store';
---
> import { onMounted } from "vue";
> import XWidgets from "@/components/MkWidgets.vue";
> import { i18n } from "@/i18n";
> import { defaultStore } from "@/store";
19,29d37
< const props = withDefaults(defineProps<{
< 	// null = 全てのウィジェットを表示
< 	// left = place: leftだけを表示
< 	// right = rightとnullを表示
< 	place?: 'left' | null | 'right';
< 	marginTop?: string;
< }>(), {
< 	place: null,
< 	marginTop: '0',
< });
< 
31c39
< 	(ev: 'mounted', el?: Element): void;
---
>   (ev: "mounted", el: Element): void;
34c42,43
< let rootEl = $shallowRef<HTMLDivElement>();
---
> let editMode = $ref(false);
> let rootEl = $ref<HTMLDivElement>();
36,41d44
< const widgets = $computed(() => {
< 	if (props.place === null) return defaultStore.reactiveState.widgets.value;
< 	if (props.place === 'left') return defaultStore.reactiveState.widgets.value.filter(w => w.place === 'left');
< 	return defaultStore.reactiveState.widgets.value.filter(w => w.place !== 'left');
< });
< 
43c46
< 	emit('mounted', rootEl);
---
>   emit("mounted", rootEl);
47,50c50,56
< 	defaultStore.set('widgets', [{
< 		...widget,
< 		place: props.place,
< 	}, ...defaultStore.state.widgets]);
---
>   defaultStore.set("widgets", [
>     {
>       ...widget,
>       place: null,
>     },
>     ...defaultStore.state.widgets,
>   ]);
54c60,63
< 	defaultStore.set('widgets', defaultStore.state.widgets.filter(w => w.id !== widget.id));
---
>   defaultStore.set(
>     "widgets",
>     defaultStore.state.widgets.filter((w) => w.id !== widget.id)
>   );
58,62c67,77
< 	defaultStore.set('widgets', defaultStore.state.widgets.map(w => w.id === id ? {
< 		...w,
< 		data,
< 		place: props.place,
< 	} : w));
---
>   defaultStore.set(
>     "widgets",
>     defaultStore.state.widgets.map((w) =>
>       w.id === id
>         ? {
>             ...w,
>             data,
>           }
>         : w
>     )
>   );
65,80c80,81
< function updateWidgets(thisWidgets) {
< 	if (props.place === null) {
< 		defaultStore.set('widgets', thisWidgets);
< 		return;
< 	}
< 	if (props.place === 'left') {
< 		defaultStore.set('widgets', [
< 			...thisWidgets.map(w => ({ ...w, place: 'left' })),
< 			...defaultStore.state.widgets.filter(w => w.place !== 'left' && !thisWidgets.some(t => w.id === t.id)),
< 		]);
< 		return;
< 	}
< 	defaultStore.set('widgets', [
< 		...defaultStore.state.widgets.filter(w => w.place === 'left' && !thisWidgets.some(t => w.id === t.id)),
< 		...thisWidgets.map(w => ({ ...w, place: 'right' })),
< 	]);
---
> function updateWidgets(widgets) {
>   defaultStore.set("widgets", widgets);
84,89c85,91
< <style lang="scss" module>
< .root {
< 	position: sticky;
< 	height: min-content;
< 	box-sizing: border-box;
< }
---
> <style lang="scss" scoped>
> .efzpzdvf {
>   position: sticky;
>   height: min-content;
>   min-height: 100vh;
>   padding: var(--margin) 0;
>   box-sizing: border-box;
91,92c93,107
< .widgets {
< 	width: 300px;
---
>   > * {
>     margin: var(--margin) 0;
>     width: 300px;
>     @media screen and (max-width:350px){
>       width: 250px;
>     }
> 
>     &:first-child {
>       margin-top: 0;
>     }
>   }
> 
>   > .add {
>     margin: 0 auto;
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/visitor/a.vue RiricaV13/ui/visitor/a.vue
2,20c2,42
< <div class="mk-app">
< 	<div v-if="mainRouter.currentRoute?.name === 'index'" class="banner" :style="{ backgroundImage: `url(${ $instance.bannerUrl })` }">
< 		<div>
< 			<h1 v-if="meta"><img v-if="meta.logoImageUrl" class="logo" :src="meta.logoImageUrl"><span v-else class="text">{{ instanceName }}</span></h1>
< 			<div v-if="meta" class="about">
< 				<!-- eslint-disable-next-line vue/no-v-html -->
< 				<div class="desc" v-html="meta.description || $ts.introMisskey"></div>
< 			</div>
< 			<div class="action">
< 				<button class="_button primary" @click="signup()">{{ $ts.signup }}</button>
< 				<button class="_button" @click="signin()">{{ $ts.login }}</button>
< 			</div>
< 		</div>
< 	</div>
< 	<div v-else class="banner-mini" :style="{ backgroundImage: `url(${ $instance.bannerUrl })` }">
< 		<div>
< 			<h1 v-if="meta"><img v-if="meta.logoImageUrl" class="logo" :src="meta.logoImageUrl"><span v-else class="text">{{ instanceName }}</span></h1>
< 		</div>
< 	</div>
---
>   <div class="mk-app">
>     <div
>       v-if="mainRouter.currentRoute?.name === 'index'"
>       class="banner"
>       :style="{ backgroundImage: `url(${$instance.bannerUrl})` }"
>     >
>       <div>
>         <h1 v-if="meta">
>           <img
>             v-if="meta.logoImageUrl"
>             class="logo"
>             :src="meta.logoImageUrl"
>           /><span v-else class="text">{{ instanceName }}</span>
>         </h1>
>         <div v-if="meta" class="about">
>           <!-- eslint-disable-next-line vue/no-v-html -->
>           <div class="desc" v-html="meta.description || $ts.introMisskey"></div>
>         </div>
>         <div class="action">
>           <button class="_button primary" @click="signup()">
>             {{ $ts.signup }}
>           </button>
>           <button class="_button" @click="signin()">{{ $ts.login }}</button>
>         </div>
>       </div>
>     </div>
>     <div
>       v-else
>       class="banner-mini"
>       :style="{ backgroundImage: `url(${$instance.bannerUrl})` }"
>     >
>       <div>
>         <h1 v-if="meta">
>           <img
>             v-if="meta.logoImageUrl"
>             class="logo"
>             :src="meta.logoImageUrl"
>           /><span v-else class="text">{{ instanceName }}</span>
>         </h1>
>       </div>
>     </div>
22,36c44,76
< 	<div class="main">
< 		<div ref="contents" class="contents" :class="{ wallpaper }">
< 			<header v-show="mainRouter.currentRoute?.name !== 'index'" ref="header" class="header">
< 				<XHeader :info="pageInfo"/>
< 			</header>
< 			<main ref="main" style="container-type: inline-size;">
< 				<RouterView/>
< 			</main>
< 			<div class="powered-by">
< 				<b><MkA to="/">{{ host }}</MkA></b>
< 				<small>Powered by <a href="https://github.com/misskey-dev/misskey" target="_blank">Misskey</a></small>
< 			</div>
< 		</div>
< 	</div>
< </div>
---
>     <div class="main">
>       <div ref="contents" class="contents" :class="{ wallpaper }">
>         <header
>           v-show="mainRouter.currentRoute?.name !== 'index'"
>           ref="header"
>           class="header"
>         >
>           <XHeader :info="pageInfo" />
>         </header>
>         <main ref="main">
>           <RouterView v-if="mainRouter" />
>           <pre v-else>
>         Network connection has Lost!
>         ネットワークにつながっていません！
> 
>         ネットワークにつないだ状態で再度お試しください
>       </pre
>           >
>         </main>
>         <div class="powered-by">
>           <b
>             ><MkA to="/">{{ host }}</MkA></b
>           >
>           <small
>             >Powered by
>             <a href="https://github.com/misskey-dev/misskey" target="_blank"
>               >Misskey</a
>             ></small
>           >
>         </div>
>       </div>
>     </div>
>   </div>
40,47c80,88
< import { defineComponent } from 'vue';
< import XHeader from './header.vue';
< import { host, instanceName } from '@/config';
< import { search } from '@/scripts/search';
< import * as os from '@/os';
< import MkButton from '@/components/MkButton.vue';
< import { ColdDeviceStorage } from '@/store';
< import { mainRouter } from '@/router';
---
> import { defineComponent, defineAsyncComponent } from "vue";
> import XHeader from "./header.vue";
> import { host, instanceName } from "@/config";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import MkPagination from "@/components/MkPagination.vue";
> import MkButton from "@/components/MkButton.vue";
> import { ColdDeviceStorage } from "@/store";
> import { mainRouter } from "@/router";
52,55c93,97
< 	components: {
< 		XHeader,
< 		MkButton,
< 	},
---
>   components: {
>     XHeader,
>     MkPagination,
>     MkButton,
>   },
57,71c99,113
< 	data() {
< 		return {
< 			host,
< 			instanceName,
< 			pageInfo: null,
< 			meta: null,
< 			narrow: window.innerWidth < 1280,
< 			announcements: {
< 				endpoint: 'announcements',
< 				limit: 10,
< 			},
< 			mainRouter,
< 			isDesktop: window.innerWidth >= DESKTOP_THRESHOLD,
< 		};
< 	},
---
>   data() {
>     return {
>       host,
>       instanceName,
>       pageInfo: null,
>       meta: null,
>       narrow: window.innerWidth < 1280,
>       announcements: {
>         endpoint: "announcements",
>         limit: 10,
>       },
>       mainRouter,
>       isDesktop: window.innerWidth >= DESKTOP_THRESHOLD,
>     };
>   },
73,84c115,126
< 	computed: {
< 		keymap(): any {
< 			return {
< 				'd': () => {
< 					if (ColdDeviceStorage.get('syncDeviceDarkMode')) return;
< 					this.$store.set('darkMode', !this.$store.state.darkMode);
< 				},
< 				's': search,
< 				'h|/': this.help,
< 			};
< 		},
< 	},
---
>   computed: {
>     keymap(): any {
>       return {
>         d: () => {
>           if (ColdDeviceStorage.get("syncDeviceDarkMode")) return;
>           this.$store.set("darkMode", !this.$store.state.darkMode);
>         },
>         s: search,
>         "h|/": this.help,
>       };
>     },
>   },
86,87c128,129
< 	created() {
< 		document.documentElement.style.overflowY = 'scroll';
---
>   created() {
>     document.documentElement.style.overflowY = "scroll";
89,92c131,134
< 		os.api('meta', { detail: true }).then(meta => {
< 			this.meta = meta;
< 		});
< 	},
---
>     os.api("meta", { detail: true }).then((meta) => {
>       this.meta = meta;
>     });
>   },
94,100c136,146
< 	mounted() {
< 		if (!this.isDesktop) {
< 			window.addEventListener('resize', () => {
< 				if (window.innerWidth >= DESKTOP_THRESHOLD) this.isDesktop = true;
< 			}, { passive: true });
< 		}
< 	},
---
>   mounted() {
>     if (!this.isDesktop) {
>       window.addEventListener(
>         "resize",
>         () => {
>           if (window.innerWidth >= DESKTOP_THRESHOLD) this.isDesktop = true;
>         },
>         { passive: true }
>       );
>     }
>   },
102,104c148,150
< 	methods: {
< 		// @ThatOneCalculator: Are these methods even used?
< 		// I can't find references to them anywhere else in the code...
---
>   methods: {
>     // @ThatOneCalculator: Are these methods even used?
>     // I can't find references to them anywhere else in the code...
106,108c152,154
< 		// setParallax(el) {
< 		// 	new simpleParallax(el);
< 		// },
---
>     // setParallax(el) {
>     // 	new simpleParallax(el);
>     // },
110,117c156,163
< 		changePage(page) {
< 			if (page == null) return;
< 			// eslint-disable-next-line no-undef
< 			if (page[symbols.PAGE_INFO]) {
< 				// eslint-disable-next-line no-undef
< 				this.pageInfo = page[symbols.PAGE_INFO];
< 			}
< 		},
---
>     changePage(page) {
>       if (page == null) return;
>       // eslint-disable-next-line no-undef
>       if (page[symbols.PAGE_INFO]) {
>         // eslint-disable-next-line no-undef
>         this.pageInfo = page[symbols.PAGE_INFO];
>       }
>     },
119,121c165,167
< 		top() {
< 			window.scroll({ top: 0, behavior: 'smooth' });
< 		},
---
>     top() {
>       window.scroll({ top: 0, behavior: "smooth" });
>     },
123,126c169,175
< 		help() {
< 			window.open('https://misskey-hub.net/docs/keyboard-shortcut.md', '_blank');
< 		},
< 	},
---
>     help() {
>       window.open(
>         "https://misskey-hub.net/docs/keyboard-shortcut.md",
>         "_blank"
>       );
>     },
>   },
132c181
< 	min-height: 100vh;
---
>   min-height: 100vh;
134,139c183,188
< 	> .banner {
< 		position: relative;
< 		width: 100%;
< 		text-align: center;
< 		background-position: center;
< 		background-size: cover;
---
>   > .banner {
>     position: relative;
>     width: 100%;
>     text-align: center;
>     background-position: center;
>     background-size: cover;
141,143c190,192
< 		> div {
< 			height: 100%;
< 			background: rgba(0, 0, 0, 0.3);
---
>     > div {
>       height: 100%;
>       background: rgba(0, 0, 0, 0.3);
145,152c194,196
< 			* {
< 				color: #fff;
< 			}
< 					
< 			> h1 {
< 				margin: 0;
< 				padding: 96px 32px 0 32px;
< 				text-shadow: 0 0 8px black;
---
>       * {
>         color: #fff;
>       }
154,158c198,201
< 				> .logo {
< 					vertical-align: bottom;
< 					max-height: 150px;
< 				}
< 			}
---
>       > h1 {
>         margin: 0;
>         padding: 96px 32px 0 32px;
>         text-shadow: 0 0 8px black;
160,166c203,207
< 			> .about {
< 				padding: 32px;
< 				max-width: 580px;
< 				margin: 0 auto;
< 				box-sizing: border-box;
< 				text-shadow: 0 0 8px black;
< 			}
---
>         > .logo {
>           vertical-align: bottom;
>           max-height: 150px;
>         }
>       }
168,178c209,215
< 			> .action {
< 				padding-bottom: 64px;
< 				
< 				> button {
< 					display: inline-block;
< 					padding: 10px 20px;
< 					box-sizing: border-box;
< 					text-align: center;
< 					border-radius: 999px;
< 					background: var(--panel);
< 					color: var(--fg);
---
>       > .about {
>         padding: 32px;
>         max-width: 580px;
>         margin: 0 auto;
>         box-sizing: border-box;
>         text-shadow: 0 0 8px black;
>       }
180,183c217,218
< 					&.primary {
< 						background: var(--accent);
< 						color: #fff;
< 					}
---
>       > .action {
>         padding-bottom: 64px;
185,191c220,227
< 					&:first-child {
< 						margin-right: 16px;
< 					}
< 				}
< 			}
< 		}
< 	}
---
>         > button {
>           display: inline-block;
>           padding: 10px 20px;
>           box-sizing: border-box;
>           text-align: center;
>           border-radius: 999px;
>           background: var(--panel);
>           color: var(--fg);
193,198c229,232
< 	> .banner-mini {
< 		position: relative;
< 		width: 100%;
< 		text-align: center;
< 		background-position: center;
< 		background-size: cover;
---
>           &.primary {
>             background: var(--accent);
>             color: #fff;
>           }
200,204c234,240
< 		> div {
< 			position: relative;
< 			z-index: 1;
< 			height: 100%;
< 			background: rgba(0, 0, 0, 0.3);
---
>           &:first-child {
>             margin-right: 16px;
>           }
>         }
>       }
>     }
>   }
206,208c242,247
< 			* {
< 				color: #fff !important;
< 			}
---
>   > .banner-mini {
>     position: relative;
>     width: 100%;
>     text-align: center;
>     background-position: center;
>     background-size: cover;
210,217c249,253
< 			> header {
< 				
< 			}
< 					
< 			> h1 {
< 				margin: 0;
< 				padding: 32px;
< 				text-shadow: 0 0 8px black;
---
>     > div {
>       position: relative;
>       z-index: 1;
>       height: 100%;
>       background: rgba(0, 0, 0, 0.3);
219,225c255,257
< 				> .logo {
< 					vertical-align: bottom;
< 					max-height: 100px;
< 				}
< 			}
< 		}
< 	}
---
>       * {
>         color: #fff !important;
>       }
227,230c259,260
< 	> .main {
< 		> .contents {
< 			position: relative;
< 			z-index: 1;
---
>       > header {
>       }
232,237c262,265
< 			> .header {
< 				position: sticky;
< 				top: 0;
< 				left: 0;
< 				z-index: 1000;
< 			}
---
>       > h1 {
>         margin: 0;
>         padding: 32px;
>         text-shadow: 0 0 8px black;
239,243c267,273
< 			> .powered-by {
< 				padding: 28px;
< 				font-size: 14px;
< 				text-align: center;
< 				border-top: 1px solid var(--divider);
---
>         > .logo {
>           vertical-align: bottom;
>           max-height: 100px;
>         }
>       }
>     }
>   }
245,252c275,300
< 				> small {
< 					display: block;
< 					margin-top: 8px;
< 					opacity: 0.5;
< 				}
< 			}
< 		}
< 	}
---
>   > .main {
>     > .contents {
>       position: relative;
>       z-index: 1;
> 
>       > .header {
>         position: sticky;
>         top: 0;
>         left: 0;
>         z-index: 1000;
>       }
> 
>       > .powered-by {
>         padding: 28px;
>         font-size: 14px;
>         text-align: center;
>         border-top: 1px solid var(--divider);
> 
>         > small {
>           display: block;
>           margin-top: 8px;
>           opacity: 0.5;
>         }
>       }
>     }
>   }
256,257c304
< <style lang="scss">
< </style>
---
> <style lang="scss"></style>
diff --color=auto -r misskeyV13/packages/frontend/src/ui/visitor/b.vue RiricaV13/ui/visitor/b.vue
3c3,35
< 	<a v-if="root" href="https://github.com/misskey-dev/misskey" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:var(--panel); color:var(--fg); position: fixed; z-index: 10; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
---
> 	<a
> 		v-if="root"
> 		href="https://github.com/misskey-dev/misskey"
> 		target="_blank"
> 		class="github-corner"
> 		aria-label="View source on GitHub"
> 	><svg
> 		width="80"
> 		height="80"
> 		viewBox="0 0 250 250"
> 		style="
>           fill: var(--panel);
>           color: var(--fg);
>           position: fixed;
>           z-index: 10;
>           top: 0;
>           border: 0;
>           right: 0;
>         "
> 		aria-hidden="true"
> 	>
> 		<path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
> 		<path
> 			d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
> 			fill="currentColor"
> 			style="transform-origin: 130px 106px"
> 			class="octo-arm"
> 		></path>
> 		<path
> 			d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
> 			fill="currentColor"
> 			class="octo-body"
> 		></path></svg></a>
14,15c46,47
< 			<main style="container-type: inline-size;">
< 				<RouterView/>
---
> 			<main>
> 				<RouterView v-if="root"/>
19c51,52
< 				<small>Powered by <a href="https://github.com/misskey-dev/misskey" target="_blank">Misskey</a></small>
---
> 				<small>Powered by
> 					<a href="https://github.com/misskey-dev/misskey" target="_blank">Misskey</a></small>
24c57
< 	<Transition :name="$store.state.animation ? 'tray-back' : ''">
---
> 	<transition :name="$store.state.animation ? 'tray-back' : ''">
31c64
< 	</Transition>
---
> 	</transition>
33c66
< 	<Transition :name="$store.state.animation ? 'tray' : ''">
---
> 	<transition :name="$store.state.animation ? 'tray' : ''">
35,38c68,79
< 			<MkA to="/" class="link" active-class="active"><i class="ti ti-home icon"></i>{{ $ts.home }}</MkA>
< 			<MkA to="/explore" class="link" active-class="active"><i class="ti ti-hash icon"></i>{{ $ts.explore }}</MkA>
< 			<MkA to="/featured" class="link" active-class="active"><i class="ti ti-flare icon"></i>{{ $ts.featured }}</MkA>
< 			<MkA to="/channels" class="link" active-class="active"><i class="ti ti-device-tv icon"></i>{{ $ts.channel }}</MkA>
---
> 			<MkA to="/" class="link" active-class="active">
> 				<i class="fas fa-home icon"></i>{{ $ts.home }}
> 			</MkA>
> 			<MkA to="/explore" class="link" active-class="active">
> 				<i class="fas fa-hashtag icon"></i>{{ $ts.explore }}
> 			</MkA>
> 			<MkA to="/featured" class="link" active-class="active">
> 				<i class="fas fa-fire-alt icon"></i>{{ $ts.featured }}
> 			</MkA>
> 			<MkA to="/channels" class="link" active-class="active">
> 				<i class="fas fa-satellite-dish icon"></i>{{ $ts.channel }}
> 			</MkA>
40c81,83
< 				<button class="_buttonPrimary" @click="signup()">{{ $ts.signup }}</button>
---
> 				<button class="_buttonPrimary" @click="signup()">
> 					{{ $ts.signup }}
> 				</button>
44c87
< 	</Transition>
---
> 	</transition>
49,61c92,108
< import { ComputedRef, onMounted, provide } from 'vue';
< import XHeader from './header.vue';
< import XKanban from './kanban.vue';
< import { host, instanceName } from '@/config';
< import { search } from '@/scripts/search';
< import * as os from '@/os';
< import MkPagination from '@/components/MkPagination.vue';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import MkButton from '@/components/MkButton.vue';
< import { ColdDeviceStorage, defaultStore } from '@/store';
< import { mainRouter } from '@/router';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
---
> import { ComputedRef, onMounted, provide } from "vue";
> import XHeader from "./header.vue";
> import XKanban from "./kanban.vue";
> import { host, instanceName } from "@/config";
> import { search } from "@/scripts/search";
> import * as os from "@/os";
> import MkPagination from "@/components/MkPagination.vue";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import MkButton from "@/components/MkButton.vue";
> import { ColdDeviceStorage, defaultStore } from "@/store";
> import { mainRouter } from "@/router";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
67c114
< provide('router', mainRouter);
---
> provide("router", mainRouter);
69,72c116,119
< 	pageMetadata = info;
< 	if (pageMetadata.value) {
< 		document.title = `${pageMetadata.value.title} | ${instanceName}`;
< 	}
---
>   pageMetadata = info;
>   if (pageMetadata.value) {
>     document.title = `${pageMetadata.value.title} | ${instanceName}`;
>   }
76,77c123,124
< 	endpoint: 'announcements',
< 	limit: 10,
---
>   endpoint: "announcements",
>   limit: 10,
85,91c132,138
< 	return {
< 		'd': () => {
< 			if (ColdDeviceStorage.get('syncDeviceDarkMode')) return;
< 			defaultStore.set('darkMode', !defaultStore.state.darkMode);
< 		},
< 		's': search,
< 	};
---
>   return {
>     d: () => {
>       if (ColdDeviceStorage.get("syncDeviceDarkMode")) return;
>       defaultStore.set("darkMode", !defaultStore.state.darkMode);
>     },
>     s: search,
>   };
94c141
< const root = $computed(() => mainRouter.currentRoute.value.name === 'index');
---
> const root = $computed(() => mainRouter.currentRoute.value.name === "index");
96,99d142
< os.api('meta', { detail: true }).then(res => {
< 	meta = res;
< });
< 
101,103c144,151
< 	os.popup(XSigninDialog, {
< 		autoSet: true,
< 	}, {}, 'closed');
---
>   os.popup(
>     XSigninDialog,
>     {
>       autoSet: true,
>     },
>     {},
>     "closed"
>   );
107,109c155,162
< 	os.popup(XSignupDialog, {
< 		autoSet: true,
< 	}, {}, 'closed');
---
>   os.popup(
>     XSignupDialog,
>     {
>       autoSet: true,
>     },
>     {},
>     "closed"
>   );
113,117c166,174
< 	if (!isDesktop) {
< 		window.addEventListener('resize', () => {
< 			if (window.innerWidth >= DESKTOP_THRESHOLD) isDesktop = true;
< 		}, { passive: true });
< 	}
---
>   if (!isDesktop) {
>     window.addEventListener(
>       "resize",
>       () => {
>         if (window.innerWidth >= DESKTOP_THRESHOLD) isDesktop = true;
>       },
>       { passive: true }
>     );
>   }
121c178
< 	showMenu: $$(showMenu),
---
>   showMenu: $$(showMenu),
126c183,207
< .github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}
---
> .github-corner:hover .octo-arm {
>   animation: octocat-wave 560ms ease-in-out;
> }
> @keyframes octocat-wave {
>   0%,
>   100% {
>     transform: rotate(0);
>   }
>   20%,
>   60% {
>     transform: rotate(-25deg);
>   }
>   40%,
>   80% {
>     transform: rotate(10deg);
>   }
> }
> @media (max-width: 500px) {
>   .github-corner:hover .octo-arm {
>     animation: none;
>   }
>   .github-corner .octo-arm {
>     animation: octocat-wave 560ms ease-in-out;
>   }
> }
132,134c213,216
< 	opacity: 1;
< 	transform: translateX(0);
< 	transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1), opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
>   opacity: 1;
>   transform: translateX(0);
>   transition: transform 300ms cubic-bezier(0.23, 1, 0.32, 1),
>     opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
138,139c220,221
< 	opacity: 0;
< 	transform: translateX(-240px);
---
>   opacity: 0;
>   transform: translateX(-240px);
144,145c226,227
< 	opacity: 1;
< 	transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
---
>   opacity: 1;
>   transition: opacity 300ms cubic-bezier(0.23, 1, 0.32, 1);
149c231
< 	opacity: 0;
---
>   opacity: 0;
153,157c235,239
< 	display: flex;
< 	min-height: 100vh;
< 	background-position: center;
< 	background-size: cover;
< 	background-attachment: fixed;
---
>   display: flex;
>   min-height: 100vh;
>   background-position: center;
>   background-size: cover;
>   background-attachment: fixed;
159,161c241,243
< 	> .side {
< 		width: 500px;
< 		height: 100vh;
---
>   > .side {
>     width: 500px;
>     height: 100vh;
163,171c245,253
< 		> .kanban {
< 			position: fixed;
< 			top: 0;
< 			left: 0;
< 			width: 500px;
< 			height: 100vh;
< 			overflow: auto;
< 		}
< 	}
---
>     > .kanban {
>       position: fixed;
>       top: 0;
>       left: 0;
>       width: 500px;
>       height: 100vh;
>       overflow: auto;
>     }
>   }
173,175c255,257
< 	> .main {
< 		flex: 1;
< 		min-width: 0;
---
>   > .main {
>     flex: 1;
>     min-width: 0;
177,178c259,260
< 		> .banner {
< 		}
---
>     > .banner {
>     }
180,182c262,264
< 		> .contents {
< 			position: relative;
< 			z-index: 1;
---
>     > .contents {
>       position: relative;
>       z-index: 1;
184,188c266,270
< 			> .powered-by {
< 				padding: 28px;
< 				font-size: 14px;
< 				text-align: center;
< 				border-top: 1px solid var(--divider);
---
>       > .powered-by {
>         padding: 28px;
>         font-size: 14px;
>         text-align: center;
>         border-top: 1px solid var(--divider);
190,197c272,279
< 				> small {
< 					display: block;
< 					margin-top: 8px;
< 					opacity: 0.5;
< 				}
< 			}
< 		}
< 	}
---
>         > small {
>           display: block;
>           margin-top: 8px;
>           opacity: 0.5;
>         }
>       }
>     }
>   }
199,206c281,288
< 	> .menu-back {
< 		position: fixed;
< 		z-index: 1001;
< 		top: 0;
< 		left: 0;
< 		width: 100vw;
< 		height: 100vh;
< 	}
---
>   > .menu-back {
>     position: fixed;
>     z-index: 1001;
>     top: 0;
>     left: 0;
>     width: 100vw;
>     height: 100vh;
>   }
208,215c290,297
< 	> .menu {
< 		position: fixed;
< 		z-index: 1001;
< 		top: 0;
< 		left: 0;
< 		width: 240px;
< 		height: 100vh;
< 		background: var(--panel);
---
>   > .menu {
>     position: fixed;
>     z-index: 1001;
>     top: 0;
>     left: 0;
>     width: 240px;
>     height: 100vh;
>     background: var(--panel);
217,219c299,301
< 		> .link {
< 			display: block;
< 			padding: 16px;
---
>     > .link {
>       display: block;
>       padding: 16px;
221,224c303,306
< 			> .icon {
< 				margin-right: 1em;
< 			}
< 		}
---
>       > .icon {
>         margin-right: 1em;
>       }
>     }
226,227c308,309
< 		> .action {
< 			padding: 16px;
---
>     > .action {
>       padding: 16px;
229,235c311,317
< 			> button {
< 				display: block;
< 				width: 100%;
< 				padding: 10px;
< 				box-sizing: border-box;
< 				text-align: center;
< 				border-radius: 999px;
---
>       > button {
>         display: block;
>         width: 100%;
>         padding: 10px;
>         box-sizing: border-box;
>         text-align: center;
>         border-radius: 999px;
237,239c319,321
< 				&._button {
< 					background: var(--panel);
< 				}
---
>         &._button {
>           background: var(--panel);
>         }
241,246c323,328
< 				&:first-child {
< 					margin-bottom: 16px;
< 				}
< 			}
< 		}
< 	}
---
>         &:first-child {
>           margin-bottom: 16px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/visitor/header.vue RiricaV13/ui/visitor/header.vue
2,39c2,85
< <div class="sqxihjet">
< 	<div v-if="narrow === false" class="wide">
< 		<div class="content">
< 			<MkA to="/" class="link" active-class="active"><i class="ti ti-home icon"></i>{{ $ts.home }}</MkA>
< 			<MkA to="/explore" class="link" active-class="active"><i class="ti ti-hash icon"></i>{{ $ts.explore }}</MkA>
< 			<MkA to="/featured" class="link" active-class="active"><i class="ti ti-flare icon"></i>{{ $ts.featured }}</MkA>
< 			<MkA to="/channels" class="link" active-class="active"><i class="ti ti-device-tv icon"></i>{{ $ts.channel }}</MkA>
< 			<div v-if="info" class="page active link">
< 				<div class="title">
< 					<i v-if="info.icon" class="icon" :class="info.icon"></i>
< 					<MkAvatar v-else-if="info.avatar" class="avatar" :user="info.avatar" indicator/>
< 					<span v-if="info.title" class="text">{{ info.title }}</span>
< 					<MkUserName v-else-if="info.userName" :user="info.userName" :nowrap="false" class="text"/>
< 				</div>
< 				<button v-if="info.action" class="_button action" @click.stop="info.action.handler"><!-- TODO --></button>
< 			</div>
< 			<div class="right">
< 				<button class="_button search" @click="search()"><i class="ti ti-search icon"></i><span>{{ $ts.search }}</span></button>
< 				<button class="_buttonPrimary signup" @click="signup()">{{ $ts.signup }}</button>
< 				<button class="_button login" @click="signin()">{{ $ts.login }}</button>
< 			</div>
< 		</div>
< 	</div>
< 	<div v-else-if="narrow === true" class="narrow">
< 		<button class="menu _button" @click="$parent.showMenu = true">
< 			<i class="ti ti-menu-2 icon"></i>
< 		</button>
< 		<div v-if="info" class="title">
< 			<i v-if="info.icon" class="icon" :class="info.icon"></i>
< 			<MkAvatar v-else-if="info.avatar" class="avatar" :user="info.avatar" indicator/>
< 			<span v-if="info.title" class="text">{{ info.title }}</span>
< 			<MkUserName v-else-if="info.userName" :user="info.userName" :nowrap="false" class="text"/>
< 		</div>
< 		<button v-if="info && info.action" class="action _button" @click.stop="info.action.handler">
< 			<!-- TODO -->
< 		</button>
< 	</div>
< </div>
---
>   <div class="sqxihjet">
>     <div v-if="narrow === false" class="wide">
>       <div class="content">
>         <MkA to="/" class="link" active-class="active"
>           ><i class="fas fa-home icon"></i>{{ $ts.home }}</MkA
>         >
>         <MkA to="/explore" class="link" active-class="active"
>           ><i class="fas fa-hashtag icon"></i>{{ $ts.explore }}</MkA
>         >
>         <MkA to="/featured" class="link" active-class="active"
>           ><i class="fas fa-fire-alt icon"></i>{{ $ts.featured }}</MkA
>         >
>         <MkA to="/channels" class="link" active-class="active"
>           ><i class="fas fa-satellite-dish icon"></i>{{ $ts.channel }}</MkA
>         >
>         <div v-if="info" class="page active link">
>           <div class="title">
>             <i v-if="info.icon" class="icon" :class="info.icon"></i>
>             <MkAvatar
>               v-else-if="info.avatar"
>               class="avatar"
>               :user="info.avatar"
>               :disable-preview="true"
>               :show-indicator="true"
>             />
>             <span v-if="info.title" class="text">{{ info.title }}</span>
>             <MkUserName
>               v-else-if="info.userName"
>               :user="info.userName"
>               :nowrap="false"
>               class="text"
>             />
>           </div>
>           <button
>             v-if="info.action"
>             class="_button action"
>             @click.stop="info.action.handler"
>           >
>             <!-- TODO -->
>           </button>
>         </div>
>         <div class="right">
>           <button class="_button search" @click="search()">
>             <i class="fas fa-search icon"></i><span>{{ $ts.search }}</span>
>           </button>
>           <button class="_buttonPrimary signup" @click="signup()">
>             {{ $ts.signup }}
>           </button>
>           <button class="_button login" @click="signin()">
>             {{ $ts.login }}
>           </button>
>         </div>
>       </div>
>     </div>
>     <div v-else-if="narrow === true" class="narrow">
>       <button class="menu _button" @click="$parent.showMenu = true">
>         <i class="fas fa-bars icon"></i>
>       </button>
>       <div v-if="info" class="title">
>         <i v-if="info.icon" class="icon" :class="info.icon"></i>
>         <MkAvatar
>           v-else-if="info.avatar"
>           class="avatar"
>           :user="info.avatar"
>           :disable-preview="true"
>           :show-indicator="true"
>         />
>         <span v-if="info.title" class="text">{{ info.title }}</span>
>         <MkUserName
>           v-else-if="info.userName"
>           :user="info.userName"
>           :nowrap="false"
>           class="text"
>         />
>       </div>
>       <button
>         v-if="info && info.action"
>         class="action _button"
>         @click.stop="info.action.handler"
>       >
>         <!-- TODO -->
>       </button>
>     </div>
>   </div>
43,47c89,93
< import { defineComponent } from 'vue';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import * as os from '@/os';
< import { search } from '@/scripts/search';
---
> import { defineComponent } from "vue";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import * as os from "@/os";
> import { search } from "@/scripts/search";
50,54c96,100
< 	props: {
< 		info: {
< 			required: true,
< 		},
< 	},
---
>   props: {
>     info: {
>       required: true,
>     },
>   },
56,61c102,107
< 	data() {
< 		return {
< 			narrow: null,
< 			showMenu: false,
< 		};
< 	},
---
>   data() {
>     return {
>       narrow: null,
>       showMenu: false,
>     };
>   },
63,65c109,111
< 	mounted() {
< 		this.narrow = this.$el.clientWidth < 1300;
< 	},
---
>   mounted() {
>     this.narrow = this.$el.clientWidth < 1300;
>   },
67,72c113,123
< 	methods: {
< 		signin() {
< 			os.popup(XSigninDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>   methods: {
>     signin() {
>       os.popup(
>         XSigninDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
74,78c125,134
< 		signup() {
< 			os.popup(XSignupDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>     signup() {
>       os.popup(
>         XSignupDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
80,81c136,137
< 		search,
< 	},
---
>     search,
>   },
87,95c143,151
< 	$height: 60px;
< 	position: sticky;
< 	top: 0;
< 	left: 0;
< 	z-index: 1000;
< 	line-height: $height;
< 	-webkit-backdrop-filter: var(--blur, blur(32px));
< 	backdrop-filter: var(--blur, blur(32px));
< 	background-color: var(--X16);
---
>   $height: 60px;
>   position: sticky;
>   top: 0;
>   left: 0;
>   z-index: 1000;
>   line-height: $height;
>   -webkit-backdrop-filter: var(--blur, blur(32px));
>   backdrop-filter: var(--blur, blur(32px));
>   background-color: var(--X16);
97,102c153,158
< 	> .wide {
< 		> .content {
< 			max-width: 1400px;
< 			margin: 0 auto;
< 			display: flex;
< 			align-items: center;
---
>   > .wide {
>     > .content {
>       max-width: 1400px;
>       margin: 0 auto;
>       display: flex;
>       align-items: center;
104,110c160,166
< 			> .link {
< 				$line: 3px;
< 				display: inline-block;
< 				padding: 0 16px;
< 				line-height: $height - ($line * 2);
< 				border-top: solid $line transparent;
< 				border-bottom: solid $line transparent;
---
>       > .link {
>         $line: 3px;
>         display: inline-block;
>         padding: 0 16px;
>         line-height: $height - ($line * 2);
>         border-top: solid $line transparent;
>         border-bottom: solid $line transparent;
112,114c168,170
< 				> .icon {
< 					margin-right: 0.5em;
< 				}
---
>         > .icon {
>           margin-right: 0.5em;
>         }
116,119c172,175
< 				&.page {
< 					border-bottom-color: var(--accent);
< 				}
< 			}
---
>         &.page {
>           border-bottom-color: var(--accent);
>         }
>       }
121,128c177,184
< 			> .page {
< 				> .title {
< 					display: inline-block;
< 					vertical-align: bottom;
< 					white-space: nowrap;
< 					overflow: hidden;
< 					text-overflow: ellipsis;
< 					position: relative;
---
>       > .page {
>         > .title {
>           display: inline-block;
>           vertical-align: bottom;
>           white-space: nowrap;
>           overflow: hidden;
>           text-overflow: ellipsis;
>           position: relative;
130,132c186,188
< 					> .icon + .text {
< 						margin-left: 8px;
< 					}
---
>           > .icon + .text {
>             margin-left: 8px;
>           }
134,142c190,198
< 					> .avatar {
< 						$size: 32px;
< 						display: inline-block;
< 						width: $size;
< 						height: $size;
< 						vertical-align: middle;
< 						margin-right: 8px;
< 						pointer-events: none;
< 					}
---
>           > .avatar {
>             $size: 32px;
>             display: inline-block;
>             width: $size;
>             height: $size;
>             vertical-align: middle;
>             margin-right: 8px;
>             pointer-events: none;
>           }
144,148c200,204
< 					&._button {
< 						&:hover {
< 							color: var(--fgHighlighted);
< 						}
< 					}
---
>           &._button {
>             &:hover {
>               color: var(--fgHighlighted);
>             }
>           }
150,154c206,210
< 					&.selected {
< 						box-shadow: 0 -2px 0 0 var(--accent) inset;
< 						color: var(--fgHighlighted);
< 					}
< 				}
---
>           &.selected {
>             box-shadow: 0 -2px 0 0 var(--accent) inset;
>             color: var(--fgHighlighted);
>           }
>         }
156,159c212,215
< 				> .action {
< 					padding: 0 0 0 16px;
< 				}
< 			}
---
>         > .action {
>           padding: 0 0 0 16px;
>         }
>       }
161,162c217,218
< 			> .right {
< 				margin-left: auto;
---
>       > .right {
>         margin-left: auto;
164,170c220,226
< 				> .search {
< 					background: var(--bg);
< 					border-radius: 999px;
< 					width: 230px;
< 					line-height: $height - 20px;
< 					margin-right: 16px;
< 					text-align: left;
---
>         > .search {
>           background: var(--bg);
>           border-radius: 999px;
>           width: 230px;
>           line-height: $height - 20px;
>           margin-right: 16px;
>           text-align: left;
172,174c228,230
< 					> * {
< 						opacity: 0.7;
< 					}
---
>           > * {
>             opacity: 0.7;
>           }
176,179c232,235
< 					> .icon {
< 						padding: 0 16px;
< 					}
< 				}
---
>           > .icon {
>             padding: 0 16px;
>           }
>         }
181,185c237,241
< 				> .signup {
< 					border-radius: 999px;
< 					padding: 0 24px;
< 					line-height: $height - 20px;
< 				}
---
>         > .signup {
>           border-radius: 999px;
>           padding: 0 24px;
>           line-height: $height - 20px;
>         }
187,192c243,248
< 				> .login {
< 					padding: 0 16px;
< 				}
< 			}
< 		}
< 	}
---
>         > .login {
>           padding: 0 16px;
>         }
>       }
>     }
>   }
194,195c250,251
< 	> .narrow {
< 		display: flex;
---
>   > .narrow {
>     display: flex;
197,202c253,258
< 		> .menu,
< 		> .action {
< 			width: $height;
< 			height: $height;
< 			font-size: 20px;
< 		}
---
>     > .menu,
>     > .action {
>       width: $height;
>       height: $height;
>       font-size: 20px;
>     }
204,210c260,266
< 		> .title {
< 			flex: 1;
< 			white-space: nowrap;
< 			overflow: hidden;
< 			text-overflow: ellipsis;
< 			position: relative;
< 			text-align: center;
---
>     > .title {
>       flex: 1;
>       white-space: nowrap;
>       overflow: hidden;
>       text-overflow: ellipsis;
>       position: relative;
>       text-align: center;
212,214c268,270
< 			> .icon + .text {
< 				margin-left: 8px;
< 			}
---
>       > .icon + .text {
>         margin-left: 8px;
>       }
216,226c272,282
< 			> .avatar {
< 				$size: 32px;
< 				display: inline-block;
< 				width: $size;
< 				height: $size;
< 				vertical-align: middle;
< 				margin-right: 8px;
< 				pointer-events: none;
< 			}
< 		}
< 	}
---
>       > .avatar {
>         $size: 32px;
>         display: inline-block;
>         width: $size;
>         height: $size;
>         vertical-align: middle;
>         margin-right: 8px;
>         pointer-events: none;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/visitor/kanban.vue RiricaV13/ui/visitor/kanban.vue
3,37c3,75
< <div class="rwqkcmrc" :style="{ backgroundImage: transparent ? 'none' : `url(${ $instance.backgroundImageUrl })` }">
< 	<div class="back" :class="{ transparent }"></div>
< 	<div class="contents">
< 		<div class="wrapper">
< 			<h1 v-if="meta" :class="{ full }">
< 				<MkA to="/" class="link"><img v-if="meta.logoImageUrl" class="logo" :src="meta.logoImageUrl" alt="logo"><span v-else class="text">{{ instanceName }}</span></MkA>
< 			</h1>
< 			<template v-if="full">
< 				<div v-if="meta" class="about">
< 					<div class="desc" v-html="meta.description || $ts.introMisskey"></div>
< 				</div>
< 				<div class="action">
< 					<button class="_buttonPrimary" @click="signup()">{{ $ts.signup }}</button>
< 					<button class="_button" @click="signin()">{{ $ts.login }}</button>
< 				</div>
< 				<div class="announcements panel">
< 					<header>{{ $ts.announcements }}</header>
< 					<MkPagination v-slot="{items}" :pagination="announcements" class="list">
< 						<section v-for="announcement in items" :key="announcement.id" class="item">
< 							<div class="title">{{ announcement.title }}</div>
< 							<div class="content">
< 								<Mfm :text="announcement.text"/>
< 								<img v-if="announcement.imageUrl" :src="announcement.imageUrl" alt="announcement image"/>
< 							</div>
< 						</section>
< 					</MkPagination>
< 				</div>
< 				<div v-if="poweredBy" class="powered-by">
< 					<b><MkA to="/">{{ host }}</MkA></b>
< 					<small>Powered by <a href="https://github.com/misskey-dev/misskey" target="_blank">Misskey</a></small>
< 				</div>
< 			</template>
< 		</div>
< 	</div>
< </div>
---
>   <div
>     class="rwqkcmrc"
>     :style="{
>       backgroundImage: transparent
>         ? 'none'
>         : `url(${$instance.backgroundImageUrl})`,
>     }"
>   >
>     <div class="back" :class="{ transparent }"></div>
>     <div class="contents">
>       <div class="wrapper">
>         <h1 v-if="meta" :class="{ full }">
>           <MkA to="/" class="link"
>             ><img
>               v-if="meta.logoImageUrl"
>               class="logo"
>               :src="meta.logoImageUrl"
>               alt="logo"
>             /><span v-else class="text">{{ instanceName }}</span></MkA
>           >
>         </h1>
>         <template v-if="full">
>           <div v-if="meta" class="about">
>             <div
>               class="desc"
>               v-html="meta.description || $ts.introMisskey"
>             ></div>
>           </div>
>           <div class="action">
>             <button class="_buttonPrimary" @click="signup()">
>               {{ $ts.signup }}
>             </button>
>             <button class="_button" @click="signin()">{{ $ts.login }}</button>
>           </div>
>           <div class="announcements panel">
>             <header>{{ $ts.announcements }}</header>
>             <MkPagination
>               v-slot="{ items }"
>               :pagination="announcements"
>               class="list"
>             >
>               <section
>                 v-for="announcement in items"
>                 :key="announcement.id"
>                 class="item"
>               >
>                 <div class="title">{{ announcement.title }}</div>
>                 <div class="content">
>                   <Mfm :text="announcement.text" />
>                   <img
>                     v-if="announcement.imageUrl"
>                     :src="announcement.imageUrl"
>                     alt="announcement image"
>                   />
>                 </div>
>               </section>
>             </MkPagination>
>           </div>
>           <div v-if="poweredBy" class="powered-by">
>             <b
>               ><MkA to="/">{{ host }}</MkA></b
>             >
>             <small
>               >Powered by
>               <a href="https://github.com/misskey-dev/misskey" target="_blank"
>                 >Misskey</a
>               ></small
>             >
>           </div>
>         </template>
>       </div>
>     </div>
>   </div>
41,47c79,85
< import { defineComponent, defineAsyncComponent } from 'vue';
< import { host, instanceName } from '@/config';
< import * as os from '@/os';
< import MkPagination from '@/components/MkPagination.vue';
< import XSigninDialog from '@/components/MkSigninDialog.vue';
< import XSignupDialog from '@/components/MkSignupDialog.vue';
< import MkButton from '@/components/MkButton.vue';
---
> import { defineComponent, defineAsyncComponent } from "vue";
> import { host, instanceName } from "@/config";
> import * as os from "@/os";
> import MkPagination from "@/components/MkPagination.vue";
> import XSigninDialog from "@/components/MkSigninDialog.vue";
> import XSignupDialog from "@/components/MkSignupDialog.vue";
> import MkButton from "@/components/MkButton.vue";
50,53c88,91
< 	components: {
< 		MkPagination,
< 		MkButton,
< 	},
---
>   components: {
>     MkPagination,
>     MkButton,
>   },
55,71c93,109
< 	props: {
< 		full: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		transparent: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 		poweredBy: {
< 			type: Boolean,
< 			required: false,
< 			default: false,
< 		},
< 	},
---
>   props: {
>     full: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     transparent: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>     poweredBy: {
>       type: Boolean,
>       required: false,
>       default: false,
>     },
>   },
73,85c111,123
< 	data() {
< 		return {
< 			host,
< 			instanceName,
< 			pageInfo: null,
< 			meta: null,
< 			narrow: window.innerWidth < 1280,
< 			announcements: {
< 				endpoint: 'announcements',
< 				limit: 10,
< 			},
< 		};
< 	},
---
>   data() {
>     return {
>       host,
>       instanceName,
>       pageInfo: null,
>       meta: null,
>       narrow: window.innerWidth < 1280,
>       announcements: {
>         endpoint: "announcements",
>         limit: 10,
>       },
>     };
>   },
87,91c125,129
< 	created() {
< 		os.api('meta', { detail: true }).then(meta => {
< 			this.meta = meta;
< 		});
< 	},
---
>   created() {
>     os.api("meta", { detail: true }).then((meta) => {
>       this.meta = meta;
>     });
>   },
93,98c131,141
< 	methods: {
< 		signin() {
< 			os.popup(XSigninDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
---
>   methods: {
>     signin() {
>       os.popup(
>         XSigninDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
100,105c143,153
< 		signup() {
< 			os.popup(XSignupDialog, {
< 				autoSet: true,
< 			}, {}, 'closed');
< 		},
< 	},
---
>     signup() {
>       os.popup(
>         XSignupDialog,
>         {
>           autoSet: true,
>         },
>         {},
>         "closed"
>       );
>     },
>   },
111,115c159,163
< 	position: relative;
< 	text-align: center;
< 	background-position: center;
< 	background-size: cover;
< 	// TODO: パララックスにしたい
---
>   position: relative;
>   text-align: center;
>   background-position: center;
>   background-size: cover;
>   // TODO: パララックスにしたい
117,123c165,171
< 	> .back {
< 		position: absolute;
< 		top: 0;
< 		left: 0;
< 		width: 100%;
< 		height: 100%;
< 		background: rgba(0, 0, 0, 0.3);
---
>   > .back {
>     position: absolute;
>     top: 0;
>     left: 0;
>     width: 100%;
>     height: 100%;
>     background: rgba(0, 0, 0, 0.3);
125,129c173,177
< 		&.transparent {
< 			-webkit-backdrop-filter: var(--blur, blur(12px));
< 			backdrop-filter: var(--blur, blur(12px));
< 		}
< 	}
---
>     &.transparent {
>       -webkit-backdrop-filter: var(--blur, blur(12px));
>       backdrop-filter: var(--blur, blur(12px));
>     }
>   }
131,135c179,183
< 	> .contents {
< 		position: relative;
< 		z-index: 1;
< 		height: inherit;
< 		overflow: auto;
---
>   > .contents {
>     position: relative;
>     z-index: 1;
>     height: inherit;
>     overflow: auto;
137,141c185,189
< 		> .wrapper {
< 			max-width: 380px;
< 			padding: 0 16px;
< 			box-sizing: border-box;
< 			margin: 0 auto;
---
>     > .wrapper {
>       max-width: 380px;
>       padding: 0 16px;
>       box-sizing: border-box;
>       margin: 0 auto;
143,147c191,195
< 			> .panel {
< 				-webkit-backdrop-filter: var(--blur, blur(8px));
< 				backdrop-filter: var(--blur, blur(8px));
< 				background: rgba(0, 0, 0, 0.5);
< 				border-radius: var(--radius);
---
>       > .panel {
>         -webkit-backdrop-filter: var(--blur, blur(8px));
>         backdrop-filter: var(--blur, blur(8px));
>         background: rgba(0, 0, 0, 0.5);
>         border-radius: var(--radius);
149,152c197,201
< 				&, * {
< 					color: #fff !important;
< 				}
< 			}
---
>         &,
>         * {
>           color: #fff !important;
>         }
>       }
154,158c203,207
< 			> h1 {
< 				display: block;
< 				margin: 0;
< 				padding: 32px 0 32px 0;
< 				color: #fff;
---
>       > h1 {
>         display: block;
>         margin: 0;
>         padding: 32px 0 32px 0;
>         color: #fff;
160,161c209,210
< 				&.full {
< 					padding: 64px 0 0 0;
---
>         &.full {
>           padding: 64px 0 0 0;
163,168c212,217
< 					> .link {
< 						> ::v-deep(.logo) {
< 							max-height: 130px;
< 						}
< 					}
< 				}
---
>           > .link {
>             > ::v-deep(.logo) {
>               max-height: 130px;
>             }
>           }
>         }
170,171c219,220
< 				> .link {
< 					display: block;
---
>         > .link {
>           display: block;
173,178c222,227
< 					> ::v-deep(.logo) {
< 						vertical-align: bottom;
< 						max-height: 100px;
< 					}
< 				}
< 			}
---
>           > ::v-deep(.logo) {
>             vertical-align: bottom;
>             max-height: 100px;
>           }
>         }
>       }
180,187c229,236
< 			> .about {
< 				display: block;
< 				margin: 24px 0;
< 				text-align: center;
< 				box-sizing: border-box;
< 				text-shadow: 0 0 8px black;
< 				color: #fff;
< 			}
---
>       > .about {
>         display: block;
>         margin: 24px 0;
>         text-align: center;
>         box-sizing: border-box;
>         text-shadow: 0 0 8px black;
>         color: #fff;
>       }
189,196c238,245
< 			> .action {
< 				> button {
< 					display: block;
< 					width: 100%;
< 					padding: 10px;
< 					box-sizing: border-box;
< 					text-align: center;
< 					border-radius: 999px;
---
>       > .action {
>         > button {
>           display: block;
>           width: 100%;
>           padding: 10px;
>           box-sizing: border-box;
>           text-align: center;
>           border-radius: 999px;
198,200c247,249
< 					&._button {
< 						background: var(--panel);
< 					}
---
>           &._button {
>             background: var(--panel);
>           }
202,206c251,255
< 					&:first-child {
< 						margin-bottom: 16px;
< 					}
< 				}
< 			}
---
>           &:first-child {
>             margin-bottom: 16px;
>           }
>         }
>       }
208,210c257,259
< 			> .announcements {
< 				margin: 32px 0;
< 				text-align: left;
---
>       > .announcements {
>         margin: 32px 0;
>         text-align: left;
212,215c261,264
< 				> header {
< 					padding: 12px 16px;
< 					border-bottom: solid 1px rgba(255, 255, 255, 0.5);
< 				}
---
>         > header {
>           padding: 12px 16px;
>           border-bottom: solid 1px rgba(255, 255, 255, 0.5);
>         }
217,219c266,268
< 				> .list {
< 					max-height: 300px;
< 					overflow: auto;
---
>         > .list {
>           max-height: 300px;
>           overflow: auto;
221,222c270,271
< 					> .item {
< 						padding: 12px 16px;
---
>           > .item {
>             padding: 12px 16px;
224,226c273,275
< 						& + .item {
< 							border-top: solid 1px rgba(255, 255, 255, 0.5);
< 						}
---
>             & + .item {
>               border-top: solid 1px rgba(255, 255, 255, 0.5);
>             }
228,230c277,279
< 						> .title {
< 							font-weight: bold;
< 						}
---
>             > .title {
>               font-weight: bold;
>             }
232,239c281,288
< 						> .content {
< 							> img {
< 								max-width: 100%;
< 							}
< 						}
< 					}
< 				}
< 			}
---
>             > .content {
>               > img {
>                 max-width: 100%;
>               }
>             }
>           }
>         }
>       }
241,246c290,295
< 			> .powered-by {
< 				padding: 28px;
< 				font-size: 14px;
< 				text-align: center;
< 				border-top: 1px solid rgba(255, 255, 255, 0.5);
< 				color: #fff;
---
>       > .powered-by {
>         padding: 28px;
>         font-size: 14px;
>         text-align: center;
>         border-top: 1px solid rgba(255, 255, 255, 0.5);
>         color: #fff;
248,255c297,304
< 				> small {
< 					display: block;
< 					margin-top: 8px;
< 					opacity: 0.5;
< 				}
< 			}
< 		}
< 	}
---
>         > small {
>           display: block;
>           margin-top: 8px;
>           opacity: 0.5;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/ui/visitor.vue RiricaV13/ui/visitor.vue
2,3c2,3
< <DesignB/>
< <XCommon/>
---
>   <DesignB />
>   <XCommon />
7,10c7,10
< import { defineComponent, defineAsyncComponent } from 'vue';
< import DesignA from './visitor/a.vue';
< import DesignB from './visitor/b.vue';
< import XCommon from './_common_/common.vue';
---
> import { defineComponent, defineAsyncComponent } from "vue";
> import DesignA from "./visitor/a.vue";
> import DesignB from "./visitor/b.vue";
> import XCommon from "./_common_/common.vue";
13,17c13,17
< 	components: {
< 		XCommon,
< 		DesignA,
< 		DesignB,
< 	},
---
>   components: {
>     XCommon,
>     DesignA,
>     DesignB,
>   },
diff --color=auto -r misskeyV13/packages/frontend/src/ui/zen.vue RiricaV13/ui/zen.vue
2,3c2,3
< <div class="mk-app" style="container-type: inline-size;">
< 	<RouterView/>
---
>   <div class="mk-app">
>     <RouterView />
5,6c5,6
< 	<XCommon/>
< </div>
---
>     <XCommon />
>   </div>
10,14c10,18
< import { provide, ComputedRef } from 'vue';
< import XCommon from './_common_/common.vue';
< import { mainRouter } from '@/router';
< import { PageMetadata, provideMetadataReceiver, setPageMetadata } from '@/scripts/page-metadata';
< import { instanceName } from '@/config';
---
> import { provide, ComputedRef } from "vue";
> import XCommon from "./_common_/common.vue";
> import { mainRouter } from "@/router";
> import {
>   PageMetadata,
>   provideMetadataReceiver,
>   setPageMetadata,
> } from "@/scripts/page-metadata";
> import { instanceName } from "@/config";
18c22
< provide('router', mainRouter);
---
> provide("router", mainRouter);
20,23c24,27
< 	pageMetadata = info;
< 	if (pageMetadata.value) {
< 		document.title = `${pageMetadata.value.title} | ${instanceName}`;
< 	}
---
>   pageMetadata = info;
>   if (pageMetadata.value) {
>     document.title = `${pageMetadata.value.title} | ${instanceName}`;
>   }
26c30
< document.documentElement.style.overflowY = 'scroll';
---
> document.documentElement.style.overflowY = "scroll";
31,32c35,36
< 	min-height: 100dvh;
< 	box-sizing: border-box;
---
>   min-height: 100dvh;
>   box-sizing: border-box;
Only in RiricaV13: vite-env.d.ts
Only in misskeyV13/packages/frontend/src/widgets: WidgetActivity.calendar.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetActivity.chart.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetActivity.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetAichan.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetAiscript.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetAiscriptApp.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetButton.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetCalendar.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetClicker.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetClock.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetDigitalClock.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetFederation.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetInstanceCloud.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetInstanceInfo.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetJobQueue.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetMemo.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetNotifications.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetOnlineUsers.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetPhotos.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetPostForm.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetProfile.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetRss.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetRssTicker.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetSlideshow.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetTimeline.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetTrends.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetUnixClock.vue
Only in misskeyV13/packages/frontend/src/widgets: WidgetUserList.vue
Only in RiricaV13/widgets: activity.calendar.vue
Only in RiricaV13/widgets: activity.chart.vue
Only in RiricaV13/widgets: activity.vue
Only in RiricaV13/widgets: aichan.vue
Only in RiricaV13/widgets: aiscript.vue
Only in RiricaV13/widgets: button.vue
Only in RiricaV13/widgets: calendar.vue
Only in RiricaV13/widgets: clock.vue
Only in RiricaV13/widgets: digital-clock.vue
Only in RiricaV13/widgets: federation.vue
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/index.ts RiricaV13/widgets/index.ts
1c1
< import { App, defineAsyncComponent } from 'vue';
---
> import { App, defineAsyncComponent } from "vue";
3,30c3,91
< export default function(app: App) {
< 	app.component('WidgetProfile', defineAsyncComponent(() => import('./WidgetProfile.vue')));
< 	app.component('WidgetInstanceInfo', defineAsyncComponent(() => import('./WidgetInstanceInfo.vue')));
< 	app.component('WidgetMemo', defineAsyncComponent(() => import('./WidgetMemo.vue')));
< 	app.component('WidgetNotifications', defineAsyncComponent(() => import('./WidgetNotifications.vue')));
< 	app.component('WidgetTimeline', defineAsyncComponent(() => import('./WidgetTimeline.vue')));
< 	app.component('WidgetCalendar', defineAsyncComponent(() => import('./WidgetCalendar.vue')));
< 	app.component('WidgetRss', defineAsyncComponent(() => import('./WidgetRss.vue')));
< 	app.component('WidgetRssTicker', defineAsyncComponent(() => import('./WidgetRssTicker.vue')));
< 	app.component('WidgetTrends', defineAsyncComponent(() => import('./WidgetTrends.vue')));
< 	app.component('WidgetClock', defineAsyncComponent(() => import('./WidgetClock.vue')));
< 	app.component('WidgetActivity', defineAsyncComponent(() => import('./WidgetActivity.vue')));
< 	app.component('WidgetPhotos', defineAsyncComponent(() => import('./WidgetPhotos.vue')));
< 	app.component('WidgetDigitalClock', defineAsyncComponent(() => import('./WidgetDigitalClock.vue')));
< 	app.component('WidgetUnixClock', defineAsyncComponent(() => import('./WidgetUnixClock.vue')));
< 	app.component('WidgetFederation', defineAsyncComponent(() => import('./WidgetFederation.vue')));
< 	app.component('WidgetPostForm', defineAsyncComponent(() => import('./WidgetPostForm.vue')));
< 	app.component('WidgetSlideshow', defineAsyncComponent(() => import('./WidgetSlideshow.vue')));
< 	app.component('WidgetServerMetric', defineAsyncComponent(() => import('./server-metric/index.vue')));
< 	app.component('WidgetOnlineUsers', defineAsyncComponent(() => import('./WidgetOnlineUsers.vue')));
< 	app.component('WidgetJobQueue', defineAsyncComponent(() => import('./WidgetJobQueue.vue')));
< 	app.component('WidgetInstanceCloud', defineAsyncComponent(() => import('./WidgetInstanceCloud.vue')));
< 	app.component('WidgetButton', defineAsyncComponent(() => import('./WidgetButton.vue')));
< 	app.component('WidgetAiscript', defineAsyncComponent(() => import('./WidgetAiscript.vue')));
< 	app.component('WidgetAiscriptApp', defineAsyncComponent(() => import('./WidgetAiscriptApp.vue')));
< 	app.component('WidgetAichan', defineAsyncComponent(() => import('./WidgetAichan.vue')));
< 	app.component('WidgetUserList', defineAsyncComponent(() => import('./WidgetUserList.vue')));
< 	app.component('WidgetClicker', defineAsyncComponent(() => import('./WidgetClicker.vue')));
---
> export default function (app: App) {
>   app.component(
>     "MkwMemo",
>     defineAsyncComponent(() => import("./memo.vue"))
>   );
>   app.component(
>     "MkwNotifications",
>     defineAsyncComponent(() => import("./notifications.vue"))
>   );
>   app.component(
>     "MkwTimeline",
>     defineAsyncComponent(() => import("./timeline.vue"))
>   );
>   app.component(
>     "MkwCalendar",
>     defineAsyncComponent(() => import("./calendar.vue"))
>   );
>   app.component(
>     "MkwRss",
>     defineAsyncComponent(() => import("./rss.vue"))
>   );
>   app.component(
>     "MkwRssTicker",
>     defineAsyncComponent(() => import("./rss-ticker.vue"))
>   );
>   app.component(
>     "MkwTrends",
>     defineAsyncComponent(() => import("./trends.vue"))
>   );
>   app.component(
>     "MkwClock",
>     defineAsyncComponent(() => import("./clock.vue"))
>   );
>   app.component(
>     "MkwActivity",
>     defineAsyncComponent(() => import("./activity.vue"))
>   );
>   app.component(
>     "MkwPhotos",
>     defineAsyncComponent(() => import("./photos.vue"))
>   );
>   app.component(
>     "MkwDigitalClock",
>     defineAsyncComponent(() => import("./digital-clock.vue"))
>   );
>   app.component(
>     "MkwUnixClock",
>     defineAsyncComponent(() => import("./unix-clock.vue"))
>   );
>   app.component(
>     "MkwFederation",
>     defineAsyncComponent(() => import("./federation.vue"))
>   );
>   app.component(
>     "MkwPostForm",
>     defineAsyncComponent(() => import("./post-form.vue"))
>   );
>   app.component(
>     "MkwSlideshow",
>     defineAsyncComponent(() => import("./slideshow.vue"))
>   );
>   app.component(
>     "MkwServerMetric",
>     defineAsyncComponent(() => import("./server-metric/index.vue"))
>   );
>   app.component(
>     "MkwOnlineUsers",
>     defineAsyncComponent(() => import("./online-users.vue"))
>   );
>   app.component(
>     "MkwJobQueue",
>     defineAsyncComponent(() => import("./job-queue.vue"))
>   );
>   app.component(
>     "MkwInstanceCloud",
>     defineAsyncComponent(() => import("./instance-cloud.vue"))
>   );
>   app.component(
>     "MkwButton",
>     defineAsyncComponent(() => import("./button.vue"))
>   );
>   app.component(
>     "MkwAiscript",
>     defineAsyncComponent(() => import("./aiscript.vue"))
>   );
>   app.component(
>     "MkwAichan",
>     defineAsyncComponent(() => import("./aichan.vue"))
>   );
34,60c95,116
< 	'profile',
< 	'instanceInfo',
< 	'memo',
< 	'notifications',
< 	'timeline',
< 	'calendar',
< 	'rss',
< 	'rssTicker',
< 	'trends',
< 	'clock',
< 	'activity',
< 	'photos',
< 	'digitalClock',
< 	'unixClock',
< 	'federation',
< 	'instanceCloud',
< 	'postForm',
< 	'slideshow',
< 	'serverMetric',
< 	'onlineUsers',
< 	'jobQueue',
< 	'button',
< 	'aiscript',
< 	'aiscriptApp',
< 	'aichan',
< 	'userList',
< 	'clicker',
---
>   "memo",
>   "notifications",
>   "timeline",
>   "calendar",
>   "rss",
>   "rssTicker",
>   "trends",
>   "clock",
>   "activity",
>   "photos",
>   "digitalClock",
>   "unixClock",
>   "federation",
>   "instanceCloud",
>   "postForm",
>   "slideshow",
>   "serverMetric",
>   "onlineUsers",
>   "jobQueue",
>   "button",
>   "aiscript",
>   "aichan",
Only in RiricaV13/widgets: instance-cloud.vue
Only in RiricaV13/widgets: job-queue.vue
Only in RiricaV13/widgets: memo.vue
Only in RiricaV13/widgets: notifications.vue
Only in RiricaV13/widgets: online-users.vue
Only in RiricaV13/widgets: photos.vue
Only in RiricaV13/widgets: post-form.vue
Only in RiricaV13/widgets: rss-ticker.vue
Only in RiricaV13/widgets: rss.vue
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/cpu-mem.vue RiricaV13/widgets/server-metric/cpu-mem.vue
2,69c2,61
< <div class="lcfyofjk">
< 	<svg :viewBox="`0 0 ${ viewBoxX } ${ viewBoxY }`">
< 		<defs>
< 			<linearGradient :id="cpuGradientId" x1="0" x2="0" y1="1" y2="0">
< 				<stop offset="0%" stop-color="hsl(180, 80%, 70%)"></stop>
< 				<stop offset="100%" stop-color="hsl(0, 80%, 70%)"></stop>
< 			</linearGradient>
< 			<mask :id="cpuMaskId" x="0" y="0" :width="viewBoxX" :height="viewBoxY">
< 				<polygon
< 					:points="cpuPolygonPoints"
< 					fill="#fff"
< 					fill-opacity="0.5"
< 				/>
< 				<polyline
< 					:points="cpuPolylinePoints"
< 					fill="none"
< 					stroke="#fff"
< 					stroke-width="1"
< 				/>
< 				<circle
< 					:cx="cpuHeadX"
< 					:cy="cpuHeadY"
< 					r="1.5"
< 					fill="#fff"
< 				/>
< 			</mask>
< 		</defs>
< 		<rect
< 			x="-2" y="-2"
< 			:width="viewBoxX + 4" :height="viewBoxY + 4"
< 			:style="`stroke: none; fill: url(#${ cpuGradientId }); mask: url(#${ cpuMaskId })`"
< 		/>
< 		<text x="1" y="5">CPU <tspan>{{ cpuP }}%</tspan></text>
< 	</svg>
< 	<svg :viewBox="`0 0 ${ viewBoxX } ${ viewBoxY }`">
< 		<defs>
< 			<linearGradient :id="memGradientId" x1="0" x2="0" y1="1" y2="0">
< 				<stop offset="0%" stop-color="hsl(180, 80%, 70%)"></stop>
< 				<stop offset="100%" stop-color="hsl(0, 80%, 70%)"></stop>
< 			</linearGradient>
< 			<mask :id="memMaskId" x="0" y="0" :width="viewBoxX" :height="viewBoxY">
< 				<polygon
< 					:points="memPolygonPoints"
< 					fill="#fff"
< 					fill-opacity="0.5"
< 				/>
< 				<polyline
< 					:points="memPolylinePoints"
< 					fill="none"
< 					stroke="#fff"
< 					stroke-width="1"
< 				/>
< 				<circle
< 					:cx="memHeadX"
< 					:cy="memHeadY"
< 					r="1.5"
< 					fill="#fff"
< 				/>
< 			</mask>
< 		</defs>
< 		<rect
< 			x="-2" y="-2"
< 			:width="viewBoxX + 4" :height="viewBoxY + 4"
< 			:style="`stroke: none; fill: url(#${ memGradientId }); mask: url(#${ memMaskId })`"
< 		/>
< 		<text x="1" y="5">MEM <tspan>{{ memP }}%</tspan></text>
< 	</svg>
< </div>
---
>   <div class="lcfyofjk">
>     <svg :viewBox="`0 0 ${viewBoxX} ${viewBoxY}`">
>       <defs>
>         <linearGradient :id="cpuGradientId" x1="0" x2="0" y1="1" y2="0">
>           <stop offset="0%" stop-color="hsl(180, 80%, 70%)"></stop>
>           <stop offset="100%" stop-color="hsl(0, 80%, 70%)"></stop>
>         </linearGradient>
>         <mask :id="cpuMaskId" x="0" y="0" :width="viewBoxX" :height="viewBoxY">
>           <polygon :points="cpuPolygonPoints" fill="#fff" fill-opacity="0.5" />
>           <polyline
>             :points="cpuPolylinePoints"
>             fill="none"
>             stroke="#fff"
>             stroke-width="1"
>           />
>           <circle :cx="cpuHeadX" :cy="cpuHeadY" r="1.5" fill="#fff" />
>         </mask>
>       </defs>
>       <rect
>         x="-2"
>         y="-2"
>         :width="viewBoxX + 4"
>         :height="viewBoxY + 4"
>         :style="`stroke: none; fill: url(#${cpuGradientId}); mask: url(#${cpuMaskId})`"
>       />
>       <text x="1" y="5">
>         CPU
>         <tspan>{{ cpuP }}%</tspan>
>       </text>
>     </svg>
>     <svg :viewBox="`0 0 ${viewBoxX} ${viewBoxY}`">
>       <defs>
>         <linearGradient :id="memGradientId" x1="0" x2="0" y1="1" y2="0">
>           <stop offset="0%" stop-color="hsl(180, 80%, 70%)"></stop>
>           <stop offset="100%" stop-color="hsl(0, 80%, 70%)"></stop>
>         </linearGradient>
>         <mask :id="memMaskId" x="0" y="0" :width="viewBoxX" :height="viewBoxY">
>           <polygon :points="memPolygonPoints" fill="#fff" fill-opacity="0.5" />
>           <polyline
>             :points="memPolylinePoints"
>             fill="none"
>             stroke="#fff"
>             stroke-width="1"
>           />
>           <circle :cx="memHeadX" :cy="memHeadY" r="1.5" fill="#fff" />
>         </mask>
>       </defs>
>       <rect
>         x="-2"
>         y="-2"
>         :width="viewBoxX + 4"
>         :height="viewBoxY + 4"
>         :style="`stroke: none; fill: url(#${memGradientId}); mask: url(#${memMaskId})`"
>       />
>       <text x="1" y="5">
>         MEM
>         <tspan>{{ memP }}%</tspan>
>       </text>
>     </svg>
>   </div>
73,74c65,66
< import { onMounted, onBeforeUnmount } from 'vue';
< import { v4 as uuid } from 'uuid';
---
> import { onMounted, onBeforeUnmount } from "vue";
> import { v4 as uuid } from "uuid";
77,78c69,70
< 	connection: any,
< 	meta: any
---
>   connection: any;
>   meta: any;
88,91c80,83
< let cpuPolylinePoints: string = $ref('');
< let memPolylinePoints: string = $ref('');
< let cpuPolygonPoints: string = $ref('');
< let memPolygonPoints: string = $ref('');
---
> let cpuPolylinePoints: string = $ref("");
> let memPolylinePoints: string = $ref("");
> let cpuPolygonPoints: string = $ref("");
> let memPolygonPoints: string = $ref("");
96,97c88,89
< let cpuP: string = $ref('');
< let memP: string = $ref('');
---
> let cpuP: string = $ref("");
> let memP: string = $ref("");
100,104c92,96
< 	props.connection.on('stats', onStats);
< 	props.connection.on('statsLog', onStatsLog);
< 	props.connection.send('requestLog', {
< 		id: Math.random().toString().substr(2, 8),
< 	});
---
>   props.connection.on("stats", onStats);
>   props.connection.on("statsLog", onStatsLog);
>   props.connection.send("requestLog", {
>     id: Math.random().toString().substr(2, 8),
>   });
108,109c100,101
< 	props.connection.off('stats', onStats);
< 	props.connection.off('statsLog', onStatsLog);
---
>   props.connection.off("stats", onStats);
>   props.connection.off("statsLog", onStatsLog);
113,114c105,106
< 	stats.push(connStats);
< 	if (stats.length > 50) stats.shift();
---
>   stats.push(connStats);
>   if (stats.length > 50) stats.shift();
116,119c108,121
< 	let cpuPolylinePointsStats = stats.map((s, i) => [viewBoxX - ((stats.length - 1) - i), (1 - s.cpu) * viewBoxY]);
< 	let memPolylinePointsStats = stats.map((s, i) => [viewBoxX - ((stats.length - 1) - i), (1 - (s.mem.active / props.meta.mem.total)) * viewBoxY]);
< 	cpuPolylinePoints = cpuPolylinePointsStats.map(xy => `${xy[0]},${xy[1]}`).join(' ');
< 	memPolylinePoints = memPolylinePointsStats.map(xy => `${xy[0]},${xy[1]}`).join(' ');
---
>   let cpuPolylinePointsStats = stats.map((s, i) => [
>     viewBoxX - (stats.length - 1 - i),
>     (1 - s.cpu) * viewBoxY,
>   ]);
>   let memPolylinePointsStats = stats.map((s, i) => [
>     viewBoxX - (stats.length - 1 - i),
>     (1 - s.mem.active / props.meta.mem.total) * viewBoxY,
>   ]);
>   cpuPolylinePoints = cpuPolylinePointsStats
>     .map((xy) => `${xy[0]},${xy[1]}`)
>     .join(" ");
>   memPolylinePoints = memPolylinePointsStats
>     .map((xy) => `${xy[0]},${xy[1]}`)
>     .join(" ");
121,122c123,128
< 	cpuPolygonPoints = `${viewBoxX - (stats.length - 1)},${viewBoxY} ${cpuPolylinePoints} ${viewBoxX},${viewBoxY}`;
< 	memPolygonPoints = `${viewBoxX - (stats.length - 1)},${viewBoxY} ${memPolylinePoints} ${viewBoxX},${viewBoxY}`;
---
>   cpuPolygonPoints = `${
>     viewBoxX - (stats.length - 1)
>   },${viewBoxY} ${cpuPolylinePoints} ${viewBoxX},${viewBoxY}`;
>   memPolygonPoints = `${
>     viewBoxX - (stats.length - 1)
>   },${viewBoxY} ${memPolylinePoints} ${viewBoxX},${viewBoxY}`;
124,127c130,133
< 	cpuHeadX = cpuPolylinePointsStats[cpuPolylinePointsStats.length - 1][0];
< 	cpuHeadY = cpuPolylinePointsStats[cpuPolylinePointsStats.length - 1][1];
< 	memHeadX = memPolylinePointsStats[memPolylinePointsStats.length - 1][0];
< 	memHeadY = memPolylinePointsStats[memPolylinePointsStats.length - 1][1];
---
>   cpuHeadX = cpuPolylinePointsStats[cpuPolylinePointsStats.length - 1][0];
>   cpuHeadY = cpuPolylinePointsStats[cpuPolylinePointsStats.length - 1][1];
>   memHeadX = memPolylinePointsStats[memPolylinePointsStats.length - 1][0];
>   memHeadY = memPolylinePointsStats[memPolylinePointsStats.length - 1][1];
129,130c135,136
< 	cpuP = (connStats.cpu * 100).toFixed(0);
< 	memP = (connStats.mem.active / props.meta.mem.total * 100).toFixed(0);
---
>   cpuP = (connStats.cpu * 100).toFixed(0);
>   memP = ((connStats.mem.active / props.meta.mem.total) * 100).toFixed(0);
134,136c140,142
< 	for (const revStats of [...statsLog].reverse()) {
< 		onStats(revStats);
< 	}
---
>   for (const revStats of [...statsLog].reverse()) {
>     onStats(revStats);
>   }
142c148
< 	display: flex;
---
>   display: flex;
144,147c150,153
< 	> svg {
< 		display: block;
< 		padding: 10px;
< 		width: 50%;
---
>   > svg {
>     display: block;
>     padding: 10px;
>     width: 50%;
149,151c155,157
< 		&:first-child {
< 			padding-right: 5px;
< 		}
---
>     &:first-child {
>       padding-right: 5px;
>     }
153,155c159,161
< 		&:last-child {
< 			padding-left: 5px;
< 		}
---
>     &:last-child {
>       padding-left: 5px;
>     }
157,159c163,165
< 		> text {
< 			font-size: 4.5px;
< 			fill: currentColor;
---
>     > text {
>       font-size: 5px;
>       fill: currentColor;
161,165c167,171
< 			> tspan {
< 				opacity: 0.5;
< 			}
< 		}
< 	}
---
>       > tspan {
>         opacity: 0.5;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/cpu.vue RiricaV13/widgets/server-metric/cpu.vue
2,9c2,9
< <div class="vrvdvrys">
< 	<XPie class="pie" :value="usage"/>
< 	<div>
< 		<p><i class="ti ti-cpu"></i>CPU</p>
< 		<p>{{ meta.cpu.cores }} Logical cores</p>
< 		<p>{{ meta.cpu.model }}</p>
< 	</div>
< </div>
---
>   <div class="vrvdvrys">
>     <XPie class="pie" :value="usage" />
>     <div>
>       <p><i class="fas fa-microchip"></i>CPU</p>
>       <p>{{ meta.cpu.cores }} Logical cores</p>
>       <p>{{ meta.cpu.model }}</p>
>     </div>
>   </div>
13,14c13,14
< import { onMounted, onBeforeUnmount } from 'vue';
< import XPie from './pie.vue';
---
> import { onMounted, onBeforeUnmount } from "vue";
> import XPie from "./pie.vue";
17,18c17,18
< 	connection: any,
< 	meta: any
---
>   connection: any;
>   meta: any;
24c24
< 	usage = stats.cpu;
---
>   usage = stats.cpu;
28c28
< 	props.connection.on('stats', onStats);
---
>   props.connection.on("stats", onStats);
32c32
< 	props.connection.off('stats', onStats);
---
>   props.connection.off("stats", onStats);
38,39c38,39
< 	display: flex;
< 	padding: 16px;
---
>   display: flex;
>   padding: 16px;
41,45c41,45
< 	> .pie {
< 		height: 82px;
< 		flex-shrink: 0;
< 		margin-right: 16px;
< 	}
---
>   > .pie {
>     height: 82px;
>     flex-shrink: 0;
>     margin-right: 16px;
>   }
47,48c47,48
< 	> div {
< 		flex: 1;
---
>   > div {
>     flex: 1;
50,52c50,52
< 		> p {
< 			margin: 0;
< 			font-size: 0.8em;
---
>     > p {
>       margin: 0;
>       font-size: 0.8em;
54,56c54,56
< 			&:first-child {
< 				font-weight: bold;
< 				margin-bottom: 4px;
---
>       &:first-child {
>         font-weight: bold;
>         margin-bottom: 4px;
58,63c58,63
< 				> i {
< 					margin-right: 4px;
< 				}
< 			}
< 		}
< 	}
---
>         > i {
>           margin-right: 4px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/disk.vue RiricaV13/widgets/server-metric/disk.vue
2,10c2,10
< <div class="zbwaqsat">
< 	<XPie class="pie" :value="usage"/>
< 	<div>
< 		<p><i class="ti ti-database"></i>Disk</p>
< 		<p>Total: {{ bytes(total, 1) }}</p>
< 		<p>Free: {{ bytes(available, 1) }}</p>
< 		<p>Used: {{ bytes(used, 1) }}</p>
< 	</div>
< </div>
---
>   <div class="zbwaqsat">
>     <XPie class="pie" :value="usage" />
>     <div>
>       <p><i class="fas fa-hdd"></i>Disk</p>
>       <p>Total: {{ bytes(total, 1) }}</p>
>       <p>Free: {{ bytes(available, 1) }}</p>
>       <p>Used: {{ bytes(used, 1) }}</p>
>     </div>
>   </div>
14,16c14,16
< import { } from 'vue';
< import XPie from './pie.vue';
< import bytes from '@/filters/bytes';
---
> import {} from "vue";
> import XPie from "./pie.vue";
> import bytes from "@/filters/bytes";
19c19
< 	meta: any; // TODO
---
>   meta: any; // TODO
30,31c30,31
< 	display: flex;
< 	padding: 16px;
---
>   display: flex;
>   padding: 16px;
33,37c33,37
< 	> .pie {
< 		height: 82px;
< 		flex-shrink: 0;
< 		margin-right: 16px;
< 	}
---
>   > .pie {
>     height: 82px;
>     flex-shrink: 0;
>     margin-right: 16px;
>   }
39,40c39,40
< 	> div {
< 		flex: 1;
---
>   > div {
>     flex: 1;
42,44c42,44
< 		> p {
< 			margin: 0;
< 			font-size: 0.8em;
---
>     > p {
>       margin: 0;
>       font-size: 0.8em;
46,48c46,48
< 			&:first-child {
< 				font-weight: bold;
< 				margin-bottom: 4px;
---
>       &:first-child {
>         font-weight: bold;
>         margin-bottom: 4px;
50,55c50,55
< 				> i {
< 					margin-right: 4px;
< 				}
< 			}
< 		}
< 	}
---
>         > i {
>           margin-right: 4px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/index.vue RiricaV13/widgets/server-metric/index.vue
2,5c2,13
< <MkContainer :show-header="widgetProps.showHeader" :naked="widgetProps.transparent">
< 	<template #icon><i class="ti ti-server"></i></template>
< 	<template #header>{{ i18n.ts._widgets.serverMetric }}</template>
< 	<template #func="{ buttonStyleClass }"><button class="_button" :class="buttonStyleClass" @click="toggleView()"><i class="ti ti-selector"></i></button></template>
---
>   <MkContainer
>     :show-header="widgetProps.showHeader"
>     :naked="widgetProps.transparent"
>   >
>     <template #header
>       ><i class="fas fa-server"></i
>       >{{ i18n.ts._widgets.serverMetric }}</template
>     >
>     <template #func
>       ><button class="_button" @click="toggleView()">
>         <i class="fas fa-sort"></i></button
>     ></template>
7,14c15,42
< 	<div v-if="meta" class="mkw-serverMetric data-cy-mkw-serverMetric">
< 		<XCpuMemory v-if="widgetProps.view === 0" :connection="connection" :meta="meta"/>
< 		<XNet v-else-if="widgetProps.view === 1" :connection="connection" :meta="meta"/>
< 		<XCpu v-else-if="widgetProps.view === 2" :connection="connection" :meta="meta"/>
< 		<XMemory v-else-if="widgetProps.view === 3" :connection="connection" :meta="meta"/>
< 		<XDisk v-else-if="widgetProps.view === 4" :connection="connection" :meta="meta"/>
< 	</div>
< </MkContainer>
---
>     <div v-if="meta" class="mkw-serverMetric">
>       <XCpuMemory
>         v-if="widgetProps.view === 0"
>         :connection="connection"
>         :meta="meta"
>       />
>       <XNet
>         v-else-if="widgetProps.view === 1"
>         :connection="connection"
>         :meta="meta"
>       />
>       <XCpu
>         v-else-if="widgetProps.view === 2"
>         :connection="connection"
>         :meta="meta"
>       />
>       <XMemory
>         v-else-if="widgetProps.view === 3"
>         :connection="connection"
>         :meta="meta"
>       />
>       <XDisk
>         v-else-if="widgetProps.view === 4"
>         :connection="connection"
>         :meta="meta"
>       />
>     </div>
>   </MkContainer>
18,29c46,63
< import { onMounted, onUnmounted, ref } from 'vue';
< import { useWidgetPropsManager, Widget, WidgetComponentEmits, WidgetComponentExpose, WidgetComponentProps } from '../widget';
< import XCpuMemory from './cpu-mem.vue';
< import XNet from './net.vue';
< import XCpu from './cpu.vue';
< import XMemory from './mem.vue';
< import XDisk from './disk.vue';
< import MkContainer from '@/components/MkContainer.vue';
< import { GetFormResultType } from '@/scripts/form';
< import * as os from '@/os';
< import { stream } from '@/stream';
< import { i18n } from '@/i18n';
---
> import { onMounted, onUnmounted, ref } from "vue";
> import {
>   useWidgetPropsManager,
>   Widget,
>   WidgetComponentEmits,
>   WidgetComponentExpose,
>   WidgetComponentProps,
> } from "../widget";
> import XCpuMemory from "./cpu-mem.vue";
> import XNet from "./net.vue";
> import XCpu from "./cpu.vue";
> import XMemory from "./mem.vue";
> import XDisk from "./disk.vue";
> import MkContainer from "@/components/MkContainer.vue";
> import { GetFormResultType } from "@/scripts/form";
> import * as os from "@/os";
> import { stream } from "@/stream";
> import { i18n } from "@/i18n";
31c65
< const name = 'serverMetric';
---
> const name = "serverMetric";
34,46c68,80
< 	showHeader: {
< 		type: 'boolean' as const,
< 		default: true,
< 	},
< 	transparent: {
< 		type: 'boolean' as const,
< 		default: false,
< 	},
< 	view: {
< 		type: 'number' as const,
< 		default: 0,
< 		hidden: true,
< 	},
---
>   showHeader: {
>     type: "boolean" as const,
>     default: true,
>   },
>   transparent: {
>     type: "boolean" as const,
>     default: false,
>   },
>   view: {
>     type: "number" as const,
>     default: 0,
>     hidden: true,
>   },
54,55c88,89
< const props = defineProps<{ widget?: Widget<WidgetProps>; }>();
< const emit = defineEmits<{ (ev: 'updateProps', props: WidgetProps); }>();
---
> const props = defineProps<{ widget?: Widget<WidgetProps> }>();
> const emit = defineEmits<{ (ev: "updateProps", props: WidgetProps) }>();
57,60c91,95
< const { widgetProps, configure, save } = useWidgetPropsManager(name,
< 	widgetPropsDef,
< 	props,
< 	emit,
---
> const { widgetProps, configure, save } = useWidgetPropsManager(
>   name,
>   widgetPropsDef,
>   props,
>   emit
65,66c100,101
< os.api('server-info', {}).then(res => {
< 	meta.value = res;
---
> os.api("server-info", {}).then((res) => {
>   meta.value = res;
70,75c105,110
< 	if (widgetProps.view === 4) {
< 		widgetProps.view = 0;
< 	} else {
< 		widgetProps.view++;
< 	}
< 	save();
---
>   if (widgetProps.view === 4) {
>     widgetProps.view = 0;
>   } else {
>     widgetProps.view++;
>   }
>   save();
78c113
< const connection = stream.useChannel('serverStats');
---
> const connection = stream.useChannel("serverStats");
80c115
< 	connection.dispose();
---
>   connection.dispose();
84,86c119,121
< 	name,
< 	configure,
< 	id: props.widget ? props.widget.id : null,
---
>   name,
>   configure,
>   id: props.widget ? props.widget.id : null,
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/mem.vue RiricaV13/widgets/server-metric/mem.vue
2,10c2,10
< <div class="zlxnikvl">
< 	<XPie class="pie" :value="usage"/>
< 	<div>
< 		<p><i class="fas fa-memory"></i>RAM</p>
< 		<p>Total: {{ bytes(total, 1) }}</p>
< 		<p>Used: {{ bytes(used, 1) }}</p>
< 		<p>Free: {{ bytes(free, 1) }}</p>
< 	</div>
< </div>
---
>   <div class="zlxnikvl">
>     <XPie class="pie" :value="usage" />
>     <div>
>       <p><i class="fas fa-memory"></i>RAM</p>
>       <p>Total: {{ bytes(total, 1) }}</p>
>       <p>Used: {{ bytes(used, 1) }}</p>
>       <p>Free: {{ bytes(free, 1) }}</p>
>     </div>
>   </div>
14,16c14,16
< import { onMounted, onBeforeUnmount } from 'vue';
< import XPie from './pie.vue';
< import bytes from '@/filters/bytes';
---
> import { onMounted, onBeforeUnmount } from "vue";
> import XPie from "./pie.vue";
> import bytes from "@/filters/bytes";
19,20c19,20
< 	connection: any,
< 	meta: any
---
>   connection: any;
>   meta: any;
29,32c29,32
< 	usage = stats.mem.active / props.meta.mem.total;
< 	total = props.meta.mem.total;
< 	used = stats.mem.active;
< 	free = total - used;
---
>   usage = stats.mem.active / props.meta.mem.total;
>   total = props.meta.mem.total;
>   used = stats.mem.active;
>   free = total - used;
36c36
< 	props.connection.on('stats', onStats);
---
>   props.connection.on("stats", onStats);
40c40
< 	props.connection.off('stats', onStats);
---
>   props.connection.off("stats", onStats);
46,47c46,47
< 	display: flex;
< 	padding: 16px;
---
>   display: flex;
>   padding: 16px;
49,53c49,53
< 	> .pie {
< 		height: 82px;
< 		flex-shrink: 0;
< 		margin-right: 16px;
< 	}
---
>   > .pie {
>     height: 82px;
>     flex-shrink: 0;
>     margin-right: 16px;
>   }
55,56c55,56
< 	> div {
< 		flex: 1;
---
>   > div {
>     flex: 1;
58,60c58,60
< 		> p {
< 			margin: 0;
< 			font-size: 0.8em;
---
>     > p {
>       margin: 0;
>       font-size: 0.8em;
62,64c62,64
< 			&:first-child {
< 				font-weight: bold;
< 				margin-bottom: 4px;
---
>       &:first-child {
>         font-weight: bold;
>         margin-bottom: 4px;
66,71c66,71
< 				> i {
< 					margin-right: 4px;
< 				}
< 			}
< 		}
< 	}
---
>         > i {
>           margin-right: 4px;
>         }
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/net.vue RiricaV13/widgets/server-metric/net.vue
2,43c2,31
< <div class="oxxrhrto">
< 	<svg :viewBox="`0 0 ${ viewBoxX } ${ viewBoxY }`">
< 		<polygon
< 			:points="inPolygonPoints"
< 			fill="#94a029"
< 			fill-opacity="0.5"
< 		/>
< 		<polyline
< 			:points="inPolylinePoints"
< 			fill="none"
< 			stroke="#94a029"
< 			stroke-width="1"
< 		/>
< 		<circle
< 			:cx="inHeadX"
< 			:cy="inHeadY"
< 			r="1.5"
< 			fill="#94a029"
< 		/>
< 		<text x="1" y="5">NET rx <tspan>{{ bytes(inRecent) }}</tspan></text>
< 	</svg>
< 	<svg :viewBox="`0 0 ${ viewBoxX } ${ viewBoxY }`">
< 		<polygon
< 			:points="outPolygonPoints"
< 			fill="#ff9156"
< 			fill-opacity="0.5"
< 		/>
< 		<polyline
< 			:points="outPolylinePoints"
< 			fill="none"
< 			stroke="#ff9156"
< 			stroke-width="1"
< 		/>
< 		<circle
< 			:cx="outHeadX"
< 			:cy="outHeadY"
< 			r="1.5"
< 			fill="#ff9156"
< 		/>
< 		<text x="1" y="5">NET tx <tspan>{{ bytes(outRecent) }}</tspan></text>
< 	</svg>
< </div>
---
>   <div class="oxxrhrto">
>     <svg :viewBox="`0 0 ${viewBoxX} ${viewBoxY}`">
>       <polygon :points="inPolygonPoints" fill="#94a029" fill-opacity="0.5" />
>       <polyline
>         :points="inPolylinePoints"
>         fill="none"
>         stroke="#94a029"
>         stroke-width="1"
>       />
>       <circle :cx="inHeadX" :cy="inHeadY" r="1.5" fill="#94a029" />
>       <text x="1" y="5">
>         NET rx
>         <tspan>{{ bytes(inRecent) }}</tspan>
>       </text>
>     </svg>
>     <svg :viewBox="`0 0 ${viewBoxX} ${viewBoxY}`">
>       <polygon :points="outPolygonPoints" fill="#ff9156" fill-opacity="0.5" />
>       <polyline
>         :points="outPolylinePoints"
>         fill="none"
>         stroke="#ff9156"
>         stroke-width="1"
>       />
>       <circle :cx="outHeadX" :cy="outHeadY" r="1.5" fill="#ff9156" />
>       <text x="1" y="5">
>         NET tx
>         <tspan>{{ bytes(outRecent) }}</tspan>
>       </text>
>     </svg>
>   </div>
47,48c35,36
< import { onMounted, onBeforeUnmount } from 'vue';
< import bytes from '@/filters/bytes';
---
> import { onMounted, onBeforeUnmount } from "vue";
> import bytes from "@/filters/bytes";
51,52c39,40
< 	connection: any,
< 	meta: any
---
>   connection: any;
>   meta: any;
58,61c46,49
< let inPolylinePoints: string = $ref('');
< let outPolylinePoints: string = $ref('');
< let inPolygonPoints: string = $ref('');
< let outPolygonPoints: string = $ref('');
---
> let inPolylinePoints: string = $ref("");
> let outPolylinePoints: string = $ref("");
> let inPolygonPoints: string = $ref("");
> let outPolygonPoints: string = $ref("");
70,74c58,62
< 	props.connection.on('stats', onStats);
< 	props.connection.on('statsLog', onStatsLog);
< 	props.connection.send('requestLog', {
< 		id: Math.random().toString().substr(2, 8),
< 	});
---
>   props.connection.on("stats", onStats);
>   props.connection.on("statsLog", onStatsLog);
>   props.connection.send("requestLog", {
>     id: Math.random().toString().substr(2, 8),
>   });
78,79c66,67
< 	props.connection.off('stats', onStats);
< 	props.connection.off('statsLog', onStatsLog);
---
>   props.connection.off("stats", onStats);
>   props.connection.off("statsLog", onStatsLog);
83,84c71,72
< 	stats.push(connStats);
< 	if (stats.length > 50) stats.shift();
---
>   stats.push(connStats);
>   if (stats.length > 50) stats.shift();
86,87c74,75
< 	const inPeak = Math.max(1024 * 64, Math.max(...stats.map(s => s.net.rx)));
< 	const outPeak = Math.max(1024 * 64, Math.max(...stats.map(s => s.net.tx)));
---
>   const inPeak = Math.max(1024 * 64, Math.max(...stats.map((s) => s.net.rx)));
>   const outPeak = Math.max(1024 * 64, Math.max(...stats.map((s) => s.net.tx)));
89,92c77,90
< 	let inPolylinePointsStats = stats.map((s, i) => [viewBoxX - ((stats.length - 1) - i), (1 - (s.net.rx / inPeak)) * viewBoxY]);
< 	let outPolylinePointsStats = stats.map((s, i) => [viewBoxX - ((stats.length - 1) - i), (1 - (s.net.tx / outPeak)) * viewBoxY]);
< 	inPolylinePoints = inPolylinePointsStats.map(xy => `${xy[0]},${xy[1]}`).join(' ');
< 	outPolylinePoints = outPolylinePointsStats.map(xy => `${xy[0]},${xy[1]}`).join(' ');
---
>   let inPolylinePointsStats = stats.map((s, i) => [
>     viewBoxX - (stats.length - 1 - i),
>     (1 - s.net.rx / inPeak) * viewBoxY,
>   ]);
>   let outPolylinePointsStats = stats.map((s, i) => [
>     viewBoxX - (stats.length - 1 - i),
>     (1 - s.net.tx / outPeak) * viewBoxY,
>   ]);
>   inPolylinePoints = inPolylinePointsStats
>     .map((xy) => `${xy[0]},${xy[1]}`)
>     .join(" ");
>   outPolylinePoints = outPolylinePointsStats
>     .map((xy) => `${xy[0]},${xy[1]}`)
>     .join(" ");
94,95c92,97
< 	inPolygonPoints = `${viewBoxX - (stats.length - 1)},${viewBoxY} ${inPolylinePoints} ${viewBoxX},${viewBoxY}`;
< 	outPolygonPoints = `${viewBoxX - (stats.length - 1)},${viewBoxY} ${outPolylinePoints} ${viewBoxX},${viewBoxY}`;
---
>   inPolygonPoints = `${
>     viewBoxX - (stats.length - 1)
>   },${viewBoxY} ${inPolylinePoints} ${viewBoxX},${viewBoxY}`;
>   outPolygonPoints = `${
>     viewBoxX - (stats.length - 1)
>   },${viewBoxY} ${outPolylinePoints} ${viewBoxX},${viewBoxY}`;
97,100c99,102
< 	inHeadX = inPolylinePointsStats[inPolylinePointsStats.length - 1][0];
< 	inHeadY = inPolylinePointsStats[inPolylinePointsStats.length - 1][1];
< 	outHeadX = outPolylinePointsStats[outPolylinePointsStats.length - 1][0];
< 	outHeadY = outPolylinePointsStats[outPolylinePointsStats.length - 1][1];
---
>   inHeadX = inPolylinePointsStats[inPolylinePointsStats.length - 1][0];
>   inHeadY = inPolylinePointsStats[inPolylinePointsStats.length - 1][1];
>   outHeadX = outPolylinePointsStats[outPolylinePointsStats.length - 1][0];
>   outHeadY = outPolylinePointsStats[outPolylinePointsStats.length - 1][1];
102,103c104,105
< 	inRecent = connStats.net.rx;
< 	outRecent = connStats.net.tx;
---
>   inRecent = connStats.net.rx;
>   outRecent = connStats.net.tx;
107,109c109,111
< 	for (const revStats of [...statsLog].reverse()) {
< 		onStats(revStats);
< 	}
---
>   for (const revStats of [...statsLog].reverse()) {
>     onStats(revStats);
>   }
115c117
< 	display: flex;
---
>   display: flex;
117,120c119,122
< 	> svg {
< 		display: block;
< 		padding: 10px;
< 		width: 50%;
---
>   > svg {
>     display: block;
>     padding: 10px;
>     width: 50%;
122,124c124,126
< 		&:first-child {
< 			padding-right: 5px;
< 		}
---
>     &:first-child {
>       padding-right: 5px;
>     }
126,128c128,130
< 		&:last-child {
< 			padding-left: 5px;
< 		}
---
>     &:last-child {
>       padding-left: 5px;
>     }
130,132c132,134
< 		> text {
< 			font-size: 4.5px;
< 			fill: currentColor;
---
>     > text {
>       font-size: 5px;
>       fill: currentColor;
134,138c136,140
< 			> tspan {
< 				opacity: 0.5;
< 			}
< 		}
< 	}
---
>       > tspan {
>         opacity: 0.5;
>       }
>     }
>   }
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/server-metric/pie.vue RiricaV13/widgets/server-metric/pie.vue
2,20c2,24
< <svg class="hsalcinq" viewBox="0 0 1 1" preserveAspectRatio="none">
< 	<circle
< 		:r="r"
< 		cx="50%" cy="50%"
< 		fill="none"
< 		stroke-width="0.1"
< 		stroke="rgba(0, 0, 0, 0.05)"
< 	/>
< 	<circle
< 		:r="r"
< 		cx="50%" cy="50%"
< 		:stroke-dasharray="Math.PI * (r * 2)"
< 		:stroke-dashoffset="strokeDashoffset"
< 		fill="none"
< 		stroke-width="0.1"
< 		:stroke="color"
< 	/>
< 	<text x="50%" y="50%" dy="0.05" text-anchor="middle">{{ (value * 100).toFixed(0) }}%</text>
< </svg>
---
>   <svg class="hsalcinq" viewBox="0 0 1 1" preserveAspectRatio="none">
>     <circle
>       :r="r"
>       cx="50%"
>       cy="50%"
>       fill="none"
>       stroke-width="0.1"
>       stroke="rgba(0, 0, 0, 0.05)"
>     />
>     <circle
>       :r="r"
>       cx="50%"
>       cy="50%"
>       :stroke-dasharray="Math.PI * (r * 2)"
>       :stroke-dashoffset="strokeDashoffset"
>       fill="none"
>       stroke-width="0.1"
>       :stroke="color"
>     />
>     <text x="50%" y="50%" dy="0.05" text-anchor="middle">
>       {{ (value * 100).toFixed(0) }}%
>     </text>
>   </svg>
24c28
< import { } from 'vue';
---
> import {} from "vue";
27c31
< 	value: number;
---
>   value: number;
32,33c36,39
< const color = $computed(() => `hsl(${180 - (props.value * 180)}, 80%, 70%)`);
< const strokeDashoffset = $computed(() => (1 - props.value) * (Math.PI * (r * 2)));
---
> const color = $computed(() => `hsl(${180 - props.value * 180}, 80%, 70%)`);
> const strokeDashoffset = $computed(
>   () => (1 - props.value) * (Math.PI * (r * 2))
> );
38,39c44,45
< 	display: block;
< 	height: 100%;
---
>   display: block;
>   height: 100%;
41,45c47,51
< 	> circle {
< 		transform-origin: center;
< 		transform: rotate(-90deg);
< 		transition: stroke-dashoffset 0.5s ease;
< 	}
---
>   > circle {
>     transform-origin: center;
>     transform: rotate(-90deg);
>     transition: stroke-dashoffset 0.5s ease;
>   }
47,50c53,56
< 	> text {
< 		font-size: 0.15px;
< 		fill: currentColor;
< 	}
---
>   > text {
>     font-size: 0.15px;
>     fill: currentColor;
>   }
Only in RiricaV13/widgets: slideshow.vue
Only in RiricaV13/widgets: timeline.vue
Only in RiricaV13/widgets: trends.vue
Only in RiricaV13/widgets: unix-clock.vue
diff --color=auto -r misskeyV13/packages/frontend/src/widgets/widget.ts RiricaV13/widgets/widget.ts
1,5c1,5
< import { reactive, watch } from 'vue';
< import { throttle } from 'throttle-debounce';
< import { Form, GetFormResultType } from '@/scripts/form';
< import * as os from '@/os';
< import { deepClone } from '@/scripts/clone';
---
> import { reactive, watch } from "vue";
> import { throttle } from "throttle-debounce";
> import { Form, GetFormResultType } from "@/scripts/form";
> import * as os from "@/os";
> import { deepClone } from "@/scripts/clone";
8,9c8,9
< 	id: string;
< 	data: Partial<P>;
---
>   id: string;
>   data: Partial<P>;
13c13
< 	widget?: Widget<P>;
---
>   widget?: Widget<P>;
17c17
< 	(ev: 'updateProps', props: P);
---
>   (ev: "updateProps", props: P);
21,23c21,23
< 	name: string;
< 	id: string | null;
< 	configure: () => void;
---
>   name: string;
>   id: string | null;
>   configure: () => void;
26,30c26,32
< export const useWidgetPropsManager = <F extends Form & Record<string, { default: any; }>>(
< 	name: string,
< 	propsDef: F,
< 	props: Readonly<WidgetComponentProps<GetFormResultType<F>>>,
< 	emit: WidgetComponentEmits<GetFormResultType<F>>,
---
> export const useWidgetPropsManager = <
>   F extends Form & Record<string, { default: any }>
> >(
>   name: string,
>   propsDef: F,
>   props: Readonly<WidgetComponentProps<GetFormResultType<F>>>,
>   emit: WidgetComponentEmits<GetFormResultType<F>>
32,34c34,36
< 	widgetProps: GetFormResultType<F>;
< 	save: () => void;
< 	configure: () => void;
---
>   widgetProps: GetFormResultType<F>;
>   save: () => void;
>   configure: () => void;
36c38,40
< 	const widgetProps = reactive(props.widget ? deepClone(props.widget.data) : {});
---
>   const widgetProps = reactive(
>     props.widget ? deepClone(props.widget.data) : {}
>   );
38,47c42,55
< 	const mergeProps = () => {
< 		for (const prop of Object.keys(propsDef)) {
< 			if (typeof widgetProps[prop] === 'undefined') {
< 				widgetProps[prop] = propsDef[prop].default;
< 			}
< 		}
< 	};
< 	watch(widgetProps, () => {
< 		mergeProps();
< 	}, { deep: true, immediate: true });
---
>   const mergeProps = () => {
>     for (const prop of Object.keys(propsDef)) {
>       if (typeof widgetProps[prop] === "undefined") {
>         widgetProps[prop] = propsDef[prop].default;
>       }
>     }
>   };
>   watch(
>     widgetProps,
>     () => {
>       mergeProps();
>     },
>     { deep: true, immediate: true }
>   );
49,51c57,59
< 	const save = throttle(3000, () => {
< 		emit('updateProps', widgetProps);
< 	});
---
>   const save = throttle(3000, () => {
>     emit("updateProps", widgetProps);
>   });
53,59c61,67
< 	const configure = async () => {
< 		const form = deepClone(propsDef);
< 		for (const item of Object.keys(form)) {
< 			form[item].default = widgetProps[item];
< 		}
< 		const { canceled, result } = await os.form(name, form);
< 		if (canceled) return;
---
>   const configure = async () => {
>     const form = deepClone(propsDef);
>     for (const item of Object.keys(form)) {
>       form[item].default = widgetProps[item];
>     }
>     const { canceled, result } = await os.form(name, form);
>     if (canceled) return;
61,63c69,71
< 		for (const key of Object.keys(result)) {
< 			widgetProps[key] = result[key];
< 		}
---
>     for (const key of Object.keys(result)) {
>       widgetProps[key] = result[key];
>     }
65,66c73,74
< 		save();
< 	};
---
>     save();
>   };
68,72c76,80
< 	return {
< 		widgetProps,
< 		save,
< 		configure,
< 	};
---
>   return {
>     widgetProps,
>     save,
>     configure,
>   };
